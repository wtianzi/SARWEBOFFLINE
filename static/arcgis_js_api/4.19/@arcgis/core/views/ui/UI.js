/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import"../../chunks/ArrayPool.js";import"../../core/lang.js";import"../../chunks/deprecate.js";import"../../chunks/object.js";import"../../config.js";import"../../chunks/Logger.js";import"../../chunks/string.js";import"../../chunks/metadata.js";import{property as e}from"../../core/accessorSupport/decorators/property.js";import i from"../../core/Accessor.js";import"../../chunks/PropertyOrigin.js";import"../../core/scheduling.js";import"../../core/promiseUtils.js";import"../../chunks/Message.js";import"../../core/Error.js";import"../../chunks/ensureType.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import{E as n}from"../../chunks/Evented.js";import"../../core/Collection.js";import"../../core/urlUtils.js";import{cast as s}from"../../core/accessorSupport/decorators/cast.js";import"../../chunks/resourceExtension.js";import r from"../../core/Handles.js";import{init as d}from"../../core/watchUtils.js";import{b as a,e as p,i as c}from"../../chunks/domUtils.js";import{i as l}from"../../chunks/widgetUtils.js";const h="esri-component";let u=class extends i{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add(h),e&&e.classList.remove(h),this._set("node",t))}castNode(t){return t?"string"==typeof t||function(t){return t&&"nodeType"in t}(t)?(this._set("widget",null),a(t)):(function(t){return t&&"function"==typeof t.render}(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};t([e({dependsOn:[]})],u.prototype,"id",null),t([e()],u.prototype,"node",null),t([s("node")],u.prototype,"castNode",null),t([e({readOnly:!0})],u.prototype,"widget",void 0),u=t([o("esri.views.ui.Component")],u);var m=u;const g={left:0,top:0,bottom:0,right:0},_={bottom:30,top:15,right:15,left:15},f="esri-ui",y="esri-ui-corner",C="esri-ui-inner-container",v="esri-ui-manual-container",w="esri-ui-corner-container",j="esri-ui-top-left",P="esri-ui-top-right",L="esri-ui-bottom-left",k="esri-ui-bottom-right";function b(t){return"object"==typeof t&&!(t instanceof m)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function x(t,{top:e,bottom:i,left:o,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=o,t.style.right=n}let N=class extends n.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new r,this.view=null,this._initContainers()}initialize(){this._handles.add([d(this,"view.padding, container",this._applyViewPadding.bind(this)),d(this,"padding",this._applyUIPadding.bind(this))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(f),this._attachContainers(t)),e&&(e.classList.remove(f),x(e,{top:"",bottom:"",left:"",right:""}),p(e)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const e=this._getViewPadding(),i=e.top+e.bottom;return Math.max(t-i,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding")}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{..._,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const e=this._getViewPadding(),i=e.left+e.right;return Math.max(t-i,0)}add(t,e){let i,o;if(Array.isArray(t))return void t.forEach((t=>this.add(t,e)));const n=b(t);n&&({index:i,position:e,component:t,key:o}=n),e&&"object"==typeof e&&({index:i,key:o,position:e}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,o)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,e)));const i=this._find(t);if(i){const o=this._componentToKey;if(o.has(t)&&o.get(t)!==e)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,e)=>t.concat(e)));if("manual"===(t=t||"manual")){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(y))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,e){if(Array.isArray(t)&&t.forEach((t=>this.move(t,e))),!t)return;let i;const o=b(t)||b(e);if(o&&(i=o.index,e=o.position,t=o.component||t),e&&!this._isValidPosition(e))return;const n=this.remove(t);n&&this.add(n,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getPosition(t){for(const e in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[e].contains(t))return e}return null}_add(t,e,i,o){t instanceof m||(t=new m({node:t})),this._place({component:t,position:e,index:i}),this._components.push(t),o&&this._componentToKey.set(t,o)}_find(t){return t?t instanceof m?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||g}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(C),t.classList.add(w);const e=document.createElement("div");e.classList.add(C),e.classList.add(v);const i=document.createElement("div");i.classList.add(j),i.classList.add(y),t.appendChild(i);const o=document.createElement("div");o.classList.add(P),o.classList.add(y),t.appendChild(o);const n=document.createElement("div");n.classList.add(L),n.classList.add(y),t.appendChild(n);const s=document.createElement("div");s.classList.add(k),s.classList.add(y),t.appendChild(s),this._innerContainer=t,this._manualContainer=e;const r=l();this._cornerNameToContainerLookup={"top-left":i,"top-right":o,"bottom-left":n,"bottom-right":s,"top-leading":r?o:i,"top-trailing":r?i:o,"bottom-leading":r?s:n,"bottom-trailing":r?n:s},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.component,i=t.position||"manual",o=t.index,n=this._positionNameToContainerLookup[i],s=o>-1;var r;if((r=e.widget)&&!r._started&&"function"==typeof r.postMixInProperties&&"function"==typeof r.buildRendering&&"function"==typeof r.postCreate&&"function"==typeof r.startup&&e.widget.startup(),!s)return void n.appendChild(e.node);const d=Array.prototype.slice.call(n.children);if(0===o)return void(n.firstChild?c(e.node,n.firstChild):n.appendChild(e.node));o>=d.length?n.appendChild(e.node):c(e.node,d[o])}_applyViewPadding(){const t=this.container;t&&x(t,this._toPxPosition(this._getViewPadding()))}_applyUIPadding(){const t=this._innerContainer;t&&x(t,this._toPxPosition(this.padding))}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let e,i=null;return this._components.some((o=>(e=o===t,e&&(i=o),e))),i}_findById(t){let e,i=null;return this._components.some((o=>(e=o.id===t,e&&(i=o),e))),i}_findByNode(t){let e,i=null;return this._components.some((o=>(e=o.node===t,e&&(i=o),e))),i}};t([e()],N.prototype,"container",null),t([e()],N.prototype,"height",null),t([e({value:_})],N.prototype,"padding",null),t([s("padding")],N.prototype,"castPadding",null),t([e()],N.prototype,"view",void 0),t([e()],N.prototype,"width",null),N=t([o("esri.views.ui.UI")],N);var T=N;export default T;export{m as C};
