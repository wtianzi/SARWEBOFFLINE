/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import{_ as e}from"./tslib.es6.js";import"../core/lang.js";import{i as t}from"./Logger.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"./ensureType.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import{E as n}from"./Evented.js";import"../core/urlUtils.js";import"./resourceExtension.js";import s from"../core/Handles.js";import{watch as r,pausable as a}from"../core/watchUtils.js";let c=class extends n.EventedAccessor{constructor(e){super(e),this._anchorHandles=new s,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([r(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),r(this,["view","view.ready"],(()=>this._wireUpView()))])}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=a(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint()}_viewpointChange(){this._setScreenLocation(),this.emit("view-change")}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint()}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause()}_setScreenLocation(){const{location:e,view:o,screenLocationEnabled:i}=this,n=this.get("view.ready"),s=i&&n&&t(e)?o.toScreen(e):null;this._set("screenLocation",s)}};e([o()],c.prototype,"location",void 0),e([o({readOnly:!0})],c.prototype,"screenLocation",void 0),e([o()],c.prototype,"screenLocationEnabled",void 0),e([o()],c.prototype,"view",void 0),c=e([i("esri.widgets.support.AnchorElementViewModel")],c);var l=c;export{l as A};
