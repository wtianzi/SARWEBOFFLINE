/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import"../core/lang.js";import{d as e,t,a as s,B as r,f as i,e as n,c as a,i as u,u as h,b as f,h as c,v as d,w as l,g as p,k as o,x as F,s as m,q as w,r as y,l as b,j as v}from"./BufferView.js";function g(e){switch(e){case"u8":return 1;case"u16":return 2;case"u32":return 4;case"i8":return 1;case"i16":return 2;case"i32":case"f32":return 4;case"f64":return 8;default:return}}function B(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function N(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function T(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}class A{constructor(e,t){this.layout=e,this.buffer="number"==typeof t?new ArrayBuffer(t*e.stride):t;for(const t of e.fieldNames){const s=e.fields.get(t);this[t]=new s.constructor(this.buffer,s.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(e,t){const s=this[e];return s&&s.elementCount===t.ElementCount&&s.elementType===t.ElementType?s:null}slice(e,t){return new A(this.layout,this.buffer.slice(e*this.stride,t*this.stride))}copyFrom(e,t,s,r){const i=this.stride;if(i%4==0){const n=new Uint32Array(e.buffer,t*i,r*i/4);new Uint32Array(this.buffer,s*i,r*i/4).set(n)}else{const n=new Uint8Array(e.buffer,t*i,r*i);new Uint8Array(this.buffer,s*i,r*i).set(n)}}}class E{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(t,s){return this.appendField(t,e,s),this}vec2f64(e,s){return this.appendField(e,t,s),this}vec3f(e,t){return this.appendField(e,s,t),this}vec3f64(e,t){return this.appendField(e,r,t),this}vec4f(e,t){return this.appendField(e,i,t),this}vec4f64(e,t){return this.appendField(e,n,t),this}mat3f(e,t){return this.appendField(e,a,t),this}mat3f64(e,t){return this.appendField(e,u,t),this}mat4f(e,t){return this.appendField(e,h,t),this}mat4f64(e,t){return this.appendField(e,f,t),this}vec4u8(e,t){return this.appendField(e,c,t),this}f32(e,t){return this.appendField(e,d,t),this}f64(e,t){return this.appendField(e,l,t),this}u8(e,t){return this.appendField(e,p,t),this}u16(e,t){return this.appendField(e,o,t),this}i8(e,t){return this.appendField(e,F,t),this}vec2i8(e,t){return this.appendField(e,m,t),this}vec2i16(e,t){return this.appendField(e,w,t),this}vec2u8(e,t){return this.appendField(e,y,t),this}vec4u16(e,t){return this.appendField(e,b,t),this}u32(e,t){return this.appendField(e,v,t),this}appendField(e,t,s){const r=t.ElementCount*g(t.ElementType),i=this.stride;this.fields.set(e,{size:r,constructor:t,offset:i,optional:s}),this.stride+=r,this.fieldNames.push(e)}alignTo(e){return this.stride=Math.floor((this.stride+e-1)/e)*e,this}hasField(e){return this.fieldNames.indexOf(e)>=0}createBuffer(e){return new A(this,e)}createView(e){return new A(this,e)}clone(){const e=new E;return e.stride=this.stride,e.fields=new Map,this.fields.forEach(((t,s)=>e.fields.set(s,t))),e.fieldNames=this.fieldNames.slice(),e.BufferType=this.BufferType,e}}function U(){return new E}export{B as a,g as e,N as i,T as m,U as n};
