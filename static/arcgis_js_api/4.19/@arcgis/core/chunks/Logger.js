/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
import"../core/lang.js";import e from"../config.js";import{n as r}from"./string.js";const t=null;function n(e){return null!=e}function o(e){return null==e}function s(e){return void 0===e}function i(e,r){return n(e)?r(e):null}function l(e){return e}function u(e,r){if(o(e))throw new Error(r);return e}function c(e,r){return n(e)?e:"function"==typeof r?r():r}function a(e){return n(e)&&e.destroy(),null}function g(e){return n(e)&&e.dispose(),null}function h(e){return n(e)&&e.remove(),null}function f(e){return n(e)&&e.abort(),null}function _(e){return n(e)&&e.release(),null}function d(e){return null}function w(e,r){const t=new Array;return e.forEach((e=>{const o=r(e);n(o)&&t.push(o)})),t}function m(e,r){const t=new Array;for(const n of e)t.push(k(n,null,r));return t}function p(e,r){for(const t of e)k(t,null,r)}function k(e,r,t){return n(e)?t(e):r}function y(e,r){return n(e)?r(e):null}function v(e){return e.filter((e=>n(e)))}function M(e,...r){let t=e,n=0;for(;n<r.length&&t;)t=t[r[n++]];return t}function b(e){return e}const T={info:0,warn:1,error:2,none:3};class C{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,C._loggers[this.module]=this;const r=this.module.lastIndexOf(".");-1!==r&&(this._parent=C.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(e={}){const r=C._loggers;return C._loggers=e,r},set throttlingDisabled(e){C._throttlingDisabled=e}}}static getLogger(e){let r=C._loggers[e];return r||(r=new C({module:e})),r}_log(r,t,...n){if(!this._matchLevel(r))return;if("always"!==t&&!C._throttlingDisabled){const e=this._argsToKey(n),o=this._loggedMessages[r].get(e);if("once"===t&&null!=o||"oncePerTick"===t&&o&&o>=C._tickCounter)return;this._loggedMessages[r].set(e,C._tickCounter),C._scheduleTickCounterIncrement()}for(const t of e.log.interceptors)if(t(r,this.module,...n))return;this._inheritedWriter()(r,this.module,...n)}_parentWithMember(e,r){let t=this;for(;n(t);){const r=t[e];if(n(r))return r;t=t.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,r,...t){console[e](`[${r}]`,...t)}_matchLevel(r){const t=e.log.level?e.log.level:"warn";return T[this._parentWithMember("level",t)]<=T[r]}_argsToKey(...e){return r(JSON.stringify(e,((e,r)=>"object"!=typeof r||Array.isArray(r)?r:"[Object]")))}static _scheduleTickCounterIncrement(){C._tickCounterScheduled||(C._tickCounterScheduled=!0,Promise.resolve().then((()=>{C._tickCounter++,C._tickCounterScheduled=!1})))}}C._loggers={},C._tickCounter=0,C._tickCounterScheduled=!1,C._throttlingDisabled=!1;export{C as L,b as a,o as b,c,a as d,i as e,g as f,M as g,f as h,n as i,t as j,_ as k,v as l,p as m,d as n,s as o,k as p,y as q,h as r,m as s,u as t,l as u,w as v};
