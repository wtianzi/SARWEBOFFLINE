self.webpackChunkRemoteClient([163],{27:function(e,t,r){"use strict";r.r(t),r.d(t,"l",(function(){return d})),r.d(t,"r",(function(){return S}));var n=r(1),o=(r(4),r(18)),s=r(6),a=r(0),i=(r(9),r(2)),c=(r(10),r(8)),l=r(14);const u=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function d(e,t,r=!1,o){return new Promise((s,c)=>{if(Object(i.n)(o))return void c(h());let l=()=>{p(),c(new Error("Unable to load "+t))},u=()=>{const t=e;p(),s(t)},d=()=>{if(!e)return;const t=e;p(),t.src="",c(h())};const p=()=>{Object(n.i)("esri-image-decode")||(e.removeEventListener("error",l),e.removeEventListener("load",u)),l=null,u=null,e=null,Object(a.h)(o)&&o.removeEventListener("abort",d),d=null,r&&URL.revokeObjectURL(t)};Object(a.h)(o)&&o.addEventListener("abort",d),Object(n.i)("esri-image-decode")?e.decode().then(u,l):(e.addEventListener("error",l),e.addEventListener("load",u))})}function h(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}async function p(e,t){const d=Object(l.u)(e),h=Object(l.t)(e);h||d||(e=Object(l.B)(e));const w={url:e,requestOptions:{...Object(a.p)(t)}};let O=Object(l.l)(e);if(O){const e=await async function(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let r,n;try{n=await e.before(t)}catch(e){r=j("request:interceptor",e,t)}if((n instanceof Error||n instanceof c.a)&&(r=j("request:interceptor",n,t)),r)throw e.error&&e.error(r),r;return n}}(O,w);if(null!=e)return{data:e,getHeader:g,requestOptions:w.requestOptions,url:w.url};O.after||O.error||(O=null)}if(e=w.url,"image"===(t=w.requestOptions).responseType){if(Object(n.i)("host-webworker")||Object(n.i)("host-node"))throw j("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),w)}else if(d)throw j("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+t.responseType),w);if("head"===t.method){if(t.body)throw j("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),w);if(d||h)throw j("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),w)}if(await async function(){Object(n.i)("host-webworker")?m||(m=await r.e(143).then(r.bind(null,438))):p._abortableFetch||(p._abortableFetch=n.h.fetch.bind(n.h))}(),m)return m.execute(e,t);const y=Object(i.d)();Object(i.q)(t,()=>y.abort());const E={controller:y,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:O,params:w,redoRequest:!1,useIdentity:f.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},x=await async function(e){let t,r;await async function(e){const t=e.params.url,r=e.params.requestOptions,a=e.controller.signal,c=r.body;let d=null,h=null,m=null;if(b&&"HTMLFormElement"in n.h&&(c instanceof FormData?d=c:c instanceof HTMLFormElement&&(h=c,d=new FormData(h))),"string"==typeof c&&(m=c),e.fetchOptions={cache:r.cacheBust&&!p._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},method:"head"===r.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:a},(d||m)&&(e.fetchOptions.body=d||m),"anonymous"===r.authMode&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||r.query&&r.query.token||d&&d.get&&d.get("token")||h&&h.elements.token),!e.hasToken&&s.a.apiKey&&function(e){const t=Object(l.m)(e,!0);return t&&t.endsWith(".arcgis.com")&&!u.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}(t)&&(r.query||(r.query={}),r.query.token=s.a.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!k(t)&&!Object(i.n)(a)){let n;"immediate"===r.authMode?(await q(),n=await o.c.getCredential(t,{signal:a}),e.credential=n):"no-prompt"===r.authMode?(await q(),n=await o.c.getCredential(t,{prompt:!1,signal:a}).catch(()=>{}),e.credential=n):o.c&&(n=o.c.findCredential(t)),n&&(e.credentialToken=n.token,e.useSSL=!!n.ssl)}}(e);try{do{[t,r]=await T(e)}while(!await v(e,t,r))}catch(r){const n=j("request:server",r,e.params,t);throw n.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(n),n}const a=e.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(a)&&!e.hasToken&&!e.credentialToken&&r&&r.user&&r.user.username&&!Object(l.w)(a)){const e=Object(l.m)(a,!0);e&&f.trustedServers.push(e)}const c=e.credential;if(c&&o.c){const e=o.c.findServerInfo(c.server);let t=e&&e.owningSystemUrl;if(t){t=t.replace(/\/?$/,"/sharing");const e=o.c.findCredential(t,c.userId);e&&-1===o.c._getIdenticalSvcIdx(t,e)&&e.resources.unshift(t)}}return{data:r,getHeader:t?e=>t.headers.get(e):g,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}(E);return O&&O.after&&O.after(x),x}let m;const f=s.a.request,b="FormData"in n.h,w=[499,498,403,401],O=["COM_0056","COM_0057","SB_0008"],y=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],g=()=>null;function j(e,t,r,o){let s="Error";const a={url:r.url,requestOptions:r.requestOptions,getHeader:g,ssl:!1};if(t instanceof c.a)return t.details?(t.details=Object(n.b)(t.details),t.details.url=r.url,t.details.requestOptions=r.requestOptions):t.details=a,t;if(t){const e=o&&(e=>o.headers.get(e)),r=o&&o.status,n=t.message;n&&(s=n),e&&(a.getHeader=e),a.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||r||0,a.subCode=t.subcode,a.messageCode=t.messageCode,"string"==typeof t.details?a.messages=[t.details]:a.messages=t.details}return Object(i.m)(t)?Object(i.e)():new c.a(e,s,a)}async function q(){o.c||await r.e(44).then(r.bind(null,449))}function k(e){return y.some(t=>t.test(e))}async function T(e){let t=e.params.url;const r=e.params.requestOptions,s=e.fetchOptions,a=Object(l.t)(t)||Object(l.u)(t),c=r.responseType||"json",u=a?0:null!=r.timeout?r.timeout:f.timeout;let d=!1;if(!a){e.useSSL&&(t=Object(l.H)(t)),r.cacheBust&&"default"===s.cache&&(t=Object(l.d)(t,"request.preventCache",Date.now()));let a={...r.query};e.credentialToken&&(a.token=e.credentialToken);let i=Object(l.C)(a);Object(n.i)("esri-url-encodes-apostrophe")&&(i=i.replace(/'/g,"%27"));const c=t.length+1+i.length;let u;d="delete"===r.method||"post"===r.method||"put"===r.method||!!r.body||c>f.maxUrlLength;const h=r.useProxy||!!Object(l.o)(t);if(h){const e=Object(l.p)(t);u=e.path,!d&&u.length+1+c>f.maxUrlLength&&(d=!0),e.query&&(a={...e.query,...a})}if("HEAD"===s.method&&(d||h)){if(d){if(c>f.maxUrlLength)throw j("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw j("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(h)throw j("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(d?(s.method="delete"===r.method?"DELETE":"put"===r.method?"PUT":"POST",r.body?t=Object(l.e)(t,a):(s.body=Object(l.C)(a),s.headers["Content-Type"]="application/x-www-form-urlencoded")):t=Object(l.e)(t,a),h&&(e.useProxy=!0,t=`${u}?${t}`),a.token&&b&&s.body instanceof FormData){const e=s.body;e.set?e.set("token",a.token):e.append("token",a.token)}if(r.hasOwnProperty("withCredentials"))e.withCredentials=r.withCredentials;else if(!Object(l.q)(t,l.g))if(Object(l.w)(t))e.withCredentials=!0;else if(o.c){const r=o.c.findServerInfo(t);r&&r.webTierAuth&&(e.withCredentials=!0)}e.withCredentials&&(s.credentials="include")}let h,m,w=0,O=!1;u>0&&(w=setTimeout(()=>{O=!0,e.controller.abort()},u));try{if("image"!==r.responseType||"default"!==s.cache||"GET"!==s.method||d||function(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0;return!1}(r.headers)||!a&&!e.useProxy&&f.proxyUrl&&!function(e){const t=Object(l.m)(e);return!t||t.endsWith(".arcgis.com")||-1!==p._corsServers.indexOf(t)||Object(l.w)(t)}(t)){if(h=await p._abortableFetch(t,s),e.useProxy||function(e){if(Object(l.t)(e)||Object(l.u)(e))return;const t=Object(l.m)(e);t&&-1===p._corsServers.indexOf(t)&&p._corsServers.push(t)}(t),h.ok&&"HEAD"!==s.method){switch(c){case"array-buffer":m=await h.arrayBuffer();break;case"blob":case"image":m=await h.blob();break;default:m=await h.text()}if(w&&(clearTimeout(w),w=0),"json"===c||"xml"===c||"document"===c)if(m)switch(c){case"json":m=JSON.parse(m);break;case"xml":m=E(m,"application/xml");break;case"document":m=E(m,"text/html")}else m=null;if(m){if("array-buffer"===c||"blob"===c){const e=h.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(e)&&m["blob"===c?"size":"byteLength"]<=750)try{const e=await new Response(m).json();e.error&&(m=e)}catch{}}"image"===c&&m instanceof Blob&&(m=await x(URL.createObjectURL(m),e,!0))}}}else m=await x(t,e)}catch(n){if("AbortError"===n.name){if(O)throw new Error("Timeout exceeded");throw Object(i.e)("Request canceled")}if(!(!h&&n instanceof TypeError&&f.proxyUrl)||r.body||"delete"===r.method||"head"===r.method||"post"===r.method||"put"===r.method||e.useProxy)throw n;e.redoRequest=!0,Object(l.c)({proxyUrl:f.proxyUrl,urlPrefix:Object(l.E)(Object(l.I)(t).path)})}finally{w&&clearTimeout(w)}return[h,m]}function E(e,t){let r;try{r=(new DOMParser).parseFromString(e,t)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}async function v(e,t,r){if(e.redoRequest)return e.redoRequest=!1,!1;if(!t)return!0;if(!t.ok)throw new Error(`Unable to load ${t.url} status: ${t.status}`);let n,s,a,i;r&&r.error&&(n=Object.assign(new Error,r.error)),n&&(s=Number(n.code),a=n.hasOwnProperty("subcode")?Number(n.subcode):null,i=n.messageCode,i=i&&i.toUpperCase());const c=e.params.requestOptions.authMode;if(403===s&&(4===a||n.message&&n.message.toLowerCase().indexOf("ssl")>-1&&-1===n.message.toLowerCase().indexOf("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&("no-prompt"!==c||498===s)&&-1!==w.indexOf(s)&&!k(e.params.url)&&(403!==s||-1===O.indexOf(i)&&(null==a||2===a&&e.credentialToken))){await q();try{const t=await o.c.getCredential(e.params.url,{error:j("request:server",n,e.params),prompt:"no-prompt"!==c,signal:e.controller.signal,token:e.credentialToken});return e.credential=t,e.credentialToken=t.token,e.useSSL=e.useSSL||t.ssl,!1}catch(t){if("no-prompt"===c)return e.credential=null,e.credentialToken=null,!1;n=t}}if(n)throw n;return!0}function x(e,t,r=!1){const n=t.controller.signal,o=new Image;return t.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.src=e,d(o,e,r,n)}p._abortableFetch=null,p._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];var S=Object.freeze({__proto__:null,default:p});t.default=p}});