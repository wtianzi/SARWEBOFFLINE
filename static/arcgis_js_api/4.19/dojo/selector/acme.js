//>>built
define(["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],function(Q,u,H,I,B){var R=I.trim,N=H.forEach,S="BackCompat"==B.doc.compatMode,v=!1,C=function(){return!0},O=function(a){a=0<="\x3e~+".indexOf(a.slice(-1))?a+" * ":a+" ";for(var b=function(J,ia){return R(a.slice(J,ia))},c=[],d=-1,e=-1,g=-1,k=-1,f=-1,h=-1,n=-1,m,r="",q="",T,p=0,ja=a.length,l=null,t=null,D=function(){0<=h&&(l.id=b(h,p).replace(/\\/g,""),h=-1);if(0<=n){var J=n==p?null:b(n,p);l[0>"\x3e~+".indexOf(J)?"tag":
"oper"]=J;n=-1}0<=f&&(l.classes.push(b(f+1,p).replace(/\\/g,"")),f=-1)};r=q,q=a.charAt(p),p<ja;p++)"\\"!=r&&(l||(T=p,l={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return v?this.otag:this.tag}},n=p),m?q==m&&(m=null):"'"==q||'"'==q?m=q:0<=d?"]"==q?(t.attr?t.matchFor=b(g||d+1,p):t.attr=b(d+1,p),!(d=t.matchFor)||'"'!=d.charAt(0)&&"'"!=d.charAt(0)||(t.matchFor=d.slice(1,-1)),t.matchFor&&(t.matchFor=t.matchFor.replace(/\\/g,"")),l.attrs.push(t),t=null,d=g=-1):
"\x3d"==q&&(g=0<="|~^$*".indexOf(r)?r:"",t.type=g+q,t.attr=b(d+1,p-g.length),g=p+1):0<=e?")"==q&&(0<=k&&(t.value=b(e+1,p)),k=e=-1):"#"==q?(D(),h=p+1):"."==q?(D(),f=p):":"==q?(D(),k=p):"["==q?(D(),d=p,t={}):"("==q?(0<=k&&(t={name:b(k+1,p),value:null},l.pseudos.push(t)),e=p):" "==q&&r!=q&&(D(),0<=k&&l.pseudos.push({name:b(k+1,p)}),l.loops=l.pseudos.length||l.attrs.length||l.classes.length,l.oquery=l.query=b(T,p),l.otag=l.tag=l.oper?null:l.tag||"*",l.tag&&(l.tag=l.tag.toUpperCase()),c.length&&c[c.length-
1].oper&&(l.infixOper=c.pop(),l.query=l.infixOper.query+" "+l.query),c.push(l),l=null));return c},y=function(a,b){return a?b?function(){return a.apply(window,arguments)&&b.apply(window,arguments)}:a:b},E=function(a,b){b=b||[];a&&b.push(a);return b},K=function(a){return 1==a.nodeType},z=function(a,b){return a?"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(v?a.getAttribute(b):a.getAttribute(b,2))||"":""},U={"*\x3d":function(a,b){return function(c){return 0<=z(c,a).indexOf(b)}},
"^\x3d":function(a,b){return function(c){return 0==z(c,a).indexOf(b)}},"$\x3d":function(a,b){return function(c){c=" "+z(c,a);var d=c.lastIndexOf(b);return-1<d&&d==c.length-b.length}},"~\x3d":function(a,b){var c=" "+b+" ";return function(d){return 0<=(" "+z(d,a)+" ").indexOf(c)}},"|\x3d":function(a,b){var c=b+"-";return function(d){d=z(d,a);return d==b||0==d.indexOf(c)}},"\x3d":function(a,b){return function(c){return z(c,a)==b}}};I=B.doc.documentElement;var L=!(I.nextElementSibling||"nextElementSibling"in
I),F=L?"nextSibling":"nextElementSibling",ka=L?"previousSibling":"previousElementSibling",G=L?K:C,V=function(a){for(;a=a[ka];)if(G(a))return!1;return!0},W=function(a){for(;a=a[F];)if(G(a))return!1;return!0},M=function(a){var b=a.parentNode;b=7!=b.nodeType?b:b.nextSibling;var c=0,d=b.children||b.childNodes,e=a._i||a.getAttribute("_i")||-1,g=b._l||("undefined"!==typeof b.getAttribute?b.getAttribute("_l"):-1);if(!d)return-1;d=d.length;if(g==d&&0<=e&&0<=g)return e;u("ie")&&"undefined"!==typeof b.setAttribute?
b.setAttribute("_l",d):b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[F])G(b)&&(u("ie")?b.setAttribute("_i",++c):b._i=++c,a===b&&(e=c));return e},la=function(a){return!(M(a)%2)},ma=function(a){return M(a)%2},X={checked:function(a,b){return function(c){return!("checked"in c?!c.checked:!c.selected)}},disabled:function(a,b){return function(c){return c.disabled}},enabled:function(a,b){return function(c){return!c.disabled}},"first-child":function(){return V},"last-child":function(){return W},
"only-child":function(a,b){return function(c){return V(c)&&W(c)}},empty:function(a,b){return function(c){var d=c.childNodes;for(c=c.childNodes.length-1;0<=c;c--){var e=d[c].nodeType;if(1===e||3==e)return!1}return!0}},contains:function(a,b){a=b.charAt(0);if('"'==a||"'"==a)b=b.slice(1,-1);return function(c){return 0<=c.innerHTML.indexOf(b)}},not:function(a,b){a=O(b)[0];b={el:1};"*"!=a.tag&&(b.tag=1);a.classes.length||(b.classes=1);var c=w(a,b);return function(d){return!c(d)}},"nth-child":function(a,
b){a=parseInt;if("odd"==b)return ma;if("even"==b)return la;if(-1!=b.indexOf("n")){b=b.split("n",2);var c=b[0]?"-"==b[0]?-1:a(b[0]):1,d=b[1]?a(b[1]):0,e=0,g=-1;0<c?0>d?d=d%c&&c+d%c:0<d&&(d>=c&&(e=d-d%c),d%=c):0>c&&(c*=-1,0<d&&(g=d,d%=c));if(0<c)return function(f){f=M(f);return f>=e&&(0>g||f<=g)&&f%c==d};b=d}var k=a(b);return function(f){return M(f)==k}}},na=9>u("ie")||(u("ie"),0)?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return v?c.getAttribute(a):c[a]||c[b]}}:
function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},w=function(a,b){if(!a)return C;b=b||{};var c=null;"el"in b||(c=y(c,K));"tag"in b||"*"!=a.tag&&(c=y(c,function(d){return d&&(v?d.tagName:d.tagName.toUpperCase())==a.getTag()}));"classes"in b||N(a.classes,function(d,e,g){var k=new RegExp("(?:^|\\s)"+d+"(?:\\s|$)");c=y(c,function(f){return k.test(f.className)});c.count=e});"pseudos"in b||N(a.pseudos,function(d){var e=d.name;X[e]&&(c=y(c,X[e](e,d.value)))});"attrs"in b||N(a.attrs,
function(d){var e,g=d.attr;d.type&&U[d.type]?e=U[d.type](g,d.matchFor):g.length&&(e=na(g));e&&(c=y(c,e))});"id"in b||a.id&&(c=y(c,function(d){return!!d&&d.id==a.id}));c||"default"in b||(c=C);return c},oa=function(a){return function(b,c,d){for(;b=b[F];)if(!L||K(b)){d&&!A(b,d)||!a(b)||c.push(b);break}return c}},pa=function(a){return function(b,c,d){for(b=b[F];b;){if(G(b)){if(d&&!A(b,d))break;a(b)&&c.push(b)}b=b[F]}return c}},Y=function(a,b){var c=function(d){var e=[];try{e=Array.prototype.slice.call(d)}catch(f){for(var g=
0,k=d.length;g<k;g++)e.push(d[g])}return e};a=a||C;return function(d,e,g){var k=0,f=[];f=c(d.children||d.childNodes);for(b&&H.forEach(f,function(h){1===h.nodeType&&(f=f.concat(c(h.getElementsByTagName("*"))))});d=f[k++];)G(d)&&(!g||A(d,g))&&a(d,k)&&e.push(d);return e}},Z=function(a,b){for(a=a.parentNode;a&&a!=b;)a=a.parentNode;return!!a},aa={},ba=function(a){var b=aa[a.query];if(b)return b;var c=a.infixOper;c=c?c.oper:"";var d=w(a,{el:1}),e="*"==a.tag,g=B.doc.getElementsByClassName;if(c)g={el:1},
e&&(g.tag=1),d=w(a,g),"+"==c?b=oa(d):"~"==c?b=pa(d):"\x3e"==c&&(b=Y(d));else if(a.id)d=!a.loops&&e?C:w(a,{el:1,id:1}),b=function(f,h){var n=Q.byId(a.id,f.ownerDocument||f);f.ownerDocument&&!Z(f,f.ownerDocument)&&H.some(11===f.nodeType?f.childNodes:[f],function(m){m=Y(function(r){return r.id===a.id},!0)(m,[]);if(m.length)return n=m[0],!1});if(n&&d(n)&&(9==f.nodeType||Z(n,f)))return E(n,h)};else if(g&&/\{\s*\[native code\]\s*\}/.test(String(g))&&a.classes.length&&!S){d=w(a,{el:1,classes:1,id:1});var k=
a.classes.join(" ");b=function(f,h,n){h=E(0,h);for(var m,r=0,q=f.getElementsByClassName(k);m=q[r++];)d(m,f)&&A(m,n)&&h.push(m);return h}}else e||a.loops?(d=w(a,{el:1,tag:1,id:1}),b=function(f,h,n){h=E(0,h);for(var m,r=0,q=(m=a.getTag())?f.getElementsByTagName(m):[];m=q[r++];)d(m,f)&&A(m,n)&&h.push(m);return h}):b=function(f,h,n){h=E(0,h);var m=0,r=a.getTag();for(r=r?f.getElementsByTagName(r):[];f=r[m++];)A(f,n)&&h.push(f);return h};return aa[a.query]=b},ca={},da={},ea=function(a){var b=O(R(a));if(1==
b.length){var c=ba(b[0]);return function(d){if(d=c(d,[]))d.nozip=!0;return d}}return function(d){d=E(d);for(var e,g,k=b.length,f,h,n=0;n<k;n++){h=[];e=b[n];g=d.length-1;0<g&&(f={},h.nozip=!0);g=ba(e);for(var m=0;e=d[m];m++)g(e,h,f);if(!h.length)break;d=h}return h}},qa=u("ie")?"commentStrip":"nozip",fa=!!B.doc.querySelectorAll,ra=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,sa=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},ta=/([^[]*)([^\]]*])?/g,ua=function(a,b,c){return b.replace(ra,sa)+
(c||"")},ha=function(a,b){a=a.replace(ta,ua);if(fa){var c=da[a];if(c&&!b)return c}if(c=ca[a])return c;c=a.charAt(0);var d=-1==a.indexOf(" ");0<=a.indexOf("#")&&d&&(b=!0);if(!fa||b||-1!="\x3e~+".indexOf(c)||u("ie")&&-1!=a.indexOf(":")||S&&0<=a.indexOf(".")||-1!=a.indexOf(":contains")||-1!=a.indexOf(":checked")||-1!=a.indexOf("|\x3d")){var e=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return ca[a]=2>e.length?ea(a):function(k){for(var f=0,h=[],n;n=e[f++];)h=h.concat(ea(n)(k));return h}}var g=
0<="\x3e~+".indexOf(a.charAt(a.length-1))?a+" *":a;return da[a]=function(k){if(9==k.nodeType||d)try{var f=k.querySelectorAll(g);f[qa]=!0;return f}catch(h){}return ha(a,!0)(k)}},x=0,va=u("ie")?function(a){return v?a.getAttribute("_uid")||a.setAttribute("_uid",++x)||x:a.uniqueID}:function(a){return a._uid||(a._uid=++x)},A=function(a,b){if(!b)return 1;a=va(a);return b[a]?0:b[a]=1},wa=function(a){if(a&&a.nozip)return a;if(!a||!a.length)return[];if(2>a.length)return[a[0]];var b=[];x++;var c,d;if(u("ie")&&
v){var e=x+"";for(c=0;c<a.length;c++)(d=a[c])&&d.getAttribute("_zipIdx")!=e&&(b.push(d),d.setAttribute("_zipIdx",e))}else if(u("ie")&&a.commentStrip)try{for(c=0;c<a.length;c++)(d=a[c])&&K(d)&&b.push(d)}catch(g){}else for(c=0;c<a.length;c++)(d=a[c])&&d._zipIdx!=x&&(b.push(d),d._zipIdx=x);return b},P=function(a,b){b=b||B.doc;v="div"===(b.ownerDocument||b).createElement("div").tagName;return(a=ha(a)(b))&&a.nozip?a:wa(a)};P.filter=function(a,b,c){var d=[],e=O(b);e=1!=e.length||/[^\w#\.]/.test(b)?function(f){return-1!=
H.indexOf(P(b,Q.byId(c)),f)}:w(e[0]);for(var g=0,k;k=a[g];g++)e(k)&&d.push(k);return d};return P});