// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../core/mathUtils ./vec3f64 ./vec3 ../core/ObjectStack ../views/3d/support/stack".split(" "),function(k,t,p,e,u,l){function r(b){return b?{origin:p.clone(b.origin),vector:p.clone(b.vector)}:{origin:p.create(),vector:p.create()}}function v(b,a){const c=K.get();c.origin=b;c.vector=a;return c}function B(b,a=r()){return w(b.origin,b.vector,a)}function w(b,a,c=r()){e.copy(c.origin,b);e.copy(c.vector,a);return c}function C(b,a,c=r()){e.copy(c.origin,b);e.subtract(c.vector,a,b);return c}
function x(b,a){a=e.subtract(l.sv3d.get(),a,b.origin);var c=e.dot(b.vector,a);const m=e.dot(b.vector,b.vector);c=t.clamp(c/m,0,1);b=e.subtract(l.sv3d.get(),e.scale(l.sv3d.get(),b.vector,c),a);return e.dot(b,b)}function D(b,a){return Math.sqrt(x(b,a))}function E(b,a,c){return y(b,a,0,1,c)}function F(b,a,c){return e.add(c,b.origin,e.scale(c,b.vector,a))}function y(b,a,c,m,h){const {vector:f,origin:d}=b;a=e.subtract(l.sv3d.get(),a,d);a=e.dot(f,a)/e.squaredLength(f);e.scale(h,f,t.clamp(a,c,m));return e.add(h,
h,b.origin)}function G(b,a){if(z(b,v(a.origin,a.direction),!1,q)){const {tA:c,pB:m,distance2:h}=q;if(0<=c&&1>=c)return h;if(0>c)return e.squaredDistance(b.origin,m);if(1<c)return e.squaredDistance(e.add(l.sv3d.get(),b.origin,b.vector),m)}return null}function H(b,a,c){return z(b,a,!0,q)?(e.copy(c,q.pA),!0):!1}function I(b,a){return z(b,a,!0,q)?q.distance2:null}function z(b,a,c,m){const h=b.origin;var f=e.add(l.sv3d.get(),h,b.vector);b=a.origin;var d=e.add(l.sv3d.get(),b,a.vector),g=l.sv3d.get();a=
l.sv3d.get();g[0]=h[0]-b[0];g[1]=h[1]-b[1];g[2]=h[2]-b[2];a[0]=d[0]-b[0];a[1]=d[1]-b[1];a[2]=d[2]-b[2];if(1E-6>Math.abs(a[0])&&1E-6>Math.abs(a[1])&&1E-6>Math.abs(a[2]))return!1;d=l.sv3d.get();d[0]=f[0]-h[0];d[1]=f[1]-h[1];d[2]=f[2]-h[2];if(1E-6>Math.abs(d[0])&&1E-6>Math.abs(d[1])&&1E-6>Math.abs(d[2]))return!1;f=g[0]*a[0]+g[1]*a[1]+g[2]*a[2];var n=a[0]*d[0]+a[1]*d[1]+a[2]*d[2];const A=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],J=(d[0]*d[0]+d[1]*d[1]+d[2]*d[2])*A-n*n;if(1E-6>Math.abs(J))return!1;g=(f*n-(g[0]*d[0]+
g[1]*d[1]+g[2]*d[2])*A)/J;f=(f+n*g)/A;c&&(g=t.clamp(g,0,1),f=t.clamp(f,0,1));c=l.sv3d.get();n=l.sv3d.get();c[0]=h[0]+g*d[0];c[1]=h[1]+g*d[1];c[2]=h[2]+g*d[2];n[0]=b[0]+f*a[0];n[1]=b[1]+f*a[1];n[2]=b[2]+f*a[2];m.tA=g;m.tB=f;m.pA=c;m.pB=n;m.distance2=e.squaredDistance(c,n);return!0}const q={tA:0,tB:0,pA:p.create(),pB:p.create(),distance2:0},K=new u.ObjectStack(()=>({origin:null,vector:null}));u=Object.freeze({__proto__:null,create:r,wrap:v,copy:B,fromValues:w,fromPoints:C,distance2:x,distance:D,projectPoint:E,
pointAt:F,projectPointClamp:y,closestRayDistance2:G,closestLineSegmentPoint:H,closestLineSegmentDistance2:I});k.closestLineSegmentDistance2=I;k.closestLineSegmentPoint=H;k.closestRayDistance2=G;k.copy=B;k.create=r;k.distance=D;k.distance2=x;k.fromPoints=C;k.fromValues=w;k.lineSegmentModule=u;k.pointAt=F;k.projectPoint=E;k.projectPointClamp=y;k.wrap=v});