// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../core/Error ./vec3f64 ./vec3 ../geometry/support/aaBoundingRect ../views/3d/terrain/TilingScheme ../views/3d/terrain/TerrainConst".split(" "),function(p,t,l,h,r,u,v){function w(a,d,b=0){a=a.extent;return 0===b?r.containsPoint(a,d):r.containsPointWithMargin(a,d,b*Math.min(a[2]-a[0],a[3]-a[1]))}function m(a,d,b,c){h.copy(n,b);n[c]=d[c];c=h.subtract(n,n,d);var e=h.subtract(z,a,d);e=h.dot(e,c);const k=h.dot(c,c);d=0>=e?d:k<=e?b:h.add(n,d,h.scale(c,c,e/k));a=h.subtract(n,a,d);return Math.PI/
2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+a[1]*a[1]))}function x(a,d){var b=a.elevationBounds;a=a.extent;b=.5*(b.min+b.max);f[0]=a[0];f[1]=a[1];f[2]=b;g[0]=a[2];g[1]=a[3];g[2]=b;a=b=Infinity;d[0]<f[0]?b=m(d,f,g,0):d[0]>g[0]&&(b=m(d,g,f,0));d[1]<f[1]?a=m(d,f,g,1):d[1]>g[1]&&(a=m(d,g,f,1));return Math.min(b,a)}function y(a,d,b){if(a.spatialReference.isGeographic)return new t("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var c=u.checkUnsupported(a);
if(c)return c;{var e=a.lods;c=e[0].resolution*2**e[0].level;var k=[c*a.size[0],c*a.size[1]];const A=[a.origin.x,a.origin.y];b=r.fromExtent(b);const q=r.create();u.computeRowColExtent(b,k,A,q);k=(q[2]-q[0])*(q[3]-q[1]);k>v.MAX_ROOT_TILES?(e=e[0].scale*2**e[0].level,c=Math.max((b[3]-b[1])/a.size[1],(b[2]-b[0])/a.size[0])*e/c,b=Math.floor(Math.log(c)/Math.log(10)),c=Math.ceil(c/10**b)*10**b,c=new t("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(e).toLocaleString()+
") is too large for the layer's extent. Suggested scale: 1:"+c.toLocaleString()+".",{level0Scale:e,suggestedLevel0Scale:c,requiredNumRootTiles:k,allowedNumRootTiles:v.MAX_ROOT_TILES})):c=null}return c?c:d&&!a.spatialReference.equals(d)?new t("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}const n=l.create(),z=l.create(),f=l.create(),g=l.create();l=Object.freeze({__proto__:null,isInsideExtent:w,tiltOnEdge:m,tiltToExtentEdge:x,
checkIfTileInfoSupportedForViewSR:y});p.checkIfTileInfoSupportedForViewSR=y;p.isInsideExtent=w;p.terrainUtilsPlanar=l;p.tiltOnEdge=m;p.tiltToExtentEdge=x});