// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../core/has ../core/maybe ../core/Logger ../core/mathUtils ./vec3f64 ./vec3 ../views/3d/support/mathUtils ./mat4 ./vec4f64 ./vec4 ../views/3d/support/stack ./vector ./ray".split(" "),function(e,C,T,U,V,p,d,D,E,q,W,h,X,r){function t(){return q.create()}function u(a,b=t()){return W.copy(b,a)}function F(a,b){return q.fromValues(a[0],a[1],a[2],b)}function G(a){return a}function H(a){a[0]=a[1]=a[2]=a[3]=0}function I(a){return a}function n(a){return Array.isArray(a)?a[3]:a}function k(a){return Array.isArray(a)?
a:J}function K(a,b,c,f){return q.fromValues(a,b,c,f)}function L(a,b,c){a!==c&&d.copy(c,a);c[3]=a[3]+b;return c}function M(a,b,c){Y.error("sphere.setExtent is not yet supported");return a===c?c:u(a,c)}function l(a,b,c){if(T.isNone(b))return!1;var f=d.subtract(h.sv3d.get(),b.origin,k(a)),g=d.dot(b.direction,b.direction);const m=2*d.dot(b.direction,f);a=d.dot(f,f)-a[3]*a[3];a=m*m-4*g*a;if(0>a)return!1;f=Math.sqrt(a);a=(-m-f)/(2*g);g=(-m+f)/(2*g);if(0>a||g<a&&0<g)a=g;if(0>a)return!1;c&&d.add(c,b.origin,
d.scale(h.sv3d.get(),b.direction,a));return!0}function N(a,b,c,f){b=r.fromScreenAtEye(b,c,Z);return l(a,b,f)}function O(a,b){return l(a,b,null)}function P(a,b,c){if(l(a,b,c))return c;a=v(a,b,h.sv3d.get());d.add(c,b.origin,d.scale(h.sv3d.get(),b.direction,d.distance(b.origin,a)/d.length(b.direction)));return c}function v(a,b,c){const f=h.sv3d.get(),g=h.sm4d.get();d.cross(f,b.origin,b.direction);const m=n(a);d.cross(c,f,b.origin);d.scale(c,c,1/d.length(c)*m);a=w(a,b.origin);b=X.angle(b.origin,c);E.identity(g);
E.rotate(g,g,b+a,f);d.transformMat4(c,c,g);return c}function Q(a,b,c){if(l(a,b,c))return c;r.closestPoint(b,k(a),c);return x(a,c,c)}function x(a,b,c){b=d.subtract(h.sv3d.get(),b,k(a));b=d.scale(h.sv3d.get(),b,a[3]/d.length(b));return d.add(c,b,k(a))}function R(a,b){b=d.subtract(h.sv3d.get(),b,k(a));b=d.squaredLength(b);return Math.sqrt(Math.abs(b-a[3]*a[3]))}function w(a,b){b=d.subtract(h.sv3d.get(),b,k(a));b=d.length(b);a=n(a);return V.acosClamped(a/(a+Math.abs(a-b)))}function y(a,b,c,f){a=d.subtract(z,
b,k(a));switch(c){case 0:return c=D.cartesianToSpherical(a,z)[2],d.set(f,-Math.sin(c),Math.cos(c),0);case 1:return a=D.cartesianToSpherical(a,z),c=a[1],a=a[2],b=Math.sin(c),d.set(f,-b*Math.cos(a),-b*Math.sin(a),Math.cos(c));case 2:return d.normalize(f,a)}}function A(a,b){b=d.subtract(B,b,k(a));return d.length(b)-a[3]}function S(a,b,c,f){const g=A(a,b);a=y(a,b,2,B);c=d.scale(B,a,c-g);d.add(f,b,c);return f}const Y=U.getLogger("esri.views.3d.support.geometryUtils.sphere"),z=p.create(),Z=r.create(),J=
p.create(),B=p.create();Object.freeze(J);C=Object.freeze({__proto__:null,create:t,copy:u,fromCenterAndRadius:F,wrap:G,clear:H,fromRadius:I,getRadius:n,getCenter:k,fromValues:K,elevate:L,setExtent:M,intersectRay:l,intersectScreen:N,intersectsRay:O,intersectRayClosestSilhouette:P,closestPointOnSilhouette:v,closestPoint:Q,projectPoint:x,distanceToSilhouette:R,angleToSilhouette:w,axisAt:y,altitudeAt:A,setAltitudeAt:S});e.altitudeAt=A;e.angleToSilhouette=w;e.axisAt=y;e.clear=H;e.closestPoint=Q;e.closestPointOnSilhouette=
v;e.copy=u;e.create=t;e.distanceToSilhouette=R;e.elevate=L;e.fromCenterAndRadius=F;e.fromRadius=I;e.fromValues=K;e.getCenter=k;e.getRadius=n;e.intersectRay=l;e.intersectRayClosestSilhouette=P;e.intersectScreen=N;e.intersectsRay=O;e.projectPoint=x;e.setAltitudeAt=S;e.setExtent=M;e.sphereModule=C;e.wrap=G});