// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../core/Error","../core/promiseUtils","./locale"],function(e,g,p,h){async function q(a,b){const c=[];for(const k of f)if(l(k.pattern,a))try{return await k.fetchMessageBundle(a,b)}catch(r){c.push(r)}if(c.length)throw new g("intl:message-bundle-error",`Errors occurred while loading "${a}"`,{errors:c});throw new g("intl:no-message-bundle-loader",`No loader found for message bundle "${a}"`);}function l(a,b){return"string"===typeof a?b.startsWith(a):a.test(b)}const m=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,
n=new Set("ar bs ca cs da de el en es et fi fr he hi hr hu id it ja ko lt lv nb nl pl pt-BR pt-PT ro ru sk sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" ")),f=[],d=new Map;h.beforeLocaleChange(()=>{d.clear()});const t=new (function(){function a(){this._numLoading=0}var b=a.prototype;b.waitForAll=async function(){this._dfd&&await this._dfd.promise};b.add=function(c){this._increase();c.then(()=>this._decrease(),()=>this._decrease());return this.waitForAll()};b._increase=function(){this._numLoading++;
this._dfd||(this._dfd=p.createDeferred())};b._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0);this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)};return a}()),u={cache:d,loaders:f};e.fetchMessageBundle=async function(a){const b=h.getLocale();d.has(a)||d.set(a,q(a,b));a=d.get(a);await t.add(a);return a};e.normalizeMessageBundleLocale=function(a){if(!m.test(a))return null;const [,b,c]=m.exec(a);a=b+(c?"-"+c.toUpperCase():"");return n.has(a)?a:n.has(b)?b:null};
e.registerMessageBundleLoader=function(a){if(!f.includes(a)){for(const b of d.keys())l(a.pattern,b)&&d.delete(b);f.unshift(a)}};e.test=u;Object.defineProperty(e,"__esModule",{value:!0})});