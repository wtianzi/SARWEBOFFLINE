// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../../core/screenUtils","./cimSymbolUtils","../cim/CIMSymbolRasterizer"],function(g,n,h,p){const q=new p.CIMSymbolRasterizer(null,!0);g.previewCIMSymbol=async function(a,b={}){const {size:f,maxSize:k,node:l,opacity:m}=b,{feature:r,fieldMap:t,geometryType:u,style:v}=b.cimOptions||b;var c=h.getCIMSymbolSize(a),d=Math.min(null!=f?f:c,null!=k?k:n.px2pt(120));d!==c&&(a=a.clone(),h.scaleCIMSymbolTo(a,d,{preserveOutlineWidth:!0}));c=3;a&&a.data&&a.data.symbol&&"CIMPointSymbol"!==a.data.symbol.type&&
(c=1);var e=await q.rasterizeCIMSymbolAsync(a,r,t,u,{scaleFactor:c,style:v});a=document.createElement("canvas");a.width=e.imageData.width;a.height=e.imageData.height;a.getContext("2d").putImageData(e.imageData,0,0);e=a.width/c;c=a.height/c;if(null==f?0:null!=(null==b?void 0:b.scale)?null==b?0:b.scale:1)b=e/c,e=1>=b?Math.ceil(d*b):d,c=1>=b?d:Math.ceil(d/b);d=new Image(e,c);d.src=a.toDataURL();null!=m&&(d.style.opacity=`${m}`);l&&l.appendChild(d);return d};Object.defineProperty(g,"__esModule",{value:!0})});