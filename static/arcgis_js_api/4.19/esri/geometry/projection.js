// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("require exports ../chunks/_rollupPluginBabelHelpers ../core/maybe ../core/Error ../core/promiseUtils ./support/spatialReferenceUtils ./support/Ellipsoid ./Point ./Extent ./Multipoint ./Polygon ./Polyline ../core/mathUtils ../chunks/vec3f64 ../chunks/vec3 ./projectionEllipsoid ../core/unitUtils ../chunks/mat4 ../chunks/pe ./support/aaBoundingRect ./support/geodesicConstants ./support/GeographicTransformation".split(" "),function(ja,m,Ja,k,Ka,La,x,v,ka,Ma,Na,Oa,Pa,Q,M,N,R,Qa,O,Y,Ra,Sa,S){function la(){return!!z&&
Y.isLoaded()}function ma(a){k.isNone(T)&&(T=Promise.all([Y.load(),(new Promise(function(c,b){ja(["../chunks/geometryEngineBase"],c,b)})).then(function(c){return c.geometryEngineBase}),new Promise(function(c,b){ja(["./geometryAdapters/hydrated"],c,b)})]));return T.then(([,c,{hydratedAdapter:b}])=>{La.throwIfAborted(a);F=b;z=c.default;z._enableProjection(Y.pe)})}function Z(a,c,b,d,e=null){if(k.isNone(b)||k.isNone(d))return c;if(aa(b,d,e))return c.map(f=>Ta(f,b,d));if(k.isNone(e)){const f=S.cacheKey(b,
d);void 0!==U[f]?e=U[f]:(e=na(b,d,null),k.isNone(e)&&(e=new S),U[f]=e)}if(k.isNone(z))throw new ba;return z._project(a,c,b,d,e)}function na(a,c,b=null){if(k.isNone(z))throw new ba;if(k.isNone(a)||k.isNone(c))return null;a=z._getTransformation(F,a,c,b,null==b?void 0:b.spatialReference);return null!==a?S.fromGE(a):null}function aa(a,c,b){return b?!1:x.equals(a,c)?!0:x.isValid(a)&&x.isValid(c)&&!!ca(a,c,da)}function Ta(a,c,b){if(!a)return a;if("x"in a){var d=new ka;return oa(a,c,d,b)?d:null}return"xmin"in
a?(d=new Ma,pa(a,c,d,b)?d:null):"rings"in a?(d=new Oa,qa(a,c,d,b)?d:null):"paths"in a?(d=new Pa,ra(a,c,d,b)?d:null):"points"in a?(d=new Na,sa(a,c,d,b)?d:null):null}function oa(a,c,b,d,e=0){l[0]=a.x;l[1]=a.y;const f=a.z;l[2]=void 0!==f?f:e;if(!y(l,c,0,l,d,0,1))return!1;b.x=l[0];b.y=l[1];b.spatialReference=d;void 0===f?(b.z=void 0,b.hasZ=!1):(b.z=l[2],b.hasZ=!0);void 0===a.m?(b.m=void 0,b.hasM=!1):(b.m=a.m,b.hasM=!0);return!0}function sa(a,c,b,d,e=0){const {points:f,hasZ:g,hasM:h}=a;a=[];const r=f.length,
q=[];for(var p of f)q.push(p[0],p[1],g?p[2]:e);if(!y(q,c,0,q,d,0,r))return!1;for(c=0;c<r;++c){e=3*c;p=q[e];const u=q[e+1];g&&h?a.push([p,u,q[e+2],f[c][3]]):g?a.push([p,u,q[e+2]]):h?a.push([p,u,f[c][2]]):a.push([p,u])}b.points=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;return!0}function ra(a,c,b,d,e=0){const {paths:f,hasZ:g,hasM:h}=a;a=[];if(!ta(f,g,h,c,a,d,e))return!1;b.paths=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;return!0}function qa(a,c,b,d,e=0){const {rings:f,hasZ:g,hasM:h}=a;a=[];if(!ta(f,g,h,
c,a,d,e))return!1;b.rings=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;return!0}function pa(a,c,b,d,e=0){const {xmin:f,ymin:g,xmax:h,ymax:r,hasZ:q,hasM:p}=a;if(!ea(f,g,q?a.zmin:e,c,l,d))return!1;b.xmin=l[0];b.ymin=l[1];q&&(b.zmin=l[2]);if(!ea(h,r,q?a.zmax:e,c,l,d))return!1;b.xmax=l[0];b.ymax=l[1];q&&(b.zmax=l[2]);p&&(b.mmin=a.mmin,b.mmax=a.mmax);b.spatialReference=d;return!0}function ea(a,c,b,d,e,f){n[0]=a;n[1]=c;n[2]=b;return y(n,d,0,e,f,0,1)}function fa(a,c,b,d){if(k.isNone(c)||k.isNone(d)||2>a.length)return!1;
2===a.length&&(n[0]=a[0],n[1]=a[1],n[2]=0,a=n);return y(a,c,0,b,d,0,1)}function ua(a,c,b){k.isNone(c)?a=!1:(c=C(c,V),c=D[c][6],k.isNone(c)?a=!1:(c(a,0,n,0),b!==n&&(b[0]=n[0],b[1]=n[1],2<b.length&&(b[2]=n[2])),a=!0));return a}function y(a,c,b,d,e,f,g=1){c=ca(c,e,da);if(k.isNone(c))return!1;if(c===t){if(a===d&&b===f)return!0;g=b+3*g;for(let h=b,r=f;h<g;h++,r++)d[r]=a[h];return!0}g=b+3*g;for(let h=b,r=f;h<g;h+=3,r+=3)c(a,h,d,r);return!0}function ta(a,c,b,d,e,f,g=0){const h=[];for(const r of a)for(const q of r)h.push(q[0],
q[1],c?q[2]:g);if(!y(h,d,0,h,f,0,h.length/3))return!1;d=0;e.length=0;for(const r of a){a=[];for(const q of r)c&&b?a.push([h[d++],h[d++],h[d++],q[3]]):c?a.push([h[d++],h[d++],h[d++]]):(b?a.push([h[d++],h[d++],q[2]]):a.push([h[d++],h[d++]]),d++);e.push(a)}return!0}function va(a,c,b){const d=Math.sin(c);c=Math.cos(c);const e=Math.sin(a);a=Math.cos(a);b[0]=-d;b[4]=-e*c;b[8]=a*c;b[12]=0;b[1]=c;b[5]=-e*d;b[9]=a*d;b[13]=0;b[2]=0;b[6]=a;b[10]=e;b[14]=0;b[3]=0;b[7]=0;b[11]=0;b[15]=1;return b}function C(a,
c){if(c.spatialReference===a)return c.spatialReferenceId;c.spatialReference=a;"metersPerUnit"in c&&(c.metersPerUnit=Qa.getMetersPerUnitForSR(a,1));return a.wkt===R.SphericalECEFSpatialReference.wkt?c.spatialReferenceId=1:x.isWGS84(a)?c.spatialReferenceId=2:x.isWebMercator(a)?c.spatialReferenceId=3:a.wkt===R.WGS84ECEFSpatialReference.wkt?c.spatialReferenceId=4:4490===a.wkid?c.spatialReferenceId=5:a.wkt===R.SphericalPCPFMars.wkt?c.spatialReferenceId=7:a.wkt===R.SphericalPCPFMoon.wkt?c.spatialReferenceId=
9:x.isMars(a)?c.spatialReferenceId=8:x.isMoon(a)?c.spatialReferenceId=10:c.spatialReferenceId=0}function t(a,c,b,d){a!==b&&(b[d++]=a[c++],b[d++]=a[c++],b[d]=a[c])}function P(a,c,b,d){b[d++]=G*(a[c++]/v.earth.radius);b[d++]=G*(Math.PI/2-2*Math.atan(Math.exp(-1*a[c++]/v.earth.radius)));b[d]=a[c]}function wa(a,c,b,d){P(a,c,b,d);H(b,d,b,d)}function xa(a,c,b,d){P(a,c,b,d);I(b,d,b,d)}function ya(a,c,b,d,e){var f=.4999999*Math.PI;f=Q.clamp(w*a[c+1],-f,f);f=Math.sin(f);b[d++]=w*a[c]*e.radius;b[d++]=e.halfSemiMajorAxis*
Math.log((1+f)/(1-f));b[d]=a[c+2]}function J(a,c,b,d){ya(a,c,b,d,v.earth)}function ha(a,c,b,d,e){e+=a[c+2];const f=w*a[c+1];a=w*a[c];c=Math.cos(f);b[d++]=Math.cos(a)*c*e;b[d++]=Math.sin(a)*c*e;b[d]=Math.sin(f)*e}function za(a,c,b,d){ha(a,c,b,d,v.moon.radius)}function Aa(a,c,b,d){ha(a,c,b,d,v.mars.radius)}function H(a,c,b,d){ha(a,c,b,d,v.earth.radius)}function W(a,c,b,d,e){var f=a[c];const g=a[c+1];c=a[c+2];a=Math.sqrt(f*f+g*g+c*c);c=Q.asinClamped(c/(0===a?1:a));f=Math.atan2(g,f);b[d++]=G*f;b[d++]=
G*c;b[d]=a-e}function Ba(a,c,b,d){W(a,c,b,d,v.moon.radius)}function Ca(a,c,b,d){W(a,c,b,d,v.mars.radius)}function K(a,c,b,d){W(a,c,b,d,v.earth.radius)}function Da(a,c,b,d){K(a,c,b,d);J(b,d,b,d)}function Ea(a,c,b,d){K(a,c,b,d);I(b,d,b,d)}function I(a,c,b,d){{var e=v.earth;const g=w*a[c];var f=w*a[c+1];a=a[c+2];c=Math.sin(f);f=Math.cos(f);const h=e.radius/Math.sqrt(1-e.eccentricitySquared*c*c);b[d++]=(h+a)*f*Math.cos(g);b[d++]=(h+a)*f*Math.sin(g);b[d++]=(h*(1-e.eccentricitySquared)+a)*c}}function L(a,
c,b,d){var e=Sa.earthEllipsoidConstants,f=a[c],g=a[c+1];a=a[c+2];let h;c=Math.abs(a);var r=f*f+g*g;var q=Math.sqrt(r);var p=r+a*a;var u=Math.sqrt(p);f=Math.atan2(g,f);var A=a*a/p;p=r/p;g=e.a2/u;r=e.a3-e.a4/u;.3<p?(A=c/u*(1+p*(e.a1+g+A*r)/u),u=Math.asin(A),g=A*A,p=Math.sqrt(1-g)):(p=q/u*(1-A*(e.a5-g-p*r)/u),u=Math.acos(p),g=1-p*p,A=Math.sqrt(g));h=1-v.earth.eccentricitySquared*g;g=v.earth.radius/Math.sqrt(h);e=e.a6*g;g=q-g*p;r=c-e*A;c=p*g+A*r;q=p*r-A*g;e=q/(e/h+c);u+=e;0>a&&(u=-u);b[d++]=G*f;b[d++]=
G*u;b[d]=c+q*e/2}function Fa(a,c,b,d){L(a,c,b,d);H(b,d,b,d)}function Ga(a,c,b,d){L(a,c,b,d);J(b,d,b,d)}function ca(a,c,b=ia()){return k.isNone(a)||k.isNone(c)?null:Ha(a,c,b).projector}function Ha(a,c,b){if(k.isNone(a)||k.isNone(c)||b.source.spatialReference===a&&b.dest.spatialReference===c)return b;const d=C(a,b.source),e=C(c,b.dest);0===d&&0===e?x.equals(a,c)?b.projector=t:b.projector=null:b.projector=D[d][e];return b}function ia(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},
dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:t}}let z=null,F=null,T=null,U={},ba=function(a){function c(){return a.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}Ja._inheritsLoose(c,a);return c}(Ka);const D={[2]:{[5]:null,[8]:null,[10]:null,[6]:t,[1]:H,[7]:null,[9]:null,[0]:null,[3]:J,[2]:t,[4]:I},[5]:{[5]:t,[8]:null,[10]:null,[6]:t,[1]:H,[7]:null,[9]:null,[0]:null,[3]:null,[2]:null,[4]:I},[8]:{[5]:null,[8]:t,[10]:null,
[6]:null,[1]:null,[7]:Aa,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:t,[6]:null,[1]:null,[7]:null,[9]:za,[0]:null,[3]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[6]:P,[1]:wa,[7]:null,[9]:null,[0]:null,[3]:t,[2]:P,[4]:xa},[4]:{[5]:L,[8]:null,[10]:null,[6]:L,[1]:Fa,[7]:null,[9]:null,[0]:null,[3]:Ga,[2]:L,[4]:t},[1]:{[5]:K,[8]:null,[10]:null,[6]:K,[1]:t,[7]:null,[9]:null,[0]:null,[3]:Da,[2]:K,[4]:Ea},[7]:{[5]:null,[8]:Ca,[10]:null,[6]:null,[1]:null,[7]:t,
[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:Ba,[6]:null,[1]:null,[7]:null,[9]:t,[0]:null,[3]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[6]:null,[1]:null,[7]:null,[9]:null,[0]:t,[3]:null,[2]:null,[4]:null},[6]:{[5]:null,[8]:null,[10]:null,[6]:t,[1]:H,[7]:null,[9]:null,[0]:null,[3]:null,[2]:t,[4]:I}},V={spatialReference:null,spatialReferenceId:0},Ia={spatialReference:null,spatialReferenceId:0},da=ia(),Ua=ia(),w=Q.deg2rad(1),G=Q.rad2deg(1),n=M.create(),B=
M.create(),E=M.create(),l=M.create(),X=M.create();m.canProjectToWGS84ComparableLonLat=function(a){if(k.isNone(a))return!1;a=C(a,V);return!!D[a][6]};m.canProjectWithoutEngine=aa;m.computeLatLonToENURotation=va;m.computeLinearTransformation=function(a,c,b,d){if(k.isNone(a)||k.isNone(d))return!1;var e=C(a,V),f=C(d,Ia);if(e===f&&1!==f&&(0!==e||x.equals(a,d)))return O.identity(b),O.translate(b,b,c),!0;if(1===f||7===f||9===f){d=a=0;if(1===f){e=D[e][6];f=D[6][f];if(k.isNone(e)||k.isNone(f))return!1;e(c,
0,B,0);f(B,0,E,0);a=w*B[0];d=w*B[1]}else if(7===f||9===f){f=D[e][f];if(k.isNone(f))return!1;f(c,0,E,0);a=w*c[0];d=w*c[1]}va(d,a,b);b[12]=E[0];b[13]=E[1];b[14]=E[2];return!0}if(3===f&&(2===e||1===e)){f=D[e][6];if(k.isNone(f))return!1;f(c,0,B,0);c=w*B[1];J(B,0,E,0);O.identity(b);O.translate(b,b,E);c=1/Math.cos(c);O.scale(b,b,[c,c,1]);return!0}return!1};m.getProjectorName=function(a,c){switch(ca(a,c,da)){case t:return"copy3";case H:return"wgs84ToSphericalECEF";case J:return"wgs84ToWebMercator";case I:return"wgs84ToWGS84ECEF";
case P:return"webMercatorToWGS84";case wa:return"webMercatorToSphericalECEF";case xa:return"webMercatorToWGS84ECEF";case L:return"wgs84ECEFToWGS84";case Fa:return"wgs84ECEFToSphericalECEF";case Ga:return"wgs84ECEFToWebMercator";case K:return"sphericalECEFToWGS84";case Da:return"sphericalECEFToWebMercator";case Ca:return"sphericalMarsPCPFToMars2000";case Ba:return"sphericalMoonPCPFToMoon2000";case Ea:return"sphericalECEFToWGS84ECEF";case Aa:return"mars2000ToSphericalPCPF";case za:return"moon2000ToSphericalPCPF";
default:return null}};m.getTransformation=na;m.getTransformations=function(a,c,b=null){if(k.isNone(z))throw new ba;a=z._getTransformationBySuitability(F,a,c,b,null==b?void 0:b.spatialReference);if(null!==a){c=[];for(const d of a)c.push(S.fromGE(d));return c}return[]};m.initializeProjection=async function(a,c){if(!la())for(const {source:b,dest:d,geographicTransformation:e}of a)if(!aa(b,d,e))return ma(c)};m.isLoaded=la;m.isSupported=function(){return!0};m.load=ma;m.localLinearScaleFactors=function(a,
c,b,d){if(k.isNone(c)||k.isNone(d))return!1;const e=C(c,V);var f=C(d,Ia);if(e===f&&0!==e||x.equals(c,d))return b[0]=1,b[1]=1,b[2]=1,!0;if(1===e){c=N.length(a);a=c/Math.sqrt(a[0]*a[0]+a[1]*a[1]);c/=v.earth.radius;if(3===f)return b[0]=a*c,b[1]=a*c,b[2]=1,!0;if(2===f||5===f)return f=180/(v.earth.radius*Math.PI),b[0]=f*a*c,b[1]=f*c,b[2]=1,!0}return!1};m.lonLatToSphericalPCPF=function(a,c,b,d,e=0){d+=e;e=Math.cos(b);a[0]=Math.cos(c)*e*d;a[1]=Math.sin(c)*e*d;a[2]=Math.sin(b)*d};m.lonLatToWebMercatorComparable=
ya;m.project=function(a,c,b=null){return Array.isArray(a)?0===a.length?[]:Z(F,a,a[0].spatialReference,c,b):Z(F,[a],a.spatialReference,c,b)[0]};m.projectBoundingRect=function(a,c,b,d){if(null==a)return!1;if(x.equals(c,d))return Ra.set(b,a),!0;n[0]=a[0];n[1]=a[1];n[2]=0;if(!y(n,c,0,n,d,0,1))return!1;b[0]=n[0];b[1]=n[1];n[0]=a[2];n[1]=a[3];n[2]=0;if(!y(n,c,0,n,d,0,1))return!1;b[2]=n[0];b[3]=n[1];return!0};m.projectBoundingSphere=function(a,c,b,d){if(k.isNone(c)||k.isNone(d))return!1;c=Ha(c,d,Ua);if(c.projector===
t)return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],!0;if(k.isNone(c.projector))return!1;const {source:e,dest:f}=c;if(3===f.spatialReferenceId){c=D[e.spatialReferenceId][2];if(k.isNone(c))return!1;c(a,0,B,0);c=Math.abs(w*B[1])+Math.asin(a[3]/(v.earth.radius+a[2]));J(B,0,b,0);b[3]=c>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(c)*a[3];return!0}c.projector(a,0,b,0);b[3]=a[3]*e.metersPerUnit/f.metersPerUnit;return!0};m.projectBuffer=y;m.projectDirection=function(a,c,b,d,e){N.copy(l,a);N.add(X,a,c);fa(l,b,
l,e);fa(X,b,X,e);N.subtract(d,X,l);N.normalize(d,d)};m.projectExtent=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:pa(a,a.spatialReference,c,b,d)};m.projectMany=Z;m.projectMultipoint=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:sa(a,a.spatialReference,c,b,d)};m.projectPoint=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:oa(a,a.spatialReference,c,b,d)};m.projectPointToVector=function(a,c,b,d=0){l[0]=a.x;l[1]=a.y;const e=a.z;l[2]=void 0!==e?e:d;return y(l,
a.spatialReference,0,c,b,0,1)};m.projectPointToWGS84ComparableLonLat=function(a,c){l[0]=a.x;l[1]=a.y;const b=a.z;l[2]=void 0!==b?b:0;return ua(l,a.spatialReference,c)};m.projectPolygon=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:qa(a,a.spatialReference,c,b,d)};m.projectPolyline=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:ra(a,a.spatialReference,c,b,d)};m.projectVectorToDehydratedPoint=function(a,c,b){return y(a,c,0,l,b.spatialReference,0,1)?(b.x=l[0],b.y=l[1],b.z=
l[2],b):null};m.projectVectorToPoint=function(a,c,b){if(k.isNone(c)||k.isNone(b))return null;const d=new ka({spatialReference:b});return y(a,c,0,l,b,0,1)?(d.x=l[0],d.y=l[1],d.z=l[2],d):null};m.projectVectorToVector=fa;m.projectVectorToWGS84ComparableLonLat=ua;m.projectXYZToVector=ea;m.sphericalPCPFtoLonLatElevation=W;m.unload=function(){T=F=z=null;U={}};Object.defineProperty(m,"__esModule",{value:!0})});