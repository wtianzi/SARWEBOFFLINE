// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Logger ../../../chunks/vec3f64 ../../projectionEllipsoid ../../../chunks/mat4 ../../projection ../../../chunks/mat4f64 ./projection".split(" "),function(t,w,u,x,m,h,v,k){const q=w.getLogger("esri.geometry.support.meshUtils.centerAt"),n=u.create(),g=u.create(),p=v.create(),f=v.create();t.centerAt=function(b,e,a){if(b.vertexAttributes&&b.vertexAttributes.position){var d=b.spatialReference,c=a&&a.origin||b.extent.center;if(d.isWGS84||d.isWebMercator&&(!a||!1!==a.geographic))if(a=
b.spatialReference,d=x.getSphericalPCPF(a),h.projectPointToVector(e,n,d)){h.projectPointToVector(c,g,d)||h.projectPointToVector(b.extent.center,g,d);c=b.vertexAttributes.position;e=b.vertexAttributes.normal;var l=new Float64Array(c.length),r=new Float32Array(e?e.length:0);k.projectToECEF(c,a,l);e&&k.projectNormalToECEF(e,c,l,a,r);h.computeLinearTransformation(d,g,p,d);h.computeLinearTransformation(d,n,f,d);m.invert(p,p);m.multiply(f,f,p);k.transformBufferInPlace(l,f);m.invert(f,f);m.transpose(f,f);
e&&k.transformBufferInPlace(r,f,!0);k.projectFromECEF(l,c,a);e&&k.projectNormalFromECEF(r,c,l,a,e);b.vertexAttributesChanged()}else q.error(`Failed to project centerAt location (wkid:${e.spatialReference.wkid}) to ECEF`);else if(h.projectPointToVector(e,n,b.spatialReference)){h.projectPointToVector(c,g,b.spatialReference)||(a=b.extent.center,g[0]=a.x,g[1]=a.y,g[2]=a.z,q.error(`Failed to project specified origin (wkid:${c.spatialReference.wkid}) to mesh spatial reference (wkid:${b.spatialReference.wkid}). Using mesh extent.center instead`));
if(a=b.vertexAttributes.position)for(d=0;d<a.length;d+=3)for(c=0;3>c;c++)a[d+c]+=n[c]-g[c];b.vertexAttributesChanged()}else q.error(`Failed to project centerAt location (wkid:${e.spatialReference.wkid}) to mesh spatial reference (wkid:${b.spatialReference.wkid})`)}};Object.defineProperty(t,"__esModule",{value:!0})});