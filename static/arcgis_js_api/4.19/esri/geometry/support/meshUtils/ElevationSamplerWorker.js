// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/libs/rbush/PooledRBush":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../maybe ../../arrayUtils ../../PooledArray ../../../chunks/quickselect".split(" "),function(C,D,E,y,w,G){function g(k,e){m(k,0,k.children.length,e,k)}function m(k,e,a,b,c){c||(c=new I([]));c.minX=Infinity;c.minY=Infinity;c.maxX=-Infinity;c.maxY=-Infinity;for(let d=e,f;d<a;d++)f=k.children[d],h(c,k.leaf?b(f):f);return c}function h(k,e){k.minX=Math.min(k.minX,e.minX);k.minY=Math.min(k.minY,
e.minY);k.maxX=Math.max(k.maxX,e.maxX);k.maxY=Math.max(k.maxY,e.maxY)}function l(k,e){return k.minX-e.minX}function q(k,e){return k.minY-e.minY}function r(k){return(k.maxX-k.minX)*(k.maxY-k.minY)}function t(k){return k.maxX-k.minX+(k.maxY-k.minY)}function z(k,e){return k.minX<=e.minX&&k.minY<=e.minY&&e.maxX<=k.maxX&&e.maxY<=k.maxY}function v(k,e){return e.minX<=k.maxX&&e.minY<=k.maxY&&e.maxX>=k.minX&&e.maxY>=k.minY}function N(k,e,a,b,c){for(e=[e,a];e.length;){a=E.assumeNonNull(e.pop());const d=E.assumeNonNull(e.pop());
if(a-d<=b)continue;const f=d+Math.ceil((a-d)/b/2)*b;G.quickselect(k,f,d,a,c);e.push(d,f,f,a)}}let O=function(){function k(a=9,b){this.compareMinX=l;this.compareMinY=q;this.toBBox=function(c){return c};this._maxEntries=Math.max(4,a||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));b&&("function"===typeof b?this.toBBox=b:this._initFormat(b));this.clear()}var e=k.prototype;e.destroy=function(){this.clear();F.prune();J.prune();A.prune();K.prune()};e.all=function(a){this._all(this.data,a)};
e.search=function(a,b){let c=this.data;const d=this.toBBox;if(v(a,c))for(F.clear();c;){for(let f=0,n=c.children.length;f<n;f++){const p=c.children[f],u=c.leaf?d(p):p;v(a,u)&&(c.leaf?b(p):z(a,u)?this._all(p,b):F.push(p))}c=F.pop()}};e.collides=function(a){let b=this.data;const c=this.toBBox;if(!v(a,b))return!1;for(F.clear();b;){for(let d=0,f=b.children.length;d<f;d++){const n=b.children[d],p=b.leaf?c(n):n;if(v(a,p)){if(b.leaf||z(a,p))return!0;F.push(n)}}b=F.pop()}return!1};e.load=function(a){if(!a.length)return this;
if(a.length<this._minEntries){for(let b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(0,a.length),0,a.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){const b=this.data;this.data=a;a=b}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this};e.insert=function(a){a&&this._insert(a,this.data.height-1);return this};e.clear=function(){this.data=new I([]);return this};e.remove=
function(a){if(!a)return this;let b=this.data,c=null,d=0,f=!1,n;const p=this.toBBox(a);A.clear();for(K.clear();b||0<A.length;){if(!b){var u;b=E.assumeNonNull(A.pop());c=A.data[A.length-1];d=null!=(u=K.pop())?u:0;f=!0}if(b.leaf&&(n=y.indexOf(b.children,a,b.children.length,b.indexHint),-1!==n)){b.children.splice(n,1);A.push(b);this._condense(A);break}f||b.leaf||!z(b,p)?c?(d++,b=c.children[d],f=!1):b=null:(A.push(b),K.push(d),d=0,c=b,b=b.children[0])}return this};e.toJSON=function(){return this.data};
e.fromJSON=function(a){this.data=a;return this};e._all=function(a,b){for(J.clear();a;){var c;if(!0===a.leaf)for(const d of a.children)b(d);else J.pushArray(a.children);a=null!=(c=J.pop())?c:null}};e._build=function(a,b,c,d){var f=c-b+1,n=this._maxEntries;if(f<=n)return a=new I(a.slice(b,c+1)),g(a,this.toBBox),a;d||(d=Math.ceil(Math.log(f)/Math.log(n)),n=Math.ceil(f/n**(d-1)));const p=new L([]);p.height=d;f=Math.ceil(f/n);n=f*Math.ceil(Math.sqrt(n));for(N(a,b,c,n,this.compareMinX);b<=c;b+=n){const u=
Math.min(b+n-1,c);N(a,b,u,f,this.compareMinY);for(let x=b;x<=u;x+=f)p.children.push(this._build(a,x,Math.min(x+f-1,u),d-1))}g(p,this.toBBox);return p};e._chooseSubtree=function(a,b,c,d){for(;;){d.push(b);if(!0===b.leaf||d.length-1===c)break;let f=Infinity,n=Infinity,p=void 0;for(let u=0,x=b.children.length;u<x;u++){const B=b.children[u],H=r(B),M=(Math.max(B.maxX,a.maxX)-Math.min(B.minX,a.minX))*(Math.max(B.maxY,a.maxY)-Math.min(B.minY,a.minY))-H;M<n?(n=M,f=H<f?H:f,p=B):M===n&&H<f&&(f=H,p=B)}b=p||
b.children[0]}return b};e._insert=function(a,b,c){var d=this.toBBox;c=c?a:d(a);A.clear();d=this._chooseSubtree(c,this.data,b,A);d.children.push(a);for(h(d,c);0<=b;)if(A.data[b].children.length>this._maxEntries)this._split(A,b),b--;else break;this._adjustParentBBoxes(c,A,b)};e._split=function(a,b){const c=a.data[b];var d=c.children.length;const f=this._minEntries;this._chooseSplitAxis(c,f,d);(d=this._chooseSplitIndex(c,f,d))?(d=c.children.splice(d,c.children.length-d),d=c.leaf?new I(d):new L(d),d.height=
c.height,g(c,this.toBBox),g(d,this.toBBox),b?a.data[b-1].children.push(d):this._splitRoot(c,d)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")};e._splitRoot=function(a,b){this.data=new L([a,b]);this.data.height=a.height+1;g(this.data,this.toBBox)};e._chooseSplitIndex=function(a,b,c){let d,f,n=void 0;d=f=Infinity;for(let u=b;u<=c-b;u++){var p=m(a,0,u,this.toBBox);const x=m(a,u,c,this.toBBox),B=Math.max(0,Math.min(p.maxX,x.maxX)-Math.max(p.minX,x.minX))*Math.max(0,
Math.min(p.maxY,x.maxY)-Math.max(p.minY,x.minY));p=r(p)+r(x);B<d?(d=B,n=u,f=p<f?p:f):B===d&&p<f&&(f=p,n=u)}return n};e._chooseSplitAxis=function(a,b,c){const d=a.leaf?this.compareMinX:l,f=a.leaf?this.compareMinY:q,n=this._allDistMargin(a,b,c,d);b=this._allDistMargin(a,b,c,f);n<b&&a.children.sort(d)};e._allDistMargin=function(a,b,c,d){a.children.sort(d);d=this.toBBox;var f=m(a,0,b,d);const n=m(a,c-b,c,d);let p=t(f)+t(n);for(let u=b;u<c-b;u++){const x=a.children[u];h(f,a.leaf?d(x):x);p+=t(f)}for(c=
c-b-1;c>=b;c--)f=a.children[c],h(n,a.leaf?d(f):f),p+=t(n);return p};e._adjustParentBBoxes=function(a,b,c){for(;0<=c;c--)h(b.data[c],a)};e._condense=function(a){for(let b=a.length-1;0<=b;b--){const c=a.data[b];if(0===c.children.length)if(0<b){const d=a.data[b-1],f=d.children;f.splice(y.indexOf(f,c,f.length,d.indexHint),1)}else this.clear();else g(c,this.toBBox)}};e._initFormat=function(a){const b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a",
"b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")};return k}();const F=new w,J=new w,A=new w,K=new w({deallocator:void 0});w=function(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity};let P=function(k){function e(){var a=k.apply(this,arguments)||this;a.height=1;a.indexHint=new y.PositionHint;return a}D._inheritsLoose(e,k);return e}(w),I=function(k){function e(a){var b=k.call(this)||this;b.children=a;b.leaf=!0;
return b}D._inheritsLoose(e,k);return e}(P),L=function(k){function e(a){var b=k.call(this)||this;b.children=a;b.leaf=!1;return b}D._inheritsLoose(e,k);return e}(P);C.BBox=w;C.PooledRBush=O;C.default=O;Object.defineProperty(C,"__esModule",{value:!0})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(C,D){D=D.createCommonjsModule(function(E){(function(y){y=y();void 0!==y&&(E.exports=y)})(function(){function y(g,m,h,l,q){for(;l>h;){if(600<l-h){var r=l-h+1,t=m-h+
1,z=Math.log(r),v=.5*Math.exp(2*z/3);z=.5*Math.sqrt(z*v*(r-v)/r)*(0>t-r/2?-1:1);y(g,m,Math.max(h,Math.floor(m-t*v/r+z)),Math.min(l,Math.floor(m+(r-t)*v/r+z)),q)}r=g[m];t=h;v=l;w(g,h,m);for(0<q(g[l],r)&&w(g,h,l);t<v;){w(g,t,v);t++;for(v--;0>q(g[t],r);)t++;for(;0<q(g[v],r);)v--}0===q(g[h],r)?w(g,h,v):(v++,w(g,v,l));v<=m&&(h=v+1);m<=v&&(l=v-1)}}function w(g,m,h){var l=g[m];g[m]=g[h];g[h]=l}function G(g,m){return g<m?-1:g>m?1:0}return function(g,m,h,l,q){y(g,m,h||0,l||g.length-1,q||G)}})});C.quickselect=
D})},"*noref":1}});
define(["exports","../../../core/has","../../../core/maybe","../../../core/libs/rbush/PooledRBush"],function(C,D,E,y){function w(g,m,h,l){return{minX:Math.min(g[m+0],g[h+0],g[l+0]),maxX:Math.max(g[m+0],g[h+0],g[l+0]),minY:Math.min(g[m+1],g[h+1],g[l+1]),maxY:Math.max(g[m+1],g[h+1],g[l+1]),p0:[g[m+0],g[m+1],g[m+2]],p1:[g[h+0],g[h+1],g[h+2]],p2:[g[l+0],g[l+1],g[l+2]]}}let G=function(){function g(){}var m=g.prototype;m.createIndex=async function(h,l){const q=[];if(!h.vertexAttributes||!h.vertexAttributes.position)return new y.PooledRBush;
h=this.createMeshData(h);l=E.isSome(l)?await l.invoke("createIndexThread",h,{transferList:q}):this.createIndexThread(h).result;return this.createPooledRBush().fromJSON(l)};m.createIndexThread=function(h){const l=new Float64Array(h.position),q=this.createPooledRBush();return h.components?this.createIndexComponentsThread(q,l,h.components.map(r=>new Uint32Array(r))):this.createIndexAllThread(q,l)};m.createIndexAllThread=function(h,l){const q=Array(l.length/9);let r=0;for(let t=0;t<l.length;t+=9)q[r++]=
w(l,t+0,t+3,t+6);h.load(q);return{result:h.toJSON()}};m.createIndexComponentsThread=function(h,l,q){var r=0;for(var t of q)r+=t.length/3;r=Array(r);t=0;for(const z of q)for(q=0;q<z.length;q+=3)r[t++]=w(l,3*z[q+0],3*z[q+1],3*z[q+2]);h.load(r);return{result:h.toJSON()}};m.createMeshData=function(h){const l=h.vertexAttributes.position.buffer;return!h.components||h.components.some(q=>!q.faces)?{position:l}:{position:l,components:h.components.map(q=>q.faces)}};m.createPooledRBush=function(){return new y.PooledRBush(9,
D("csp-restrictions")?h=>h:[".minX",".minY",".maxX",".maxY"])};return g}();C.ElevationSamplerWorker=G;C.default=G;Object.defineProperty(C,"__esModule",{value:!0})});