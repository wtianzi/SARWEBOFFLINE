// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(l,m,n,p,q,g,r){g=function(f){function h(a){var b=f.call(this,a)||this;b._rendererInfo=new r.WGLRendererInfo;b._materialItemsRequestQueue=new p;b.attributeView=new q.AttributeStoreView(()=>b.onAttributeStoreUpdate());return b}m._inheritsLoose(h,f);var c=h.prototype;c.destroy=function(){this.removeAllChildren();
this.children.forEach(a=>a.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};c.setRendererInfo=function(a,b,d){this._rendererInfo.setInfo(a,b,d);this.requestRender()};c.getMaterialItems=async function(a,b){if(!a||0===a.length)return null;const d=n.createResolver();this._materialItemsRequestQueue.push({items:a,abortOptions:b,resolver:d});this.requestRender();return d.promise};c.doRender=function(a){a.context.capabilities.enable("textureFloat");a.context.capabilities.enable("vao");
if(0<this._materialItemsRequestQueue.length){let b=this._materialItemsRequestQueue.pop();for(;b;)this._processMaterialItemRequest(a,b),b=this._materialItemsRequestQueue.pop()}f.prototype.doRender.call(this,a)};c.renderChildren=function(a){for(const b of this.children)b.commit(a);this._rendererInfo.update(a.state);f.prototype.renderChildren.call(this,a)};c.createRenderParams=function(a){return{...f.prototype.createRenderParams.call(this,a),rendererInfo:this._rendererInfo,attributeView:this.attributeView}};
c.onAttributeStoreUpdate=function(){};c._processMaterialItemRequest=function(a,{items:b,abortOptions:d,resolver:k}){const {painter:t,pixelRatio:u}=a;a=b.map(e=>t.textureManager.rasterizeItem(e.symbol,u,e.glyphIds,d));Promise.all(a).then(e=>{this.stage?(e=e.map((v,w)=>({id:b[w].id,mosaicItem:v})),k.resolve(e)):k.reject()},k.reject)};return h}(g["default"]);l.FeatureContainer=g;Object.defineProperty(l,"__esModule",{value:!0})});