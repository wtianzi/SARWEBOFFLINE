// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./decluttering/util".split(" "),function(p,t,f,q,l,y,r,z,A,B,D,E,C){q=function(){function k(e,c){this.layerUIDs=[];this.isDestroyed=!1;this.data=e;this.memoryUsed=
e.byteLength;let a=1;e=new Uint32Array(e);this.layerUIDs=[];const b=e[a++];for(let d=0;d<b;d++)this.layerUIDs[d]=e[a++];this.bufferDataOffset=a;c&&(this.layer=c.getStyleLayerByUID(this.layerUIDs[0]))}var h=k.prototype;h.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)};h.prepareForRendering=function(e){f.isNone(this.data)||(this.doPrepareForRendering(e,this.data,this.bufferDataOffset),this.data=null)};t._createClass(k,[{key:"isPreparedForRendering",get:function(){return f.isNone(this.data)}},
{key:"offset",get:function(){return this.bufferDataOffset}}]);return k}();y=function(k){function h(c,a){a=k.call(this,c,a)||this;a.type=2;a.lineIndexStart=0;a.lineIndexCount=0;c=new Uint32Array(c);let b=a.bufferDataOffset;a.lineIndexStart=c[b++];a.lineIndexCount=c[b++];a.bufferDataOffset=b;return a}t._inheritsLoose(h,k);var e=h.prototype;e.hasData=function(){return 0<this.lineIndexCount};e.triangleCount=function(){return this.lineIndexCount/3};e.doDestroy=function(){f.isSome(this.lineVertexArrayObject)&&
this.lineVertexArrayObject.dispose();f.isSome(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose();f.isSome(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose();this.lineIndexBuffer=this.lineVertexBuffer=this.lineVertexArrayObject=null;this.memoryUsed=0};e.doPrepareForRendering=function(c,a,b){a=new Uint32Array(a);var d=new Int32Array(a.buffer);const g=a[b++];this.lineVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*b,g));b+=g;d=a[b++];this.lineIndexBuffer=l.createIndex(c,35044,new Uint32Array(a.buffer,
4*b,d));b+=d;b=this.layer.lineMaterial;this.lineVertexArrayObject=new r(c,b.getAttributeLocations(),b.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)};return h}(q);z=function(k){function h(c,a){a=k.call(this,c,a)||this;a.type=1;a.fillIndexStart=0;a.fillIndexCount=0;a.outlineIndexStart=0;a.outlineIndexCount=0;c=new Uint32Array(c);let b=a.bufferDataOffset;a.fillIndexStart=c[b++];a.fillIndexCount=c[b++];a.outlineIndexStart=c[b++];a.outlineIndexCount=c[b++];a.bufferDataOffset=b;
return a}t._inheritsLoose(h,k);var e=h.prototype;e.hasData=function(){return 0<this.fillIndexCount||0<this.outlineIndexCount};e.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3};e.doDestroy=function(){f.isSome(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose();f.isSome(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose();f.isSome(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose();this.fillIndexBuffer=this.fillVertexBuffer=this.fillVertexArrayObject=
null;f.isSome(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose();f.isSome(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose();f.isSome(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose();this.outlineIndexBuffer=this.outlineVertexBuffer=this.outlineVertexArrayObject=null;this.memoryUsed=0};e.doPrepareForRendering=function(c,a,b){a=new Uint32Array(a);var d=new Int32Array(a.buffer),g=a[b++];this.fillVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*
b,g));b+=g;g=a[b++];this.fillIndexBuffer=l.createIndex(c,35044,new Uint32Array(a.buffer,4*b,g));b+=g;g=a[b++];this.outlineVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*b,g));b+=g;d=a[b++];this.outlineIndexBuffer=l.createIndex(c,35044,new Uint32Array(a.buffer,4*b,d));b+=d;a=this.layer;b=a.fillMaterial;a=a.outlineMaterial;this.fillVertexArrayObject=new r(c,b.getAttributeLocations(),b.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer);this.outlineVertexArrayObject=
new r(c,a.getAttributeLocations(),a.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)};return h}(q);A=function(k){function h(c,a,b){a=k.call(this,c,a)||this;a.type=3;a.iconPerPageElementsMap=new Map;a.glyphPerPageElementsMap=new Map;a.symbolInstances=[];a.isIconSDF=!1;a.opacityChanged=!1;a.lastOpacityUpdate=0;a.symbols=[];const d=new Uint32Array(c),g=new Int32Array(c);c=new Float32Array(c);let m=a.bufferDataOffset;a.isIconSDF=!!d[m++];var u=d[m++];for(var n=0;n<u;n++){var v=
d[m++],w=d[m++],x=d[m++];a.iconPerPageElementsMap.set(v,[w,x])}u=d[m++];for(n=0;n<u;n++)v=d[m++],w=d[m++],x=d[m++],a.glyphPerPageElementsMap.set(v,[w,x]);u=d[m++];n=d[m++];a.iconOpacity=new Int32Array(u);a.textOpacity=new Int32Array(n);m=C.deserializeSymbols(d,g,c,m,a.symbols,b);a.bufferDataOffset=m;return a}t._inheritsLoose(h,k);var e=h.prototype;e.hasData=function(){return 0<this.iconPerPageElementsMap.size||0<this.glyphPerPageElementsMap.size};e.triangleCount=function(){let c=0;for(const [,a]of this.iconPerPageElementsMap)c+=
a[1];for(const [,a]of this.glyphPerPageElementsMap)c+=a[1];return c/3};e.doDestroy=function(){f.isSome(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose();f.isSome(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose();f.isSome(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose();f.isSome(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose();this.iconIndexBuffer=this.iconOpacityBuffer=this.iconVertexBuffer=this.iconVertexArrayObject=null;f.isSome(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose();
f.isSome(this.textVertexBuffer)&&this.textVertexBuffer.dispose();f.isSome(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose();f.isSome(this.textIndexBuffer)&&this.textIndexBuffer.dispose();this.textIndexBuffer=this.textOpacityBuffer=this.textVertexBuffer=this.textVertexArrayObject=null;this.memoryUsed=0};e.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=!1;var c=f.unwrap(this.iconOpacity),a=f.unwrap(this.iconOpacityBuffer);0<c.length&&c.byteLength===a.size&&a.setSubData(c);
c=f.unwrap(this.textOpacity);a=f.unwrap(this.textOpacityBuffer);0<c.length&&c.byteLength===a.size&&a.setSubData(c)}};e.doPrepareForRendering=function(c,a,b){a=new Uint32Array(a);var d=new Int32Array(a.buffer),g=a[b++];this.iconVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*b,g));b+=g;g=a[b++];this.iconIndexBuffer=l.createIndex(c,35044,new Uint32Array(a.buffer,4*b,g));b+=g;g=a[b++];this.textVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*b,g));b+=g;d=a[b++];this.textIndexBuffer=
l.createIndex(c,35044,new Uint32Array(a.buffer,4*b,d));b+=d;this.iconOpacityBuffer=l.createVertex(c,35044,f.unwrap(this.iconOpacity).buffer);this.textOpacityBuffer=l.createVertex(c,35044,f.unwrap(this.textOpacity).buffer);a=this.layer;b=a.iconMaterial;a=a.textMaterial;this.iconVertexArrayObject=new r(c,b.getAttributeLocations(),b.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer);this.textVertexArrayObject=new r(c,a.getAttributeLocations(),a.getLayoutInfo(),
{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)};return h}(q);B=function(k){function h(c,a){a=k.call(this,c,a)||this;a.type=4;a.circleIndexStart=0;a.circleIndexCount=0;c=new Uint32Array(c);let b=a.bufferDataOffset;a.circleIndexStart=c[b++];a.circleIndexCount=c[b++];a.bufferDataOffset=b;return a}t._inheritsLoose(h,k);var e=h.prototype;e.hasData=function(){return 0<this.circleIndexCount};e.triangleCount=function(){return this.circleIndexCount/3};e.doDestroy=function(){f.isSome(this.circleVertexArrayObject)&&
this.circleVertexArrayObject.dispose();f.isSome(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose();f.isSome(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose();this.circleIndexBuffer=this.circleVertexBuffer=this.circleVertexArrayObject=null;this.memoryUsed=0};e.doPrepareForRendering=function(c,a,b){a=new Uint32Array(a);var d=new Int32Array(a.buffer);const g=a[b++];this.circleVertexBuffer=l.createVertex(c,35044,new Int32Array(d.buffer,4*b,g));b+=g;d=a[b++];this.circleIndexBuffer=l.createIndex(c,
35044,new Uint32Array(a.buffer,4*b,d));b+=d;b=this.layer.circleMaterial;this.circleVertexArrayObject=new r(c,b.getAttributeLocations(),b.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)};return h}(q);p.CircleRenderBucket=B;p.FillRenderBucket=z;p.LineRenderBucket=y;p.RenderBucketBase=q;p.SymbolRenderBucket=A;Object.defineProperty(p,"__esModule",{value:!0})});