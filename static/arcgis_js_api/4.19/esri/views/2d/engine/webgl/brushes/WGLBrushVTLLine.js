// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../number ../enums ./WGLBrush".split(" "),function(r,z,A,t,B,C,D,k){k=function(u){function l(){var c=u.apply(this,arguments)||this;c._dashArray=B.create();c._programOptions={id:!1,pattern:!1};return c}z._inheritsLoose(l,u);var v=l.prototype;v.dispose=function(){};v.drawMany=function(c,e){const {context:f,displayLevel:h,state:m,drawPhase:E,painter:F,styleLayerUID:n}=
c,g=c.styleLayer,w=g.lineMaterial;var b=F.vectorTilesMaterialManager,p=g.getPaintValue("line-translate",h);const G=g.getPaintValue("line-translate-anchor",h);var a=g.getPaintValue("line-pattern",h);const x=void 0!==a,H=1/c.pixelRatio,y=E===D.WGLDrawPhase.HITTEST,q=this._programOptions;q.id=y;q.pattern=x;b=b.getMaterialProgram(f,w,q);f.bindProgram(b);b.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);b.setUniformMatrix3fv("u_displayMat3",1===G?m.displayMat3:m.displayViewMat3);b.setUniform2fv("u_lineTranslation",
p);b.setUniform1f("u_depth",g.z);b.setUniform1f("u_antialiasing",H);y&&(p=C.u32to4Xu8(n+1),b.setUniform4fv("u_id",p));if(x){if(c=c.spriteMosaic,a=c.getMosaicItemPosition(a,!0))c.bind(f,9729,a.page,t.VTL_TEXTURE_BINDING_UNIT_SPRITES),b.setUniform2f("u_pattern_tl",a.tl[0],a.br[1]),b.setUniform2f("u_pattern_br",a.br[0],a.tl[1]),b.setUniform2f("u_spriteSize",8*a.size[0],a.size[1]),b.setUniform1i("u_texture",t.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else a=g.getPaintValue("line-dasharray",h),2>a.length&&(a=
[1,-1]),this._dashArray[0]=8*a[0],this._dashArray[1]=8*a[1],b.setUniform2fv("u_dasharray",this._dashArray);a=-1;for(const d of e)d.layerData.has(n)&&(d.key.level!==a&&(a=d.key.level,w.setDataUniforms(b,h,g,a)),e=d.layerData.get(n),e.prepareForRendering(f),c=e.lineVertexArrayObject,A.isNone(c)||(f.bindVAO(c),b.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs),f.setStencilFunction(514,d.stencilRef,255),f.drawElements(4,e.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*e.lineIndexStart),d.triangleCount+=
e.lineIndexCount/3))};return l}(k);r.WGLBrushVTLLine=k;Object.defineProperty(r,"__esModule",{value:!0})});