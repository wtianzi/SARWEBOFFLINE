// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../number ../../enums ../../materialKey/MaterialKey ./templateUtils ../../TurboLine".split(" "),function(r,p,t,g,u,v,w,n){const q=1/3.8,x=b=>d=>{const a=b.out;var h=Math.ceil(1024*b._halfWidth);const c=Math.ceil(1024*b._halfReferenceWidth);d.entry0=b.offset+b.vertexCount++;var e=g.i1616to32(d.distance,h),f=g.i8888to32(Math.round(31*d.prevNormal.x),Math.round(31*d.prevNormal.y),0,-31),k=g.i8888to32(0,
0,0,b._bitset);a.vertexBounds(d.currentVertex.x,d.currentVertex.y,0,0);a.vertexWrite(g.i1616to32(8*d.currentVertex.x,8*d.currentVertex.y));a.vertexWrite(b.id);a.vertexWrite(b._fillColor);a.vertexWrite(f);a.vertexWrite(e);a.vertexWrite(b._tl);a.vertexWrite(b._br);a.vertexWrite(k);a.vertexWrite(g.i1616to32(c,0));a.vertexEnd();d.entry2=b.offset+b.vertexCount++;e=g.i1616to32(d.distance,h);f=g.i8888to32(Math.round(31*-d.prevNormal.x),Math.round(31*-d.prevNormal.y),0,31);k=g.i8888to32(0,0,0,b._bitset);
a.vertexBounds(d.currentVertex.x,d.currentVertex.y,0,0);a.vertexWrite(g.i1616to32(8*d.currentVertex.x,8*d.currentVertex.y));a.vertexWrite(b.id);a.vertexWrite(b._fillColor);a.vertexWrite(f);a.vertexWrite(e);a.vertexWrite(b._tl);a.vertexWrite(b._br);a.vertexWrite(k);a.vertexWrite(g.i1616to32(c,0));a.vertexEnd();d.exit0=b.offset+b.vertexCount++;e=g.i1616to32(d.distance,h);f=g.i8888to32(Math.round(31*d.nextNormal.x),Math.round(31*d.nextNormal.y),0,-31);k=g.i8888to32(0,0,0,b._bitset);a.vertexBounds(d.currentVertex.x,
d.currentVertex.y,0,0);a.vertexWrite(g.i1616to32(8*d.currentVertex.x,8*d.currentVertex.y));a.vertexWrite(b.id);a.vertexWrite(b._fillColor);a.vertexWrite(f);a.vertexWrite(e);a.vertexWrite(b._tl);a.vertexWrite(b._br);a.vertexWrite(k);a.vertexWrite(g.i1616to32(c,0));a.vertexEnd();d.exit2=b.offset+b.vertexCount++;h=g.i1616to32(d.distance,h);e=g.i8888to32(Math.round(31*-d.nextNormal.x),Math.round(31*-d.nextNormal.y),0,31);f=g.i8888to32(0,0,0,b._bitset);a.vertexBounds(d.currentVertex.x,d.currentVertex.y,
0,0);a.vertexWrite(g.i1616to32(8*d.currentVertex.x,8*d.currentVertex.y));a.vertexWrite(b.id);a.vertexWrite(b._fillColor);a.vertexWrite(e);a.vertexWrite(h);a.vertexWrite(b._tl);a.vertexWrite(b._br);a.vertexWrite(f);a.vertexWrite(g.i1616to32(c,0));a.vertexEnd()},y=b=>d=>{const a=b.out;a.indexWrite(d.leftExit0);a.indexWrite(d.rightEntry0);a.indexWrite(d.leftExit2);a.indexWrite(d.rightEntry0);a.indexWrite(d.rightEntry2);a.indexWrite(d.leftExit2);b.indexCount+=6},z=b=>(d,a,h,c,e,f,k,l,m)=>{m=g.i1616to32(m,
Math.ceil(1024*b._halfWidth));e=g.i8888to32(Math.round(31*e),Math.round(31*f),Math.round(31*k),Math.round(31*l));h=g.i8888to32(31*h,31*c,0,b._bitset);c=b.out;c.vertexBounds(d,a,1,1);c.vertexWrite(g.i1616to32(8*d,8*a));c.vertexWrite(b.id);c.vertexWrite(b._fillColor);c.vertexWrite(e);c.vertexWrite(m);c.vertexWrite(b._tl);c.vertexWrite(b._br);c.vertexWrite(h);c.vertexWrite(g.i1616to32(Math.ceil(1024*b._halfReferenceWidth),0));c.vertexEnd();return b.offset+b.vertexCount++},A=b=>(d,a,h)=>{const c=b.out;
c.indexWrite(d);c.indexWrite(a);c.indexWrite(h);b.indexCount+=3};return b=>function(d){function a(...c){c=d.call(this,...c)||this;c.tessellationProperties={};c._tessellationOptions={};c.geometryType=u.WGLGeometryType.LINE;return c}r._inheritsLoose(a,d);var h=a.prototype;h._initializeTessellator=function(c){var e=v.LineMaterialKey.load(this._materialKey);const f=this._tessellationOptions;e=e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue;f.thin=this.tessellationProperties._halfWidth<
t.THIN_LINE_THRESHOLD/2&&!c&&!e;f.trackDistance=this._isDashed||this._hasPattern;f.wrapDistance=65535;f.innerBisectorAutoSplitThreshold=q;f.outerBisectorAutoSplitThreshold=q;f.enableInnerBisectorSplit=this._isDashed||this._hasPattern;f.enableOuterBisectorSplit=this._isDashed||this._hasPattern;f.thin?this._tessellationCallbacks={vertex:x(this.tessellationProperties),bridge:y(this.tessellationProperties)}:(c=new n.StandardTessellationCallbacks(z(this.tessellationProperties),A(this.tessellationProperties)),
c.miterLimitCosine=this._miterLimitCosine,c.textured=this._isDashed||this._hasPattern,c.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=c)};h._write=function(c,e,f){const k="esriGeometryPoint"===e.geometryType;c.recordStart(e.getDisplayId(),this._materialKey,this.geometryType,!1,k);this._writeGeometry(c,e,f,k);c.recordEnd()};h._writeGeometry=function(c,e,f,k){f=null!=f?f:e.readLegacyGeometry();k=this._getLines(f,k);p.isNone(k)||this._writeVertices(c,e,k)};h._getLines=function(c,e){if(p.isNone(c))return null;
c=c.paths||c.rings;return p.isNone(c)?null:w.clipLinesMarshall(c,e?256:16)};h._writeVertices=function(c,e,f){e=e.getDisplayId();const k=c.vertexCount(),l=this.tessellationProperties;l.out=c;l.id=e;l.indexCount=0;l.vertexCount=0;l.offset=k;for(const {line:m,start:B}of f)this._tessellationOptions.initialDistance=B%65535,this._tessellationCallbacks instanceof n.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),n.tessellate(m,
this._tessellationOptions,this._tessellationCallbacks),n.cleanup()};return a}(b)});