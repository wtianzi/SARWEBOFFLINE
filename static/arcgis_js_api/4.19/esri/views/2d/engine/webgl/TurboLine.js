// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","./mesh/templates/util"],function(w,K){function H(){if(b.cosine<d.innerBisectorAutoSplitThreshold){b.splitInner=!0;b.gapInner=!0;var c=Math.max(d.innerBisectorAutoSplitThreshold,b.cosine);c=Math.sqrt(1-c*c)/c;b.leftInner.x=b.nextNormal.x+b.sign*c*b.outbound.x;b.leftInner.y=b.nextNormal.y+b.sign*c*b.outbound.y;b.rightInner.x=b.prevNormal.x-b.sign*c*b.inbound.x;b.rightInner.y=b.prevNormal.y-b.sign*c*b.inbound.y}else d.enableInnerBisectorSplit&&(b.splitInner=!0,b.gapInner=!1,b.leftInner.x=
b.rightInner.x=b.bisector.x/b.cosine,b.leftInner.y=b.rightInner.y=b.bisector.y/b.cosine);b.cosine<d.outerBisectorAutoSplitThreshold?(b.splitOuter=!0,b.gapOuter=!0,c=Math.max(d.outerBisectorAutoSplitThreshold,b.cosine),c=Math.sqrt(1-c*c)/c,b.leftOuter.x=b.prevNormal.x-b.sign*c*b.inbound.x,b.leftOuter.y=b.prevNormal.y-b.sign*c*b.inbound.y,b.rightOuter.x=b.nextNormal.x+b.sign*c*b.outbound.x,b.rightOuter.y=b.nextNormal.y+b.sign*c*b.outbound.y):d.enableOuterBisectorSplit&&(b.splitOuter=!0,b.gapOuter=!1,
b.leftOuter.x=b.rightOuter.x=b.bisector.x/b.cosine,b.leftOuter.y=b.rightOuter.y=b.bisector.y/b.cosine)}function y(){if(A)b.distance=0,A=b.isCap=b.isFirstVertex=b.isLastVertex=!1;else{if(0===q)if(b.isFirstVertex=0===f,m=e[f],0===f){if(q=0,b.closed){b.inbound.x=m.x-e[e.length-2].x;b.inbound.y=m.y-e[e.length-2].y;var c=Math.sqrt(b.inbound.x*b.inbound.x+b.inbound.y*b.inbound.y);b.inbound.x/=c;b.inbound.y/=c}}else b.inbound.x=m.x-z.x,b.inbound.y=m.y-z.y,q=Math.sqrt(b.inbound.x*b.inbound.x+b.inbound.y*
b.inbound.y),b.inbound.x/=q,b.inbound.y/=q;b.distance+q-t<=d.wrapDistance?(f<e.length-1?(b.outbound.x=e[f+1].x-m.x,b.outbound.y=e[f+1].y-m.y,c=Math.sqrt(b.outbound.x*b.outbound.x+b.outbound.y*b.outbound.y),b.outbound.x/=c,b.outbound.y/=c):b.closed?(b.outbound.x=e[1].x-m.x,b.outbound.y=e[1].y-m.y,c=Math.sqrt(b.outbound.x*b.outbound.x+b.outbound.y*b.outbound.y),b.outbound.x/=c,b.outbound.y/=c):(b.outbound.x=b.inbound.x,b.outbound.y=b.inbound.y),0!==f||b.closed||(b.inbound.x=b.outbound.x,b.inbound.y=
b.outbound.y),++f,b.isLastVertex=f===e.length,b.isCap=!b.closed&&(b.isFirstVertex||b.isLastVertex),b.distance+=q-t,t=q=0,A=b.distance+q-t===d.wrapDistance,b.currentVertex.x=m.x,b.currentVertex.y=m.y,z=m,m=null):(b.outbound.x=b.inbound.x,b.outbound.y=b.inbound.y,t+=d.wrapDistance-b.distance,b.distance=d.wrapDistance,A=!0,c=t/q,b.currentVertex.x=(1-c)*z.x+c*m.x,b.currentVertex.y=(1-c)*z.y+c*m.y)}}function F(){b.prevNormal.x=-b.inbound.y;b.prevNormal.y=b.inbound.x;b.nextNormal.x=-b.outbound.y;b.nextNormal.y=
b.outbound.x}function B(){F();b.bisector.x=b.prevNormal.x+b.nextNormal.x;b.bisector.y=b.prevNormal.y+b.nextNormal.y;const c=Math.sqrt(b.bisector.x*b.bisector.x+b.bisector.y*b.bisector.y);.001>c?(b.bisector.x=void 0,b.bisector.y=void 0,b.cosine=0,b.sign=void 0):(b.bisector.x/=c,b.bisector.y/=c,b.cosine=b.bisector.x*b.nextNormal.x+b.bisector.y*b.nextNormal.y,b.sign=0<=b.prevNormal.x*b.nextNormal.y-b.prevNormal.y*b.nextNormal.x?1:-1)}function C(c){r.vertex(b);1===c?(b.leftEntry0=b.entry0,b.leftEntry1=
b.entry1,b.leftEntry2=b.entry2,b.leftExit0=b.exit0,b.leftExit1=b.exit1,b.leftExit2=b.exit2):2===c&&(b.rightEntry0=b.entry0,b.rightEntry1=b.entry1,b.rightEntry2=b.entry2,b.rightExit0=b.exit0,b.rightExit1=b.exit1,b.rightExit2=b.exit2)}function I(c){r.vertex(b);1===c?(b.leftEntry0=b.entry0,b.leftEntry2=b.entry2,b.leftExit0=b.exit0,b.leftExit2=b.exit2):2===c&&(b.rightEntry0=b.entry0,b.rightEntry2=b.entry2,b.rightExit0=b.exit0,b.rightExit2=b.exit2)}let J=function(){this.isCap=this.isLastVertex=this.isFirstVertex=
this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}},e;const d={};let r,f=void 0,q,t,A,z,m;const b=new J;let L=function(){function c(a,l){this.writeVertex=a;this.writeTriangle=l;this.capType=
0;this.joinType=2;this.miterLimitCosine=K.getLimitCosine(2);this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}var g=c.prototype;g.vertex=function(a){var l=2===this.joinType?this.miterLimitCosine:this.roundLimitCosine,u=a.isCap&&0!==this.capType,h=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),
a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(h=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,
a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(H(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<l?(h=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(h=h||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,
1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,
a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<l?(h=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.splitOuter?(h=h||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,
0,-1,a.distance),a.cosine<l?(h=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,
-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<l?(h=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));l=a.canSplit&&(a.splitInner||a.splitOuter)||h||u?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(h&&1!==this.joinType)this.writeTriangle(l,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(u&&1===this.capType||h&&1===this.joinType){let D,E;if(a.isCap){h=Math.PI;u=Math.ceil(h/this.radsPerSlice);var v=h/u;if(a.isFirstVertex){var k=a.prevNormal.x;var n=a.prevNormal.y;D=a.entry0;E=a.entry2}else a.isLastVertex&&(k=-a.nextNormal.x,n=-a.nextNormal.y,D=a.exit2,E=a.exit0)}else k=2*Math.acos(a.cosine),u=Math.ceil(k/this.radsPerSlice),
v=k/u,k=0<a.sign?-a.prevNormal.x:a.nextNormal.x,n=0<a.sign?-a.prevNormal.y:a.nextNormal.y,D=0<a.sign?a.entry2:a.exit0,E=0<a.sign?a.exit2:a.entry0;h=Math.cos(v);v=Math.sin(v);var x=v*k+h*n;k=h*k-v*n;n=x;var p;for(x=0;x<u;++x){var G=p;x<u-1&&(p=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,k,n,a.isFirstVertex?-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,k,n,0,a.sign,a.distance));this.writeTriangle(0===x?D:G,l,x===u-1?E:p);G=v*k+h*n;k=h*k-v*n;n=G}}else u&&
2===this.capType&&(p=a.isFirstVertex?1:-1,this.textured?(k=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-p*a.inbound.x,a.prevNormal.y-p*a.inbound.y,-p,-1,a.distance),n=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-p*a.inbound.x,-a.prevNormal.y-p*a.inbound.y,-p,1,a.distance)):(k=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-p*a.inbound.x,a.prevNormal.y-p*a.inbound.y,0,-1,a.distance),n=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.prevNormal.x-p*a.inbound.x,-a.prevNormal.y-p*a.inbound.y,0,1,a.distance)),0<p?(this.writeTriangle(l,a.entry2,n),this.writeTriangle(l,n,k),this.writeTriangle(l,k,a.entry0)):(this.writeTriangle(l,n,a.exit2),this.writeTriangle(l,k,n),this.writeTriangle(l,a.exit0,k)))};g.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?a.leftExit1:
a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)};return c}(),M=function(){function c(a,l){this.writeVertex=a;this.writeTriangle=l}var g=c.prototype;g.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,
0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};g.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,
a.rightEntry2,a.leftExit2)};return c}();w.StandardTessellationCallbacks=L;w.TessellationState=J;w.ThinTessellationCallbacks=M;w.cleanup=function(){r=e=null};w.splitVertex=H;w.tessellate=function(c,g,a){d.trackDistance=null!=g.trackDistance?g.trackDistance:!1;d.wrapDistance=null!=g.wrapDistance?g.wrapDistance:65535;d.thin=null!=g.thin?g.thin:!1;d.initialDistance=null!=g.initialDistance?g.initialDistance:0;d.enableOuterBisectorSplit=null!=g.enableOuterBisectorSplit?g.enableOuterBisectorSplit:!1;d.outerBisectorAutoSplitThreshold=
null!=g.outerBisectorAutoSplitThreshold?g.outerBisectorAutoSplitThreshold:0;d.enableInnerBisectorSplit=null!=g.enableOuterBisectorSplit?g.enableOuterBisectorSplit:!1;d.innerBisectorAutoSplitThreshold=null!=g.innerBisectorAutoSplitThreshold?g.innerBisectorAutoSplitThreshold:0;e=c;r=a;t=q=f=0;A=!1;m=z=null;b.currentVertex.x=null;b.currentVertex.y=null;b.distance=d.initialDistance;c=e[0];g=e[e.length-1];b.canSplit=!1;b.closed=c.x===g.x&&c.y===g.y;if(!(2>e.length||2===e.length&&b.closed))if(d.thin)if(d.trackDistance)for(y(),
F(),I(1);q-t>d.wrapDistance||f<e.length;)y(),F(),I(2),r.bridge(b),b.leftExit0=b.rightExit0,b.leftExit2=b.rightExit2;else for(;f<e.length;)0<f&&(b.inbound.x=b.outbound.x,b.inbound.y=b.outbound.y),f<e.length-1?(b.outbound.x=e[f+1].x-e[f].x,b.outbound.y=e[f+1].y-e[f].y,c=Math.sqrt(b.outbound.x*b.outbound.x+b.outbound.y*b.outbound.y),b.distance+=c,b.outbound.x/=c,b.outbound.y/=c):(b.outbound.x=b.inbound.x,b.outbound.y=b.inbound.y),0===f&&(b.inbound.x=b.outbound.x,b.inbound.y=b.outbound.y),b.currentVertex.x=
e[f].x,b.currentVertex.y=e[f].y,b.prevNormal.x=-b.inbound.y,b.prevNormal.y=b.inbound.x,b.nextNormal.x=-b.outbound.y,b.nextNormal.y=b.outbound.x,0===f?(r.vertex(b),b.leftEntry0=b.entry0,b.leftEntry2=b.entry2,b.leftExit0=b.exit0,b.leftExit2=b.exit2):(r.vertex(b),b.rightEntry0=b.entry0,b.rightEntry2=b.entry2,b.rightExit0=b.exit0,b.rightExit2=b.exit2,r.bridge(b),b.leftExit0=b.rightExit0,b.leftExit2=b.rightExit2),++f;else{if(d.enableOuterBisectorSplit||0<d.outerBisectorAutoSplitThreshold||d.enableInnerBisectorSplit||
0<d.innerBisectorAutoSplitThreshold)for(b.canSplit=!0,y(),B(),b.splitInner=b.gapInner=b.splitOuter=b.gapOuter=!1,C(1),b.closure0=b.leftEntry0,b.closure1=b.leftEntry1,b.closure2=b.leftEntry2;q-t>d.wrapDistance||f<e.length-1||f<e.length&&(!b.closed||d.trackDistance);)y(),B(),b.splitInner=b.gapInner=b.splitOuter=b.gapOuter=!1,C(2),r.bridge(b),b.leftExit0=b.rightExit0,b.leftExit1=b.rightExit1,b.leftExit2=b.rightExit2;else for(y(),B(),C(1),b.closure0=b.leftEntry0,b.closure1=b.leftEntry1,b.closure2=b.leftEntry2;q-
t>d.wrapDistance||f<e.length-1||f<e.length&&(!b.closed||d.trackDistance);)y(),B(),C(2),r.bridge(b),b.leftExit0=b.rightExit0,b.leftExit1=b.rightExit1,b.leftExit2=b.rightExit2;b.closed&&!d.trackDistance&&(b.rightEntry0=b.closure0,b.rightEntry1=b.closure1,b.rightEntry2=b.closure2,r.bridge(b),b.leftExit0=b.rightExit0,b.leftExit1=b.rightExit1,b.leftExit2=b.rightExit2)}};Object.defineProperty(w,"__esModule",{value:!0})});