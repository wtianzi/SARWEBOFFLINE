// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/HandleOwner ../../core/throttle ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r){const p=B.getLogger("esri.views.2d.layers.labels.LabelManager");E=function(g){function q(v){v=g.call(this,v)||this;v._applyVisibilityPassThrottled=h.throttle(v._applyVisibilityPass,32,y._assertThisInitialized(v));v.lastUpdateId=-1;v.updateRequested=!1;v.view=null;return v}y._inheritsLoose(q,g);var u=q.prototype;u.initialize=function(){this.collisionEngine=new m.CollisionEngine(this.view.featuresTilingScheme);this._layerViewSorter=new r.LayerViewSorter((v,
z)=>{this.collisionEngine.registerLayerView(v,z);this.requestUpdate()},v=>{this.collisionEngine.unregisterLayerView(v);this.requestUpdate()});this.handles.add(this.view.allLayerViews.on("change",v=>{this._layerViewSorter.update(v)}))};u.destroy=function(){this._layerViewSorter.destroy();this.collisionEngine=this._layerViewSorter=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};u.update=function(v){this._applyVisibilityPassThrottled(v)};u.viewChange=function(){this.requestUpdate()};
u.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};u.processUpdate=function(v){this._set("updateParameters",v);this.updateRequested&&(this.updateRequested=!1,this.update(v))};u._applyVisibilityPass=function(v){try{const z=this.view.featuresTilingScheme.getClosestInfoForScale(v.state.scale).level;this.collisionEngine.run(v,z)}catch(z){p.error(new e("mapview-labeling","Encountered an error during label decluttering",z))}};y._createClass(q,[{key:"updating",
get:function(){return this.updateRequested}}]);return q}(l.HandleOwnerMixin(n));D.__decorate([k.property()],E.prototype,"updateRequested",void 0);D.__decorate([k.property({readOnly:!0})],E.prototype,"updateParameters",void 0);D.__decorate([k.property()],E.prototype,"updating",null);D.__decorate([k.property()],E.prototype,"view",void 0);return E=D.__decorate([b.subclass("esri.views.2d.layers.labels.LabelManager")],E)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./CollisionGrid ./LayerCollisionInfo".split(" "),
function(y,D,E,B,A,k){function c(e,a){const d=[];e.forEachTile(f=>d.push(f));d.sort((f,n)=>f.instanceId-n.instanceId);d.forEach(f=>{E.isSome(f.labelMetrics)&&f.isReady&&a(f,f.labelMetrics.getCursor())})}let b=function(){function e(d){this._layers=new Map;this._tilingScheme=d}var a=e.prototype;a.registerLayerView=function(d,f){this._layers.has(d)||(f=k["default"].create(d,f,this.collisionInfos,this._tilingScheme),this._layers.set(d,f))};a.unregisterLayerView=function(d){if(this._layers.has(d)){var f=
this._layers.get(d);k["default"].delete(f.index,this.collisionInfos);this._layers.delete(d)}};a.run=function(d,f){this._transformMetrics(d);this._runCollision(d,f)};a._runCollision=function(d,f){const [n,l]=d.state.size,h=new A.CollisionBitsetGrid(n,l);this._forEachLayer((m,r)=>{m=m.zoomRanges.some(g=>"none"===g.deconflictionStrategy);const p=r.featuresView.attributeView;m?c(r,(g,q)=>{for(;q.nextId();)p.setLabelMinZoom(q.id,0)}):(this._prepare(r),this._collideVisible(h,r,f),this._collideInvisible(h,
r))})};a._isFiltered=function(d,f,n){d=f.getFilterFlags(d);f=!n.effect||n.effect.excludedLabelsVisible||!!(d&B.EFFECT_FLAG_0);return!((!n.hasFilter||d&B.FILTER_FLAG_0)&&f)};a._prepare=function(d){const f=d.featuresView.attributeView,n=new Set;c(d,(l,h)=>{for(;h.nextId();)n.has(h.id)||(n.add(h.id),this._isFiltered(h.id,f,d.layerView)?f.setLabelMinZoom(h.id,254):0!==f.getLabelMinZoom(h.id)?f.setLabelMinZoom(h.id,255):f.setLabelMinZoom(h.id,0))})};a._collideVisible=function(d,f,n){const l=f.featuresView.attributeView,
h=new Set;c(f,(m,r)=>{for(;r.nextId();)if(!h.has(r.id))if(m.key.level!==n)l.setLabelMinZoom(r.id,254);else if(0===l.getLabelMinZoom(r.id))switch(d.insertMetrics(r)){case A.HAS_COLLISION:l.setLabelMinZoom(r.id,254);h.add(r.id);break;case A.NONE:l.setLabelMinZoom(r.id,0),h.add(r.id)}})};a._collideInvisible=function(d,f){const n=f.featuresView.attributeView,l=new Set;c(f,(h,m)=>{for(;m.nextId();)if(!l.has(m.id)&&255===n.getLabelMinZoom(m.id))switch(d.insertMetrics(m)){case A.HAS_COLLISION:n.setLabelMinZoom(m.id,
255);l.add(m.id);break;case A.NONE:n.setLabelMinZoom(m.id,0),l.add(m.id)}})};a._transformMetrics=function(d){this._forEachLayer((f,n)=>{c(n,(l,h)=>{const m=n.featuresView.attributeView;l=l.transforms.labelMat2d;l[4]=Math.round(l[4]);l[5]=Math.round(l[5]);const r=l[4],p=l[5],g="polyline"===f.geometryType;for(;h.next();){const t=h.boundsCount,w=h.anchorX,x=h.anchorY;var q=0,u=0;f.hasVV()&&(q=m.getVVSize(h.id),q=f.vvEval(q),u=isNaN(q)||null==q||Infinity===q?h.size:q,q=u/2*h.directionX,u=u/2*h.directionY);
for(let C=0;C<t;C++){var v=w,z=h.anchorY;g?(v=v+h.boundsCenterX(C)+q,z=z+h.boundsCenterY(C)+u,d.state.rotation?(v=l[0]*v+l[2]*z+l[4],z=l[1]*v+l[3]*z+l[5]):(v+=r,z+=p),h.setBoundsComputedAnchorX(C,Math.floor(v)),h.setBoundsComputedAnchorY(C,Math.floor(z))):(d.state.rotation?(v=l[0]*w+l[2]*x+l[4],z=l[1]*w+l[3]*x+l[5]):(v+=r,z+=p),v=v+h.boundsCenterX(C)+q,z=z+h.boundsCenterY(C)+u,h.setBoundsComputedAnchorX(C,v),h.setBoundsComputedAnchorY(C,z))}}})})};a._forEachLayer=function(d){const f=[];this._layers.forEach(n=>
f.push(n));f.sort((n,l)=>n.order-l.order);f.forEach(n=>{var l;const h=null==(l=n.layerView)?void 0:l.tileRenderer;h&&d(n,h)})};D._createClass(e,[{key:"collisionInfos",get:function(){return Array.from(this._layers.values())}}]);return e}();y.CollisionEngine=b;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(y){y.ANGLE_FACTOR_256=256/360;y.ATTRIBUTE_DATA_ANIMATION=1;y.ATTRIBUTE_DATA_DD0=3;y.ATTRIBUTE_DATA_DD1=3;y.ATTRIBUTE_DATA_FILTER_FLAGS=
0;y.ATTRIBUTE_DATA_VV=2;y.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;y.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};y.BUFFER_DATA_MINIMUM_SIZE=128;y.BUFFER_DATA_POOL_SIZE=4;y.COLLISION_BOX_PADDING=16;y.COLLISION_BUCKET_SIZE=128;y.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;y.COLLISION_MAX_ZOOM_DELTA=1;y.COLLISION_PLACEMENT_PADDING=8;y.COLLISION_TILE_BOX_SIZE=4;y.DEBUG_LABELS=!1;y.DISPLAY_RECORD_INT_PER_ELEMENT=7;y.DOT_DENSITY_MAX_FIELDS=8;y.EFFECT_FLAG_0=4;y.ENABLE_EARLY_LABEL_DISCARD=
!1;y.EXTRUDE_SCALE=64;y.FILTER_FLAG_0=2;y.GLYPH_SIZE=24;y.HEURISTIC_GLYPHS_PER_FEATURE=10;y.HEURISTIC_GLYPHS_PER_LINE=50;y.HIGHLIGHT_FLAG=1;y.HITTEST_SEARCH_SIZE=6;y.MAGIC_LABEL_LINE_HEIGHT=29;y.MAX_FILTERS=2;y.MAX_GPU_UPLOADS_PER_FRAME=2;y.NAN_MAGIC_NUMBER=1E-30;y.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;y.PICTURE_FILL_COLOR=4294967295;y.RASTER_TILE_SIZE=256;y.SPRITE_PADDING=2;y.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;y.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;y.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;y.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;y.TEXTURE_BINDING_BITMAP=0;y.TEXTURE_BINDING_GLYPH_ATLAS=0;y.TEXTURE_BINDING_HIGHLIGHT_0=5;y.TEXTURE_BINDING_HIGHLIGHT_1=6;y.TEXTURE_BINDING_RENDERER_0=5;y.TEXTURE_BINDING_RENDERER_1=6;y.TEXTURE_BINDING_SPRITE_ATLAS=0;y.TEXT_PLACEMENT_PADDING=8;y.THIN_LINE_THRESHOLD=2.5;y.TILE_SIZE=512;y.VTL_HIGH_RES_CUTOFF=1.15;y.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;y.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;y.WEBGL_MAX_INNER_STOPS=6;y.WEBGL_MAX_STOPS=8;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports",
"../../../../../core/mathUtils","../../../layers/features/support/StaticBitSet","../definitions"],function(y,D,E,B){let A=function(){function c(e,a){this.width=e;this.height=a;e=Math.ceil(e/1);a=Math.ceil(a/1);this._cols=e;this._rows=a;this._cells=E.StaticBitSet.create(e*a)}var b=c.prototype;b.insertMetrics=function(e){const a=this._hasCollision(e);0===a&&this._markMetrics(e);return a};b.getCellId=function(e,a){return e+a*this._cols};b.has=function(e){return this._cells.has(e)};b.hasRange=function(e,
a){return this._cells.hasRange(e,a)};b.set=function(e){this._cells.set(e)};b.setRange=function(e,a){this._cells.setRange(e,a)};b._hasCollision=function(e){const a=e.id;let d=0,f=0;e.save();do{const n=e.boundsCount;d+=n;for(let l=0;l<n;l++){const h=e.boundsComputedAnchorX(l),m=e.boundsComputedAnchorY(l),r=e.boundsWidth(l)+2,p=e.boundsHeight(l)+2;switch(this._collide(h,m,r,p)){case 2:return 2;case 1:f++}}}while(e.peekId()===a&&e.next());e.restore();return d===f?1:0};b._collide=function(e,a,d,f){var n=
e-d/2;e+=d/2;d=a-f/2;a+=f/2;if(0>e||0>a||n>this.width||d>this.height)return 1;n=D.clamp(Math.floor(n/1),0,this._cols);f=D.clamp(Math.floor(d/1),0,this._rows);e=D.clamp(Math.ceil(e/1),0,this._cols);for(a=D.clamp(Math.ceil(a/1),0,this._rows);f<=a;f++)for(d=n;d<=e;d++){const l=this.getCellId(d,f);if(this.has(l))return 2}return 0};b._mark=function(e,a,d,f){var n=e+d/2,l=a-f/2;a+=f/2;e=D.clamp(Math.floor(e-d/2),0,this._cols);d=D.clamp(Math.floor(l/1),0,this._rows);n=D.clamp(Math.ceil(n/1),0,this._cols);
l=D.clamp(Math.ceil(a/1),0,this._rows);for(a=d;a<=l;a++)for(d=e;d<=n;d++)f=this.getCellId(d,a),this.set(f);return!1};b._markMetrics=function(e){const a=e.id;do{const d=e.boundsCount;for(let f=0;f<d;f++){const n=e.boundsComputedAnchorX(f),l=e.boundsComputedAnchorY(f),h=e.boundsWidth(f)+2,m=e.boundsHeight(f)+2;this._mark(n,l,h,m)}}while(e.peekId()===a&&e.next())};return c}(),k=function(){function c(e,a=2){this._bucketSize=e;this._rowsLength=B.TILE_SIZE/e;this._colsLength=B.TILE_SIZE/e;this._elementsPerBucket=
a;this._grid=this._initGrid()}var b=c.prototype;b.checkOverlap=function(e,a){e=Math.floor(e/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>e||e>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a*this._colsLength+e]>=this._elementsPerBucket};b.markUsed=function(e,a){this._grid[Math.floor(a/this._bucketSize)*this._colsLength+Math.floor(e/this._bucketSize)]+=1};b.reset=function(){this._grid=this._initGrid()};b._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};
return c}();y.CollisionBitsetGrid=A;y.CollisionGrid=k;y.HAS_COLLISION=2;y.NONE=0;y.OUTSIDE_EXTENT=1;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(y){let D=function(){function E(A,k){this._mask=0;this._buf=A;this._mask=k}E.fromBuffer=function(A,k){return new E(A,k)};E.create=function(A,k=4294967295){A=new Uint32Array(Math.ceil(A/32));return new E(A,k)};var B=E.prototype;B._getIndex=function(A){return Math.floor(A/
32)};B.has=function(A){A&=this._mask;return!!(this._buf[this._getIndex(A)]&1<<A%32)};B.hasRange=function(A,k){for(;A%32&&A!==k;){if(this.has(A))return!0;A++}for(;k%32&&A!==k;){if(this.has(A))return!0;k--}if(A===k)return!1;for(A/=32;A!==k/32;A++)if(this._buf[A])return!0;return!1};B.set=function(A){A&=this._mask;const k=this._getIndex(A);this._buf[k]|=1<<A%32};B.setRange=function(A,k){for(;A%32&&A!==k;)this.set(A++);for(;k%32&&A!==k;)this.set(k--);if(A!==k)for(A/=32;A!==k/32;A++)this._buf[A]=4294967295};
B.unset=function(A){A&=this._mask;const k=this._getIndex(A);this._buf[k]&=4294967295^1<<A%32};B.resize=function(A){const k=this._buf;A=new Uint32Array(Math.ceil(A/32));A.set(k);this._buf=A};B.or=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]|=A._buf[k];return this};B.and=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]&=A._buf[k];return this};B.xor=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]^=A._buf[k];return this};B.ior=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]|=
~A._buf[k];return this};B.iand=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]&=~A._buf[k];return this};B.ixor=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]^=~A._buf[k];return this};B.any=function(){for(let A=0;A<this._buf.length;A++)if(this._buf[A])return!0;return!1};B.copy=function(A){for(let k=0;k<this._buf.length;k++)this._buf[k]=A._buf[k];return this};B.clone=function(){return new E(this._buf.slice(),this._mask)};B.clear=function(){for(let A=0;A<this._buf.length;A++)this._buf[A]=
0};B.forEachSet=function(A){for(let k=0;k<this._buf.length;k++){let c=this._buf[k],b=32*k;if(c)for(;c;)c&1&&A(b),c>>>=1,b++}};B.countSet=function(){let A=0;this.forEachSet(k=>{A++});return A};return E}();y.StaticBitSet=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define(["exports","../../../../../core/Logger","../../../../../core/mathUtils","../../../../../core/screenUtils","./visualVariableSimpleUtils"],function(y,D,E,
B,A){function k(f,n){const l=!!f.maxScale,h=!!f.minScale&&n.scaleToZoom(f.minScale)||0;n=l&&n.scaleToZoom(f.maxScale)||255;return{deconflictionStrategy:f.deconflictionStrategy,minZoom:E.clamp(Math.floor(10*h),0,255),maxZoom:E.clamp(Math.floor(10*n),0,255)}}function c(f){return n=>B.pt2px(A.getSizeForValueSimple(n,f))}function b(f){if(!f)return null;for(const n of f)if("size"===n.type)return c(n);return null}const e=(f,n)=>f.order-n.order,a=(f,n)=>f.index-n.index,d=D.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");
D=function(){function f(l,h,m,r){this._vvHandle=null;var p=l.layer;const {geometryType:g,labelingInfo:q,renderer:u}=p;u&&(this.vvEval=b("visualVariables"in u&&u.visualVariables));this._vvHandle=p.watch("renderer",z=>{z&&(this.vvEval=b("visualVariables"in z&&z.visualVariables))});var v=(p=p.featureReduction)&&"cluster"===p.type&&p.labelingInfo;p=(q||[]).map(z=>k(z,r));v=(v||[]).map(z=>k(z,r));this.layerView=l;this.geometryType=g;this.index=h;this.order=m;this.zoomRanges=[...p,...v];this.layerView=
l}var n=f.prototype;n.hasVV=function(){return!!this.vvEval};n.allOrNothing=function(){return"polyline"!==this.geometryType};n.destroy=function(){this._vvHandle.remove()};f.create=function(l,h,m,r){m=m.sort(e);let p=!1,g=-1;for(const q of m)!p&&q.order>h&&(g=q.index,p=!0),p&&q.index++;p||(g=m.length);return new f(l,g,h,r)};f.delete=function(l,h){const m=h.sort(a);for(let r=l+1;r<m.length;r++)h[r].index--;h[l].destroy();h.splice(l,1)};f.find=function(l,h){for(const m of h)if(m.index===l)return m;d.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");
return null};return f}();y.createLabelVVEvaluator=b;y.default=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils"],function(y,D,E){function B(b,e){switch(e.transformationType){case "additive":var a=A(e.minSize,b);return b+=a||e.minDataValue;case "constant":return a=(a=e.stops)&&a.length&&a[0].size,null==a&&(a=e.minSize),b=A(a,
b);case "clamped-linear":a=(b-e.minDataValue)/(e.maxDataValue-e.minDataValue);var d=A(e.minSize,b),f=A(e.maxSize,b);b=b<=e.minDataValue?d:b>=e.maxDataValue?f:d+a*(f-d);return b;case "proportional":return a=b/e.minDataValue,d=A(e.minSize,b),b=A(e.maxSize,b),b=D.clamp(a*d,d,b);case "stops":{const [n,l,h]=k(b,e.cache.ipData);n===l?b=A(e.stops[n].size,b):(a=A(e.stops[n].size,b),b=A(e.stops[l].size,b),b=a+(b-a)*h)}return b;case "real-world-size":{a=E.meterIn[e.valueUnit];d=A(e.minSize,b);f=A(e.maxSize,
b);({valueRepresentation:e}=e);let n=null;n="area"===e?2*Math.sqrt(b/c)/a:"radius"===e||"distance"===e?2*b/a:b/a;b=D.clamp(n,d,f)}return b;case "identity":return b;case "unknown":return null}}function A(b,e){return"number"===typeof b?b:B(e,b)}function k(b,e){if(e){var a=0,d=e.length-1;e.some((f,n)=>{if(b<f)return d=n,!0;a=n;return!1});return[a,d,(b-e[a])/(e[d]-e[a])]}}const c=Math.PI;y.getSizeForValueSimple=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["exports",
"../../../../../core/Logger","../../../../../core/Error"],function(y,D,E){function B(k){return"esri.views.2d.layers.FeatureLayerView2D"===k.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===k.declaredClass}const A=D.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");D=function(){function k(b,e){this.registerLayer=b;this.unregisterLayer=e;this._layerViewState=new Map}var c=k.prototype;c.findIndex=function(b){return b.view.allLayerViews.findIndex(e=>e.uid===b.uid)};c.update=function(b){const {added:e,
removed:a}=b;for(const d of a)B(d)&&this._layerViewState.has(d)&&this._deleteState(d);for(const d of e){if(b=B(d))a:if(d.layer&&d.layer.renderer)switch(d.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":b=!0;break a;default:A.error(new E("mapview-labeling",`Renderer of type ${d.layer.renderer.type} does not currently support labeling`)),b=!1}else b=!1;b&&!this._layerViewState.has(d)&&this._createState(d)}this._recomputeOrder()};c.destroy=
function(){this._layerViewState.forEach(b=>b.handles.forEach(e=>e.remove()))};c._createState=function(b){const e={priority:-1,handles:null};e.handles=[b.layer.watch("visible",this._recomputeOrder.bind(this)),b.layer.watch("labelsVisible",this._recomputeOrder.bind(this)),b.layer.watch("labelingInfo",this._recomputeOrder.bind(this)),b.layer.watch("featureReduction",this._recomputeOrder.bind(this))];this._layerViewState.set(b,e);return e};c._deleteState=function(b){if(this._layerViewState.has(b)){var e=
this._layerViewState.get(b);e.handles.forEach(a=>a.remove());-1!==e.priority&&this.unregisterLayer(b);this._layerViewState.delete(b)}};c._recomputeOrder=function(){this._layerViewState.forEach((b,e)=>{var a=e.view.map.allLayers.findIndex(n=>n.uid===e.layer.uid);const d=e.layer;var f=d.featureReduction;f=f&&"cluster"===f.type&&f.labelsVisible&&f.labelingInfo&&f.labelingInfo.length;f=d.labelsVisible&&d.labelingInfo&&d.labelingInfo.length||f;a=d.visible&&f?4294967295-a:-1;a!==b.priority&&(b.priority=
a,this.unregisterLayer(e),-1!==a&&this.registerLayer(e,a))})};return k}();y.LayerViewSorter=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../core/Error ../../../core/events ../../../core/scheduling ../../../chunks/common ../../../core/watchUtils ../../../chunks/vec2f64 ../../support/screenshotUtils ../../../chunks/vec2 ../../webgl/context-util ../../../chunks/mat2d ../../../chunks/mat2df64 ../support/Timeline ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/programUtils ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ./webgl/enums ./Container ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/cpuMapped/BufferDataPool ./webgl/shaders/StencilPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z,t,w,x,C,F,H,J,K,N){m=function(R){function I(G,M){var P=R.call(this)||this;P._trash=new Set;P._clipData=new Float32Array(8);P._upperLeft=e.create();P._upperRight=e.create();P._lowerLeft=e.create();P._lowerRight=e.create();P._mat2=l.create();P._clipRendererInitialized=!1;P._supersampleScreenshots=!0;P._pools={bufferData:new K.BufferDataPool};P.renderRequested=!1;P.stage=D._assertThisInitialized(P);P._stationary=!0;const {canvas:T=document.createElement("canvas"),
alpha:Y=!0,stencil:Z=!0,renderContext:ca="webgl",supersampleScreenshots:ia=!0,contextOptions:da={}}=M;P._canvas=T;const ja=f.createContextOrErrorHTML(T,{alpha:Y,antialias:!1,depth:!0,stencil:Z},ca);P.context=new t(ja,da);P.painter=new F(P.context,D._assertThisInitialized(P));E("esri-2d-profiler")&&(P._debugOutput=document.createElement("div"),P._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),G.appendChild(P._debugOutput));P._renderParameters={drawPhase:0,state:P.state,
pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:P.context,painter:P.painter,timeline:M.timeline||new h.Timeline,renderingOptions:M.renderingOptions,requireFBO:!1,driverTestResult:J.testWebGLDriver(P.context),profiler:new H.Profiler(P.context,P._debugOutput),dataUploadCounter:0};P._taskHandle=k.addFrameTask({render:la=>P.renderFrame(la)});P._taskHandle.pause();P._supersampleScreenshots=ia;P._lostWebGLContextHandle=
A.on(T,"webglcontextlost",()=>{P.emit("webgl-error",{error:new B("webgl-context-lost")})});T.setAttribute("style","width: 100%; height:100%; display:block;");G.appendChild(T);return P}D._inheritsLoose(I,R);var L=I.prototype;L.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this._pools.bufferData.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};L.trashDisplayObject=
function(G){this._trash.add(G);this.requestRender()};L.untrashDisplayObject=function(G){return this._trash.delete(G)};L.requestRender=function(){this._lastRenderRequestTime=performance.now();this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};L.renderFrame=function(G){2E3<=G.time-this._lastRenderRequestTime&&this._taskHandle.pause();this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=
window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=G.time;this._renderParameters.deltaTime=G.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};L.renderChildren=function(G){for(const M of this.children)M.beforeRender(G);this._renderChildren(this.children,G);for(const M of this.children)M.afterRender(G)};L._renderChildren=function(G,M){const P=this.context;M.profiler.recordStart("drawLayers");
M.dataUploadCounter=0;this._beforeRenderChildren(M);M.drawPhase=x.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(P,this.background);for(const T of G)T.processRender(M);this.painter.renderLayers(P);M.drawPhase=x.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(P);for(const T of G)T.processRender(M);this.painter.renderLayers(P);if(this._isLabelDrawPhaseRequired(G)){M.drawPhase=x.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(P);for(const T of G)T.processRender(M);this.painter.renderLayers(P)}if(E("esri-tiles-debug")){M.drawPhase=
x.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(P);for(const T of G)T.processRender(M);this.painter.renderLayers(P)}M.profiler.recordEnd("drawLayers");this._afterRenderChildren()};L._beforeRenderChildren=function(G){const {context:M}=this,{state:P,pixelRatio:T}=G;M.enforceState();const {size:Y,rotation:Z}=P;var ca=Math.round(Y[0]*T);G=Math.round(Y[1]*T);this._boundFBO=M.getBoundFramebufferObject();if(P.spatialReference&&(P.spatialReference._isWrappable?P.spatialReference._isWrappable():P.spatialReference.isWrappable)){var ia=
c.toRadian(Z),da=Math.abs(Math.cos(ia)),ja=Math.abs(Math.sin(ia)),la=Math.round(P.worldScreenWidth);if(Math.round(ca*da+G*ja)<=la)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===ca&&this._clipFBO.height===G||(this._clipFBO=new u(M,{colorTarget:0,depthStencilTarget:3,width:ca,height:G}));var fa=(this.state.padding.left-this.state.padding.right)/2,Q=(this.state.padding.bottom-this.state.padding.top)/2,V=.5*ca,O=.5*G,U=1/ca,W=1/G;la=.5*la*T;var ba=.5*(ca*ja+G*da);ca=this._upperLeft;da=this._upperRight;
ja=this._lowerLeft;var ea=this._lowerRight;d.set(ca,-la,-ba);d.set(da,la,-ba);d.set(ja,-la,ba);d.set(ea,la,ba);n.identity(this._mat2);n.translate(this._mat2,this._mat2,[V+fa,O+Q]);0!==Z&&n.rotate(this._mat2,this._mat2,ia);d.transformMat2d(ca,ca,this._mat2);d.transformMat2d(da,da,this._mat2);d.transformMat2d(ja,ja,this._mat2);d.transformMat2d(ea,ea,this._mat2);ia=this._clipData;ia.set([2*ja[0]*U-1,2*(G-ja[1])*W-1,2*ea[0]*U-1,2*(G-ea[1])*W-1,2*ca[0]*U-1,2*(G-ca[1])*W-1,2*da[0]*U-1,2*(G-da[1])*W-1]);
this._clipRendererInitialized||this._initializeClipRenderer(M);this._clipVBO.setData(ia);this._boundFBO=M.getBoundFramebufferObject();M.bindFramebuffer(this._clipFBO);M.setDepthWriteEnabled(!0);M.setStencilWriteMask(255);M.setClearColor(0,0,0,0);M.setClearDepth(1);M.setClearStencil(0);M.clear(M.gl.COLOR_BUFFER_BIT|M.gl.DEPTH_BUFFER_BIT|M.gl.STENCIL_BUFFER_BIT);M.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};L._afterRenderChildren=function(){const G=this.context;G.logIno();
if(this._clipFrame&&this._clipRendererInitialized){G.bindFramebuffer(this._boundFBO);this._boundFBO=null;G.bindVAO(this._clipVAO);G.bindProgram(this._clipStencilProgram);G.setDepthWriteEnabled(!1);G.setDepthTestEnabled(!1);G.setStencilTestEnabled(!0);G.setBlendingEnabled(!1);G.setColorMask(!1,!1,!1,!1);G.setStencilOp(7680,7680,7681);G.setStencilWriteMask(255);G.setStencilFunction(519,1,255);G.drawElements(4,6,5123,0);G.bindVAO();G.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:M,g:P,
b:T,a:Y}=this.background.color;G.setClearColor(Y*M/255,Y*P/255,Y*T/255,Y)}else G.setClearColor(0,0,0,0);G.clear(G.gl.COLOR_BUFFER_BIT);G.setBlendingEnabled(!0);G.setStencilFunction(514,1,255);this.painter.blitTexture(G,this._clipFBO.colorTexture,9728,1);G.setStencilTestEnabled(!1)}};L.doRender=function(G){const M=this.context,{state:P,pixelRatio:T}=G;this._resizeCanvas(G);this.context.enforceState();M.setViewport(0,0,T*P.size[0],T*P.size[1]);M.setDepthWriteEnabled(!0);M.setStencilWriteMask(255);R.prototype.doRender.call(this,
G)};L.takeScreenshot=async function(G,M){var P=a.screenshotSuperSampleSettings(G,this._supersampleScreenshots,this._state.padding);const {framebufferWidth:T,framebufferHeight:Y}=P;var Z=this.context,ca=G.layers;let ia=this.children;const da={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:P.pixelRatio,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};if(null!=G.rotation){var ja=da.state.viewpoint;
ja.rotation=G.rotation;da.state.viewpoint=ja}0<ca.length&&(ia=[],ca.forEach(fa=>{const Q=M.find(V=>V.layer.id===fa.id);Q&&"container"in Q&&Q.container&&ia.push(Q.container)}));const la=new u(Z,{colorTarget:0,depthStencilTarget:3,width:T,height:Y});ca=Z.getBoundFramebufferObject();ja=Z.getViewport();Z.bindFramebuffer(la);Z.setViewport(0,0,T,Y);this._renderChildren(ia,da);P=this._readbackScreenshot(P);Z.bindFramebuffer(ca);Z.setViewport(ja.x,ja.y,ja.width,ja.height);this.requestRender();Z=this._ensureScreenshotEncodeCanvas();
return a.encodeResult(P,G,Z,{flipY:!0,premultipliedAlpha:!0})};L._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};L._readbackScreenshot=function(G){const {framebufferWidth:M,framebufferHeight:P,region:T,resample:Y}=G;G=this.context.gl;if(Y){var Z=a.createEmptyImageData(M,P,this._ensureScreenshotEncodeCanvas());G.readPixels(0,0,M,P,6408,5121,new Uint8Array(Z.data.buffer));G=a.createEmptyImageData(T.width,
T.height,this._ensureScreenshotEncodeCanvas());return a.resampleHermite(Z,G,!0,Y.region.x,P-(Y.region.y+Y.region.height),Y.region.width,Y.region.height)}Z=a.createEmptyImageData(T.width,T.height,this._ensureScreenshotEncodeCanvas());G.readPixels(T.x,P-(T.y+T.height),T.width,T.height,6408,5121,new Uint8Array(Z.data.buffer));return Z};L._resizeCanvas=function(G){const M=this._canvas,P=M.style,{state:{size:T},pixelRatio:Y}=G;G=T[0];const Z=T[1],ca=Math.round(G*Y),ia=Math.round(Z*Y);if(M.width!==ca||
M.height!==ia)M.width=ca,M.height=ia;P.width=G+"px";P.height=Z+"px"};L._initializeClipRenderer=function(G){if(this._clipRendererInitialized)return!0;const M=N.stencil.attributes,P=v.createProgram(G,N.stencil);if(!P)return!1;const T=r.createVertex(G,35040,32);var Y=new Uint16Array([0,1,2,2,1,3]);Y=r.createIndex(G,35044,Y);G=new g(G,M,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:T},Y);this._clipStencilProgram=P;this._clipVBO=T;this._clipVAO=G;return this._clipRendererInitialized=
!0};L._emptyTrash=function(){for(;0<this._trash.size;){const G=Array.from(this._trash);this._trash.clear();for(const M of G)M.processDetach()}};L._isLabelDrawPhaseRequired=function(G){let M=!1;for(const P of G){if(!(P instanceof C.Container)){M=M||!1;break}if(P.hasLabels)return!0;M=M||this._isLabelDrawPhaseRequired(P.children)}return M};D._createClass(I,[{key:"background",get:function(){return this._background},set:function(G){this._background=G;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},
set:function(G){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=G)this._highlightOptionsHandle=b.init(this._highlightOptions,"version",()=>{this.painter.setHighlightOptions(G);this.requestRender()})}},{key:"pools",get:function(){return this._pools}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(G){this._renderingOptions=G;this.requestRender()}},{key:"state",get:function(){return this._state},
set:function(G){this._state=G;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(G){this._stationary!==G&&(this._stationary=G,this.requestRender())}}]);return I}(C.Container);y.EXTRA_RENDER_TIME=2E3;y.Stage=m;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(y){(function(D){D[D.FILL=0]="FILL";D[D.LINE=1]="LINE";D[D.MARKER=2]="MARKER";D[D.TEXT=3]="TEXT";D[D.LABEL=4]="LABEL"})(y.WGLGeometryType||
(y.WGLGeometryType={}));(function(D){D[D.SUCCEEDED=0]="SUCCEEDED";D[D.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(y.WGLGeometryTransactionStatus||(y.WGLGeometryTransactionStatus={}));(function(D){D[D.NONE=0]="NONE";D[D.MAP=1]="MAP";D[D.LABEL=2]="LABEL";D[D.LABEL_ALPHA=4]="LABEL_ALPHA";D[D.HITTEST=8]="HITTEST";D[D.HIGHLIGHT=16]="HIGHLIGHT";D[D.CLIP=32]="CLIP";D[D.DEBUG=64]="DEBUG";D[D.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(y.WGLDrawPhase||(y.WGLDrawPhase={}));(function(D){D[D.SIZE=0]="SIZE";D[D.COLOR=
1]="COLOR";D[D.OPACITY=2]="OPACITY";D[D.ROTATION=3]="ROTATION"})(y.VVType||(y.VVType={}));(function(D){D[D.NONE=0]="NONE";D[D.OPACITY=1]="OPACITY";D[D.COLOR=2]="COLOR";D[D.ROTATION=4]="ROTATION";D[D.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";D[D.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";D[D.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";D[D.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(y.WGLVVFlag||(y.WGLVVFlag={}));(function(D){D[D.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";D[D.SCALE_TARGETS_OUTLINE=256]=
"SCALE_TARGETS_OUTLINE";D[D.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";D[D.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(y.WGLVVTarget||(y.WGLVVTarget={}));(function(D){D[D.SPRITE=0]="SPRITE";D[D.GLYPH=1]="GLYPH"})(y.MosaicType||(y.MosaicType={}));Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/has","./DisplayObject","../../layers/effects/EffectList"],function(y,
D,E,B,A){const k=E("mapview-transitions-duration");E=function(c){function b(){var a=c.apply(this,arguments)||this;a._childrenSet=new Set;a.children=[];a._effectList=null;return a}D._inheritsLoose(b,c);var e=b.prototype;e.updateTransitionProperties=function(a,d){c.prototype.updateTransitionProperties.call(this,a,d);this._effectList&&(this._effectList.transitionStep(a,d),this._effectList.transitioning&&this.requestRender())};e.doRender=function(a){a=this.createRenderParams(a);this.renderChildren(a)};
e.addChild=function(a){return this.addChildAt(a,this.children.length)};e.addChildAt=function(a,d=this.children.length){if(!a||this.contains(a))return a;const f=a.parent;f&&f!==this&&f.removeChild(a);d>=this.children.length?this.children.push(a):this.children.splice(d,0,a);this._childrenSet.add(a);a.parent=this;a.stage=this.stage;this!==this.stage&&(a.clips=this.clips);this.requestRender();return a};e.contains=function(a){return this._childrenSet.has(a)};e.removeAllChildren=function(){this._childrenSet.clear();
for(const a of this.children)this!==this.stage&&(a.clips=null),a.stage=null,a.parent=null;this.children.length=0};e.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.children.indexOf(a)):a};e.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet.delete(a);this!==this.stage&&(a.clips=null);a.stage=null;a.parent=null;return a};e.sortChildren=function(a){return this.children.sort(a)};e.onAttach=function(){c.prototype.onAttach.call(this);
const a=this.stage;for(const d of this.children)d.stage=a};e.onDetach=function(){c.prototype.onDetach.call(this);for(const a of this.children)a.stage=null};e.renderChildren=function(a){for(const d of this.children)d.beforeRender(a);for(const d of this.children)d.processRender(a);for(const d of this.children)d.afterRender(a)};e.createRenderParams=function(a){return{...a,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:a.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};
D._createClass(b,[{key:"blendMode",get:function(){return this._blendMode},set:function(a){this._blendMode=a;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(a){this._clips=a;this.children.forEach(d=>d.clips=a)}},{key:"computedEffects",get:function(){var a,d;return null!=(a=null==(d=this._effectList)?void 0:d.effects)?a:null}},{key:"effect",get:function(){var a,d;return null!=(a=null==(d=this._effectList)?void 0:d.effect)?a:""},set:function(a){if(this._effectList||
a)this._effectList||(this._effectList=new A["default"](k)),this._effectList.effect=a,this.requestRender()}}]);return b}(B.DisplayObject);y.Container=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/has","../../../core/promiseUtils","../../../core/Evented"],function(y,D,E,B,A){const k=1/E("mapview-transitions-duration");E=function(c){function b(){var a=c.apply(this,arguments)||
this;a._fadeOutResolver=null;a._fadeInResolver=null;a._clips=null;a.computedVisible=!0;a.computedOpacity=1;a.fadeTransitionEnabled=!1;a.inFadeTransition=!1;a._isReady=!1;a._opacity=1;a._stage=null;a._visible=!0;return a}D._inheritsLoose(b,c);var e=b.prototype;e.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=B.createResolver();
this.requestRender();return this._fadeInResolver.promise};e.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=B.createResolver();this.requestRender();return this._fadeOutResolver.promise};e.beforeRender=function(a){this.updateTransitionProperties(a.deltaTime,a.state.scale)};e.afterRender=function(a){this._fadeInResolver&&this.computedOpacity===
this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};e.remove=function(){var a;null==(a=this.parent)?void 0:a.removeChild(this)};e.setTransform=function(a){};e.processRender=function(a){this.stage&&this.computedVisible&&this.doRender(a)};e.requestRender=function(){this.stage&&this.stage.requestRender()};e.processDetach=function(){this.onDetach();this.emit("detach")};e.updateTransitionProperties=
function(a,d){if(this.fadeTransitionEnabled){d=this._fadeOutResolver||!this.visible?0:this.opacity;const f=this.computedOpacity;f===d?this.computedVisible=this.visible:(a*=k,this.computedOpacity=f>d?Math.max(d,f-a):Math.min(d,f+a),this.computedVisible=0<this.computedOpacity,a=d===this.computedOpacity,this.inFadeTransition=!a,a||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};e.onAttach=function(){};e.onDetach=function(){};e.doRender=function(a){};e.ready=
function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};D._createClass(b,[{key:"clips",get:function(){return this._clips},set:function(a){this._clips=a;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=Math.min(1,Math.max(a,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(a){if(this._stage!==a){var d=
this._stage;(this._stage=a)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):d.trashDisplayObject(this)}}},{key:"visible",get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())}}]);return b}(A);y.DisplayObject=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/layers/effects/EffectList":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../core/Logger ../../../core/Error ../../../colorUtils ./effects ./parser".split(" "),
function(y,D,E,B,A,k,c,b){function e(m){if(!m)return[];if("string"===typeof m){var r=b.parse(m);return r.error?r.error:[{scale:-1,effects:r.effects}]}r=[];for(var p of m){if(!isFinite(p.scale)||0>=p.scale)return new A("effect:invalid-scale","scale must be finite and greater than 0",{stop:p});m=b.parse(p.value);if(m.error)return m.error;r.push({scale:p.scale,effects:m.effects})}r.sort((g,q)=>q.effects.length-g.effects.length);for(p=0;p<r.length-1;p++){if(!d(r[p].effects,r[p+1].effects))return new A("effect:interpolation-impossible",
"Cannot interpolate by scale between 2 lists of mixed effects",{a:r[p].effects,b:r[p+1].effects});f(r[p].effects,r[p+1].effects)}r.sort((g,q)=>q.scale-g.scale);return r}function a(m){switch(m.type){case "grayscale":case "sepia":case "invert":return new c.ColorMatrixEffect(m.type,0);case "saturate":case "brightness":case "contrast":return new c.ColorMatrixEffect(m.type,1);case "opacity":return new c.OpacityEffect(1);case "hue-rotate":return new c.HueRotateEffect(0);case "blur":return new c.BlurEffect(0);
case "drop-shadow":return new c.DropShadowEffect(0,0,0,[...k.getNamedColor("transparent")]);case "bloom":return new c.BloomEffect(0,0,0)}}function d(m,r){const p=m.length>r.length?m:r;return(m.length>r.length?r:m).every((g,q)=>g.type===p[q].type)}function f(m,r){const p=m.length>r.length?m:r;m=m.length>r.length?r:m;for(r=m.length;r<p.length;r++)m.push(a(p[r]))}function n(m,r,p){var g,q,u,v;return null!=(g=m[0])&&g.effects&&null!=(q=r[0])&&q.effects?(-1===(null==(u=m[0])?void 0:u.scale)||-1===(null==
(v=r[0])?void 0:v.scale))&&(1<m.length||1<r.length)&&0>=p?!1:d(m[0].effects,r[0].effects):!0}function l(m,r,p){var g,q;const u=m.length>r.length?m:r;m=m.length>r.length?r:m;const v=m[m.length-1];r=null!=(g=null==v?void 0:v.scale)?g:p;g=null!=(q=null==v?void 0:v.effects)?q:[];for(q=m.length;q<u.length;q++)m.push({scale:r,effects:[...g]});for(q=0;q<u.length;q++)m[q].scale=-1===m[q].scale?p:m[q].scale,u[q].scale=-1===u[q].scale?p:u[q].scale,f(m[q].effects,u[q].effects)}let h=function(){function m(p=
200){this.duration=p;this._final=this._to=this._from=null;this._current=[];this._time=0;this._effect="";this._effects=[];this._scale=0}var r=m.prototype;r.transitionStep=function(p,g){this._applyTimeTransition(p);this._updateForScale(g)};r._transitionTo=function(p){0<this.scale&&n(this._current,p,this.scale)?(this._final=p,this._to=E.clone(p),l(this._current,this._to,this.scale),this._from=E.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=p);this._effects=this._current[0]?
E.clone(this._current[0].effects):[]};r._applyTimeTransition=function(p){if(this._to){this._time+=p;p=Math.min(1,this._time/this.duration);for(let q=0;q<this._current.length;q++){const u=this._current[q],v=this._from[q],z=this._to[q];var g=v.scale;u.scale=g+(z.scale-g)*p;for(g=0;g<u.effects.length;g++)u.effects[g].interpolate(v.effects[g],z.effects[g],p)}1===p&&(this._current=this._final,this._effects=this._current[0]?E.clone(this._current[0].effects):[],this._from=this._to=this._final=null)}};r._updateForScale=
function(p){if(0!==this._current.length){this._scale=p;var g=this._current,q=this._current.length-1,u,v=1;if(1===g.length||p>=g[0].scale)var z=u=g[0].effects;else if(p<=g[q].scale)z=u=g[q].effects;else for(let t=0;t<q;t++){const w=g[t],x=g[t+1];if(w.scale>=p&&x.scale<=p){v=(p-w.scale)/(x.scale-w.scale);u=w.effects;z=x.effects;break}}for(p=0;p<this._effects.length;p++)this._effects[p].interpolate(u[p],z[p],v)}};D._createClass(m,[{key:"effect",get:function(){return this._effect},set:function(p){p=p||
"";if(this._effect!==p){this._effect=p;var g=e(p);Array.isArray(g)?this._transitionTo(g):(this._transitionTo([]),B.getLogger("esri.views.layers.effects.EffectList").warn("Invalid Effect",{effect:p,error:g}))}}},{key:"hasEffects",get:function(){return this.transitioning||!!this._effects.length}},{key:"effects",get:function(){return this._effects}},{key:"scale",get:function(){return this._scale}},{key:"transitioning",get:function(){return null!==this._to}}]);return m}();y.canInterpolateEffectStops=
n;y.canInterpolateEffects=d;y.convertEffectToStops=e;y.default=h;y.normalizeEffectStops=l;y.normalizeEffects=f;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/layers/effects/effects":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat4f32","./colorMatrixFunctions"],function(y,D,E,B){function A(f,n,l){return f+(n-f)*l}let k=function(){function f(l,h,m){this.strength=l;this.radius=h;this.threshold=m;this.type="bloom"}var n=f.prototype;n.interpolate=
function(l,h,m){this.strength=A(l.strength,h.strength,m);this.radius=A(l.radius,h.radius,m);this.threshold=A(l.threshold,h.threshold,m)};n.clone=function(){return new f(this.strength,this.radius,this.threshold)};return f}(),c=function(){function f(l){this.radius=l;this.type="blur"}var n=f.prototype;n.interpolate=function(l,h,m){this.radius=Math.round(A(l.radius,h.radius,m))};n.clone=function(){return new f(this.radius)};return f}(),b=function(){function f(l,h){this.type=l;this.amount=h;if("invert"===
this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}var n=f.prototype;n.interpolate=function(l,h,m){this.amount=A(l.amount,h.amount,m);this._updateMatrix()};n.clone=function(){return new f(this.type,this.amount)};n._updateMatrix=function(){const l=this._colorMatrix||E.create();switch(this.type){case "brightness":this._colorMatrix=B.brightness(l,this.amount);break;case "contrast":this._colorMatrix=B.contrast(l,this.amount);break;case "grayscale":this._colorMatrix=
B.grayscale(l,this.amount);break;case "invert":this._colorMatrix=B.invert(l,this.amount);break;case "saturate":this._colorMatrix=B.saturate(l,this.amount);break;case "sepia":this._colorMatrix=B.sepia(l,this.amount)}};D._createClass(f,[{key:"colorMatrix",get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}}]);return f}(),e=function(){function f(l,h,m,r){this.offsetX=l;this.offsetY=h;this.blurRadius=m;this.color=r;this.type="drop-shadow"}var n=f.prototype;n.interpolate=function(l,
h,m){this.offsetX=A(l.offsetX,h.offsetX,m);this.offsetY=A(l.offsetY,h.offsetY,m);this.blurRadius=A(l.blurRadius,h.blurRadius,m);this.color[0]=Math.round(A(l.color[0],h.color[0],m));this.color[1]=Math.round(A(l.color[1],h.color[1],m));this.color[2]=Math.round(A(l.color[2],h.color[2],m));this.color[3]=A(l.color[3],h.color[3],m)};n.clone=function(){return new f(this.offsetX,this.offsetY,this.blurRadius,[...this.color])};return f}(),a=function(){function f(l){this.angle=l;this.type="hue-rotate"}var n=
f.prototype;n.interpolate=function(l,h,m){this.angle=A(l.angle,h.angle,m);this._updateMatrix()};n.clone=function(){return new f(this.angle)};n._updateMatrix=function(){const l=this._colorMatrix||E.create();this._colorMatrix=B.rotateHue(l,this.angle)};D._createClass(f,[{key:"colorMatrix",get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}}]);return f}(),d=function(){function f(l){this.amount=l;this.type="opacity";this.amount=Math.min(this.amount,1)}var n=f.prototype;n.interpolate=
function(l,h,m){this.amount=A(l.amount,h.amount,m)};n.clone=function(){return new f(this.amount)};return f}();y.BloomEffect=k;y.BlurEffect=c;y.ColorMatrixEffect=b;y.DropShadowEffect=e;y.HueRotateEffect=a;y.OpacityEffect=d;y.isColorMatrixEffect=function(f){return"colorMatrix"in f};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/chunks/mat4f32":function(){define(["exports"],function(y){function D(){const b=new Float32Array(16);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}function E(b){const e=new Float32Array(16);
e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];e[6]=b[6];e[7]=b[7];e[8]=b[8];e[9]=b[9];e[10]=b[10];e[11]=b[11];e[12]=b[12];e[13]=b[13];e[14]=b[14];e[15]=b[15];return e}function B(b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z){const t=new Float32Array(16);t[0]=b;t[1]=e;t[2]=a;t[3]=d;t[4]=f;t[5]=n;t[6]=l;t[7]=h;t[8]=m;t[9]=r;t[10]=p;t[11]=g;t[12]=q;t[13]=u;t[14]=v;t[15]=z;return t}function A(b,e){return new Float32Array(b,e,16)}const k=D();var c=Object.freeze({__proto__:null,create:D,clone:E,fromValues:B,
createView:A,IDENTITY:k});y.IDENTITY=k;y.clone=E;y.create=D;y.createView=A;y.fromValues=B;y.mat4f32=c})},"esri/views/layers/effects/colorMatrixFunctions":function(){define(["exports","../../../chunks/mat4"],function(y,D){y.brightness=(E,B)=>{E=D.set(E,B,0,0,0,0,B,0,0,0,0,B,0,0,0,0,1);return D.transpose(E,E)};y.contrast=(E,B)=>{E=D.set(E,B,0,0,.5-.5*B,0,B,0,.5-.5*B,0,0,B,.5-.5*B,0,0,0,1);return D.transpose(E,E)};y.grayscale=(E,B)=>{B=1-B;E=D.set(E,.2126+.7874*B,.7152-.7152*B,.0722-.0722*B,0,.2126-
.2126*B,.7152+.2848*B,.0722-.0722*B,0,.2126-.2126*B,.7152-.7152*B,.0722+.9278*B,0,0,0,0,1);return D.transpose(E,E)};y.invert=(E,B)=>{const A=1-2*B;E=D.set(E,A,0,0,B,0,A,0,B,0,0,A,B,0,0,0,1);return D.transpose(E,E)};y.rotateHue=(E,B)=>{const A=Math.sin(B*Math.PI/180);B=Math.cos(B*Math.PI/180);E=D.set(E,.213+.787*B-.213*A,.715-.715*B-.715*A,.072-.072*B+.928*A,0,.213-.213*B+.143*A,.715+.285*B+.14*A,.072-.072*B-.283*A,0,.213-.213*B-.787*A,.715-.715*B+.715*A,.072+.928*B+.072*A,0,0,0,0,1);return D.transpose(E,
E)};y.saturate=(E,B)=>{E=D.set(E,.213+.787*B,.715-.715*B,.072-.072*B,0,.213-.213*B,.715+.285*B,.072-.072*B,0,.213-.213*B,.715-.715*B,.072+.928*B,0,0,0,0,1);return D.transpose(E,E)};y.sepia=(E,B)=>{B=1-B;E=D.set(E,.393+.607*B,.769-.769*B,.189-.189*B,0,.349-.349*B,.686+.314*B,.168-.168*B,0,.272-.272*B,.534-.534*B,.131+.869*B,0,0,0,0,1);return D.transpose(E,E)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/layers/effects/parser":function(){define(["exports","../../../core/Error","../../../colorUtils",
"../../../chunks/_commonjsHelpers","./effects"],function(y,D,E,B,A){function k(g){try{switch(g.name){case "grayscale":case "sepia":case "saturate":case "invert":case "brightness":case "contrast":var q,u=1;c(g.parameters,1);1===g.parameters.length&&(u=a(g.parameters[0]));return q=new A.ColorMatrixEffect(g.name,u);case "opacity":var v;u=1;c(g.parameters,1);1===g.parameters.length&&(u=a(g.parameters[0]));return v=new A.OpacityEffect(u);case "hue-rotate":var z;u=0;c(g.parameters,1);if(1===g.parameters.length){var t=
g.parameters[0];if("quantity"!==t.type||(0!==t.value||null!==t.unit)&&null==h[t.unit])throw new D("effect:type-error",`Expected <angle>, Actual: ${b(t)}`,{term:t});u=t.value*h[t.unit]||0}return z=new A.HueRotateEffect(u);case "blur":var w;u=0;c(g.parameters,1);1===g.parameters.length&&(u=f(g.parameters[0]),e(u,g.parameters[0]));return w=new A.BlurEffect(u);case "drop-shadow":v=[];for(const H of g.parameters)if("color"===H.type){v.length&&Object.freeze(v);if(C)throw new D("effect:type-error","Accepts only one color",
{});a:{var x=void 0;q=H;switch(q.colorType){case "hex":var C=E.hex2rgba(q.value);break a;case "named":C=n(q.value);break a;case "function":var F=q.value;c(F.parameters,4);if(r.test(F.name))x=[a(F.parameters[0]),a(F.parameters[1]),a(F.parameters[2]),F.parameters[3]?a(F.parameters[3]):1];else if(p.test(F.name))x=E.hsla2rgba(d(F.parameters[0]),a(F.parameters[1]),a(F.parameters[2]),F.parameters[3]?a(F.parameters[3]):1);else throw new D("effect:syntax-error",`Invalid color function '${F.name}'`,{colorFunction:F});
C=x;break a}C=void 0}}else{const J=f(H);if(Object.isFrozen(v))throw new D("effect:type-error","\x3clength\x3e parameters not consecutive",{lengths:v});v.push(J);3===v.length&&e(J,H)}if(2>v.length||3<v.length)throw new D("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${v.length}}`,{lengths:v});return u=new A.DropShadowEffect(v[0],v[1],v[2]||0,C||n("black"));case "bloom":return u=1,C=F=0,c(g.parameters,3),g.parameters[0]&&(u=a(g.parameters[0])),g.parameters[1]&&(F=f(g.parameters[1]),
e(F,g.parameters[1])),g.parameters[2]&&(C=a(g.parameters[2])),x=new A.BloomEffect(u,F,C)}}catch(H){throw H.details.filter=g,H;}throw new D("effect:unknown-effect",`Effect '${g.name}' is not supported`,{effect:g});}function c(g,q){if(g.length>q)throw new D("effect:type-error",`Function supports up to ${q} parameters, Actual: ${g.length}`,{parameters:g});}function b(g){return"color"===g.type?"\x3ccolor\x3e":m[g.unit]?"\x3clength\x3e":h[g.unit]?"\x3cangle\x3e":"%"===g.unit?"\x3cpercentage\x3e":"\x3cdouble\x3e"}
function e(g,q){if(0>g)throw new D("effect:type-error",`Negative values are not allowed, Actual: ${g}`,{term:q});}function a(g){if("quantity"!==g.type||null!==g.unit&&"%"!==g.unit)throw new D("effect:type-error",`Expected <double> or <percentage>, Actual: ${b(g)}`,{term:g});const q=g.value;e(q,g);return"%"===g.unit?.01*q:q}function d(g){if("quantity"!==g.type||null!==g.unit)throw new D("effect:type-error",`Expected <double>, Actual: ${b(g)}`,{term:g});e(g.value,g);return g.value}function f(g){if("quantity"!==
g.type||(0!==g.value||null!==g.unit)&&null==m[g.unit])throw new D("effect:type-error",`Expected <length>, Actual: ${b(g)}`,{term:g});return g.value*m[g.unit]||0}function n(g){const q=E.getNamedColorCopy(g);if(!q)throw new D("effect:unknown-color",`color '${g}' isn't valid`,{namedColor:g});return q}var l=B.createCommonjsModule(function(g){(function(q,u){g.exports&&(g.exports=u())})(B.commonjsGlobal,function(){function q(u,v,z,t){this.message=u;this.expected=v;this.found=z;this.location=t;this.name=
"SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,q)}(function(u,v){function z(){this.constructor=u}z.prototype=v.prototype;u.prototype=new z})(q,Error);q.buildMessage=function(u,v){function z(C){return C.charCodeAt(0).toString(16).toUpperCase()}function t(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(F){return"\\x0"+z(F)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(F){return"\\x"+z(F)})}function w(C){return C.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(F){return"\\x0"+z(F)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(F){return"\\x"+z(F)})}var x={literal:function(C){return'"'+t(C.text)+'"'},"class":function(C){var F="",H;for(H=0;H<C.parts.length;H++)F+=C.parts[H]instanceof Array?w(C.parts[H][0])+"-"+
w(C.parts[H][1]):w(C.parts[H]);return"["+(C.inverted?"^":"")+F+"]"},any:function(C){return"any character"},end:function(C){return"end of input"},other:function(C){return C.description}};return"Expected "+function(C){var F=Array(C.length),H;for(H=0;H<C.length;H++){var J=H;var K=C[H];K=x[K.type](K);F[J]=K}F.sort();if(0<F.length){for(C=H=1;H<F.length;H++)F[H-1]!==F[H]&&(F[C]=F[H],C++);F.length=C}switch(F.length){case 1:return F[0];case 2:return F[0]+" or "+F[1];default:return F.slice(0,-1).join(", ")+
", or "+F[F.length-1]}}(u)+" but "+(v?'"'+t(v)+'"':"end of input")+" found."};return{SyntaxError:q,parse:function(u,v){function z(ha,S){return{type:"literal",text:ha,ignoreCase:S}}function t(ha,S,aa){return{type:"class",parts:ha,inverted:S,ignoreCase:aa}}function w(ha){return{type:"other",description:ha}}function x(ha){var S=Ga[ha],aa;if(!S){for(aa=ha-1;!Ga[aa];)aa--;S=Ga[aa];for(S={line:S.line,column:S.column};aa<ha;)10===u.charCodeAt(aa)?(S.line++,S.column=1):S.column++,aa++;Ga[ha]=S}return S}function C(ha,
S){var aa=x(ha),ka=x(S);return{start:{offset:ha,line:aa.line,column:aa.column},end:{offset:S,line:ka.line,column:ka.column}}}function F(ha){X<za||(X>za&&(za=X,Ha=[]),Ha.push(ha))}function H(){na++;var ha=X;var S=N();S!==G?(u.substr(X,4)===Y?(S=Y,X+=4):(S=G,0===na&&F(Z)),S!==G?(S=N(),S!==G?(sa=ha,ha=S=[]):(X=ha,ha=G)):(X=ha,ha=G)):(X=ha,ha=G);na--;ha===G&&(S=G,0===na&&F(T));if(ha===G)if(ha=[],S=J(),S!==G)for(;S!==G;)ha.push(S),S=J();else ha=G;return ha}function J(){var ha=X;var S=N();if(S!==G){na++;
S=X;var aa=R();if(aa!==G){if(40===u.charCodeAt(X)){var ka=O;X++}else ka=G,0===na&&F(U);ka!==G?(sa=S,S=aa):(X=S,S=G)}else X=S,S=G;na--;S===G&&(aa=G,0===na&&F(V));if(S!==G)if(aa=N(),aa!==G){ka=X;var wa=K();if(wa!==G){aa=[];var ra=X;var Da=N();if(Da!==G){if(44===u.charCodeAt(X)){var ya=da;X++}else ya=G,0===na&&F(ja);ya===G&&(ya=null);if(ya!==G){var Ea=N();if(Ea!==G){var Fa=K();Fa!==G?ra=Da=[Da,ya,Ea,Fa]:(X=ra,ra=G)}else X=ra,ra=G}else X=ra,ra=G}else X=ra,ra=G;for(;ra!==G;)aa.push(ra),ra=X,Da=N(),Da!==
G?(44===u.charCodeAt(X)?(ya=da,X++):(ya=G,0===na&&F(ja)),ya===G&&(ya=null),ya!==G?(Ea=N(),Ea!==G?(Fa=K(),Fa!==G?ra=Da=[Da,ya,Ea,Fa]:(X=ra,ra=G)):(X=ra,ra=G)):(X=ra,ra=G)):(X=ra,ra=G);aa!==G?(sa=ka,ka=wa,ka=wa=0<aa.length?[ka].concat(L(aa,3)):[ka]):(X=ka,ka=G)}else X=ka,ka=G;aa=ka;aa===G&&(aa=null);aa!==G?(ka=N(),ka!==G?(41===u.charCodeAt(X)?(ka=ca,X++):(ka=G,0===na&&F(ia)),ka!==G?(ka=N(),ka!==G?(sa=ha,ha=S={type:"function",name:S,parameters:aa||[]}):(X=ha,ha=G)):(X=ha,ha=G)):(X=ha,ha=G)):(X=ha,ha=
G)}else X=ha,ha=G;else X=ha,ha=G}else X=ha,ha=G;return ha}function K(){var ha=X;na++;var S=X;var aa=N();if(aa!==G)if(aa=I(),aa!==G){if(37===u.charCodeAt(X)){var ka=oa;X++}else ka=G,0===na&&F(pa);ka!==G?(sa=S,S=aa={value:aa,unit:"%"}):(X=S,S=G)}else X=S,S=G;else X=S,S=G;na--;S===G&&(aa=G,0===na&&F(ma));S===G&&(na++,S=X,aa=N(),aa!==G?(aa=I(),aa!==G?(u.substr(X,2)===va?(ka=va,X+=2):(ka=G,0===na&&F(ta)),ka!==G?(sa=S,S=aa={value:aa,unit:"px"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=N(),aa!==G?
(aa=I(),aa!==G?(u.substr(X,2)===ua?(ka=ua,X+=2):(ka=G,0===na&&F(Aa)),ka!==G?(sa=S,S=aa={value:aa,unit:"cm"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=N(),aa!==G?(aa=I(),aa!==G?(u.substr(X,2)===xa?(ka=xa,X+=2):(ka=G,0===na&&F(Ta)),ka!==G?(sa=S,S=aa={value:aa,unit:"mm"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=N(),aa!==G?(aa=I(),aa!==G?(u.substr(X,2)===Ia?(ka=Ia,X+=2):(ka=G,0===na&&F(Ua)),ka!==G?(sa=S,S=aa={value:aa,unit:"in"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=N(),aa!==G?
(aa=I(),aa!==G?(u.substr(X,2)===Ja?(ka=Ja,X+=2):(ka=G,0===na&&F(Va)),ka!==G?(sa=S,S=aa={value:aa,unit:"pt"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=N(),aa!==G?(aa=I(),aa!==G?(u.substr(X,2)===Ka?(ka=Ka,X+=2):(ka=G,0===na&&F(Wa)),ka!==G?(sa=S,S=aa={value:aa,unit:"pc"}):(X=S,S=G)):(X=S,S=G)):(X=S,S=G)))))),na--,S===G&&(aa=G,0===na&&F(qa)),S===G&&(na++,S=X,aa=I(),aa!==G?(u.substr(X,3)===La?(ka=La,X+=3):(ka=G,0===na&&F(Xa)),ka!==G?(sa=S,S=aa={value:aa,unit:"deg"}):(X=S,S=G)):(X=S,S=G),S===G&&(S=
X,aa=I(),aa!==G?(u.substr(X,3)===Ma?(ka=Ma,X+=3):(ka=G,0===na&&F(Ya)),ka!==G?(sa=S,S=aa={value:aa,unit:"rad"}):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=I(),aa!==G?(u.substr(X,4)===Na?(ka=Na,X+=4):(ka=G,0===na&&F(Za)),ka!==G?(sa=S,S=aa={value:aa,unit:"grad"}):(X=S,S=G)):(X=S,S=G),S===G&&(S=X,aa=I(),aa!==G?(u.substr(X,4)===Oa?(ka=Oa,X+=4):(ka=G,0===na&&F($a)),ka!==G?(sa=S,S=aa={value:aa,unit:"turn"}):(X=S,S=G)):(X=S,S=G)))),na--,S===G&&(aa=G,0===na&&F(ab)),S===G&&(na++,S=X,aa=N(),aa!==G?(aa=I(),aa!==G?(sa=
S,S=aa={value:aa,unit:null}):(X=S,S=G)):(X=S,S=G),na--,S===G&&(aa=G,0===na&&F(bb)))));S!==G&&(sa=ha,S={type:"quantity",value:S.value,unit:S.unit});ha=S;if(ha===G){ha=X;na++;S=X;35===u.charCodeAt(X)?(aa=cb,X++):(aa=G,0===na&&F(db));if(aa!==G){aa=[];Pa.test(u.charAt(X))?(ka=u.charAt(X),X++):(ka=G,0===na&&F(Qa));if(ka!==G)for(;ka!==G;)aa.push(ka),Pa.test(u.charAt(X))?(ka=u.charAt(X),X++):(ka=G,0===na&&F(Qa));else aa=G;aa!==G?(sa=S,S=aa={type:"hex",value:u.substring(sa,X)}):(X=S,S=G)}else X=S,S=G;S===
G&&(S=X,aa=J(),aa!==G&&(sa=S,aa={type:"function",value:aa}),S=aa,S===G&&(S=X,aa=R(),aa!==G&&(sa=S,aa={type:"named",value:u.substring(sa,X)}),S=aa));na--;S===G&&(aa=G,0===na&&F(eb));S!==G&&(sa=ha,S={type:"color",colorType:S.type,value:S.value});ha=S}return ha}function N(){na++;var ha=[];if(fa.test(u.charAt(X))){var S=u.charAt(X);X++}else S=G,0===na&&F(Q);for(;S!==G;)ha.push(S),fa.test(u.charAt(X))?(S=u.charAt(X),X++):(S=G,0===na&&F(Q));na--;ha===G&&(S=G,0===na&&F(la));return ha}function R(){na++;var ha=
X;var S=[];if(ba.test(u.charAt(X))){var aa=u.charAt(X);X++}else aa=G,0===na&&F(ea);if(aa!==G)for(;aa!==G;)S.push(aa),ba.test(u.charAt(X))?(aa=u.charAt(X),X++):(aa=G,0===na&&F(ea));else S=G;S!==G&&(sa=ha,S=u.substring(sa,X));ha=S;na--;ha===G&&(S=G,0===na&&F(W));return ha}function I(){var ha=X;if(Ra.test(u.charAt(X))){var S=u.charAt(X);X++}else S=G,0===na&&F(Sa);S===G&&(S=null);if(S!==G){var aa=X;S=[];if(Ba.test(u.charAt(X))){var ka=u.charAt(X);X++}else ka=G,0===na&&F(Ca);for(;ka!==G;)S.push(ka),Ba.test(u.charAt(X))?
(ka=u.charAt(X),X++):(ka=G,0===na&&F(Ca));if(S!==G)if(46===u.charCodeAt(X)?(ka=fb,X++):(ka=G,0===na&&F(gb)),ka!==G){var wa=[];if(Ba.test(u.charAt(X))){var ra=u.charAt(X);X++}else ra=G,0===na&&F(Ca);if(ra!==G)for(;ra!==G;)wa.push(ra),Ba.test(u.charAt(X))?(ra=u.charAt(X),X++):(ra=G,0===na&&F(Ca));else wa=G;wa!==G?aa=S=[S,ka,wa]:(X=aa,aa=G)}else X=aa,aa=G;else X=aa,aa=G;if(aa===G)if(aa=[],Ba.test(u.charAt(X))?(S=u.charAt(X),X++):(S=G,0===na&&F(Ca)),S!==G)for(;S!==G;)aa.push(S),Ba.test(u.charAt(X))?(S=
u.charAt(X),X++):(S=G,0===na&&F(Ca));else aa=G;if(aa!==G){S=X;101===u.charCodeAt(X)?(ka=hb,X++):(ka=G,0===na&&F(ib));if(ka!==G)if(Ra.test(u.charAt(X))?(wa=u.charAt(X),X++):(wa=G,0===na&&F(Sa)),wa===G&&(wa=null),wa!==G){ra=[];Ba.test(u.charAt(X))?(aa=u.charAt(X),X++):(aa=G,0===na&&F(Ca));if(aa!==G)for(;aa!==G;)ra.push(aa),Ba.test(u.charAt(X))?(aa=u.charAt(X),X++):(aa=G,0===na&&F(Ca));else ra=G;ra!==G?S=ka=[ka,wa,ra]:(X=S,S=G)}else X=S,S=G;else X=S,S=G;S===G&&(S=null);S!==G?(sa=ha,ha=S=parseFloat(u.substring(sa,
X))):(X=ha,ha=G)}else X=ha,ha=G}else X=ha,ha=G;return ha}function L(ha,S){return ha.map(function(aa){return aa[S]})}v=void 0!==v?v:{};var G={},M={start:H},P=H,T=w("none"),Y="none",Z=z("none",!1),ca=")",ia=z(")",!1),da=",",ja=z(",",!1),la=w("whitespace"),fa=/^[ \t\n\r]/,Q=t([" ","\t","\n","\r"],!1,!1),V=w("function"),O="(",U=z("(",!1),W=w("identifier"),ba=/^[a-z\-]/,ea=t([["a","z"],"-"],!1,!1),ma=w("percentage"),oa="%",pa=z("%",!1),qa=w("length"),va="px",ta=z("px",!1),ua="cm",Aa=z("cm",!1),xa="mm",
Ta=z("mm",!1),Ia="in",Ua=z("in",!1),Ja="pt",Va=z("pt",!1),Ka="pc",Wa=z("pc",!1),ab=w("angle"),La="deg",Xa=z("deg",!1),Ma="rad",Ya=z("rad",!1),Na="grad",Za=z("grad",!1),Oa="turn",$a=z("turn",!1),bb=w("number"),eb=w("color"),cb="#",db=z("#",!1),Pa=/^[0-9a-fA-F]/,Qa=t([["0","9"],["a","f"],["A","F"]],!1,!1),Ra=/^[+\-]/,Sa=t(["+","-"],!1,!1),Ba=/^[0-9]/,Ca=t([["0","9"]],!1,!1),fb=".",gb=z(".",!1),hb="e",ib=z("e",!1),X=0,sa=0,Ga=[{line:1,column:1}],za=0,Ha=[],na=0;if("startRule"in v){if(!(v.startRule in
M))throw Error("Can't start parsing from rule \""+v.startRule+'".');P=M[v.startRule]}v=P();if(v!==G&&X===u.length)return v;v!==G&&X<u.length&&F({type:"end"});throw function(ha,S,aa){return new q(q.buildMessage(ha,S),ha,S,aa)}(Ha,za<u.length?u.charAt(za):null,za<u.length?C(za,za+1):C(za,za));}}})});const h={deg:1,grad:.9,rad:180/Math.PI,turn:360},m={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/73},r=/^rgba?/i,p=/^hsla?/i;y.parse=function(g){let q;try{q=g?l.parse(g):[]}catch(u){return{input:g,parsedFunctions:[],
effects:[],error:new D("effect:invalid-syntax","Invalid effect syntax",{input:g,error:u})}}g={input:g,parsedFunctions:q,effects:[],error:null};try{for(const u of q)g.effects.push(k(u))}catch(u){g.effects.length=0,g.error=u}return g};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z,t){function w(x,C,F){return 1!==F||D.isSome(x)&&"normal"!==x||D.isSome(C)&&0<C.length}return function(){function x(F,H){this.context=F;this._blitRenderer=new h.BitBlitRenderer;this._brushCache=new Map;this._vtlMaterialManager=new l;this._blendEffect=new g.BlendEffect;this.effects={highlight:new u,hittest:new v.HittestEffect,integrate:new p.AnimationEffect,insideEffect:new q.FeatureEffect("inside"),outsideEffect:new q.FeatureEffect("outside")};
this.materialManager=new m(F);this.textureManager=new r(H);this._effectsManager=new z.EffectManager(H)}var C=x.prototype;C.getRenderTarget=function(){return this._renderTarget};C.setRenderTarget=function(F){this._renderTarget=F};C.getFbos=function(F,H){if(F!==this._lastWidth||H!==this._lastHeight){this._lastWidth=F;this._lastHeight=H;if(this._fbos){for(var J in this._fbos)this._fbos[J].resize(F,H);return this._fbos}J={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:F,
height:H};const K={colorTarget:0,depthStencilTarget:3};this._stencilBuf=F=new c(this.context,{width:F,height:H,internalFormat:34041});this._fbos={output:new b(this.context,K,J,F),blend:new b(this.context,K,J,F),effect0:new b(this.context,K,J,F)}}return this._fbos};C.getSharedStencilBuffer=function(){return this._stencilBuf};C.beforeRenderLayers=function(F,H=null){const {width:J,height:K}=F.getViewport();this._prevFBO=F.getBoundFramebufferObject();const N=this.getFbos(J,K);F.bindFramebuffer(N.output);
F.setColorMask(!0,!0,!0,!0);F.setDepthWriteEnabled(!0);if(D.isSome(H)){const {r:R,g:I,b:L,a:G}=H.color;F.setClearColor(G*R/255,G*I/255,G*L/255,G)}else F.setClearColor(0,0,0,0);F.setClearDepth(1);F.clear(F.gl.COLOR_BUFFER_BIT|F.gl.DEPTH_BUFFER_BIT);F.setDepthWriteEnabled(!1)};C.beforeRenderLayer=function(F,H,J){const {context:K,blendMode:N,effects:R,requireFBO:I}=F;I||w(N,R,J)?(K.bindFramebuffer(this._fbos.blend),K.setColorMask(!0,!0,!0,!0),K.setClearColor(0,0,0,0),K.clear(K.gl.COLOR_BUFFER_BIT)):
(F=this._getOutputFBO(),K.bindFramebuffer(F));K.setDepthWriteEnabled(!1);K.setDepthTestEnabled(!1);K.setStencilTestEnabled(!0);K.setClearStencil(H);K.setStencilWriteMask(255);K.clear(K.gl.STENCIL_BUFFER_BIT)};C.compositeLayer=function(F,H){const {context:J,blendMode:K,effects:N,requireFBO:R}=F;if(R||w(K,N,H)){D.isSome(N)&&0<N.length&&F.drawPhase===f.WGLDrawPhase.MAP&&this._applyEffects(F,N);var I=this._getOutputFBO();J.bindFramebuffer(I);J.setStencilTestEnabled(!1);J.setStencilWriteMask(0);J.setBlendingEnabled(!0);
J.setBlendFunctionSeparate(1,771,1,771);J.setColorMask(!0,!0,!0,!0);I=D.isSome(K)?K:"normal";this._blendEffect.draw(F,this._fbos.blend.colorTexture,9728,I,H)}};C.renderLayers=function(F){F.bindFramebuffer(this._prevFBO);if(this._fbos){var H=this._getOutputFBO();F.setStencilTestEnabled(!1);F.setStencilWriteMask(0);this.blitTexture(F,H.colorTexture,9728)}};C.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=
null);this._brushCache&&(this._brushCache.forEach(F=>F.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const F in this._fbos)this._fbos[F]&&this._fbos[F].dispose();if(this.effects)for(const F in this.effects)this.effects[F]&&this.effects[F].dispose();this._vtlMaterialManager&&(this._vtlMaterialManager.dispose(),this._vtlMaterialManager=null);this._prevFBO=null};C.getGeometryBrush=function(F){F={[f.WGLGeometryType.FILL]:n.brushes.fill,[f.WGLGeometryType.LINE]:n.brushes.line,
[f.WGLGeometryType.MARKER]:n.brushes.marker,[f.WGLGeometryType.TEXT]:n.brushes.text}[F];let H=this._brushCache.get(F);void 0===H&&(H=new F,this._brushCache.set(F,H));return this._brushCache.get(F)};C.renderObject=function(F,H,J,K){J=n.brushes[J];if(!J)return null;let N=this._brushCache.get(J);void 0===N&&(N=new J,this._brushCache.set(J,N));N.prepareState(F,H,K);N.draw(F,H,K)};C.renderObjects=function(F,H,J,K){J=n.brushes[J];if(!J)return null;let N=this._brushCache.get(J);void 0===N&&(N=new J,this._brushCache.set(J,
N));N.drawMany(F,H,K)};C.registerRenderPass=function(F){const H=F.brushes.map(J=>{this._brushCache.has(J)||this._brushCache.set(J,new J);return this._brushCache.get(J)});return new t(H,F)};C.setHighlightOptions=function(F){this.effects.highlight.setHighlightOptions(F)};C.blitTexture=function(F,H,J,K=1){F.setBlendingEnabled(!0);F.setBlendFunctionSeparate(1,771,1,771);F.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(F,H,J,K)};C.getPostProcessingEffects=function(F){return this._effectsManager.getPostProcessingEffects(F)};
C._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};C._applyEffects=function(F,H){const {context:J}=F;H=this._effectsManager.getPostProcessingEffects(H);for(const {postProcessingEffect:K,effect:N}of H)J.bindFramebuffer(this._fbos.blend),K.draw(F,this._fbos.blend,N)};y._createClass(x,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return x}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){const r={vtlBackground:k.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:e.WGLBrushVTLLine,vtlCircle:c.WGLBrushVTLCircle,vtlSymbol:a.WGLBrushVTLSymbol};y.brushes={marker:l,line:n,fill:d,text:h,label:f,clip:E,stencil:A,bitmap:D,raster:m,tileInfo:B,vtlBackground:k.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:e.WGLBrushVTLLine,vtlCircle:c.WGLBrushVTLCircle,vtlSymbol:a.WGLBrushVTLSymbol};y.vtlBrushes=r;Object.defineProperty(y,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush"],function(y,D,E,B){const A={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};return function(k){function c(){var e=k.apply(this,arguments)||this;e._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",
attributes:{a_position:0,a_texcoord:1}};return e}y._inheritsLoose(c,k);var b=c.prototype;b.dispose=function(){this._quad&&this._quad.dispose()};b.prepareState=function({context:e},a){e.setBlendingEnabled(!0);"additive"===a.blendFunction?e.setBlendFunctionSeparate(1,1,1,1):e.setBlendFunctionSeparate(1,771,1,771);e.setColorMask(!0,!0,!0,!0);e.setStencilWriteMask(0);e.setStencilTestEnabled(!0);e.setStencilFunction(514,a.stencilRef,255)};b.draw=function(e,a){const {context:d,renderingOptions:f,painter:n}=
e;if(a.source){e.timeline.begin(this.name);this._quad||(this._quad=new E(d,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode){({state:m}=e);var l=a.resolution/a.pixelRatio/m.resolution,h=Math.round(e.pixelRatio)!==e.pixelRatio;l=1.05<l||.95>l;var m=m.rotation||l||h||a.isSourceScaled||a.rotation?A.bilinear:A.nearest}else m=A[f.samplingMode];h=n.materialManager.getProgram(e,this._desc,m.defines);var {coordScale:r,computedOpacity:p,transforms:g}=a;a.setSamplingProfile(m);a.bind(e,D.TEXTURE_BINDING_BITMAP);
d.bindProgram(h);h.setUniformMatrix3fv("u_dvsMat3",g.dvs);h.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP);h.setUniform2fv("u_coordScale",r);h.setUniform1f("u_opacity",p);this._quad.draw();e.timeline.end(this.name)}};return c}(B)})},"esri/views/2d/engine/webgl/VertexStream":function(){define("../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler".split(" "),
function(y,D,E,B,A,k,c,b,e){return function(){function a(f,n){this.rctx=f;this._vertexBuffer=D.createVertex(f,35044,new Uint16Array(n));this._vao=new B(f,{a_position:0},{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}var d=a.prototype;d.bind=function(){this._vao.bind()};d.unbind=function(){this._vao.unbind()};d.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};d.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,
0,4)};return a}()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function y(){this.name=this.constructor.name||"UnnamedBrush"}var D=y.prototype;D.prepareState=function(E,B,A){};D.draw=function(E,B,A){};D.drawMany=function(E,B,A){for(const k of B)this.draw(E,k,A)};return y}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/programUtils ./WGLBrush ../Utils ../shaders/BackgroundPrograms".split(" "),
function(y,D,E,B,A,k){return function(c){function b(){var a=c.apply(this,arguments)||this;a._color=D.fromValues(0,1,0,1);return a}y._inheritsLoose(b,c);var e=b.prototype;e.dispose=function(){this._program&&this._program.dispose()};e.prepareState=function({context:a}){a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,0,255)};e.draw=function(a,d){const {context:f,
state:n}=a;this._program||(this._program=E.createProgram(f,k.background));a=this._program;const l=A.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});d=d.getVAO(f,n,l.attributes,l.bufferLayouts);f.bindProgram(this._program);a.setUniform2fv("u_coord_range",[1,1]);a.setUniform4fv("u_color",this._color);a.setUniformMatrix3fv("u_dvsMat3",n.displayMat3);f.bindVAO(d);f.drawElements(4,d.indexBuffer.size,5125,0);f.bindVAO()};return b}(B)})},"esri/chunks/vec4f32":function(){define(["exports"],
function(y){function D(){return new Float32Array(4)}function E(g){const q=new Float32Array(4);q[0]=g[0];q[1]=g[1];q[2]=g[2];q[3]=g[3];return q}function B(g,q,u,v){const z=new Float32Array(4);z[0]=g;z[1]=q;z[2]=u;z[3]=v;return z}function A(g,q){return new Float32Array(g,q,4)}function k(){return D()}function c(){return B(1,1,1,1)}function b(){return B(1,0,0,0)}function e(){return B(0,1,0,0)}function a(){return B(0,0,1,0)}function d(){return B(0,0,0,1)}const f=D(),n=c(),l=b(),h=e(),m=a(),r=d();var p=
Object.freeze({__proto__:null,create:D,clone:E,fromValues:B,createView:A,zeros:k,ones:c,unitX:b,unitY:e,unitZ:a,unitW:d,ZEROS:f,ONES:n,UNIT_X:l,UNIT_Y:h,UNIT_Z:m,UNIT_W:r});y.ONES=n;y.UNIT_W=r;y.UNIT_X=l;y.UNIT_Y=h;y.UNIT_Z=m;y.ZEROS=f;y.clone=E;y.create=D;y.createView=A;y.fromValues=B;y.ones=c;y.unitW=d;y.unitX=b;y.unitY=e;y.unitZ=a;y.vec4f32=p;y.zeros=k})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Logger ../../../../core/Error ../../../../core/mathUtils ../../../../core/screenUtils ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ./color ./SymbolProperties".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r){function p(G){const M={};for(const P of G)M[P.name]=P.strideInBytes;return M}function g(G){switch(G){case h.WGLGeometryType.MARKER:return J;case h.WGLGeometryType.FILL:return K;case h.WGLGeometryType.LINE:return N;case h.WGLGeometryType.TEXT:return R;case h.WGLGeometryType.LABEL:return I}}function q(G){switch(G%4){case 0:case 2:return 4;case 1:case 3:return 1}}function u(G){switch(G){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function v(G){const M={};for(const P in G){let T=0;M[P]=G[P].map(Y=>{const Z={...Y,normalized:Y.normalized||!1,divisor:Y.divisor||0,offset:T,stride:0};T+=Y.count*u(Y.type);return Z});M[P].forEach(Y=>Y.stride=T)}return M}const z=D.getLogger("esri.views.2d.engine.webgl.Utils");D=[{name:"geometry",strideInBytes:32,divisor:0}];k=[{name:"geometry",strideInBytes:32,divisor:0}];c=[{name:"geometry",strideInBytes:12,divisor:0}];e=[{name:"geometry",strideInBytes:36,divisor:0}];a=[{name:"geometry",strideInBytes:32,
divisor:0}];d=[{name:"geometry",strideInBytes:36,divisor:0}];const t=p(D),w=p(k),x=p(c),C=p(e),F=p(a),H=p(d),J=["geometry"],K=["geometry"],N=["geometry"],R=["geometry"],I=["geometry"],L=new Map;y.C_FILL_STRIDE_SPEC=w;y.C_FILL_STRIDE_SPEC_DD=x;y.C_FILL_VERTEX_DEF=k;y.C_FILL_VERTEX_DEF_DD=c;y.C_ICON_STRIDE_SPEC=t;y.C_ICON_VERTEX_DEF=D;y.C_LABEL_STRIDE_SPEC=H;y.C_LABEL_VERTEX_DEF=d;y.C_LINE_STRIDE_SPEC=C;y.C_LINE_VERTEX_DEF=e;y.C_TEXT_STRIDE_SPEC=F;y.C_TEXT_VERTEX_DEF=a;y.C_VBO_GEOMETRY="geometry";y.C_VBO_INFO=
{["geometry"]:35044};y.C_VBO_PERINSTANCE="per_instance";y.C_VBO_PERINSTANCE_VV="per_instance_vv";y.allocateTypedArrayBuffer=function(G,M){switch(M%4){case 0:case 2:return new Uint32Array(Math.floor(G*M/4));case 1:case 3:return new Uint8Array(G*M)}};y.allocateTypedArrayBufferwithData=function(G,M){switch(M%4){case 0:case 2:return new Uint32Array(G);case 1:case 3:return new Uint8Array(G)}};y.copyMeshData=function(G,M,P,T,Y,Z,ca){for(const ja in Z){var ia=Z[ja].stride,da=q(ia);const la=Z[ja].data,fa=
P[ja].data,Q=ia*Y.vertexCount/da,V=ia*G/da;ia=ia*Y.vertexFrom/da;for(da=0;da<Q;++da)fa[da+V]=la[da+ia]}P=Y.indexCount;for(Z=0;Z<P;++Z)T[Z+M]=ca[Z+Y.indexFrom]-Y.vertexFrom+G};y.createGeometryData=function(G,M){const P=[];for(let T=0;5>T;++T){const Y=g(T),Z={};for(const ca of Y)Z[ca]={data:M(T,ca)};P.push({data:G(T),buffers:Z})}return P};y.createProgramDescriptor=(G,M)=>{if(!L.has(G)){const Y=v(M);var P=Y;var T={};for(const Z in P){const ca=P[Z];T[Z]=ca.length?ca[0].stride:0}P=T;T={};for(const Z in M)for(const ca of M[Z])T[ca.name]=
ca.location;M=T;L.set(G,{strides:P,bufferLayouts:Y,attributes:M})}return L.get(G)};y.createTextureFromTexelData=function(G,M){let P,T;B.isPowerOfTwo(M.width)&&B.isPowerOfTwo(M.height)?(P=!0,T=9987):(P=!1,T=9729);return new b(G,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:P,samplingMode:T,wrapMode:33071,flipped:!0},M)};y.forEachGeometryType=function(G){G(h.WGLGeometryType.MARKER);G(h.WGLGeometryType.FILL);G(h.WGLGeometryType.LINE);G(h.WGLGeometryType.TEXT);G(h.WGLGeometryType.LABEL)};
y.geometryToMappedGeometry=function(G){return{vertexFrom:void 0,vertexTo:void 0,geometry:G}};y.getBytes=u;y.getCapType=function(G,M){switch(G){case "butt":return 0;case "round":return M?2:1;case "square":return 2;default:return z.error(new E("mapview-invalid-type",`Cap type ${G} is not a valid option. Defaulting to round`)),1}};y.getJoinType=function(G){switch(G){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return z.error(new E("mapview-invalid-type",`Join type ${G} is not a valid option. Defaulting to round`)),
1}};y.getNamedBuffers=g;y.getPixelArrayCtor=function(G){switch(G){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:z.error(new E("webgl-utils",`Unable to handle type ${G}`))}};y.getPixelBytes=function(G){switch(G){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:z.error(new E("webgl-utils",`Unable to handle type ${G}`))}};y.getStrides=function(G,M){switch(G){case h.WGLGeometryType.MARKER:return t;case h.WGLGeometryType.FILL:return M?
x:w;case h.WGLGeometryType.LINE:return C;case h.WGLGeometryType.TEXT:return F;case h.WGLGeometryType.LABEL:return H}};y.getTextProperties=function(G){return r.TextProperties.pool.acquire(G.color?m.copyAndPremultiply(G.color):[255,255,255,255],G.haloColor?m.copyAndPremultiply(G.haloColor):[255,255,255,255],A.pt2px(G.haloSize),A.pt2px(G.font.size),G.angle*Math.PI/180,G.xoffset/G.font.size,G.yoffset/G.font.size,"left"===G.horizontalAlignment?0:"right"===G.horizontalAlignment?1:.5,"top"===G.verticalAlignment?
0:"bottom"===G.verticalAlignment?1:.5)};y.getTransformParams=function(G){const {transform:M,hasZ:P,hasM:T}=G;return{transform:M,hasZ:P,hasM:T}};y.getVVType=function(G){switch(G){case "opacity":return h.VVType.OPACITY;case "color":return h.VVType.COLOR;case "rotation":return h.VVType.ROTATION;case "size":return h.VVType.SIZE;default:return z.error(`Cannot interpret unknown vv: ${G}`),null}};y.isDefined=function(G){return null!=G};y.isNumber=function(G){return"number"===typeof G};y.strideToPackingFactor=
q;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(y,D){function E(k,c){Array.isArray(c)?(k[0]=c[0],k[1]=c[1],k[2]=c[2],k[3]=c[3]):(k[0]=c.r,k[1]=c.g,k[2]=c.b,k[3]=c.a);return k}function B(k,c=0,b=!1){const e=k[c+3];k[c+0]*=e;k[c+1]*=e;k[c+2]*=e;b||(k[c+3]*=255);return k}const A=[0,0,0,0];y.copyAndPremultiply=function(k){return B(E([],k))};y.premultiplyAlpha=B;y.premultiplyAlphaRGBA=function(k){if(!k)return 0;
const {r:c,g:b,b:e,a}=k;return D.i8888to32(c*a,b*a,e*a,255*a)};y.premultiplyAlphaRGBAArray=function(k){if(!k)return 0;const [c,b,e,a]=k;return D.i8888to32(a/255*c,a/255*b,a/255*e,a)};y.premultiplyAlphaUint32=function(k){B(E(A,k));return D.i8888to32(A[0],A[1],A[2],A[3])};y.white=[255,255,255,1];Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(y){function D(A,k,c){return Math.round(Math.max(Math.min(A,c),k))}const E=new Float32Array(1),
B=new Uint32Array(E.buffer);y.i16=function(A){return D(A,-32768,32767)};y.i1616to32=function(A,k){return 65535&A|k<<16};y.i32=function(A){return D(A,-2147483648,2147483647)};y.i8=function(A){return D(A,-128,127)};y.i8816to32=function(A,k,c){return A&255|(k&255)<<8|c<<16};y.i8888to32=function(A,k,c,b){return A&255|(k&255)<<8|(c&255)<<16|b<<24};y.numTo32=function(A){return A|0};y.toFloat32=function(A){B[0]=A;return E[0]};y.toUint32=function(A){E[0]=A;return B[0]};y.u16=function(A){return D(A,0,65535)};
y.u32=function(A){return D(A,0,4294967295)};y.u32to4Xu8=function(A){return[A&255,(A&65280)>>>8,(A&16711680)>>>16,(A&4278190080)>>>24]};y.u8=function(A){return D(A,0,255)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(y,D){let E=function(){function B(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=
0}var A=B.prototype;A.acquire=function(k,c,b,e,a,d,f,n,l){this.color=k;this.haloColor=c;this.haloSize=b;this.size=e;this.angle=a;this.offsetX=d;this.offsetY=f;this.hAnchor=n;this.vAnchor=l};A.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return B}();E.pool=new D(E);y.TextProperties=E;Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(y,D){D={shaders:{vertexShader:D.resolveIncludes("background/background.vert"),fragmentShader:D.resolveIncludes("background/background.frag")},attributes:{a_pos:0}};y.background=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define("exports ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./shaderRepository".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){const f=new a(function(n){let l=d;n.split("/").forEach(h=>{l&&(l=l[h])});return l});y.resolveIncludes=function(n){return f.resolveIncludes(n)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\n  return max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\n  float vIn \x3d rgb2v(Cb);\n  vec3 hsvTint \x3d rgb2hsv(Cs);\n  vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n  return hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\n  return (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\n return (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\n\treturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\n  if (Cs \x3c\x3d 0.5) {\n    return Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n  }\n  if (Cb \x3c\x3d 0.25) {\n    return Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n  }\n  return Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\n  return min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\n  return max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\n  return dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\n  return maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\n  float lum \x3d lumv3(color);\n  float mincol \x3d minv3(color);\n  float maxcol \x3d maxv3(color);\n  if (mincol \x3c 0.0) {\n    color \x3d lum + ((color - lum) * lum) / (lum - mincol);\n  }\n  if (maxcol \x3e 1.0) {\n    color \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n  }\n  return color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\n  float lbase \x3d lumv3(cbase);\n  float llum \x3d lumv3(clum);\n  float ldiff \x3d llum - lbase;\n  vec3 color \x3d cbase + vec3(ldiff);\n  return clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\n  float minbase \x3d minv3(cbase);\n  float sbase \x3d satv3(cbase);\n  float ssat \x3d satv3(csat);\n  vec3 color;\n  if (sbase \x3e 0.0) {\n    color \x3d (cbase - minbase) * ssat / sbase;\n  } else {\n    color \x3d vec3(0.0);\n  }\n  return setLum(color, clum);\n}\nvoid main() {\n  vec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\n  gl_FragColor \x3d src *  u_opacity;\n#else\n  vec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\n  vec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\n  vec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\n  float as \x3d u_opacity * src.a;\n  float ab \x3d dst.a;\n  #ifdef DESTINATION_OVER\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n  #endif\n  #ifdef SOURCE_IN\n    vec4 color \x3d vec4(as * Cs * ab, as * ab);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef DESTINATION_IN\n    vec4 color \x3d vec4(ab * Cb * as, ab * as);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef SOURCE_OUT\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n  #endif\n  #ifdef DESTINATION_OUT\n    gl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n  #endif\n  #ifdef SOURCE_ATOP\n    gl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n  #endif\n  #ifdef DESTINATION_ATOP\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n  #endif\n  #ifdef XOR\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\n                        as * (1.0 - ab) + ab * (1.0 - as));\n  #endif\n  #ifdef MULTIPLY\n    gl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SCREEN\n    gl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef OVERLAY\n    vec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DARKEN\n    gl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LIGHTER\n    gl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n  #endif\n  #ifdef LIGHTEN\n    gl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_DODGE\n    vec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_BURN\n    vec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HARD_LIGHT\n    vec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SOFT_LIGHT\n    vec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DIFFERENCE\n    gl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef EXCLUSION\n     vec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef INVERT\n    gl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n  #endif\n  #ifdef VIVID_LIGHT\n    vec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\n                  vividLight(Cb.g, Cs.g),\n                  vividLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HUE\n    vec3 f \x3d setLumSat(Cs,Cb,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SATURATION\n    vec3 f \x3d setLumSat(Cb,Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR\n    vec3 f \x3d setLum(Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LUMINOSITY\n    vec3 f \x3d setLum(Cb,Cs);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef PLUS\n    gl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n  #endif\n  #ifdef MINUS\n     gl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n  #endif\n  #ifdef AVERAGE\n     vec3 f \x3d (Cb + Cs) / 2.0;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef REFLECT\n    vec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\n                  reflectBlend(Cb.g, Cs.g),\n                  reflectBlend(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position , 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\n  lowp vec2 uvn \x3d uv * 2.0 - 1.0;\n  if (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\n    return vec2(0.5, 0.5);\n  }\n  lowp float theta \x3d atan(uvn.y, uvn.x);\n  lowp float r \x3d pow(length(uvn), barrelFactor);\n  return r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\n  color \x3d (color + (1.0 - color.a) * u_background);\n  lowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\n  color *\x3d mask;\n  lowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\n  gl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  gl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackDisplayIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d preEffectColor;\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity();\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  float width \x3d u_zoomFactor * a_aux1.x * aux2.x;\n  float height \x3d u_zoomFactor * a_aux1.y * aux2.y;\n  float angle \x3d C_256_TO_RAD * a_aux3.z;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  mat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n                           -sinA / width, cosA / height, 0,\n                            0,            0,             1);\n  vec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\n  v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.x;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity();\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d a_outlineColor;\n  v_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d v_lineHalfWidth;\n  mediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / adjustedPatternWidth, 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity();\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n  return getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\n  float a_bitSet        \x3d a_aux.w;\n  float a_fontSize      \x3d a_texFontSize.z;\n  vec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float fontSize      \x3d getTextSize(a_fontSize, a_referenceSize);\n  float scaleFactor   \x3d fontSize / a_fontSize;\n  float fontScale     \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  mat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\n  v_opacity \x3d getOpacity();\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackDisplayIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\n  pos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n  #if !defined(HIGHLIGHT_ALL)\n    pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n  #endif\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\n  return pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  gl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\n  float mirrorFactor \x3d 1.2 - factor;\n  return mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\n  gl_FragColor \x3d u_bloomStrength * (\n    lerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\n    lerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\n    lerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\n    lerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\n    lerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n  );\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d float(SIGMA);\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 texel \x3d texture2D(u_texture, v_uv);\n  vec3 luma \x3d vec3(0.299, 0.587, 0.114);\n  float v \x3d dot(texel.xyz, luma);\n  vec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\n  float alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\n  gl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d u_sigma;\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\n    float samples[10];\n    samples[0] \x3d -0.08;\n    samples[1] \x3d -0.05;\n    samples[2] \x3d -0.03;\n    samples[3] \x3d -0.02;\n    samples[4] \x3d -0.01;\n    samples[5] \x3d  0.01;\n    samples[6] \x3d  0.02;\n    samples[7] \x3d  0.03;\n    samples[8] \x3d  0.05;\n    samples[9] \x3d  0.08;\n    vec2 dir \x3d 0.5 - v_uv;\n    float dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\n    dir \x3d dir / dist;\n    vec4 color \x3d texture2D(u_colorTexture,v_uv);\n    vec4 sum \x3d color;\n    for (int i \x3d 0; i \x3c 10; i++) {\n      sum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n    }\n    sum *\x3d 1.0 / 11.0;\n    float t \x3d dist * sampleStrength;\n    t \x3d clamp(t, 0.0, 1.0);\n    gl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\n  vec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\n  vec4 color \x3d texture2D(u_texture, v_uv);\n  vec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\n  vec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\n  vec3 colorUnpremultiply \x3d color.rgb / color.a;\n  vec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\n  gl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\n  vec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\n  vec2 onePixel \x3d vec2(1.0) / u_srcResolution;\n  vec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\n  vec4 minColor \x3d vec4(1.0);\n  vec4 maxColor \x3d vec4(0.0);\n  for (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\n    for (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\n      vec2 offset \x3d uv + vec2(x, y) * onePixel;\n      minColor \x3d min(minColor, texture2D(u_minTexture, offset));\n      maxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n    }\n  }\n  gl_FragData[0] \x3d minColor;\n  gl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\n  vec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\n  gl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\n  vec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\n  gl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\n  G[0] \x3d g0,\n  G[1] \x3d g1,\n  G[2] \x3d g2,\n  G[3] \x3d g3,\n  G[4] \x3d g4,\n  G[5] \x3d g5,\n  G[6] \x3d g6,\n  G[7] \x3d g7,\n  G[8] \x3d g8;\n  mat3 I;\n  float cnv[9];\n  vec3 sample;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 9; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  float M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\n  float S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\n  gl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  gl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  gl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  vec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  gl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  float alpha \x3d u_opacity * color.a;\n  gl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\n  targetLocation \x3d projectPixelLocation(targetLocation);\n#endif\n  return targetLocation;\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\n  vec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\n  vec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\n  return color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvec3 rgb2hsv(vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\n  val \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\n  vec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\n  vec3 hsv \x3d rgb2hsv(rgb.xyz);\n  hsv.z \x3d hillshade;\n  return vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\n     float z \x3d (u_cosZs[0] + cosDelta) / dzd;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / dzd;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\n  gl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\n  gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\n  float clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\n  vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n  vec4 color \x3d texture2D(u_colormap, clrPosition);\n  vec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  vec4 result \x3d colorize(currentPixel, 1.0);\n  gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}",
"lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\n  gl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n  return;\n#endif\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\n      vec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\n      gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h){return function(m){function r(){var g=m.apply(this,arguments)||this;g._color=D.fromValues(1,0,0,1);return g}y._inheritsLoose(r,m);var p=r.prototype;p.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};p.prepareState=function({context:g}){g.setBlendingEnabled(!0);g.setBlendFunctionSeparate(1,771,1,771);g.setColorMask(!0,!0,!0,!0);g.setStencilWriteMask(0);g.setStencilTestEnabled(!1)};p.draw=function(g,q){({context:g}=g);if(q.isReady){this._loadWGLResources(g);g.bindVAO(this._outlineVertexArrayObject);g.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",q.transforms.dvs);
this._outlineProgram.setUniform2f("u_coord_range",q.coordRange[0],q.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);g.drawArrays(3,0,4);g.bindVAO();var u=this._getTexture(g,q);u&&(g.bindVAO(this._tileInfoVertexArrayObject),g.bindProgram(this._tileInfoProgram),g.bindTexture(u,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",q.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
q.coordRange[0]/q.size[0],q.coordRange[1]/q.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",u.descriptor.width,u.descriptor.height),g.drawArrays(5,0,4),g.bindVAO())}};p._loadWGLResources=function(g){if(!this._outlineProgram||!this._tileInfoProgram){var q=e.createProgram(g,l.background),u=e.createProgram(g,h.tileInfo),v={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},z=new Int8Array([0,0,1,0,1,1,0,
1]);z=B.createVertex(g,35044,z);z=new k(g,l.background.attributes,v,{geometry:z});var t=new Int8Array([0,0,1,0,0,1,1,1]);t=B.createVertex(g,35044,t);g=new k(g,h.tileInfo.attributes,v,{geometry:t});this._outlineProgram=q;this._tileInfoProgram=u;this._outlineVertexArrayObject=z;this._tileInfoVertexArrayObject=g}};p._getTexture=function(g,q){if(q.texture&&q.triangleCountReportedInDebug===q.triangleCount)return q.texture;q.triangleCountReportedInDebug=q.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const u=q.triangleCount;let v=q.key.id;0<q.triangleCount&&(v+=`, ${u}`);const z=this._canvas,t=z.getContext("2d");t.font="24px sans-serif";t.textAlign="left";t.textBaseline="top";t.clearRect(0,0,300,32);1E5<u?(t.fillStyle="red",t.fillRect(0,0,300,32),t.fillStyle="black"):(t.clearRect(0,0,300,32),t.fillStyle="blue");t.fillText(v,
0,0);q.texture=new A(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},z);return q.texture};return r}(n)})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(y,D){D={shaders:{vertexShader:D.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:D.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}};y.tileInfo=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l){return function(h){function m(){var p=h.apply(this,arguments)||this;p._color=D.fromValues(1,0,0,1);p._initialized=!1;return p}y._inheritsLoose(m,h);var r=m.prototype;r.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};r.prepareState=function({context:p},g){p.setDepthWriteEnabled(!1);p.setDepthTestEnabled(!1);p.setStencilTestEnabled(!0);
p.setBlendingEnabled(!1);p.setColorMask(!1,!1,!1,!1);p.setStencilOp(7680,7680,7681);p.setStencilWriteMask(255);p.setStencilFunctionSeparate(1032,516,g.stencilRef,255)};r.draw=function(p,g){({context:p}=p);this._initialized||this._initialize(p);p.bindVAO(this._solidVertexArrayObject);p.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",g.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",
this._color);p.drawArrays(5,0,4);p.bindVAO()};r._initialize=function(p){if(this._initialized)return!0;const g=e.createProgram(p,l.background);if(!g)return!1;var q=new Int8Array([0,0,1,0,0,1,1,1]);q=B.createVertex(p,35044,q);p=new k(p,l.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:q});this._solidProgram=g;this._solidVertexArrayObject=p;return this._initialized=!0};return m}(n)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../definitions ../../../../../chunks/mat3f32 ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../number ../enums ./WGLBrush".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r){k=function(p){function g(){var u=p.apply(this,arguments)||this;u._color=E.fromValues(1,0,0,1);u._patternMatrix=A.create();u._programOptions={id:!1,pattern:!1};return u}D._inheritsLoose(g,p);var q=g.prototype;q.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};q.drawMany=function(u,v){const {context:z,painter:t,styleLayerUID:w}=u;this._loadWGLResources(u);const x=u.displayLevel;var C=u.styleLayer,F=C.backgroundMaterial;const H=t.vectorTilesMaterialManager,
J=C.getPaintValue("background-color",x),K=C.getPaintValue("background-opacity",x),N=C.getPaintValue("background-pattern",x),R=void 0!==N,I=J[3]*K,L=u.spriteMosaic;let G;const M=(window.devicePixelRatio|1)>B.VTL_HIGH_RES_CUTOFF?2:1;u=u.drawPhase===m.WGLDrawPhase.HITTEST;const P=this._programOptions;P.id=u;P.pattern=R;F=H.getMaterialProgram(z,F,P);z.bindVAO(this._vao);z.bindProgram(F);if(R){G=L.getMosaicItemPosition(N,!0);if(!G)return;F.setUniform1f("u_opacity",K);F.setUniform2f("u_pattern_tl",G.tl[0],
G.tl[1]);F.setUniform2f("u_pattern_br",G.br[0],G.br[1]);F.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES);L.bind(z,9729,G.page,B.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=I*J[0],this._color[1]=I*J[1],this._color[2]=I*J[2],this._color[3]=I,F.setUniform4fv("u_color",this._color);F.setUniform1f("u_depth",C.z||0);u&&(C=h.u32to4Xu8(w+1),F.setUniform4fv("u_id",C));for(const T of v)F.setUniform1f("u_coord_range",T.coordRange[0]),F.setUniformMatrix3fv("u_dvsMat3",T.transforms.dvs),
R&&(v=M*T.size[0]*Math.max(2**(Math.round(x)-T.key.level),1),C=v/G.size[1],this._patternMatrix[0]=v/G.size[0],this._patternMatrix[4]=C,F.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),z.setStencilFunction(514,T.stencilRef,255),z.drawArrays(5,0,4)};q._loadWGLResources=function(u){if(!this._vao){var {context:v,styleLayer:z}=u;u=z.backgroundMaterial;var t=new Int8Array([0,0,1,0,0,1,1,1]);t=c.createVertex(v,35044,t);this._vao=new e(v,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:t})}};
return g}(r);y.WGLBrushVTLBackground=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../number ../enums ./WGLBrush".split(" "),function(y,D,E,B,A,k){k=function(c){function b(){var a=c.apply(this,arguments)||this;a._programOptions={id:!1};return a}D._inheritsLoose(b,c);var e=b.prototype;e.dispose=function(){};e.drawMany=function(a,d){const {context:f,
displayLevel:n,requiredLevel:l,state:h,drawPhase:m,painter:r,styleLayerUID:p}=a;a=a.styleLayer;const g=a.circleMaterial;var q=r.vectorTilesMaterialManager,u=a.getPaintValue("circle-translate",n);const v=a.getPaintValue("circle-translate-anchor",n);var z=m===A.WGLDrawPhase.HITTEST;const t=this._programOptions;t.id=z;q=q.getMaterialProgram(f,g,t);f.bindProgram(q);q.setUniformMatrix3fv("u_displayMat3",1===v?h.displayMat3:h.displayViewMat3);q.setUniform2fv("u_circleTranslation",u);q.setUniform1f("u_depth",
a.z);q.setUniform1f("u_antialiasingWidth",1.2);u=-1;z&&(z=B.u32to4Xu8(p+1),q.setUniform4fv("u_id",z));for(const w of d)w.layerData.has(p)&&(w.key.level!==u&&(u=w.key.level,g.setDataUniforms(q,n,a,u)),d=w.layerData.get(p),d.prepareForRendering(f),z=d.circleVertexArrayObject,E.isNone(z)||(f.bindVAO(z),q.setUniformMatrix3fv("u_dvsMat3",w.transforms.dvs),l!==w.key.level?f.setStencilFunction(514,w.stencilRef,255):f.setStencilFunction(516,255,255),f.drawElements(4,d.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*
d.circleIndexStart),w.triangleCount+=d.circleIndexCount/3))};return b}(k);y.WGLBrushVTLCircle=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/mat3f32 ../number ../enums ./WGLBrush".split(" "),function(y,D,E,B,A,k,c,b){const e=1/65536;b=function(a){function d(){var n=a.apply(this,arguments)||this;n._fillProgramOptions=
{id:!1,pattern:!1};n._outlineProgramOptions={id:!1};n._patternMatrix=A.create();return n}D._inheritsLoose(d,a);var f=d.prototype;f.dispose=function(){};f.drawMany=function(n,l){const {displayLevel:h,drawPhase:m,renderPass:r,styleLayerUID:p}=n,g=n.styleLayer;var q=g.getPaintValue("fill-pattern",h),u=void 0!==q;const v=!u&&g.getPaintValue("fill-antialias",h);let z=!0;var t=1;if(!u){u=g.getPaintProperty("fill-color");var w=g.getPaintProperty("fill-opacity");null!=u&&u.isDataDriven||null!=w&&w.isDataDriven||
(t=g.getPaintValue("fill-color",h),t=g.getPaintValue("fill-opacity",h)*t[3],1<=t&&(z=!1))}if(!z||"opaque"!==r){var x;m===c.WGLDrawPhase.HITTEST&&(x=k.u32to4Xu8(p+1));u=g.getPaintValue("fill-translate",h);w=g.getPaintValue("fill-translate-anchor",h);(z||"translucent"!==r)&&this._drawFill(n,p,g,l,u,w,q,x);q=!g.hasDataDrivenOutlineColor&&g.outlineUsesFillColor&&1>t;v&&"opaque"!==r&&!q&&this._drawOutline(n,p,g,l,u,w,x)}};f._drawFill=function(n,l,h,m,r,p,g,q){const {context:u,displayLevel:v,state:z,drawPhase:t,
painter:w,pixelRatio:x,spriteMosaic:C}=n;n=h.fillMaterial;var F=w.vectorTilesMaterialManager;const H=void 0!==g,J=x>B.VTL_HIGH_RES_CUTOFF?2:1;let K;const N=t===c.WGLDrawPhase.HITTEST,R=this._fillProgramOptions;R.id=N;R.pattern=H;F=F.getMaterialProgram(u,n,R);u.bindProgram(F);if(H){K=C.getMosaicItemPosition(g,!0);if(!K){u.bindProgram();return}F.setUniform2f("u_pattern_tl",K.tl[0],K.tl[1]);F.setUniform2f("u_pattern_br",K.br[0],K.br[1]);F.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES);
C.bind(u,9729,K.page,B.VTL_TEXTURE_BINDING_UNIT_SPRITES)}F.setUniformMatrix3fv("u_displayMat3",1===p?z.displayMat3:z.displayViewMat3);F.setUniform2fv("u_fillTranslation",r);F.setUniform1f("u_depth",h.z+e);N&&F.setUniform4fv("u_id",q);r=-1;for(const I of m)I.layerData.has(l)&&(I.key.level!==r&&(r=I.key.level,n.setDataUniforms(F,v,h,r)),m=I.layerData.get(l),m.prepareForRendering(u),p=m.fillVertexArrayObject,E.isNone(p)||(u.bindVAO(p),F.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs),H&&(p=I.coordRange[0]/
(J*I.size[0]*Math.max(2**(Math.round(v)-I.key.level),1)),g=1/(K.size[1]*p),this._patternMatrix[0]=1/(K.size[0]*p),this._patternMatrix[4]=g,F.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),u.setStencilFunction(514,I.stencilRef,255),u.drawElements(4,m.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*m.fillIndexStart),I.triangleCount+=m.fillIndexCount/3))};f._drawOutline=function(n,l,h,m,r,p,g){const {context:q,displayLevel:u,state:v,drawPhase:z,painter:t,pixelRatio:w}=n;n=h.outlineMaterial;
var x=t.vectorTilesMaterialManager;const C=.75/w,F=z===c.WGLDrawPhase.HITTEST,H=this._outlineProgramOptions;H.id=F;x=x.getMaterialProgram(q,n,H);q.bindProgram(x);x.setUniformMatrix3fv("u_displayMat3",1===p?v.displayMat3:v.displayViewMat3);x.setUniform2fv("u_fillTranslation",r);x.setUniform1f("u_depth",h.z+e);x.setUniform1f("u_outline_width",C);F&&x.setUniform4fv("u_id",g);r=-1;for(const J of m)J.layerData.has(l)&&(J.key.level!==r&&(r=J.key.level,n.setDataUniforms(x,u,h,r)),m=J.layerData.get(l),m.prepareForRendering(q),
p=m.outlineVertexArrayObject,E.isNone(p)||(q.bindVAO(p),x.setUniformMatrix3fv("u_dvsMat3",J.transforms.dvs),q.setStencilFunction(514,J.stencilRef,255),q.drawElements(4,m.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*m.outlineIndexStart),J.triangleCount+=m.outlineIndexCount/3))};return d}(b);y.WGLBrushVTLFill=b;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../number ../enums ./WGLBrush".split(" "),
function(y,D,E,B,A,k,c,b){b=function(e){function a(){var f=e.apply(this,arguments)||this;f._dashArray=A.create();f._programOptions={id:!1,pattern:!1};return f}D._inheritsLoose(a,e);var d=a.prototype;d.dispose=function(){};d.drawMany=function(f,n){const {context:l,displayLevel:h,state:m,drawPhase:r,painter:p,styleLayerUID:g}=f,q=f.styleLayer,u=q.lineMaterial;var v=p.vectorTilesMaterialManager,z=q.getPaintValue("line-translate",h);const t=q.getPaintValue("line-translate-anchor",h);var w=q.getPaintValue("line-pattern",
h);const x=void 0!==w,C=1/f.pixelRatio,F=r===c.WGLDrawPhase.HITTEST,H=this._programOptions;H.id=F;H.pattern=x;v=v.getMaterialProgram(l,u,H);l.bindProgram(v);v.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);v.setUniformMatrix3fv("u_displayMat3",1===t?m.displayMat3:m.displayViewMat3);v.setUniform2fv("u_lineTranslation",z);v.setUniform1f("u_depth",q.z);v.setUniform1f("u_antialiasing",C);F&&(z=k.u32to4Xu8(g+1),v.setUniform4fv("u_id",z));if(x){if(f=f.spriteMosaic,w=f.getMosaicItemPosition(w,
!0))f.bind(l,9729,w.page,B.VTL_TEXTURE_BINDING_UNIT_SPRITES),v.setUniform2f("u_pattern_tl",w.tl[0],w.br[1]),v.setUniform2f("u_pattern_br",w.br[0],w.tl[1]),v.setUniform2f("u_spriteSize",8*w.size[0],w.size[1]),v.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else w=q.getPaintValue("line-dasharray",h),2>w.length&&(w=[1,-1]),this._dashArray[0]=8*w[0],this._dashArray[1]=8*w[1],v.setUniform2fv("u_dasharray",this._dashArray);w=-1;for(const J of n)J.layerData.has(g)&&(J.key.level!==w&&(w=J.key.level,
u.setDataUniforms(v,h,q,w)),n=J.layerData.get(g),n.prepareForRendering(l),f=n.lineVertexArrayObject,E.isNone(f)||(l.bindVAO(f),v.setUniformMatrix3fv("u_dvsMat3",J.transforms.dvs),l.setStencilFunction(514,J.stencilRef,255),l.drawElements(4,n.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*n.lineIndexStart),J.triangleCount+=n.lineIndexCount/3))};return a}(b);y.WGLBrushVTLLine=b;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../number ../enums ./WGLBrush ../GeometryUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a){const d=1/65536;e=function(f){function n(){var h=f.apply(this,arguments)||this;h._iconProgramOptions={id:!1,sdf:!1};h._sdfProgramOptions={id:!1};h._spritesTextureSize=A.create();return h}D._inheritsLoose(n,f);var l=n.prototype;l.dispose=function(){};l.drawMany=function(h,m){const {drawPhase:r,styleLayerUID:p}=h,g=h.styleLayer;let q;r===b.WGLDrawPhase.HITTEST&&(q=c.u32to4Xu8(p+1));this._drawIcons(h,g,m,q);this._drawText(h,g,m,q)};l._drawIcons=function(h,m,r,p){const {context:g,
displayLevel:q,drawPhase:u,painter:v,state:z,styleLayerUID:t}=h,w=m.iconMaterial;var x=v.vectorTilesMaterialManager,C=!1;for(var F of r)if(F.layerData.has(t)){var H=F.layerData.get(t);if(0<H.iconPerPageElementsMap.size){C=!0;break}}if(C){C=m.getPaintValue("icon-translate",q);F=m.getPaintValue("icon-translate-anchor",q);var J=m.getLayoutValue("icon-rotation-alignment",q);2===J&&(J=0===m.getLayoutValue("symbol-placement",q)?1:0);var K=0===J;K=m.getLayoutValue("icon-keep-upright",q)&&K;var N=H.isIconSDF;
H=u===b.WGLDrawPhase.HITTEST;var R=this._iconProgramOptions;R.id=H;R.sdf=N;x=x.getMaterialProgram(g,w,R);g.bindProgram(x);x.setUniformMatrix3fv("u_displayViewMat3",0===J?z.displayViewMat3:z.displayMat3);x.setUniformMatrix3fv("u_displayMat3",1===F?z.displayMat3:z.displayViewMat3);x.setUniform2fv("u_iconTranslation",C);x.setUniform1f("u_depth",m.z);x.setUniform1f("u_mapRotation",a.degToByte(z.rotation));x.setUniform1f("u_keepUpright",K?1:0);x.setUniform1f("u_level",10*q);x.setUniform1i("u_texture",
B.VTL_TEXTURE_BINDING_UNIT_SPRITES);x.setUniform1f("u_fadeDuration",k.FADE_DURATION/1E3);H&&x.setUniform4fv("u_id",p);p=-1;for(const I of r)if(I.layerData.has(t)&&(I.key.level!==p&&(p=I.key.level,w.setDataUniforms(x,q,m,p)),H=I.layerData.get(t),0!==H.iconPerPageElementsMap.size&&(H.prepareForRendering(g),H.updateOpacityInfo(),r=H.iconVertexArrayObject,!E.isNone(r)))){g.bindVAO(r);x.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs);x.setUniform1f("u_time",(performance.now()-H.lastOpacityUpdate)/1E3);
for(const [L,G]of H.iconPerPageElementsMap)this._renderIconRange(h,x,G,L,I)}}};l._renderIconRange=function(h,m,r,p,g){const {context:q,spriteMosaic:u}=h;this._spritesTextureSize[0]=u.getWidth(p)/4;this._spritesTextureSize[1]=u.getHeight(p)/4;m.setUniform2fv("u_mosaicSize",this._spritesTextureSize);u.bind(q,9729,p,B.VTL_TEXTURE_BINDING_UNIT_SPRITES);q.setStencilTestEnabled(!0);q.setStencilFunction(516,255,255);q.setStencilWriteMask(0);q.drawElements(4,r[1],5125,Uint32Array.BYTES_PER_ELEMENT*r[0]);
g.triangleCount+=r[1]/3};l._drawText=function(h,m,r,p){const {context:g,displayLevel:q,drawPhase:u,glyphMosaic:v,painter:z,pixelRatio:t,state:w,styleLayerUID:x}=h;h=m.textMaterial;const C=z.vectorTilesMaterialManager;var F=!1;for(var H of r)if(H.layerData.has(x)){var J=H.layerData.get(x);if(0<J.glyphPerPageElementsMap.size){F=!0;break}}if(F&&(J=m.getPaintProperty("text-opacity"),!J||J.isDataDriven||0!==J.getValue(q))){J=m.getPaintProperty("text-color");var K=!J||J.isDataDriven||0<J.getValue(q)[3];
J=m.getPaintProperty("text-halo-width");H=m.getPaintProperty("text-halo-color");var N=(!J||J.isDataDriven||0<J.getValue(q))&&(!H||H.isDataDriven||0<H.getValue(q)[3]);if(K||N){J=m.getLayoutValue("text-rotation-alignment",q);2===J&&(J=0===m.getLayoutValue("symbol-placement",q)?1:0);H=0===J;H=m.getLayoutValue("text-keep-upright",q)&&H;F=u===b.WGLDrawPhase.HITTEST;var R=.8*3/t;this._glyphTextureSize||(this._glyphTextureSize=A.fromValues(v.width/4,v.height/4));var I=m.getPaintValue("text-translate",q),
L=m.getPaintValue("text-translate-anchor",q),G=this._sdfProgramOptions;G.id=F;var M=C.getMaterialProgram(g,h,G);g.bindProgram(M);M.setUniformMatrix3fv("u_displayViewMat3",0===J?w.displayViewMat3:w.displayMat3);M.setUniformMatrix3fv("u_displayMat3",1===L?w.displayMat3:w.displayViewMat3);M.setUniform2fv("u_textTranslation",I);M.setUniform1f("u_depth",m.z+d);M.setUniform2fv("u_mosaicSize",this._glyphTextureSize);M.setUniform1f("u_mapRotation",a.degToByte(w.rotation));M.setUniform1f("u_keepUpright",H?
1:0);M.setUniform1f("u_level",10*q);M.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_GLYPHS);M.setUniform1f("u_antialiasingWidth",R);M.setUniform1f("u_fadeDuration",k.FADE_DURATION/1E3);F&&M.setUniform4fv("u_id",p);p=-1;for(const P of r)P.layerData.has(x)&&(P.key.level!==p&&(p=P.key.level,h.setDataUniforms(M,q,m,p)),J=P.layerData.get(x),0!==J.glyphPerPageElementsMap.size&&(J.prepareForRendering(g),J.updateOpacityInfo(),r=J.textVertexArrayObject,E.isNone(r)||(g.bindVAO(r),M.setUniformMatrix3fv("u_dvsMat3",
P.transforms.dvs),g.setStencilTestEnabled(!0),g.setStencilFunction(516,255,255),g.setStencilWriteMask(0),r=(performance.now()-J.lastOpacityUpdate)/1E3,M.setUniform1f("u_time",r),J.glyphPerPageElementsMap.forEach((T,Y)=>{this._renderGlyphRange(g,T,Y,v,M,N,K,P)}))))}}};l._renderGlyphRange=function(h,m,r,p,g,q,u,v){p.bind(h,9729,r,B.VTL_TEXTURE_BINDING_UNIT_GLYPHS);q&&(g.setUniform1f("u_halo",1),h.drawElements(4,m[1],5125,Uint32Array.BYTES_PER_ELEMENT*m[0]),v.triangleCount+=m[1]/3);u&&(g.setUniform1f("u_halo",
0),h.drawElements(4,m[1],5125,Uint32Array.BYTES_PER_ELEMENT*m[0]),v.triangleCount+=m[1]/3)};return n}(e);y.WGLBrushVTLSymbol=e;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(y){y.COLLISION_GRID_CELL_SIZE=32;y.DECLUTTER_BUDGET=1.5;y.DECLUTTER_TILES=!0;y.FADE_DURATION=200;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(y){function D(b,
e){b%=e;return 0<=b?b:b+e}const E=Number.POSITIVE_INFINITY,B=Math.PI,A=128/B,k=256/360,c=1/Math.LN2;y.C_256_TO_RAD=B/128;y.C_2PI=2*B;y.C_DEG_TO_256=k;y.C_DEG_TO_RAD=B/180;y.C_INFINITY=E;y.C_PI=B;y.C_PI_BY_2=B/2;y.C_RAD_TO_256=A;y.C_SQRT2=1.414213562;y.C_SQRT2_INV=1/1.414213562;y.between=function(b,e,a){return b>=e&&b<=a||b>=a&&b<=e};y.degToByte=function(b){return D(b*k,256)};y.interpolate=function(b,e,a){return b*(1-a)+e*a};y.log2=function(b){return Math.log(b)*c};y.positiveMod=D;y.radToByte=function(b){return D(b*
A,256)};y.sqr=function(b){return b*b};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/RandomLCG ../definitions ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../enums ../materialKey/MaterialKey ../Utils ./WGLGeometryBrush".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){return function(r){function p(){var q=r.apply(this,arguments)||this;q._dotTextureSize=0;q._dotTextures=null;q._dotSamplers=new Int32Array([E.TEXTURE_BINDING_RENDERER_0,E.TEXTURE_BINDING_RENDERER_1]);return q}y._inheritsLoose(p,r);var g=p.prototype;g.dispose=function(){this._disposeTextures()};g.getGeometryType=function(){return n.WGLGeometryType.FILL};g.drawGeometry=function(q,u,v,z){const {context:t,painter:w,rendererInfo:x,requiredLevel:C}=q;var F=l.FillMaterialKey.load(v.materialKey);
const {bufferLayouts:H,attributes:J}=h.createProgramDescriptor(F.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},...F.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],...F.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[]]});
z=w.materialManager.getMaterialProgram(q,F,"materials/fill",J,z);t.bindProgram(z);this._setSharedUniforms(z,q,u);F.textureBinding&&(w.textureManager.bindTextures(t,z,F),z.setUniform1f("u_zoomFactor",1/2**(C-u.key.level)/q.pixelRatio));F.vvColor&&(z.setUniform1fv("u_vvColorValues",x.vvColorValues),z.setUniform4fv("u_vvColors",x.vvColors));F.vvOpacity&&(z.setUniform1fv("u_vvOpacityValues",x.vvOpacityValues),z.setUniform1fv("u_vvOpacities",x.vvOpacities));if(F.dotDensity){F=E.TILE_SIZE/x.ddDotSize;const K=
F*window.devicePixelRatio*F*window.devicePixelRatio;u=1/2**(C-u.key.level);const N=1/u*(1/u);q=x.ddDotScale?q.state.scale/x.ddDotScale:1;z.setUniform1f("u_tileZoomFactor",u);z.setUniform1f("u_tileDotsOverArea",K/(E.TILE_SIZE*window.devicePixelRatio*E.TILE_SIZE*window.devicePixelRatio));z.setUniformMatrix4fv("u_dotColors",x.ddColors);z.setUniform4fv("u_isActive",x.ddActiveDots);z.setUniform4fv("u_dotBackgroundColor",x.ddBackgroundColor);z.setUniform1f("u_dotValue",Math.max(1,x.ddDotValue*q*N));this._bindDotDensityTextures(t,
z,x,F)}v.draw(t,H,J)};g._disposeTextures=function(){if(this._dotTextures){for(let q=0;q<this._dotTextures.length;q++)this._dotTextures[q].dispose();this._dotTextures=null}};g._bindDotDensityTextures=function(q,u,v,z){v=this._createDotDensityTextures(q,z,v.ddSeed);u.setUniform1iv("u_dotTextures",this._dotSamplers);for(u=0;u<v.length;u++)q.bindTexture(v[u],this._dotSamplers[u])};g._createDotDensityTextures=function(q,u,v){if(this._dotTextureSize!==u||this._seed!==v)this._disposeTextures(),this._dotTextureSize=
u,this._seed=v;null===this._dotTextures&&(v=new D(v),this._dotTextures=[this._allocDotDensityTexture(q,u,v),this._allocDotDensityTexture(q,u,v)]);return this._dotTextures};g._allocDotDensityTexture=function(q,u,v){const z=new Float32Array(u*u*4);for(let t=0;t<z.length;t++)z[t]=v.getFloat();return new k(q,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:u,height:u},z)};return p}(m)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/Error","../enums","../mesh/templates/meshUtils"],function(y,D,E,B,A){function k(p,g=!1){const q=B.WGLVVFlag.SIZE_FIELD_STOPS|B.WGLVVFlag.SIZE_MINMAX_VALUE|B.WGLVVFlag.SIZE_SCALE_STOPS|B.WGLVVFlag.SIZE_UNIT_VALUE;p=(p&(B.WGLVVTarget.FIELD_TARGETS_OUTLINE|B.WGLVVTarget.MINMAX_TARGETS_OUTLINE|B.WGLVVTarget.SCALE_TARGETS_OUTLINE|B.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return g?q&p:q&~p}function c(p){const g=k(p,!1);return p&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY|B.WGLVVFlag.ROTATION|
g)}let b=function(){function p(q){this._data=0;this._data=q}p.load=function(q){const u=this.shared;u.data=q;return u};var g=p.prototype;g.setBit=function(q,u){q=1<<q;this._data=u?this._data|q:this._data&~q};g.bit=function(q){return(this._data&1<<q)>>q};g.setBits=function(q,u,v){for(let z=u,t=0;z<v;z++,t++)this.setBit(z,0!==(q&1<<t))};g.bits=function(q,u){let v=0;for(let z=q,t=0;z<u;z++,t++)v|=this.bit(z)<<t;return v};g.hasVV=function(){return!1};g.setVV=function(q,u){};g.getVariation=function(){return{mapAligned:this.mapAligned,
pattern:this.pattern,sdf:this.sdf}};g.getVariationHash=function(){return this._data&~(7&this.textureBinding)};D._createClass(p,[{key:"data",get:function(){return this._data},set:function(q){this._data=q}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(q){this.setBits(q,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(q){this.setBit(20,q)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(q){this.setBit(11,q)}},{key:"pattern",get:function(){return!!this.bit(12)},
set:function(q){this.setBit(12,q)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(q){this.setBits(q,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case B.WGLGeometryType.FILL:return"fill";case B.WGLGeometryType.MARKER:return"marker";case B.WGLGeometryType.LINE:return"line";case B.WGLGeometryType.TEXT:return"text";case B.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);
return p}();b.shared=new b(0);const e=p=>function(g){function q(){return g.apply(this,arguments)||this}D._inheritsLoose(q,g);var u=q.prototype;u.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};u.setVV=function(v,z){g.prototype.setVV.call(this,v,z);v&=k(v,z);this.vvSizeMinMaxValue=!!(v&B.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(v&B.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(v&B.WGLVVFlag.SIZE_UNIT_VALUE);
this.vvSizeScaleStops=!!(v&B.WGLVVFlag.SIZE_SCALE_STOPS)};D._createClass(q,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(v){this.setBit(16,v)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(v){this.setBit(17,v)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(v){this.setBit(18,v)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(v){this.setBit(19,v)}}]);return q}(p),a=p=>function(g){function q(){return g.apply(this,
arguments)||this}D._inheritsLoose(q,g);var u=q.prototype;u.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvRotation};u.setVV=function(v,z){g.prototype.setVV.call(this,v,z);this.vvRotation=!z&&!!(v&B.WGLVVFlag.ROTATION)};D._createClass(q,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(v){this.setBit(15,v)}}]);return q}(p),d=p=>function(g){function q(){return g.apply(this,arguments)||this}D._inheritsLoose(q,g);var u=q.prototype;u.hasVV=function(){return g.prototype.hasVV.call(this)||
this.vvColor};u.setVV=function(v,z){g.prototype.setVV.call(this,v,z);this.vvColor=!z&&!!(v&B.WGLVVFlag.COLOR)};D._createClass(q,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(v){this.setBit(13,v)}}]);return q}(p),f=p=>function(g){function q(){return g.apply(this,arguments)||this}D._inheritsLoose(q,g);var u=q.prototype;u.hasVV=function(){return g.prototype.hasVV.call(this)||this.vvOpacity};u.setVV=function(v,z){g.prototype.setVV.call(this,v,z);this.vvOpacity=!z&&!!(v&B.WGLVVFlag.OPACITY)};
D._createClass(q,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(v){this.setBit(14,v)}}]);return q}(p);let n=function(p){function g(){return p.apply(this,arguments)||this}D._inheritsLoose(g,p);g.load=function(q){const u=this.shared;u.data=q;return u};g.from=function(q,u){const v=this.load(0);v.geometryType=B.WGLGeometryType.FILL;u?v.dotDensity=!0:v.setVV(q,!1);return v.data};g.prototype.getVariation=function(){return{...p.prototype.getVariation.call(this),dotDensity:this.dotDensity,
vvColor:this.vvColor,vvOpacity:this.vvOpacity}};D._createClass(g,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(q){this.setBit(15,q)}}]);return g}(d(f(b)));n.shared=new n(0);let l=function(p){function g(){return p.apply(this,arguments)||this}D._inheritsLoose(g,p);g.load=function(q){const u=this.shared;u.data=q;return u};g.from=function(q){const u=this.load(0);u.geometryType=B.WGLGeometryType.MARKER;u.setVV(q,!1);return u.data};g.prototype.getVariation=function(){return{...p.prototype.getVariation.call(this),
vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(d(f(a(e(b)))));l.shared=new l(0);let h=function(p){function g(){return p.apply(this,arguments)||this}D._inheritsLoose(g,p);g.load=function(q){const u=this.shared;u.data=q;return u};g.from=function(q,u){const v=this.load(0);v.geometryType=B.WGLGeometryType.LINE;
v.setVV(q,u);return v.data};g.prototype.getVariation=function(){return{...p.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(d(f(e(b))));h.shared=new h(0);let m=function(p){function g(){return p.apply(this,arguments)||this}D._inheritsLoose(g,p);g.load=function(q){const u=this.shared;u.data=q;return u};
g.from=function(q){const u=this.load(q);u.geometryType=B.WGLGeometryType.TEXT;u.setVV(q,!1);return u.data};g.prototype.getVariation=function(){return{...p.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(d(f(a(e(b)))));m.shared=new m(0);let r=function(p){function g(){return p.apply(this,
arguments)||this}D._inheritsLoose(g,p);g.load=function(q){const u=this.shared;u.data=q;return u};g.from=function(q,u){const v=this.load(0);v.geometryType=B.WGLGeometryType.LABEL;v.setVV(q,!1);v.mapAligned=!!A.isMapAligned(u);return v.data};g.prototype.getVariation=function(){return{...p.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return g}(e(b));r.shared=
new r(0);y.FillMaterialKey=n;y.LabelMaterialKey=r;y.LineMaterialKey=h;y.MarkerMaterialKey=l;y.MaterialKeyBase=b;y.TextMaterialKey=m;y.createMaterialKey=function(p,g,q,u,v){switch(p){case B.WGLGeometryType.FILL:return n.from(g,u);case B.WGLGeometryType.LINE:return h.from(g,q);case B.WGLGeometryType.MARKER:return l.from(g);case B.WGLGeometryType.TEXT:return m.from(g);case B.WGLGeometryType.LABEL:return r.from(g,v);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${p}`);}};y.getFillVVFlags=
function(p){return p&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY)};y.getLabelVVFlags=function(p){const g=k(p,!1);return p&g};y.getLineVVFlags=function(p,g){if(g)return g=k(p,!0),p&g;g=k(p,!1);return p&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY|g)};y.getMarkerVVFlags=c;y.getSizeFlagsMask=k;y.getTextVVFlags=function(p){return c(p)};y.hydrateMaterialKey=function(p){switch(b.load(p).geometryType){case B.WGLGeometryType.MARKER:return new l(p);case B.WGLGeometryType.FILL:return new n(p);case B.WGLGeometryType.LINE:return new h(p);
case B.WGLGeometryType.TEXT:return new m(p);case B.WGLGeometryType.LABEL:return new r(p)}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],function(y){y.isMapAligned=function(D){switch(D){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../definitions","./WGLBrush"],function(y,D,E,B){return function(A){function k(){return A.apply(this,arguments)||this}y._inheritsLoose(k,A);var c=k.prototype;c.prepareState=function({context:b},e,a){a=a&&-1!==a.indexOf("id");b.setBlendingEnabled(!a);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,e.stencilRef,255)};c.draw=function(b,e,a){var d=this.getGeometryType();e.commit(b);
d=e.getGeometry(d);D.isNone(d)||(b.timeline.begin(this.name),b.attributeView.bindTextures(b.context),d.forEachCommand(f=>this.drawGeometry(b,e,f,a)))};c._setSharedUniforms=function(b,e,a){b.setUniform1f("u_pixelRatio",e.pixelRatio);b.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b.setUniformMatrix3fv("u_displayViewMat3",e.state.displayViewMat3);b.setUniform1i("u_attributeTextureSize",e.attributeView.size);b.setUniform1i("u_attributeData0",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);b.setUniform1i("u_attributeData1",
E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);b.setUniform1i("u_attributeData2",E.TEXTURE_BINDING_ATTRIBUTE_DATA_2);b.setUniform1i("u_attributeData3",E.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return k}(B)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(y,D,E,B,A){return function(k){function c(){return k.apply(this,arguments)||this}y._inheritsLoose(c,
k);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.LABEL};b.drawGeometry=function(e,a,d,f){const {context:n,painter:l,state:h,rendererInfo:m}=e,r=E.LabelMaterialKey.load(d.materialKey),p=r.mapAligned?1:0;if(p||!(1<=Math.abs(a.key.level-Math.round(100*e.displayLevel)/100))){var {bufferLayouts:g,attributes:q}=B.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",
count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});f=l.materialManager.getMaterialProgram(e,r,"materials/label",q,f);e.context.setStencilFunction(514,0,255);n.bindProgram(f);this._setSharedUniforms(f,
e,a);l.textureManager.bindTextures(n,f,r);var u=1===p?h.displayViewMat3:h.displayMat3;r.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);r.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);r.vvSizeFieldStops&&(a=m.getSizeVVFieldStops(a.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",a.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));r.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);
f.setUniform1f("u_mapRotation",Math.floor(h.rotation/360*254));f.setUniform1f("u_mapAligned",p);f.setUniformMatrix3fv("u_displayMat3",u);f.setUniform1f("u_opacity",1);f.setUniform1f("u_zoomLevel",Math.round(10*e.displayLevel));f.setUniform2fv("u_screenSize",e.state.size);f.setUniform1f("u_isHalo",1);d.draw(n,g,q);f.setUniform1f("u_isHalo",0);d.draw(n,g,q);n.setStencilTestEnabled(!0);n.setBlendingEnabled(!0)}};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(y,D,E,B,A){return function(k){function c(){return k.apply(this,arguments)||this}y._inheritsLoose(c,k);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.LINE};b.drawGeometry=function(e,a,d,f){const {context:n,painter:l,rendererInfo:h,requiredLevel:m}=e,r=E.LineMaterialKey.load(d.materialKey),{bufferLayouts:p,attributes:g}=B.createProgramDescriptor(r.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]});f=l.materialManager.getMaterialProgram(e,r,"materials/line",g,f);const q=1/e.pixelRatio;n.bindProgram(f);
this._setSharedUniforms(f,e,a);r.textureBinding&&l.textureManager.bindTextures(n,f,r);f.setUniform1f("u_zoomFactor",2**(m-a.key.level)/e.pixelRatio);f.setUniform1f("u_blur",0+q);f.setUniform1f("u_antialiasing",q);r.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",h.vvSizeMinMaxValue);r.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",h.vvSizeScaleStopsValue);r.vvSizeFieldStops&&(e=h.getSizeVVFieldStops(a.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",e.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",
e.sizes));r.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",h.vvSizeUnitValueToPixelsRatio);r.vvColor&&(f.setUniform1fv("u_vvColorValues",h.vvColorValues),f.setUniform4fv("u_vvColors",h.vvColors));r.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",h.vvOpacityValues),f.setUniform1fv("u_vvOpacities",h.vvOpacities));n.setFaceCullingEnabled(!0);n.setFrontFace(2305);n.setCullFace(1029);d.draw(n,p,g);n.setFaceCullingEnabled(!1)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(y,D,E,B,A){return function(k){function c(){return k.apply(this,arguments)||this}y._inheritsLoose(c,k);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.MARKER};b.drawGeometry=function(e,a,d,f){const {context:n,painter:l,rendererInfo:h,state:m}=e,r=E.MarkerMaterialKey.load(d.materialKey),{bufferLayouts:p,attributes:g}=B.createProgramDescriptor(r.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:2,type:5123},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]});f=l.materialManager.getMaterialProgram(e,r,"materials/icon",g,f);n.bindProgram(f);
r.textureBinding&&l.textureManager.bindTextures(n,f,r,!0);this._setSharedUniforms(f,e,a);f.setUniformMatrix3fv("u_displayMat3",r.vvRotation?m.displayViewMat3:m.displayMat3);r.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",h.vvSizeMinMaxValue);r.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",h.vvSizeScaleStopsValue);r.vvSizeFieldStops&&(e=h.getSizeVVFieldStops(a.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",e.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes));
r.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",h.vvSizeUnitValueToPixelsRatio);r.vvColor&&(f.setUniform1fv("u_vvColorValues",h.vvColorValues),f.setUniform4fv("u_vvColors",h.vvColors));r.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",h.vvOpacityValues),f.setUniform1fv("u_vvOpacities",h.vvOpacities));r.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===h.vvMaterialParameters.vvRotationType?0:1);d.draw(n,p,g)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(y,D,E,B,A){return function(k){function c(){return k.apply(this,arguments)||this}y._inheritsLoose(c,k);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.TEXT};b.drawGeometry=function(e,a,d,f){const {context:n,painter:l,rendererInfo:h,state:m}=e,r=E.TextMaterialKey.load(d.materialKey),{bufferLayouts:p,attributes:g}=B.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]});f=l.materialManager.getMaterialProgram(e,r,"materials/text",g,f);n.bindProgram(f);this._setSharedUniforms(f,e,a);
l.textureManager.bindTextures(n,f,r);f.setUniformMatrix3fv("u_displayMat3",m.displayMat3);f.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);r.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",h.vvSizeMinMaxValue);r.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",h.vvSizeScaleStopsValue);r.vvSizeFieldStops&&(e=h.getSizeVVFieldStops(a.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",e.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes));r.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
h.vvSizeUnitValueToPixelsRatio);r.vvColor&&(f.setUniform1fv("u_vvColorValues",h.vvColorValues),f.setUniform4fv("u_vvColors",h.vvColors));r.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",h.vvOpacityValues),f.setUniform1fv("u_vvOpacities",h.vvOpacities));r.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===h.vvMaterialParameters.vvRotationType?0:1);f.setUniform1f("u_isHalo",1);d.draw(n,p,g);f.setUniform1f("u_isHalo",0);d.draw(n,p,g)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../webgl/rasterUtils","../../VertexStream","../WGLBrush"],function(y,D,E,B){return function(A){function k(){var b=A.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:{a_position:0,a_texcoord:1}},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};b._rendererUniformInfos=new Map;return b}y._inheritsLoose(k,
A);var c=k.prototype;c.dispose=function(){this._quad&&this._quad.dispose()};c.prepareState=function({context:b},e){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,e.stencilRef,255)};c.draw=function(b,e){var a;if(e.source&&!e.suspended){b.timeline.begin(this.name);var d=!(null!=(a=b.context.capabilities.textureFloat)&&a.textureFloatLinear);e.updateTexture(b);a=this.getShaderVariations(e,
d);a=b.painter.materialManager.getProgram(b,this._desc[e.symbolizerParameters.type],a);this.drawWithProgram(b.context,a,e);b.timeline.end(this.name)}};c.drawWithProgram=function(b,e,a,d=1,f=[0,0],n=!1){this._quad||(this._quad=new E(b,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:l,transformGrid:h,width:m,height:r,opacity:p}=a;var g=l.type;b.bindProgram(e);const q=this.getShaderVariations(a);g=this.getUniformInfos(g,b,e,q);const {names:u,textures:v}=a.getTextures();D.setTextures(b,e,u,v);b=D.getBasicGridUniforms(d,
f);n=D.getCommonUniforms(h,[m,r],[a.source.width,a.source.height],p,n);D.setUniforms(e,g,{u_coordScale:a.coordScale,u_dvsMat3:a.transforms.dvs,...b,...n});if(l.colormap){const {colormap:z,colormapOffset:t}=l;a=D.getColormapUniforms(z,t);D.setUniforms(e,g,a)}"stretch"===l.type?(a=D.getStretchUniforms(l),D.setUniforms(e,g,a)):"hillshade"===l.type&&(a=D.getShadedReliefUniforms(l),D.setUniforms(e,g,a));this._quad.draw()};c.getUniformInfos=function(b,e,a,d){b=0<d.length?b+"-"+d.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);
e=D.getUniformLocationInfos(e,a);this._rendererUniformInfos.set(b,e);return e};c.getShaderVariations=function(b,e=!1){const a=[];"cubic"===b.interpolation?a.push("bicubic"):e&&"bilinear"===b.interpolation&&a.push("bilinear");b.isRendereredSource?a.push("noop"):b.symbolizerParameters.colormap&&a.push("applyColormap");b.transformGrid&&a.push("applyProjection");return a};return k}(B)})},"esri/views/webgl/rasterUtils":function(){define("exports ./Program ./BufferObject ./Texture ./VertexArrayObject ./Renderbuffer ./FramebufferObject ./ProgramCache ./RenderingContext ./ShaderCompiler".split(" "),
function(y,D,E,B,A,k,c,b,e,a){y.createColormapTexture=function(d,f){return new B(d,{width:f.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},f)};y.createFrameBuffer=function(d,f,n,l){l=new B(d,{width:f,height:n,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:l?5121:5126,wrapMode:33071,flipped:!1});return new c(d,{colorTarget:0,depthStencilTarget:3,width:f,height:n},l)};y.createRasterTexture=function(d,
f,n="nearest",l=!1){var h,m=!(l&&"u8"===f.pixelType);l=m?5126:5121;m=null==f.pixels||0===f.pixels.length?null:m?f.getAsRGBAFloat():f.getAsRGBA();const r=null==(h=d.capabilities.textureFloat)?void 0:h.textureFloatLinear;f={width:f.width,height:f.height,target:3553,pixelFormat:6408,internalFormat:d.isWebGL2Context()?34836:6408,samplingMode:!r||"bilinear"!==n&&"cubic"!==n?9728:9729,dataType:l,wrapMode:33071,flipped:!1};return new B(d,f,m)};y.createTransformTexture=function(d,f){var n=4*f.size[0],l=f.size[1];
const h={width:n,height:l,target:3553,pixelFormat:6408,internalFormat:d.isWebGL2Context()?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1};n=new Float32Array(n*l*4);l=0;for(let m=0;m<f.coefficients.length;m++)n[l++]=f.coefficients[m],2===m%3&&(n[l++]=1);return new B(d,h,n)};y.getBasicGridUniforms=function(d,f){return{u_scale:d,u_offset:f}};y.getColormapUniforms=function(d,f){return{u_colormapOffset:f||0,u_colormapMaxIndex:d?d.length/4-1:null}};y.getCommonUniforms=function(d,f,
n,l=1,h=!0,m=!1){return{u_flipY:h,u_isFloatTexture:m,u_applyTransform:d?!0:!1,u_opacity:l,u_transformSpacing:d?d.spacing:null,u_transformGridSize:d?d.size:null,u_targetImageSize:f,u_srcImageSize:n}};y.getShadedReliefUniforms=function(d){return{u_hillshadeType:d.hillshadeType,u_sinZcosAs:d.sinZcosAs,u_sinZsinAs:d.sinZsinAs,u_cosZs:d.cosZs,u_weights:d.weights,u_factor:d.factor,u_minValue:d.minValue,u_maxValue:d.maxValue}};y.getStretchUniforms=function(d){return{u_bandCount:d.bandCount,u_minOutput:d.outMin,
u_maxOutput:d.outMax,u_minCutOff:d.minCutOff,u_maxCutOff:d.maxCutOff,u_factor:d.factor,u_useGamma:d.useGamma,u_gamma:d.gamma,u_gammaCorrection:d.gammaCorrection}};y.getUniformLocationInfos=function(d,f){d=d.gl;f=f.glName;const n=d.getProgramParameter(f,d.ACTIVE_UNIFORMS),l=new Map;let h;for(let m=0;m<n;m++)(h=d.getActiveUniform(f,m))&&l.set(h.name,{location:d.getUniformLocation(f,h.name),info:h});return l};y.setTextures=function(d,f,n,l){n.length===l.length&&(l.some(h=>null==h)||n.some(h=>null==h)||
n.forEach((h,m)=>{f.setUniform1i(h,m);d.bindTexture(l[m],m)}))};y.setUniforms=function(d,f,n){Object.keys(n).forEach(l=>{var h=f.get(l)||f.get(l+"[0]");if(h){var m=n[l];if(null!==h&&null!=m)switch({info:h}=h,h.type){case 5126:1<h.size?d.setUniform1fv(l,m):d.setUniform1f(l,m);break;case 35664:d.setUniform2fv(l,m);break;case 35665:d.setUniform3fv(l,m);break;case 35666:d.setUniform4fv(l,m);break;case 35675:d.setUniformMatrix3fv(l,m);break;case 35676:d.setUniformMatrix4fv(l,m);break;case 5124:1<h.size?
d.setUniform1iv(l,m):d.setUniform1i(l,m);break;case 35670:d.setUniform1i(l,m?1:0);break;case 35667:case 35671:d.setUniform2iv(l,m);break;case 35668:case 35672:d.setUniform3iv(l,m);break;case 35669:case 35673:d.setUniform4iv(l,m)}}})};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define("../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./Programs".split(" "),
function(y,D,E,B,A,k,c,b,e,a){return function(){function d(){this._programByKey=new Map}var f=d.prototype;f.dispose=function(){this._programByKey.forEach(n=>n.dispose());this._programByKey.clear()};f.getMaterialProgram=function(n,l,h){const m=l.key<<2|this._getMaterialOptionsValue(l.type,h);if(this._programByKey.has(m))return this._programByKey.get(m);var r=this._getProgramTemplate(l.type);({shaders:r}=r);const {vertexShader:p,fragmentShader:g}=r(h);h=l.getShaderHeader();r=l.getShaderMain();h=p.replace("#pragma header",
h).replace("#pragma main",r);n=new y(n,h,g,l.getAttributeLocations());this._programByKey.set(m,n);return n};f._getMaterialOptionsValue=function(n,l){switch(n){case 0:return(l.pattern?1:0)<<1|(l.id?1:0);case 1:return(l.pattern?1:0)<<1|(l.id?1:0);case 2:return l.id?1:0;case 3:return(l.pattern?1:0)<<1|(l.id?1:0);case 4:return(l.sdf?1:0)<<1|(l.id?1:0);case 5:return l.id?1:0;case 6:return l.id?1:0;default:return 0}};f._getProgramTemplate=function(n){switch(n){case 0:return a.background;case 5:return a.circle;
case 1:return a.fill;case 4:return a.icon;case 3:return a.line;case 2:return a.outline;case 6:return a.text;default:return null}};return d}()})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f){y.background={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+f.resolveIncludes("background/background.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+f.resolveIncludes("background/background.frag")})};y.circle={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("circle/circle.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("circle/circle.frag")})};y.fill={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id,
PATTERN:n.pattern})+f.resolveIncludes("fill/fill.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+f.resolveIncludes("fill/fill.frag")})};y.icon={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id,SDF:n.sdf})+f.resolveIncludes("icon/icon.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id,SDF:n.sdf})+f.resolveIncludes("icon/icon.frag")})};y.line={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+f.resolveIncludes("line/line.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id,
PATTERN:n.pattern})+f.resolveIncludes("line/line.frag")})};y.outline={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("outline/outline.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("outline/outline.frag")})};y.text={shaders:n=>({vertexShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("text/text.vert"),fragmentShader:b.glslifyDefineMap({ID:n.id})+f.resolveIncludes("text/text.frag")})};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define("exports ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./shaderRepository".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){const f=new a(function(n){let l=d;n.split("/").forEach(h=>{l&&(l=l[h])});return l});y.resolveIncludes=function(n){return f.resolveIncludes(n)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\n  v_color \x3d color * opacity;\n  v_stroke_color \x3d stroke_color * stroke_opacity;\n  v_stroke_width \x3d stroke_width;\n  v_radius \x3d radius;\n  v_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\n  v_color \x3d color * opacity;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float softEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * softEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (v_halo_width \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\n  v_color \x3d color;\n  v_opacity \x3d opacity;\n#ifdef SDF\n  v_halo_width \x3d halo_width;\n#endif\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_opacity *\x3d interpolatedOpacity;\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump vec2 a_tex            \x3d a_texAngleRange.xy;\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_opacity, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n#pragma main\n  v_color \x3d color * opacity;\n  v_blur \x3d blur + u_antialiasing;\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n  v_lineHalfWidth +\x3d (width + u_antialiasing) * 0.5;\n#ifndef PATTERN\n  v_dasharray \x3d u_dasharray * width;\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\n  v_color \x3d color * opacity;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d halo_color * opacity;\n    halo_width *\x3d sdfPixel;\n    halo_blur *\x3d sdfPixel;\n  }\n  else\n  {\n    v_color \x3d color * opacity;\n    halo_width \x3d 0.0;\n    halo_blur \x3d 0.0;\n  }\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_color *\x3d interpolatedOpacity;\n  mediump float a_angle       \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump vec2 a_tex          \x3d a_texAngleRange.xy;\n  mediump float a_visMinAngle    \x3d a_texAngleRange.z;\n  mediump float a_visMaxAngle    \x3d a_texAngleRange.w;\n  mediump float delta_z \x3d 0.0;\n  mediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\n  if (a_visMinAngle \x3c a_visMaxAngle)\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n  }\n  else\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n  }\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_color[3], 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - halo_width / size;\n  v_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/programUtils ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./shaders/BitBlitPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f){D=function(){function n(){this._initialized=!1}var l=n.prototype;l.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};l.render=function(h,m,r,p){h&&(this._initialized||this._initialize(h),h.setBlendFunctionSeparate(1,771,1,771),h.bindVAO(this._vertexArrayObject),h.bindProgram(this._program),m.setSamplingMode(r),h.bindTexture(m,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",p),h.drawArrays(5,0,4),h.bindTexture(null,0),h.bindVAO())};l._initialize=function(h){if(this._initialized)return!0;const m=f.bitBlit.attributes,r=b.createProgram(h,f.bitBlit);if(!r)return!1;const p=new Int8Array(16);p[0]=-1;p[1]=-1;p[2]=0;p[3]=0;p[4]=1;p[5]=-1;p[6]=1;p[7]=0;p[8]=-1;p[9]=1;p[10]=0;p[11]=1;p[12]=1;p[13]=1;p[14]=1;p[15]=1;h=new A(h,m,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,
offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:E.createVertex(h,35044,p)});this._program=r;this._vertexArrayObject=h;return this._initialized=!0};return n}();y.BitBlitRenderer=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(y,D){D={shaders:{vertexShader:D.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:D.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,
a_tex:1}};y.bitBlit=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("../../../../core/maybe ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ./shaders/MaterialPrograms".split(" "),function(y,D,E,B,A,k,c,b,e,a,d,f){const n=
m=>m===d.WGLDrawPhase.HITTEST||m===d.WGLDrawPhase.LABEL_ALPHA,l=({rendererInfo:m,drawPhase:r},p,g,q)=>{p=p.getVariationHash();q=q.join(".");r=(n(r)?1:0)|(r===d.WGLDrawPhase.HIGHLIGHT?2:0);return`${p}-${q}-${r}-${m.getVariationHash()}-${y.isSome(g)&&g.join(".")}`},h=(m,r,p,g)=>{g=g.reduce((q,u)=>({...q,[u]:m.driverTestResult[u]}),{});r={...r.getVariation(),...m.rendererInfo.getVariation(),highlight:m.drawPhase===d.WGLDrawPhase.HIGHLIGHT,id:n(m.drawPhase),...g};if(y.isSome(p))for(const q of p)r[q]=
!0;return r};return function(){function m(p){this._programByKey=new Map;this._programCache=new b(p)}var r=m.prototype;r.dispose=function(){this._programCache&&this._programCache.dispose()};r.getProgram=function(p,g,q=[],u=[]){const v=g.vsPath+"."+g.fsPath+JSON.stringify(q)+u.join(".");if(this._programByKey.has(v))return this._programByKey.get(v);u=u.reduce((x,C)=>({...x,[C]:p.driverTestResult[C]}),{});q={...q.map(x=>"string"===typeof x?{name:x,value:!0}:x).reduce((x,C)=>({...x,[C.name]:C.value}),
{}),...u};const {vsPath:z,fsPath:t,attributes:w}=g;g=this._programCache.getProgram(f.createProgramTemplate(z,t,w),q);if(!g)throw Error("Unable to get program for key: ${key}");this._programByKey.set(v,g);return g};r.getMaterialProgram=function(p,g,q,u,v,z=["ignoresSamplerPrecision"]){const t=l(p,g,v,z);if(this._programByKey.has(t))return this._programByKey.get(t);p=h(p,g,v,z);q=this._programCache.getProgram(f.createProgramTemplate(q,q,u),p);if(!q)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(t,q);return q};return m}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),function(y,D,E,B,A,k,
c,b,e,a,d,f){const n=l=>{const h={};for(const r in l){{let p=void 0;var m=r;p=""+m[0].toUpperCase();for(let g=1;g<m.length;g++){const q=m[g];q===q.toUpperCase()?(p+="_",p+=q):p+=q.toUpperCase()}m=p}h[m]=l[r]}return b.glslifyDefineMap(h)};y.createProgramTemplate=(l,h,m)=>{const r=l+l.substring(l.lastIndexOf("/")),p=h+h.substring(h.lastIndexOf("/"));return{attributes:m,shaders:g=>({vertexShader:n(g)+f.resolveIncludes(`${r}.vert`),fragmentShader:n(g)+f.resolveIncludes(`${p}.frag`)})}};Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../request ../../../../chunks/vec2 ./definitions ../../../../chunks/vec2f32 ../../../support/QueueProcessor ./util/BidiText ../../../../symbols/cim/Rasterizer ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z,t){function w(N){switch(N.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===N.style||"esriSFSNull"===N.style;case "esriSLS":return"esriSLSSolid"===N.style||"esriSLSNull"===N.style;default:return!1}}function x(N){switch(N.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}async function C(N,R){N=
N.imageData?`data:${N.contentType};base64,${N.imageData}`:N.url;var I;if(-1!==N.indexOf(";base64,")){R=N.indexOf(";base64,")+8;R=N.substring(R);R=atob(R);N=new Uint8Array(R.length);for(I=0;I<R.length;I++)N[I]=R.charCodeAt(I);I=N.buffer}else try{const {data:L}=await b(N,{responseType:"array-buffer",...R});I=L}catch(L){if(!k.isAbortError(L))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${N}`)}return I}function F(N,R){R=Math.round(c.pt2px(R)*window.devicePixelRatio);
return Math.min(N,R*(128<=R?2:4))}const H=d.create(),J=B.getLogger("esri.views.2d.engine.webgl.TextureManager");let K=function(){function N(R,I,L){this.mosaicType=R;this.page=I;this.sdf=L}N.fromMosaic=function(R,I){return new N(R,I.page,I.sdf)};return N}();return function(){function N(I){this._invalidFontsMap=new Map;this._sdfConverter=new g(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new l;this._ongoingRasterizations=new Map;this._imageRequestQueue=new f.QueueProcessor({concurrency:10,
process:async(L,G)=>{k.throwIfAborted(G);try{return await b(L,{responseType:"image",signal:G})}catch(M){if(!k.isAbortError(M))throw new A("mapview-invalid-resource",`Could not fetch requested resource at ${L}`,M);throw M;}}});this._spriteMosaic=new q(I,2048,2048,500);this._glyphSource=new p(`${D.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new r(1024,1024,this._glyphSource)}var R=N.prototype;R.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();
this._sdfConverter.dispose();this._sdfConverter=this._rasterizer=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=null;this._imageRequestQueue.clear();this._imageRequestQueue=null};R.rasterizeItem=async function(I,L,G,M){if(E.isNone(I))return J.error(new A("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(I.type){case "CIMTextSymbol":case "esriTS":return I=
await this._rasterizeText(I,G,M),I.forEach(P=>this._setTextureBinding(h.MosaicType.GLYPH,P)),{glyphMosaicItems:I};default:if(I.type&&-1!==I.type.toLowerCase().indexOf("3d"))return J.error(new A("mapview-invalid-type",`MapView does not support symbol type: ${I.type}`,I)),null;I=await this._rasterizeSpriteSymbol(I,L,M);z.ok(I)&&I&&this._setTextureBinding(h.MosaicType.SPRITE,I);return{spriteMosaicItem:I}}};R.bindTextures=function(I,L,G,M=!1){if(0!==G.textureBinding){var P=this._bindingInfos[G.textureBinding-
1];G=P.page;M=M?9987:9729;switch(P.mosaicType){case h.MosaicType.SPRITE:{P=this.sprites.getWidth(G);const T=this.sprites.getHeight(G);P=e.set(H,P,T);this._spriteMosaic.bind(I,M,G,a.TEXTURE_BINDING_SPRITE_ATLAS);L.setUniform1i("u_texture",a.TEXTURE_BINDING_SPRITE_ATLAS);L.setUniform2fv("u_mosaicSize",P);break}case h.MosaicType.GLYPH:P=e.set(H,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(I,M,G,a.TEXTURE_BINDING_GLYPH_ATLAS);L.setUniform1i("u_texture",a.TEXTURE_BINDING_GLYPH_ATLAS);L.setUniform2fv("u_mosaicSize",
P);break;default:J.error("mapview-texture-manager",`Cannot handle unknown type ${P.mosaicType}`)}}};R._hashMosaic=function(I,L){return 1|I<<1|(L.sdf?1:0)<<2|L.page<<3};R._setTextureBinding=function(I,L){const G=this._hashMosaic(I,L);this._hashToBindingIndex.has(G)||(I=K.fromMosaic(I,L),this._hashToBindingIndex.set(G,this._bindingInfos.length+1),this._bindingInfos.push(I));L.textureBinding=this._hashToBindingIndex.get(G)};R._rasterizeText=async function(I,L,G){const M=m.getFullyQualifiedFontName(I.font),
P=this._invalidFontsMap.has(M);if(L)I=L;else{I=n.bidiText(I.text)[0];L=[];for(let T=0;T<I.length;T++)L.push(I.charCodeAt(T));I=L}try{return await this._glyphMosaic.getGlyphItems(P?"arial-unicode-ms-regular":M,I,G)}catch(T){return J.error(new A("mapview-invalid-resource",`Couldn't find font ${M}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(M,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",I,G)}};R._rasterizeSpriteSymbol=async function(I,L,G){if(w(I))return null;
const M=t.keyFromSymbol(I);if(this._spriteMosaic.has(M))return this._spriteMosaic.getSpriteItem(M);if("esriSMS"===I.type&&I.path||I.url||I.imageData)return this._handleAsyncResource(M,I,G);if(L=this._rasterizer.rasterizeJSONResource(I,L)){const {size:P,image:T,sdf:Y,simplePattern:Z}=L;return this._addItemToMosaic(M,P,{type:"static",data:T},x(I),Y,Z)}return new A("TextureManager","unrecognized or null rasterized image")};R._handleAsyncResource=async function(I,L,G){if(this._ongoingRasterizations.has(I))return this._ongoingRasterizations.get(I);
L="esriSMS"===L.type&&L.path?this._handleSVG(L,I,G):this._handleImage(L,I,G);this._ongoingRasterizations.set(I,L);try{await L,this._ongoingRasterizations.delete(I)}catch{this._ongoingRasterizations.delete(I)}return L};R._handleSVG=async function(I,L,G){I=await this._sdfConverter.draw(I.path,G);return this._addItemToMosaic(L,[126,126],{type:"static",data:new Uint32Array(I.buffer)},!1,!0,!0)};R._handleGIFOrPNG=async function(I,L,G){var M=await C(I,G);if(z.ok(M)){var P=v.isGIF(M);const T=u.isPNG(M);
if(!P&&!T)return new A("mapview-invalid-resource","Image data is neither GIF nor PNG!");let Y;try{P&&v.isAnimatedGIF(M)?Y=await v["default"].create(M,G):T&&u.isAnimatedPNG(M)&&(Y=await u["default"].create(M,G))}catch(Z){if(!k.isAbortError(Z))return new A("mapview-invalid-resource","Could not fetch requested resource!")}if(Y&&z.ok(Y))return this._addItemToMosaic(L,[Y.width,Y.height],{type:"animated",data:Y},x(I),!1,!1);G=new Blob([M],{type:P?"image/gif":"image/png"});if((G=await this._imageFromBlob(G))&&
G instanceof HTMLImageElement){M=G.width;P=G.height;"esriPMS"===I.type&&(M=Math.round(F(G.width,I.width)),P=Math.round(M/G.width*G.height));const {size:Z,sdf:ca,image:ia}=this._rasterizer.rasterizeImageResource(M,P,G,I.colorSubstitutions);return this._addItemToMosaic(L,Z,{type:"static",data:ia},x(I),ca,!1)}}return new A("mapview-invalid-resource","Could not handle resource!")};R._handleImage=async function(I,L,G){var M;(M=I.url&&-1!==I.url.indexOf(".gif")||I.contentType&&"image/gif"===I.contentType||
I.imageData&&-1!==I.imageData.indexOf("data:image/gif"))||(M=I.url&&-1!==I.url.indexOf(".png")||I.contentType&&"image/png"===I.contentType||I.imageData&&-1!==I.imageData.indexOf("data:image/png"));if(M)return this._handleGIFOrPNG(I,L,G);M=I.imageData?`data:${I.contentType};base64,${I.imageData}`:I.url;try{const {data:P}=await this._imageRequestQueue.push(M,{...G});-1!==M.indexOf("data:image/svg+xml")&&(P.width=c.pt2px(I.width),P.height=c.pt2px(I.height));let T=P.width,Y=P.height;"esriPMS"===I.type&&
(T=Math.round(F(P.width,I.width)),Y=Math.round(T/P.width*P.height));const {size:Z,sdf:ca,image:ia}=this._rasterizer.rasterizeImageResource(T,Y,P,I.colorSubstitutions);return this._addItemToMosaic(L,Z,{type:"static",data:ia},x(I),ca,!1)}catch(P){if(!k.isAbortError(P))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${M}. ${P.message}`)}};R._imageFromBlob=async function(I){I=window.URL.createObjectURL(I);try{const {data:L}=await this._imageRequestQueue.push(I);window.URL.revokeObjectURL(I);
return L}catch(L){window.URL.revokeObjectURL(I);if(!k.isAbortError(L))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${I}`);throw L;}};R._addItemToMosaic=function(I,L,G,M,P,T){return this._spriteMosaic.addSpriteItem(I,L,G,M,P,T)};y._createClass(N,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return N}()})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["exports","../../../../../core/BidiEngine"],
function(y,D){const E=new D;y.bidiText=function(B){if(!E.hasBidiChar(B))return[B,!1];let A;A="rtl"===E.checkContextual(B)?"IDNNN":"ICNNN";return[E.bidiTransform(B,A,"VLYSN"),!0]};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(y){function D(v,z,t,w,x){var C=v;void 0===z&&(z=x.defInFormat);void 0===t&&(t=x.defOutFormat);void 0===w&&(w=x.defSwap);if(z!==t){var F=z.substring(0,1),H=t.substring(0,1);var J=z.substring(1,4);var K=
t.substring(1,4);"C"===J.charAt(0)&&(J=E(C),J="ltr"===J||"rtl"===J?J.toUpperCase():"L"===z.charAt(2)?"LTR":"RTL",z=F+J);"C"===K.charAt(0)&&(J=E(C),"rtl"===J?K="RTL":"ltr"===J?(C=C.split(""),C.reverse(),J=E(C.join("")),K=J.toUpperCase()):K="L"===t.charAt(2)?"LTR":"RTL",t=H+K)}if(z===t)return v;H=z.substring(0,1);C=z.substring(1,4);F=t.substring(0,1);K=t.substring(1,4);x.inFormat=z;x.outFormat=t;x.swap=w;if("L"===H&&"VLTR"===t){if("LTR"===C)return x.dir=0,B(v,x);if("RTL"===C)return x.dir=1,B(v,x)}if("V"===
H&&"V"===F)return x.dir="RTL"===C?1:0,k(v,x);if("L"===H&&"VRTL"===t)return x.dir="LTR"===C?0:1,v=B(v,x),k(v);if("VLTR"===z&&"LLTR"===t)return x.dir=0,B(v,x);if("V"===H&&"L"===F&&C!==K)return v=k(v),"RTL"===C?D(v,"LLTR","VLTR",w,x):D(v,"LRTL","VRTL",w,x);if("VRTL"===z&&"LRTL"===t)return D(v,"LRTL","VRTL",w,x);"L"===H&&"L"===F&&(z=x.swap,x.swap=z.substr(0,1)+"N","RTL"===C?(x.dir=1,v=B(v,x),x.swap="N"+z.substr(1,2),x.dir=0,v=B(v,x)):(x.dir=0,v=B(v,x),x.swap="N"+z.substr(1,2),v=D(v,"VLTR","LRTL",x.swap,
x)));return v}function E(v){return(v=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(v))?"z">=v[0]?"ltr":"rtl":""}function B(v,z){v=v.split("");const t=[];A(v,t,z);if(0!==z.hiLevel&&z.swap.substr(0,1)!==z.swap.substr(1,2))for(let C=0;C<v.length;C++)if(1===t[C]){var w=C;b:{let F=void 0;var x=v[C];let H=0,J=y.SwapTable.length-1;for(;H<=J;)if(F=Math.floor((H+J)/2),x<y.SwapTable[F][0])J=F-1;else if(x>y.SwapTable[F][0])H=F+1;else{x=y.SwapTable[F][1];break b}}v[w]=x}e(2,
v,t,z);e(1,v,t,z);p=t;return v.join("")}function A(v,z,t){const w=v.length;var x=t.dir?y.impTabRtl:y.impTabLtr,C=0,F=-1;const H=[],J=[];t.hiLevel=t.dir;t.lastArabic=!1;t.hasUbatAl=!1;t.hasUbatB=!1;t.hasUbatS=!1;for(var K=0;K<w;K++){var N=K;{var R=v[K].charCodeAt(0);const I=y.PrimaryTable[R>>8];R=I<y.TBBASE?I:y.UnicodeTable[I-y.TBBASE][R&255]}H[N]=R}for(N=0;N<w;N++){K=a(v,H,J,N,t);J[N]=K;C=x[C][K];R=C&240;C&=15;K=x[C][5];z[N]=K;if(0<R){if(16===R)for(;F<N;F++)z[F]=1;F=-1}if(x[C][6])-1===F&&(F=N);else if(-1<
F){for(;F<N;F++)z[F]=K;F=-1}H[N]===y.UBAT_B&&(z[N]=0);t.hiLevel|=K}if(t.hasUbatS)for(v=0;v<w;v++)if(H[v]===y.UBAT_S)for(z[v]=t.dir,x=v-1;0<=x;x--)if(H[x]===y.UBAT_WS)z[x]=t.dir;else break}function k(v,z){v=v.split("");if(z){const t=[];A(v,t,z);p=t}v.reverse();m.reverse();return v.join("")}function c(v){for(let z=0;z<y.ArabicAlefBetIntervalsBegine.length;z++)if(v>=y.ArabicAlefBetIntervalsBegine[z]&&v<=y.ArabicAlefBetIntervalsEnd[z])return!0;return!1}function b(v,z,t,w){for(;z*t<w&&f(v[z]);)z+=t;return z*
t<w&&c(v[z])?!0:!1}function e(v,z,t,w){if(!(w.hiLevel<v))if(1!==v||1!==w.dir||w.hasUbatB){w=z.length;for(var x=0,C,F,H;x<w;){if(t[x]>=v){for(C=x+1;C<w&&t[C]>=v;)C++;for(F=C-1;x<F;x++,F--)H=z[x],z[x]=z[F],z[F]=H,H=m[x],m[x]=m[F],m[F]=H;x=C}x++}}else z.reverse(),m.reverse()}function a(v,z,t,w,x){return{UBAT_L:()=>{x.lastArabic=!1;return y.UBAT_L},UBAT_R:()=>{x.lastArabic=!1;return y.UBAT_R},UBAT_ON:()=>y.UBAT_ON,UBAT_AN:()=>y.UBAT_AN,UBAT_EN:()=>x.lastArabic?y.UBAT_AN:y.UBAT_EN,UBAT_AL:()=>{x.lastArabic=
!0;x.hasUbatAl=!0;return y.UBAT_R},UBAT_WS:()=>y.UBAT_ON,UBAT_CS:()=>{let C,F;if(1>w||w+1>=z.length||(C=t[w-1])!==y.UBAT_EN&&C!==y.UBAT_AN||(F=z[w+1])!==y.UBAT_EN&&F!==y.UBAT_AN)return y.UBAT_ON;x.lastArabic&&(F=y.UBAT_AN);return F===C?F:y.UBAT_ON},UBAT_ES:()=>(0<w?t[w-1]:y.UBAT_B)===y.UBAT_EN&&w+1<z.length&&z[w+1]===y.UBAT_EN?y.UBAT_EN:y.UBAT_ON,UBAT_ET:()=>{if(0<w&&t[w-1]===y.UBAT_EN)return y.UBAT_EN;if(x.lastArabic)return y.UBAT_ON;let C=w+1;const F=z.length;for(;C<F&&z[C]===y.UBAT_ET;)C++;return C<
F&&z[C]===y.UBAT_EN?y.UBAT_EN:y.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===x.inFormat){for(var C=z.length,F=w+1;F<C&&z[F]===y.UBAT_NSM;)F++;if(F<C&&(C=v[w].charCodeAt[0],F=z[F],(1425<=C&&2303>=C||64286===C)&&(F===y.UBAT_R||F===y.UBAT_AL)))return y.UBAT_R}return 1>w||z[w-1]===y.UBAT_B?y.UBAT_ON:t[w-1]},UBAT_B:()=>{x.lastArabic=!0;x.hasUbatB=!0;return x.dir},UBAT_S:()=>{x.hasUbatS=!0;return y.UBAT_ON},UBAT_LRE:()=>{x.lastArabic=!1;return y.UBAT_ON},UBAT_RLE:()=>{x.lastArabic=!1;return y.UBAT_ON},UBAT_LRO:()=>
{x.lastArabic=!1;return y.UBAT_ON},UBAT_RLO:()=>{x.lastArabic=!1;return y.UBAT_ON},UBAT_PDF:()=>{x.lastArabic=!1;return y.UBAT_ON},UBAT_BN:()=>y.UBAT_ON}[y.TYPES_NAMES[z[w]]]()}function d(v,z){for(let t=0;t<y.BaseForm.length;t++)if(v===y.BaseForm[t])return z[t];return v}function f(v){return"\u064b"<=v&&"\u0655">=v?!0:!1}function n(v){return"L"===v?"LTR":"R"===v?"RTL":"C"===v?"CLR":"D"===v?"CRL":""}function l(v,z){for(let t=0;t<y.AlefTable.length;t++)if(v===y.AlefTable[t])return z[t];return v}function h(v,
z,t,w){for(let x=0;x<v.length;x++)if(v[x]>z||!t&&v[x]===z)v[x]+=w}let m=[],r=[],p=[];const g={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},q=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,u=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function v(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var z=
v.prototype;z.bidiTransform=function(t,w,x){this.sourceToTarget=[];this.targetToSource=[];if(!t)return"";var C=this.sourceToTarget,F=this.targetToSource,H=t.length;m=[];p=[];for(var J=0;J<H;J++)C[J]=J,F[J]=J,m[J]=J;if(!this.checkParameters(w,x))return t;w=this.inputFormat;x=this.outputFormat;C=t;H=n(w.charAt(1));C=n(x.charAt(1));J="I"===w.charAt(0)?"L":w.charAt(0);F="I"===x.charAt(0)?"L":x.charAt(0);H=J+H;C=F+C;F=w.charAt(2)+x.charAt(2);g.defInFormat=H;g.defOutFormat=C;g.defSwap=F;t=D(t,H,C,F,g);
C=!1;if("R"===x.charAt(1))C=!0;else if("C"===x.charAt(1)||"D"===x.charAt(1))C="rtl"===this.checkContextual(t);F=this.sourceToTarget=m;H=Array(F.length);for(J=0;J<F.length;J++)H[F[J]]=J;r=this.targetToSource=F=H;if(w.charAt(3)===x.charAt(3))C=t;else if("S"===x.charAt(3))if(w=C,x=!0,0===t.length)C="";else{void 0===w&&(w=!0);void 0===x&&(x=!0);t=String(t);t=t.split("");H=0;C=1;F=t.length;w||(H=t.length-1,C=-1,F=1);var K=H;H=x;var N=0;J=[];for(var R=0;K*C<F;K+=C)if(c(t[K])||f(t[K])){var I;if(I="\u0644"===
t[K])b:{for(var L=t,G=K+C,M=C,P=F;G*M<P&&f(L[G]);)G+=M;I=" ";if(G*M<P)for(I=L[G],L=0;L<y.AlefTable.length;L++)if(y.AlefTable[L]===I){I=!0;break b}I=!1}if(I){t[K]=0===N?l(t[K+C],y.LamAlefInialTableFE):l(t[K+C],y.LamAlefMedialTableFE);K+=C;N=t;I=K;L=C;for(G=F;I*L<G&&f(N[I]);)I+=L;I*L<G&&(N[I]=" ");H&&(J[R]=K,R++);N=0}else{I=t[K];if(1===N){L=K;if(b(t,K+C,C,F))b:for(G=t[K],M=0;M<y.BaseForm.length;M++){if(G===y.BaseForm[M]){G=y.MedialForm[M];break b}}else G=d(t[K],y.FinalForm);t[L]=G}else!0===b(t,K+C,
C,F)?t[K]=d(t[K],y.InitialForm):t[K]=d(t[K],y.IsolatedForm);f(I)||(N=1);b:{for(L=0;L<y.StandAlonForm.length;L++)if(y.StandAlonForm[L]===I){I=!0;break b}I=!1}!0===I&&(N=0)}}else N=0;C=J;F="";for(H=0;H<t.length;H++){if(J=x){b:{for(J=0;J<C.length;J++)if(C[J]===H)break b;J=-1}J=-1<J}J?(h(r,H,!w,-1),m.splice(H,1)):F+=t[H]}C=F}else if(w=t,x=C,t=!0,0===w.length)C="";else for(void 0===t&&(t=!0),void 0===x&&(x=!0),w=String(w),C="",F=w.split(""),H=0;H<w.length;H++)J=!1,"\ufe70"<=F[H]&&"\ufeff">F[H]?(R=w.charCodeAt(H),
"\ufef5"<=F[H]&&"\ufefc">=F[H]?(x?(0<H&&t&&" "===F[H-1]?C=C.substring(0,C.length-1)+"\u0644":(C+="\u0644",J=!0),C+=y.AlefTable[(R-65269)/2]):(C+=y.AlefTable[(R-65269)/2],C+="\u0644",H+1<w.length&&t&&" "===F[H+1]?H++:J=!0),J&&(h(r,H,!0,1),m.splice(H,0,m[H]))):C+=y.FETo06Table[R-65136]):C+=F[H];this.sourceToTarget=m;this.targetToSource=r;this.levels=p;return C};z._inputFormatSetter=function(t){if(!q.test(t))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=t};
z._outputFormatSetter=function(t){if(!q.test(t))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=t};z.checkParameters=function(t,w){t?this._inputFormatSetter(t):t=this.inputFormat;w?this._outputFormatSetter(w):w=this.outputFormat;return t===w?!1:!0};z.checkContextual=function(t){t=E(t);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(w){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t};z.hasBidiChar=function(t){return u.test(t)};return v}()})},"esri/core/bidiEngineTables":function(){define(["exports"],
function(y){y.AlefTable=["\u0622","\u0623","\u0625","\u0627"];y.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];y.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];y.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");y.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
y.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");y.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
y.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");y.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];y.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];y.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
y.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];y.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");y.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];y.TBBASE=100;y.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");y.UBAT_AL=7;y.UBAT_AN=3;y.UBAT_B=5;y.UBAT_BN=18;y.UBAT_CS=9;y.UBAT_EN=2;y.UBAT_ES=10;y.UBAT_ET=11;y.UBAT_L=0;y.UBAT_LRE=13;y.UBAT_LRO=16;y.UBAT_NSM=12;y.UBAT_ON=
4;y.UBAT_PDF=15;y.UBAT_R=1;y.UBAT_RLE=14;y.UBAT_RLO=17;y.UBAT_S=6;y.UBAT_WS=8;y.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];y.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];y.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/Rasterizer":function(){define(["./utils","./Rect","./CIMSymbolHelper","./SDFHelper"],function(y,D,E,B){return function(){function A(){}var k=A.prototype;k.dispose=function(){this._rasterizationCanvas=
null};k.rasterizeJSONResource=function(c,b,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===c.type||"esriSFS"===c.type){const [r,p,g]=E.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,c.style,b);return{size:[p,g],image:new Uint32Array(r.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===c.type||"esriSLS"===c.type){const [r,p,g]=E.SymbolHelper.rasterizeSimpleLine(c.style,c.cap);return{size:[p,g],image:new Uint32Array(r.buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,d;"simple-marker"===c.type||"esriSMS"===c.type||"line-marker"===c.type?(c=E.CIMSymbolHelper.fromSimpleMarker(c),d=B.getSDFInfo(c)):"CIMHatchFill"===c.type?(c=E.CIMSymbolHelper.fromCIMHatchFill(c),a=new D(c.frame.xmin,-c.frame.ymax,c.frame.xmax-c.frame.xmin,c.frame.ymax-c.frame.ymin)):c.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===c.markerPlacement.type?(c=E.CIMSymbolHelper.fromCIMInsidePolygon(c),a=new D(c.frame.xmin,-c.frame.ymax,c.frame.xmax-
c.frame.xmin,c.frame.ymax-c.frame.ymin)):d=B.getSDFInfo(c);if(d&&!e){const [r,p,g]=B.buildSDF(d);return r?{size:[p,g],image:new Uint32Array(r.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [f,n,l,h,m]=E.CIMSymbolHelper.rasterize(this._rasterizationCanvas,c,a,!e);return f?{size:[n,l],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:h,anchorY:m}:null};k.rasterizeImageResource=function(c,b,e,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));
this._rasterizationCanvas.width=c;this._rasterizationCanvas.height=b;var d=this._rasterizationCanvas.getContext("2d");e instanceof ImageData?d.putImageData(e,0,0):(e.setAttribute("width",`${c}px`),e.setAttribute("height",`${b}px`),d.drawImage(e,0,0,c,b));e=d.getImageData(0,0,c,b);e=new Uint8Array(e.data);if(a)for(var f of a)if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){const [n,l,h,m]=f.oldColor,[r,p,g,q]=f.newColor;if(n!==r||l!==p||h!==g||m!==q)for(a=0;a<e.length;a+=
4)n===e[a]&&l===e[a+1]&&h===e[a+2]&&m===e[a+3]&&(e[a]=r,e[a+1]=p,e[a+2]=g,e[a+3]=q)}for(a=0;a<e.length;a+=4)f=e[a+3]/255,e[a]*=f,e[a+1]*=f,e[a+2]*=f;d=e;f=c;a=b;if(512<=f||512<=a){d=f/a;1<d?(f=512,a=Math.round(512/d)):(a=512,f=Math.round(512*d));d=new Uint8Array(4*f*a);const n=new Uint8ClampedArray(d.buffer);y.resampleHermite(e,c,b,n,f,a,!1)}return{size:[c,b],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return A}()})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(y){return function(){function D(E=0,B=0,A=0,k=0){this.x=E;this.y=B;this.width=A;this.height=k}D.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};y._createClass(D,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return D}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../core/Logger ../../core/mathUtils ../../Color ./CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),
function(y,D,E,B,A,k,c){function b(l,h){switch(h.type){case "CIMSymbolReference":l.drawSymbol(h.symbol,{type:"point",x:0,y:0});break;case "CIMPointSymbol":l.drawSymbol(h,{type:"point",x:0,y:0});break;case "CIMVectorMarker":{const m=new A.Placement;l.drawMarker(h,m)}}return l.envelope()}const e=Math.PI,a=e/2,d=D.getLogger("esri.symbols.cim.CIMSymbolHelper");D=function(){function l(){}l.getEnvelope=function(h){const m=new k.EnvDrawHelper;if(Array.isArray(h)){let r;for(const p of h)r?r.union(b(m,p)):
r=b(m,p);return r}return b(m,h)};l.getTextureAnchor=function(h){h=this.getEnvelope(h);if(!h||0>=h.width||0>=h.height)return[0,0,0];const m=96/72,r=h.height*m+2;return[(h.x+.5*h.width)*m/(h.width*m+2),-(h.y+.5*h.height)*m/r,r]};l.rasterize=function(h,m,r,p=!0){var g=r||this.getEnvelope(m);if(!g||0>=g.width||0>=g.height)return[null,0,0,0,0];var q=96/72;const u=(g.x+.5*g.width)*q,v=(g.y+.5*g.height)*q;h.width=g.width*q;h.height=g.height*q;r||(h.width+=2,h.height+=2);r=h.getContext("2d");q=k.Transformation.createScale(q,
-q);q.translate(.5*h.width-u,.5*h.height+v);q=new k.CanvasDrawHelper(r,q);switch(m.type){case "CIMPointSymbol":q.drawSymbol(m,{type:"point",x:0,y:0});break;case "CIMVectorMarker":g=new A.Placement,q.drawMarker(m,g)}m=r.getImageData(0,0,h.width,h.height);m=new Uint8Array(m.data);if(p)for(r=0;r<m.length;r+=4)p=m[r+3]/255,m[r]*=p,m[r+1]*=p,m[r+2]*=p;return[m,h.width,h.height,-u/h.width,-v/h.height]};l.fromSimpleMarker=function(h){var m=h.style;if("circle"===m||"esriSMSCircle"===m){var r=Math.acos(.995);
var p=Math.ceil(e/r/4);0===p&&(p=1);r=a/p;p*=4;m=[];m.push([50,0]);for(let q=1;q<p;q++)m.push([50*Math.cos(q*r),-50*Math.sin(q*r)]);m.push([50,0]);r={rings:[m]};p={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===m||"esriSMSCross"===m)r={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},p={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===m||"esriSMSDiamond"===m)r={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},p={xmin:-50,ymin:-50,
xmax:50,ymax:50};else if("square"===m||"esriSMSSquare"===m)r={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},p={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===m||"esriSMSX"===m)r={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},p={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===m||"esriSMSTriangle"===m)p=2/3*100,m=p-100,r={rings:[[[-57.735026918962575,m],[0,p],[57.735026918962575,m],[-57.735026918962575,m]]]},p=
{xmin:-57.735026918962575,ymin:m,xmax:57.735026918962575,ymax:p};else if("arrow"===m||"esriSMSArrow"===m)r={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},p={xmin:-50,ymin:-50,xmax:50,ymax:50};if(r&&p){var g=[{type:"CIMSolidFill",enable:!0,color:h.color}];h.outline&&g.push({type:"CIMSolidStroke",enable:!0,width:h.outline.width,color:h.outline.color});g={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:h.angle,size:h.size,offsetX:h.xoffset,offsetY:h.yoffset,
frame:p,markerGraphics:[{type:"CIMMarkerGraphic",geometry:r,symbol:{type:"CIMPolygonSymbol",symbolLayers:g}}]}]}}return g};l.fromCIMHatchFill=function(h){const m=void 0!==h.separation?h.separation:4,r=m/2;for(var p=this._getLineSymbolPeriod(h.lineSymbol)||4;4>p;)p*=2;p/=2;return{type:"CIMVectorMarker",frame:{xmin:-p,xmax:p,ymin:-r,ymax:r},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-p,0],[p,0]]]},symbol:h.lineSymbol}],size:m}};l._getLineSymbolPeriod=function(h){if(h){const m=this._getEffectsRepeat(h.effects);
if(m)return m;if(h.symbolLayers)for(const r of h.symbolLayers)if((h=this._getEffectsRepeat(r.effects))||r&&(h=this._getPlacementRepeat(r.markerPlacement)))return h}return 0};l._getEffectsRepeat=function(h){if(h)for(var m of h)if(m)switch(m.type){case "CIMGeometricEffectDashes":if((h=m.dashTemplate)&&h.length){m=0;for(const r of h)m+=r;h.length&1&&(m*=2);return m}break;case "CIMGeometricEffectWave":return m.period;default:d.error(`unsupported geometric effect type ${m.type}`)}return 0};l._getPlacementRepeat=
function(h){if(h)switch(h.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((h=h.placementTemplate)&&h.length){let m=0;for(const r of h)m+=r;h.length&1&&(m*=2);return m}}return 0};l.fromCIMInsidePolygon=function(h){var m=h.markerPlacement;const r={type:h.type,...h,markerPlacement:null,anchorPoint:null};let p,g;!0===m.shiftOddRows?(h=m.stepX/2,p=m.stepY,g=2*m.stepY,m=[{x:-h,y:0},{x:h,y:0},{x:0,y:p},{x:0,y:-p}].map(q=>
({type:"CIMMarkerGraphic",geometry:q,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}))):(h=m.stepX/2,p=m.stepY/2,g=m.stepY,m=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}]);return{type:"CIMVectorMarker",frame:{xmin:-h,xmax:h,ymin:-p,ymax:p},markerGraphics:m,size:g}};l.getFillColor=function(h){if(!h)return null;switch(h.type){case "CIMPolygonSymbol":if(h.symbolLayers)for(const m of h.symbolLayers)if(h=l.getFillColor(m),null!=h)return h;break;case "CIMTextSymbol":return l.getFillColor(h.symbol);
case "CIMSolidFill":return h.color}};l.getStrokeColor=function(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const m of h.symbolLayers)if(h=l.getStrokeColor(m),void 0!==h)return h;break;case "CIMTextSymbol":return l.getStrokeColor(h.symbol);case "CIMSolidStroke":return h.color}};l.getStrokeWidth=function(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const m of h.symbolLayers)if(h=l.getStrokeWidth(m),void 0!==h)return h;
break;case "CIMTextSymbol":return l.getStrokeWidth(h.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return h.width}};l.getSize=function(h){if(h)switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let m=0;if(h.symbolLayers)for(const r of h.symbolLayers)h=l.getSize(r),h>m&&(m=h);return m}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return h.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return h.size}};
l.getMarkerScaleRatio=function(h){if(h)switch(h.type){case "CIMVectorMarker":if(!1!==h.scaleSymbolsProportionally&&h.frame)return h.size/(h.frame.ymax-h.frame.ymin)}return 1};return l}();let f=function(){function l(){}l.rasterizeSimpleFill=function(h,m,r){"solid"!==m&&"none"!==m&&"esriSFSSolid"!==m&&"esriSFSNull"!==m||console.error("Unexpected: style does not require rasterization");r=E.nextPowerOfTwo(Math.ceil(r));var p=this._isHorizontalOrVertical(m)?8*r:16*r;const g=2*r;h.width=p;h.height=p;const q=
h.getContext("2d");q.strokeStyle="#FFFFFF";q.lineWidth=r;q.beginPath();if("vertical"===m||"cross"===m||"esriSFSCross"===m||"esriSFSVertical"===m)q.moveTo(p/2,-g),q.lineTo(p/2,p+g);if("horizontal"===m||"cross"===m||"esriSFSCross"===m||"esriSFSHorizontal"===m)q.moveTo(-g,p/2),q.lineTo(p+g,p/2);if("forward-diagonal"===m||"diagonal-cross"===m||"esriSFSDiagonalCross"===m||"esriSFSForwardDiagonal"===m)q.moveTo(-g,-g),q.lineTo(p+g,p+g),q.moveTo(p-g,-g),q.lineTo(p+g,g),q.moveTo(-g,p-g),q.lineTo(g,p+g);if("backward-diagonal"===
m||"diagonal-cross"===m||"esriSFSBackwardDiagonal"===m||"esriSFSDiagonalCross"===m)q.moveTo(p+g,-g),q.lineTo(-g,p+g),q.moveTo(g,-g),q.lineTo(-g,g),q.moveTo(p+g,p-g),q.lineTo(p-g,p+g);q.stroke();m=q.getImageData(0,0,h.width,h.height);m=new Uint8Array(m.data);for(p=0;p<m.length;p+=4)r=m[p+3]/255,m[p]*=r,m[p+1]*=r,m[p+2]*=r;return[m,h.width,h.height]};l.rasterizeSimpleLine=function(h,m){switch(m){case "butt":m="Butt";break;case "square":m="Square";break;default:m="Round"}const r="Butt"===m;switch(h){case "dash":case "esriSLSDash":h=
r?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":h=r?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":h=r?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":h=r?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":h=r?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":h=r?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":h=r?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":h=r?[4,1,1,1]:[3,2,0,2];
break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":h=r?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":h=r?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":d.error("Unexpected: style does not require rasterization");h=[0,0];break;default:d.error(`Tried to rasterize SLS, but found an unexpected style: ${h}!`),h=[0,0]}return this.rasterizeDash(h,m)};l.rasterizeDash=function(h,m){var r="Butt"===m,p="Square"===m;m=!r&&!p;var g=0;for(var q of h)g+=q;q=
15*g;var u=31*q;g=new Float32Array(u);var v=m?225:15;for(var z=0;z<u;++z)g[z]=v;v=u=0;z=!0;for(var t of h){u=v;v+=15*t;for(h=u;h<v;){let w=0;for(;31>w;){const x=m?(w-15)*(w-15):Math.abs(w-15);g[w*q+h]=z?r?Math.max(Math.max(u+7.5-h,x),Math.max(h-v+7.5,x)):x:m?Math.min((h-u)*(h-u)+x,(h-v)*(h-v)+x):p?Math.min(Math.max(h-u,x),Math.max(v-h,x)):Math.min(Math.max(h-u+7.5,x),Math.max(v+7.5-h,x));w++}h++}z=!z}r=g.length;t=new Uint8Array(4*r);for(p=0;p<r;++p)c.packFloatRGBA((m?Math.sqrt(g[p]):g[p])/15,t,4*
p);return[t,q,31]};l._isHorizontalOrVertical=function(h){return"vertical"===h||"horizontal"===h||"cross"===h||"esriSFSCross"===h||"esriSFSVertical"===h||"esriSFSHorizontal"===h};return l}(),n=function(){function l(){}l.findApplicableOverrides=function(h,m,r){if(m){if(h.primitiveName){let p=!1;for(const g of r)if(g.primitiveName===h.primitiveName){p=!0;break}if(!p)for(const g of m)g.primitiveName===h.primitiveName&&r.push(g)}switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(h.effects)for(const p of h.effects)l.findApplicableOverrides(p,
m,r);if(h.symbolLayers)for(const p of h.symbolLayers)l.findApplicableOverrides(p,m,r);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(h.effects)for(const p of h.effects)l.findApplicableOverrides(p,m,r);h.markerPlacement&&l.findApplicableOverrides(h.markerPlacement,m,r);if("CIMVectorMarker"===h.type){if(h.markerGraphics)for(const p of h.markerGraphics)l.findApplicableOverrides(p,
m,r),l.findApplicableOverrides(p.symbol,m,r)}else"CIMCharacterMarker"===h.type?l.findApplicableOverrides(h.symbol,m,r):"CIMHatchFill"===h.type&&l.findApplicableOverrides(h.lineSymbol,m,r)}}};l.applyOverrides=function(h,m,r,p){if(m){if(h.primitiveName)for(const q of m)if(q.primitiveName===h.primitiveName){var g=(g=q.propertyName)?g.charAt(0).toLowerCase()+g.substr(1):g;p&&p.push({cim:h,nocapPropertyName:g,value:h[g]});q.expression&&(q.value=l.toValue(q.propertyName,q.expression));if(r){let u=!1;for(const v of r)v.primitiveName===
h.primitiveName&&(u=!0);u||r.push(q)}h[g]=q.value}switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(h.effects)for(const q of h.effects)l.applyOverrides(q,m,r,p);if(h.symbolLayers)for(const q of h.symbolLayers)l.applyOverrides(q,m,r,p);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(h.effects)for(const q of h.effects)l.applyOverrides(q,m,r,p);if("CIMVectorMarker"===h.type&&h.markerGraphics)for(const q of h.markerGraphics)l.applyOverrides(q,
m,r,p),l.applyOverrides(q.symbol,m,r,p)}}};l.restoreOverrides=function(h){for(const m of h)m.cim[m.nocapPropertyName]=m.value};l.buildOverrideKey=function(h){let m="";for(const r of h)void 0!==r.value&&(m+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return m};l.toValue=function(h,m){return"DashTemplate"===h?m.split(" ").map(r=>Number(r)):"Color"===h?(h=(new B(m)).toRgba(),h[3]*=255,h):m};return l}();y.CIMSymbolHelper=D;y.OverrideHelper=n;y.SymbolHelper=f;Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(y){let D=function(){function B(){this.setIdentity()}var A=B.prototype;A.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};A.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};A.setTranslate=function(k,c){this.tx=k;this.ty=c};A.setTranslateZ=function(k){this.tz=
k};A.setRotateCS=function(k,c){this.rz=void 0;this.rz_c=k;this.rz_s=c};A.setRotate=function(k){this.rz=k;this.rz_s=this.rz_c=void 0};A.setRotateY=function(k){this.ry=k};A.setScale=function(k){this.s=k};A.setMeasure=function(k){this.m=k};return B}(),E=function(){function B(){}B.prototype.next=function(){return null};return B}();y.EmptyPlacementCursor=E;y.Placement=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ../../geometry/support/aaBoundingRect ./CIMPlacements ./CIMEffects ./CIMOperators ./Rect".split(" "),
function(y,D,E,B,A,k,c,b,e,a){const d=Math.PI/180,f=E.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let n=function(){function m(p){this._t=p}m.createIdentity=function(){return new m([1,0,0,0,1,0])};var r=m.prototype;r.clone=function(){return new m(this._t.slice())};r.transform=function(p){const g=this._t;return[g[0]*p[0]+g[1]*p[1]+g[2],g[3]*p[0]+g[4]*p[1]+g[5]]};m.createScale=function(p,g){return new m([p,0,0,0,g,0])};r.scale=function(p,g){const q=this._t;q[0]*=p;q[1]*=p;q[2]*=p;q[3]*=g;q[4]*=
g;q[5]*=g;return this};r.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};m.createTranslate=function(p,g){return new m([0,0,p,0,0,g])};r.translate=function(p,g){const q=this._t;q[2]+=p;q[5]+=g;return this};m.createRotate=function(p){const g=Math.cos(p);p=Math.sin(p);return new m([g,-p,0,p,g,0])};r.rotate=function(p){return this.multiply(m.createRotate(p))};r.multiply=function(p){const g=this._t;p=p._t;const q=g[1]*p[0]+g[4]*p[1],u=g[2]*p[0]+g[5]*p[1]+p[2],v=g[0]*
p[3]+g[3]*p[4],z=g[1]*p[3]+g[4]*p[4],t=g[2]*p[3]+g[5]*p[4]+p[5];g[0]=g[0]*p[0]+g[3]*p[1];g[1]=q;g[2]=u;g[3]=v;g[4]=z;g[5]=t;return this};return m}();E=function(){function m(p){this._transfos=[];this._sizeTransfos=[];this._transfos.push(p||n.createIdentity());this._sizeTransfos.push(p?p.scaleRatio():1)}var r=m.prototype;r.transformPt=function(p){return this._transfos[this._transfos.length-1].transform(p)};r.transformSize=function(p){return p*this._sizeTransfos[this._sizeTransfos.length-1]};r.back=
function(){return this._transfos[this._transfos.length-1]};r.push=function(p,g){g=g?p.scaleRatio():1;p.multiply(this.back());this._transfos.push(p);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*g)};r.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};r.drawSymbol=function(p,g){if(p)switch(p.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(p,g)}};r.drawMultiLayerSymbol=function(p,g){if(p){var q=p.symbolLayers;
if(q)if(p=p.effects){if(g=this.executeEffects(p,g))for(p=g.next();p;)this.drawSymbolLayers(q,p),p=g.next()}else this.drawSymbolLayers(q,g)}};r.executeEffects=function(p,g){g=new b.SimpleGeometryCursor(g);for(const q of p)(p=e.getEffectOperator(q))&&(g=p.execute(g,q,1));return g};r.drawSymbolLayers=function(p,g){let q=p.length;for(;q--;){const v=p[q];if(v&&!1!==v.enable){var u=v.effects;if(u){if(u=this.executeEffects(u,g)){let z=u.next();for(;z;)this.drawSymbolLayer(v,z),z=u.next()}}else this.drawSymbolLayer(v,
g)}}};r.drawSymbolLayer=function(p,g){switch(p.type){case "CIMSolidFill":this.drawSolidFill(g,p.color);break;case "CIMHatchFill":this.drawHatchFill(p,g);break;case "CIMSolidStroke":this.drawSolidStroke(g,p.color,p.width,p.capStyle,p.joinStyle,p.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(p,g)}};r.drawHatchFill=function(p,g){const q=this._buildHatchPolyline(p,g,1);q&&(this.pushClipPath(g),this.drawMultiLayerSymbol(p.lineSymbol,q),
this.popClipPath())};r.drawMarkerLayer=function(p,g){var q=p.markerPlacement;if(q){const v=e.getPlacementOperator(q);if(v){var u="CIMMarkerPlacementInsidePolygon"===q.type;u&&this.pushClipPath(g);if(g=v.execute(g,q,1))for(q=g.next();q;)this.drawMarker(p,q),q=g.next();u&&this.popClipPath()}}else u=new c.Placement,u.tx=g.x,u.ty=g.y,this.drawMarker(p,u)};r.drawMarker=function(p,g){switch(p.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(p,g);break;case "CIMVectorMarker":this.drawVectorMarker(p,
g)}};r.drawPictureMarker=function(p,g){if(p){var q=p.size||10,u=n.createIdentity(),v=p.anchorPoint;if(v){let z=v.x;v=v.y;"Absolute"!==p.anchorPointUnits&&(z*=q,v*=q);u.translate(-z,-v)}p.rotation&&u.rotate(p.rotation*d);u.translate(p.offsetX||0,p.offsetY||0);u.translate(g.tx,g.ty);this.push(u,!1);this.drawImage(p.url,q,p.scaleX);this.pop()}};r.drawVectorMarker=function(p,g){if(p){var q=p.markerGraphics;if(q){var u=p.size,v=p.frame,z=v?v.ymax-v.ymin:0;u=u&&z?u/z:1;z=n.createIdentity();v&&z.translate(.5*
-(v.xmax+v.xmin),.5*-(v.ymax+v.ymin));var t=p.anchorPoint;if(t){let w=t.x;t=t.y;"Absolute"!==p.anchorPointUnits&&v&&(w*=v.xmax-v.xmin,t*=v.ymax-v.ymin);z.translate(-w,-t)}1!==u&&z.scale(u,u);p.rotation&&z.rotate(p.rotation*d);z.translate(p.offsetX||0,p.offsetY||0);z.translate(g.tx,g.ty);this.push(z,p.scaleSymbolsProportionally);for(const w of q)w&&w.symbol&&w.geometry||f.error("Invalid marker graphic",w),this.drawSymbol(w.symbol,w.geometry);this.pop()}}};r._buildHatchPolyline=function(p,g,q){var u=
(void 0!==p.separation?p.separation:4)*q,v=void 0!==p.rotation?p.rotation:0;if(0===u)return null;0>u&&(u=-u);for(var z=0,t=.5*u;z>t;)z-=u;for(;z<-t;)z+=u;z=k.create();B.getBoundsXY(z,g);z[0]-=t;z[1]-=t;z[2]+=t;z[3]+=t;for(var w=[[z[0],z[1]],[z[0],z[3]],[z[2],z[3]],[z[2],z[1]]];180<v;)v-=180;for(;0>v;)v+=180;t=Math.cos(v*d);var x=Math.sin(v*d);v=-u*x;g=u*t;z=(void 0!==p.offsetX?p.offsetX*q:0)*x-(void 0!==p.offsetY?p.offsetY*q:0)*t;let C;var F=p=Number.MAX_VALUE;C=q=-Number.MAX_VALUE;for(var H of w){var J=
H[0];const K=H[1];w=t*J+x*K;J=-x*J+t*K;F=Math.min(F,w);p=Math.min(p,J);C=Math.max(C,w);q=Math.max(q,J)}p=Math.floor(p/u)*u;H=t*F-x*p-v*z/u;F=x*F+t*p-g*z/u;w=t*C-x*p-v*z/u;z=x*C+t*p-g*z/u;u=1+Math.round((q-p)/u);t=[];for(x=0;x<u;x++)H+=v,F+=g,w+=v,z+=g,t.push([[H,F],[w,z]]);return{paths:t}};return m}();let l=function(m){function r(){var g=m.call(this)||this;g.reset();return g}D._inheritsLoose(r,m);var p=r.prototype;p.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=
0};p.envelope=function(){return new a(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};p.drawSolidFill=function(g){!g||0<this._clipCount||(A.isPolygon(g)?this._processPath(g.rings,0):A.isPolyline(g)&&this._processPath(g.paths,0))};p.drawSolidStroke=function(g,q,u){!g||0<this._clipCount||(q=.5*this.transformSize(u),A.isPolygon(g)?this._processPath(g.rings,q):A.isPolyline(g)&&this._processPath(g.paths,q))};p.pushClipPath=function(g){this.drawSolidFill(g);++this._clipCount};p.popClipPath=
function(){--this._clipCount};p.drawImage=function(g,q,u){g=q/2;this._merge(this.transformPt([0,0]),g)};p._processPath=function(g,q){if(g)for(const u of g)if(g=u?u.length:0,1<g){this._merge(this.transformPt(u[0]),q);for(let v=1;v<g;++v)this._merge(this.transformPt(u[v]),q)}};p._merge=function(g,q){g[0]-q<this._xmin&&(this._xmin=g[0]-q);g[0]+q>this._xmax&&(this._xmax=g[0]+q);g[1]-q<this._ymin&&(this._ymin=g[1]-q);g[1]+q>this._ymax&&(this._ymax=g[1]+q)};return r}(E),h=function(m){function r(g,q){q=
m.call(this,q)||this;q._ctx=g;return q}D._inheritsLoose(r,m);var p=r.prototype;p.drawSolidFill=function(g,q){if(g){if(A.isPolygon(g))this._buildPath(g.rings,!0);else if(A.isPolyline(g))this._buildPath(g.paths,!0);else return;g=this._ctx;g.fillStyle="string"===typeof q?q:"rgba("+Math.round(q[0])+","+Math.round(q[1])+","+Math.round(q[2])+","+q[3]/255+")";g.fill("evenodd")}};p.drawSolidStroke=function(g,q,u,v,z,t){if(g&&q&&0!==u){if(A.isPolygon(g))this._buildPath(g.rings,!0);else if(A.isPolyline(g))this._buildPath(g.paths,
!1);else return;g=this._ctx;g.strokeStyle="string"===typeof q?q:"rgba("+Math.round(q[0])+","+Math.round(q[1])+","+Math.round(q[2])+","+q[3]/255+")";g.lineWidth=this.transformSize(u)+.5;this._setCapStyle(v);this._setJoinStyle(z);g.miterLimit=t;g.stroke()}};p.pushClipPath=function(g){this._ctx.save();A.isPolygon(g)?this._buildPath(g.rings,!0):A.isPolyline(g)&&this._buildPath(g.paths,!0);this._ctx.clip("evenodd")};p.popClipPath=function(){this._ctx.restore()};p.drawImage=function(g,q,u){};p._buildPath=
function(g,q){const u=this._ctx;u.beginPath();if(g)for(const v of g)if(g=v?v.length:0,1<g){let z=this.transformPt(v[0]);u.moveTo(z[0],z[1]);for(let t=1;t<g;++t)z=this.transformPt(v[t]),u.lineTo(z[0],z[1]);q&&u.closePath()}};p._setCapStyle=function(g){switch(g){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};p._setJoinStyle=function(g){switch(g){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin=
"round";break;case "Miter":this._ctx.lineJoin="miter"}};return r}(E);y.CIMSymbolDrawHelper=E;y.C_DEG_TO_RAD=d;y.CanvasDrawHelper=h;y.EnvDrawHelper=l;y.Transformation=n;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(y,D){let E=function(){function B(A){this._geometry=A}B.prototype.next=function(){const A=this._geometry;this._geometry=null;return A};return B}();y.SimpleGeometryCursor=E;y.clone=function(B){return D.clone(B)};
Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u){y.getEffectOperator=function(v){if(!v)return null;switch(v.type){case "CIMGeometricEffectAddControlPoints":return D.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return B.EffectBuffer.local();case "CIMGeometricEffectCut":return A.EffectCut.local();case "CIMGeometricEffectDashes":return k.EffectDashes.local();case "CIMGeometricEffectDonut":return c.EffectDonut.local();case "CIMGeometricEffectJog":return b.EffectJog.local();
case "CIMGeometricEffectMove":return e.EffectMove.local();case "CIMGeometricEffectOffset":return a.EffectOffset.local();case "CIMGeometricEffectReverse":return d.EffectReverse.local();case "CIMGeometricEffectRotate":return f.EffectRotate.local();case "CIMGeometricEffectScale":return n.EffectScale.local();case "CIMGeometricEffectWave":return l.EffectWave.local()}return null};y.getPlacementOperator=function(v){if(!v)return null;switch(v.type){case "CIMMarkerPlacementAlongLineSameSize":return h.PlacementAlongLineSameSize.local();
case "CIMMarkerPlacementAtExtremities":return m.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return r.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return p.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return g.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return q.PlacementOnVertices.local();case "CIMMarkerPlacementPolygonCenter":return u.PlacementPolygonCenter.local()}return null};Object.defineProperty(y,"__esModule",
{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(){function c(e,a,d){this._inputGeometries=e;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:
120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var b=c.prototype;b.next=function(){for(var e=this._inputGeometries.next();e;){if(E.isPolygon(e))return this._isClosed=!0,e=D.clone(e),this._processMultipath(e.rings),e;if(E.isPolyline(e))return this._isClosed=!1,e=D.clone(e),this._processMultipath(e.paths),e;if(E.isExtent(e)){if(this._maxCosAngle)return e;this._isClosed=!0;e=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];this._processPath(e);
return{rings:[e]}}e=this._inputGeometries.next()}return null};b._processMultipath=function(e){if(e)for(const a of e)this._processPath(a)};b._processPath=function(e){if(e){let a=e.length,d=e[0],f,n,l,h,m,r;this._isClosed&&++a;for(let p=1;p<a;++p){let g;g=this._isClosed&&p===a-1?e[0]:e[p];const q=g[0]-d[0],u=g[1]-d[1],v=Math.sqrt(q*q+u*u);1<p&&0<v&&0<l&&(f*q+n*u)/v/l<=this._maxCosAngle&&B.setId(d,1);1===p&&(h=q,m=u,r=v);0<v&&(d=g,f=q,n=u,l=v)}this._isClosed&&0<l&&0<r&&(f*h+n*m)/r/l<=this._maxCosAngle&&
B.setId(e[0],1)}};return c}();y.EffectAddControlPoints=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(y,D,E,B){function A(l){if(l){var h=l.length;for(--h;0<h;--h)l[h][0]-=l[h-1][0],l[h][1]-=l[h-1][1]}}function k(l){if(l)for(const h of l)A(h)}function c(l){if(l){const h=l.length;for(let m=1;m<h;++m)l[m][0]+=l[m-1][0],l[m][1]+=l[m-1][1]}}function b(l){if(l)for(const h of l)c(h)}
function e(l){l&&(E.isPolygon(l)?b(l.rings):E.isPolyline(l)?b(l.paths):E.isMultipoint(l)&&c(l.points))}function a(l){l&&l.reverse()}function d(l){return{rings:[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]]}}let f=function(){function l(h,m,r,p){this.acceptPolygon=m;this.acceptPolyline=r;this.geomUnitsPerPoint=p;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;h&&(E.isPolygon(h)?m&&(this.multiPath=h.rings,this.isClosed=!0):E.isPolyline(h)?r&&(this.multiPath=
h.paths,this.isClosed=!1):E.isExtent(h)&&m&&(this.multiPath=d(h).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new B.Placement}l.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const h=this.processPath(this.multiPath[this.pathIndex]);if(h)return h}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return l}(),n=function(){function l(h,
m,r,p){this.inputGeometries=h;this.acceptPolygon=m;this.acceptPolyline=r;this.geomUnitsPerPoint=p;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}l.prototype.next=function(){for(;;){if(!this.multiPath){for(var h=this.inputGeometries.next();h;)if(E.isPolygon(h)?this.acceptPolygon&&(this.multiPath=h.rings,this.isClosed=!0):E.isPolyline(h)?this.acceptPolyline&&(this.multiPath=h.paths,this.isClosed=!1):E.isExtent(h)&&this.acceptPolygon&&(this.multiPath=d(h).rings,this.isClosed=!0),this.multiPath){this.pathCount=
this.multiPath.length;this.pathIndex=-1;break}else h=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,h=this.processPath(this.multiPath[this.pathIndex]))return h;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return l}();y.PathGeometryCursor=n;y.PathTransformationCursor=f;y.cloneAndDecodeGeometry=function(l){l=D.clone(l);e(l);return l};y.deltaDecodeGeometry=e;y.deltaEncodeGeometry=function(l){l&&
(E.isPolygon(l)?k(l.rings):E.isPolyline(l)?k(l.paths):E.isMultipoint(l)&&A(l.points))};y.getCoord2D=function(l,h,m){return[l[0]+(h[0]-l[0])*m,l[1]+(h[1]-l[1])*m]};y.getId=function(l){return l[4]};y.isClosedPath=function(l){return l&&0!==l.length?l[0][0]===l[l.length-1][0]&&l[0][1]===l[l.length-1][1]:!1};y.reverseMultipath=function(l){if(l)for(const h of l)a(h)};y.reversePath=a;y.setId=function(l,h){l[4]=h};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(c){function b(a,d,f){a=c.call(this,a,!1,!0)||this;a._curveHelper=new B.CurveHelper;a._width=(void 0!==d.width?d.width:5)*f;a._arrowType=void 0!==d.geometricEffectArrowType?d.geometricEffectArrowType:
"OpenEnded";a._offsetFlattenError=B.PIXEL_TOLERANCE*f;return a}D._inheritsLoose(b,c);var e=b.prototype;e.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};e._constructSimpleArrow=function(a,d){var f=this._curveHelper.calculatePathLength(a),n=this._width;f<2*n&&(n=f/2);f=this._curveHelper.getSubCurve(a,0,f-n);if(!f)return null;var l=n/2;if(this._curveHelper.isEmpty(f,
!1))return null;n=this._constructOffset(f,-l);if(!n)return null;f=this._constructOffset(f,l);if(!f)return null;const h=this._constructArrowBasePoint(n,-l/2);if(!h)return null;l=this._constructArrowBasePoint(f,l/2);if(!l)return null;a=a[a.length-1];d||(this._makeControlPoint(f,!0),this._makeControlPoint(n,!0));const m=new B.PathHelper;m.addPath(f,!0);m.lineTo(l);this._makeControlPoint(m.path());m.lineTo(a);this._makeControlPoint(m.path());m.lineTo(h);this._makeControlPoint(m.path());m.addPath(n,!1);
return d?{paths:[m.path()]}:(m.close(),{rings:[m.path()]})};e._constructCrossedArrow=function(a){var d=this._curveHelper.calculatePathLength(a),f=this._width;d<3.732050807568877*f&&(f=d/3.732050807568877);var n=this._curveHelper.getSubCurve(a,0,d-2.732050807568877*f);if(!n)return null;var l=f/2;if(this._curveHelper.isEmpty(n,!1))return null;const h=this._constructOffset(n,l);if(!h)return null;n=this._constructOffset(n,-l);if(!n)return null;d=this._curveHelper.getSubCurve(a,0,d-f);if(!d||this._curveHelper.isEmpty(d,
!1))return null;f=this._constructOffset(d,l);if(!f)return null;var m=this._constructOffset(d,-l);if(!m)return null;d=f[f.length-1];f=this._constructArrowBasePoint(f,l/2);if(!f)return null;const r=m[m.length-1];l=this._constructArrowBasePoint(m,-l/2);if(!l)return null;a=a[a.length-1];this._makeControlPoint(h,!1);this._makeControlPoint(n,!1);m=new B.PathHelper;m.addPath(h,!0);this._makeControlPoint(m.path());m.lineTo(r);m.lineTo(l);this._makeControlPoint(m.path());m.lineTo(a);this._makeControlPoint(m.path());
m.lineTo(f);this._makeControlPoint(m.path());m.lineTo(d);this._makeControlPoint(m.path());m.addPath(n,!1);return{paths:[m.path()]}};e._constructOffset=function(a,d){return this._curveHelper.offset(a,d,"Rounded",4,this._offsetFlattenError)};e._constructArrowBasePoint=function(a,d){if(!a||2>a.length)return null;var f=a[a.length-2];a=a[a.length-1];f=[a[0]-f[0],a[1]-f[1]];this._curveHelper.normalize(f);return[a[0]+f[1]*d,a[1]-f[0]*d]};e._makeControlPoint=function(a,d=!1){d?E.setId(a[0],1):E.setId(a[a.length-
1],1)};return b}(E.PathGeometryCursor);y.EffectArrow=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(y){let D=function(){function B(){this._path=[]}var A=B.prototype;A.path=function(){return this._path};A.addPath=function(k,c){c||k.reverse();Array.prototype.push.apply(this._path,k);c||k.reverse()};B.mergePath=function(k,c){c&&Array.prototype.push.apply(k,c)};A.startPath=function(k){this._path.push(k)};A.lineTo=function(k){this._path.push(k)};
A.close=function(){const k=this._path;1<k.length&&(k[0][0]!==k[k.length-1][0]||k[0][1]!==k[k.length-1][1])&&k.push([k[0][0],k[0][1]])};return B}(),E=function(){function B(k,c){}var A=B.prototype;A.normalize=function(k){const c=Math.sqrt(k[0]*k[0]+k[1]*k[1]);k[0]/=c;k[1]/=c};A.calculateLength=function(k,c){const b=c[0]-k[0];k=c[1]-k[1];return Math.sqrt(b*b+k*k)};A.calculateSegLength=function(k,c){return this.calculateLength(k[c],k[c+1])};A.calculatePathLength=function(k){let c=0;const b=k?k.length:
0;for(let e=0;e<b-1;++e)c+=this.calculateSegLength(k,e);return c};A.calculatePathArea=function(k){let c=0;const b=k?k.length:0;for(let e=0;e<b-1;++e)c+=(k[e+1][0]-k[e][0])*(k[e+1][1]+k[e][1]);return c/2};A.getCoord2D=function(k,c,b){return[k[0]+(c[0]-k[0])*b,k[1]+(c[1]-k[1])*b]};A.getSegCoord2D=function(k,c,b){return this.getCoord2D(k[c],k[c+1],b)};A.getAngle=function(k,c,b){return Math.atan2(c[1]-k[1],c[0]-k[0])};A.getSegAngle=function(k,c,b){return this.getAngle(k[c],k[c+1],b)};A.getAngleCS=function(k,
c,b){b=c[0]-k[0];k=c[1]-k[1];c=Math.sqrt(b*b+k*k);return 0<c?[b/c,k/c]:[1,0]};A.getSegAngleCS=function(k,c,b){return this.getAngleCS(k[c],k[c+1],b)};A.cut=function(k,c,b,e){b=0>=b?k[c]:this.getSegCoord2D(k,c,b);k=1<=e?k[c+1]:this.getSegCoord2D(k,c,e);return[b,k]};A.addSegment=function(k,c,b){b&&k.push(c[0]);k.push(c[1])};A.getSubCurve=function(k,c,b){const e=[];return this.appendSubCurve(e,k,c,b)?e:null};A.appendSubCurve=function(k,c,b,e){const a=c?c.length-1:0;let d=0,f=!0,n=0;for(;n<a;){const h=
this.calculateSegLength(c,n);if(0!==h){if(f){if(d+h>b){var l=(b-d)/h;let m=1,r=!1;d+h>=e&&(m=(e-d)/h,r=!0);(l=this.cut(c,n,l,m))&&this.addSegment(k,l,f);if(r)break;f=!1}}else{if(d+h>e){(c=this.cut(c,n,0,(e-d)/h))&&this.addSegment(k,c,f);break}this.addSegment(k,[c[n],c[n+1]],f)}d+=h}++n}return!0};A.getCIMPointAlong=function(k,c){const b=k?k.length-1:0;let e=0,a=-1;for(;a<b;){++a;const d=this.calculateSegLength(k,a);if(0!==d){if(e+d>c)return this.getCoord2D(k[a],k[a+1],(c-e)/d);e+=d}}return null};A.isEmpty=
function(k,c){if(!k||1>=k.length)return!0;const b=k?k.length-1:0;let e=-1;for(;e<b;)if(++e,k[e+1][0]!==k[e][0]||k[e+1][1]!==k[e][1]||c&&k[e+1][2]!==k[e][2])return!1;return!0};A.offset=function(k,c,b,e,a){if(!k||2>k.length)return null;a=k.length;const d=k[0][0]===k[a-1][0]&&k[0][1]===k[a-1][1];if(d){if(3>k.length)return null;--a}const f=[];var n=d?k[a-1]:null;let l=k[0];for(let p=0;p<a;p++){const g=p===a-1?d?k[0]:null:k[p+1];if(n)if(g){var h=[g[0]-l[0],g[1]-l[1]];this.normalize(h);n=[l[0]-n[0],l[1]-
n[1]];this.normalize(n);var m=n[0]*h[1]-n[1]*h[0],r=n[0]*h[0]+n[1]*h[1];if(0<=m===0>=c)h=[h[0]-n[0],h[1]-n[1]],this.normalize(h),n=-Math.abs(c)/Math.sqrt((1+r)/2),f.push([l[0]-h[0]*n,l[1]-h[1]*n]);else switch(b){case "Mitered":if(r=Math.sqrt((1+r)/2),0<r&&1/r<e){h=[h[0]-n[0],h[1]-n[1]];this.normalize(h);n=Math.abs(c)/r;f.push([l[0]-h[0]*n,l[1]-h[1]*n]);break}case "Bevelled":f.push([l[0]+n[1]*c,l[1]-n[0]*c]);f.push([l[0]+h[1]*c,l[1]-h[0]*c]);break;case "Rounded":f.push([l[0]+n[1]*c,l[1]-n[0]*c]);r=
.2;for(m=1;5>m;m++,r+=.2){const q=[n[1]*(1-r)+h[1]*r,-n[0]*(1-r)-h[0]*r];this.normalize(q);f.push([l[0]+q[0]*c,l[1]+q[1]*c])}f.push([l[0]+h[1]*c,l[1]-h[0]*c]);break;default:0>m?(f.push([l[0]+(n[1]+n[0])*c,l[1]+(n[1]-n[0])*c]),f.push([l[0]+(h[1]-h[0])*c,l[1]-(h[0]+h[1])*c])):(r=Math.sqrt((1+Math.abs(r))/2),h=[h[0]-n[0],h[1]-n[1]],this.normalize(h),n=c/r,f.push([l[0]-h[0]*n,l[1]-h[1]*n]))}}else h=[l[0]-n[0],l[1]-n[1]],this.normalize(h),f.push([l[0]+h[1]*c,l[1]-h[0]*c]);else h=[g[0]-l[0],g[1]-l[1]],
this.normalize(h),f.push([l[0]+h[1]*c,l[1]-h[0]*c]);n=l;l=g}d&&f.push([f[0][0],f[0][1]]);return f};return B}();y.CurveHelper=E;y.PIXEL_TOLERANCE=.03;y.PathHelper=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(y,D,E){let B=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(c,b,e){return new A(c,
b,e)};return k}();B.instance=null;let A=function(){function k(c,b,e){this._inputGeometries=c;this._curveHelper=new E.CurveHelper;this._size=(void 0!==b.size?b.size:1)*e;this._offsetFlattenError=E.PIXEL_TOLERANCE*e}k.prototype.next=function(){let c=this._inputGeometries.next();for(;c;){if(D.isExtent(c))if(0<this._size){var b=this._curveHelper.offset([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(b)return{rings:[b]}}else if(0>
this._size){if(0<Math.min(c.xmax-c.xmin,c.ymax-c.ymin)+2*this._size)return{xmin:c.xmin-this._size,xmax:c.xmax+this._size,ymin:c.ymin-this._size,ymax:c.ymax+this._size}}else return c;if(D.isPolygon(c)){if(0===this._size)return c;b=[];for(const a of c.rings){var e=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);e&&b.push(e)}if(b.length)return{rings:b}}if(D.isPolyline(c)&&0<this._size){b=[];for(const a of c.paths)if(a&&1<a.length){e=this._curveHelper.offset(a,this._size,"Rounded",
4,this._offsetFlattenError);const d=this._curveHelper.offset(a,-this._size,"Rounded",4,this._offsetFlattenError);if(e&&d){for(let f=d.length-1;0<=f;f--)e.push(d[f]);e.push([e[0][0],e[0][1]]);b.push(e)}}if(b.length)return{rings:b}}D.isPoint(c);c=this._inputGeometries.next()}return null};return k}();y.EffectBuffer=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],
function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(c){function b(e,a,d){e=c.call(this,e,!0,!0)||this;e._curveHelper=new B.CurveHelper;e._beginCut=(void 0!==a.beginCut?a.beginCut:1)*d;e._endCut=(void 0!==a.endCut?a.endCut:1)*d;e._middleCut=(void 0!==a.middleCut?a.middleCut:0)*d;e._invert=void 0!==a.invert?a.invert:!1;0>e._beginCut&&
(e._beginCut=0);0>e._endCut&&(e._endCut=0);0>e._middleCut&&(e._middleCut=0);return e}D._inheritsLoose(b,c);b.prototype.processPath=function(e){var a=this._beginCut;const d=this._endCut,f=this._middleCut,n=this._curveHelper.calculatePathLength(e),l=[];if(!this._invert)0===a&&0===d&&0===f?l.push(e):a+d+f>=n||(0===f?(e=this._curveHelper.getSubCurve(e,a,n-d))&&l.push(e):((a=this._curveHelper.getSubCurve(e,a,.5*(n-f)))&&l.push(a),(a=this._curveHelper.getSubCurve(e,.5*(n+f),n-d))&&l.push(a)));else if(0!==
a||0!==d||0!==f)a+d+f>=n?l.push(e):((a=this._curveHelper.getSubCurve(e,0,a))&&l.push(a),(a=this._curveHelper.getSubCurve(e,.5*(n-f),.5*(n+f)))&&l.push(a),(a=this._curveHelper.getSubCurve(e,n-d,d))&&l.push(a));return 0===l.length?null:{paths:l}};return b}(E.PathGeometryCursor);y.EffectCut=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],
function(y,D,E,B,A){let k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(e,a,d){return new c(e,a,d)};return b}();k.instance=null;let c=function(b){function e(a,d,f){a=b.call(this,a,!0,!0)||this;a._walker=new A.GeometryWalker;a._walker.updateTolerance(f);a._endings=d.lineDashEnding;a._customDashPos=void 0!==d.offsetAlongLine?d.offsetAlongLine*f:0;a._offsetAtEnd=void 0!==d.customEndingOffset?d.customEndingOffset*f:0;
a._pattern=new A.DashPattern;a._pattern.init(d.dashTemplate,!0);a._pattern.scale(f);return a}D._inheritsLoose(e,b);e.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[a]};if(!this.iteratePath){var d=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||
(d=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var f=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||f<.1*this._pattern.length()||!this._walker.init(a,this._pattern,d))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{switch(this._endings){default:d=.5*this._pattern.firstValue();break;case "HalfGap":d=.5*-this._pattern.lastValue();break;case "FullGap":d=-this._pattern.lastValue();break;case "FullPattern":d=0;break;case "NoConstraint":case "Custom":d=
-this._customDashPos}a=d/this._pattern.length();a-=Math.floor(a);d=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(f=!1;d>=a;)d-=a,a=this._pattern.nextValue(),f=!f;a-=d;f?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(d=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),B.PathHelper.mergePath(d,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(d=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,d=this._firstCurve,this._firstCurve=null);return{paths:[d]}};return e}(E.PathGeometryCursor);y.EffectDashes=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(y,D,E,B){let A=function(){function b(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var e=b.prototype;e.isEmpty=function(){return 0===this._values.length};e.size=function(){return this._values.length};e.init=function(a,d,f=!0){this._setEmpty();if(!a||0===a.length)return!1;for(let n=0;n<a.length;n++){let l=Math.abs(a[n]);f&&1E-7>l&&(l=1E-7);this._values.push(l);this._length+=l}d&&a.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};e.scale=function(a){const d=this._values?this._values.length:0;for(let f=0;f<d;++f)this._values[f]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};e.addValue=function(a){this._length+=a;this._values.push(a)};e.firstValue=function(){return this._values[0]};e.lastValue=function(){return this._values[this._values.length-1]};e.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};e.reset=function(){this._currentValue=-1};e.length=function(){return this._length};e._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return b}(),k=function(){function b(){this.reset()}var e=b.prototype;e.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};e.isValid=function(){return-1!==this.segment};e.copyTo=
function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return b}(),c=function(b){function e(d=0,f=!1){d=b.call(this,d,f)||this;d._tolerance=B.PIXEL_TOLERANCE;d._currentPosition=new k;return d}D._inheritsLoose(e,b);var a=e.prototype;a.updateTolerance=function(d){this._tolerance=B.PIXEL_TOLERANCE*d};a.init=function(d,f,n=!0){n?(this._patternLength=f.length(),this._partExtPtGap=f.extPtGap,this._partCtrlPtGap=
f.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=d;this._seg=-1;return this.setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};a.nextPosition=function(d,f=0){const n=new k;if(!this._nextPosition(d,n,null,f))return!1;n.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(d){d.pt=this._getPoint(this._currentPosition);const [f,n]=this._getAngle(this._currentPosition);
d.ca=f;d.sa=n};a.nextPointAndAngle=function(d,f,n=0){const l=new k;if(!this._nextPosition(d,l,null,n))return!1;l.copyTo(this._currentPosition);f.pt=this._getPoint(l);const [h,m]=this._getAngle(l);f.ca=h;f.sa=m;return!0};a.nextCurve=function(d){if(0===d)return null;const f=[],n=new k;if(!this._nextPosition(d,n,f,1))return null;n.copyTo(this._currentPosition);return f};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");
return this._path[this._currentPosition.segment+1]};a._nextPosition=function(d,f,n,l){if(this._currentPosition.isPathEnd)return!1;var h=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(h/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(f);f.abscissa+d*this._partLengthRatio>f.segmentLength+this._tolerance;)if(n&&(0===n.length&&(0===h?(h=this._path[f.segment],n.push([h[0],h[1]])):n.push(this.getSegCoord2D(this._path,f.segment,h))),h=this._path[f.segment+1],
n.push([h[0],h[1]])),h=0,d-=(f.segmentLength-f.abscissa)/this._partLengthRatio,this._partSegCount)f.segment=this.nextSegment(),f.segmentLength=this.calculateSegLength(this._path,f.segment),f.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===l)return!1;f.segmentLength=this.calculateSegLength(this._path,f.segment);f.isPartEnd=!0;1===l?(f.abscissa=f.segmentLength,f.isPathEnd=!0):f.abscissa=f.segmentLength+d;return!0}this._currentPosition.copyTo(f)}f.abscissa+=d*this._partLengthRatio;
n&&(0===n.length&&(0===h?(d=this._path[f.segment],n.push([d[0],d[1]])):n.push(this.getSegCoord2D(this._path,f.segment,h))),d=f.abscissa/f.segmentLength,1===d?(d=this._path[f.segment+1],n.push([d[0],d[1]])):n.push(this.getSegCoord2D(this._path,f.segment,d)));!this._partSegCount&&Math.abs(f.abscissa-f.segmentLength)<this._tolerance&&(f.isPathEnd=this._partIsLast,f.isPartEnd=!0);return!0};a._getPoint=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,d.segment,
0>=d.segmentLength?0:d.abscissa/d.segmentLength)};a._getAngle=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,d.segment,0>=d.segmentLength?0:d.abscissa/d.segmentLength)};a.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,
this.nextSegment()),this._partSegCount++,1===E.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var d=this._partSegCount;d;)this.previousSegment(),--d;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;d=this.getStartPointIndex();this._ctrlPtBegin=
1===E.getId(this._path[d]);d=d+this._partSegCount+1;d>=this._path.length&&(d=0);this._ctrlPtEnd=1===E.getId(this._path[d]);if(0<this._patternLength){d=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const f=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let n=Math.round((this._partLength-(d+f))/this._patternLength);0>=n&&(n=0<d+f?0:1);this._partLengthRatio=this._partLength/(d+f+n*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=
1;return!0};a.hasNextSegment=function(){return this._seg<this._path.length-2};a.previousSegment=function(){return--this._seg};a.nextSegment=function(){return++this._seg};a.getStartPointIndex=function(){return this._seg};a.getEndPointIndex=function(){return this._seg+1};return e}(B.CurveHelper);y.DashPattern=A;y.GeometryWalker=c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],
function(y,D,E){let B=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(c,b,e){return new A(c,b,e)};return k}();B.instance=null;let A=function(){function k(c,b,e){this._inputGeometries=c;this._curveHelper=new E.CurveHelper;this._width=(void 0!==b.width?b.width:2)*e;switch(b.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";
break;case "Square":this._method="Square"}this._option=b.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*e}k.prototype.next=function(){for(var c=this._inputGeometries.next();c;){if(D.isExtent(c)&&0<this._width){if(0>Math.min(c.xmax-c.xmin,c.ymax-c.ymin)-2*this._width)return c;var b=[];b.push([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]);b.push([[c.xmin+this._width,c.ymin+this._width],[c.xmax-this._width,c.ymin+this._width],[c.xmax-this._width,c.ymax-this._width],
[c.xmin+this._width,c.ymax-this._width],[c.xmin+this._width,c.ymin+this._width]]);return{rings:b}}if(D.isPolygon(c)&&0<this._width){b=[];for(const e of c.rings){c=this._curveHelper.calculatePathLength(e);const a=this._curveHelper.offset(e,this._width,this._method,4,this._offsetFlattenError);a&&(0>c&&a.reverse(),b.push(a))}if(b.length)return{rings:b}}c=this._inputGeometries.next()}return null};return k}();y.EffectDonut=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(c){function b(e,a,d){e=c.call(this,e,!1,!0)||this;e._curveHelper=new B.CurveHelper;e._length=(void 0!==a.length?a.length:20)*d;e._angle=void 0!==a.angle?a.angle:225;e._position=void 0!==a.position?a.position:
50;0>e._length&&(e._length=-e._length);20>e._position&&(e._position=20);80<e._position&&(e._position=80);e._mirror=!1;return e}D._inheritsLoose(b,c);b.prototype.processPath=function(e){if(this._curveHelper.isEmpty(e,!1))return null;const a=e[0];e=e[e.length-1];this._curveHelper.normalize([e[0]-a[0],e[1]-a[1]]);const d=[a[0]+(e[0]-a[0])*this._position/100,a[1]+(e[1]-a[1])*this._position/100],f=Math.cos((90-this._angle)/180*Math.PI);let n=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(n=-n);
this._mirror=!this._mirror;return{paths:[[a,[d[0]-this._length/2*f,d[1]-this._length/2*n],[d[0]+this._length/2*f,d[1]+this._length/2*n],e]]}};return b}(E.PathGeometryCursor);y.EffectJog=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(y,D,E){let B=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=
function(c,b,e){return new A(c,b,e)};return k}();B.instance=null;let A=function(){function k(b,e,a){this._inputGeometries=b;this._offsetX=void 0!==e.offsetX?e.offsetX*a:0;this._offsetY=void 0!==e.offsetY?-e.offsetY*a:0}var c=k.prototype;c.next=function(){for(var b=this._inputGeometries.next();b;){if(E.isExtent(b))return{xmin:b.xmin+this._offsetX,xmax:b.xmax+this._offsetX,ymin:b.ymin+this._offsetY,ymax:b.ymax+this._offsetY};if(E.isPolygon(b))return b=D.clone(b),this._moveMultipath(b.rings,this._offsetX,
this._offsetY),b;if(E.isPolyline(b))return b=D.clone(b),this._moveMultipath(b.paths,this._offsetX,this._offsetY),b;if(E.isMultipoint(b))return b=D.clone(b),this._movePath(b.points,this._offsetX,this._offsetY),b;if(E.isPoint(b))return{x:b.x+this._offsetX,y:b.y+this._offsetY};b=this._inputGeometries.next()}return null};c._moveMultipath=function(b,e,a){if(b)for(const d of b)this._movePath(d,e,a)};c._movePath=function(b,e,a){if(b)for(const d of b)d[0]+=e,d[1]+=a};return k}();y.EffectMove=B;Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(y,D,E){let B=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(c,b,e){return new A(c,b,e)};return k}();B.instance=null;let A=function(){function k(c,b,e){this._inputGeometries=c;this._curveHelper=new E.CurveHelper;this._offset=(void 0!==b.offset?b.offset:1)*e;
this._method=b.method;this._option=b.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*e}k.prototype.next=function(){for(var c=this._inputGeometries.next();c;){if(0===this._offset)return c;if(D.isExtent(c)){if("Rounded"===this._method&&0<this._offset){var b=this._curveHelper.offset([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]],this._offset,this._method,4,this._offsetFlattenError);return b?{rings:[b]}:null}if(0<Math.min(c.xmax-c.xmin,c.ymax-c.ymin)+2*this._offset)return{xmin:c.xmin-
this._offset,xmax:c.xmax+this._offset,ymin:c.ymin-this._offset,ymax:c.ymax+this._offset}}if(D.isPolygon(c)){var e=[];for(b of c.rings){const a=this._curveHelper.offset(b,this._offset,this._method,4,this._offsetFlattenError);a&&e.push(a)}if(e.length)return{rings:e}}if(D.isPolyline(c)){e=[];for(const a of c.paths)(c=this._curveHelper.offset(a,this._offset,this._method,4,this._offsetFlattenError))&&e.push(c);if(e.length)return{paths:e}}c=this._inputGeometries.next()}return null};return k}();y.EffectOffset=
B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(){function c(b,e,a){this._inputGeometries=b;this._reverse=void 0!==e.reverse?
e.reverse:!0}c.prototype.next=function(){for(var b=this._inputGeometries.next();b;){if(!this._reverse)return b;if(E.isPolyline(b))return b=D.clone(b),B.reverseMultipath(b.paths),b;b=this._inputGeometries.next()}return null};return c}();y.EffectReverse=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils","../../../geometry/support/aaBoundingRect"],
function(y,D,E,B,A){let k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(e,a,d){return new c(e,a,d)};return b}();k.instance=null;let c=function(){function b(a,d,f){this._inputGeometries=a;this._rotateAngle=void 0!==d.angle?-d.angle*Math.PI/180:0}var e=b.prototype;e.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var d=A.create();E.getBoundsXY(d,a);const f=(d[2]+d[0])/2;d=
(d[3]+d[1])/2;if(B.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,f,d),a;if(B.isPolygon(a))return a=D.clone(a),this._rotateMultipath(a.rings,f,d),a;if(B.isPolyline(a))return a=D.clone(a),this._rotateMultipath(a.paths,f,d),a;if(B.isMultipoint(a))return a=D.clone(a),this._rotatePath(a.points,f,d),a;if(B.isPoint(a))return a;a=this._inputGeometries.next()}return null};e._rotateMultipath=function(a,d,f){if(a)for(const n of a)this._rotatePath(n,
d,f)};e._rotatePath=function(a,d,f){if(a){const n=Math.cos(this._rotateAngle),l=Math.sin(this._rotateAngle);for(const h of a){a=h[0]-d;const m=h[1]-f;h[0]=d+a*n-m*l;h[1]=f+a*l+m*n}}};return b}();y.EffectRotate=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils","../../../geometry/support/aaBoundingRect"],function(y,D,E,B,A){let k=
function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(e,a,d){return new c(e,a,d)};return b}();k.instance=null;let c=function(){function b(a,d,f){this._inputGeometries=a;this._xFactor=void 0!==d.xScaleFactor?d.xScaleFactor:1.15;this._yFactor=void 0!==d.yScaleFactor?d.yScaleFactor:1.15}var e=b.prototype;e.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var d=A.create();
E.getBoundsXY(d,a);const f=(d[2]+d[0])/2;d=(d[3]+d[1])/2;if(B.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,f,d),a;if(B.isPolygon(a))return a=D.clone(a),this._scaleMultipath(a.rings,f,d),a;if(B.isPolyline(a))return a=D.clone(a),this._scaleMultipath(a.paths,f,d),a;if(B.isMultipoint(a))return a=D.clone(a),this._scalePath(a.points,f,d),a;if(B.isPoint(a))return a;a=this._inputGeometries.next()}return null};
e._scaleMultipath=function(a,d,f){if(a)for(const n of a)this._scalePath(n,d,f)};e._scalePath=function(a,d,f){if(a)for(const n of a)a=(n[1]-f)*this._yFactor,n[0]=d+(n[0]-d)*this._xFactor,n[1]=f+a};return b}();y.EffectScale=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&
(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(){function c(e,a,d){this._inputGeometries=e;this._height=(void 0!==a.amplitude?a.amplitude:2)*d;this._period=(void 0!==a.period?a.period:3)*d;this._style=a.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new B.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new B.GeometryWalker;this._walker.updateTolerance(d)}var b=c.prototype;b.next=function(){for(var e=this._inputGeometries.next();e;){if(0===this._height||0===this._period)return e;if(D.isPolyline(e)){const a=this._processGeom(e.paths);if(a.length)return{paths:a}}if(D.isPolygon(e)&&(e=this._processGeom(e.rings),e.length))return{rings:e};e=this._inputGeometries.next()}return null};b._processGeom=function(e){const a=[];for(const d of e)if(this._walker.init(d,this._pattern))switch(this._style){default:a.push(this._constructCurve(d,
!1));break;case "Square":a.push(this._constructSquare(d));break;case "Triangle":a.push(this._constructTriangle(d));break;case "Random":a.push(this._constructCurve(d,!0))}else a.push(d);return a};b._constructCurve=function(e,a){const d=new E.PathHelper;var f=this._walker.calculatePathLength(e),n=Math.round(f/this._period);0===n&&(n=1);const l=this._period/16,h=1/(16*n+1);f=2*Math.PI*f/(f/n);n=2*Math.PI*Math.random();const m=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),p=.75-Math.random()/2,g=
.75-Math.random()/2,q={};this._walker.curPointAndAngle(q);d.startPath(q.pt);let u=0;for(;;)if(this._walker.nextPointAndAngle(l,q)){const v=u;u+=h;let z;if(a){const t=this._height/2*(1+.3*Math.sin(p*f*v+n));z=t*Math.sin(f*v+m);z+=t*Math.sin(g*f*v+r);z/=2}else z=.5*this._height*Math.sin(.5*f*v);d.lineTo([q.pt[0]-z*q.sa,q.pt[1]+z*q.ca])}else{d.lineTo(e[e.length-1]);break}return d.path()};b._constructSquare=function(e){const a=new E.PathHelper;e=this._walker.calculatePathLength(e);e=Math.round(e/this._period);
0===e&&(e=1);for(e=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const n={};if(this._walker.nextPointAndAngle(this._period,n)){const l={};this._walker.nextPointAndAngle(this._period,l)&&(e?(a.startPath(f.pt),e=!1):a.lineTo(f.pt),a.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),a.lineTo([n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca]),a.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca]),a.lineTo([l.pt[0]+
this._height/2*l.sa,l.pt[1]-this._height/2*l.ca]),d=!0)}}if(!d){a.lineTo(this._walker.getPathEnd());break}}return a.path()};b._constructTriangle=function(e){const a=new E.PathHelper;e=this._walker.calculatePathLength(e);e=Math.round(e/this._period);0===e&&(e=1);for(e=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const n={};if(this._walker.nextPointAndAngle(this._period/2,n)){const l={};this._walker.nextPointAndAngle(this._period,l)&&(this._walker.nextPosition(this._period/
2)&&(e?(a.startPath(f.pt),e=!1):a.lineTo(f.pt),a.lineTo([n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca]),a.lineTo([l.pt[0]+this._height/2*l.sa,l.pt[1]-this._height/2*l.ca])),d=!0)}}if(!d){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return c}();y.EffectWave=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker",
"../enums"],function(y,D,E,B,A){let k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(e,a,d){return new c(e,a,d)};return b}();k.instance=null;let c=function(b){function e(d,f,n){d=b.call(this,d,!0,!0)||this;d._grometryWalker=new B.GeometryWalker;d._grometryWalker.updateTolerance(n);d._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;d._offset=void 0!==f.offset?f.offset*n:0;d._originalEndings=f.endings;d._offsetAtEnd=
void 0!==f.customEndingOffset?f.customEndingOffset*n:0;d._position=void 0!==f.offsetAlongLine?f.offsetAlongLine*n:0;d._pattern=new B.DashPattern;d._pattern.init(f.placementTemplate,!1);d._pattern.scale(n);d._endings=d._originalEndings;return d}D._inheritsLoose(e,b);var a=e.prototype;a.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath)var f=this._pattern.nextValue();else{this._endings=this._originalEndings===A.PlacementEndings.WithFullGap&&this.isClosed?A.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let n=!0;switch(this._endings){case A.PlacementEndings.NoConstraint:f=-this._position;f=this._adjustPosition(f);n=!1;break;default:f=-this._pattern.lastValue()/2;break;case A.PlacementEndings.WithFullGap:f=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case A.PlacementEndings.WithMarkers:f=0;break;case A.PlacementEndings.Custom:f=-this._position,f=this._adjustPosition(f),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(d,
this._pattern,n))return null;this._pattern.reset();for(d=0;f>d;)f-=d,d=this._pattern.nextValue();f=d-=f;this.iteratePath=!0}d={};if(!this._grometryWalker.nextPointAndAngle(f,d)||this._endings===A.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===A.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(d.pt[0]+this._offset*d.sa,d.pt[1]-this._offset*
d.ca);this._angleToLine&&this.internalPlacement.setRotateCS(d.ca,d.sa);return this.internalPlacement};a._adjustPosition=function(d){d/=this._pattern.length();d-=Math.floor(d);return d*this._pattern.length()};return e}(E.PathTransformationCursor);y.PlacementAlongLineSameSize=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(y){var D=y.PlacementEndings||(y.PlacementEndings={});D.NoConstraint="NoConstraint";D.WithMarkers="WithMarkers";
D.WithFullGap="WithFullGap";D.WithHalfGap="WithHalfGap";D.Custom="Custom";Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=
function(c){function b(a,d,f){a=c.call(this,a,!1,!0)||this;a._curveHelper=new B.CurveHelper;a._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;a._offset=void 0!==d.offset?d.offset*f:0;a._type=d.extremityPlacement;a._position=void 0!==d.offsetAlongLine?d.offsetAlongLine*f:0;a._beginProcessed=!1;return a}D._inheritsLoose(b,c);var e=b.prototype;e.processPath=function(a){let d;switch(this._type){default:this._beginProcessed?(d=this._atExtremities(a,this._position,!1),this.iteratePath=this._beginProcessed=
!1):(d=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":d=this._atExtremities(a,this._position,!0);break;case "JustEnd":d=this._atExtremities(a,this._position,!1);case "None":}return d};e._atExtremities=function(a,d,f){var n=a.length;if(2>n)return null;var l=f?1:n-2;const h=f?n:-1,m=f?1:-1;let r=0;f=f?a[0]:a[n-1];for(n=l;n!==h;n+=m){l=f;f=a[n];const p=this._curveHelper.calculateLength(l,f);if(r+p>d){a=(d-r)/p;const [g,q]=this._curveHelper.getAngleCS(l,
f,a);a=E.getCoord2D(l,f,a);this.internalPlacement.setTranslate(a[0]-this._offset*q,a[1]+this._offset*g);this._angleToLine&&this.internalPlacement.setRotateCS(-g,-q);return this.internalPlacement}r+=p}return null};return b}(E.PathTransformationCursor);y.PlacementAtExtremities=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(y,
D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(c){function b(e,a,d){e=c.call(this,e,!0,!0)||this;e._walker=new B.GeometryWalker;e._walker.updateTolerance(d);e._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;e._offset=void 0!==a.offset?a.offset*d:0;e._beginGap=void 0!==a.beginPosition?a.beginPosition*d:0;e._endGap=void 0!==a.endPosition?
a.endPosition*d:0;e._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;e._pattern=new B.DashPattern;e._pattern.init(a.positionArray,!1,!1);e._subPathLen=0;e._posCount=e._pattern.size();e._isFirst=!0;e._prevPos=0;return e}D._inheritsLoose(b,c);b.prototype.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath){e=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+e;e=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=
0;this._subPathLen=this._walker.calculatePathLength(e)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();e=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+e;e=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(e,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*a.ca);e=
this._isFirst&&this._flipFirst;let d;this._angleToLine?(d=a.ca,a=a.sa):(d=1,a=0);e&&(d=-d,a=-a);this.internalPlacement.setRotateCS(d,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return b}(E.PathTransformationCursor);y.PlacementAtRatioPositions=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(y,D){let E=function(){function A(){}
A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=function(k,c,b){return new B(k,c,b)};return A}();E.instance=null;let B=function(){function A(c,b,e){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==b.stepX?Math.abs(b.stepX):16)*e;this._stepY=(void 0!==b.stepY?Math.abs(b.stepY):16)*e;if(0!==this._stepX&&0!==this._stepY&&c&&void 0!==c.rings&&c.rings){this._gridType=void 0!==b.gridType?b.gridType:"Fixed";
if("Random"===this._gridType)this._randomness=void 0!==b.randomness?b.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==b.gridAngle?b.gridAngle:0;this._shiftOddRows=void 0!==b.shiftOddRows?b.shiftOddRows:!1;this._offsetX=void 0!==b.offsetX?b.offsetX*e:0;this._offsetY=void 0!==b.offsetY?b.offsetY*e:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/
180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new D.Placement;this._calculateMinMax(c);this._geometry=c}}var k=A.prototype;k.next=function(){return this._geometry?
this._nextInside():null};k._calculateMinMax=function(c){this._yMax=this._yMin=this._xMax=this._xMin=0;let b,e,a,d,f;e=a=Number.MAX_VALUE;d=f=-Number.MAX_VALUE;for(const l of c.rings){const h=l?l.length:0;for(let m=0;m<h;++m){var n=l[m][0]-this._graphicOriginX-this._offsetX;b=l[m][1]-this._graphicOriginY-this._offsetY;c=this._cosAngle*n-this._sinAngle*b;n=this._sinAngle*n+this._cosAngle*b;e=Math.min(e,c);d=Math.max(d,c);a=Math.min(a,n);f=Math.max(f,n)}}e+=this._graphicOriginX;d+=this._graphicOriginX;
a+=this._graphicOriginY;f+=this._graphicOriginY;this._xMin=Math.round(e/this._stepX);this._xMax=Math.round(d/this._stepX);this._yMin=Math.round(a/this._stepY);this._yMax=Math.round(f/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};k._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var c=this._currentX*this._stepX+this._offsetX;
this._shiftOddRows&&this._currentY%2&&(c+=.5*this._stepX);const b=this._currentY*this._stepY+this._offsetY;this._currentX++;let e;"Random"===this._gridType?(e=this._graphicOriginX+c+this._stepX*this._randomness*(.5-Math.random())*2/3,c=this._graphicOriginY+b+this._stepY*this._randomness*(.5-Math.random())*2/3):(e=this._graphicOriginX+this._cosAngle*c+this._sinAngle*b,c=this._graphicOriginY-this._sinAngle*c+this._cosAngle*b);this._internalPlacement.setTranslate(e,c);return this._internalPlacement}};
return A}();y.PlacementInsidePolygon=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(c){function b(a,d,f){a=c.call(this,
a,!0,!0)||this;a._curveHelper=new B.CurveHelper;a._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;a._offset=void 0!==d.offset?d.offset*f:0;a._relativeTo=d.relativeTo;a._position=void 0!==d.startPointOffset?d.startPointOffset*f:0;a._epsilon=.001*f;return a}D._inheritsLoose(b,c);var e=b.prototype;e.processPath=function(a){var d=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var f=
this._curSegment;this._curSegment++;d=a[f-1];f=a[f];const n=this._curveHelper.calculateLength(d,f);if(n<this._epsilon)continue;a=.5+this._position/n;const [l,h]=this._curveHelper.getAngleCS(d,f,a);a=E.getCoord2D(d,f,a);this.internalPlacement.setTranslate(a[0]-this._offset*h,a[1]+this._offset*l);this._angleToLine&&this.internalPlacement.setRotateCS(l,h);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&E.reversePath(a);d=this.onLine(a,d);"LineEnd"===this._relativeTo&&
E.reversePath(a);return d};e.onLine=function(a,d){let f,n=!1;switch(this._relativeTo){default:f=this._curveHelper.calculatePathLength(a)/2+d;break;case "LineBeginning":f=d;break;case "LineEnd":f=d,n=!0}const l=a.length;let h=0,m=a[0];for(let r=1;r<l;++r){d=m;m=a[r];const p=this._curveHelper.calculateLength(d,m);if(h+p>f){a=(f-h)/p;const [g,q]=this._curveHelper.getAngleCS(d,m,a);a=E.getCoord2D(d,m,a);d=n?this._offset:-this._offset;this.internalPlacement.setTranslate(a[0]-d*q,a[1]+d*g);this._angleToLine&&
(n?this.internalPlacement.setRotateCS(-g,-q):this.internalPlacement.setRotateCS(g,q));return this.internalPlacement}h+=p}return null};return b}(E.PathTransformationCursor);y.PlacementOnLine=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(y,D,E,B){function A(b,e){const a=Math.PI;for(;Math.abs(e-b)>a+2E-15;)e=e-b>a?e-2*a:e+2*a;return(b+
e)/2}let k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(e,a,d){return new c(e,a,d)};return b}();k.instance=null;let c=function(b){function e(d,f,n){d=b.call(this,d,!0,!0)||this;d._curveHelper=new B.CurveHelper;d._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;d._offset=void 0!==f.offset?f.offset*n:0;d._endPoints=void 0!==f.placeOnEndPoints?f.placeOnEndPoints:!0;d._controlPoints=void 0!==f.placeOnControlPoints?
f.placeOnControlPoints:!0;d._regularVertices=void 0!==f.placeOnRegularVertices?f.placeOnRegularVertices:!0;d._tags=[];d._tagIterator=0;return d}D._inheritsLoose(e,b);var a=e.prototype;a.processPath=function(d){this.iteratePath||(this._preparePath(d),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;d=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(d[2]);let f=d[0],n=d[1];if(0!==this._offset){const l=
Math.cos(d[2]);f-=this._offset*Math.sin(d[2]);n+=this._offset*l}this.internalPlacement.setTranslate(f,n);this._tagIterator++;return this.internalPlacement};a._preparePath=function(d){this._tagIterator=this._tags.length=0;const f=E.isClosedPath(d),n=d.length-1;let l=0,h=0,m=0,r=0,p=0,g,q;for(;l<n;){l++;g=d[l-1];q=d[l];const u=E.getId(g),v=E.getId(q);if(this._angleToLine||0!==this._offset)r=this._curveHelper.getAngle(g,q,0);1===l?f?(h=r,m=u):this._endPoints&&this._tags.push([g[0],g[1],r]):1===u?this._controlPoints&&
this._tags.push([g[0],g[1],A(p,r)]):this._regularVertices&&this._tags.push([g[0],g[1],A(p,r)]);if(this._angleToLine||0!==this._offset)p=this._curveHelper.getAngle(g,q,1);l===n&&(f?1===v||1===m?this._controlPoints&&this._tags.push([q[0],q[1],A(p,h)]):this._regularVertices&&this._tags.push([q[0],q[1],A(p,h)]):this._endPoints&&this._tags.push([q[0],q[1],p]))}this._tagIterator=0};return e}(E.PathTransformationCursor);y.PlacementOnVertices=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports",
"../../../geometry/support/boundsUtils","../../../geometry/support/aaBoundingRect","../CIMPlacements"],function(y,D,E,B){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,e,a){return new k(b,e,a)};return c}();A.instance=null;let k=function(){function c(e,a,d){this._geometry=e;this._offsetX=void 0!==a.offsetX?a.offsetX*d:0;this._offsetY=void 0!==a.offsetY?a.offsetY*d:0;this._method=void 0!==a.method?a.method:"OnPolygon";
this._internalPlacement=new B.Placement}var b=c.prototype;b.next=function(){const e=this._geometry;this._geometry=null;return e&&void 0!==e.rings?this._polygonCenter(e):null};b._polygonCenter=function(e){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const a=E.create();D.getBoundsXY(a,e);this._internalPlacement.setTranslate((a[2]+a[0])/2+this._offsetX,(a[3]+a[1])/2-this._offsetY)}}return this._internalPlacement};return c}();y.PlacementPolygonCenter=A;Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/symbols/cim/packingUtils":function(){define(["exports"],function(y){function D(c,b=0){let e=0;for(let a=0;4>a;a++)e+=c[b+a]*A[a];return e}function E(c){return c-Math.floor(c)}const B=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],k=D(new Uint8ClampedArray([255,255,255,255]));y.packFloatRGBA=function(c,b,e=0){c=0>c?0:c>k?k:c;for(let a=0;4>a;a++)b[e+a]=Math.floor(256*E(c*B[a]))};y.unpackFloatRGBA=D;Object.defineProperty(y,"__esModule",{value:!0})})},
"esri/symbols/cim/SDFHelper":function(){define(["exports","../../geometry/support/jsonUtils","./Rect","./packingUtils"],function(y,D,E,B){function A(c){if(!c)return null;switch(c.type){case "CIMPointSymbol":c=c.symbolLayers;if(!c||1!==c.length)break;return A(c[0]);case "CIMVectorMarker":c=c.markerGraphics;if(!c||1!==c.length)break;var b=c[0];if(!b)break;c=b.geometry;if(!c)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==b.type&&"CIMLineSymbol"!==b.type)break;return{geom:c,asFill:"CIMPolygonSymbol"===
b.type};case "sdf":return{geom:c.geom,asFill:c.asFill}}return null}function k(c){let b=Infinity,e=-Infinity,a=Infinity,d=-Infinity;for(const f of c)for(const n of f)n[0]<b&&(b=n[0]),n[0]>e&&(e=n[0]),n[1]<a&&(a=n[1]),n[1]>d&&(d=n[1]);return[b,a,e,d]}y.buildSDF=function(c){var b=c.geom;var e=b?b.rings?b.rings:b.paths?b.paths:void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]:null:null;b=Infinity;var a=
-Infinity;var d=Infinity,f=-Infinity;for(var n of e)for(var l of n)l[0]<b&&(b=l[0]),l[0]>a&&(a=l[0]),l[1]<d&&(d=l[1]),l[1]>f&&(f=l[1]);a=new E(b,d,a-b,f-d);d=64/Math.max(a.width,a.height);n=Math.round(a.width*d)+62;l=Math.round(a.height*d)+62;b=[];for(var h of e)if(h&&1<h.length){e=[];for(var m of h){let [x,C]=m;x-=a.x;C-=a.y;x*=d;C*=d;x+=30.5;C+=30.5;e.push([x,C])}c.asFill&&(f=e.length-1,e[0][0]===e[f][0]&&e[0][1]===e[f][1]||e.push(e[0]));b.push(e)}var r;h=n*l;m=Array(h);for(e=0;e<h;++e)m[e]=962;
for(r of b)for(e=r.length,a=1;a<e;++a){d=r[a-1];f=r[a];var p=void 0,g=void 0;d[0]<f[0]?(p=d[0],g=f[0]):(p=f[0],g=d[0]);var q=void 0,u=void 0;d[1]<f[1]?(q=d[1],u=f[1]):(q=f[1],u=d[1]);var v=Math.floor(p)-31;g=Math.floor(g)+31;q=Math.floor(q)-31;u=Math.floor(u)+31;0>v&&(v=0);g>n&&(g=n);0>q&&(q=0);u>l&&(u=l);p=f[0]-d[0];const x=f[1]-d[1],C=p*p+x*x;for(;v<g;v++)for(let F=q;F<u;F++){var z=(v-d[0])*p+(F-d[1])*x,t=void 0;0>z?(t=d[0],z=d[1]):z>C?(t=f[0],z=f[1]):(z/=C,t=d[0]+z*p,z=d[1]+z*x);t=(v-t)*(v-t)+
(F-z)*(F-z);z=(l-F-1)*n+v;t<m[z]&&(m[z]=t)}}for(r=0;r<h;++r)m[r]=Math.sqrt(m[r]);r=m;if(c.asFill)for(var w of b)for(c=w.length,b=1;b<c;++b)for(h=w[b-1],m=w[b],h[0]<m[0]?(e=h[0],a=m[0]):(e=m[0],a=h[0]),h[1]<m[1]?(f=h[1],d=m[1]):(f=m[1],d=h[1]),e=Math.floor(e),a=Math.floor(a)+1,f=Math.floor(f),d=Math.floor(d)+1,31>e&&(e=31),a>n-31&&(a=n-31),31>f&&(f=31),d>l-31&&(d=l-31);f<d;++f)if(h[1]>f!==m[1]>f){g=(l-f-1)*n;for(q=e;q<a;++q)q<(m[0]-h[0])*(f-h[1])/(m[1]-h[1])+h[0]&&(r[g+q]=-r[g+q]);for(q=31;q<e;++q)r[g+
q]=-r[g+q]}w=r.length;c=new Uint8Array(4*w);for(b=0;b<w;++b)B.packFloatRGBA(.5-r[b]/62,c,4*b);w=c;return[w,n,l]};y.getExtent=function(c){return c?c.rings?k(c.rings):c.paths?k(c.paths):D.isExtent(c)?[c.xmin,c.ymin,c.xmax,c.ymax]:null:null};y.getSDFInfo=A;y.getSDFMetrics=function(c,b,e,a,d){const [f,n,l,h]=c;if(l<f||h<n)return[0,0,0];var m=l-f,r=h-n;c=64/Math.max(m,r);m=Math.round(m*c);r=Math.round(r*c)+62;let p=1;b&&(p=r/c/(b.ymax-b.ymin));let g=0,q=0;a&&(d?b&&e&&0<b.ymax-b.ymin&&(g=a.x/((b.xmax-b.xmin)/
(b.ymax-b.ymin)*e),q=a.y/e):(g=a.x,q=a.y));g=.5*(b.xmax+b.xmin)+g*(b.xmax-b.xmin);q=.5*(b.ymax+b.ymin)+q*(b.ymax-b.ymin);g=(g-f)*c+31;q=(q-n)*c+31;return[p,g/(m+62)-.5,-(q/r-.5)]};y.getSDFSymbol=function(c){c=c.markerGraphics;if(!c||1!==c.length)return null;c=c[0];if(!c)return null;c=c.symbol;return!c||"CIMPolygonSymbol"!==c.type&&"CIMLineSymbol"!==c.type?null:c};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(y){function D(E){E=
E.toLowerCase().split(" ").join("-");switch(E){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return E}}y.getFontDecorationTop=function(E){switch(E){case "underline":return-26;case "line-through":return-18}return NaN};y.getFullyQualifiedFontName=function(E){a:{if(E.weight)switch(E.weight.toLowerCase()){case "bold":case "bolder":var B="-bold";break a}B=""}a:{if(E.style)switch(E.style.toLowerCase()){case "italic":case "oblic":var A=
"-italic";break a}A=""}B+=A;return D(E.family)+(0<B.length?B:"-regular")};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define(["../../../../core/has","../../../../core/promiseUtils","../../../webgl/Texture","./Rect","./RectangleBinPack"],function(y,D,E,B,A){function k(b){const e=new Set;for(const a of b)e.add(Math.floor(a/256));return e}function c(b,e,a){b.has(e)||b.set(e,a().then(()=>{b.delete(e)}).catch(d=>{b.delete(e);D.throwIfNotAbortError(d)}));
return b.get(e)}return function(){function b(a,d,f){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=d;this._glyphSource=f;this._binPack=new A(a-4,d-4);this._glyphData.push(new Uint8Array(a*d));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var e=b.prototype;e.dispose=function(){this._binPack=null;for(const a of this._textures)a&&a.dispose();this._textures.length=
0;this._glyphData.length=0};e._initDecorationGlyph=function(){var a=[117,149,181,207,207,181,149,117];const d=[];for(let f=0;f<a.length;f++){const n=a[f];for(let l=0;11>l;l++)d.push(n)}a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(d)};this._recordGlyph(a)};e.getGlyphItems=async function(a,d,f){const n=this._getGlyphCache(a);await this._fetchRanges(a,d,f);return d.map(l=>this._getMosaicItem(n,a,l))};e.bind=function(a,d,f,n){const l=this._getTexture(a,f);l.setSamplingMode(d);
this._dirties[f]&&(l.setData(this._glyphData[f]),this._dirties[f]=!1);a.bindTexture(l,n)};e._getGlyphCache=function(a){this._glyphCache[a]||(this._glyphCache[a]={});return this._glyphCache[a]};e._getTexture=function(a,d){this._textures[d]||(this._textures[d]=new E(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[d]};e._invalidate=function(){this._dirties[this._currentPage]=!0};e._fetchRanges=async function(a,d,f){const n=
[];k(d).forEach(l=>{n.push(this._fetchRange(a,l,f))});await Promise.all(n)};e._fetchRange=async function(a,d,f){return 256<d?null:c(this._rangePromises,a+d,()=>this._glyphSource.getRange(a,d,f))};e._getMosaicItem=function(a,d,f){if(!a[f]){d=this._glyphSource.getGlyph(d,f);if(!d||!d.metrics)return{rect:new B(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:f,sdf:!0};const n=this._recordGlyph(d);a[f]={rect:n,page:this._currentPage,metrics:d.metrics,code:f,sdf:!0};this._invalidate()}return a[f]};
e._recordGlyph=function(a){var d=a.metrics;if(0===d.width)d=new B(0,0,0,0);else{const f=d.width+6,n=d.height+6;d=this._binPack.allocate(f,n);d.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new A(this.width-4,this.height-4),d=this._binPack.allocate(f,n));const l=this._glyphData[this._currentPage];
a=a.bitmap;let h,m;if(a)for(let r=0;r<n;r++){h=f*r;m=this.width*(d.y+r)+d.x;for(let p=0;p<f;p++)l[m+p]=a[h+p]}y("esri-glyph-debug")&&this._showDebugPage(l)}return d};e._showDebugPage=function(a){const d=document.createElement("canvas"),f=d.getContext("2d"),n=new ImageData(this.width,this.height),l=n.data;d.width=this.width;d.height=this.height;d.style.border="1px solid black";for(let h=0;h<a.length;++h)l[4*h]=a[h],l[4*h+1]=0,l[4*h+2]=0,l[4*h+3]=255;f.putImageData(n,0,0);document.body.appendChild(d)};
return b}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(y){return function(){function D(E=0,B=0,A=0,k=0){this.x=E;this.y=B;this.width=A;this.height=k}D.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};y._createClass(D,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return D}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./Rect"],function(y,D){return function(){function E(A,k){this._height=this._width=0;this._free=[];this._width=A;this._height=k;this._free.push(new D(0,0,A,k))}var B=E.prototype;B.allocate=function(A,k){if(A>this._width||k>this._height)return new D;let c=null,b=-1;for(let e=0;e<this._free.length;++e){const a=this._free[e];A<=a.width&&k<=a.height&&(null===c||a.y<=c.y&&a.x<=c.x)&&(c=a,b=e)}if(null===c)return new D;this._free.splice(b,1);c.width<c.height?(c.width>A&&this._free.push(new D(c.x+A,c.y,c.width-
A,k)),c.height>k&&this._free.push(new D(c.x,c.y+k,c.width,c.height-k))):(c.width>A&&this._free.push(new D(c.x+A,c.y,c.width-A,c.height)),c.height>k&&this._free.push(new D(c.x,c.y+k,A,c.height-k)));return new D(c.x,c.y,A,k)};B.release=function(A){for(let k=0;k<this._free.length;++k){const c=this._free[k];if(c.y===A.y&&c.height===A.height&&c.x+c.width===A.x)c.width+=A.width;else if(c.x===A.x&&c.width===A.width&&c.y+c.height===A.y)c.height+=A.height;else if(A.y===c.y&&A.height===c.height&&A.x+A.width===
c.x)c.x=A.x,c.width+=A.width;else if(A.x===c.x&&A.width===c.width&&A.y+A.height===c.y)c.y=A.y,c.height+=A.height;else continue;this._free.splice(k,1);this.release(A)}this._free.push(A)};y._createClass(E,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return E}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(y,D){let E=function(){function A(c){this._metrics=[];for(this._bitmaps=
[];c.next();)switch(c.tag()){case 1:{const b=c.getMessage();for(;b.next();)switch(b.tag()){case 3:{const e=b.getMessage();let a,d,f,n,l,h,m;for(;e.next();)switch(e.tag()){case 1:a=e.getUInt32();break;case 2:d=e.getBytes();break;case 3:f=e.getUInt32();break;case 4:n=e.getUInt32();break;case 5:l=e.getSInt32();break;case 6:h=e.getSInt32();break;case 7:m=e.getUInt32();break;default:e.skip()}e.release();a&&(this._metrics[a]={width:f,height:n,left:l,top:h,advance:m},this._bitmaps[a]=d);break}default:b.skip()}b.release();
break}default:c.skip()}}var k=A.prototype;k.getMetrics=function(c){return this._metrics[c]};k.getBitmap=function(c){return this._bitmaps[c]};return A}(),B=function(){function A(){this._ranges=[]}var k=A.prototype;k.getRange=function(c){return this._ranges[c]};k.addRange=function(c,b){this._ranges[c]=b};return A}();return function(){function A(c){this._glyphInfo={};this._baseURL=c}var k=A.prototype;k.getRange=function(c,b,e){const a=this._getFontStack(c);if(a.getRange(b))return Promise.resolve();const d=
256*b,f=d+255;c=this._baseURL.replace("{fontstack}",c).replace("{range}",d+"-"+f);return y(c,{responseType:"array-buffer",...e}).then(n=>{a.addRange(b,new E(new D(new Uint8Array(n.data),new DataView(n.data))))})};k.getGlyph=function(c,b){if(c=this._getFontStack(c)){var e=Math.floor(b/256);if(!(256<e)&&(c=c.getRange(e)))return{metrics:c.getMetrics(b),bitmap:c.getBitmap(b)}}};k._getFontStack=function(c){let b=this._glyphInfo[c];b||(b=this._glyphInfo[c]=new B);return b};return A}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/promiseUtils",
"./packingUtils"],function(y,D){return function(){function E(A){this.size=A;const k=document.createElement("canvas");k.width=k.height=A;this._context=k.getContext("2d");this._gridOuter=new Float64Array(A*A);this._gridInner=new Float64Array(A*A);this._f=new Float64Array(A);this._d=new Float64Array(A);this._z=new Float64Array(A+1);this._v=new Int16Array(A)}var B=E.prototype;B.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),
this._svg=null)};B.draw=function(A,k,c=31){this._initSVG();const b=this._createSVGString(A);return new Promise((e,a)=>{const d=new Image;d.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(b);d.onload=()=>{d.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(d,0,0,this.size,this.size);var n=this._context.getImageData(0,0,this.size,this.size);const l=new Uint8Array(this.size*this.size*4);for(let h=0;h<this.size*this.size;h++){const m=n.data[4*h+3]/255;
this._gridOuter[h]=1===m?0:0===m?1E20:Math.max(0,.5-m)**2;this._gridInner[h]=1===m?1E20:0===m?0:Math.max(0,m-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(n=0;n<this.size*this.size;n++)D.packFloatRGBA(.5-(this._gridOuter[n]-this._gridInner[n])/(2*c),l,4*n);e(l)};const f=k&&k.signal;if(f)y.onAbort(f,()=>a(y.createAbortError()))})};B._initSVG=function(){if(!this._svg){const A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttribute("style",
"position: absolute;");A.setAttribute("width","0");A.setAttribute("height","0");A.setAttribute("aria-hidden","true");A.setAttribute("role","presentation");document.body.appendChild(A);this._svg=A}};B._createSVGString=function(A){const k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",A);this._svg.appendChild(k);A=k.getBBox();var c=A.width/A.height;const b=this.size/2;let e,a,d;1<c?(a=e=b/A.width,d=this.size/4,c=b-1/c*b/2):(e=a=b/A.height,d=b-b*c/2,c=this.size/4);k.setAttribute("style",
`transform: matrix(${e}, 0, 0, ${a}, ${-A.x*e+d}, ${-A.y*a+c})`);A=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(k);return A};B._edt=function(A,k,c){const b=this._f,e=this._d,a=this._v,d=this._z;for(var f=0;f<k;f++){for(var n=0;n<c;n++)b[n]=A[n*k+f];this._edt1d(b,e,a,d,c);for(n=0;n<c;n++)A[n*k+f]=e[n]}for(f=0;f<c;f++){for(n=0;n<k;n++)b[n]=A[f*k+n];this._edt1d(b,e,a,d,k);for(n=0;n<k;n++)A[f*
k+n]=Math.sqrt(e[n])}};B._edt1d=function(A,k,c,b,e){c[0]=0;b[0]=-1E20;b[1]=1E20;for(let a=1,d=0;a<e;a++){let f=(A[a]+a*a-(A[c[d]]+c[d]*c[d]))/(2*a-2*c[d]);for(;f<=b[d];)d--,f=(A[a]+a*a-(A[c[d]]+c[d]*c[d]))/(2*a-2*c[d]);d++;c[d]=a;b[d]=f;b[d+1]=1E20}for(let a=0,d=0;a<e;a++){for(;b[d+1]<a;)d++;k[a]=(a-c[d])*(a-c[d])+A[c[d]]}};return E}()})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["exports"],function(y){function D(k){return k-Math.floor(k)}const E=[1,256,65536,16777216],B=[1/256,
1/65536,1/16777216,1/4294967296],A=function(k,c=0){let b=0;for(let e=0;4>e;e++)b+=k[c+e]*B[e];return b}(new Uint8ClampedArray([255,255,255,255]));y.packFloatRGBA=function(k,c,b=0){k=0>k?0:k>A?A:k;for(let e=0;4>e;e++)c[b+e]=Math.floor(256*D(k*E[e]))};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Error ./definitions ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Rect ./GeometryUtils ./RectangleBinPack".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){function r(p){return p&&"static"===p.type}return function(){function p(q,u,v,z=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=u||0>=v)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=u;this._pageHeight=v;this._requestRender=q;0<z&&(this._maxItemSize=z);this.pixelRatio=window.devicePixelRatio||
1;this._binPack=new m(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var g=p.prototype;g.getWidth=function(q){return q>=this._mosaicPages.length?-1:this._mosaicPages[q].size[0]};g.getHeight=function(q){return q>=this._mosaicPages.length?-1:this._mosaicPages[q].size[1]};g.getPageTexture=function(q){return q<this._mosaicPages.length?
this._mosaicPages[q].texture:null};g.has=function(q){return this._mosaicRects.has(q)};g.getSpriteItem=function(q){return this._mosaicRects.get(q)};g.addSpriteItem=function(q,u,v,z,t,w){if(this._mosaicRects.has(q))return this._mosaicRects.get(q);let x,C,F;r(v)?[x,C,F]=this._allocateImage(u[0],u[1]):(x=new l(0,0,u[0],u[1]),C=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:v,size:u,dirty:!0,texture:void 0}));if(0>=x.width||0>=x.height)return null;w={rect:x,width:u[0],height:u[1],sdf:t,simplePattern:w,
pixelRatio:1,page:C};this._mosaicRects.set(q,w);r(v)&&this._copy({rect:x,spriteSize:u,spriteData:v.data,page:C,pageSize:F,repeat:z,sdf:t});return w};g.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};g.processNextItem=function(){const q=this._spriteCopyQueue.pop();q&&this._copy(q)};g.getSpriteItems=function(q){const u={};for(const v of q)u[v]=this.getSpriteItem(v);return u};g.getMosaicItemPosition=function(q){const u=(q=this.getSpriteItem(q))&&q.rect;if(!u)return null;u.width=
q.width;u.height=q.height;const v=B.SPRITE_PADDING,z=this._mosaicPages[q.page];return{size:[q.width,q.height],tl:[(u.x+v)/z[0],(u.y+v)/z[1]],br:[(u.x+v+q.width)/z[0],(u.y+v+q.height)/z[1]],page:q.page}};g.bind=function(q,u,v=0,z=0){v=this._mosaicPages[v];var t=v.mosaicsData,w=v.texture;w||(w=v.size,w=r(t)?new c(q,{pixelFormat:6408,dataType:5121,width:w[0],height:w[1]},new Uint8Array(t.data.buffer)):new c(q,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:w[0],height:w[1]},null),
v.texture=w);w.setSamplingMode(u);r(t)?(q.bindTexture(w,z),v.dirty&&(w.setData(new Uint8Array(t.data.buffer)),w.generateMipmap())):(u=t.data,t=u.bindFrame(q,w,z),D.isSome(this._requestRender)&&t&&0<u.frameCount&&this._requestRender.requestRender(),u.bindFrame(q,w,z));v.dirty=!1};p._copyBits=function(q,u,v,z,t,w,x,C,F,H,J){let K=z*u+v;x=C*w+x;if(J)for(x-=w,J=-1;J<=H;J++,K=((J+H)%H+z)*u+v,x+=w)for(C=-1;C<=F;C++)t[x+C]=q[K+(C+F)%F];else for(v=0;v<H;v++){for(z=0;z<F;z++)t[x+z]=q[K+z];K+=u;x+=w}};g._copy=
function(q){if(!(q.page>=this._mosaicPages.length)){var u=this._mosaicPages[q.page],v=u.mosaicsData;if(!r(u.mosaicsData))throw new E("mapview-invalid-resource","unsuitable data type!");var z=q.spriteData;(v=v.data)&&z||console.error("Source or target images are uninitialized!");p._copyBits(z,q.spriteSize[0],0,0,v,q.pageSize[0],q.rect.x+B.SPRITE_PADDING,q.rect.y+B.SPRITE_PADDING,q.spriteSize[0],q.spriteSize[1],q.repeat);u.dirty=!0}};g._allocateImage=function(q,u){q+=2*B.SPRITE_PADDING;u+=2*B.SPRITE_PADDING;
var v=Math.max(q,u);if(this._maxItemSize&&this._maxItemSize<v){v=2**Math.ceil(h.log2(q));const z=2**Math.ceil(h.log2(u));q=new l(0,0,q,u);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(v*z)},size:[v,z],dirty:!0,texture:void 0});return[q,this._mosaicPages.length-1,[v,z]]}v=this._binPack.allocate(q,u);return 0>=v.width?(v=this._mosaicPages[this._currentPage],!v.dirty&&r(v.mosaicsData)&&(v.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new m(this._pageWidth,this._pageHeight),this._allocateImage(q,u)):[v,this._currentPage,[this._pageWidth,this._pageHeight]]};g.dispose=function(){this._binPack=null;for(const u of this._mosaicPages){var q=u.texture;q&&q.dispose();q=u.mosaicsData;r(q)||q.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};y._createClass(p,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);
return p}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../core/Error","../../../../../core/promiseUtils"],function(y,D,E){function B(p,g=0,q=p.length-g){let u=-1;for(let v=g,z=g+q;v<z;v++)u=u>>>8^f[(u^p[v])&255];return u^-1}function A(p){const g=p.constructor===Uint8Array?p:new Uint8Array(p);return m.some((q,u)=>q!==g[u])?!1:!0}function k(p,g){const q=new Uint8Array(g);if(m.some((H,J)=>H!==q[J]))return l;let u=!1;c(q,H=>!(u="acTL"===H));if(!u)return h;
const v=[],z=[];let t=null,w=null,x=0;c(q,(H,J,K,N)=>{const R=new DataView(J.buffer);switch(H){case "IHDR":t=J.subarray(K+8,K+8+N);p.width=R.getUint32(K+8);p.height=R.getUint32(K+12);break;case "acTL":p.numPlays=R.getUint32(K+8+4);break;case "fcTL":w&&(p.frames.push(w),x++);w=new r;w.width=R.getUint32(K+8+4);w.height=R.getUint32(K+8+8);w.left=R.getUint32(K+8+12);w.top=R.getUint32(K+8+16);H=R.getUint16(K+8+20);J=R.getUint16(K+8+22);0===J&&(J=100);w.delay=1E3*H/J;10>=w.delay&&(w.delay=100);p.playTime+=
w.delay;w.disposeOp=R.getUint8(K+8+24);w.blendOp=R.getUint8(K+8+25);w.dataParts=[];0===x&&2===w.disposeOp&&(w.disposeOp=1);break;case "fdAT":w&&w.dataParts.push(J.subarray(K+8+4,K+8+N));break;case "IDAT":w&&w.dataParts.push(J.subarray(K+8,K+8+N));break;case "IEND":z.push(e(J,K,12+N));break;default:v.push(e(J,K,12+N))}});if(0===p.frames.length)return h;p.frameCount=p.frames.length;const C=new Blob(v),F=new Blob(z);p.frames.forEach(H=>{let J=[];J.push(m);t.set(d(H.width),0);t.set(d(H.height),4);J.push(a("IHDR",
t));J.push(C);H.dataParts.forEach(K=>J.push(a("IDAT",K)));J.push(F);H.data=new Blob(J,{type:"image/png"});delete H.dataParts;J=null});return p}function c(p,g){const q=new DataView(p.buffer);let u=8;let v,z;do{v=q.getUint32(u);var t=u+4;t=Array.prototype.slice.call(p.subarray(t,t+4));t=String.fromCharCode.apply(String,t);z=g(t,p,u,v);u+=12+v}while(!1!==z&&"IEND"!==t&&u<p.length)}function b(p){const g=new Uint8Array(p.length);for(let q=0;q<p.length;q++)g[q]=p.charCodeAt(q);return g}function e(p,g,q){const u=
new Uint8Array(q);u.set(p.subarray(g,g+q));return u}function a(p,g){const q=p.length+g.length,u=new Uint8Array(q+8),v=new DataView(u.buffer);v.setUint32(0,g.length);u.set(b(p),4);u.set(g,8);p=B(u,4,q);v.setUint32(q+4,p);return u}function d(p){return new Uint8Array([p>>>24&255,p>>>16&255,p>>>8&255,p&255])}const f=new Uint32Array(256);for(var n=0;256>n;n++){let p=n;for(let g=0;8>g;g++)p=0!==(p&1)?3988292384^p>>>1:p>>>1;f[n]=p}const l=new D("Not a PNG"),h=new D("Not an animated PNG"),m=new Uint8Array([137,
80,78,71,13,10,26,10]);n=function(){function p(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}p.create=async function(q,u){const v=new p;try{await v._load(q,u)}catch(z){if(!E.isAbortError(z))return new D("invalid-resource",`Could not load PNG: ${z.message}`)}return v};var g=p.prototype;g.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};g.pause=function(){this.paused=
!0;this.playing=!1;clearTimeout(this.timerID)};g.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};g.bindFrame=function(q,u,v){q.bindTexture(u,v);q=this.frameChanged();if(!q)return!1;v=this.currentFrame;const z=v.frameData,t=u.descriptor;(v.left||v.top||v.width!==t.width||v.height!==t.height)&&u.setData(null);u.updateData(0,v.left,v.top,v.width,v.height,z);this.updateUsedFrame();return q};g.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};g.updateUsedFrame=
function(){this._lastUsedFrame=this.currentFrameNumber};g._load=async function(q,u){try{const v=k(this,q);if(v!==this)return v;this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;await Promise.all(this.frames.map(z=>z.createImage(this._resizeCanvas)))}catch(v){if(!E.isAbortError(v))return new D("invalid-resource","Could not parse PNG")}this.play()};g._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;
0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var q=this.currentFrameNumber;--q;0>q&&(q=this.frames.length-1);q=-this.frames[q].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,q=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;var u=this.frames[this.currentFrameNumber];this.currentFrame={frameData:u.imageData,top:u.top,left:u.left,width:u.width,height:u.height};this.timerID=window.setTimeout(()=>this._play(),q)}};
return p}();let r=function(){function p(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}p.prototype.createImage=async function(g){if(null===this.imageData)return new Promise((q,u)=>{const v=URL.createObjectURL(this.data),z=document.createElement("img");z.onload=()=>{URL.revokeObjectURL(v);{g.width=z.width;g.height=z.height;var t=g.getContext("2d");t.drawImage(z,0,0,z.width,z.height);t=t.getImageData(0,0,z.width,z.height);t=new Uint8Array(t.data);
let w;for(let x=0;x<t.length;x+=4)w=t[x+3]/255,t[x]*=w,t[x+1]*=w,t[x+2]*=w;t=new ImageData(new Uint8ClampedArray(t.buffer),z.width,z.height)}this.imageData=t;q()};z.onerror=()=>{URL.revokeObjectURL(v);this.imageData=null;u(Error("Image creation error"))};z.src=v})};return p}();y.default=n;y.getPNGSize=function(p){p=new Uint8Array(p);let g,q;c(p,(u,v,z)=>{v=new DataView(v.buffer);"IHDR"===u&&(g=v.getUint32(z+8),q=v.getUint32(z+12))});return[g,q]};y.isAnimatedPNG=function(p){p=new Uint8Array(p);if(!A(p))return!1;
let g=!1;c(p,q=>!(g="acTL"===q));return g};y.isPNG=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../core/Error","../../../../../core/promiseUtils"],function(y,D,E){function B(c){if(!c||0===c.byteLength)return!1;c=c.constructor===Uint8Array?c:new Uint8Array(c);return 71===c[0]&&73===c[1]&&70===c[2]&&56===c[3]}let A=function(){function c(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=
this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}c.create=async function(e,a){const d=new c;try{await d._load(e,a)}catch(f){if(!E.isAbortError(f))return new D("invalid-resource",`Could not load PNG: ${f.message}`)}return d};var b=c.prototype;b.play=function(){this.playing||(this.paused=!1,this.playing=
!0,this._play())};b.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};b.bindFrame=function(e,a,d){e.bindTexture(a,d);if(e=this.frameChanged())d=this.currentFrame,a.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return e};b.seekFrame=function(e){clearTimeout(this.timerID);this.currentFrameNumber=e%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};
b.seek=function(e){clearTimeout(this.timerID);0>e&&(e=0);e=1E3*e%this.length;let a=0;for(;e>this.frames[a].time+this.frames[a].delay&&a<this.frames.length;)a+=1;this.currentFrameNumber=a;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};b._load=async function(e,a){try{this.loading=!0,await this._parse(e,a),this.loading=!1,
this.play()}catch(d){if(!E.isAbortError(d))return new D("invalid-resource","Could not parse gif!")}};b._parse=function(e,a){const d=new k(e);d.pos+=6;this.width=d.data[d.pos++]+(d.data[d.pos++]<<8);this.height=d.data[d.pos++]+(d.data[d.pos++]<<8);e=d.data[d.pos++];this.globalColourCount=1<<(e&7)+1;d.pos++;d.pos++;e&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,d));return new Promise((f,n)=>{setTimeout(()=>this._parseBlock(d,f,n,a),0)})};b._parseBlock=async function(e,
a,d,f){if(f&&f.signal&&E.isAborted(f.signal))d(E.createAbortError());else{var n=e.data[e.pos++];if(44===n){if(this._parseImg(e),this.firstFrameOnly){this._finishedLoading();a();return}}else{if(59===n){this._finishedLoading();a();return}this._parseExt(e)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:e.pos,totalBytes:e.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(e,a,d,f),0)}};b._parseColourTable=function(e,a){const d=[];for(let f=0;f<e;f++)d.push([a.data[a.pos++],
a.data[a.pos++],a.data[a.pos++]]);return d};b._parseImg=function(e){const a=n=>{const l=this.pixelBufSize/n;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);let h=0;for(let m=0;4>m;m++)for(let r=this.interlaceOffsets[m];r<l;r+=this.interlaceSteps[m])this.deinterlaceBuf.set(this.pixelBuf.subarray(h,h+n),r*n),h+=n},d={};this.frames.push(d);d.disposalMethod=this.disposalMethod;d.time=this.length;d.delay=10*this.delayTime;
this.length+=d.delay;d.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;d.leftPos=e.data[e.pos++]+(e.data[e.pos++]<<8);d.topPos=e.data[e.pos++]+(e.data[e.pos++]<<8);d.width=e.data[e.pos++]+(e.data[e.pos++]<<8);d.height=e.data[e.pos++]+(e.data[e.pos++]<<8);const f=e.data[e.pos++];d.localColourTableFlag=f&128?!0:!1;d.localColourTableFlag&&(d.localColourTable=this._parseColourTable(1<<(f&7)+1,e));this.pixelBufSize!==d.width*d.height&&(this.pixelBuf=new Uint8Array(d.width*d.height),
this.pixelBufSize=d.width*d.height);this._lzwDecode(e.data[e.pos++],e.readSubBlocksB());f&64?(d.interlaced=!0,a(d.width)):d.interlaced=!1;this._processFrame(d)};b._lzwDecode=function(e,a){let d,f,n,l,h;let m,r;n=f=0;let p=[];const g=1<<e,q=g+1;l=e+1;for(r=!1;!r;){var u=h;for(d=h=0;d<l;d++)a[n>>3]&1<<(n&7)&&(h|=1<<d),n++;if(h===g){p=[];l=e+1;for(d=0;d<g;d++)p[d]=[d];p[g]=[];p[q]=null}else{if(h===q){r=!0;break}h>=p.length?p.push(p[u].concat(p[u][0])):u!==g&&p.push(p[u].concat(p[h][0]));u=p[h];m=u.length;
for(d=0;d<m;d++)this.pixelBuf[f++]=u[d];p.length===1<<l&&12>l&&l++}}};b._processFrame=function(e){e.image=document.createElement("canvas");e.image.width=this.width;e.image.height=this.height;e.ctx=e.image.getContext("2d");const a=e.localColourTableFlag?e.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=e);const d=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;d||e.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);const f=e.ctx.getImageData(e.leftPos,
e.topPos,e.width,e.height),n=e.transparencyIndex,l=f.data,h=e.interlaced?this.deinterlaceBuf:this.pixelBuf,m=h.length;let r=0,p,g;for(let q=0;q<m;q++)p=h[q],g=a[p],n!==p?(l[r++]=g[0],l[r++]=g[1],l[r++]=g[2],l[r++]=255):(d&&(l[r+3]=0),r+=4);e.ctx.putImageData(f,e.leftPos,e.topPos);this.lastFrame=e};b._parseExt=function(e){const a=e.data[e.pos++];249===a?this._parseGCExt(e):254===a?this.comment+=e.readSubBlocks():255===a?this._parseAppExt(e):(1===a&&(e.pos+=13),e.readSubBlocks())};b._parseAppExt=function(e){e.pos+=
1;"NETSCAPE"===e.getString(8)?e.pos+=8:(e.pos+=3,e.readSubBlocks())};b._parseGCExt=function(e){e.pos++;const a=e.data[e.pos++];this.disposalMethod=(a&28)>>2;this.transparencyGiven=a&1?!0:!1;this.delayTime=e.data[e.pos++]+(e.data[e.pos++]<<8);this.transparencyIndex=e.data[e.pos++];e.pos++};b._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=
this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};b._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var e=this.currentFrameNumber;--e;0>e&&(e=this.frames.length-1);e=-this.frames[e].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=
this.frames.length,e=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=window.setTimeout(()=>this._play(),e)}};b._setCurrentFrame=function(e){this.currentFrame={frameData:this.frames[e].image,top:0,left:0,width:this.width,height:this.height}};return c}(),k=function(){function c(e){this.pos=0;this.data=new Uint8ClampedArray(e);this.len=this.data.length}var b=c.prototype;b.getString=function(e){let a="";for(;e--;)a+=String.fromCharCode(this.data[this.pos++]);
return a};b.readSubBlocks=function(){let e,a,d="";do for(a=e=this.data[this.pos++];a--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==e&&this.pos<this.len);return d};b.readSubBlocksB=function(){let e,a;const d=[];do for(a=e=this.data[this.pos++];a--;)d.push(this.data[this.pos++]);while(0!==e&&this.pos<this.len);return d};return c}();y.default=A;y.getGIFSize=function(c){var b=new Uint8ClampedArray(c);let e=6;c=b[e++]+(b[e++]<<8);b=b[e++]+(b[e++]<<8);return[c,b]};y.isAnimatedGIF=function(c){if(!c||
0===c.byteLength)return!1;c=new Uint8Array(c);if(!B(c))return!1;let b=0;for(let e=0,a=c.length-9;e<a&&(0!==c[e]||33!==c[e+1]||249!==c[e+2]||4!==c[e+3]||0!==c[e+8]||44!==c[e+9]&&33!==c[e+9]||(b++,!(1<b)));++e);return 1<b};y.isGIF=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(y,D){y.ok=function(E,B){return E&&"name"in E?(B&&B.error(new D(E.name,E.message,E.details)),!1):!0};Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(y){y.keyFromSymbol=function(D){switch(D.type){case "esriSMS":return`${D.style}.${D.path}`;case "esriSLS":return`${D.style}.${D.cap}`;case "esriSFS":return`${D.style}`;case "esriPFS":case "esriPMS":return D.imageData?`${D.imageData}${D.width}${D.height}`:`${D.url}${D.width}${D.height}`;default:return D.mosaicHash?D.mosaicHash:JSON.stringify(D)}};Object.defineProperty(y,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(y,D,E,B,A,k){k=function(c){function b(){var a=c.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:{a_position:0}};return a}D._inheritsLoose(b,c);var e=b.prototype;e.dispose=function(){this._quad&&this._quad.dispose()};e.bind=function(){};
e.unbind=function(){};e.draw=function(a,d){if(d.size){var {context:f,renderingOptions:n}=a;this._quad||(this._quad=new A(f,[0,0,1,0,0,1,1,1]));var l=f.getBoundFramebufferObject(),{x:h,y:m,width:r,height:p}=f.getViewport();d.bindTextures(f);var g=d.getBlock(B.ATTRIBUTE_DATA_ANIMATION);if(!E.isNone(g)){var q=g.getFBO(f);g=g.getFBO(f,1);f.setViewport(0,0,d.size,d.size);this._computeDelta(a,g,n.labelsAnimationTime);this._updateAnimationState(a,g,q);f.bindFramebuffer(l);f.setViewport(h,m,r,p)}}};e._computeDelta=
function(a,d,f){const {context:n,painter:l,displayLevel:h}=a,m=l.materialManager.getProgram(a,this._desc,["delta"]);n.bindFramebuffer(d);n.setClearColor(0,0,0,0);n.clear(n.gl.COLOR_BUFFER_BIT);n.bindProgram(m);m.setUniform1i("u_maskTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_0);m.setUniform1i("u_sourceTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_1);m.setUniform1f("u_timeDelta",a.deltaTime);m.setUniform1f("u_animationTime",f);m.setUniform1f("u_zoomLevel",Math.round(10*h));this._quad.draw()};e._updateAnimationState=
function(a,d,f){const {context:n,painter:l}=a;a=l.materialManager.getProgram(a,this._desc,["update"]);n.bindTexture(d.colorTexture,1);n.bindProgram(a);a.setUniform1i("u_sourceTexture",1);n.bindFramebuffer(f);n.setClearColor(0,0,0,0);n.clear(n.gl.COLOR_BUFFER_BIT);this._quad.draw()};return b}(k.Effect);y.AnimationEffect=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(y){y.Effect=function(){this.name=this.constructor.name};
Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/Error ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){const r=E.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");E=function(){function p(){this._size=[0,0]}var g=p.prototype;g.dispose=function(q){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};g.draw=function(q,u,v,z,t){const {context:w,drawPhase:x}=q;this._setupShader(w);
z&&"normal"!==z&&x!==l.WGLDrawPhase.LABEL?this._drawBlended(q,u,v,z,t):(q=this._programCache.getProgram(m.blend,"normal"))?(w.bindProgram(q),u.setSamplingMode(v),w.bindTexture(u,0),q.setUniform1i("u_layerTexture",0),q.setUniform1f("u_opacity",t),w.setBlendingEnabled(!0),w.setBlendFunction(1,771),u=this._quad,u.draw(),u.unbind()):r.error(new B("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};g._drawBlended=function(q,u,v,z,t){const {context:w,state:x,pixelRatio:C,inFadeTransition:F}=
q;var {size:H}=x,J=w.getBoundFramebufferObject();let K;D.isSome(J)?(H=J.descriptor,K=H.width,H=H.height):(K=Math.round(C*H[0]),H=Math.round(C*H[1]));this._createOrResizeTexture(q,K,H);q=this._backBufferTexture;J.copyToTexture(0,0,K,H,0,0,q);w.setStencilTestEnabled(!1);w.setStencilWriteMask(0);w.setBlendingEnabled(!0);w.setDepthTestEnabled(!1);w.setDepthWriteEnabled(!1);(J=this._programCache.getProgram(m.blend,z))?(w.bindProgram(J),q.setSamplingMode(v),w.bindTexture(q,0),J.setUniform1i("u_backbufferTexture",
0),u.setSamplingMode(v),w.bindTexture(u,1),J.setUniform1i("u_layerTexture",1),J.setUniform1f("u_opacity",t),J.setUniform1f("u_inFadeOpacity",F?1:0),w.setBlendFunction(1,0),u=this._quad,u.draw(),u.unbind(),w.setBlendFunction(1,771)):r.error(new B("mapview-BlendEffect",`Error creating shader program for blend mode ${z}`))};g._setupShader=function(q){this._programCache||(this._programCache=new d(q),this._quad||(this._quad=new h(q,[-1,-1,1,-1,-1,1,1,1])))};g._createOrResizeTexture=function(q,u,v){({context:q}=
q);if(null===this._backBufferTexture||u!==this._size[0]||v!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(u,v):this._backBufferTexture=new c(q,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:u,height:v}),this._size[0]=u,this._size[1]=v};return p}();y.BlendEffect=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(y,D){y.blend={attributes:{a_pos:0,a_tex:1},shaders:E=>({vertexShader:`#define ${E.replace("-","_").toUpperCase()}\n`+D.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${E.replace("-","_").toUpperCase()}\n`+D.resolveIncludes("blend/blend.frag")})};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect"],function(y,D,E){E=function(B){function A(c){var b=
B.call(this)||this;b.name=b.constructor.name;b.defines=[c];return b}D._inheritsLoose(A,B);var k=A.prototype;k.dispose=function(){};k.bind=function({context:c,painter:b}){this._prev=c.getBoundFramebufferObject();const {width:e,height:a}=c.getViewport();b=b.getFbos(e,a).effect0;c.bindFramebuffer(b);c.setColorMask(!0,!0,!0,!0);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};k.unbind=function(){};k.draw=function(c,b){const {context:e,painter:a,state:d,deltaTime:f}=c,n=a.getPostProcessingEffects(b.effects),
l=e.getBoundFramebufferObject();n.length&&b.transitionStep(f,d.scale);for(const {postProcessingEffect:h,effect:m}of n)h.draw(c,l,m);e.bindFramebuffer(this._prev);e.setStencilTestEnabled(!1);a.blitTexture(e,l.colorTexture,9728);e.setStencilTestEnabled(!0)};return A}(E.Effect);y.FeatureEffect=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(y,D,E,B,A,k,c){return function(b){function e(){var d=b.apply(this,arguments)||this;d.defines=["highlight"];d._hlRenderer=new k;d._hlGradient=new A;d._width=void 0;d._height=void 0;d._hlSurfaces=new c;d._adjustedWidth=void 0;d._adjustedHeight=void 0;d._blitRenderer=new E.BitBlitRenderer;return d}y._inheritsLoose(e,b);var a=e.prototype;a.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};a.bind=function(d){const {context:f,painter:n}=d,{width:l,height:h}=f.getViewport(),m=n.getFbos(l,h).effect0;this.setup(d,l,h);f.bindFramebuffer(m);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};a.unbind=function(){};a.setup=function({context:d},f,n){this._width=f;this._height=n;const l=f%4,h=n%4;f+=2>l?-l:4-l;n+=2>h?-h:4-h;this._adjustedWidth=f;this._adjustedHeight=n;this._boundFBO=d.getBoundFramebufferObject();f=Math.round(.75*f);n=Math.round(.75*
n);this._hlRenderer.setup(d,f,n);this._hlSurfaces.setup(d,f,n)};a.draw=function({context:d}){const f=d.getBoundFramebufferObject();d.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);d.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);d.setStencilTestEnabled(!1);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(d,f.colorTexture,9728,1);d.setStencilTestEnabled(!1);d.setBlendingEnabled(!1);d.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);d.setClearColor(0,
0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(d,this._hlSurfaces.sharedBlur1Tex);d.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(d,this._hlSurfaces.sharedBlur2Tex);d.bindFramebuffer(this._boundFBO);d.setBlendingEnabled(!0);d.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(d,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};a.setHighlightOptions=function(d){this._hlGradient.setHighlightOptions(d)};
return e}(B.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../core/Logger ../../definitions ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./parameters".split(" "),function(y,
D,E,B,A,k,c,b,e,a,d,f){function n(m,r){r.fillColor[0]=m.color.r/255;r.fillColor[1]=m.color.g/255;r.fillColor[2]=m.color.b/255;r.fillColor[3]=m.color.a;m.haloColor?(r.outlineColor[0]=m.haloColor.r/255,r.outlineColor[1]=m.haloColor.g/255,r.outlineColor[2]=m.haloColor.b/255,r.outlineColor[3]=m.haloColor.a):(r.outlineColor[0]=r.fillColor[0],r.outlineColor[1]=r.fillColor[1],r.outlineColor[2]=r.fillColor[2],r.outlineColor[3]=r.fillColor[3]);r.fillColor[3]*=m.fillOpacity;r.outlineColor[3]*=m.haloOpacity;
r.fillColor[0]*=r.fillColor[3];r.fillColor[1]*=r.fillColor[3];r.fillColor[2]*=r.fillColor[3];r.outlineColor[0]*=r.outlineColor[3];r.outlineColor[1]*=r.outlineColor[3];r.outlineColor[2]*=r.outlineColor[3];r.outlineWidth=f.HIGHLIGHT_SIZING.outlineWidth;r.outerHaloWidth=f.HIGHLIGHT_SIZING.outerHaloWidth;r.innerHaloWidth=f.HIGHLIGHT_SIZING.innerHaloWidth;r.outlinePosition=f.HIGHLIGHT_SIZING.outlinePosition}const l=y.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),h=[0,0,0,
0];return function(){function m(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:f.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:f.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:f.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:f.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*f.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var r=m.prototype;r.setHighlightOptions=function(p){function g(C,F,H){x[0]=
(1-H)*C[0]+H*F[0];x[1]=(1-H)*C[1]+H*F[1];x[2]=(1-H)*C[2]+H*F[2];x[3]=(1-H)*C[3]+H*F[3]}const q=this._convertedHighlightOptions;n(p,q);p=q.outlinePosition-q.outlineWidth/2-q.outerHaloWidth;const u=q.outlinePosition-q.outlineWidth/2,v=q.outlinePosition+q.outlineWidth/2,z=q.outlinePosition+q.outlineWidth/2+q.innerHaloWidth;var t=Math.sqrt(Math.PI/2)*f.SIGMAS[3],w=Math.abs(p)>t?Math.round(10*(Math.abs(p)-t))/10:0;t=Math.abs(z)>t?Math.round(10*(Math.abs(z)-t))/10:0;w&&!t?l.error("The outer rim of the highlight is "+
w+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!w&&t?l.error("The inner rim of the highlight is "+t+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):w&&t&&l.error("The highlight is "+Math.max(w,t)+"px away from the edge of the feature; consider reducing some width values.");const x=[void 0,void 0,void 0,
void 0];({texelData:t}=this);for(let C=0;C<f.SHADE_TEXTURE_SIZE;++C)w=p+C/(f.SHADE_TEXTURE_SIZE-1)*(z-p),w<p?(x[4*C]=0,x[4*C+1]=0,x[4*C+2]=0,x[4*C+3]=0):w<u?g(h,q.outlineColor,(w-p)/(u-p)):w<v?[x[0],x[1],x[2],x[3]]=q.outlineColor:w<z?g(q.outlineColor,q.fillColor,(w-v)/(z-v)):[x[4*C],x[4*C+1],x[4*C+2],x[4*C+3]]=q.fillColor,t[4*C]=255*x[0],t[4*C+1]=255*x[1],t[4*C+2]=255*x[2],t[4*C+3]=255*x[3];this.minMaxDistance[0]=p;this.minMaxDistance[1]=z;this.shadeTexChanged=!0};r.applyHighlightOptions=function(p,
g){this.shadeTex||(this.shadeTex=new A(p,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,f.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);p.bindTexture(this.shadeTex,D.TEXTURE_BINDING_HIGHLIGHT_1);g.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};r.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return m}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],
function(y){y.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];y.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0};y.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];y.SHADE_TEXTURE_SIZE=256;y.SIGMAS=[void 0,void 0,void 0,1];Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/programUtils ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./parameters ../../shaders/HighlightPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){return function(){function l(){this._height=this._width=void 0;this._resources=null}var h=l.prototype;h.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};h.preBlur=function(m,r){m.bindTexture(r,y.TEXTURE_BINDING_HIGHLIGHT_0);m.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);m.bindVAO(this._resources.quadVAO);m.drawArrays(5,0,4);m.bindVAO()};h.finalBlur=function(m,r){m.bindTexture(r,y.TEXTURE_BINDING_HIGHLIGHT_0);m.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
m.bindVAO(this._resources.quadVAO);m.drawArrays(5,0,4);m.bindVAO()};h.renderHighlight=function(m,r,p){m.bindTexture(r,y.TEXTURE_BINDING_HIGHLIGHT_0);m.bindProgram(this._resources.highlightProgram);p.applyHighlightOptions(m,this._resources.highlightProgram);m.bindVAO(this._resources.quadVAO);m.setBlendingEnabled(!0);m.setBlendFunction(1,771);m.drawArrays(5,0,4);m.bindVAO()};h._initialize=function(m,r,p){this._width=r;this._height=p;r=E.createVertex(m,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,
1,1,1,1,1])).buffer);p=new A(m,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:r});const g=b.createProgram(m,n.highlight);m=b.createProgram(m,n.blur);g.setUniform1i("u_texture",y.TEXTURE_BINDING_HIGHLIGHT_0);g.setUniform1i("u_shade",y.TEXTURE_BINDING_HIGHLIGHT_1);g.setUniform4fv("u_sigmas",f.SIGMAS);m.setUniform1i("u_texture",y.TEXTURE_BINDING_HIGHLIGHT_0);
m.setUniform4fv("u_sigmas",f.SIGMAS);this._resources={quadGeometry:r,quadVAO:p,highlightProgram:g,blurProgram:m}};h.setup=function(m,r,p){this._resources?(this._width=r,this._height=p):this._initialize(m,r,p)};return l}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(y,D){const E={shaders:{vertexShader:D.resolveIncludes("highlight/textured.vert"),fragmentShader:D.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};D={shaders:{vertexShader:D.resolveIncludes("highlight/textured.vert"),fragmentShader:D.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}};y.blur=D;y.highlight=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler".split(" "),
function(y,D,E,B,A,k,c,b,e,a){function d(f,n,l){n=new B(f,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:n,height:l,samplingMode:9729});f=new c(f,{colorTarget:0,depthStencilTarget:2},n);return[n,f]}return function(){function f(){this._height=this._width=void 0;this._resources=null}var n=f.prototype;n.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};n._initialize=function(l,h,m){this._width=h;this._height=m;const [r,p]=d(l,h,m),[g,q]=d(l,h,m);this._resources={sharedBlur1Tex:r,sharedBlur1Fbo:p,sharedBlur2Tex:g,sharedBlur2Fbo:q}};n.setup=function(l,h,m){!this._resources||this._width===h&&this._height===m||this.dispose();this._resources||this._initialize(l,h,m)};y._createClass(f,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},
{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return f}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./Effect"],function(y,D,E,B,A){A=function(k){function c(){var e=k.apply(this,arguments)||this;e.name=e.constructor.name;e.defines=["id"];e._lastSize=0;return e}
D._inheritsLoose(c,k);var b=c.prototype;b.dispose=function(){E.isSome(this._fbo)&&this._fbo.dispose()};b.bind=function({context:e,painter:a}){const {width:d,height:f}=e.getViewport();a=a.getFbos(d,f).effect0;e.bindFramebuffer(a);e.setColorMask(!0,!0,!0,!0);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.draw=function({context:e,state:a,pixelRatio:d},f,n=B.HITTEST_SEARCH_SIZE){const l=e.getBoundFramebufferObject(),h=a.size[1]*d,m=Math.round(n*d),r=m/2,p=m/2;this._ensureBuffer(m);
f.forEach((g,q)=>{var u=new Map;l.readPixels(Math.floor(q[0]*d-m/2),Math.floor(h-q[1]*d-m/2),m,m,6408,5121,this._buf);for(let t=0;t<this._buf32.length;t++){const w=this._buf32[t];if(4294967295!==w&&0!==w){var v=t%m,z=m-Math.floor(t/m);v=(r-v)*(r-v)+(p-z)*(p-z);z=u.has(w)?u.get(w):4294967295;u.set(w,Math.min(v,z))}}u=Array.from(u).sort((t,w)=>t[1]-w[1]).map(t=>t[0]);g.resolve(u);f.delete(q)})};b._ensureBuffer=function(e){this._lastSize!==e&&(this._lastSize=e,this._buf=new Uint8Array(4*e*e),this._buf32=
new Uint32Array(this._buf.buffer))};return c}(A.Effect);y.HittestEffect=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define(["require","exports"],function(y,D){const E={colorize:async()=>new (await new Promise(function(A,k){y(["./Colorize"],A,k)})).Colorize,blur:async()=>new (await new Promise(function(A,k){y(["./Blur"],A,k)})).Blur,bloom:async()=>new (await new Promise(function(A,k){y(["./Bloom"],A,k)})).Bloom,
opacity:async()=>new (await new Promise(function(A,k){y(["./Opacity"],A,k)})).Opacity,"drop-shadow":async()=>new (await new Promise(function(A,k){y(["./DropShadow"],A,k)})).DropShadow};let B=function(){function A(c){this._requestRender=c;this._effectMap=new Map;this._effectPromiseMap=new Map}var k=A.prototype;k.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(c=>c.dispose());this._effectMap.clear();this._effectPromiseMap.clear()};k.getPostProcessingEffects=
function(c){if(!c||0===c.length)return[];const b=[];for(const e of c){a:switch(c=e.type,c){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:c="colorize"}const a=this._effectMap.get(c);a?b.push({postProcessingEffect:a,effect:e}):this._enablePostProcessingEffect(c)}return b};k._enablePostProcessingEffect=async function(c){const b=await this._loadPostProcessingEffect(c);this._requestRender&&(this._effectMap.set(c,b),this._requestRender.requestRender())};k._loadPostProcessingEffect=
async function(c){this._effectPromiseMap.has(c)||this._effectPromiseMap.set(c,E[c]());return this._effectPromiseMap.get(c)};return A}();D.EffectManager=B;Object.defineProperty(D,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/has","../../../../../core/maybe","../../../../../core/arrayUtils","../enums"],function(y,D,E,B){return function(){function A(c,b){var e;this.brushes=c;this.name=b.name;this.drawPhase=b.drawPhase||B.WGLDrawPhase.MAP;
this._targetFn=b.target;this.effects=b.effects||[];this.enableDefaultDraw=null!=(e=b.enableDefaultDraw)?e:()=>!0;this.has=b.has}var k=A.prototype;k.render=function(c){const {context:b,profiler:e}=c,a=this._targetFn();var d=this.drawPhase&c.drawPhase;e.recordPassStart(this.name);if(d&&(!this.has||y(this.has))){this.enableDefaultDraw()&&this._doRender(c,a);e.recordPassEnd();for(const f of this.effects){if(!f.enable())continue;d=f.apply;e.recordPassStart(this.name+"."+d.name);e.recordBrushStart(d.name);
const n=f.args&&f.args(),{x:l,y:h,width:m,height:r}=b.getViewport(),p=b.getBoundFramebufferObject();d.bind(c,n);this._doRender(c,a,d.defines);d.draw(c,n);d.unbind(c,n);b.bindFramebuffer(p);b.setViewport(l,h,m,r);e.recordBrushEnd();e.recordPassEnd()}}};k._doRender=function(c,b,e){if(!D.isNone(b))if(E.isArrayLike(b))for(const a of b){if(a.visible)for(const d of this.brushes)c.profiler.recordBrushStart(d.name),d.prepareState(c,a,e),d.draw(c,a,e),c.profiler.recordBrushEnd()}else for(const a of this.brushes)c.profiler.recordBrushStart(a.name),
a.prepareState(c,b,e),a.draw(c,b,e),c.profiler.recordBrushEnd()};return A}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/Evented ../../../../core/CircularArray ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(y,D,E,B,A,k,c){const b=E("esri-2d-profiler");E=function(){function e(d,f){this._events=new A;this._entries=new Map;this._timings=new k(10);if(b){this._ext=
c.createDisjointTimerQuery(d.gl,{});this._debugOutput=f;var n=d.gl;if(this.enableCommandLogging)for(const l in n)if("function"===typeof n[l]){const h=n[l],m=-1!==l.indexOf("draw");n[l]=(...r)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:l,args:r,isDrawCommand:m});this._currentSummary&&(this._currentSummary.commands++,m&&this._currentSummary.drawCommands++);return h.apply(n,r)}}}}var a=e.prototype;a.recordContainerStart=function(d){b&&
(this._currentContainer=d)};a.recordContainerEnd=function(){b&&(this._currentContainer=null)};a.recordPassStart=function(d){b&&(this._currentPass=d,this._initSummary())};a.recordPassEnd=function(){b&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(d){b&&(this._currentBrush=d)};a.recordBrushEnd=function(){b&&(this._currentBrush=null)};a.recordStart=function(d){if(b&&B.isSome(this._ext)){if(this._entries.has(d)){const m=this._entries.get(d);var f=this._ext.resultAvailable(m.query),
n=this._ext.disjoint();if(f&&!n){f=this._ext.getResult(m.query)/1E6;n=0;if(B.isSome(this._timings.enqueue(f))){n=this._timings.entries;const r=n.length;let p=0;for(var l of n)p+=l;n=p/r}l=f.toFixed(2);f=n?n.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${d}, ${l} ms (${f} last 10 avg)
${m.commandsLen} Commands (${m.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(m.summaries),console.log("Commands: ",m.commands),console.groupEnd()):console.log(`Frame report for ${d}, ${l} ms (${f} last 10 avg)`);this._debugOutput.innerHTML=`${l} (${f})`}for(const r of m.handles)r.remove();this._entries.delete(d)}const h={name:d,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(h.handles.push(this._events.on("command",
m=>{h.commandsLen++;h.commands.push(m);m.isDrawCommand&&h.drawCommands++})),h.handles.push(this._events.on("summary",m=>{h.summaries.push(m)})));this._ext.beginTimeElapsed(h.query);this._entries.set(d,h)}};a.recordEnd=function(d){b&&B.isSome(this._ext)&&this._entries.has(d)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&
this._events.emit("summary",this._currentSummary)};D._createClass(e,[{key:"enableCommandLogging",get:function(){return!("object"===typeof b&&b.disableCommands)}}]);return e}();y.Profiler=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(y,D){return function(){function E(A=Number.POSITIVE_INFINITY){this._start=this.size=0;this.maxSize=A;this._buffer=isFinite(A)?Array(A):[]}var B=E.prototype;B.enqueue=
function(A){if(this.size===this.maxSize){const k=this._buffer[this._start];this._buffer[this._start]=A;this._start=(this._start+1)%this.maxSize;return k}isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=A:this._buffer[this._start+this.size++]=A;return null};B.dequeue=function(){if(0===this.size)return null;const A=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return A};B.peek=function(){return 0===this.size?
null:this._buffer[this._start]};B.find=function(A){if(0===this.size)return null;for(const k of this._buffer)if(D.isSome(k)&&A(k))return k;return null};B.clear=function(A){let k=this.dequeue();for(;D.isSome(k);)A&&A(k),k=this.dequeue()};y._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/testSVGPremultipliedAlpha ./VertexStream".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h){const m=B.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest");let r=function(){function g(q){this.svgAlwaysPremultipliesAlpha=!1;this._ignoresSamplerPrecision=null;this._context=q;l.testSVGPremultipliedAlpha(q).then(u=>{this.svgAlwaysPremultipliesAlpha=!u})}D._createClass(g,[{key:"ignoresSamplerPrecision",get:function(){E.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=p(this._context));return this._ignoresSamplerPrecision}}]);return g}();
const p=g=>{var q=new a(g,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const u=new Uint8Array(4),v=new h(g,[0,0,1,0,0,1,1,1]),z=new A(g,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0});var t=new c(g,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));z.setUniform1i("u_texture",0);g.bindTexture(t,0);t=g.getBoundFramebufferObject();g.bindFramebuffer(q);g.bindProgram(z);const {x:w,y:x,width:C,height:F}=g.getViewport();g.setViewport(0,0,1,1);v.draw();g.setViewport(w,x,C,F);q.readPixels(0,0,1,1,6408,
5121,u);z.dispose();v.dispose();q.dispose();(q=255!==u[0]||255!==u[1]||255!==u[2]||255!==u[3])&&m.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${u[0]}.${u[1]}.${u[2]}.${u[3]}]`);g.bindFramebuffer(t);return q};y.testSamplerPrecision=p;y.testWebGLDriver=
g=>new r(g);Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ./Program ./BufferObject ./Texture ./VertexArrayObject ./Renderbuffer ./FramebufferObject ./ProgramCache ./RenderingContext ./ShaderCompiler".split(" "),function(y,D,E,B,A,k,c,b,e,a){y.testSVGPremultipliedAlpha=async function(d){const f=new Image;f.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
f.width=5;f.height=5;await f.decode();if(!d.gl)return!0;const n=new c(d,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),l=E.createVertex(d,35044,new Uint16Array([0,0,1,0,0,1,1,1])),h=new A(d,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:l}),m=new D(d,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",{a_pos:0});d.bindProgram(m);const r=new B(d,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},f);d.bindTexture(r,0);m.setUniform1i("u_texture",0);const p=d.getBoundFramebufferObject(),{x:g,y:q,width:u,height:v}=d.getViewport();d.bindFramebuffer(n);d.setViewport(0,0,1,1);d.bindVAO(h);d.drawArrays(5,0,
4);const z=new Uint8Array(4);n.readPixels(0,0,1,1,6408,5121,z);m.dispose();h.dispose(!1);l.dispose();n.dispose();r.dispose();d.setViewport(g,q,u,v);d.bindFramebuffer(p);f.src="";return 255===z[0]};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/BufferDataPool":function(){define("exports ../../../../../core/has ../../../../../core/maybe ../../../../../core/CircularArray ./DisplayRecordReader ./BufferData".split(" "),function(y,D,E,B,A,k){D=function(){function c(){this._pools=
new Map}var b=c.prototype;b.acquire=function(e,a,d=0){var f=A.DisplayRecordReader.from(e.records,d);d=f.size();f.next();const n=f.vertexCount;f=f.indexCount;const l=this._tryAcquire(e.stride,a,n,f);return k.BufferData.createPooled(l,e,a,n,f,d,this)};b.release=function(e){e.isReleased||e.destroy()};b.destroy=function(){this._pools.forEach(e=>{E.isSome(e)&&e.clear(a=>a.destroy())})};b._tryAcquire=function(e,a,d,f){e=this._pools.get(e<<3|a);if(E.isNone(e))return null;e=e.dequeue();return E.isSome(e)&&
e.vertexBufferSize>=d&&e.indexBufferSize>=f?e:null};return c}();y.BufferDataPool=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(y,D,E,B){let A=function(){function c(e){this._cursor=this._head=e}c.from=function(e,a=0,d=e.byteLength/k.BYTES_PER_RECORD-a){e=new k(new Int32Array(e,a*k.BYTES_PER_RECORD,d*
k.ELEMENTS_PER_RECORD));return new c(e)};var b=c.prototype;b.size=function(){var e,a;return null!=(e=null==(a=this._cursor)?void 0:a.size())?e:0};b.link=function(e){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=e._head}else this._head=e._head};b.getCursor=function(){return this.copy()};b.lookup=function(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};b.copy=function(){var e;
const a=new c(null==(e=this._head)?void 0:e.copy());if(!a._head)return a;e=a._head;let d=a._head._link;for(;d;)e._link=d.copy(),e=d,d=e._link;return a};b.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};b.peekId=function(){var e;return null!=(e=this._cursor.peekId())?e:this._cursor._link.peekId()};b.delete=function(e){let a=this._head,d=null;for(;a;){if(a.delete(e))return a.isEmpty()&&(E.isSome(d)&&
(d._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;d=a;a=a._link}return!1};D._createClass(c,[{key:"id",get:function(){return this._cursor.id},set:function(e){this._cursor.id=e}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(e){this._cursor.materialKey=e}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(e){this._cursor.indexFrom=
e}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(e){this._cursor.indexCount=e}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(e){this._cursor.vertexFrom=e}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(e){this._cursor.vertexCount=e}},{key:"index",get:function(){return this._cursor._index}}]);return c}();A.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;A.BYTES_PER_RECORD=A.ELEMENTS_PER_RECORD*
Int32Array.BYTES_PER_ELEMENT;let k=function(){function c(e){this._link=null;this._index=-1;this._deletedCount=0;this._offsets={instance:null};this._packedRecords=e}c.from=function(e,a=0,d=e.byteLength/this.BYTES_PER_RECORD-a){return new c(new Int32Array(e,a*this.BYTES_PER_RECORD,d*this.ELEMENTS_PER_RECORD))};var b=c.prototype;b.delete=function(e){const a=this._index,d=this.lookup(e);if(d)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===e;)this.id=2147483647,++this._deletedCount;
this._index=a;return d};b.isEmpty=function(){return this._deletedCount===this.size()};b.link=function(e){this._link?this._link.link(e):this._link=e};b.lookup=function(e){if(E.isNone(this._offsets.instance)){this._offsets.instance=new Map;var a=this.copy();a._index=-1;let d=0;for(;a.next();)a.id!==d&&(this._offsets.instance.set(a.id,a._index),d=a.id)}if(!this._offsets.instance.has(e))return!1;a=this._index;this._index=this._offsets.instance.get(e);return 2147483647===this.id?(this._index=a,!1):!0};
b.size=function(){return this._packedRecords.length/c.ELEMENTS_PER_RECORD};b.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};b.peekId=function(){const e=(this._index+1)*c.ELEMENTS_PER_RECORD;return e>=this._packedRecords.length?0:this._packedRecords[e]};b.getCursor=function(){return this.copy()};b.copy=function(){const e=new c(this._packedRecords);e._link=this._link;e._index=this._index;e._offsets=this._offsets;e._deletedCount=this._deletedCount;
return e};D._createClass(c,[{key:"id",get:function(){return this._packedRecords[this._index*c.ELEMENTS_PER_RECORD]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD]=e}},{key:"materialKey",get:function(){return this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+1]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+1]=e}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*
c.ELEMENTS_PER_RECORD+3]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+3]=e}},{key:"indexCount",get:function(){return this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+4]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+4]=e}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+5]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+5]=e}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*
c.ELEMENTS_PER_RECORD+6]},set:function(e){this._packedRecords[this._index*c.ELEMENTS_PER_RECORD+6]=e}},{key:"index",get:function(){return this._index}}]);return c}();k.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;k.BYTES_PER_RECORD=k.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;y.DisplayRecordReader=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/BufferData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../definitions ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../FeatureDisplayList ./Buffer ./DisplayRecordReader ../mesh/heuristics".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p){E=function(){function g(u,v,z,t,w){this._vaoInvalidated=!0;const x=p.getMeshHeuristic(v),C=Math.max(x.verticesPerRecord*x.multiplier*z,t+1);t=u/Uint32Array.BYTES_PER_ELEMENT;z=new m.Buffer("index",Math.max(x.indicesPerRecord*x.multiplier*z,w+1),1);w={geometry:new m.Buffer("vertex",C,t)};this.stride=u;this.strideInt=t;this.geometryType=v;this._buffers={index:z,vertex:w}}g.createPooled=function(u,v,z,t,w,x,C){const F=Math.max(A.BUFFER_DATA_MINIMUM_SIZE,
Math.round(1.5*x));u=B.unwrapOr(u,()=>new g(v.stride,z,F,t,w));u._buffers.index.clear();u._buffers.vertex.geometry.clear();u._records=null;u._displayList=null;u._vaoInvalidated=!0;u._pool=C;u._released=!1;return u};var q=g.prototype;q.release=function(){this.isReleased||(this._pool.release(this),this._released=!0)};q.destroy=function(){this._buffers.index.destroy();this._buffers.vertex.geometry.destroy();B.andThen(this._vao,u=>u.dispose(!1))};q.draw=function(u,v,z,t,w){this.upload(u);v=this._getVAO(u,
v,z);t*=Uint32Array.BYTES_PER_ELEMENT;u.bindVAO(v);u.drawElements(4,w,5125,t);u.bindVAO(null)};q.insert=function(u){if(!u.done){var {vertexData:v,offset:z}=u,{records:t,indices:w,vertices:x}=v,C=this._getInsertionInfo(r.DisplayRecordReader.from(t,z)),{vertFrom:F,vertCount:H,indexFrom:J,indexCount:K,recordCount:N,done:R}=C;u.done=R;u.offset=N+z;if(0!==N){var {index:I,vertex:L}=this._buffers;u=L.geometry.insert(x,F,H,0);C=I.insert(w,J,K,u);this._addRecords(r.DisplayRecordReader.from(t,z,N),C,u)}}};
q.free=function(u){for(u=r.DisplayRecordReader.from(u.records).getCursor();u.next();)this._freeId(u.id)};q.freeIds=function(u){for(const v of u)this._freeId(v)};q.upload=function(u){const {index:v,vertex:z}=this._buffers;v.upload(u);z.geometry.upload(u)};q.has=function(u){if(!this._records)return!1;const v=this._records.getCursor();for(;v.next();)if(v.id===u)return!0;return!1};q.getViewOf=function(u){if(!this._records)return null;const v=this._records.getCursor();for(;v.next();)if(v.id===u)return v;
return null};q._getInsertionInfo=function(u){u=u.getCursor();const {index:v,vertex:z}=this._buffers,t=v.maxAvailableSpace(),w=z.geometry.maxAvailableSpace();let x=0,C=null,F=0,H=null,J=0,K=!0;for(;u.next();){null===H&&(H=u.vertexFrom,C=u.indexFrom);const N=J+u.vertexCount,R=F+u.indexCount;if(N>=w||R>=t){K=!1;break}x+=1;F=R;J=N}return{done:K,vertFrom:H,vertCount:J,indexFrom:C,indexCount:F,recordCount:x}};q._addRecords=function(u,v,z){const t=u.getCursor();for(;t.next();)t.indexFrom+=v,t.vertexFrom+=
z;this._records?(this._records.link(u),this._displayList=null):this._records=u};q._freeId=function(u){const v=this._records.getCursor(),z=this._buffers.index,t=this._buffers.vertex.geometry;if(v.lookup(u)){for(var w=v.indexFrom,x=v.indexCount,C=v.vertexFrom,F=v.vertexCount;v.next()&&v.id===u;)x+=v.indexCount,F+=v.vertexCount;z.free(w,x);t.free(C,F,!0);this._records.delete(u)}};q._getVAO=function(u,v,z){if(this._vaoInvalidated){const t=JSON.stringify(v)+JSON.stringify(z);t!==this._vaoHash&&(B.andThen(this._vao,
w=>{w.dispose(!1)}),this._vao=null,this._vaoHash=t);this._vaoInvalidated=!1}if(B.isNone(this._vao)){const {index:t,vertex:w}=this._buffers;if(B.isNone(w.geometry.gpu)||B.isNone(t.gpu))throw Error("bad news");this._vao=new e(u,z,v,{geometry:w.geometry.gpu},t.gpu)}return this._vao};D._createClass(g,[{key:"isReleased",get:function(){return this._released}},{key:"indexBufferSize",get:function(){return this._buffers.index.bufferSize}},{key:"vertexBufferSize",get:function(){return this._buffers.vertex.geometry.bufferSize}},
{key:"displayList",get:function(){B.isNone(this._displayList)&&(this._displayList=h.FeatureDisplayList.from(this,this._records.getCursor()));return this._displayList}}]);return g}();y.BufferData=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/FeatureDisplayList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(y,D){let E=function(){function A(c,b,e,a,d){this.target=c;this.geometryType=b;this.materialKey=e;this.indexFrom=a;this.indexCount=
d}var k=A.prototype;k.extend=function(c){this.indexCount+=c};k.draw=function(c,b,e){this.target.draw(c,b,e,this.indexFrom,this.indexCount)};D._createClass(A,[{key:"indexEnd",get:function(){return this.indexFrom+this.indexCount}}]);return A}(),B=function(){function A(c){this._infos=[];this._target=c}A.from=function(c,b){for(c=new A(c);b.next();)c.add(b);return c};var k=A.prototype;k.add=function(c){const {materialKey:b,indexFrom:e,indexCount:a}=c;this._infos.length&&c.materialKey===this._last.materialKey&&
c.indexFrom===this._last.indexEnd?this._last.extend(a):(c=new E(this._target,this.geometryType,b,e,a),this._infos.push(c))};k.forEach=function(c){for(const b of this._infos)c(b)};D._createClass(A,[{key:"_last",get:function(){return this._infos[this._infos.length-1]}}]);return A}();y.FeatureDisplayList=B;y.FeatureDisplayListInfo=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/Buffer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./FreeList".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){B=function(){function l(m,r,p){r=new Uint32Array(r*p);this.strideInt=p;this.bufferType=m;this.dirty={start:Infinity,end:0};this.cpu=r;this.gpu=null;this.clear()}var h=l.prototype;h.destroy=function(){E.andThen(this.gpu,m=>m.dispose())};h.clear=function(){this.dirty.start=Infinity;this.dirty.end=0;this.freeList=new n.FreeList({start:0,end:this.cpu.length/this.strideInt});this.fillPointer=0};h.maxAvailableSpace=function(){return this.freeList.maxAvailableSpace()};
h.insert=function(m,r,p,g){var q=p*this.strideInt;m=new Uint32Array(m,r*this.strideInt*Uint32Array.BYTES_PER_ELEMENT,q);var u=E.unwrapOrThrow(this.freeList.firstFit(p),"First fit region must be defined");p=u*this.strideInt;q*=this.strideInt;r=u-r;if(0!==g)for(u=0;u<m.length;u++)m[u]+=g;this.cpu.set(m,p);this.dirty.start=Math.min(this.dirty.start,p);this.dirty.end=Math.max(this.dirty.end,p+q);this.fillPointer=Math.max(this.fillPointer,p+q);return r};h.free=function(m,r,p){const g=m*this.strideInt,
q=(m+r)*this.strideInt;if(!0===p)for(p=m;p!==m+r;p++)this.cpu[p*this.strideInt]=2147450879;this.dirty.start=Math.min(this.dirty.start,g);this.dirty.end=Math.max(this.dirty.end,q);this.freeList.free(m,r)};h.upload=function(m){this.dirty.end&&(E.isNone(this.gpu)?this.gpu=this._createBuffer(m):this.gpu.setSubData(this.cpu,this.dirty.start,this.dirty.start,this.dirty.end),this.dirty.start=Infinity,this.dirty.end=0)};h._createBuffer=function(m){return"index"===this.bufferType?A.createIndex(m,35048,this.cpu):
A.createVertex(m,35048,this.cpu)};D._createClass(l,[{key:"bufferSize",get:function(){return this.cpu.length/this.strideInt}}]);return l}();y.Buffer=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/FreeList":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],function(y,D,E){let B=function(){function k(b){if(Array.isArray(b)){this.data=b[0];var e=this;for(let a=1;a<b.length;a++)e.next=new k([b[a]]),e=
e.next}else this.data=b}var c=k.prototype;c.find=function(b){var e;return b(this.data)?this:null==(e=this.next)?void 0:e.find(b)};c.max=function(b,e=this){e=b(this.data)>b(e.data)?this:e;return this.next?this.next.max(b,e):e};c.remove=function(b,e=null){return this===b?e?(e.next=this.next,e):this.next:this.next.remove(b,this)};D._createClass(k,[{key:"last",get:function(){return this.next?this.next.last:this}}]);return k}(),A=function(){function k(b){this._head=null;E.isNone(b)||(this._head=new B(b))}
var c=k.prototype;c.maxAvailableSpace=function(){if(E.isNone(this._head))return 0;const b=this._head.max(e=>e.end-e.start);return b.data.end-b.data.start};c.firstFit=function(b){if(E.isNone(this._head))return null;var e=null;let a=this._head;for(;a;){const d=a.data.end-a.data.start;if(d===b)return e?e.next=a.next:this._head=a.next,a.data.start;if(d>b)return e=a.data.start,a.data.start+=b,e;e=a;a=a.next}return null};c.free=function(b,e){const a=b+e;if(E.isNone(this._head))this._head=new B({start:b,
end:a});else if(a<=this._head.data.start)if(a===this._head.data.start)this._head.data.start-=e;else{var d=new B({start:b,end:a});d.next=this._head;this._head=d}else{d=this._head;for(var f=d.next;f;){if(f.data.start>=a){if(d.data.end===b){d.data.end+=e;return}if(f.data.start===a){f.data.start-=e;return}b=new B({start:b,end:a});b.next=d.next;d.next=b;return}d=f;f=f.next}b===d.data.end?d.data.end+=e:(b=new B({start:b,end:a}),d.next=b)}};D._createClass(k,[{key:"head",get:function(){return this._head}}]);
return k}();y.FreeList=A;y.List=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(y,D,E){const B=new Map;B.set(E.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});B.set(E.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});B.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});B.set(E.WGLGeometryType.TEXT,
{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});B.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});y.getMeshHeuristic=function(A){return B.get(A)};y.getMeshSizeHint=function(A,k,c){const {indicesPerRecord:b,multiplier:e,verticesPerRecord:a}=B.get(A);return{recordBytes:c*D.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:e*b*c*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:e*a*c*k}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports",
"./sources/resolver"],function(y,D){D={shaders:{vertexShader:D.resolveIncludes("stencil/stencil.vert"),fragmentShader:D.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}};y.stencil=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/promiseUtils ../../../../core/Accessor ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/SpatialReference ../../../../geometry/support/coordsUtils ../../../../geometry/Polygon ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../geometry/support/aaBoundingRect ../../../../symbols/support/defaults ../../../../core/HandleOwner ../../engine/webgl/definitions ../../../webgl/capabilities ../../../../geometry/support/normalizeUtilsSync ../../engine/webgl/util/BidiText ../../../../symbols/cim/cimSymbolUtils ../../../../layers/graphics/data/projectionSupport ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../features/support/AttributeStore ../../engine/webgl/mesh/MeshData ./graphicsUtils ../features/schemaUtils ../../engine/webgl/mesh/factories/matcherUtils ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/mesh/factories/WGLMeshFactory ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ../features/support/TileStore ./GraphicStore ../../../layers/GraphicsView".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z,t,w,x,C,F,H,J,K,N,R,I,L,G,M,P,T,Y,Z,ca,ia){function da(ja,la,fa){if(fa.has(ja))return fa.get(ja);la={tile:la,addedOrModified:[],removed:[]};fa.set(ja,la);return la}E=function(ja){function la(Q){Q=ja.call(this,Q)||this;Q._storage=new T.ComputedAttributeStorage;Q._displayIds=new Map;Q._tiles=new Map;Q._graphicStoreUpdate=!1;Q._graphicsSet=new Set;Q._matcher=Promise.resolve(null);Q._tileUpdateSet=new Set;Q._tilesToUpdate=new Map;Q._graphicIdToAbortController=
new Map;Q._attached=!1;Q._highlightIds=new Map;Q._updatingGraphicsTimer=null;Q._hashToExpandedSymbol=new Map;Q._hashTpExpandedSymbolPromise=new Map;Q._processing=!1;Q._needsProcessing=!1;Q._pendingUpdate={added:new Set,updated:new Set,removed:new Set};Q.lastUpdateId=-1;Q.updateRequested=!1;Q.graphicUpdateHandler=Q.graphicUpdateHandler.bind(y._assertThisInitialized(Q));return Q}y._inheritsLoose(la,ja);var fa=la.prototype;fa._createMatcher=function(Q,V){Q&&(Q=L.createMatcherSchema({indexCount:0,fields:{}},
"feature",Q),this._matcher=G.createMatcher(Q,V,null))};fa._createDisplayId=function(Q){this._displayIds.has(Q)||this._displayIds.set(Q,this._storage.createDisplayId());return this._displayIds.get(Q)};fa.initialize=function(){this._tileStore=new Z(this.view.featuresTilingScheme);this._attributeStore=new N["default"]({type:"local",initialize:V=>Promise.resolve(this.container.attributeView.initialize(V)),update:V=>this.container.attributeView.requestUpdate(V),render:()=>this.container.requestRender()},
w());this._graphicStore=new ca(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,V=>{this._createDisplayId(V.uid);this._setFilterState(V.uid,V.visible)},V=>{const O=this._displayIds.get(V.uid);this._displayIds.delete(V.uid);this._storage.releaseDisplayId(O)});const Q=new M.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._createMatcher(this.renderer,Q);this._meshFactory=new P.WGLMeshFactory(null,this.uid,Q);this._templateStore=Q;this.watch("renderer",
V=>{this._createMatcher(V,Q);for(const O of this.graphics)this._pendingUpdate.updated.add(O);this.requestUpdate()});this._tileStore.on("update",this._onTileUpdate.bind(this));this.container.on("attach",()=>{0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",V=>this._graphicsChangeHandler(V)),"graphics");this._attached=!0;this.notifyChange("updating")})};fa.destroy=function(){this._updatingGraphicsTimer&&
(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._tileStore.destroy();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null};fa.hitTest=function(Q,V){if(!this.view||!this.view.position)return Promise.resolve(null);Q=this.view.toMap(q.createScreenPoint(Q,V));return this.searchFeatures(Q).then(O=>O&&O.length?O[0]:null)};fa.searchFeatures=
async function(Q,V=2){return this._graphicStore.hitTest(Q.x,Q.y,V,this.view.state.resolution,this.view.state.rotation)};fa.update=function(Q){Q=Q.state;const V=this.view.featuresTilingScheme.getClosestInfoForScale(Q.scale).level;this._graphicStore.updateLevel(V);this._tileStore.setViewState(Q);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};fa.viewChange=function(){this.requestUpdate()};fa.requestUpdate=
function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};fa.processUpdate=function(Q){this.updateRequested&&(this.updateRequested=!1,this.update(Q))};fa.graphicUpdateHandler=function(Q){const {graphic:V,property:O,newValue:U}=Q;switch(O){case "geometry":case "symbol":this._pendingUpdate.updated.add(V);this.requestUpdate();break;case "visible":this._setFilterState(V.uid,U),this._attributeStore.sendUpdates()}};fa.addHighlight=function(Q){for(const V of Q)this._highlightIds.has(V)?
(Q=this._highlightIds.get(V),this._highlightIds.set(V,Q+1)):this._highlightIds.set(V,1);this._updateHighlight()};fa.removeHighlight=function(Q){for(const V of Q)this._highlightIds.has(V)&&(Q=this._highlightIds.get(V)-1,0===Q?this._highlightIds.delete(V):this._highlightIds.set(V,Q));this._updateHighlight()};fa._updateHighlight=function(){const Q=Array.from(this._highlightIds.keys()),V=Q.map(O=>this._displayIds.get(O));this._attributeStore.setHighlight(Q,V)};fa._getIntersectingTiles=function(Q){Q=this._graphicStore.getBounds(Q);
if(!Q||0===u.width(Q)||0===u.height(Q))return[];const V=I.intersectingInternationalDateline(Q,this.view.spatialReference);return B.isSome(V)?[...this._tileStore.boundsIntersections(V[0]),...this._tileStore.boundsIntersections(V[1])]:this._tileStore.boundsIntersections(Q)};fa._updateTile=async function(Q){const V=Q.tile;var O=this._getGraphicsData(this._templateStore,V,Q.addedOrModified);O=await this._processGraphics(V,O);this._patchTile(V.key,{type:"update",addOrUpdate:O,remove:Q.removed,end:!0,clear:!1});
return O};fa._patchTile=function(Q,V){this._tiles.has(Q)&&(Q=this._tiles.get(Q),this.container.onTileData(Q,V),this.container.requestRender())};fa._graphicsChangeHandler=function(Q){for(const V of Q.added)this._pendingUpdate.added.add(V);for(const V of Q.moved)this._pendingUpdate.added.add(V);for(const V of Q.removed)this._pendingUpdate.added.has(V)?this._pendingUpdate.added.delete(V):this._pendingUpdate.removed.add(V);this._processing?this._needsProcessing=!0:this._updateGraphics()};fa._getGraphicsToUpdate=
function(){const Q={added:[],removed:[],updated:[]};if(!this.graphics)return Q;const V=this._pendingUpdate;for(const O of this.graphics.items)V.added.has(O)?Q.added.push(O):V.updated.has(O)&&Q.updated.push(O);for(const O of V.removed)this._graphicStore.has(O)&&Q.removed.push(O);V.added.clear();V.removed.clear();V.updated.clear();return Q};fa._updateGraphics=async function(){this._processing=!0;const {added:Q,removed:V,updated:O}=this._getGraphicsToUpdate(),U=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var W=
this.view.state,ba=this.view.featuresTilingScheme.getClosestInfoForScale(W.scale).level;this._graphicStore.updateLevel(ba);this._tileStore.setViewState(W)}W=[];const qa=Array(Q.length+V.length);for(ba=0;ba<O.length;ba++){var ea=O[ba];const ta=this._getIntersectingTiles(ea);for(const ua of ta){var ma=ua.id;da(ma,ua,U).removed.push(this._displayIds.get(ea.uid))}W.push(this._updateGraphic(ea,null));qa[ba]=ea}var oa=O.length;for(ea=0;ea<Q.length;ea++){const ta=Q[ea];qa[oa+ea]=ta;this._graphicsSet.add(ta);
W.push(this._addGraphic(ta))}for(const ta of V){this._abortProcessingGraphic(ta.uid);const ua=this._getIntersectingTiles(ta);for(const Aa of ua)ma=Aa.id,da(ma,Aa,U).removed.push(this._displayIds.get(ta.uid));this._graphicsSet.delete(ta);this._graphicStore.remove(ta)}this._flipUpdatingGraphics();await Promise.all(W);let va;for(oa=0;oa<qa.length;oa++){va=qa[oa];const ta=this._getIntersectingTiles(va);for(const ua of ta)ma=ua.id,da(ma,ua,U).addedOrModified.push(va)}this._graphicStore.updateZ();ma=[];
for(var [,pa]of U)ma.push(this._updateTile(pa));await Promise.all(ma)}catch(qa){}for(const qa of V)(pa=await this._getSymbolForGraphic(qa,{}))&&this._hashToExpandedSymbol.delete(pa.hash());U.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())};fa._getArcadeInfo=function(Q){const V=(Q.attributes?Object.keys(Q.attributes):[]).map(O=>({name:O,alias:O,type:"string"===typeof Q.attributes[O]?"esriFieldTypeString":"esriFieldTypeDouble"}));
return B.isNone(Q.geometry)?null:{geometryType:g.getJsonType(Q.geometry),spatialReference:m.fromJSON(Q.geometry.spatialReference),fields:V}};fa._getSymbolForGraphic=async function(Q,V){return B.isSome(Q.symbol)?Q.symbol:B.isSome(this.renderer)?this.renderer.getSymbolAsync(Q,{scale:this.view.scale,abortOptions:V}):this._getNullSymbol(Q)};fa._getSymbolResources=async function(Q,V){if(!this.container.stage)return Promise.resolve(null);var O=await this._getSymbolForGraphic(Q,V),U=O.hash();let W=this._hashToExpandedSymbol.get(U);
if(!W){let ba=this._hashTpExpandedSymbolPromise.get(U);if(ba)W=await ba;else{Q=this._getArcadeInfo(Q);O=L.createSymbolSchema(O);ba=F.expandSymbol(O,Q,V);this._hashTpExpandedSymbolPromise.set(U,ba);try{W=await ba,this._hashTpExpandedSymbolPromise.delete(U),this._hashToExpandedSymbol.set(U,W)}catch(ea){this._hashTpExpandedSymbolPromise.delete(U),n.throwIfAborted(ea)}}}if("esriTS"===W.type){V=[];[U]=C.bidiText(W.text);for(O=0;O<U.length;O++)V.push(U.charCodeAt(O));[{mosaicItem:V}]=await this.container.getMaterialItems([{symbol:W,
id:0,glyphIds:V}]);return{symbol:W,mosaicItem:V}}return{symbol:W,mosaicItem:null}};fa._projectAndNormalizeGeometry=async function(Q,V){if(B.isNone(Q.geometry)||"mesh"===Q.geometry.type)return Promise.resolve(null);var O=Q.geometry;g.isPolygon(O)?O.rings=O.rings:g.isPolyline(O)?O.paths=O.paths:g.isExtent(O)&&(Q=await this._getSymbolForGraphic(Q,V),O=I.isMarkerSymbol(Q.type)||I.isTextSymbol(Q.type)?O.center:p.fromExtent(O));await H.checkProjectionSupport(O.spatialReference,this.view.spatialReference);
Q=x.normalizeCentralMeridianSync(O);O=H.project(Q,O.spatialReference,this.view.spatialReference);r.closeRingsAndFixWinding(O);return O};fa._onTileUpdate=function(Q){const V=h.getInfo(this.view.spatialReference);if(Q.added&&0<Q.added.length)for(const O of Q.added)this._addNewTile(O,V);if(Q.removed&&0<Q.removed.length)for(const O of Q.removed)this._removeTile(O.key)};fa._addGraphic=async function(Q){this._abortProcessingGraphic(Q.uid);var V=n.createAbortController();this._graphicIdToAbortController.set(Q.uid,
V);V={signal:V.signal};try{await this._addOrUpdateGraphic(Q,V),this._graphicIdToAbortController.delete(Q.uid)}catch(O){if(this._graphicIdToAbortController.delete(Q.uid),!n.isAbortError(O))throw O;}};fa._updateGraphic=async function(Q,V){const O=this._projectAndNormalizeGeometry(Q,V);V=this._getSymbolResources(Q,V);const [U,W]=await Promise.all([O,V]);this._graphicStore.addOrModify(Q,W,U)};fa._addOrUpdateGraphic=async function(Q,V){const O=this._projectAndNormalizeGeometry(Q,V);V=this._getSymbolResources(Q,
V);try{const [U,W]=await Promise.all([O,V]);this._addProjectedGraphic(Q,W,U)}catch(U){if(!n.isAbortError(U))throw U;}};fa._addProjectedGraphic=function(Q,V,O){this._graphicsSet.has(Q)&&this._graphicStore.addOrModify(Q,V,O)};fa._addTile=function(Q){var V=this.view.featuresTilingScheme.getTileBounds(u.create(),Q);V=new J.GraphicTile(Q,V);this._tiles.set(Q,V);this.container.addChild(V);return V};fa._addNewTile=function(Q,V){const O=this._addTile(Q.key),U=this._graphicStore.queryTileData(this._templateStore,
Q);if(V){V=Math.round((V.valid[1]-V.valid[0])/Q.resolution);for(const ba of U)ba.geometry&&(g.isPoint(ba.geometry)||g.isMultipoint(ba.geometry))&&this._wrapPoints(ba,V)}const W=Q.key;this._tileUpdateSet.add(Q.key);this.notifyChange("updating");this._processGraphics(Q,U).then(ba=>{O.patch({type:"update",clear:!1,addOrUpdate:ba,remove:[],end:!0});this._tileUpdateSet.delete(W);this.notifyChange("updating")}).catch(ba=>{this._tileUpdateSet.delete(W);this.notifyChange("updating");if(!n.isAbortError(ba))throw ba;
})};fa._removeTile=function(Q){if(this._tiles.has(Q)){var V=this._tiles.get(Q);this.container.removeChild(V);V.destroy();this._tiles.delete(Q)}};fa._setFilterState=function(Q,V){const O=this._displayIds.get(Q);Q=this._attributeStore.getHighlightFlag(Q);this._attributeStore.setData(O,0,0,Q|(V?t.FILTER_FLAG_0:0))};fa._getGraphicsData=function(Q,V,O){const U=h.getInfo(this.view.spatialReference);Q=this._graphicStore.getGraphicsData(Q,V,O);if(U){V=Math.round((U.valid[1]-U.valid[0])/V.resolution);for(const W of Q)W.geometry&&
(g.isPoint(W.geometry)||g.isMultipoint(W.geometry))&&this._wrapPoints(W,V)}return Q};fa._wrapPoints=function(Q,V){const O=Q.geometry;g.isMultipoint(O)?this._wrapMultipoint(O,V):this._wrapPoint(Q,V)};fa._wrapMultipoint=function(Q,V){var O=Q.points;const U=[];let W=0,ba=0;for(const [ea,ma]of O)U.push([ea+W,ma]),W=0,V===I.TILE_SIZE?(O=5*I.PIXEL_BUFFER,ea+ba<O?(U.push([V,0]),W=-V):ea+ba>I.TILE_SIZE-O&&(U.push([-V,0]),W=V)):ea+ba<-I.PIXEL_BUFFER?(U.push([V,0]),W=-V):ea+ba>I.TILE_SIZE+I.PIXEL_BUFFER&&(U.push([-V,
0]),W=V),ba+=ea;Q.points=U};fa._wrapPoint=function(Q,V){const O=Q.geometry;if(V===I.TILE_SIZE){const U=5*I.PIXEL_BUFFER;O.x<U?Q.geometry={points:[[O.x,O.y],[V,0]]}:O.x>I.TILE_SIZE-U&&(Q.geometry={points:[[O.x,O.y],[-V,0]]})}else O.x<-I.PIXEL_BUFFER?Q.geometry={points:[[O.x,O.y],[V,0]]}:O.x>I.TILE_SIZE+I.PIXEL_BUFFER&&(Q.geometry={points:[[O.x,O.y],[-V,0]]})};fa._processGraphics=async function(Q,V,O){if(!V||!V.length||!this._meshFactory)return null;V=Y.GraphicsReader.from(V);const U=this._meshFactory,
W=await this._matcher;await U.analyzeGraphics(V,W,null,null,O);this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(Q,V)};fa._processAnalyzedGraphics=function(Q,V){const O=this._meshFactory;var U=V.getApproximateSize();V=V.getCursor();for(U=new R.MeshData(Q.key.id,{features:U,records:U,metrics:0},!1,!1,!1);V.next();){const W=V.readGraphic();W.insertAfter=-1===W.insertAfter?-1:this._displayIds.get(W.insertAfter);W.displayId=this._displayIds.get(W.attributes[this.uid]);O.writeGraphic(U,
V)}Q=U.serialize(Q.tileInfoView.tileInfo.isWrappable);return 1!==Q.length?new K.TileData:K.TileData.fromVertexData(Q[0].message)};fa._abortProcessingGraphic=function(Q){this._graphicIdToAbortController.has(Q)&&this._graphicIdToAbortController.get(Q).abort()};fa._getNullSymbol=function(Q){Q=Q.geometry;return g.isPolyline(Q)?v.errorPolylineSymbol2D:g.isPolygon(Q)||g.isExtent(Q)?v.errorPolygonSymbol2D:v.errorPointSymbol2D};fa._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);
this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};y._createClass(la,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);return la}(ia.GraphicsView(z.HandleOwnerMixin(l)));D.__decorate([c.property({constructOnly:!0})],E.prototype,"requestUpdateCallback",void 0);D.__decorate([c.property()],E.prototype,"container",
void 0);D.__decorate([c.property({constructOnly:!0})],E.prototype,"graphics",void 0);D.__decorate([c.property()],E.prototype,"updating",null);D.__decorate([c.property()],E.prototype,"view",void 0);D.__decorate([c.property()],E.prototype,"updateRequested",void 0);return E=D.__decorate([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],E)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ./spatialReferenceUtils ./intersects ./boundsUtils ./jsonUtils ./normalizeUtilsCommon ./aaBoundingRect".split(" "),
function(y,D,E,B,A,k,c){function b(r,p){const g=k.getGeometryParts(r);for(const q of g)for(const u of q)u[0]+=p;return r}function e(r,p){if(!p)return r;const g=d(r,p).map(q=>q.extent);return 2>g.length?g[0]||r:2<g.length?(r.xmin=p.valid[0],r.xmax=p.valid[1],r):{rings:g.map(q=>[[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]])}}function a(r,p,g){if(Array.isArray(r)){var q=r[0];q>p?(g=k.offsetMagnitude(q,p),r[0]=q+-2*g*p):q<g&&(p=k.offsetMagnitude(q,g),r[0]=q+-2*p*g)}else q=
r.x,q>p?(g=k.offsetMagnitude(q,p),r.x+=-2*g*p):q<g&&(p=k.offsetMagnitude(q,g),r.x+=-2*p*g);return r}function d(r,p){const g=[],{ymin:q,ymax:u}=r;var v=r.xmax-r.xmin,z=r.xmin,t=r.xmax;const [w,x]=p.valid;var C=f(r.xmin,p);var F=C.x;const H=C.frameId;C=f(r.xmax,p);r=C.x;C=C.frameId;p=F===r&&0<v;if(v>2*x){v={xmin:z<t?F:r,ymin:q,xmax:x,ymax:u};z={xmin:w,ymin:q,xmax:z<t?r:F,ymax:u};t={xmin:0,ymin:q,xmax:x,ymax:u};F={xmin:w,ymin:q,xmax:0,ymax:u};r=[];p=[];n(v,t)&&r.push(H);n(v,F)&&p.push(H);n(z,t)&&r.push(C);
n(z,F)&&p.push(C);for(let J=H+1;J<C;J++)r.push(J),p.push(J);g.push({extent:v,frameIds:[H]},{extent:z,frameIds:[C]},{extent:t,frameIds:r},{extent:F,frameIds:p})}else F>r||p?g.push({extent:{xmin:F,ymin:q,xmax:x,ymax:u},frameIds:[H]},{extent:{xmin:w,ymin:q,xmax:r,ymax:u},frameIds:[C]}):g.push({extent:{xmin:F,ymin:q,xmax:r,ymax:u},frameIds:[H]});return g}function f(r,p){const [g,q]=p.valid;p=2*q;var u=0;r>q?(u=Math.ceil(Math.abs(r-q)/p),r-=u*p):r<g&&(u=Math.ceil(Math.abs(r-g)/p),r+=u*p,u=-u);return{x:r,
frameId:u}}function n(r,p){const {xmin:g,ymin:q,xmax:u,ymax:v}=p;return l(r,g,q)&&l(r,g,v)&&l(r,u,v)&&l(r,u,q)}function l(r,p,g){return p>=r.xmin&&p<=r.xmax&&g>=r.ymin&&g<=r.ymax?!0:!1}let h=function(){function r(){}r.prototype.cut=function(p,g){let q;if(p.rings)this.closed=!0,q=p.rings,this.minPts=4;else if(p.paths)this.closed=!1,q=p.paths,this.minPts=2;else return null;const u=q.length;g*=-2;for(let v=0;v<u;v++){const z=q[v];if(z&&z.length>=this.minPts){const t=[];for(const w of z)t.push([w[0]+
g,w[1]]);q.push(t)}}this.closed?p.rings=q:p.paths=q;return p};return r}();const m=c.create();y.normalizeCentralMeridianSync=function(r){if(!r)return null;if("mesh"===r.type)return r.toJSON();let p=null;var g=r.spatialReference,q=D.getInfo(g);if(!q)return r.toJSON();var u=g.isWebMercator?102100:4326;const v=k.cutParams[u].maxX,z=k.cutParams[u].minX;g=k.cutParams[u].plus180Line;u=k.cutParams[u].minus180Line;let t;var w=r.toJSON();A.isPoint(w)?t=a(w,v,z):A.isMultipoint(w)?(w.points=w.points.map(x=>a(x,
v,z)),t=w):A.isExtent(w)?t=e(w,q):A.isPolygon(w)||A.isPolyline(w)?(B.getBoundsXY(m,w),r={xmin:m[0],ymin:m[1],xmax:m[2],ymax:m[3]},q=2*k.offsetMagnitude(r.xmin,z)*v,w=0===q?w:b(w,q),r.xmin+=q,r.xmax+=q,E.extentIntersectsPolyline(r,g)&&r.xmax!==v?p=w:E.extentIntersectsPolyline(r,u)&&r.xmin!==z?p=w:t=w):t=r.toJSON();return null!==p?(new h).cut(p,v):t};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/cimSymbolUtils":function(){define(["exports","../WebStyleSymbol","../../symbols",
"./cimAnalyzer","./ExpandedCIM"],function(y,D,E,B,A){const k=async(b,e)=>new A.ExpandedCIM(await B.analyzeCIMSymbol(b.data,e),b.data,b.rendererKey,b.maxVVSize),c=async(b,e,a)=>b?"cim"===b.type?k(b,e):"web-style"===b.type?(b={type:"cim",data:(await D.fromJSON(b).fetchCIMSymbol(a)).data,rendererKey:b.rendererKey,maxVVSize:b.maxVVSize},k(b,e)):b:null;y.expandSymbol=c;y.expandSymbols=async(b,e,a)=>Promise.all(b.map(d=>c(d,e,a)));Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../core/string ../../core/Logger ../../support/arcadeOnDemand ../../Color ../../core/screenUtils ./utils ../../views/2d/arcade/callExpressionWithFeature ./CIMSymbolHelper ./SDFHelper".split(" "),
function(y,D,E,B,A,k,c,b,e,a){function d(I){switch(I){case "Butt":return 0;case "Square":return 2;default:return 1}}function f(I){switch(I){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function n(I){switch(I){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function l(I){switch(I){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function h(I){let L="normal",G=
"normal";I&&(I=I.toLowerCase(),-1!==I.indexOf("italic")?L="italic":-1!==I.indexOf("oblique")&&(L="oblique"),-1!==I.indexOf("bold")?G="bold":-1!==I.indexOf("light")&&(G="lighter"));return{style:L,weight:G}}function m(I,L,G,M){let P;I[L]?P=I[L]:(P={},I[L]=P);P[G]=M}function r(I){return(I=I.markerPlacement)&&I.angleToLine?1:0}function p(I,L,G,M,P,T){if(I){var Y=I.symbolLayers;if(Y){var Z,ca=e.CIMSymbolHelper.getSize(I);"CIMPointSymbol"===I.type&&"Map"===I.angleAlignment&&(Z=1);for(var ia=Y.length;ia--;){var da=
Y[ia];if(da&&!1!==da.enable){var ja=[];e.OverrideHelper.findApplicableOverrides(da,L,ja);switch(da.type){case "CIMSolidFill":g(da,G,ja,M,P);break;case "CIMPictureFill":q(da,G,ja,M,P);break;case "CIMHatchFill":u(da,G,ja,M,P);break;case "CIMGradientFill":var la=G,fa=M,Q=P,V=D.numericHash(JSON.stringify(da)).toString();Q.push({type:"fill",templateHash:V,materialHash:0===ja.length?V:N(V,la,ja,fa),cim:da,materialOverrides:null,colorLocked:da.colorLocked,effects:da.effects,color:{r:128,g:128,b:128,a:1},
height:0,angle:0,offsetX:0,offsetY:0,scaleX:1});break;case "CIMSolidStroke":v(da,G,ja,M,P,"CIMPolygonSymbol"===I.type,ca);break;case "CIMPictureStroke":z(da,G,ja,M,P,"CIMPolygonSymbol"===I.type,ca);break;case "CIMGradientStroke":{la=G;fa=M;Q=P;V="CIMPolygonSymbol"===I.type;var O=ca,U=da.primitiveName,W=void 0!==da.width?da.width:4,ba=d(da.capStyle),ea=f(da.joinStyle);const ma=da.miterLimit,oa=D.numericHash(JSON.stringify(da)).toString();Q.push({type:"line",templateHash:oa,materialHash:0===ja.length?
oa:N(oa,la,ja,fa),cim:da,materialOverrides:null,isOutline:V,colorLocked:da.colorLocked,effects:da.effects,color:{r:128,g:128,b:128,a:1},width:K(U,la,"Width",fa,W),cap:K(U,la,"CapStyle",fa,ba),join:K(U,la,"JoinStyle",fa,ea),miterLimit:K(U,la,"MiterLimit",fa,ma),referenceWidth:O,zOrder:H(da.name),isDashed:!1})}break;case "CIMCharacterMarker":t(da,G,ja,M,P);break;case "CIMPictureMarker":if(t(da,G,ja,M,P))break;"CIMLineSymbol"===I.type&&(Z=r(da));w(da,G,ja,M,P,Z,ca);break;case "CIMVectorMarker":if(t(da,
G,ja,M,P))break;"CIMLineSymbol"===I.type&&(Z=r(da));la=G;fa=M;Q=P;V=Z;O=ca;U=T;if(ba=da.markerGraphics){W=0;da.scaleSymbolsProportionally&&(ea=da.frame)&&(W=ea.ymax-ea.ymin);for(const ma of ba)if(ma&&(ba=ma.symbol))switch(ba.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":C(da,ma,ja,la,fa,Q,V,O,W,U);break;case "CIMTextSymbol":x(da,ma,la,ja,fa,Q,V,O,W)}}break;default:R.error("Cannot analyze CIM layer",da.type)}}}}}}function g(I,L,G,M,P){const T=I.primitiveName,Y=c.fromCIMColor(I.color),
Z=D.numericHash(JSON.stringify(I)).toString();P.push({type:"fill",templateHash:Z,materialHash:0===G.length?Z:()=>Z,cim:I,materialOverrides:null,colorLocked:I.colorLocked,color:K(T,L,"Color",M,Y,J),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:I.effects})}function q(I,L,G,M,P){const T=I.primitiveName,Y=I.tintColor?c.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},Z=D.numericHash(JSON.stringify(I)).toString(),ca=D.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();P.push({type:"fill",
templateHash:Z,materialHash:0===G.length?ca:()=>ca,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,color:K(T,L,"TintColor",M,Y,J),height:K(T,L,"Height",M,I.height),scaleX:K(T,L,"ScaleX",M,I.scaleX),angle:K(T,L,"Rotation",M,I.rotation),offsetX:K(T,L,"OffsetX",M,I.offsetX),offsetY:K(T,L,"OffsetY",M,I.offsetY)})}function u(I,L,G,M,P){const T=["Rotation","OffsetX","OffsetY"],Y=G.filter(da=>da.primitiveName!==I.primitiveName&&-1===T.indexOf(da.propertyName)),Z=I.primitiveName,
ca=D.numericHash(JSON.stringify(I)).toString(),ia=D.numericHash(`${I.separation}${JSON.stringify(I.lineSymbol)}`).toString();P.push({type:"fill",templateHash:ca,materialHash:0===G.length?ia:N(ia,L,Y,M),cim:I,materialOverrides:Y,colorLocked:I.colorLocked,effects:I.effects,color:{r:255,g:255,b:255,a:1},height:K(Z,L,"Separation",M,I.separation),scaleX:1,angle:K(Z,L,"Rotation",M,I.rotation),offsetX:K(Z,L,"OffsetX",M,I.offsetX),offsetY:K(Z,L,"OffsetY",M,I.offsetY)})}function v(I,L,G,M,P,T,Y){const Z=D.numericHash(JSON.stringify(I)).toString(),
ca=I.primitiveName,ia=c.fromCIMColor(I.color),da=void 0!==I.width?I.width:4,ja=d(I.capStyle),la=f(I.joinStyle),fa=I.miterLimit;P.push({type:"line",templateHash:Z,materialHash:0===G.length?Z:()=>Z,cim:I,materialOverrides:null,isOutline:T,colorLocked:I.colorLocked,effects:I.effects,color:K(ca,L,"Color",M,ia,J),width:K(ca,L,"Width",M,da),cap:K(ca,L,"CapStyle",M,ja),join:K(ca,L,"JoinStyle",M,la),miterLimit:K(ca,L,"MiterLimit",M,fa),referenceWidth:Y,zOrder:H(I.name),isDashed:!1})}function z(I,L,G,M,P,
T,Y){const Z=D.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),ca=I.primitiveName,ia=c.fromCIMColor(I.tintColor),da=void 0!==I.width?I.width:4,ja=d(I.capStyle),la=f(I.joinStyle),fa=I.miterLimit,Q=D.numericHash(JSON.stringify(I)).toString();P.push({type:"line",templateHash:Q,materialHash:0===G.length?Z:()=>Z,cim:I,materialOverrides:null,isOutline:T,colorLocked:I.colorLocked,effects:I.effects,color:K(ca,L,"TintColor",M,ia,J),width:K(ca,L,"Width",M,da),cap:K(ca,L,"CapStyle",
M,ja),join:K(ca,L,"JoinStyle",M,la),miterLimit:K(ca,L,"MiterLimit",M,fa),referenceWidth:Y,zOrder:H(I.name),isDashed:!1})}function t(I,L,G,M,P){const T=I.markerPlacement;if(!T||"CIMMarkerPlacementInsidePolygon"!==T.type)return!1;const Y=["Rotation","OffsetX","OffsetY"],Z=G.filter(ia=>ia.primitiveName!==I.primitiveName&&-1===Y.indexOf(ia.propertyName)),ca=D.numericHash(JSON.stringify(I)).toString();P.push({type:"fill",templateHash:ca,materialHash:0===G.length?ca:N(ca,L,Z,M),cim:I,materialOverrides:Z,
colorLocked:I.colorLocked,effects:I.effects,color:{r:255,g:255,b:255,a:1},height:K(T.primitiveName,L,"StepY",M,T.stepY),scaleX:1,angle:K(T.primitiveName,L,"GridAngle",M,T.gridAngle),offsetX:K(T.primitiveName,L,"OffsetX",M,T.offsetX),offsetY:K(T.primitiveName,L,"OffsetY",M,T.offsetY)});return!0}function w(I,L,G,M,P,T,Y){const Z=I.primitiveName,ca=I.size,ia=I.scaleX,da=I.rotation,ja=I.offsetX,la=I.offsetY,fa=c.fromCIMColor(I.tintColor),Q=D.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();
let V=!1,O="";for(const U of G)U.primitiveName===Z&&(void 0!==U.value?O+=`-${U.primitiveName}-${U.propertyName}-${JSON.stringify(U.value)}`:U.valueExpressionInfo&&(V=!0));P.push({type:"marker",templateHash:D.numericHash(JSON.stringify(I)+O).toString(),materialHash:V?()=>Q:Q,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:!1,alignment:T,size:K(Z,L,"Size",M,ca),scaleX:K(Z,L,"ScaleX",M,ia),rotation:K(Z,L,"Rotation",M,da),offsetX:K(Z,L,"OffsetX",M,ja),
offsetY:K(Z,L,"OffsetY",M,la),color:K(Z,L,"TintColor",M,fa,J),anchorPoint:I.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:I.rotateClockwise,referenceSize:Y,sizeRatio:1,markerPlacement:I.markerPlacement})}function x(I,L,G,M,P,T,Y,Z,ca){e.OverrideHelper.findApplicableOverrides(L,M,[]);var ia=L.geometry;if("x"in ia&&"y"in ia){var da=L.symbol;var ja=da.underline?"underline":da.strikethrough?"line-through":
"none";var la=h(da.fontStyleName);da.font={family:da.fontFamilyName,decoration:ja,...la};var fa=I.frame,Q=I.size/ca;ca=I.primitiveName;ja=(da.height||0)*Q;la=da.angle||0;var V=((da.offsetX||0)+(ia.x-.5*(fa.xmin+fa.xmax)))*Q;ia=((da.offsetY||0)+(ia.y-.5*(fa.ymin+fa.ymax)))*Q;fa=c.fromCIMColor(e.CIMSymbolHelper.getFillColor(da));var O=c.fromCIMColor(e.CIMSymbolHelper.getStrokeColor(da)),U=e.CIMSymbolHelper.getStrokeWidth(da);U||(O=c.fromCIMColor(e.CIMSymbolHelper.getFillColor(da.haloSymbol)),U=da.haloSize*
Q);Q="";for(const W of M)W.primitiveName===ca&&void 0!==W.value&&(Q+=`-${W.primitiveName}-${W.propertyName}-${JSON.stringify(W.value)}`);M=JSON.stringify(I.effects)+Number(I.colorLocked)+JSON.stringify(I.anchorPoint)+I.anchorPointUnits+JSON.stringify(I.markerPlacement);M=D.numericHash(JSON.stringify(L)+M+Q).toString();T.push({type:"text",templateHash:M,materialHash:()=>D.numericHash(JSON.stringify(da.font)).toString(),cim:da,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,alignment:Y,
anchorPoint:{x:I.anchorPoint?I.anchorPoint.x:0,y:I.anchorPoint?I.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,fontName:da.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:K(ca,G,"Size",P,ja),angle:K(ca,G,"Rotation",P,la),offsetX:K(ca,G,"OffsetX",P,V),offsetY:K(ca,G,"OffsetY",P,ia),horizontalAlignment:n(da.horizontalAlignment),verticalAlignment:l(da.verticalAlignment),text:K(L.primitiveName,G,"TextString",P,L.textString,c._adjustTextCase,da.textCase),color:fa,
outlineColor:O,outlineSize:U,referenceSize:Z,sizeRatio:1,markerPlacement:I.markerPlacement})}}function C(I,L,G,M,P,T,Y,Z,ca,ia){const da=L.geometry;if(da){var ja=L.symbol.symbolLayers;if(ja)if(ia)F(I,L,M,G,P,T,Y,Z,ca);else for(ia=ja.length;ia--;){var la=ja[ia];if(la&&!1!==la.enable)switch(la.type){case "CIMSolidFill":case "CIMSolidStroke":{var fa=a.getExtent(da);if(!fa)continue;const [O,U,W]=a.getSDFMetrics(fa,I.frame,I.size,I.anchorPoint,"Relative"!==I.anchorPointUnits);var Q="CIMSolidFill"===la.type;
fa={type:"sdf",geom:da,asFill:Q};var V=I.primitiveName;const ba=I.size,ea=I.rotation||0,ma=I.offsetX,oa=I.offsetY,pa=la.primitiveName,qa=Q?c.fromCIMColor(e.CIMSymbolHelper.getFillColor(la)):c.fromCIMColor(e.CIMSymbolHelper.getStrokeColor(la)),va=Q?{r:0,g:0,b:0,a:0}:c.fromCIMColor(e.CIMSymbolHelper.getStrokeColor(la)),ta=e.CIMSymbolHelper.getStrokeWidth(la);if(!Q&&!ta)break;Q=!1;let ua="";for(const xa of G)if(xa.primitiveName===pa||xa.primitiveName===V)void 0!==xa.value?ua+=`-${xa.primitiveName}-${xa.propertyName}-${JSON.stringify(xa.value)}`:
xa.valueExpressionInfo&&(Q=!0);V=JSON.stringify({...I,markerGraphics:null});const Aa=D.numericHash(JSON.stringify(fa)).toString();la={type:"marker",templateHash:D.numericHash(JSON.stringify(L)+JSON.stringify(la)+V+ua).toString(),materialHash:Q?()=>Aa:Aa,cim:fa,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:Y,anchorPoint:{x:U,y:W},isAbsoluteAnchorPoint:!1,size:K(I.primitiveName,M,"Size",P,ba),rotation:K(I.primitiveName,
M,"Rotation",P,ea),offsetX:K(I.primitiveName,M,"OffsetX",P,ma),offsetY:K(I.primitiveName,M,"OffsetY",P,oa),scaleX:1,frameHeight:ca,rotateClockwise:I.rotateClockwise,referenceSize:Z,sizeRatio:O,color:K(pa,M,"Color",P,qa,J),outlineColor:K(pa,M,"Color",P,va,J),outlineWidth:K(pa,M,"Width",P,ta),markerPlacement:I.markerPlacement};T.push(la);break}default:F(I,L,M,G,P,T,Y,Z,ca)}}}}function F(I,L,G,M,P,T,Y,Z,ca){L={type:I.type,enable:!0,name:I.name,colorLocked:I.colorLocked,primitiveName:I.primitiveName,
anchorPoint:I.anchorPoint,anchorPointUnits:I.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:I.rotateClockwise,rotation:0,size:I.size,billboardMode3D:I.billboardMode3D,depth3D:I.depth3D,frame:I.frame,markerGraphics:[L],scaleSymbolsProportionally:I.scaleSymbolsProportionally,respectFrame:I.respectFrame,clippingPath:I.clippingPath,effects:I.effects};let ia=[];const da=["Rotation","OffsetX","OffsetY"];ia=M.filter(W=>W.primitiveName!==I.primitiveName||-1===da.indexOf(W.propertyName));var ja="";for(var la of M)void 0!==
la.value&&(ja+=`-${la.primitiveName}-${la.propertyName}-${JSON.stringify(la.value)}`);const [fa,Q,V]=e.CIMSymbolHelper.getTextureAnchor(L);M=I.primitiveName;la=I.rotation||0;const O=I.offsetX||0,U=I.offsetY||0;ja=D.numericHash(JSON.stringify(L)+ja).toString();G={type:"marker",templateHash:ja,materialHash:0===ia.length?ja:N(ja,G,ia,P),cim:L,materialOverrides:ia,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:Y,anchorPoint:{x:fa,y:Q},isAbsoluteAnchorPoint:!1,
size:I.size,rotation:K(M,G,"Rotation",P,la),offsetX:K(M,G,"OffsetX",P,O),offsetY:K(M,G,"OffsetY",P,U),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ca,rotateClockwise:I.rotateClockwise,referenceSize:Z,sizeRatio:V/k.pt2px(I.size),markerPlacement:I.markerPlacement};T.push(G)}function H(I){return I&&0===I.indexOf("Level_")?parseInt(I.substr(6),10):0}function J(I){if(!I||0===I.length)return null;I=(new A(I)).toRgba();return{r:I[0],g:I[1],b:I[2],a:I[3]}}function K(I,
L,G,M,P,T,Y){if(I=L[I]){const Z=I[G];if("string"===typeof Z||"number"===typeof Z||Z instanceof Array)return T?T.call(null,Z,Y):Z;if(null!=Z&&Z instanceof B.ArcadeExpression)return(ca,ia,da)=>{ca=b(Z,ca,{$view:da},M.geometryType,ia);null!==ca&&T&&(ca=T.call(null,ca,Y));return null!==ca?ca:P}}return P}function N(I,L,G,M){for(const P of G)if(P.valueExpressionInfo){const T=L[P.primitiveName]&&L[P.primitiveName][P.propertyName];T instanceof B.ArcadeExpression&&(P.fn=(Y,Z,ca)=>b(T,Y,{$view:ca},M.geometryType,
Z))}return(P,T,Y)=>{for(const Z of G)Z.fn&&(Z.value=Z.fn(P,T,Y));return D.numericHash(I+e.OverrideHelper.buildOverrideKey(G)).toString()}}const R=E.getLogger("esri.symbols.cim.cimAnalyzer");y.analyzeCIMResource=function(I,L){if(!L||0===L.length)return I;I=JSON.parse(JSON.stringify(I));e.OverrideHelper.applyOverrides(I,L);return I};y.analyzeCIMSymbol=async function(I,L,G,M){G=G?G:[];if(!I)return G;let P;const T={};if("CIMSymbolReference"===I.type){if(P=I.symbol,I=I.primitiveOverrides){const Z=[];for(const ca of I){var Y=
ca.valueExpressionInfo;Y&&L?(Y=B.createRendererExpression(Y.expression,L.spatialReference,L.fields).then(ia=>{ia&&m(T,ca.primitiveName,ca.propertyName,ia)}),Z.push(Y)):null!=ca.value&&m(T,ca.primitiveName,ca.propertyName,ca.value)}await Promise.all(Z)}}else return R.error("Expect cim type to be 'CIMSymbolReference'"),G;switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":p(P,I,T,L,G,M)}return G};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Logger",
"../../../core/Error","../../../geometry/support/quantizationUtils"],function(y,D,E){function B(k){const c={};switch(k){case "esriGeometryPoint":return(b,e,a,d)=>E.unquantizePoint(e,c,b,a,d);case "esriGeometryPolygon":return(b,e,a,d)=>E.unquantizePolygon(e,c,b,a,d);case "esriGeometryPolyline":return(b,e,a,d)=>E.unquantizePolyline(e,c,b,a,d);case "esriGeometryMultipoint":return(b,e,a,d)=>E.unquantizeMultipoint(e,c,b,a,d);default:return y.getLogger("esri.views.2d.support.arcadeOnDemand").error(new D("mapview-arcade",
`Unable to handle geometryType: ${k}`)),b=>b}}const A=new Map;return function(k,c,b,e,a){if(k.referencesGeometry()&&a){{const {transform:d,hasZ:f,hasM:n}=a;A.has(e)||A.set(e,B(e));e=A.get(e)(c.geometry,d,f,n);c={...c,geometry:e}}}c=k.repurposeFeature(c);try{return k.evaluate({...b,$feature:c})}catch(d){return y.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",d),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],
function(y,D){function E({scale:x,translate:C},F){return Math.round((F-C[0])/x[0])}function B({scale:x,translate:C},F){return Math.round((C[1]-F)/x[1])}function A(x,C,F){const H=[];let J,K,N,R;for(let I=0;I<F.length;I++){const L=F[I];if(0<I){if(N=E(x,L[0]),R=B(x,L[1]),N!==J||R!==K)H.push(C(L,N-J,R-K)),J=N,K=R}else J=E(x,L[0]),K=B(x,L[1]),H.push(C(L,J,K))}return 0<H.length?H:null}function k(x,C,F,H){return A(x,F?H?w:t:H?t:z,C)}function c(x,C,F,H){const J=[];F=F?H?w:t:H?t:z;for(H=0;H<C.length;H++){const K=
A(x,F,C[H]);K&&3<=K.length&&J.push(K)}return J.length?J:null}function b(x,C,F,H){const J=[];F=F?H?w:t:H?t:z;for(H=0;H<C.length;H++){const K=A(x,F,C[H]);K&&2<=K.length&&J.push(K)}return J.length?J:null}function e({scale:x,translate:C},F){return F*x[0]+C[0]}function a({scale:x,translate:C},F){return C[1]-F*x[1]}function d(x,C,F){const H=Array(F.length);if(!F.length)return H;const [J,K]=x.scale;let N=e(x,F[0][0]);x=a(x,F[0][1]);H[0]=C(F[0],N,x);for(let R=1;R<F.length;R++){const I=F[R];N+=I[0]*J;x-=I[1]*
K;H[R]=C(I,N,x)}return H}function f(x,C,F){const H=Array(F.length);for(let J=0;J<F.length;J++)H[J]=d(x,C,F[J]);return H}function n(x,C,F,H){return d(x,F?H?w:t:H?t:z,C)}function l(x,C,F,H){return f(x,F?H?w:t:H?t:z,C)}function h(x,C,F,H){return f(x,F?H?w:t:H?t:z,C)}function m(x,C,F){let [H,J]=F[0],K=Math.min(H,C[0]),N=Math.min(J,C[1]),R=Math.max(H,C[2]);C=Math.max(J,C[3]);for(let I=1;I<F.length;I++){const [L,G]=F[I];H+=L;J+=G;0>L&&(K=Math.min(K,H));0<L&&(R=Math.max(R,H));0>G?N=Math.min(N,J):0<G&&(C=
Math.max(C,J))}x[0]=K;x[1]=N;x[2]=R;x[3]=C;return x}function r(x,C){if(!C.length)return null;x[0]=x[1]=Number.POSITIVE_INFINITY;x[2]=x[3]=Number.NEGATIVE_INFINITY;for(let F=0;F<C.length;F++)m(x,x,C[F]);return x}function p(x,C,F,H,J){C.xmin=E(x,F.xmin);C.ymin=B(x,F.ymin);C.xmax=E(x,F.xmax);C.ymax=B(x,F.ymax);C!==F&&(H&&(C.zmin=F.zmin,C.zmax=F.zmax),J&&(C.mmin=F.mmin,C.mmax=F.mmax));return C}function g(x,C,F,H,J){C.points=k(x,F.points,H,J);return C}function q(x,C,F,H,J){C.x=E(x,F.x);C.y=B(x,F.y);C!==
F&&(H&&(C.z=F.z),J&&(C.m=F.m));return C}function u(x,C,F,H,J){x=c(x,F.rings,H,J);if(!x)return null;C.rings=x;return C}function v(x,C,F,H,J){x=b(x,F.paths,H,J);if(!x)return null;C.paths=x;return C}const z=(x,C,F)=>[C,F],t=(x,C,F)=>[C,F,x[2]],w=(x,C,F)=>[C,F,x[2],x[3]];y.equals=function(x,C){if(x===C||null==x&&null==C)return!0;if(null==x||null==C)return!1;let F,H,J,K;x&&"upperLeft"===x.originPosition?(F=x.translate[0],H=x.translate[1],x=x.scale[0]):(F=x.extent.xmin,H=x.extent.ymax,x=x.tolerance);C&&
"upperLeft"===C.originPosition?(J=C.translate[0],K=C.translate[1],C=C.scale[0]):(J=C.extent.xmin,K=C.extent.ymax,C=C.tolerance);return F===J&&H===K&&x===C};y.getQuantizedBoundsCoordsArray=m;y.getQuantizedBoundsCoordsArrayArray=r;y.getQuantizedBoundsPaths=function(x){return r([0,0,0,0],x)};y.getQuantizedBoundsPoints=function(x){const C=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return m(C,C,x)};y.getQuantizedBoundsRings=function(x){return r([0,
0,0,0],x)};y.quantizeBounds=function(x,C,F){C[0]=E(x,F[0]);C[3]=B(x,F[1]);C[2]=E(x,F[2]);C[1]=B(x,F[3]);return C};y.quantizeExtent=p;y.quantizeGeometry=function(x,C){return x&&C?D.isPoint(C)?q(x,{},C,!1,!1):D.isPolyline(C)?v(x,{},C,!1,!1):D.isPolygon(C)?u(x,{},C,!1,!1):D.isMultipoint(C)?g(x,{},C,!1,!1):D.isExtent(C)?p(x,{},C,!1,!1):null:null};y.quantizeMultipoint=g;y.quantizePaths=b;y.quantizePoint=q;y.quantizePoints=k;y.quantizePolygon=u;y.quantizePolyline=v;y.quantizeRings=c;y.quantizeX=E;y.quantizeY=
B;y.toQuantizationTransform=function(x){return x?{originPosition:"upper-left"===x.originPosition?"upperLeft":"lower-left"===x.originPosition?"lowerLeft":x.originPosition,scale:x.tolerance?[x.tolerance,x.tolerance]:[1,1],translate:x.extent?[x.extent.xmin,x.extent.ymax]:[0,0]}:null};y.unquantizeBounds=function(x,C,F){return F?(C[0]=e(x,F[0]),C[1]=a(x,F[3]),C[2]=e(x,F[2]),C[3]=a(x,F[1]),C):[e(x,C[0]),a(x,C[3]),e(x,C[2]),a(x,C[1])]};y.unquantizeCoordsArray=d;y.unquantizeCoordsArrayArray=f;y.unquantizeExtent=
function(x,C,F,H,J){C.xmin=e(x,F.xmin);C.ymin=a(x,F.ymin);C.xmax=e(x,F.xmax);C.ymax=a(x,F.ymax);C!==F&&(H&&(C.zmin=F.zmin,C.zmax=F.zmax),J&&(C.mmin=F.mmin,C.mmax=F.mmax));return C};y.unquantizeMultipoint=function(x,C,F,H,J){C.points=n(x,F.points,H,J);return C};y.unquantizePaths=l;y.unquantizePoint=function(x,C,F,H,J){C.x=e(x,F.x);C.y=a(x,F.y);C!==F&&(H&&(C.z=F.z),J&&(C.m=F.m));return C};y.unquantizePoints=n;y.unquantizePolygon=function(x,C,F,H,J){C.rings=h(x,F.rings,H,J);return C};y.unquantizePolyline=
function(x,C,F,H,J){C.paths=l(x,F.paths,H,J);return C};y.unquantizeRings=h;y.unquantizeX=e;y.unquantizeY=a;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(y,D,E,B){const A={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};E=function(){function k(c,
b,e,a){this.layers=c;this.data=b;this.hash=this._createHash();this.rendererKey=e;for(const d of c)d.materialKey=B.createMaterialKey(A[d.type],this.rendererKey,!1,!1),d.maxVVSize=a}k.prototype._createHash=function(){let c="";for(const b of this.layers)c+=b.templateHash;return c};D._createClass(k,[{key:"type",get:function(){return"expanded-cim"}}]);return k}();y.ExpandedCIM=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/layers/graphics/data/projectionSupport":function(){define(["exports",
"../../../geometry/support/spatialReferenceUtils","../../../geometry/support/webMercatorUtils","../../../geometry/projection","../../../geometry/geometryAdapters/json"],function(y,D,E,B,A){function k(n,l){if(!l)return null;if("x"in l){var h={x:0,y:0};[h.x,h.y]=n(l.x,l.y,e);null!=l.z&&(h.z=l.z);null!=l.m&&(h.m=l.m);return h}if("xmin"in l)return h={xmin:0,ymin:0,xmax:0,ymax:0},[h.xmin,h.ymin]=n(l.xmin,l.ymin,e),[h.xmax,h.ymax]=n(l.xmax,l.ymax,e),l.hasZ&&(h.zmin=l.zmin,h.zmax=l.zmax,h.hasZ=!0),l.hasM&&
(h.mmin=l.mmin,h.mmax=l.mmax,h.hasM=!0),h;if("rings"in l)return{rings:c(l.rings,n),hasM:l.hasM,hasZ:l.hasZ};if("paths"in l)return{paths:c(l.paths,n),hasM:l.hasM,hasZ:l.hasZ};if("points"in l)return{points:b(l.points,n),hasM:l.hasM,hasZ:l.hasZ}}function c(n,l){const h=[];for(const m of n)h.push(b(m,l));return h}function b(n,l){const h=[];for(const m of n)n=l(m[0],m[1],[0,0]),h.push(n),2<m.length&&n.push(m[2]),3<m.length&&n.push(m[3]);return h}const e=[0,0],a=k.bind(null,E.lngLatToXY),d=k.bind(null,
E.xyToLngLat),f=new (function(){function n(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var l=n.prototype;l.push=async function(h,m,r){h&&h.length&&m&&r&&D.equals(m,r);const p={geometries:h,inSpatialReference:m,outSpatialReference:r,resolve:null};this._jobs.push(p);return new Promise(g=>{p.resolve=g;null===this._timer&&(this._timer=setTimeout(this._process,10))})};l._process=function(){this._timer=null;const h=this._jobs.shift();if(h){var {geometries:m,inSpatialReference:r,
outSpatialReference:p,resolve:g}=h;E.canProject(r,p)?D.isWebMercator(p)?g(m.map(a)):g(m.map(d)):g(B.projectMany(A.jsonAdapter,m,r,p,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return n}());y.checkProjectionSupport=async function(n,l){l&&(n=Array.isArray(n)?n.map(h=>{var m;return null==(m=h.geometry)?void 0:m.spatialReference}):[n],await B.initializeProjection(n.map(h=>({source:h,dest:l}))))};y.project=function(n,l,h){if(!n)return n;h||(h=l,l=n.spatialReference);return D.isValid(l)&&
D.isValid(h)&&!D.equals(l,h)?E.canProject(l,h)?D.isWebMercator(h)?a(n):d(n):B.projectMany(A.jsonAdapter,[n],l,h,null)[0]:n};y.projectMany=async function(n,l,h){return f.push(n,l,h)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(y){let D=function(c,b,e){this.x=c;this.y=b;this.spatialReference=e;this.m=this.z=void 0},E=function(c,b,e,a){this.rings=c;this.spatialReference=b;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);
a&&(this.hasM=a)},B=function(c,b,e,a){this.paths=c;this.spatialReference=b;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);a&&(this.hasM=a)},A=function(c,b,e,a){this.points=c;this.spatialReference=b;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);a&&(this.hasM=a)},k=function(c,b,e,a,d){this.xmin=c;this.ymin=b;this.xmax=e;this.ymax=a;this.spatialReference=d;this.mmax=this.mmin=this.zmax=this.zmin=void 0};y.jsonAdapter={convertToGEGeometry:function(c,b){return null==b?null:c.convertJSONToGeometry(b)},exportPoint:function(c,
b,e){e=new D(c.getPointX(b),c.getPointY(b),e);const a=c.hasZ(b),d=c.hasM(b);a&&(e.z=c.getPointZ(b));d&&(e.m=c.getPointM(b));return e},exportPolygon:function(c,b,e){return new E(c.exportPaths(b),e,c.hasZ(b),c.hasM(b))},exportPolyline:function(c,b,e){return new B(c.exportPaths(b),e,c.hasZ(b),c.hasM(b))},exportMultipoint:function(c,b,e){return new A(c.exportPoints(b),e,c.hasZ(b),c.hasM(b))},exportExtent:function(c,b,e){var a=c.hasZ(b);const d=c.hasM(b);e=new k(c.getXMin(b),c.getYMin(b),c.getXMax(b),
c.getYMax(b),e);a&&(a=c.getZExtent(b),e.zmin=a.vmin,e.zmax=a.vmax);d&&(c=c.getMExtent(b),e.mmin=c.vmin,e.mmax=c.vmax);return e}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(y,D,E,B,A,k){k=function(c){function b(){var a=c.apply(this,arguments)||this;a._data=null;a._displayList=null;a._lastCommitTime=0;a._hasData=
!1;a._invalidated=!1;a._wglBuffers=null;a._dirtyMap=new E;return a}D._inheritsLoose(b,c);var e=b.prototype;e.destroy=function(){c.prototype.destroy.call(this);this.clear()};e.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};e.getDisplayList=function(){return this._displayList};e.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var d=a.addOrUpdate,f=a.remove;!this._data&&d&&d.tileDisplayData.displayObjects.length?(d.tileDisplayData.computeDisplayList(),
this._dirtyMap=new E,this._dispRecStore=B.fromTileData(d,this._dirtyMap),this._data=d,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?d&&d.tileDisplayData.displayObjects.length||f.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};e.commit=function(a){if(!a.time||a.time!==this._lastCommitTime)if(this._lastCommitTime=a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=
new A(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};e.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};e._doPatchData=function(a){this._invalidated=
!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=B.fromTileData(this._data,this._dirtyMap));this.requestRender()};e._patchData=function(a){let d=!0;var f=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],n=(a.remove||[]).slice();for(var l of f)null!=l.insertAfter&&n.push(l.id);for(var h of n)if(n=this._data.tileDisplayData.displayObjectRegistry.get(h)){this._data.tileDisplayData.displayList.removeFromList(n.displayRecords);
for(var m of n.displayRecords)this._dispRecStore.delete(m);this._data.tileDisplayData.displayObjectRegistry.delete(h);n=this._data.tileDisplayData.displayObjects.indexOf(n);this._data.tileDisplayData.displayObjects.splice(n,1)}for(const q of f){f=this._data.tileDisplayData.displayObjectRegistry.get(q.id);let u;if(f){h=f.displayRecords;f.set(q);f.displayRecords=h;h=f.displayRecords.length;for(m=0;m<h;++m)if(n=f.displayRecords[m],l=q.displayRecords[m],m>=q.displayRecords.length||n.geometryType!==l.geometryType||
n.symbolLevel!==l.symbolLevel||n.zOrder!==l.zOrder||n.materialKey!==l.materialKey)this._dispRecStore.delete(f.displayRecords[m]),m<q.displayRecords.length&&(f.displayRecords[m]=void 0);f.displayRecords.length=q.displayRecords.length}else if(f=q.copy(),f.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(q.id,f),h=this._data.tileDisplayData.displayObjects,null!=f.insertAfter?(u={},0<=f.insertAfter?(m=this._data.tileDisplayData.displayObjectRegistry.get(f.insertAfter))?(l=h.indexOf(m)+
1,l<h.length?h.splice(l,0,f):(h.push(f),l=h.length)):(h.push(f),l=h.length):(h.unshift(f),l=0)):(h.push(f),l=h.length),u)for(m=0<q.displayRecords.length?1:0,n=0,--l;0<=l&&n<m;--l)for(var r=h[l].displayRecords.length-1;0<=r&&n<m;--r){var p=h[l].displayRecords[r],g=this._data.tileDisplayData.displayList.getDPInfoType();u[g]||(u[g]=p,++n)}h=q.displayRecords.length;for(m=0;m<h;++m){n=q.displayRecords[m];(l=f.displayRecords[m])?(l.meshData=n.meshData,l.materialKey=n.materialKey):(l=n.copy(),l.vertexFrom=
void 0,l.indexFrom=void 0,f.displayRecords[m]=l);p=n.geometryType;r=this._data.tileDisplayData.displayList.getDPInfoType();g=a.addOrUpdate.tileBufferData.geometries[p];p=g.vertexBuffer;g=g.indexBuffer;let v=void 0;u&&(v=u[r]?this._data.tileDisplayData.displayList.splitAfter(u[r]):-1);d=this._dispRecStore.setMeshData(l,n,p,g,v)&&d;u&&null!=l.indexFrom&&null!=l.indexFrom&&(u[r]=l)}}return d};D._createClass(b,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var a;
return null!=(a=this._displayObjects)?a:[]}}]);return b}(k.WGLTile);y.GraphicTile=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["./Utils"],function(y){function D(E,B,A){if(!E.allDirty)if(null!=E.from&&null!=E.count){const k=Math.min(E.from,B);B=Math.max(E.from+E.count,B+A)-k;E.from=k;E.count=B}else E.from=B,E.count=A}return function(){function E(){this._dirties=y.createGeometryData(()=>({indices:{from:null,count:null,allDirty:!1}}),
()=>({vertices:{from:null,count:null,allDirty:!1}}))}var B=E.prototype;B.hasDirty=function(){for(const A of this._dirties)if(null!==A.data.indices.count||A.data.indices.allDirty)return!0;return!1};B.markAllClean=function(){for(const A of this._dirties){A.data.indices.from=null;A.data.indices.count=null;A.data.indices.allDirty=!1;for(const k in A.buffers)A.buffers[k].data.vertices.from=null,A.buffers[k].data.vertices.count=null,A.buffers[k].data.vertices.allDirty=!1}};B.markAllDirty=function(){for(const A of this._dirties){A.data.indices.allDirty=
!0;for(const k in A.buffers)A.buffers[k].data.vertices.allDirty=!0}};B.forEach=function(A){for(let b=0;b<this._dirties.length;++b){var k=this._dirties[b],c={};for(const e in k.buffers){const a=k.buffers[e].data.vertices;if(a.allDirty||null!=a.from&&null!=a.count&&0<a.count)c[e]=a}k=k.data.indices;c=k.allDirty||null!=k.from&&null!=k.count&&0<k.count?{indices:k,vertices:c}:{indices:null,vertices:c};(c.indices||0<Object.keys(c).length)&&A(c,b)}};B.markDirtyIndices=function(A,k,c){D(this._dirties[A].data.indices,
k,c)};B.markDirtyVertices=function(A,k,c,b){D(this._dirties[A].buffers[k].data.vertices,c,b)};return E}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./Utils","./FreeList"],function(y,D,E){const B=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function A(c,b,e,a){this._strides=c;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=e;for(const d in c){this._freeListsAndStorage[d]={vtxFreeList:a?new E.FreeList(a):
null,idxFreeList:a?new E.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const f in c[d])this._freeListsAndStorage[d].vertexBuffers[f]={data:a?D.allocateTypedArrayBuffer(a,c[d][f]):null,stride:c[d][f]}}}A.fromTileData=function(c,b){var e,a=c.getStrides(),d={};for(e=0;e<a.length;e++)d[B[e]]=a[e];e=d;a=[0,0,0,0,0];d=[0,0,0,0,0];var f=c.tileDisplayData.displayObjects;for(var n of f)for(var l of n.displayRecords)a[l.geometryType]=Math.max(a[l.geometryType],l.vertexFrom+l.vertexCount),
d[l.geometryType]=Math.max(d[l.geometryType],l.indexFrom+l.indexCount);b=new A(e,c.tileDisplayData.displayList,b,null);for(n=0;n<c.tileBufferData.geometries.length;++n){l=a[n];f=d[n];var h=c.tileBufferData.geometries[n];e=b._storageFor(B[n]);const m=c.tileBufferData.geometries[n].indexBuffer;e.indexBuffer=m;e.idxFreeList=new E.FreeList(m.length);e.idxFreeList.allocate(f);let r;for(const p in h.vertexBuffer)f=c.tileBufferData.geometries[n].vertexBuffer[p],e.vertexBuffers[p].data=f.data,e.vertexBuffers[p].stride=
f.stride,h=D.strideToPackingFactor(f.stride),f=f.data.length*h/f.stride,r||(r=f);e.vtxFreeList=new E.FreeList(r);e.vtxFreeList.allocate(l)}return b};var k=A.prototype;k.delete=function(c){const b=B[c.geometryType];this._freeVertices(b,c.vertexFrom,c.vertexCount);this._freeIndices(b,c.indexFrom,c.indexCount);this._displayList.removeFromList(c);c.vertexFrom=void 0;c.indexFrom=void 0};k.setMeshData=function(c,b,e,a,d){const f=B[c.geometryType];c.meshData=null;let n=void 0,l=void 0;void 0===c.vertexFrom?
(l=b.vertexCount,n=this._allocateVertices(f,l)):b.vertexCount>c.vertexCount?(this._freeVertices(f,c.vertexFrom,c.vertexCount),l=b.vertexCount,n=this._allocateVertices(f,l)):b.vertexCount===c.vertexCount?(n=c.vertexFrom,l=c.vertexCount):(this._freeVertices(f,c.vertexFrom+b.vertexCount,c.vertexCount-b.vertexCount),n=c.vertexFrom,l=b.vertexCount);let h=!0,m=void 0,r=void 0,p=void 0;void 0===c.indexFrom?(m=d,p=b.indexCount,r=this._allocateIndices(f,p)):b.indexCount>c.indexCount?(m=this._displayList.removeFromList(c),
this._freeIndices(f,c.indexFrom,c.indexCount),p=b.indexCount,r=this._allocateIndices(f,p)):b.indexCount===c.indexCount?(h=!1,r=c.indexFrom,p=c.indexCount):(m=this._displayList.removeFromList(c),this._freeIndices(f,c.indexFrom+b.indexCount,c.indexCount-b.indexCount),r=c.indexFrom,p=b.indexCount);if(-1!==n&&-1!==r){d=this._storageFor(f);D.copyMeshData(n,r,d.vertexBuffers,d.indexBuffer,b,e,a);c.vertexFrom=n;c.indexFrom=r;c.vertexCount=b.vertexCount;c.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(c.geometryType,
c.indexFrom,c.indexCount);for(const g in e)this._dirtyMap.markDirtyVertices(c.geometryType,g,c.vertexFrom,c.vertexCount)}h&&this._displayList.addToList(c,m);return!0}-1!==n&&this._freeVertices(f,n,l);-1!==r&&this._freeIndices(f,r,p);c.setMeshDataFromBuffers(b,e,a);c.vertexFrom=void 0;c.vertexCount=0;c.indexFrom=void 0;c.indexCount=0;return!1};k.tryAddMeshData=function(c,b){const e=b.vertexBuffer;b=b.indexBuffer;var a=B[c.geometryType];const d=this._allocateVertices(a,c.vertexCount);if(-1===d)return this._freeVertices(a,
d,c.vertexCount),!1;const f=this._allocateIndices(a,c.indexCount);if(-1===f)return this._freeVertices(a,d,c.vertexCount),this._freeIndices(a,f,c.indexCount),!1;a=this._storageFor(a);D.copyMeshData(d,f,a.vertexBuffers,a.indexBuffer,c,e,b);c.vertexFrom=d;c.indexFrom=f;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(c.geometryType,c.indexFrom,c.indexCount);for(const n in e)this._dirtyMap.markDirtyVertices(c.geometryType,n,d,c.vertexCount)}this._displayList.addToList(c);return!0};k._allocateVertices=
function(c,b){c=this._storageFor(c);b=c.vtxFreeList.allocate(b);return-1===b||.5<c.vtxFreeList.fragmentation?-1:b};k._freeVertices=function(c,b,e){this._storageFor(c).vtxFreeList.free(b,e)};k._freeIndices=function(c,b,e){this._storageFor(c).idxFreeList.free(b,e)};k._allocateIndices=function(c,b){c=this._storageFor(c);b=c.idxFreeList.allocate(b);return-1===b||.5<c.idxFreeList.fragmentation?-1:b};k._storageFor=function(c){return this._freeListsAndStorage[c]};k._stridesFor=function(c,b){return this._strides[c][b]};
return A}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(y,D){let E=function(){function A(c){this._largestRange=null;this._parent=c;this._updateLargestRange()}var k=A.prototype;k.rangeCreated=function(c){if(!this._largestRange||c.count>this._largestRange.count)this._largestRange=c};k.rangeResized=function(c,b){if(c===this._largestRange)c.count<b&&this._updateLargestRange();else if(!this._largestRange||c.count>this._largestRange.count)this._largestRange=
c};k.findBestRange=function(c){let b=this._parent._freeHead,e=null;for(;null!==b;)b.count>=c&&(!e||b.count-c<e.count-c)&&(e=b),b=b.next;return e};k.findAdjacentRanges=function(c,b){let e=!0,a=!1,d=null,f=this._parent._freeHead;for(;e&&!a;){const n=null!==f?f.from:this._parent._size;c>=(null!==d?d.from+d.count:0)&&c+b<=n?(e=!1,a=!0):null!==f?(d=f,f=f.next):e=!1}return[d,f]};k._updateLargestRange=function(){let c=null,b=this._parent._freeHead;for(;null!==b;){if(!c||b.count>c.count)c=b;b=b.next}this._largestRange=
c};D._createClass(A,[{key:"largestRange",get:function(){return this._largestRange}}]);return A}(),B=function(){function A(c,b){this._allocated=0;this._size=c;this._freeHead=0<c?{from:0,count:c,prev:null,next:null}:null;this._bookKeeper=b||new E(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var k=A.prototype;k.allocate=function(c){const b=this._bookKeeper.findBestRange(c);if(null===b)return-1;const e=b.from,a=b.count;b.from+=c;b.count-=c;this._bookKeeper.rangeResized(b,e,a);this._allocated+=
c;0===b.count&&(c=null!==b.prev?this._freeHead:b.next,A._removeRange(b),this._freeHead=c);return e};k.free=function(c,b){const [e,a]=this._bookKeeper.findAdjacentRanges(c,b);c={from:c,count:b,prev:e,next:a};null!==e&&(e.next=c);null!==a&&(a.prev=c);this._bookKeeper.rangeCreated(c);this._allocated-=b;if(null!==a&&c.from+c.count===a.from){b=c.from;var d=c.count;A._fuse(c,a);A._removeRange(a);this._bookKeeper.rangeResized(c,b,d);this._bookKeeper.rangeResized(a,void 0,0)}null!==e&&e.from+e.count===c.from&&
(b=e.from,d=e.count,A._fuse(e,c),A._removeRange(c),this._bookKeeper.rangeResized(e,b,d),this._bookKeeper.rangeResized(c,void 0,0));this._freeHead=null!==c.prev?this._freeHead:c};A._removeRange=function(c){null!==c.prev?null!==c.next?(c.prev.next=c.next,c.next.prev=c.prev):c.prev.next=null:null!==c.next&&(c.next.prev=null)};A._fuse=function(c,b){c.count+=b.count;c.next=b.next;b.from+=b.count;b.count=0;null!==b.next&&(b.next.prev=c)};D._createClass(A,[{key:"fragmentation",get:function(){const c=this._size-
this._allocated;return 0===c?0:1-this._bookKeeper.largestRange.count/c}}]);return A}();y.FreeList=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define("../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Utils".split(" "),function(y,D,
E,B,A,k,c,b,e,a){return function(){function d(n){this.geometryMap=a.createGeometryData(()=>({indexBuffer:D.createIndex(n,35044),vao:null}),(l,h)=>({vertexBuffer:D.createVertex(n,a.C_VBO_INFO[h])}))}var f=d.prototype;f.dispose=function(){for(let n=0;5>n;n++){const l=this.geometryMap[n];if(l){l.data.vao&&l.data.vao.dispose(!1);l.data.indexBuffer&&l.data.indexBuffer.dispose();for(const h in l.buffers)l.buffers[h]&&l.buffers[h].data.vertexBuffer.dispose()}}};f.get=function(n){const l=this.geometryMap[n];
return{draw(h,m,r,p,g){if(!l.data.vao){const q={};for(const u in l.buffers)q[u]=l.buffers[u].data.vertexBuffer;l.data.vao=new B(h,r,m,q,l.data.indexBuffer)}h.bindVAO(l.data.vao);h.drawElements(4,g,5125,Uint32Array.BYTES_PER_ELEMENT*p);h.bindVAO(null)}}};f.has=function(n){return null!=this.geometryMap[n]};f.upload=function(n,l){l.forEach((h,m)=>{this._upload(h,m,n)})};f._upload=function(n,l,h){n.indices&&(n.indices.allDirty?this._uploadIndices(h,l):null!=n.indices.from&&null!=n.indices.count&&this._uploadIndices(h,
l,n.indices.from,n.indices.count));if(n.vertices){n=n.vertices;for(const m in n){const r=n[m];r.allDirty?this._uploadVertices(h,l,m):null!=r.from&&null!=r.count&&this._uploadVertices(h,l,m,r.from,r.count)}}};f._uploadVertices=function(n,l,h,m,r){const p=this.geometryMap[l];p&&(l=n.geometries[l].vertexBuffer[h])&&(n=l.stride,l=l.data.buffer,p.buffers[h]&&0<l.byteLength&&(null!=m&&null!=r?p.buffers[h].data.vertexBuffer.setSubData(l,m*n,m*n,(m+r)*n):p.buffers[h].data.vertexBuffer.setData(l)))};f._uploadIndices=
function(n,l,h,m){const r=this.geometryMap[l];r&&(n=n.geometries[l].indexBuffer.buffer,r.data.indexBuffer&&0<n.byteLength&&(null!=h&&null!=m?r.data.indexBuffer.setSubData(n,4*h,4*h,4*(h+m)):r.data.indexBuffer.setData(n)))};return d}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./TiledDisplayObject"],function(y,D,E,B){B=function(A){function k(c,b){return A.call(this,c,b,[E.TILE_SIZE,E.TILE_SIZE])||this}D._inheritsLoose(k,
A);return k}(B.TiledDisplayObject);y.WGLTile=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../chunks/mat3 ../../tiling/TileKey ../../../../chunks/mat3f32 ../DisplayObject".split(" "),function(y,D,E,B,A,k,c){E=function(b){function e(d,f,n,l=n){var h=b.call(this)||this;h.triangleCountReportedInDebug=0;h.transforms={dvs:k.create(),tileMat3:k.create()};
h.triangleCount=0;h.key=new A(d);h.bounds=f;h.size=n;h.coordRange=l;return h}D._inheritsLoose(e,b);var a=e.prototype;a.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};a.setTransform=function(d,f){f/=d.resolution*d.pixelRatio;const n=this.transforms.tileMat3,[l,h]=d.toScreenNoRotation([0,0],this.coords);B.set(n,this.size[0]/this.coordRange[0]*f,0,0,0,this.size[1]/this.coordRange[1]*f,0,l,h,1);B.multiply(this.transforms.dvs,d.displayViewMat3,n)};D._createClass(e,[{key:"coords",
get:function(){return this._coords}},{key:"bounds",get:function(){return this._bounds},set:function(d){this._coords=[d[0],d[3]];this._bounds=d}}]);return e}(c.DisplayObject);y.TiledDisplayObject=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./Utils ./cpuMapped/DisplayRecordReader ./MemoryRequirements ./TileBufferData ./WGLDisplayRecord ./WGLDisplayObject ./TileDisplayData ./mesh/VertexBuffer ./util/Writer ./mesh/VertexVector".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f){const n=new A,l=new A;A=function(){function h(){this.tileBufferData=this.tileDisplayData=null}var m=h.prototype;m.reshuffle=function(){n.reset();const r=e.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var p of r)for(var g of p)g&&n.needMore(g.geometryType,g.meshData?g.meshData.vertexCount:g.vertexCount,g.meshData?g.meshData.indexData.length:g.indexCount);p=r.length;g=new k;for(var q=0;q<p;++q){g.geometries[q].indexBuffer=new Uint32Array(Math.round(1.5*
n.indicesFor(q)));var u=[];for(var v in this.tileBufferData.geometries[q].vertexBuffer)u.push(this.tileBufferData.geometries[q].vertexBuffer[v].stride);u=h._computeVertexAlignment(u);var z=Math.round(1.5*n.verticesFor(q));u=h._align(z,u);for(var t in this.tileBufferData.geometries[q].vertexBuffer)z=this.tileBufferData.geometries[q].vertexBuffer[t].stride,g.geometries[q].vertexBuffer[t]={stride:z,data:E.allocateTypedArrayBuffer(u,z)}}l.reset();this.tileDisplayData.displayList.clear();for(v=0;v<p;++v){t=
r[v];for(const w of t){if(w.meshData)w.writeMeshDataToBuffers(l.verticesFor(v),g.geometries[v].vertexBuffer,l.indicesFor(v),g.geometries[v].indexBuffer),w.meshData=null;else{t=this.tileBufferData.geometries[v].vertexBuffer;q=this.tileBufferData.geometries[v].indexBuffer;u=g.geometries[v].vertexBuffer;z=g.geometries[v].indexBuffer;const x=l.verticesFor(v),C=l.indicesFor(v);E.copyMeshData(x,C,u,z,w,t,q);w.vertexFrom=x;w.indexFrom=C}l.needMore(v,w.vertexCount,w.indexCount)}}for(const w of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(w.displayRecords);
this.tileBufferData=g};m.getStrides=function(){const r=[];for(let p=0;p<this.tileBufferData.geometries.length;++p){const g=this.tileBufferData.geometries[p];r[p]={};for(const q in g.vertexBuffer)r[p][q]=g.vertexBuffer[q].stride}return r};m.clone=function(){const r=new h;r.tileBufferData=this.tileBufferData.clone();r.tileDisplayData=this.tileDisplayData.clone();return r};m._guessSize=function(){const {displayObjects:r}=this.tileDisplayData,p=Math.min(r.length,4);let g=0;for(let q=0;q<p;q++)g=Math.max(g,
r[q].displayRecords.length);return 2*(12*r.length+r.length*g*40)};m.serialize=function(){const r=this.tileBufferData.serialize(),p=this.tileBufferData.getBuffers(),g=this.tileDisplayData.serialize(new d(Int32Array,this._guessSize())).buffer();p.push(g);return{result:{displayData:g,bufferData:r},transferList:p}};h.fromVertexData=function(r){const p=[],g={},q=new Map;E.forEachGeometryType(u=>{const v=r.data[u];if(D.isSome(v)){const w=B.DisplayRecordReader.from(v.records).getCursor();for(;w.next();){var z=
w.id;const x=w.materialKey;var t=w.insertAfter;const C=w.indexFrom,F=w.indexCount,H=w.vertexFrom,J=w.vertexCount;if(!q.has(z)){const K=new b(z);K.insertAfter=t;q.set(z,K);p.push(K)}t=q.get(z);z=new c(z,u,x);z.indexFrom=C;z.indexCount=F;z.vertexFrom=H;z.vertexCount=J;t.displayRecords.push(z)}g[u]=a.VertexBuffers.fromVertexData(v,u)}else g[u]=(new f.VertexVectors(u,0)).intoBuffers()});p.sort((u,v)=>u.id-v.id);return h.fromMeshData({displayObjects:p,vertexBuffersMap:g})};h.fromMeshData=function(r){const p=
new h,g=new e["default"],q=new k;g.displayObjects=r.displayObjects;for(const u in r.vertexBuffersMap){const v=r.vertexBuffersMap[u];q.geometries[u].indexBuffer=v.indexBuffer;q.geometries[u].vertexBuffer=v.namedBuffers}p.tileDisplayData=g;p.tileBufferData=q;return p};h.bind=function(r,p){const g=new h;g.tileDisplayData=r;g.tileBufferData=p;return g};h.create=function(r,p){const g=new h;g.tileDisplayData=new e["default"];g.tileDisplayData.displayObjects=r;const q=[0,0,0,0,0],u=[0,0,0,0,0],v=[[],[],
[],[],[]];for(var z of r)for(var t of z.displayRecords)v[t.geometryType].push(t),q[t.geometryType]+=t.meshData.vertexCount,u[t.geometryType]+=t.meshData.indexData.length;r=new k;p=[p.fill||{},p.line||{},p.icon||{},p.text||{},p.label||{}];for(z=0;5>z;z++){t=new Uint32Array(u[z]);{var w=p[z];var x=q[z];const C={};for(const F in w){const H={data:E.allocateTypedArrayBuffer(x,w[F]),stride:w[F]};C[F]=H}w=C}c.writeAllMeshDataToBuffers(v[z],w,t);r.geometries[z]={indexBuffer:t,vertexBuffer:w}}g.tileBufferData=
r;return g};h._align=function(r,p){const g=r%p;return 0===g?r:r+(p-g)};h._computeVertexAlignment=function(r){let p=!1,g=!1;for(const q of r)2===q%4?p=!0:0!==q%4&&(g=!0);return g?4:p?2:1};return h}();y.TileData=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(y){return function(){function D(){this._byGeometryType=null}var E=D.prototype;E.reset=function(){this._byGeometryType=
null};E.verticesFor=function(B){return this._byGeometryType?this._byGeometryType[B].vertices:0};E.indicesFor=function(B){return this._byGeometryType?this._byGeometryType[B].indices:0};E.needMore=function(B,A,k){if(A||k)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),B=this._byGeometryType[B],B.vertices+=A,B.indices+=k};y._createClass(D,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);
return D}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(y){return function(){function D(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var E=D.prototype;E.clone=function(){const B=new D;for(let A=0;A<this.geometries.length;A++){const k=this.geometries[A],c=B.geometries[A];c.indexBuffer=k.indexBuffer.slice();
c.vertexBuffer={};for(const b in k.vertexBuffer){const {data:e,stride:a}=k.vertexBuffer[b];c.vertexBuffer[b]={data:e.slice(),stride:a}}}return B};D.deserialize=function(B){const A=new D;for(let k=0;5>k;++k){A.geometries[k].indexBuffer=new Uint32Array(B.geometries[k].indexBuffer);A.geometries[k].vertexBuffer={};for(const c in B.geometries[k].vertexBuffer)A.geometries[k].vertexBuffer[c]={data:y.allocateTypedArrayBufferwithData(B.geometries[k].vertexBuffer[c].data,B.geometries[k].vertexBuffer[c].stride),
stride:B.geometries[k].vertexBuffer[c].stride}}return A};E.serialize=function(){const B={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let A=0;5>A;++A)for(const k in this.geometries[A].vertexBuffer)B.geometries[A].vertexBuffer[k]=
{data:this.geometries[A].vertexBuffer[k].data.buffer,stride:this.geometries[A].vertexBuffer[k].stride};return B};E.getBuffers=function(){const B=[];for(let A=0;5>A;++A){B.push(this.geometries[A].indexBuffer.buffer);for(const k in this.geometries[A].vertexBuffer)B.push(this.geometries[A].vertexBuffer[k].data.buffer)}return B};return D}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Utils","./MeshData"],function(y,D,E){return function(){function B(k,
c,b,e=0,a=0){this.id=k;this.geometryType=c;this.materialKey=b;this.minZoom=e;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var A=B.prototype;A.clone=function(){return this.copy()};A.copy=function(){const k=new B(this.id,this.geometryType,this.materialKey);k.vertexFrom=this.vertexFrom;k.vertexCount=this.vertexCount;k.indexFrom=this.indexFrom;k.indexCount=this.indexCount;k.zOrder=this.zOrder;k.symbolLevel=this.symbolLevel;
k.meshData=this.meshData;k.minZoom=this.minZoom;k.maxZoom=this.maxZoom;return k};A.setMeshDataFromBuffers=function(k,c,b){const e=new E;for(const a in c){const d=c[a].stride,f=c[a].data,n=[],l=D.strideToPackingFactor(d);for(let h=0;h<d*k.vertexCount/l;++h)n[h]=f[h+d*k.vertexFrom/l];e.vertexData.set(a,n)}e.indexData.length=0;for(c=0;c<k.indexCount;++c)e.indexData[c]=b[c+k.indexFrom]-k.vertexFrom;e.vertexCount=k.vertexCount;this.meshData=e};A.readMeshDataFromBuffers=function(k,c){this.meshData?this.meshData.clear():
this.meshData=new E;for(const b in k){const e=k[b].stride,a=k[b].data,d=[],f=D.strideToPackingFactor(e);for(let n=0;n<e*this.vertexCount/f;++n)d[n]=a[n+e*this.vertexFrom/f];this.meshData.vertexData.set(b,d)}this.meshData.indexData.length=0;for(k=0;k<this.indexCount;++k)this.meshData.indexData[k]=c[k+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};A.writeMeshDataToBuffers=function(k,c,b,e){for(const a in c){const d=c[a].stride,f=this.meshData.vertexData.get(a),n=c[a].data,
l=D.strideToPackingFactor(d);for(let h=0;h<d*this.meshData.vertexCount/l;++h)n[h+d*k/l]=f[h]}for(c=0;c<this.meshData.indexData.length;++c)e[c+b]=this.meshData.indexData[c]+k;this.vertexFrom=k;this.vertexCount=this.meshData.vertexCount;this.indexFrom=b;this.indexCount=this.meshData.indexData.length};B.writeAllMeshDataToBuffers=function(k,c,b){let e=0,a=0;for(const d of k)d.writeMeshDataToBuffers(e,c,a,b),e+=d.vertexCount,a+=d.indexCount};A._computeSortKey=function(){this._sortKey=(this.symbolLevel&
31)<<12|(this.zOrder&127)<<4|this.geometryType&7};A.serialize=function(k){k.push(this.geometryType);k.push(this.materialKey);k.push(this.vertexFrom);k.push(this.vertexCount);k.push(this.indexFrom);k.push(this.indexCount);k.push(this.minZoom);k.push(this.maxZoom);return k};B.deserialize=function(k,c){const b=k.readInt32(),e=k.readInt32();c=new B(c.id,b,e);c.vertexFrom=k.readInt32();c.vertexCount=k.readInt32();c.indexFrom=k.readInt32();c.indexCount=k.readInt32();c.minZoom=k.readInt32();c.maxZoom=k.readInt32();
return c};y._createClass(B,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return B}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function y(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var D=y.prototype;D.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};D.update=function(E,B,A){for(const k in E)this.vertexData.set(k,E[k]);for(const k in this.vertexData)null===
E[k]&&this.vertexData.delete(k);this.vertexCount=B;this.indexData=A};return y}()})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(y,D){return function(){function E(A){this.insertAfter=null;this.id=A;this.displayRecords=[]}var B=E.prototype;B.copy=function(){const A=new E(this.id);A.set(this);return A};B.clone=function(){const A=new E(this.id);A.displayRecords=this.displayRecords.map(k=>k.clone());A.insertAfter=this.insertAfter;
return A};B.set=function(A){this.id=A.id;this.displayRecords=A.displayRecords;this.insertAfter=A.insertAfter};B.serialize=function(A){A.push(this.id);D.serializeList(A,this.displayRecords);return A};E.deserialize=function(A){const k=A.readInt32(),c=new E(k);c.displayRecords=D.deserializeList(A,y,{id:k});return c};return E}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(y){y.deserializeList=function(D,E,B){var A=D.readInt32();A=Array(A);for(let k=0;k<
A.length;k++)A[k]=E.deserialize(D,B);return A};y.serializeList=function(D,E){if(null===E)D.push(0);else{D.push(E.length);for(const B of E)B.serialize(D);return D}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./util/serializationUtils","./WGLDisplayObject"],function(y,D,E,B,A){let k=function(){function c(){}var b=c.prototype;b.computeDisplayList=function(){this._displayList=
new E;for(const e of this.displayObjects)for(const a of e.displayRecords)this._displayList.addToList(a)};b.clone=function(){const e=new c;this.displayObjects&&(e.displayObjects=this.displayObjects.map(a=>a.clone()));return e};b.serialize=function(e){B.serializeList(e,this.displayObjects);return e};b._deserializeObjects=function(e){var a=e.readInt32();a=Array(a);const d=new Map;for(let f=0;f<a.length;++f){const n=A.deserialize(e);a[f]=n;d.set(n.id,n)}this.displayObjects=a;this._displayList=null;this._displayObjectRegistry=
d};c.deserialize=function(e){const a=new c;a._deserializeObjects(e);return a};D._createClass(c,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const e of this.displayObjects)this._displayObjectRegistry.set(e.id,e)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return c}();y.default=k;y.groupRecordsByGeometryType=function(c){const b=[[],[],[],[],[]];for(const e of c)for(const a of e.displayRecords)b[a.geometryType].push(a);
return b};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],function(y,D){function E(e,a,d,...f){a<e.length?e.splice(a,d,...f):e.push(...f)}const B=new Map;B.set(D.WGLDrawPhase.MAP,[D.WGLGeometryType.FILL,D.WGLGeometryType.LINE,D.WGLGeometryType.MARKER,D.WGLGeometryType.TEXT]);B.set(D.WGLDrawPhase.LABEL,[D.WGLGeometryType.LABEL]);B.set(D.WGLDrawPhase.LABEL_ALPHA,[D.WGLGeometryType.LABEL]);
D=function(){function e(){this.symbolLevels=[]}var a=e.prototype;a.replay=function(d,f,n){for(const h of this.symbolLevels)for(const m of h.zLevels){var l=m.geometryDPInfo.unified;if(l)for(const r of l){l=d.painter.getGeometryBrush(r.geometryType);const p=f.getGeometry(r.geometryType),g={geometryType:r.geometryType,materialKey:r.materialKey,indexFrom:r.indexFrom,indexCount:r.indexCount,draw:(q,u,v)=>{p.draw(q,u,v,r.indexFrom,r.indexCount)}};l.prepareState(d,f);l.drawGeometry(d,f,g,n)}}};a.clear=function(){this.symbolLevels.length=
0};a.addToList=function(d,f){if(Array.isArray(d))for(const n of d)this._addToList(n,f);else this._addToList(d,f)};a.removeFromList=function(d){Array.isArray(d)||(d=[d]);let f=null;for(const n of d)f=this._removeFromList(n);return f};a.clone=function(){const d=new e;for(const f of this.symbolLevels)d.symbolLevels.push(f.clone());return d};a.splitAfter=function(d){const f=this._getDisplayList(d.symbolLevel,d.zOrder),n=f.length,l=d.indexFrom+d.indexCount;for(let h=0;h<n;++h){const m=f[h];if(m.geometryType===
d.geometryType&&l>m.indexFrom&&l<=m.indexFrom+m.indexCount)return l<m.indexFrom+m.indexCount&&(d=new A,d.geometryType=m.geometryType,d.materialKey=m.materialKey,d.indexFrom=l,d.indexCount=m.indexFrom+m.indexCount-l,f.splice(h+1,0,d),m.indexCount=l-m.indexFrom),h}};a._addToList=function(d,f){const n=this._getDisplayList(d.symbolLevel,d.zOrder);f=null!=f?f:n.length-1;var l=0<=f&&f<n.length?n[f]:null;null!==l&&l.materialKey===d.materialKey&&l.indexFrom+l.indexCount===d.indexFrom&&l.geometryType===d.geometryType?
l.indexCount+=d.indexCount:(l=new A,l.indexFrom=d.indexFrom,l.indexCount=d.indexCount,l.materialKey=d.materialKey,l.geometryType=d.geometryType,E(n,f+1,0,l))};a._removeFromList=function(d){const f=this._getDisplayList(d.symbolLevel,d.zOrder);var n=f.length;let l=void 0;for(var h=0;h<n;++h){var m=f[h];if(d.indexFrom+d.indexCount>m.indexFrom&&d.indexFrom<m.indexFrom+m.indexCount&&m.geometryType===d.geometryType){l=h;break}}if(void 0!==l){n=f[l];if(d.indexFrom===n.indexFrom)return n.indexCount-=d.indexCount,
n.indexFrom+=d.indexCount,0===n.indexCount&&E(f,l,1),l-1;if(d.indexFrom+d.indexCount===n.indexFrom+n.indexCount)return n.indexCount-=d.indexCount,0===n.indexCount?(E(f,l,1),l-1):l;{h=n.indexFrom;m=d.indexFrom-n.indexFrom;const r=d.indexCount;d=n.indexFrom+n.indexCount-(d.indexFrom+d.indexCount);n.indexCount=m;const p=new A;p.geometryType=n.geometryType;p.materialKey=n.materialKey;p.indexFrom=h+m+r;p.indexCount=d;E(f,l+1,0,p);return l}}return null};a._getDisplayList=function(d,f){let n;var l=this.symbolLevels.length;
for(let m=0;m<l;m++)if(this.symbolLevels[m].symbolLevel===d){n=this.symbolLevels[m];break}n||(n=new b,n.symbolLevel=d,this.symbolLevels.push(n));let h;d=n.zLevels.length;for(l=0;l<d;l++)if(n.zLevels[l].zLevel===f){h=n.zLevels[l];break}h||(h=new c,h.geometryDPInfo=new k,h.zLevel=f,n.zLevels.push(h));h.geometryDPInfo.unified||(h.geometryDPInfo.unified=[]);return h.geometryDPInfo.unified};a.getDPInfoType=function(){return"unified"};y._createClass(e,[{key:"empty",get:function(){return!this.symbolLevels||
0===this.symbolLevels.length}}]);return e}();let A=function(){function e(){this.materialKey=null;this.indexCount=this.indexFrom=0}e.prototype.clone=function(){const a=new e;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return e}(),k=function(){function e(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}e.prototype.clone=function(){const a=new e;a.fill=this.fill&&this.fill.map(d=>d.clone());
a.line=this.line&&this.line.map(d=>d.clone());a.marker=this.marker&&this.marker.map(d=>d.clone());a.text=this.text&&this.text.map(d=>d.clone());a.label=this.label&&this.label.map(d=>d.clone());a.unified=this.unified&&this.unified.map(d=>d.clone());return a};return e}(),c=function(){function e(){this.geometryDPInfo=new k}e.prototype.clone=function(){const a=new e;a.zLevel=this.zLevel;a.geometryDPInfo=this.geometryDPInfo.clone();return a};return e}(),b=function(){function e(){this.zLevels=[]}e.prototype.clone=
function(){const a=new e;a.symbolLevel=this.symbolLevel;for(const d of this.zLevels)a.zLevels.push(d.clone());return a};return e}();return D})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(y,D){let E=function(){function A(k,c){this.data=k;this.stride=c}A.decode=function(k){const c=D.allocateTypedArrayBufferwithData(k.data,k.stride);return new A(c,k.stride)};A.fromVertexVector=function(k){const c=D.allocateTypedArrayBufferwithData(k.data.buffer(),
k.stride);return new A(c,k.stride)};return A}(),B=function(){function A(k,c,b){this.geometryType=k;this.indexBuffer=new Uint32Array(c);this.namedBuffers=b}A.decode=function(k){const c=k.geometryType,b=k.indexBuffer,e={};for(const a in k.namedBuffers)e[a]=E.decode(k.namedBuffers[a]);return new A(c,b,e)};A.fromVertexData=function(k,c){const b=k.indices,e=D.allocateTypedArrayBufferwithData(k.vertices,k.stride);k={geometry:new E(e,k.stride)};return new A(c,b,k)};A.fromVertexVectors=function(k){const c=
k.geometryType,b=k.indexVector.buffer(),e={};for(const a in k.namedVectors)e[a]=E.fromVertexVector(k.namedVectors[a]);return new A(c,b,e)};return A}();y.VertexBuffers=B;y.default=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(y){return function(){function D(B,A){this._pos=0;A=A?this._roundToNearest(A,B.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(A);this._buffer=new B(this._array);
this._ctor=B;this._i16View=new Int16Array(this._array)}var E=D.prototype;E._roundToNearest=function(B,A){B=Math.round(B);return B+(A-B%A)};E._ensureSize=function(B){if(this._pos+B>=this._buffer.length){B=this._roundToNearest(1.5*(this._array.byteLength+B*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);B=new ArrayBuffer(B);const A=new this._ctor(B);A.set(this._buffer,0);this._array=B;this._buffer=A;this._i16View=new Int16Array(this._array)}};E.writeF32=function(B){this._ensureSize(1);
const A=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=B;this._pos++;return A};E.push=function(B){this._ensureSize(1);const A=this._pos;this._buffer[this._pos++]=B;return A};E.writeFixed=function(B){this._buffer[this._pos++]=B};E.setValue=function(B,A){this._buffer[B]=A};E.i1616Add=function(B,A,k){this._i16View[2*B]+=A;this._i16View[2*B+1]+=k};E.getValue=function(B){return this._buffer[B]};E.incr=function(B){if(this._buffer.length<B)throw Error("Increment index overflows the target buffer");
this._buffer[B]++};E.decr=function(B){this._buffer[B]--};E.writeRegion=function(B){this._ensureSize(B.length);const A=this._pos;this._buffer.set(B,this._pos);this._pos+=B.length;return A};E.writeManyFrom=function(B,A,k){for(this._ensureSize(k-A);A!==k;A++)this.writeFixed(B._buffer[A])};E.buffer=function(){const B=this._array.slice(0,4*this._pos);this.destroy();return B};E.toArray=function(){const B=this._array,A=[];for(let k=0;k<B.byteLength/4;k++)A.push(B[k]);return A};E.seek=function(B){this._pos=
B};E.destroy=function(){this._buffer=this._array=null};y._createClass(D,[{key:"length",get:function(){return this._pos}}]);return D}()})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(y,D,E,B,A){let k=function(){function b(e,a){this.data=e;this.stride=a}b.prototype.transfer=function(e,a){const d=this.data.buffer();e.vertexCount=this.vertexCount;e.data=d;e.stride=this.stride;
a.push(d)};D._createClass(b,[{key:"vertexCount",get:function(){const e=this.data.length/(this.stride/4);e!==(e|0)&&console.debug("Corrupted stride");return e}}]);return b}(),c=function(){function b(a,d,f=!1){this.geometryType=a;this.indexVector=new A(Uint32Array,6*d);this.namedVectors={};a=E.getStrides(a,f);for(const n in a){f=a[n];let l;switch(f%4){case 0:case 2:l=new A(Uint32Array,f*d);break;case 1:case 3:l=new A(Uint8Array,f*d)}this.namedVectors[n]=new k(l,f)}}var e=b.prototype;e.get=function(a){return this.namedVectors[a].data};
e.getVector=function(a){return this.namedVectors[a]};e.transfer=function(a,d){const f=this.indexVector.buffer(),n={};d.push(f);for(const l in this.namedVectors){const h=this.namedVectors[l];n[l]={};h.transfer(n[l],d)}a.geometryType=this.geometryType;a.indexBuffer=f;a.namedBuffers=n;this.destroy()};e.intoBuffers=function(){const a=B.VertexBuffers.fromVertexVectors(this);this.destroy();return a};e.destroy=function(){this.namedVectors=this.indexVector=null};return b}();y.VertexVectors=c;y.default=k;
Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/mathUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h){function m(z,t){return w=>t(z(w))}const r=k.getLogger("esri.views.layers.2d.features.support.AttributeStore"),p=l.createDebugLogger(l.DEBUG_ATTR_UPDATES,r),g=z=>1===(z&2147483648)>>>31?254:255;var q=B("esri-shared-array-buffer"),u=B("esri-atomics");let v=function(){function z(w,x,C,F){this.size=0;this.texelSize=4;const {pixelType:H,layout:J,textureOnly:K}=F;this.textureOnly=K||!1;this.pixelType=H;this._ctype=x;this.layout=J;this._resetRange();this._shared=w;
this.size=C;K||(this.data=this._initData(H,C,w,x))}var t=z.prototype;t.unsetComponentAllTexels=function(w,x){const C=A.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)C[F*this.texelSize+w]&=~x;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};t.setComponentAllTexels=function(w,x){const C=A.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)C[F*this.texelSize+w]|=255&x;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};t.setComponent=function(w,x,C){const F=A.unwrap(this.data);
for(const H of C)F[H*this.texelSize+w]|=x,this.dirtyStart=Math.min(this.dirtyStart,H),this.dirtyEnd=Math.max(this.dirtyEnd,H)};t.setComponentTexel=function(w,x,C){A.unwrap(this.data)[C*this.texelSize+w]|=x;this.dirtyStart=Math.min(this.dirtyStart,C);this.dirtyEnd=Math.max(this.dirtyEnd,C)};t.unsetComponentTexel=function(w,x,C){A.unwrap(this.data)[C*this.texelSize+w]&=~x;this.dirtyStart=Math.min(this.dirtyStart,C);this.dirtyEnd=Math.max(this.dirtyEnd,C)};t.getData=function(w,x){w&=2147483647;return A.unwrap(this.data)[w*
this.texelSize+x]};t.setData=function(w,x,C){w&=2147483647;0===(this.layout&1<<x)?r.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[w*this.texelSize+x]=C,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};t.lock=function(){5121===this.pixelType&&this._shared&&u&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};t.unlock=function(){5121===this.pixelType&&this._shared&&u&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};t.expand=function(w){this.size=w;if(!this.textureOnly){w=this._initData(this.pixelType,w,this._shared,this._ctype);const x=A.unwrap(this.data);w.set(x);this.data=w}};t.toMessage=function(){const w=this.dirtyStart,x=this.dirtyEnd;var C=this.texelSize;if(w>x)return null;this._resetRange();const F=!this._shared&&"local"!==this._ctype,H=this.pixelType,J=this.layout,K=A.unwrap(this.data);if(!K.slice){if(!F)return{start:w,end:x,data:null,pixelType:H,layout:J};C=new (n.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,
w*C,(x+1)*C));return{start:w,end:x,data:C,pixelType:H,layout:J}}C=F&&K.slice(w*C,(x+1)*C)||null;return{start:w,end:x,data:C,pixelType:H,layout:J}};t._initData=function(w,x,C,F){C=C&&"local"!==F?SharedArrayBuffer:ArrayBuffer;w=n.getPixelArrayCtor(w);x=new w(new C(x*x*4*w.BYTES_PER_ELEMENT));for(w=0;w<x.length;w+=4)x[w+1]=255;return x};t._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};E._createClass(z,[{key:"buffer",get:function(){return A.andThen(this.data,w=>w.buffer)}}]);return z}();
k=function(){function z(w,x){this._client=w;this.config=x;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(f.MAX_FILTERS);this._targetType=0;this._abortController=b.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;w=x.supportsTextureFloat?5126:5121;p(`Creating AttributeStore ${q?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:w,layout:15},{pixelType:w,
layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var t=z.prototype;t.destroy=function(){this._abortController.abort()};t.update=function(w,x){this.config=x;x=x.schema.processors[0].storage;const C=a.diff(this._schema,x);if(w.targets.feature||w.targets.aggregate)w.storage.data=!0;if(C&&(B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",C),w.storage.data=!0,this._schema=x,this._attributeComputeMap.clear(),!A.isNone(x))){switch(x.target){case "feature":this._targetType=
0;break;case "aggregate":this._targetType=1}for(const F of x.mapping)this._bindAttribute(F)}};t.onTileData=function(w,x){if(!A.isNone(x.addOrUpdate))for(w=x.addOrUpdate.getCursor();w.next();)x=w.getDisplayId(),this.setAttributeData(x,w)};t.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=b.createAbortController()};t.setHighlight=async function(w,x){const C=this._getBlock(0);x=x.map(F=>F&2147483647);C.lock();C.unsetComponentAllTexels(0,
1);C.setComponent(0,1,x);C.unlock();this._idsToHighlight.clear();for(const F of w)this._idsToHighlight.add(F);await this.sendUpdates()};t.updateFilters=async function(w,x){const {config:C,service:F,spatialReference:H}=x;({filters:x}=C);x=x.map((J,K)=>this._updateFilter(J,K,F,H));(await Promise.all(x)).some(J=>J)&&(w.storage.filters=!0,B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))};t.setData=function(w,x,C,F){this._ensureSizeForTexel(w&2147483647);
this._getBlock(x).setData(w,C,F)};t.getData=function(w,x,C){return this._getBlock(x).getData(w,C)};t.getHighlightFlag=function(w){return this._idsToHighlight.has(w)?f.HIGHLIGHT_FLAG:0};t.unsetAttributeData=function(w){w&=2147483647;this._getBlock(0).setData(w,0,0)};t.setAttributeData=function(w,x){const C=w&2147483647;this._ensureSizeForTexel(C);this._getBlock(0).setData(C,0,this.getFilterFlags(x));if(this._targetType===(w&2147483648)>>>31){w=this._attributeComputeMap;var F=this.config.supportsTextureFloat?
1:2;w.size&&w.forEach((H,J)=>{const K=J*F%4;J=this._getBlock(Math.floor(J*F/4)+f.ATTRIBUTE_DATA_VV);H=H(x);if(this.config.supportsTextureFloat)J.setData(C,K,H);else if(H===f.NAN_MAGIC_NUMBER)J.setData(C,K,255),J.setData(C,K+1,255);else{H=e.clamp(Math.round(H),-32767,32766)+32768;const N=(H&65280)>>8;J.setData(C,K,H&255);J.setData(C,K+1,N)}})}};t.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=b.createResolver(),this._nextUpdate.promise;
const w={blocks:this._blocks.map(x=>A.isSome(x)?x.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var x=()=>{this._currUpdate=null;if(this._nextUpdate){const C=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>C.resolve())}};x=this._client.update(w,this._signal).then(x).catch(x);this._client.render(this._signal);return x}).catch(x=>{if(b.isAbortError(x))return this._createResourcesPromise=null,this._createResources();r.error(new c("mapview-attribute-store",
"Encountered an error during client update",x));return Promise.resolve()})};t._ensureSizeForTexel=function(w){for(;w>=this._size*this._size&&!this._expand(););};t._bindAttribute=function(w){function x(){return w.normalizationField?H=>{const J=H.readAttribute(w.normalizationField);return J?H.readAttribute(w.field)/J:null}:H=>H.readAttribute(w.field)}function C(){w.normalizationField&&r.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");
return H=>H.getComputedNumericAtIndex(w.fieldIndex)}let F;if(null!=w.fieldIndex)F=C();else if(w.field)F=x();else return;w.valueRepresentation&&(F=m(F,H=>h.getVisualVariableSizeValueRepresentationRatio(H,w.valueRepresentation)));this._attributeComputeMap.set(w.binding,m(F,H=>null===H||isNaN(H)||Infinity===H?f.NAN_MAGIC_NUMBER:H))};t._createResources=function(){if(A.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(f.ATTRIBUTE_DATA_ANIMATION);p("Initializing AttributeStore");
var w={shared:q&&"local"!==this._client.type,size:this._size,blocks:A.mapMany(this._blocks,x=>({textureOnly:x.textureOnly,buffer:x.buffer,pixelType:x.pixelType}))};this._createResourcesPromise=w=this._client.initialize(w,this._signal).catch(x=>{b.isAbortError(x)?this._createResourcesPromise=null:r.error(new c("mapview-attribute-store","Encountered an error during client initialization",x))});w.then(()=>A.isNone(this._createResourcesPromise)?this._createResources():void 0);return w};t._getBlock=function(w){var x=
this._blocks[w];if(A.isSome(x))return x;p(`Initializing AttributeBlock at index ${w}`);x=new v(q,this._client.type,this._size,this._blockDescriptors[w]);this._blocks[w]=x;this._createResourcesPromise=null;return x};t._expand=function(){if(this._size<this.config.maxTextureSize){const w=this._size<<=1;p("Expanding block size to",w,this._blocks);A.forEachSome(this._blocks,x=>x.expand(w));this._createResourcesPromise=null;this._size=w;return 0}r.error(new c("mapview-limitations","Maximum number of onscreen features exceeded."));
return-1};t._updateFilter=async function(w,x,C,F){const H=this._filters[x],J=A.isSome(H)&&H.hash;if(!H&&!w||J===JSON.stringify(w))return!1;if(A.isNone(w))return w=1<<x+1,C=this._getBlock(0),this._filters[x]=null,C.setComponentAllTexels(0,w),this.sendUpdates(),!0;await (await this._getFilter(x,C)).update(w,F);return!0};t._getFilter=async function(w,x){var C=this._filters[w];if(A.isSome(C))return C;({default:C}=await new Promise(function(F,H){y(["../../../../../layers/graphics/data/FeatureFilter"],
function(J){F(Object.freeze({__proto__:null,"default":J}))},H)}));x=new C({geometryType:x.geometryType,hasM:!1,hasZ:!1,timeInfo:x.timeInfo,fieldsIndex:new d(x.fields)});return this._filters[w]=x};t.isVisible=function(w){return!!(this._getBlock(0).getData(w,0)&2)};t.getFilterFlags=function(w){let x=0;var C=g(w.getDisplayId());for(let H=0;H<this._filters.length;H++){var F=this._filters[H];F=!(C&1<<H)||A.isNone(F)||F.check(w);x|=(F?1:0)<<H}C=0;this._idsToHighlight.size&&(w=w.getObjectId(),C=this.getHighlightFlag(w));
return x<<1|C};E._createClass(z,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}}]);return z}();D.DISPLAY_ID_TYPE_AGGREGATE=1;D.DISPLAY_ID_TYPE_FEATURE=0;D.default=k;D.getDisplayIdFilterMask=g;D.getDisplayIdTexel=z=>z&2147483647;D.getDisplayIdType=z=>(z&2147483648)>>>31;D.isAggregateId=function(z){return 1===(z&2147483648)>>>31};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],
function(y){y.DEBUG_ATTR_UPDATES=!1;y.createDebugLogger=(D,E)=>D&&((...B)=>E.warn("DEBUG:",...B))||(()=>null);Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/color ../../../../engine/webgl/visualVariablesUtils".split(" "),function(y,D,E,B,
A,k,c){function b(h){return{value:h.value,size:E.toPt(h.size)}}function e(h){return h.map(m=>b(m))}function a(h){return"string"===typeof h||"number"===typeof h?E.toPt(h):{type:"size",expression:h.expression,stops:e(h.stops)}}function d(h){const m={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof h.field)if(h.stops){if(8<h.stops.length)return null;h=h.stops;for(var r=0;8>r;++r){const p=h[Math.min(r,h.length-1)];m.values[r]=p.value;m.opacities[r]=p.opacity}}else return null;
else if(h.stops&&0<=h.stops.length)for(h=h.stops&&0<=h.stops.length&&h.stops[0].opacity,r=0;8>r;r++)m.values[r]=Infinity,m.opacities[r]=h;else return null;return m}function f(h,m,r){h[4*m]=r.r/255;h[4*m+1]=r.g/255;h[4*m+2]=r.b/255;h[4*m+3]=r.a}function n(h){if(D.isNone(h)||h.normalizationField)return null;const m={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof h.field)if(h.stops){if(8<h.stops.length)return null;m.field=
h.field;h=h.stops;for(var r=0;8>r;++r){const p=h[Math.min(r,h.length-1)];m.values[r]=p.value;f(m.colors,r,p.color)}}else return null;else if(h.stops&&0<=h.stops.length)for(h=h.stops&&0<=h.stops.length&&h.stops[0].color,r=0;8>r;r++)m.values[r]=Infinity,f(m.colors,r,h);else return null;for(h=0;32>h;h+=4)k.premultiplyAlpha(m.colors,h,!0);return m}const l=h=>{const m=[],r=[];h=e(h);const p=h.length;for(let g=0;6>g;g++){const q=h[Math.min(g,p-1)];m.push(q.value);r.push(null==q.size?B.NAN_MAGIC_NUMBER:
E.pt2px(q.size))}return{values:new Float32Array(m),sizes:new Float32Array(r)}};y.convertColorVariable=n;y.convertVisualVariables=function(h){const m=h&&0<h.length?{}:null,r=m?{}:null;if(!m)return{vvFields:m,vvRanges:r};for(const p of h)if(p.field&&(m[p.type]=p.field),"size"===p.type)switch(r.size||(r.size={}),h=p,c.getTypeOfSizeVisualVariable(h)){case A.WGLVVFlag.SIZE_MINMAX_VALUE:r.size.minMaxValue={minDataValue:h.minDataValue,maxDataValue:h.maxDataValue,minSize:a(h.minSize),maxSize:a(h.maxSize)};
break;case A.WGLVVFlag.SIZE_SCALE_STOPS:r.size.scaleStops={stops:e(h.stops)};break;case A.WGLVVFlag.SIZE_FIELD_STOPS:if(h.levels){const g={};for(const q in h.levels)g[q]=l(h.levels[q]);r.size.fieldStops={type:"level-dependent",levels:g}}else r.size.fieldStops={type:"static",...l(h.stops)};break;case A.WGLVVFlag.SIZE_UNIT_VALUE:r.size.unitValue={unit:h.valueUnit,valueRepresentation:h.valueRepresentation}}else"color"===p.type?r.color=n(p):"opacity"===p.type?r.opacity=d(p):"rotation"===p.type&&(r.rotation=
{type:p.rotationType});return{vvFields:m,vvRanges:r}};y.getVisualVariableSizeValueRepresentationRatio=function(h,m){if(!h||!m)return h;switch(m){case "radius":case "distance":return 2*h;case "area":return Math.sqrt(h)}return h};y.getVisualVariablesFields=function(h){const m=h&&0<h.length?{}:null;m&&h.forEach(r=>{const p=r.type;r.field&&(m[p]=r.field)});return m};y.normalizeSizeElement=a;y.normalizeSizeStops=e;y.stopToSizeStop=b;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Logger","../../../../core/Error","./enums","./Utils"],function(y,D,E,B,A){const k=D.getLogger("esri.views.2d.engine.webgl");y.getTypeOfSizeVisualVariable=function(c){if(A.isNumber(c.minDataValue)&&A.isNumber(c.maxDataValue)&&null!=c.minSize&&null!=c.maxSize)return B.WGLVVFlag.SIZE_MINMAX_VALUE;if((c.expression&&"view.scale"===c.expression||c.valueExpression&&"$view.scale"===c.valueExpression)&&Array.isArray(c.stops))return B.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=c.field||c.expression&&
"view.scale"!==c.expression||c.valueExpression&&"$view.scale"!==c.valueExpression)&&(Array.isArray(c.stops)||"levels"in c&&c.levels))return B.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=c.field||c.expression&&"view.scale"!==c.expression||c.valueExpression&&"$view.scale"!==c.valueExpression)&&null!=c.valueUnit)return B.WGLVVFlag.SIZE_UNIT_VALUE;k.error(new E("mapview-bad-type","Found invalid size VisualVariable",c));return B.WGLVVFlag.NONE};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/TileKey ../definitions ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileQueue ../../../tiling/TileStrategy ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/AttributeStore ../../../layers/features/support/tileUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){function l(m){switch(m){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function h(m){switch(m){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}A=function(){function m(p,g,q,u,v){this.hasRecords=this._hasAggregate=this._hasDotDensity=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=g;this.tileKey=p;this._hasDotDensity=q;this._hasAggregate=u;this._pixelBufferEnabled=v}var r=m.prototype;r.serialize=function(p){const g=[];g.push(this._serializeTileVertexData(this.tileKey,this._data.self));this._data.neighbors.forEach((q,u)=>{var v=1<<u;u=l(v);v=h(v);u=n.getPow2NeighborKey(new E(this.tileKey),u,v,p);g.push(this._serializeTileVertexData(u.id,q))});return g};r._serializeTileVertexData=function(p,g){var q,
u,v,z,t;const w=[];g={[e.WGLGeometryType.MARKER]:null==(q=g.get(e.WGLGeometryType.MARKER))?void 0:q.serialize(w),[e.WGLGeometryType.FILL]:null==(u=g.get(e.WGLGeometryType.FILL))?void 0:u.serialize(w),[e.WGLGeometryType.LINE]:null==(v=g.get(e.WGLGeometryType.LINE))?void 0:v.serialize(w),[e.WGLGeometryType.TEXT]:null==(z=g.get(e.WGLGeometryType.TEXT))?void 0:z.serialize(w),[e.WGLGeometryType.LABEL]:null==(t=g.get(e.WGLGeometryType.LABEL))?void 0:t.serialize(w)};return{message:{tileKey:p,data:g},transferList:w}};
r.featureStart=function(p=0){this._current.insertAfter=p};r.featureEnd=function(){};r.recordStart=function(p,g,q,u,v){this._current.writer=this._getVertexWriter(q,u);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=v;this._current.id=p;this._current.materialKey=g;this._current.geometryType=q;this._current.isDotDensity=!1;this._current.writer.recordStart()};r.recordCount=function(){return this._current.writer.recordCount};
r.vertexCount=function(){return this._current.writer.vertexCount};r.indexCount=function(){return this._current.writer.indexCount};r.vertexBounds=function(p,g,q,u){this._current.bufferingEnabled&&this._addOverlap(p,g,q,u)};r.vertexWrite=function(p){this._current.writer.writeVertex(p)};r.vertexWriteF32=function(p){this._current.writer.writeVertexF32(p)};r.vertexEnd=function(){};r.vertexWriter=function(){return this._current.writer.vertexWriter};r.indexWrite=function(p){this._current.writer.writeIndex(p)};
r.indexWriter=function(){return this._current.writer.indexWriter};r.metricWriter=function(){return this._current.writer.metricWriter};r.metricStart=function(p,g,q,u,v,z,t,w){this._current.writer=this._getVertexWriter(e.WGLGeometryType.LABEL,!1);const x=this._current.writer.metricWriter;x.push(f.getDisplayIdTexel(p));x.push(g);x.push(q);x.push(u);x.push(v);x.push(z);x.push(t);x.push(w);x.push(255);this._current.metricBoxLenPointer=x.push(0)};r.metricEnd=function(){const p=this._current.writer.metricWriter;
0===p.getValue(this._current.metricBoxLenPointer)&&p.seek(p.length-10)};r.metricBoxWrite=function(p,g,q,u){const v=this._current.writer.metricWriter;v.incr(this._current.metricBoxLenPointer);v.push(0);v.push(0);v.push(p);v.push(g);v.push(q);v.push(u)};r.recordEnd=function(){var p=this._current.indexStart,g=this._current.writer.indexCount;if(p===g)return!1;this.hasRecords=!0;var q=this._current.vertStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,
p,g-p,q,this._current.writer.vertexCount-q);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===e.WGLGeometryType.LABEL)return!0;p=this._current.writer;for(g=0;8>g;g++)if(q=1<<g,this._current.overlaps&q){if(!this._data.neighbors[g]){var u=new Map;this._data.neighbors[g]=u}u=this._data.neighbors[g];var v=this._current.geometryType;if(!u.has(v)){const z=a.getStrides(v,this._current.isDotDensity).geometry;u.set(v,new d.VertexDataWriter(v,z,B.PATCH_PIXEL_BUFFER_ALLOC_SIZE))}u=
u.get(this._current.geometryType);v=4096*-l(q);q=4096*-h(q);u.copyLastFrom(p,v,q)}return!0};r._addOverlap=function(p,g,q,u){this._current.overlaps|=255^((p<0+q?148:p>=B.TILE_SIZE-q?41:189)|(g<0+u?224:g>=B.TILE_SIZE-u?7:231))};r._getVertexWriter=function(p,g){if(!this._data.self.has(p)){g=this._data.self;const q=a.getStrides(p,this._hasDotDensity).geometry;g.set(p,new d.VertexDataWriter(p,q,8E3))}return this._data.self.get(p)};D._createClass(m,[{key:"hasAggregates",get:function(){return this._hasAggregate}},
{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return m}();y.MeshData=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(y,D,E,B,A){let k=function(){function c(e,a,d){this._start={index:0,vertex:0};d=B.getMeshSizeHint(e,a,d);a/=4;this.geometryType=e;this._records=new A(Int32Array,
d.recordBytes);this._indices=new A(Uint32Array,d.indexBytes);this._vertices=new A(Uint32Array,d.vertexBytes);this._metrics=new A(Float32Array,0);this._strideInt=a}var b=c.prototype;b.serialize=function(e){const a=this._records.buffer(),d=this._indices.buffer(),f=this._vertices.buffer(),n=this._metrics.length?this._metrics.buffer():null,l=4*this._strideInt;e.push(a,d,f);return{stride:l,records:a,indices:d,vertices:f,metrics:n}};b.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=
this._vertices.length};b.recordEnd=function(e,a,d,f,n,l,h){this._records.push(e);this._records.push(a);this._records.push(d);this._records.push(f);this._records.push(n);this._records.push(l);this._records.push(h)};b.writeIndex=function(e){this._indices.push(e)};b.writeVertex=function(e){this._vertices.push(e)};b.writeVertexF32=function(e){this._vertices.writeF32(e)};b.copyLastFrom=function(e,a,d){var f=e._records.length-7;const n=e._records.getValue(f),l=e._records.getValue(f+1),h=e._records.getValue(f+
2),m=e._records.getValue(f+4);f=e._records.getValue(f+6);const r=this._vertices.length;var p=(e._start.vertex-this._vertices.length)/this._strideInt;const g=this._indices.length,q=this.vertexCount;for(var u=e._start.index;u!==e._indices.length;u++){const v=e._indices.getValue(u);this._indices.push(v-p)}for(p=e._start.vertex;p!==e._vertices.length;p++)u=e._vertices.getValue(p),this._vertices.push(u);for(e=r;e<=this._vertices.length;e+=this._strideInt)this._vertices.i1616Add(e,a,d);this._records.push(n);
this._records.push(l);this._records.push(h);this._records.push(g);this._records.push(m);this._records.push(q);this._records.push(f)};D._createClass(c,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return c}();y.VertexDataWriter=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(y,D){function E(B,A,k,c){B=B.clone();const b=1<<B.level;A=B.col+A;k=B.row+k;c&&0>A?(B.col=A+b,--B.world):A>=b?(B.col=A-b,B.world+=1):B.col=A;B.row=k;return B}y.getPow2NeighborKey=E;y.getPow2NeighborTile=
function(B,A,k){A=E(B.key,A,k,B.tileInfoView.tileInfo.isWrappable);return new D.Tile(B.tileInfoView,A)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(y,D,E,B,A,k,c){function b(a,
d){const f=a.bounds,n=d.bounds;return a.key.id!==d.key.id&&a.key.world===d.key.world&&f[0]<=n[0]&&f[1]<=n[1]&&f[2]>=n[2]&&f[3]>=n[3]}let e=function(){function a(f,n){this.key=new c(0,0,0,0);this.bounds=A.create();this.objectIds=new Set;this.key.set(n);n=f.getLODInfoAt(this.key);this.tileInfoView=f;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=n.resolution;this.scale=n.scale;this.level=n.level;this.needsClear=!0}var d=a.prototype;d.clone=function(){return new a(this.tileInfoView,
this.key)};d.createChildTiles=function(){const f=this.key.getChildKeys(),n=E.acquire();for(let l=0;l<f.length;l++)n[l]=new a(this.tileInfoView,f[l]);return n};d.getQuantizationParameters=function(){return k.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};D._createClass(a,[{key:"id",get:function(){return this.key.id}},{key:"extent",
get:function(){return B.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}},{key:"bbox",get:function(){const f=this.bounds;return{minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}}}]);return a}();y.Tile=e;y.default=e;y.isChildOf=function(a,d){return b(d,a)};y.isParentOf=b;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/boundsUtils ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/normalizeUtils ../../../../geometry/support/aaBoundingRect ../../../../chunks/vec2 ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/vec2f32 ../../engine/webgl/alignmentUtils ../../engine/webgl/mesh/templates/shapingUtils ../../engine/webgl/util/BidiText ../../../../symbols/cim/CIMSymbolHelper".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p){function g(I,L,G,M,P,T){let Y,Z;var ca=c.pt2px(G.xoffset);const ia=c.pt2px(G.yoffset),da=t*G.angle;T*=t;switch(G.type){case "esriSMS":Y=Z=c.pt2px(G.size);break;case "esriPMS":Y=c.pt2px(G.width),Z=c.pt2px(G.height)}.04>P&&(M=.04*M/P);G=f.identity(w);f.translate(G,G,d.set(x,I,L));f.rotate(G,G,T-da);f.scale(G,G,d.set(x,M,-M));f.translate(G,G,d.set(x,ca,-ia));I=[0,0];d.transformMat2d(I,d.set(x,-.5*Y,-.5*Z),G);L=[0,0];d.transformMat2d(L,d.set(x,-.5*Y,.5*Z),
G);M=[0,0];d.transformMat2d(M,d.set(x,.5*Y,-.5*Z),G);ca=[0,0];d.transformMat2d(ca,d.set(x,.5*Y,.5*Z),G);return{rings:[[I,M,ca,L,I]]}}function q(I,L,G,M,P,T){var Y=p.CIMSymbolHelper.getEnvelope(G.data);if(!Y)return null;.04>P&&(M=.04*M/P);P=c.pt2px(Y.width);var Z=c.pt2px(Y.height);G=c.pt2px(Y.x);Y=c.pt2px(Y.y);const ca=0*t,ia=t*T;T=f.identity(w);f.translate(T,T,d.set(x,I,L));f.rotate(T,T,ia-ca);f.scale(T,T,d.set(x,M,M));I=[0,0];d.transformMat2d(I,d.set(x,G,Y+Z),T);L=[0,0];d.transformMat2d(L,d.set(x,
G,Y),T);M=[0,0];d.transformMat2d(M,d.set(x,G+P,Y+Z),T);Z=[0,0];d.transformMat2d(Z,d.set(x,G+P,Y),T);return{rings:[[I,M,Z,L,I]]}}function u(I,L,G,M,P,T){var Y=c.pt2px(G.xoffset),Z=c.pt2px(G.yoffset);G=t*G.angle;const ca=t*T;T=f.identity(w);f.translate(T,T,d.set(x,I,L));f.rotate(T,T,ca);f.scale(T,T,d.set(x,P,-P));I=M[0]+M[2]/2;L=M[1]+M[3]/2;f.translate(T,T,d.set(x,Y,-Z));f.translate(T,T,d.set(x,I,L));f.rotate(T,T,G);f.translate(T,T,d.set(x,-I,-L));Y=[0,0];d.transformMat2d(Y,d.set(x,M[0],M[1]),T);Z=
[0,0];d.transformMat2d(Z,d.set(x,M[0],M[1]+M[3]),T);G=[0,0];d.transformMat2d(G,d.set(x,M[0]+M[2],M[1]),T);I=[0,0];d.transformMat2d(I,d.set(x,M[0]+M[2],M[1]+M[3]),T);return{rings:[[Y,G,I,Z,Y]]}}function v(I){switch(I.symbol.type){case "esriSFS":case "esriPFS":return(I=I.symbol.outline)?I.width:0;case "esriSLS":return c.pt2px(I.symbol.width);case "esriSMS":return c.pt2px(I.symbol.size);case "esriPMS":return c.pt2px(Math.max(I.symbol.width,I.symbol.height));case "esriTS":{const L=[0,0,0,0];z(L,I.symbol,
I.mosaicItem);return Math.max(L[2],L[3])+Math.max(Math.abs(L[0]),Math.abs(L[1]))}case "expanded-cim":I=p.CIMSymbolHelper.getEnvelope(I.symbol.data);if(-Infinity===I.width||-Infinity===I.height)I.width=10,I.height=10,I.x=0,I.y=0;return c.pt2px(Math.sqrt(I.width*I.width+I.height*I.height));case "composite-symbol":return I.symbol.layers.length?v({symbol:I.symbol.layers[I.symbol.layers.length-1],mosaicItem:null}):0;default:return 0}}function z(I,L,G){if(!G||0===G.glyphMosaicItems.length)return I;const M=
r.bidiText(L.text)[1];L=m.shapeGlyphs(G.glyphMosaicItems,M,{scale:c.pt2px(L.font.size)/24,angle:L.angle,xOffset:L.xoffset,yOffset:L.yoffset,hAlign:h.getXAnchorDirection(L.horizontalAlignment||"center"),vAlign:h.getYAnchorDirection(L.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(L.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(L.lineHeight||1,4)),decoration:L.font.decoration||"none",isCIM:!1}).bounds;I[0]=c.pt2px(L.x-L.halfWidth);I[1]=c.pt2px(L.y-L.halfHeight);I[2]=c.pt2px(L.width);
I[3]=c.pt2px(L.height);return I}const t=Math.PI/180,w=n.create(),x=l.create(),C=l.create(),F=l.create(),H=l.create(),J=l.create(),K=l.create(),N=l.create(),R=l.create();y.PIXEL_BUFFER=50;y.TILE_SIZE=512;y.getBounds=function(I,L,G,M,P,T,Y){if(!M||!G.symbol)return I[0]=I[1]=I[2]=I[3]=0,L[0]=L[1]=L[2]=L[3]=0,I;if(k.isPoint(M)){var Z=M.x;const ia=M.y;"esriTS"===G.symbol.type&&0===L[2]&&0===L[3]&&z(L,G.symbol,G.mosaicItem);M=Z;Z=ia;G=G.symbol;switch(G.type){case "esriSMS":case "esriPMS":var ca=g(M,Z,G,
P,T,0);break;case "esriTS":ca=u(M,Z,G,L,P,0);break;case "cim":case "CIMSymbolReference":case "expanded-cim":ca=q(M,Z,G,P,T,0)}L=0;for(P=0;P<ca.rings[0].length-1;P++)G=ca.rings[0][P],G=(M-G[0])*(M-G[0])+(Z-G[1])*(Z-G[1]),L=Math.max(L,G);L=Math.sqrt(L);ca=e.normalizeMapX(M-L,Y);M=e.normalizeMapX(M+L,Y);if(ca>M&&(Y=B.getInfo(Y))){const [da,ja]=Y.valid;ca=da;M=ja}I[0]=ca;I[1]=Z-L;I[2]=M;I[3]=Z+L}else A.getBoundsXY(I,M),Y=L[0],0===Y&&(Y=v(G),L[0]=Y),Y=P*Y/2,I[0]-=Y,I[1]-=Y,I[2]+=Y,I[3]+=Y;return I};y.getCIMMarkerBounds=
q;y.getMarkerSymbolBounds=g;y.getTextSymbolBounds=u;y.getTextSymbolSize=z;y.graphicGeometryToNumber=function(I){switch(E.unwrap(I.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};y.intersectingInternationalDateline=function(I,L){if(!L.isWrappable)return null;const [G,M]=b.getSpatialReferenceMinMaxX(L);return I[2]>M?[a.create([I[0],I[1],M,I[3]]),a.create([G,I[1],G+I[2]-M,I[3]])]:I[0]<G?[a.create([G,I[1],I[2],I[3]]),a.create([M-(G-I[0]),I[1],M,I[3]])]:null};y.isMarkerSymbol=
function(I){return"simple-marker"===I||"picture-marker"===I||"esriSMS"===I||"esriPMS"===I};y.isPointOnPolyline=function(I,L,G,M){d.set(H,L,G);I=I.paths;let P,T,Y,Z,ca,ia,da,ja=Infinity;for(let fa=0;fa<I.length;fa++){const Q=I[fa];if(!(2>Q.length))for(let V=1;V<Q.length;V++){var la=Q[V-1][0];T=Q[V-1][1];P=Q[V][0];Y=Q[V][1];Z=Math.min(la,P)-M;ca=Math.min(T,Y)-M;ia=Math.max(la,P)+M;da=Math.max(T,Y)+M;L<Z||L>ia||G<ca||G>da||(d.set(C,la,T),d.set(F,P,Y),d.subtract(J,F,C),d.subtract(K,C,H),d.scale(N,J,d.dot(J,
K)/d.dot(J,J)),d.subtract(R,K,N),la=d.dot(R,R),ja>la&&(ja=la))}}return Math.sqrt(ja)<=M};y.isTextSymbol=function(I){return"text"===I||"esriTS"===I};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(y){(function(D){D[D.Left=-1]="Left";D[D.Center=0]="Center";D[D.Right=1]="Right"})(y.HAlign||(y.HAlign={}));(function(D){D[D.Top=1]="Top";D[D.Center=0]="Center";D[D.Bottom=-1]="Bottom";D[D.Baseline=2]="Baseline"})(y.VAlign||
(y.VAlign={}));y.getAlignmentFromPlacement=function(D){switch(D){case "above-left":return[y.HAlign.Right,y.VAlign.Bottom];case "above-center":case "above-along":return[y.HAlign.Center,y.VAlign.Bottom];case "above-right":return[y.HAlign.Left,y.VAlign.Bottom];case "center-left":return[y.HAlign.Right,y.VAlign.Center];case "center-center":case "center-along":return[y.HAlign.Center,y.VAlign.Center];case "center-right":return[y.HAlign.Left,y.VAlign.Center];case "below-left":return[y.HAlign.Right,y.VAlign.Top];
case "below-center":case "below-along":return[y.HAlign.Center,y.VAlign.Top];case "below-right":return[y.HAlign.Left,y.VAlign.Top];case "always-horizontal":return[y.HAlign.Center,y.VAlign.Baseline];default:return console.debug(`Found invalid placement type ${D}`),[y.HAlign.Center,y.VAlign.Center]}};y.getJustification=function(D){switch(D){case "left":return y.HAlign.Left;case "right":return y.HAlign.Right;case "center":case "justify":return y.HAlign.Center}};y.getXAnchorDirection=function(D){switch(D){case "left":return y.HAlign.Left;
case "right":return y.HAlign.Right;case "center":case "justify":return y.HAlign.Center}};y.getXDirection=function(D){switch(D){case y.HAlign.Right:return-1;case y.HAlign.Center:return 0;case y.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${D}`),0}};y.getYAnchorDirection=function(D){switch(D){case "top":return y.VAlign.Top;case "middle":return y.VAlign.Center;case "baseline":return y.VAlign.Baseline;case "bottom":return y.VAlign.Bottom}};y.getYDirection=function(D){switch(D){case y.VAlign.Top:return 1;
case y.VAlign.Center:return 0;case y.VAlign.Bottom:case y.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${D}`),0}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/vec2 ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(y,D,E,B,A,k,c,b,e,a){const d=Math.PI/180;let f=function(){function m(p,g,q,u){this._rotationT=A.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const v=q.rect,z=new Float32Array(8);p*=u;g*=u;const t=q.code?v.width*u:q.metrics.width,w=q.code?v.height*u:q.metrics.height;z[0]=p;z[1]=g;z[2]=p+t;z[3]=g;z[4]=p;z[5]=g+w;z[6]=p+t;z[7]=g+w;this._data=z;this._setTextureCoords(v);this._scale=u;this._mosaic=q;this.x=p;this.y=g;this.maxOffset=Math.max(p+t,g+w)}var r=
m.prototype;r.setTransform=function(p){this._T=p;this._offsets=null};r._setOffsets=function(p){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const g=this._offsets,q=new Float32Array(8),u=B.multiply(A.create(),this._rotationT,this._T);A.transformMany(q,p,u);g.upperLeft=b.i1616to32(8*q[0],8*q[1]);g.upperRight=b.i1616to32(8*q[2],8*q[3]);g.lowerLeft=b.i1616to32(8*q[4],8*q[5]);g.lowerRight=b.i1616to32(8*q[6],8*q[7])};r._setTextureCoords=function({x:p,y:g,width:q,height:u}){this._texcoords=
{upperLeft:b.i1616to32(p,g),upperRight:b.i1616to32(p+q,g),lowerLeft:b.i1616to32(p,g+u),lowerRight:b.i1616to32(p+q,g+u)}};D._createClass(m,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(p){this._angle=p;B.identity(this._rotationT);B.rotate(this._rotationT,this._rotationT,-p);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},
{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},
{key:"bounds",get:function(){if(!this._bounds){const {height:v,width:z}=this._mosaic.metrics;var p=z*this._scale,g=Math.abs(v)*this._scale,q=new Float32Array(8);q[0]=this.x;q[1]=this.y;q[2]=this.x+p;q[3]=this.y;q[4]=this.x;q[5]=this.y+g;q[6]=this.x+p;q[7]=this.y+g;p=B.multiply(A.create(),this._rotationT,this._T);A.transformMany(q,q,p);g=p=Infinity;let t=0;var u=0;for(let w=0;4>w;w++){const x=q[2*w],C=q[2*w+1];p=Math.min(p,x);g=Math.min(g,C);t=Math.max(t,x);u=Math.max(u,C)}q=t-p;u-=g;this._bounds=
new a(p+q/2,g+u/2,q,u)}return this._bounds}}]);return m}();const n=(m,r)=>({code:0,page:0,sdf:!0,rect:new e(0,0,11,8),textureBinding:r,metrics:{advance:0,height:4,width:m,left:0,top:0}});let l=function(){function m(p,g,q){this._rotation=0;this._decorate(p,g,q);this.glyphs=p;this.bounds=this._createBounds(p);this.isMultiline=1<g.length;this._hasRotation=0!==q.angle;this._T=this._createGlyphTransform(this.bounds,q);for(const u of p)u.setTransform(this._T)}var r=m.prototype;r.setRotation=function(p){if(0!==
p||0!==this._rotation){this._rotation=p;var g=this._T;p=B.fromRotation(A.create(),p);B.multiply(g,p,g);for(const q of this.glyphs)q.setTransform(this._T)}};r._decorate=function(p,g,q){if(q.decoration&&"none"!==q.decoration&&p.length){var u=q.scale;q="underline"===q.decoration?30:20;var v=p[0].textureBinding;for(const z of g)p.push(new f(z.startX*u,z.startY*u+q*u,n((z.width+z.glyphWidthEnd)*u,v),1))}};r._createBounds=function(p){let g=Infinity,q=Infinity,u=0;var v=0;for(const z of p)g=Math.min(g,z.xTopLeft),
q=Math.min(q,z.yTopLeft),u=Math.max(u,z.xTopLeft+z.width),v=Math.max(v,z.yBottomRight);p=u-g;v-=q;return new a(g+p/2,q+v/2,p,v)};r._createGlyphTransform=function(p,g){const q=d*g.angle,u=A.create(),v=k.create();B.translate(u,u,E.set(v,g.xOffset,-g.yOffset));g.isCIM?B.rotate(u,u,q):(B.translate(u,u,E.set(v,p.x,p.y)),B.rotate(u,u,q),B.translate(u,u,E.set(v,-p.x,-p.y)));return u};D._createClass(m,[{key:"boundsT",get:function(){var p=this.bounds;const g=E.set(k.create(),p.x,p.y);E.transformMat2d(g,g,
this._T);return this._hasRotation?(p=Math.max(p.width,p.height),new a(g[0],g[1],p,p)):new a(g[0],g[1],p.width,p.height)}}]);return m}(),h=function(m,r,p,g,q,u){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(r,p));this.end=Math.max(0,Math.max(r,p));this.end<m.length&&(this.glyphWidthEnd=m[this.end].metrics.width);this.width=g;this.yMin=q;this.yMax=u};y.ShapedGlyph=f;y.ShapingInfo=l;y.shapeGlyphs=function(m,r,p){const g=p.scale,q=[];{var u=[];var v=1/p.scale*p.maxLineWidth;
var z=r?m.length-1:0;var t=r?-1:m.length;r=r?-1:1;var w=z,x=0,C=0;let K=w,N=K,R=0,I=Infinity,L=0;for(;w!==t;){const {code:G,metrics:M}=m[w];var F=Math.abs(M.top);10!==G&&32!==G&&(I=Math.min(I,F),L=Math.max(L,F+M.height));10===G?(w!==z&&(u.push(new h(m,K,w-r,x,I,L)),I=Infinity,L=0),x=0,K=w+r,N=w+r,C=0):32===G?(N=w+r,C=0,R=M.advance,x+=M.advance):(x>v&&(N!==K?(F=N-2*r,x-=R,u.push(new h(m,K,F,x-C,I,L)),I=Infinity,L=0,K=N,x=C):(u.push(new h(m,K,w-r,x,I,L)),I=Infinity,L=0,N=K=w,x=0)),x+=M.advance,C+=M.advance);
w+=r}v=new h(m,K,w-r,x,I,L);0<=v.start&&v.end<m.length&&u.push(v)}for(v=0;v<u.length;v++);v=z=u[0].yMin;z=u[u.length-1].yMax+p.lineHeight*(u.length-1)+("underline"===p.decoration?4:0)-z;const {vAlign:H,hAlign:J}=p;t=H===c.VAlign.Baseline?1:0;v=(1-t)*-v+z/2*(t?0:H-1)+-26*(t?1:0);for(z=0;z<u.length;z++){const {start:K,end:N,width:R}=u[z];t=R/2*(J+1)*-1-3;r=z*p.lineHeight+v-3;u[z].startX=t;u[z].startY=r;for(w=K;w<=N;w++)x=m[w],10!==x.code&&(C=new f(t+x.metrics.left,r-x.metrics.top,x,g),t+=x.metrics.advance,
q.push(C))}return new l(q,u,p)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils","../../../../../chunks/vec2f32"],function(y,D,E){return function(){function B(k,c,b,e){this.center=E.fromValues(k,c);this.centerT=E.create();this.halfWidth=b/2;this.halfHeight=e/2;this.width=b;this.height=e}var A=B.prototype;A.clone=function(){return new B(this.x,
this.y,this.width,this.height)};A.serialize=function(k){k.writeF32(this.center[0]);k.writeF32(this.center[1]);k.push(this.width);k.push(this.height);return k};A.findCollisionDelta=function(k,c=4){return D.log2(Math.min((k.halfWidth+this.halfWidth+c)/Math.abs(k.centerT[0]-this.centerT[0]),(k.halfHeight+this.halfHeight+c)/Math.abs(k.centerT[1]-this.centerT[1])))};A.extend=function(k){const c=Math.min(this.xmin,k.xmin),b=Math.min(this.ymin,k.ymin),e=Math.max(this.xmax,k.xmax)-c;k=Math.max(this.ymax,
k.ymax)-b;this.width=e;this.height=k;this.halfWidth=e/2;this.halfHeight=k/2;this.x=c+e/2;this.y=b+k/2};B.deserialize=function(k){const c=k.readF32(),b=k.readF32(),e=k.readInt32();k=k.readInt32();return new B(c,b,e,k)};y._createClass(B,[{key:"x",get:function(){return this.center[0]},set:function(k){this.center[0]=k}},{key:"y",get:function(){return this.center[1]},set:function(k){this.center[1]=k}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+
this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return B}()})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/has ../../../../core/lang ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/screenUtils ../../../../renderers/Renderer ../../../../symbols/support/jsonUtils ../../../../renderers/ClassBreaksRenderer ../../../../renderers/UniqueValueRenderer ../../../../renderers/DictionaryRenderer ../../../../renderers/DotDensityRenderer ../../../../renderers/HeatmapRenderer ../../../../renderers/SimpleRenderer ../../../../renderers/support/jsonUtils ../support/clusterUtils ../../engine/webgl/enums ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/Utils ../../engine/webgl/util/vvFlagUtils ./support/pixelBuffering ./support/rendererUtils ../support/util".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u,v,z,t){function w(O){switch(O.type){case "line-marker":var U;return{type:"line-marker",color:null==(U=O.color)?void 0:U.toJSON(),placement:O.placement,style:O.style};default:return e.fromJSON(O.toJSON()).toJSON()}}function x(O,U,W){if(!O)return null;var ba=0;let ea=!1,ma=0;B.isSome(U)&&(ma=v.getPtMaxVVSize(U),"visualVariables"in U&&(ba=u.getVVFlags(U.visualVariables||[]),ea="dot-density"===U.type));switch(O.type){case "simple-fill":case "picture-fill":return C(O,
ba,ea,W);case "simple-marker":case "picture-marker":return U=ma,ba=g.createMaterialKey(p.WGLGeometryType.MARKER,ba,!1,!1),W=W?g.hydrateMaterialKey(ba):ba,ba=w(O),O={materialKey:W,hash:O.hash(),...ba,angle:O.angle,maxVVSize:U};case "simple-line":return F(O,ba,W);case "text":return U=ma,ba=g.createMaterialKey(p.WGLGeometryType.TEXT,ba,!1,!1),W=W?g.hydrateMaterialKey(ba):ba,ba=w(O),O={materialKey:W,hash:O.hash(),...ba,angle:O.angle,maxVVSize:U};case "label":return ba=g.createMaterialKey(p.WGLGeometryType.LABEL,
ba,!1,!1,O.labelPlacement),O={materialKey:W?g.hydrateMaterialKey(ba):ba,hash:O.hash(),...O.toJSON(),labelPlacement:O.labelPlacement};case "cim":return{type:"cim",rendererKey:ba,data:O.data,maxVVSize:ma};case "web-style":return{...w(O),type:"web-style",hash:O.hash(),rendererKey:ba,maxVVSize:ma};default:throw Error(`symbol not supported ${O.type}`);}}function C(O,U,W,ba){W=g.createMaterialKey(p.WGLGeometryType.FILL,U,!1,W);var ea=ba?g.hydrateMaterialKey(W):W;const ma=O.clone();W=ma.outline;ma.outline=
null;O=[];ea={materialKey:ea,hash:ma.hash(),...w(ma)};O.push(ea);W&&(U=g.createMaterialKey(p.WGLGeometryType.LINE,U,!0,!1),ba={materialKey:ba?g.hydrateMaterialKey(U):U,hash:W.hash(),...w(W)},O.push(ba));return{type:"composite-symbol",layers:O,hash:O.reduce((oa,pa)=>pa.hash+oa,"")}}function F(O,U,W){var ba=g.createMaterialKey(p.WGLGeometryType.LINE,U,!1,!1);const ea=W?g.hydrateMaterialKey(ba):ba;O=O.clone();ba=O.marker;O.marker=null;const ma=[];ma.push({materialKey:ea,hash:O.hash(),...w(O)});if(ba){var oa;
U=g.createMaterialKey(p.WGLGeometryType.MARKER,U,!1,!1);W=W?g.hydrateMaterialKey(U):U;ba.color=null!=(oa=ba.color)?oa:O.color;ma.push({materialKey:W,hash:ba.hash(),lineWidth:O.width,...w(ba)})}return{type:"composite-symbol",layers:ma,hash:ma.reduce((pa,qa)=>qa.hash+pa,"")}}function H(O,U){const W=O.labelPlacement;var ba=V[U];if(!O.symbol)return Q.warn("No LabelClass symbol specified."),!0;if(!ba)return Q.error(new k("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${U} is not supported`)),
!0;ba.some(ea=>ea===W)||(ba=ba[0],W&&Q.warn(`Found invalid label placement type ${W} for ${U}. Defaulting to ${ba}`),O.labelPlacement=ba);return!1}function J(O,U){O=E.clone(O);return O.some(W=>H(W,U))?[]:O}function K(O,U=!1){try{var W,ba;const ea=M(O,U),ma={};ea.map(oa=>{a:{switch(oa.target){case "feature":I(ma,R(O),oa);oa=void 0;break a;case "aggregate":var pa=O.featureReduction;if("selection"===pa.type)throw new k("ValidationError","Mapview does not support `selection` reduction type",pa);I(ma,
R(O),oa);ma.aggregate||(ma.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:c.pt2px(pa.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(c.pt2px(pa.clusterMaxSize)/64),fields:oa.aggregateFields}});N(ma.aggregate,oa.attributes.fields);oa=void 0;break a}oa=void 0}return oa});return{source:{definitionExpression:O.definitionExpression,fields:O.fields.map(oa=>oa.toJSON()),gdbVersion:O.gdbVersion,historicMoment:null==(W=O.historicMoment)?void 0:W.getTime(),outFields:O.availableFields,
pixelBuffer:O.pixelBuffer,spatialReference:O.spatialReference.toJSON(),timeExtent:null==(ba=O.timeExtent)?void 0:ba.toJSON()},attributes:{fields:{},indexCount:0},processors:ea,targets:ma}}catch(ea){if("ValidationError"===ea.fieldName)return Q.error(ea),null;throw ea;}}function N(O,U){for(const W in U){const ba=U[W];if(ba.target!==O.name)continue;const ea=O.attributes[W];ea?(ea.context.mesh=ea.context.mesh||ba.context.mesh,ea.context.storage=ea.context.storage||ba.context.storage):O.attributes[W]=
ba}return O}function R(O){var U,W,ba,ea,ma;return[null!=(U=null==(W=O.filter)?void 0:W.toJSON())?U:null,null!=(ba=null==(ea=O.effect)?void 0:null==(ma=ea.filter)?void 0:ma.toJSON())?ba:null]}function I(O,U,W){O.feature||(O.feature={name:"feature",input:"source",filters:U,attributes:{}});N(O.feature,W.attributes.fields);return O}function L(O,U){return U.field?G(O,{...U,type:"field",field:U.field}):U.valueExpression?G(O,{...U,type:"expression",valueExpression:U.valueExpression}):{field:null,fieldIndex:null}}
function G(O,U){switch(U.type){case "expression":var W=U.valueExpression;if(!O.fields[W]){var ba=O.indexCount++;O.fields[W]={...U,name:W,fieldIndex:ba}}return{fieldIndex:O.fields[W].fieldIndex};case "label-expression":return W=JSON.stringify(U.label),O.fields[W]||(ba=O.indexCount++,O.fields[W]={...U,name:W,fieldIndex:ba}),{fieldIndex:O.fields[W].fieldIndex};case "field":W=U.field;if("aggregate"===U.target&&O.fields[W])return{field:W};O.fields[W]={...U,name:W};return{field:W};case "statistic":return O.fields[U.name]=
{...U},{field:U.name}}}function M(O,U=!1){const W=[];let ba=0;W.push(T(O,ba++,U));return W}function P(O,U,W,ba,ea,ma=!1){U=G(U,{type:"label-expression",target:ba,context:{mesh:!0},resultType:"string",label:{labelExpression:W.labelExpression,labelExpressionInfo:W.labelExpressionInfo?{expression:W.labelExpressionInfo.expression}:null,symbol:!!W.symbol,where:W.where}});({fieldIndex:U}=U);return{...x(W,O,ma),fieldIndex:U,target:ba,index:ea}}function T(O,U,W=!1){const ba={indexCount:0,fields:{}};var ea=
"featureReduction"in O&&O.featureReduction;U=ea?"aggregate":"feature";switch(O.renderer.type){case "heatmap":{const {blurRadius:oa,fieldOffset:pa,field:qa}=O.renderer;return{type:"heatmap",aggregateFields:[],attributes:ba,target:U,storage:null,mesh:{blurRadius:oa,fieldOffset:pa,field:L(ba,{target:U,field:qa,resultType:"numeric"}).field}}}default:{const oa=[],pa="aggregate"===U?r.createClusterRenderer(oa,O.renderer,ea,null):O.renderer;Y(ba,oa);const qa=da(ba,U,pa,W);var ma=null;const va=Z(ba,U,pa),
ta=t.toJSONGeometryType(O.geometryType);O=O.labelsVisible&&O.labelingInfo||[];let ua=[];if(ea){if("selection"===ea.type)throw new k("ValidationError","Mapview does not support `selection` reduction type",ea);ea.symbol&&(ma=new h({symbol:ea.symbol,visualVariables:"visualVariables"in pa?pa.visualVariables:null}),ma=da(ba,U,ma,W));ua=ea&&ea.labelsVisible&&ea.labelingInfo||[]}O=J(O,ta);ua=J(ua,ta);let Aa=0;ea=[...O.map(xa=>P(pa,ba,xa,"feature",Aa++,W)),...ua.map(xa=>P(pa,ba,xa,"aggregate",Aa++,W))];return{type:"symbol",
target:U,attributes:ba,aggregateFields:oa,storage:va,mesh:{matcher:qa,labels:ea,aggregateMatcher:ma}}}}}function Y(O,U){const W={mesh:!0,storage:!0};for(const ba of U){const {name:ea,outStatistic:ma}=ba,{statisticType:oa,onStatisticField:pa}=ma;let qa=U=null,va=null;"onStatisticValueExpression"in ma?qa=G(O,{type:"expression",target:"feature",valueExpression:ma.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in ma?(U=G(O,{type:"field",target:"feature",field:pa,
resultType:"numeric"}).field,va=ma.onStatisticNormalizationField):U=G(O,{type:"field",target:"feature",field:pa,resultType:"numeric"}).field;G(O,{type:"statistic",target:"aggregate",name:ea,context:W,inField:U,inNormalizationField:va,inFieldIndex:qa,statisticType:oa})}}function Z(O,U,W){switch(W.type){case "dot-density":return ca(O,U,W.attributes);case "simple":case "class-breaks":case "unique-value":return ia(O,U,W.visualVariables);case "heatmap":case "dictionary":return null}}function ca(O,U,W){return W&&
W.length?{type:"dot-density",mapping:W.map((ba,ea)=>{const {field:ma,fieldIndex:oa}=L(O,{valueExpression:ba.valueExpression,field:ba.field,resultType:"numeric",target:U});return{binding:ea,field:ma,fieldIndex:oa}}),target:U}:{type:"dot-density",mapping:[],target:U}}function ia(O,U,W){if(!W||!W.length)return{type:"visual-variable",mapping:[],target:U};const ba={storage:!0};return{type:"visual-variable",mapping:z.simplifyVisualVariables(W).map(ea=>{var ma;const oa=q.getVVType(ea.type),{field:pa,fieldIndex:qa}=
L(O,{target:U,valueExpression:ea.valueExpression,field:ea.field,context:ba,resultType:"numeric"});switch(ea.type){case "size":return"$view.scale"===ea.valueExpression?null:{type:"size",binding:oa,field:pa,fieldIndex:qa,normalizationField:L(O,{target:U,field:ea.normalizationField,context:ba,resultType:"numeric"}).field,valueRepresentation:null!=(ma=ea.valueRepresentation)?ma:null};case "color":return{type:"color",binding:oa,field:pa,fieldIndex:qa,normalizationField:L(O,{target:U,field:ea.normalizationField,
context:ba,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:oa,field:pa,fieldIndex:qa,normalizationField:L(O,{target:U,field:ea.normalizationField,context:ba,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:oa,field:pa,fieldIndex:qa}}}).filter(ea=>ea),target:U}}function da(O,U,W,ba=!1){O=B.unwrapOr(O,{indexCount:0,fields:{}});switch(W.type){case "simple":case "dot-density":return ja(O,W,"dot-density"===W.type,ba);case "class-breaks":return la(O,
U,W,ba);case "unique-value":return fa(O,U,W,ba);case "dictionary":return{type:"dictionary",renderer:W.toJSON()}}}function ja(O,U,W,ba=!1){O=U.getSymbols();return{type:"simple",symbol:x(O.length?O[0]:null,U,ba),isDotDensity:W}}function la(O,U,W,ba=!1){const ea=W.backgroundFillSymbol,{field:ma,fieldIndex:oa}=L(O,{target:U,field:W.field,valueExpression:W.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});U=W.normalizationType;U="log"===U?"esriNormalizeByLog":"percent-of-total"===
U?"esriNormalizeByPercentOfTotal":"field"===U?"esriNormalizeByField":null;const pa=W.classBreakInfos.map(qa=>({symbol:x(qa.symbol,W,ba),min:qa.minValue,max:qa.maxValue})).sort((qa,va)=>qa.min-va.min);return{type:"interval",attributes:O.fields,field:ma,fieldIndex:oa,backgroundFillSymbol:x(ea,W,ba),defaultSymbol:x(W.defaultSymbol,W,ba),intervals:pa,normalizationField:W.normalizationField,normalizationTotal:W.normalizationTotal,normalizationType:U,isMaxInclusive:W.isMaxInclusive}}function fa(O,U,W,ba=
!1){const ea=[],ma=W.backgroundFillSymbol;U={target:U,context:{mesh:!0},resultType:"string"};if(W.field&&"string"!==typeof W.field)throw new k("ValidationError","Expected renderer.field to be a string",W);const {field:oa,fieldIndex:pa}=L(O,{...U,field:W.field,valueExpression:W.valueExpression});for(const qa of W.uniqueValueInfos)ea.push({value:""+qa.value,symbol:x(qa.symbol,W,ba)});return{type:"map",attributes:O.fields,field:oa,fieldIndex:pa,field2:L(O,{...U,field:W.field2}).field,field3:L(O,{...U,
field:W.field3}).field,fieldDelimiter:W.fieldDelimiter,backgroundFillSymbol:x(ma,W),defaultSymbol:x(W.defaultSymbol,W),map:ea}}const Q=A.getLogger("esri.views.2d.layers.features.schemaUtils"),V={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};y.addAggregateFields=Y;y.createMatcherSchema=da;y.createSchema=
function(O){D("esri-2d-update-debug")&&console.debug("Created new schema",K(O,!0));return K(O)};y.createSymbolSchema=x;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../renderers/visualVariables/support/SizeStop ../../../../renderers/visualVariables/SizeVariable ../../../../core/MD5 ../../engine/LevelDependentSizeVariable".split(" "),
function(y,D,E,B,A,k,c,b,e){function a(q,u,v){switch(q){case "avg":case "avg_angle":return`cluster_avg_${u}`;case "mode":return`cluster_type_${u}`;case "norm":return q=u.toLowerCase()+",norm:field,"+v.toLowerCase(),"cluster_avg_"+b.createMD5Hash(q)}}function d(q,u){const {name:v,outStatistic:z}=u,{onStatisticField:t,onStatisticValueExpression:w,statisticType:x}=z;w?(u=b.createMD5Hash(w.toLowerCase()),q.push({name:v,outStatistic:{onStatisticField:u,onStatisticValueExpression:w,statisticType:x}})):
t?q.push({name:v,outStatistic:{onStatisticField:t,statisticType:x}}):l.error(new A("mapview-unsupported-field","Unable to handle field",{field:u}))}function f(q,u,v){const z=b.createMD5Hash(u),t="mode"===v?`cluster_type_${z}`:`cluster_avg_${z}`;q.some(w=>w.name===t)||q.push({name:t,outStatistic:{onStatisticField:z,onStatisticValueExpression:u,statisticType:v}});return t}function n(q,u,v,z){if("cluster_count"===u||q.some(w=>w.name===u))return u;const t=a(v,u,z);q.some(w=>w.name===t)||("norm"===v?q.push({name:t,
outStatistic:{onStatisticField:u,onStatisticNormalizationField:z,statisticType:v}}):q.push({name:t,outStatistic:{onStatisticField:u,statisticType:v}}));return t}const l=B.getLogger("esri.views.2d.layers.support.clusterUtils");D.add("esri-cluster-arcade-enabled",1);const h=D("esri-cluster-arcade-enabled"),m=q=>{for(const u of q)if("size"===u.type)return u;return null},r=q=>{for(const u of q)if("cluster_count"===u.field)return!0;return!1},p=(q,u)=>{const v=[new k({value:0,size:0}),new k({value:1})];
if(E.isNone(u))return new c({field:"cluster_count",stops:[...v,new k({value:2,size:0})]});const z=Object.keys(u).reduce((t,w)=>({...t,[w]:[...v,new k({value:Math.max(2,u[w].minValue),size:q.clusterMinSize}),new k({value:Math.max(3,u[w].maxValue),size:q.clusterMaxSize})]}),{});return new e.LevelDependentSizeVariable({field:"cluster_count",levels:z})},g=q=>{const u=v=>l.error(new A("Unsupported-renderer",v,{renderer:q}));if("unique-value"===q.type){if(q.field2||q.field3)return u("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===q.type){if(q.normalizationField){const v=q.normalizationType;if("field"!==v)return u(`FeatureReductionCluster does not support a normalizationType of ${v}`),!1}}else if("simple"!==q.type)return u(`FeatureReductionCluster does not support renderers of type ${q.type}`),!1;if(!h){if("valueExpression"in q&&q.valueExpression)return u("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
q&&q.visualVariables||[]).some(v=>!!("valueExpression"in v&&v.valueExpression)))return u("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};y.createClusterCountSizeVariable=p;y.createClusterRenderer=(q,u,v,z)=>{u=u.clone();if(!g(u))return u;if(v.fields)for(var t of v.fields)d(q,t);if("visualVariables"in u){t=(u.visualVariables||[]).filter(x=>"$view.scale"!==x.valueExpression);const w=m(t);t.forEach(x=>
{"rotation"===x.type?x.field?x.field=n(q,x.field,"avg_angle"):x.valueExpression&&(x.field=f(q,x.valueExpression,"avg_angle"),x.valueExpression=null):x.normalizationField?(x.field=n(q,x.field,"norm",x.normalizationField),x.normalizationField=null):x.field?x.field=n(q,x.field,"avg"):(x.field=f(q,x.valueExpression,"avg"),x.valueExpression=null)});E.isNone(w)&&!r(t)&&(t.push(p(v,z)),u.dynamicClusterSize=!0);u.visualVariables=t}switch(u.type){case "unique-value":u.field?u.field=n(q,u.field,"mode"):u.valueExpression&&
(u.field=f(q,u.valueExpression,"mode"),u.valueExpression=null);break;case "class-breaks":u.normalizationField?(u.field=n(q,u.field,"norm",u.normalizationField),u.normalizationField=null):u.field?u.field=n(q,u.field,"avg"):(u.field=f(q,u.valueExpression,"avg"),u.valueExpression=null)}return u};y.findSizeVV=m;y.hasClusterCountVV=r;y.isClusterCompatibleRenderer=g;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(y){function D(b,e){const a=(b&65535)+
(e&65535);return(b>>16)+(e>>16)+(a>>16)<<16|a&65535}function E(b,e,a,d,f,n){b=D(D(e,b),D(d,n));return D(b<<f|b>>>32-f,a)}function B(b,e,a,d,f,n,l){return E(e&a|~e&d,b,e,f,n,l)}function A(b,e,a,d,f,n,l){return E(e&d|a&~d,b,e,f,n,l)}function k(b,e,a,d,f,n,l){return E(a^(e|~d),b,e,f,n,l)}const c={Base64:0,Hex:1,String:2,Raw:3};y.createMD5Hash=function(b,e=c.Hex){e=e||c.Base64;var a=[];for(let f=0,n=8*b.length;f<n;f+=8)a[f>>5]|=(b.charCodeAt(f/8)&255)<<f%32;{b=8*b.length;a[b>>5]|=128<<b%32;a[(b+64>>>
9<<4)+14]=b;b=1732584193;var d=-271733879;let f=-1732584194,n=271733878;for(let l=0;l<a.length;l+=16){const h=b,m=d,r=f,p=n;b=B(b,d,f,n,a[l+0],7,-680876936);n=B(n,b,d,f,a[l+1],12,-389564586);f=B(f,n,b,d,a[l+2],17,606105819);d=B(d,f,n,b,a[l+3],22,-1044525330);b=B(b,d,f,n,a[l+4],7,-176418897);n=B(n,b,d,f,a[l+5],12,1200080426);f=B(f,n,b,d,a[l+6],17,-1473231341);d=B(d,f,n,b,a[l+7],22,-45705983);b=B(b,d,f,n,a[l+8],7,1770035416);n=B(n,b,d,f,a[l+9],12,-1958414417);f=B(f,n,b,d,a[l+10],17,-42063);d=B(d,f,
n,b,a[l+11],22,-1990404162);b=B(b,d,f,n,a[l+12],7,1804603682);n=B(n,b,d,f,a[l+13],12,-40341101);f=B(f,n,b,d,a[l+14],17,-1502002290);d=B(d,f,n,b,a[l+15],22,1236535329);b=A(b,d,f,n,a[l+1],5,-165796510);n=A(n,b,d,f,a[l+6],9,-1069501632);f=A(f,n,b,d,a[l+11],14,643717713);d=A(d,f,n,b,a[l+0],20,-373897302);b=A(b,d,f,n,a[l+5],5,-701558691);n=A(n,b,d,f,a[l+10],9,38016083);f=A(f,n,b,d,a[l+15],14,-660478335);d=A(d,f,n,b,a[l+4],20,-405537848);b=A(b,d,f,n,a[l+9],5,568446438);n=A(n,b,d,f,a[l+14],9,-1019803690);
f=A(f,n,b,d,a[l+3],14,-187363961);d=A(d,f,n,b,a[l+8],20,1163531501);b=A(b,d,f,n,a[l+13],5,-1444681467);n=A(n,b,d,f,a[l+2],9,-51403784);f=A(f,n,b,d,a[l+7],14,1735328473);d=A(d,f,n,b,a[l+12],20,-1926607734);b=E(d^f^n,b,d,a[l+5],4,-378558);n=E(b^d^f,n,b,a[l+8],11,-2022574463);f=E(n^b^d,f,n,a[l+11],16,1839030562);d=E(f^n^b,d,f,a[l+14],23,-35309556);b=E(d^f^n,b,d,a[l+1],4,-1530992060);n=E(b^d^f,n,b,a[l+4],11,1272893353);f=E(n^b^d,f,n,a[l+7],16,-155497632);d=E(f^n^b,d,f,a[l+10],23,-1094730640);b=E(d^f^
n,b,d,a[l+13],4,681279174);n=E(b^d^f,n,b,a[l+0],11,-358537222);f=E(n^b^d,f,n,a[l+3],16,-722521979);d=E(f^n^b,d,f,a[l+6],23,76029189);b=E(d^f^n,b,d,a[l+9],4,-640364487);n=E(b^d^f,n,b,a[l+12],11,-421815835);f=E(n^b^d,f,n,a[l+15],16,530742520);d=E(f^n^b,d,f,a[l+2],23,-995338651);b=k(b,d,f,n,a[l+0],6,-198630844);n=k(n,b,d,f,a[l+7],10,1126891415);f=k(f,n,b,d,a[l+14],15,-1416354905);d=k(d,f,n,b,a[l+5],21,-57434055);b=k(b,d,f,n,a[l+12],6,1700485571);n=k(n,b,d,f,a[l+3],10,-1894986606);f=k(f,n,b,d,a[l+10],
15,-1051523);d=k(d,f,n,b,a[l+1],21,-2054922799);b=k(b,d,f,n,a[l+8],6,1873313359);n=k(n,b,d,f,a[l+15],10,-30611744);f=k(f,n,b,d,a[l+6],15,-1560198380);d=k(d,f,n,b,a[l+13],21,1309151649);b=k(b,d,f,n,a[l+4],6,-145523070);n=k(n,b,d,f,a[l+11],10,-1120210379);f=k(f,n,b,d,a[l+2],15,718787259);d=k(d,f,n,b,a[l+9],21,-343485551);b=D(b,h);d=D(d,m);f=D(f,r);n=D(n,p)}a=[b,d,f,n]}switch(e){case c.Raw:return a;case c.Hex:e=[];for(let f=0,n=4*a.length;f<n;f++)e.push("0123456789abcdef".charAt(a[f>>2]>>f%4*8+4&15)+
"0123456789abcdef".charAt(a[f>>2]>>f%4*8&15));return e=e.join("");case c.String:e=[];for(let f=0,n=32*a.length;f<n;f+=8)e.push(String.fromCharCode(a[f>>5]>>>f%32&255));return e=e.join("");case c.Base64:e=[];for(let f=0,n=4*a.length;f<n;f+=3)for(b=(a[f>>2]>>f%4*8&255)<<16|(a[f+1>>2]>>(f+1)%4*8&255)<<8|a[f+2>>2]>>(f+2)%4*8&255,d=0;4>d;d++)8*f+6*d>32*a.length?e.push("\x3d"):e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b>>6*(3-d)&63));return e=e.join("")}};y.outputTypes=
c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/lang ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../renderers/visualVariables/support/sizeVariableUtils ../../../renderers/visualVariables/SizeVariable".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){var r;y.LevelDependentSizeVariable=r=function(p){function g(){return p.apply(this,arguments)||this}D._inheritsLoose(g,p);var q=g.prototype;q.writeLevels=function(u,v,z){for(const t in u){v.stops=this.levels[t];break}};q.clone=function(){return new r({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:h.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:h.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(u=>u.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:A.clone(this.levels)})};return g}(m);E.__decorate([b.property()],y.LevelDependentSizeVariable.prototype,"levels",void 0);
E.__decorate([d.writer("levels")],y.LevelDependentSizeVariable.prototype,"writeLevels",null);y.LevelDependentSizeVariable=r=E.__decorate([a.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],y.LevelDependentSizeVariable);Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(y,D,E){y.getVVFlags=function(B){if(!B)return D.WGLVVFlag.NONE;let A=0;for(const k of B)"size"===
k.type?(B=E.getTypeOfSizeVisualVariable(k),A|=B,"outline"===k.target&&(A|=B<<4)):"color"===k.type?A|=D.WGLVVFlag.COLOR:"opacity"===k.type?A|=D.WGLVVFlag.OPACITY:"rotation"===k.type&&(A|=D.WGLVVFlag.ROTATION);return A};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../core/screenUtils ../../../engine/webgl/definitions ../../../../../symbols/cim/Rect ../../../../../symbols/cim/CIMSymbolHelper ../../graphics/graphicsUtils".split(" "),
function(y,D,E,B,A,k){function c(m){if(!("visualVariables"in m&&m.hasVisualVariables("size")))return 0;m=m.getVisualVariablesForType("size");if(!m[0])return 0;m=m[0];if("stops"===m.transformationType)return m.stops.map(r=>r.size).reduce(f,0);if("clamped-linear"===m.transformationType){let r=-Infinity,p=-Infinity;r="number"===typeof m.maxSize?m.maxSize:m.maxSize.stops.map(g=>g.size).reduce(f,0);p="number"===typeof m.minSize?m.minSize:m.minSize.stops.map(g=>g.size).reduce(f,0);return Math.max(r,p)}if("real-world-size"===
m.transformationType)return 30}function b(m,r){return null==m?r:m}async function e(m,r){if("simple-marker"===m.type)return r=Math.max(b(m.size,12),r),d(m)+.707*r;if("picture-marker"===m.type){var p=Math.max(b(m.height,12),r);r=b(m.width,12)*(p/b(m.height,12))/2;p/=2;return d(m)+Math.sqrt(r*r+p*p)}if("text"===m.type){if(p=m.text&&m.text.length){r=[];for(let g=0;g<p;g++)r.push({...h,code:m.text.charCodeAt(g)});r={glyphMosaicItems:r}}else r={glyphMosaicItems:[h]};k.getTextSymbolSize(l,m.toJSON(),r);
return Math.max(Math.abs(l[0]),Math.abs(l[1]))+Math.max(l[2],l[3])}return"simple-line"===m.type?(p=Math.max(b(m.width,.75),r)/2,m.marker?Math.max(6*m.width,2*r):p):"simple-fill"===m.type||"picture-fill"===m.type?Math.max(null==m.outline?0:b(m.outline.width,0),r)/2:"cim"===m.type?(m=A.CIMSymbolHelper.getEnvelope(m.data))?Math.sqrt(m.width*m.width+m.height*m.height):0:"web-style"===m.type?e(await m.fetchCIMSymbol(),r):0}async function a(m,r){return m.type in n?Math.min(await e(m,r),75):0}function d(m){const r=
b(m.xoffset,0);m=b(m.yoffset,0);return Math.sqrt(r*r+m*m)}function f(m,r){return Math.max(m,r)}const n={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},l=[0,0,0,0],h={sdf:!0,code:99,metrics:E.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new B(0,0,24,24),page:0,textureBinding:2};y.computePxBuffer=async function(m,r,p){if(!m||p&&"cluster"===p.type)return 0;if("heatmap"===m.type)return Math.round(3*m.blurRadius);if("dot-density"===m.type)return 0;
if("dictionary"===m.type)return"esriGeometryPoint"===r||"esriGeometryMultipoint"===r?100:200;r=m.getSymbols();m=c(m);p=[];for(var g of r)p.push(a(g,m));g=await Promise.all(p);return D.pt2px(g.reduce(f,0))};y.getPtMaxVVSize=c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(y,D,E){function B(c){return("size"===c.type||"color"===c.type||"opacity"===
c.type)&&null!=c.stops}function A(c){var b=c.type;var e=c.stops;if(8>=e.length)b=e;else if(k.warn(`Found ${e.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<e.length){{const [p,...g]=e;var a=g.pop(),d=g[0].value,f=g[g.length-1].value,n=(f-d)/6;const q=[];for(;d<f;d+=n){for(var l=0;d>=g[l].value;)l++;var h=g[l],m=e[l-1],r=d-m.value;h=h.value===m.value?1:r/(h.value-m.value);"color"===b?(m=g[l],l=e[l-1],r=m.color.clone(),r.r=(1-h)*l.color.r+h*r.r,
r.g=(1-h)*l.color.g+h*r.g,r.b=(1-h)*l.color.b+h*r.b,r.a=(1-h)*l.color.a+h*r.a,q.push({value:d,color:r,label:m.label})):"size"===b?(m=g[l],r=e[l-1],l=E.toPt(m.size),r=E.toPt(r.size),q.push({value:d,size:(1-h)*r+h*l,label:m.label})):(m=g[l],q.push({value:d,opacity:(1-h)*e[l-1].opacity+h*m.opacity,label:m.label}))}b=[p,...q,a]}}else{{const [p,...g]=e;for(b=g.pop();6<g.length;){a=e=0;for(f=1;f<g.length;f++)n=Math.abs(g[f].value-g[f-1].value),n>a&&(a=n,e=f);g.splice(e,1)}b=[p,...g,b]}}c.stops=b;return c}
const k=D.getLogger("esri.renderers.visualVariables.support.utils");y.simplifyVVRenderer=c=>{if(!("visualVariables"in c&&c.visualVariables&&c.visualVariables.length))return c;c=c.clone();const b=c.visualVariables.map(e=>B(e)?A(e):e);c.visualVariables=b;return c};y.simplifyVisualVariables=function(c){return c.map(b=>B(b)?A(b.clone()):b)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(y,D){const E=
new D.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});y.analyzeRings=function(B,A,k){const c=[],b=[];let e=0,a=0;for(const d of B){B=a;let f=d[0][0],n=d[0][1];c[a++]=f;c[a++]=n;let l=0;for(let h=1;h<d.length;++h){const m=f,r=n;f=d[h][0];n=d[h][1];l+=n*m-f*r;c[a++]=f;c[a++]=n}A(l/2);0<l?(0<B-e&&(k(e,B,c,b),e=B),b.length=0):0>l?0<B-e?b.push(.5*(B-e)):a=B:a=B}0<a-e&&
k(e,a,c,b)};y.toJSONGeometryType=function(B){return E.toJSON(B)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define(["exports","../../../../../../core/Logger","../../../../../../core/Error","../../util/Matcher"],function(y,D,E,B){const A=D.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");y.createMatcher=async function(k,c,b){switch(k.type){case "simple":return B.FeatureMatcher.fromBasicRenderer(k,c,b);case "map":return B.MapMatcher.fromUVRenderer(k,
c,b);case "interval":return B.IntervalMatcher.fromCBRenderer(k,c,b);case "dictionary":return B.DictionaryMatcher.fromDictionaryRenderer(k,c,b);default:return A.error(new E("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/Error ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/utils ../../../../../core/LRUCache ../../../arcade/callExpressionWithFeature ../../../../../symbols/cim/cimSymbolUtils ../../../layers/features/schemaUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){async function f(r,p){const g=r||1;if("number"===typeof g)return(u,v,z)=>g;const q=await k.createRendererExpression(g,p.spatialReference,p.fields);return(u,v,z)=>e(q,u,{$view:z},p.geometryType,v)||1}const n=B.getLogger("esri/views/2d/engine/webgl/util/Matcher");B=function(){function r(){this.type="feature";this._defaultResult=null}r.fromBasicRenderer=async function(g,q,u){const v=new r;g.symbol&&(g=await a.expandSymbol(g.symbol,u),q=q.createTemplateGroup(g,null),v.setDefault(q));
return v};var p=r.prototype;p.size=function(){return 1};p.getDefault=function(){return this._defaultResult};p.setDefault=function(g){this._defaultResult=g};p.match=function(g,q,u,v,z){return this.getDefault()};p.analyze=async function(g,q,u,v,z){return null};return r}();let l=function(r){function p(q,u,v,z){var t=r.call(this)||this;t.type="interval";t._intervals=[];t._isMaxInclusive=u;t._fieldIndex=z;t._field=q;t._normalizationInfo=v;return t}E._inheritsLoose(p,r);p.fromCBRenderer=async function(q,
u,v){const {isMaxInclusive:z,normalizationField:t,normalizationTotal:w,normalizationType:x}=q,C=new p(q.field,z,{normalizationField:t,normalizationTotal:w,normalizationType:x},q.fieldIndex),F=await a.expandSymbol(q.backgroundFillSymbol,v);await Promise.all(q.intervals.map(async H=>{var J=await a.expandSymbol(H.symbol,v);J=await u.createTemplateGroup(J,F);C.add({min:H.min,max:H.max},J)}));if(q=await a.expandSymbol(q.defaultSymbol,v))q=await u.createTemplateGroup(q,F),C.setDefault(q);return C};var g=
p.prototype;g.add=function(q,u){this._intervals.push({interval:q,result:u});this._intervals.sort((v,z)=>v.interval.min-z.interval.min)};g.size=function(){return r.prototype.size.call(this)+this._intervals.length};g.match=function(q,u,v,z,t){if(null==this._fieldIndex&&!this._field)return this.getDefault();q=null!=this._fieldIndex?u.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(u);if(!q&&(null===q||void 0===q||isNaN(q)))return this.getDefault();for(u=0;u<this._intervals.length;u++){const {interval:w,
result:x}=this._intervals[u];v=this._isMaxInclusive?q<=w.max:q<w.max;if(q>=w.min&&v)return x}return this.getDefault()};g._needsNormalization=function(){const q=this._normalizationInfo;return q&&(q.normalizationField||q.normalizationTotal||q.normalizationType)};g._getValueFromField=function(q){const u=q.readAttribute(this._field);if(!this._needsNormalization()||null==u)return u;const {normalizationField:v,normalizationTotal:z,normalizationType:t}=this._normalizationInfo;q=!!v&&q.readAttribute(v);if(t)switch(t){case "esriNormalizeByField":return(q||
void 0)&&u/q;case "esriNormalizeByLog":return Math.log(u)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return u/z*100;default:n.error(`Found unknown normalization type: ${t}`)}else n.error("Normalization is required, but no type was set!")};return p}(B),h=function(r){function p(q,u,v){var z=r.call(this)||this;z.type="map";z._nullResult=null;z._resultsMap=new Map;z._fieldsIndex=v;z._fields=q;z._seperator=u||"";return z}E._inheritsLoose(p,r);p.fromUVRenderer=async function(q,u,v){const z=q.fieldDelimiter,
t=[q.field];q.field2&&t.push(q.field2);q.field3&&t.push(q.field3);const w=await a.expandSymbol(q.backgroundFillSymbol,v),x=new p(t,z,q.fieldIndex);await Promise.all(q.map.map(async C=>{var F=await a.expandSymbol(C.symbol,v);F=await u.createTemplateGroup(F,w);"\x3cNull\x3e"===C.value?x.setNullResult(F):x.add(C.value,F)}));if(q=await a.expandSymbol(q.defaultSymbol,v))q=await u.createTemplateGroup(q,w),x.setDefault(q);return x};var g=p.prototype;g.setNullResult=function(q){this._nullResult=q};g.add=
function(q,u){this._resultsMap.set(q.toString(),u)};g.size=function(){return r.prototype.size.call(this)+this._resultsMap.size};g.match=function(q,u,v,z,t){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();q=null!=this._fieldsIndex?u.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(u);if(null!==this._nullResult&&(null==q||""===q||"\x3cNull\x3e"===q))return this._nullResult;if(!q&&null==q)return this.getDefault();q=q.toString();return this._resultsMap.has(q)?this._resultsMap.get(q):
this.getDefault()};g._getValueFromFields=function(q){const u=[];for(const v of this._fields){const z=q.readAttribute(v);u.push(z)}return u.join(this._seperator)};return p}(B),m=function(r){function p(q,u,v,z){var t=r.call(this)||this;t.type="dictionary";t._groupIdCache=new b(100);t._renderer=q;t._fieldMap=q.fieldMap;t._symbolFields=q.getSymbolFields();t._templates=u;t._info=v;t._scaleFn=z;return t}E._inheritsLoose(p,r);p.fromDictionaryRenderer=async function(q,u,v){q=(await new Promise(function(t,
w){y(["../../../../../renderers/DictionaryRenderer"],function(x){t(Object.freeze({__proto__:null,"default":x}))},w)})).default.fromJSON(q.renderer);await q.fetchResources({spatialReference:v.spatialReference,fields:v.fields});const z=await f(q.scaleExpression,v);return new p(q,u,v,z)};var g=p.prototype;g._analyzeFeature=async function(q,u,v,z){q=q.readLegacyFeature();const t=this._scaleFn(q,u,v);u=this._attributeHash(q)+"-"+t;const w=this._groupIdCache.get(u);if(w)return w;v=await this._renderer.getSymbolAsync(q,
{...v,spatialReference:this._info.spatialReference,abortOptions:z,fields:this._info.fields});v=d.createSymbolSchema(v,this._renderer);z=a.expandSymbol(v,this._info,z).then(x=>{if("expanded-cim"!==x.type)return n.error(new A("mapview-bad-type",`Found unexpected type ${x.type} in dictionary response`)),null;x.hash+="-"+t;for(const C of x.layers)C.scaleFactor=t,C.templateHash+="-"+t,"text"===C.type&&"string"===typeof C.text&&-1<C.text.indexOf("[")&&(C.text=c.createLabelOverrideFunction(this._fieldMap,
C.text,C.cim.textCase));return this._templates.createTemplateGroup(x,null)});this._groupIdCache.put(u,z,1);return z};g.analyze=async function(q,u,v,z,t){q=u.getCursor();for(u=[];q.next();)u.push(this._analyzeFeature(q,v,z,t));return Promise.all(u)};g.match=function(q,u,v,z,t){return null};g._attributeHash=function(q){let u="";for(const v of this._symbolFields){const z=this._fieldMap[v];z&&(u+=q.attributes[z]+"-")}return u};return p}(B);D.DictionaryMatcher=m;D.FeatureMatcher=B;D.IntervalMatcher=l;
D.MapMatcher=h;Object.defineProperty(D,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ../../util/Result ../../../../layers/features/schemaUtils ./WGLTextTemplate ./WGLMarkerTemplate ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ../../../../layers/features/textUtils ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ../../util/Lock".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p){function g(z,t){const w=z.length;z.push(null);t.then(x=>z[w]=x);return z}function q(z){return!!(z&1)}const u=E.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),v=[];E=function(){function z(w,x){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new p["default"];this._fetchResource=
w;this._joinOnUTurn=x}var t=z.prototype;t.createTemplateGroup=function(w,x){this._initErrorTemplates();const C=w.hash;if(this._symbolToTemplate.has(C))return this._symbolToTemplate.get(C);const F=[];x&&this._createMeshTemplates(F,x,!0);this._createMeshTemplates(F,w,!1);w=this._createGroupId("expanded-cim"===w.type);this._idToTemplateGroup.set(w,F);this._symbolToTemplate.set(C,w);return w};t.getTemplateGroup=function(w){return this._idToTemplateGroup.has(w)?this._idToTemplateGroup.get(w):v};t.getDynamicTemplateGroup=
function(w){if(!this._idToTemplateGroup.has(w))return v;q(w)||u.error("mapview-template-store",`Id ${w} does not refer to a dynamic template`);return this._idToTemplateGroup.get(w)};t.getMosaicItem=function(w,x){const C=this._createTemplateId(),F=new Promise(H=>this._idToResolver.set(C,H));this._fetchQueue.push({symbol:w,id:C,glyphIds:x});return F};t.finalize=function(w){return this._fetchQueue.length||this._lock.isHeld()?p.withLock(this._lock,this._fetchAllQueuedResources.bind(this),w):Promise.resolve()};
t._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],b.createSymbolSchema(k.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],b.createSymbolSchema(k.errorPointSymbol2D),!1),line:this._createMeshTemplates([],b.createSymbolSchema(k.errorPolylineSymbol2D),!1)})};t._fetchAllQueuedResources=function(w){if(!this._fetchQueue.length)return Promise.resolve();const x=this._fetchQueue,C=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=
[];return Promise.all(C).then(()=>this._fetchResource(x,w).then(F=>{for(const {id:H,mosaicItem:J}of F)this._idToResolver.get(H)(J),this._idToResolver.delete(H)})).catch(F=>{A.isAbortError(F)?this._fetchQueue=this._fetchQueue.concat(x):"worker:port-closed"!==F.name&&u.error(new B("mapview-template-store","Unable to fetch requested texture resources",F))})};t._createGroupId=function(w){return this._idCounter++<<1|(w?1:0)};t._createTemplateId=function(){return this._templateIdCounter++};t._createSMS=
async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w);return c.ok(x,u)?a.fromSimpleMarker(w,x):this._markerError};t._createPMS=async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w);return c.ok(x,u)?a.fromPictureMarker(w,x):this._markerError};t._createSFS=async function(w,x){const {spriteMosaicItem:C}=await this.getMosaicItem(w);return c.ok(C,u)?m.fromSimpleFill(w,C,x):this._fillError};t._createPFS=async function(w,x){const {spriteMosaicItem:C}=await this.getMosaicItem(w);
return c.ok(C,u)?m.fromPictureFill(w,C,x):this._fillError};t._createSLS=async function(w,x){({spriteMosaicItem:x}=await this.getMosaicItem(w));return c.ok(x,u)?r.fromSimpleLine(w,x,this._joinOnUTurn):this._lineError};t._createLMS=async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w);return c.ok(x,u)?a.fromLineSymbolMarker(w,x):this._markerError};t._createTS=async function(w){const {glyphMosaicItems:x}=await this.getMosaicItem(w);return e.fromText(w,x)};t._createCIMText=async function(w){const {glyphMosaicItems:x}=
await this.getMosaicItem(w.cim,l.codepoints(w.text));return c.ok(x,u)?e.fromCIMText(w,x):this._textError};t._createCIMFill=async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w.cim);return c.ok(x,u)?m.fromCIMFill(w,x):this._fillError};t._createCIMLine=async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w.cim);return c.ok(x,u)?r.fromCIMLine(w,x,this._joinOnUTurn):this._lineError};t._createCIMMarker=async function(w){const {spriteMosaicItem:x}=await this.getMosaicItem(w.cim);
return c.ok(x,u)?a.fromCIMMarker(w,x):this._markerError};t._createCIM=async function(w){const x=w.templateHash;if(this._cimTemplateCache.has(x))return this._cimTemplateCache.get(x);w={...w,cim:{...w.cim,mosaicHash:w.materialHash}};let C;switch(w.type){case "marker":C=this._createCIMMarker(w);break;case "line":C=this._createCIMLine(w);break;case "fill":C=this._createCIMFill(w);break;case "text":C=this._createCIMText(w)}C.then(F=>this._cimTemplateCache.set(x,F));return C};t._createDynamicCIM=function(w){const x=
w.templateHash;if(this._cimTemplateCache.has(x))return this._cimTemplateCache.get(x);let C;switch(w.type){case "marker":C=n.fromCIMMarker(w);break;case "line":C=f.fromCIMLine(w);break;case "fill":C=d.fromCIMFill(w);break;case "text":C=h.fromCIMText(w)}this._cimTemplateCache.set(x,C);return C};t._createPrimitiveMeshTemplates=function(w,x,C){switch(x.type){case "esriSMS":return g(w,this._createSMS(x));case "esriPMS":return g(w,this._createPMS(x));case "esriSFS":return g(w,this._createSFS(x,C));case "line-marker":return g(w,
this._createLMS(x));case "esriPFS":return g(w,this._createPFS(x,C));case "esriSLS":return g(w,this._createSLS(x,!1));case "esriTS":return g(w,this._createTS(x));default:return u.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),w}};t._createMeshTemplates=function(w,x,C){if(-1!==x.type.indexOf("3d"))return u.error("3D symbols are not supported with MapView"),w;if("expanded-cim"===x.type){for(const F of x.layers)"function"===typeof F.materialHash?w.push(this._createDynamicCIM(F)):
g(w,this._createCIM(F));return w}if("composite-symbol"===x.type){for(const F of x.layers)this._createPrimitiveMeshTemplates(w,F,C);return w}return"cim"===x.type||"label"===x.type||"web-style"===x.type?w:this._createPrimitiveMeshTemplates(w,x,C)};D._createClass(z,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return z}();y.WGLTemplateStore=E;y.isDynamicId=q;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../util/BidiText ../../materialKey/MaterialKey ../../color ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),function(y,D,E,B,A,k,c,b){return function(e){function a(d,f,n,l,h,m,r,p,g,q,u,v,z,t,w,x,C,F=!1){var H=
e.call(this)||this;H._xOffset=D.pt2px(v);H._yOffset=D.pt2px(z);H._decoration=g||"none";H._color=l;H._haloColor=h;H._haloSize=Math.min(Math.floor(5*D.pt2px(D.toPt(n))),127);H._size=Math.min(Math.round(D.pt2px(f)),127);f=Math.min(Math.round(D.pt2px(f)),127);H._referenceSize=Math.round(Math.sqrt(256*f));H._scale=H._size/24;H._angle=u;H._justify=E.getJustification(m||"center");H._xAlignD=E.getXAnchorDirection(m||"center");H._yAlignD=E.getYAnchorDirection(r||"baseline");H._baseline="baseline"===(r||"baseline");
H._bitset=(1===p?1:0)|(q?1:0)<<1;d=A.MaterialKeyBase.load(d);d.sdf=!0;H._materialKey=d.data;H._lineWidth=D.pt2px(t)||512;H._lineHeight=w||1;H._textPlacement=x;H._effects=C;H._isCIM=F;return H}y._inheritsLoose(a,e);a.fromText=function(d,f){const n=new a(d.materialKey,d.font.size,d.haloSize||0,d.color&&k.premultiplyAlphaRGBAArray(d.color)||0,d.haloColor&&k.premultiplyAlphaRGBAArray(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,0,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.lineWidth,
d.lineHeight,null,null,!1),[,l]=B.bidiText(d.text);n.bindTextInfo(f,l);n._vertexBoundsScale=d.maxVVSize?d.maxVVSize/d.font.size:1;return n};a.fromCIMText=function(d,f){var n=d.scaleFactor||1;const l=d.size*d.sizeRatio*n;n=new a(d.materialKey,l,d.outlineSize*d.sizeRatio,k.premultiplyAlphaRGBA(d.color),k.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.alignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*n,d.offsetY*d.sizeRatio*n,512,1,d.markerPlacement,
d.effects,!0);const [,h]=B.bidiText(d.text);n.bindTextInfo(f,h);n._vertexBoundsScale=d.maxVVSize?d.maxVVSize/l:1;return n};return a}(c(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../definitions ../../number ./shapingUtils ../../enums ../../materialKey/MaterialKey ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper".split(" "),
function(y,D,E,B,A,k,c,b,e,a){return d=>function(f){function n(...h){h=f.call(this,...h)||this;h._isCIM=!1;h._vertexBoundsScale=1;h.geometryType=b.WGLGeometryType.TEXT;h._aux=k.i8888to32(0,0,h._referenceSize,h._bitset);return h}y._inheritsLoose(n,f);var l=n.prototype;l.bindTextInfo=function(h,m){this._shapingInfo=h&&h.length?D.andThen(h,r=>c.shapeGlyphs(r,m,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,
Math.min(this._lineWidth,512)),lineHeight:A.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};l._write=function(h,m,r){const p=m.getDisplayId();this._writeGeometry(h,m,p,r)};l._writeGeometry=function(h,m,r,p){const g=this._shapingInfo;if(!D.isNone(g)){if(D.isSome(this._textPlacement))return m=null!=p?p:m.readLegacyGeometry(),this._writePlacedText(h,r,m,g);if(m=p?B.deltaDecodeGeometry(B.convertFromGeometry(p),2):"esriGeometryPolygon"===
m.geometryType?m.readCentroid():m.readUnquantizedGeometry()){if(m.isPoint){const [q,u]=m.coords;return this._writeGlyphs(h,r,{x:q,y:u},g)}m.forEachVertex((q,u)=>this._writeGlyphs(h,r,{x:q,y:u},g))}}};l._writePlacedText=function(h,m,r,p){var g=D.unwrap(this._textPlacement);if(r=a.CIMMarkerPlacementHelper.getPlacement(r,g,E.pt2px(1)))for(g=r.next();null!=g;){const q=g.getAngle();p.setRotation(q);this._writeGlyphs(h,m,{x:g.tx,y:g.ty},p);p.setRotation(-q);g=r.next()}};l._writeGlyphs=function(h,m,r,p){const g=
e.MaterialKeyBase.load(this._materialKey);r=k.i1616to32(Math.round(8*r.x),Math.round(8*r.y));for(const q of p.glyphs){g.textureBinding=q.textureBinding;h.recordStart(m,g.data,this.geometryType,!1,!0);p=q.bounds;const u=this._vertexBoundsScale;h.vertexBounds(p.x*u,p.y*u,p.width*u,p.height*u);this._writeVertices(h,m,r,q);h.recordEnd()}};l._writeGlyph=function(h,m,r,p,g){var q=e.MaterialKeyBase.load(this._materialKey);r=k.i1616to32(Math.round(8*r),Math.round(8*p));q.textureBinding=g.textureBinding;h.recordStart(m,
q.data,this.geometryType,!1,!0);q=g.bounds;p=this._vertexBoundsScale;h.vertexBounds(q.x*p,q.y*p,q.width*p,q.height*p);this._writeVertices(h,m,r,g);h.recordEnd()};l._writeVertices=function(h,m,r,p){const g=h.vertexCount();this._writeVertexCommon(h,m,r,p);h.vertexWrite(p.offsets.upperLeft);h.vertexWrite(p.texcoords.upperLeft);h.vertexEnd();this._writeVertexCommon(h,m,r,p);h.vertexWrite(p.offsets.upperRight);h.vertexWrite(p.texcoords.upperRight);h.vertexEnd();this._writeVertexCommon(h,m,r,p);h.vertexWrite(p.offsets.lowerLeft);
h.vertexWrite(p.texcoords.lowerLeft);h.vertexEnd();this._writeVertexCommon(h,m,r,p);h.vertexWrite(p.offsets.lowerRight);h.vertexWrite(p.texcoords.lowerRight);h.vertexEnd();h.indexWrite(g+0);h.indexWrite(g+1);h.indexWrite(g+2);h.indexWrite(g+1);h.indexWrite(g+3);h.indexWrite(g+2)};l._writeVertexCommon=function(h,m,r,p){p=this._color;const g=this._haloColor,q=k.i8888to32(0,0,this._referenceSize,this._bitset),u=k.i8888to32(0,0,this._size,this._haloSize);h.vertexWrite(r);h.vertexWrite(m);h.vertexWrite(p);
h.vertexWrite(g);h.vertexWrite(u);h.vertexWrite(q)};return n}(d)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(y,D,E){let B=function(){function A(){}A.getPlacement=function(k,c,b){const e=E.getPlacementOperator(c);if(!e)return null;k=D.cloneAndDecodeGeometry(k);return e.execute(k,c,b)};return A}();y.CIMMarkerPlacementHelper=B;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe",
"../../../../../../symbols/cim/effects/CIMEffectHelper"],function(y,D){return function(){function E(){}var B=E.prototype;B.bindFeature=function(A,k,c){};B.write=function(A,k){if(y.isNone(this._effects))return this._write(A,k);const c=D.CIMEffectHelper.executeEffects(this._effects,k.readLegacyGeometry());let b=D.CIMEffectHelper.next(c);for(;b;)this._write(A,k,b),b=D.CIMEffectHelper.next(c)};B._write=function(A,k,c){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports",
"../CIMEffects","../CIMCursor","../CIMOperators"],function(y,D,E,B){const A=96/72;let k=function(){function c(){}c.executeEffects=function(b,e){e=E.cloneAndDecodeGeometry(e);e=new D.SimpleGeometryCursor(e);for(const a of b)(b=B.getEffectOperator(a))&&(e=b.execute(e,a,A));return e};c.next=function(b){b=b.next();E.deltaEncodeGeometry(b);return b};return c}();y.CIMEffectHelper=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../definitions ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../materialKey/MaterialKey ../../color ./WGLMeshTemplate ./WGLBaseMarkerTemplate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){return function(f){function n(l,h,m,r,p,g,q,u,v,z,t,w,x,C,F,H,J,K,N,R,I){var L=f.call(this)||this;L.angle=r;L.height=q;L.width=g;L.xOffset=h*N;L.yOffset=m*N;L._markerPlacement=R;L._effects=I;L._anchorX=.5-(.5+H)*F.width/F.width;L._anchorY=.5-(.5+J)*F.height/F.height;h=(1===C?1:0)|(t?1:0)<<1|(x?1:0)<<2|(w?1:0)<<3;m=F&&F.sdf;l=b.MarkerMaterialKey.load(l);l.sdf=m;l.pattern=!0;l.textureBinding=F.textureBinding;L._materialKey=l.data;L._fillColor=p;L._outlineColor=v;L._sizeOutlineWidth=
c.i8888to32(Math.round(Math.min(Math.sqrt(128*g),255)),Math.round(Math.min(Math.sqrt(128*q),255)),Math.round(Math.min(Math.sqrt(128*z),255)),Math.round(Math.min(Math.sqrt(128*u),255)));p=F.rect.x+B.SPRITE_PADDING;u=F.rect.y+B.SPRITE_PADDING;v=p+F.width;F=u+F.height;L._offsets.xUpperLeft=p;L._offsets.yUpperLeft=u;L._offsets.xUpperRight=v;L._offsets.yUpperRight=u;L._offsets.xBottomLeft=p;L._offsets.yBottomLeft=F;L._offsets.xBottomRight=v;L._offsets.yBottomRight=F;L._texUpperLeft=c.i1616to32(p,u);L._texUpperRight=
c.i1616to32(v,u);L._texBottomLeft=c.i1616to32(p,F);L._texBottomRight=c.i1616to32(v,F);g=g*K*N;q=q*K*N;L._bitestAndDistRatio=c.i1616to32(h,Math.round(64*K));L._computedWidth=g;L._computedHeight=q;g=k.create();q=A.create();L._applyTransformation(q,g);return L}y._inheritsLoose(n,f);n.fromCIMMarker=function(l,h){const m=l.size,r=(h&&h.width||1)/(h&&h.height||1)*l.scaleX;var p=l.scaleSymbolsProportionally&&l.frameHeight?m/l.frameHeight:1;const g=e.premultiplyAlphaRGBA(l.color),q=e.premultiplyAlphaRGBA(l.outlineColor),
u=E.pt2px(m),v=u*r,z=E.pt2px(l.offsetX||0),t=E.pt2px(l.offsetY||0);p*=E.pt2px(l.outlineWidth||0);const w=l.alignment||0,x=E.pt2px(l.referenceSize);let C=l.rotation||0;l.rotateClockwise||(C=-C);let F=0,H=0;const J=l.anchorPoint;J&&(l.isAbsoluteAnchorPoint?m&&(F=-J.x/(m*r),H=J.y/m):(F=J.x,H=J.y));h=new n(l.materialKey,z,t,C,g,v,u,x,q,p,l.colorLocked,l.scaleSymbolsProportionally,!1,w,h,F,H,l.sizeRatio,D.unwrapOr(l.scaleFactor,1),l.markerPlacement,l.effects);h._vertexBoundsScaleX=l.maxVVSize?l.maxVVSize/
v:1;h._vertexBoundsScaleY=l.maxVVSize?l.maxVVSize/u:1;return h};n.fromPictureMarker=function(l,h){const m=Math.round(E.pt2px(l.width)),r=Math.round(E.pt2px(l.height)),p=B.PICTURE_FILL_COLOR,g=Math.round(E.pt2px(l.xoffset||0)),q=Math.round(E.pt2px(l.yoffset||0));h=new n(l.materialKey,g,q,l.angle,p,m,r,r,0,0,!1,!1,!1,0,h,0,0,1,1,null,null);h._vertexBoundsScaleX=l.maxVVSize?l.maxVVSize/l.width:1;h._vertexBoundsScaleY=l.maxVVSize?l.maxVVSize/l.height:1;return h};n.fromSimpleMarker=function(l,h){const m=
e.premultiplyAlphaRGBAArray(l.color),r=Math.round(E.pt2px(l.size)),p=Math.round(E.pt2px(l.xoffset||0)),g=Math.round(E.pt2px(l.yoffset||0)),q=l.style;var u=l.outline;const v=(u&&u.color&&e.premultiplyAlphaRGBAArray(u.color))|0;u=(u&&u.width&&Math.round(E.pt2px(u.width)))|0;h=new n(l.materialKey,p,g,l.angle,m,r,r,r,v,u,!1,!1,"esriSMSCross"===q||"esriSMSX"===q,0,h,0,0,1.96875,1,null,null);h.boundsType="esriSMSCircle"===q?"circle":"square";h._vertexBoundsScaleX=l.maxVVSize?l.maxVVSize/l.size:1;h._vertexBoundsScaleY=
l.maxVVSize?l.maxVVSize/l.size:1;return h};n.fromLineSymbolMarker=function(l,h){const m=e.premultiplyAlphaRGBAArray(l.color),r=Math.round(E.pt2px(6*l.lineWidth)),p="cross"===l.style||"x"===l.style;switch(l.placement){case "begin-end":var g="Both";break;case "begin":g="JustBegin";break;case "end":g="JustEnd";break;default:g="None"}g={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:g,offsetAlongLine:0};h=new n(l.materialKey,0,0,0,m,r,r,r/6,m,p?Math.round(E.pt2px(l.lineWidth)):
0,!1,!1,p,1,h,0,0,1.96875,1,g,null);h.boundsType="circle"===l.style?"circle":"square";return h};return n}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../chunks/vec2 ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../enums ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){const f=3.14159265359/180;return n=>function(l){function h(...r){r=l.call(this,...r)||this;r.angle=0;r.xOffset=0;r.yOffset=0;r.width=0;r.height=0;r.boundsType="square";r._anchorX=0;r._anchorY=0;r._computedWidth=0;r._computedHeight=0;r._vertexBoundsScaleX=1;r._vertexBoundsScaleY=1;r._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};r.geometryType=a.WGLGeometryType.MARKER;return r}y._inheritsLoose(h,
l);var m=h.prototype;m._write=function(r,p,g){const q=p.getDisplayId();r.recordStart(q,this._materialKey,this.geometryType,!1,!0);this._writeGeometry(r,p,q,g);r.recordEnd()};m._writeGeometry=function(r,p,g,q){if(D.isSome(this._markerPlacement))return this._writePlacedMarkers(r,p,q);if(p=q?B.deltaDecodeGeometry(B.convertFromGeometry(q),2):"esriGeometryPolygon"===p.geometryType?p.readCentroid():p.readUnquantizedGeometry()){if(p.isPoint){const [u,v]=p.coords;return!r.hasAggregates&&r.hasPixelBufferEnabled&&
(-1>u||513<=u||-1>v||513<=v)?void 0:this._writeVertices(r,g,this._getPos(u,v),u,v)}p.forEachVertex((u,v)=>this._writeVertices(r,g,this._getPos(u,v),u,v))}};m._writePlacedMarkers=function(r,p,g){g=null!=g?g:p.readLegacyGeometry();if(g=d.CIMMarkerPlacementHelper.getPlacement(g,D.unwrap(this._markerPlacement),E.pt2px(1))){p=p.getDisplayId();for(var q=b.create(),u=c.create(),v=g.next();null!=v;){const {tx:z,ty:t}=v;-128<=z&&640>=z&&-128<=t&&640>=t&&(this._applyTransformation(u,q,v.getAngle()/f),this._writeVertices(r,
p,this._getPos(z,t),z,t));v=g.next()}}};m._writeVertices=function(r,p,g,q,u){const v=r.vertexCount();r.vertexBounds(q+this.xOffset,u-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);r.vertexWrite(g);r.vertexWrite(this._offsetUpperLeft);r.vertexWrite(this._texUpperLeft);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(p);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexEnd();r.vertexWrite(g);
r.vertexWrite(this._offsetUpperRight);r.vertexWrite(this._texUpperRight);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(p);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexEnd();r.vertexWrite(g);r.vertexWrite(this._offsetBottomLeft);r.vertexWrite(this._texBottomLeft);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(p);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexEnd();
r.vertexWrite(g);r.vertexWrite(this._offsetBottomRight);r.vertexWrite(this._texBottomRight);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(p);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexEnd();r.indexWrite(v+0);r.indexWrite(v+1);r.indexWrite(v+2);r.indexWrite(v+1);r.indexWrite(v+3);r.indexWrite(v+2)};m._applyTransformation=function(r,p,g=0){k.identity(r);k.translate(r,r,b.fromValues(this.xOffset,-this.yOffset));0!==this.angle+
g&&k.rotate(r,r,f*(this.angle+g));g=this._computedWidth;const q=this._computedHeight,u=(this._anchorX-.5)*g,v=(this._anchorY-.5)*q;A.set(p,u,v);A.transformMat2d(p,p,r);this._offsetUpperLeft=e.i1616to32(16*p[0],16*p[1]);this._offsets.xUpperLeft=p[0];this._offsets.yUpperLeft=p[1];A.set(p,u+g,v);A.transformMat2d(p,p,r);this._offsetUpperRight=e.i1616to32(16*p[0],16*p[1]);this._offsets.xUpperRight=p[0];this._offsets.yUpperRight=p[1];A.set(p,u,v+q);A.transformMat2d(p,p,r);this._offsetBottomLeft=e.i1616to32(16*
p[0],16*p[1]);this._offsets.xBottomLeft=p[0];this._offsets.yBottomLeft=p[1];A.set(p,u+g,v+q);A.transformMat2d(p,p,r);this._offsetBottomRight=e.i1616to32(16*p[0],16*p[1]);this._offsets.xBottomRight=p[0];this._offsets.yBottomRight=p[1]};m._getPos=function(r,p){return e.i1616to32(Math.round(8*r),Math.round(8*p))};return h}(n)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../GeometryUtils ../../util/Result ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f){return function(n){function l(h){var m;var r=n.call(this,h)||this;if(a.isFunction(h.color))r._dynamicPropertyMap.set("_fillColor",(t,w,x)=>(t=h.color(t,w,x))&&c.premultiplyAlphaRGBA(t)||0);else{const t=h.color;r.fillColor=t&&c.premultiplyAlphaRGBA(t)||0}let p=0;a.isFunction(h.height)||(p=h.height||0);const g="CIMMarkerPlacementInsidePolygon"===(null==(m=h.cim.placement)?void 0:m.type)&&h.cim.placement.shiftOddRows?2:1;r._dynamicPropertyMap.set("_height",(t,w,x)=>
a.isFunction(h.height)?h.height(t,w,x)*g:p*g);let q=0;a.isFunction(h.offsetX)||(q=E.pt2px(h.offsetX||0)+128,255<q&&(q=255));r._dynamicPropertyMap.set("_offsetX",(t,w,x)=>a.isFunction(h.offsetX)?(t=E.pt2px(h.offsetX(t,w,x))+128,255<t&&(t=255),t):q);let u=1;a.isFunction(h.scaleX)||(u=h.scaleX||1);r._dynamicPropertyMap.set("_scaleX",(t,w,x)=>a.isFunction(h.scaleX)?h.scaleX(t,w,x):u);let v=0;a.isFunction(h.offsetY)||(v=E.pt2px(-h.offsetY||0)+128,255<v&&(v=255));r._dynamicPropertyMap.set("_offsetY",(t,
w,x)=>a.isFunction(h.offsetY)?(t=E.pt2px(-h.offsetY(t,w,x))+128,255<t&&(t=255),t):v);let z=0;a.isFunction(h.angle)||(z=b.radToByte(h.angle)||0);r._dynamicPropertyMap.set("_angle",(t,w,x)=>a.isFunction(h.angle)?b.radToByte(h.angle(t,w,x)):z);r._effects=h.effects;r._cimFillLayer=h;r._fillMaterialKey=k.FillMaterialKey.load(h.materialKey);return r}y._inheritsLoose(l,n);l.fromCIMFill=function(h){return new l(h)};l.prototype.bindFeature=function(h,m,r){const p=h.readLegacyFeature();this._dynamicPropertyMap.forEach((u,
v)=>{this[v]=u(p,m,r)});h=this._fillMaterialKey;var g=this._materialCache,q=this._cimFillLayer;this.aux3=A.i8888to32(0,0,this._angle,q.colorLocked?1:0);q=q.materialHash;q=q(p,m,r);q=g.get(q);g=null;q&&e.ok(q.spriteMosaicItem)&&(g=q.spriteMosaicItem);if(g){const {rect:u,width:v,height:z}=g;q=u.x+B.SPRITE_PADDING;const t=u.y+B.SPRITE_PADDING,w=q+v,x=t+z;let C=D.nextHighestPowerOfTwo(E.pt2px(this._height));255<C?C=255:0>=C&&(C=D.nextHighestPowerOfTwo(x-t));let F=D.nextHighestPowerOfTwo(E.pt2px(this._height/
z*v||0));255<F?F=255:0>=F&&(F=D.nextHighestPowerOfTwo(w-q));const H=this._scaleX;this.tl=A.i1616to32(q,t);this.br=A.i1616to32(w,x);this.aux1=A.i8888to32(F,C,this._offsetX,this._offsetY);this.aux2=A.i1616to32(128*H,128);h.sdf=g.sdf;h.pattern=!0;h.textureBinding=g.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,h.sdf=!1,h.pattern=!1,h.textureBinding=0;this._materialKey=h.data};return l}(d(f))})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(y){function D(E,
B){return Math.sqrt(E*E+B*B)}y.dist=function(E,B){return D(E[0]-B[0],E[1]-B[1])};y.getLimitCosine=function(E){return 1/Math.max(E,1)};y.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};y.isFunction=function(E){return"function"===typeof E};y.isMultipoint=function(E){return void 0!==E.points};y.isPoint=function(E){return void 0!==E.x&&void 0!==E.y};y.isPolygon=function(E){return void 0!==E.rings};y.isPolyline=function(E){return void 0!==E.paths};y.len=
D;y.normalize=function(E){const B=D(E[0],E[1]);E[0]/=B;E[1]/=B};y.sub=function(E,B,A){E[0]=B[0]-A[0];E[1]=B[1]-A[1];return E};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../number ../../enums ../../materialKey/MaterialKey ./templateUtils".split(" "),function(y,D,E,B,A,k,
c){return b=>function(e){function a(...f){f=e.call(this,...f)||this;f.forceLibtess=!1;f.geometryType=A.WGLGeometryType.FILL;return f}y._inheritsLoose(a,e);var d=a.prototype;d._write=function(f,n,l){const h="esriGeometryPoint"===n.geometryType,m=k.FillMaterialKey.load(this._materialKey);f.recordStart(n.getDisplayId(),this._materialKey,this.geometryType,m.dotDensity,h);this._writeGeometry(f,n,m,l,h);f.recordEnd()};d._writeGeometry=function(f,n,l,h,m){m=this._getGeometry(n,h,m);if(!D.isNone(m))if(h=
f.indexCount(),1E3<m.lengths[0]||this.forceLibtess||!c.triangulate(f,m)){m=c.triangulateLibtess(f,m);var r=f.indexCount();h!==r&&this._writeVertices(f,n,m,[m.length/2],l)}else r=f.indexCount(),h!==r&&this._writeVertices(f,n,m.coords,m.lengths,l)};d._writeVertices=function(f,n,l,h,m){const r=n.getDisplayId();let p=0;for(const q of h){var g=p;for(h=q+p;g<h;g++){const u=l[2*g],v=l[2*g+1],z=B.i1616to32(1*u,1*v);f.vertexBounds(u,v,0,0);f.vertexWrite(z);f.vertexWrite(r);m.dotDensity?f.vertexWriteF32(1/
Math.abs(n.readGeometryArea())):(f.vertexWrite(this.fillColor),f.vertexWrite(this.tl),f.vertexWrite(this.br),f.vertexWrite(this.aux1),f.vertexWrite(this.aux2),f.vertexWrite(this.aux3))}p+=q}};d._getGeometry=function(f,n,l){return(f=n?E.deltaDecodeGeometry(E.convertFromGeometry(n),2):f.readUnquantizedGeometry())?c.clipMarshall(f,l?256:128):null};return a}(b)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../layers/graphics/OptimizedGeometry ../../../../../../core/libs/earcut/earcut ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),
function(y,D,E,B,A,k,c){function b(l,h,m){let r=0;for(let p=1;p<m;p++)r+=(l[2*(h+p)]-l[2*(h+p-1)])*(l[2*(h+p)+1]+l[2*(h+p-1)+1]);return r}function e(l,h,m,r,p){let g=0;for(;m<r;m+=3){const q=2*(l.getValue(m)-p),u=2*(l.getValue(m+1)-p),v=2*(l.getValue(m+2)-p);g+=Math.abs((h[q]-h[v])*(h[u+1]-h[q+1])-(h[q]-h[u])*(h[v+1]-h[q+1]))}return g}function a(l,h,m,r,p,g,q,u){p=((l-p)*(g-u)-(h-u)*(p-q))/((l-m)*(g-u)-(h-r)*(p-q));return 0>p||1<p?null:{x:Math.round(l+p*(m-l)),y:Math.round(h+p*(r-h))}}const d=new c,
f=new A.TileClipper(0,0,0,1,0),n=new A.TileClipper(0,0,0,1,0);f.setExtent(B.TILE_SIZE);n.setExtent(B.TILE_SIZE);y.area=b;y.clip=function(l,h,m=0){const r=-m;h+=m;let p=m=0,g=0;for(let u=0;u<l.lengths.length;u++){const v=l.lengths[u],z=g+v;let t=0,w=null;for(;m!==z;){let x=l.coords[2*m],C=l.coords[2*m++ +1],F=x<r||x>=h||C<r||C>=h;for(var q=F;m!==z&&F===q;)F||(l.coords[2*p]=x,l.coords[2*p++ +1]=C,t++),x=l.coords[2*m],C=l.coords[2*m++ +1],F=x<r||x>=h||C<r||C>=h;if(m===z){F?w&&(l.coords[2*p]=w.x,l.coords[2*
p++ +1]=w.y,t++):(l.coords[2*p]=x,l.coords[2*p++ +1]=C,t++);continue}q=l.coords[2*(m-2)];const H=l.coords[2*(m-2)+1];if(q=a(q,H,x,C,r,r,h,r)||a(q,H,x,C,h,r,h,h)||a(q,H,x,C,h,h,r,h)||a(q,H,x,C,r,r,r,h))l.coords[2*p]=q.x,l.coords[2*p++ +1]=q.y,t++,w||(w=q);F||(l.coords[2*p]=x,l.coords[2*p++ +1]=C,t++)}l.lengths[u]=t;g+=v}};y.clipLinesMarshall=function(l,h){n.setPixelMargin(h);const m=-h;h=B.TILE_SIZE+h;let r=[];var p=!1;let g=0;for(;g<l.length;){const q=[],u=l[g];n.reset(2);let [v,z]=u[0];if(p)n.moveTo(v,
z);else{if(v<m||v>h||z<m||z>h){p=!0;continue}q.push({x:v,y:z})}let t=!1;const w=u.length;for(let x=1;x<w;++x)if(v+=u[x][0],z+=u[x][1],p)n.lineTo(v,z);else{if(v<m||v>h||z<m||z>h){t=!0;break}q.push({x:v,y:z})}if(t)p=!0;else{if(p){if(p=n.resultWithStarts())for(const x of p)r.push(x)}else r.push({line:q,start:0});g++;p=!1}}r=r.filter(q=>1<q.line.length);return 0===r.length?null:r};y.clipMarshall=function(l,h){a:{var m=B.TILE_SIZE+128;var r=0;for(var p=0;p<l.lengths.length;p++){var g=l.lengths[p];for(var q=
0;q<g;q++){const u=l.coords[2*(q+r)],v=l.coords[2*(q+r)+1];if(-128>u||u>m||-128>v||v>m){m=!0;break a}}r+=g}m=!1}if(!m)return l;f.setPixelMargin(h);f.reset(3);h=0;for(m=0;m<l.lengths.length;m++){r=l.lengths[m];p=l.coords[2*(0+h)];g=l.coords[2*(0+h)+1];f.moveTo(p,g);for(q=1;q<r;q++)p=l.coords[2*(q+h)],g=l.coords[2*(q+h)+1],f.lineTo(p,g);f.close();h+=r}m=f.result(!1);if(!m)return null;l=[];h=[];for(const u of m){m=0;for(const v of u)h.push(v.x),h.push(v.y),m++;l.push(m)}return new D(l,h)};y.triangleArea=
e;y.triangulate=function(l,h){const {coords:m,lengths:r,hasIndeterminateRingOrder:p}=h;h=l.indexWriter();l=l.vertexCount();if(p)return!1;const g=h.length;let q=0;for(var u=0;u<r.length;){let t=u,w=r[u];u=b(m,q,w);for(var v=[];++t<r.length;){var z=r[t];const x=b(m,q+w,z);if(!(0<x))break;u+=x;v.push(q+w);w+=z}z=h.length;k.bufcut(h,m,q,q+w,v,2,l);v=e(h,m,z,h.length,l);u=Math.abs(u);if(1E-5<Math.abs((v-u)/Math.max(1E-7,u)))return h.seek(g),!1;u=t;q+=w}return!0};y.triangulateEarcut=function(l,h,m){const {coords:r,
lengths:p,hasIndeterminateRingOrder:g}=h;if(g)return!1;let q=0;for(var u=0;u<p.length;){let z=u,t=p[u];for(u=[];++z<p.length;){var v=p[z];if(!(0<b(r,q+t,v)))break;u.push(q+t-q);t+=v}v=h.coords.slice(2*q,2*(q+t));u=E.earcut(v,u,2);for(const w of u)l.push(w+m+q);u=z;q+=t}return!0};y.triangulateLibtess=function(l,h){const m=[],r=[],p=l.indexWriter();l=l.vertexCount();const {coords:g,lengths:q}=h;d.beginPolygon(m,r);let u=0;for(let v=0;v<q.length;v++){const z=h.lengths[v];d.beginContour();for(let t=0;t<
z;t++){const w=[g[2*(u+t)],g[2*(u+t)+1],0];d.addVertex(w,w)}d.endContour();u+=z}d.endPolygon();for(h=0;h<r.length;h++)p.push(r[h]+l);return m};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/libs/earcut/earcut":function(){define(["exports"],function(y){function D(u,v,z,t,w){let x;if(w===0<n(u,v,z,t))for(;v<z;v+=t)x=k(v,u[v],u[v+1],x);else for(z-=t;z>=v;z-=t)x=k(z,u[z],u[z+1],x);x&&r(x,x.next)&&(c(x),x=x.next);return x}function E(u,v=u){if(!u)return u;let z;do if(z=!1,u.steiner||!r(u,
u.next)&&0!==d(u.prev,u,u.next))u=u.next;else{c(u);u=v=u.prev;if(u===u.next)break;z=!0}while(z||u!==v);return v}function B(u,v,z,t,w,x,C=0){if(u){!C&&x&&(u=a(u,t,w,x));for(var F=u;u.prev!==u.next;){var H=u.prev,J=u.next;if(x)var K=A(u,t,w,x);else a:{K=u;var N=K.prev,R=K;const I=K.next;if(0<=d(N,R,I)){K=!1;break a}let L=K.next.next;const G=L;let M=0;for(;L!==K.prev&&(0===M||L!==G);){M++;if(l(N.x,N.y,R.x,R.y,I.x,I.y,L.x,L.y)&&0<=d(L.prev,L,L.next)){K=!1;break a}L=L.next}K=!0}if(K)v.push(H.index/z),
v.push(u.index/z),v.push(J.index/z),c(u),F=u=J.next;else if(u=J,u===F){if(!C)B(E(u),v,z,t,w,x,1);else if(1===C){C=v;F=z;H=u;do J=H.prev,K=H.next.next,!r(J,K)&&f(J,H,H.next,K)&&h(J,K)&&h(K,J)&&(C.push(J.index/F),C.push(H.index/F),C.push(K.index/F),c(H),c(H.next),H=u=K),H=H.next;while(H!==u);u=H;B(u,v,z,t,w,x,2)}else if(2===C)a:{C=u;do{for(F=C.next.next;F!==C.prev;){if(H=C.index!==F.index){K=K=K=void 0;H=C;J=F;if(K=H.next.index!==J.index&&H.prev.index!==J.index){b:{K=H;do{if(K.index!==H.index&&K.next.index!==
H.index&&K.index!==J.index&&K.next.index!==J.index&&f(K,K.next,H,J)){K=!0;break b}K=K.next}while(K!==H);K=!1}K=!K}if(K=K&&h(H,J)&&h(J,H)){K=H;N=!1;R=(H.x+J.x)/2;J=(H.y+J.y)/2;do K.y>J!==K.next.y>J&&K.next.y!==K.y&&R<(K.next.x-K.x)*(J-K.y)/(K.next.y-K.y)+K.x&&(N=!N),K=K.next;while(K!==H);K=N}H=K}if(H){u=g(C,F);C=E(C,C.next);u=E(u,u.next);B(C,v,z,t,w,x);B(u,v,z,t,w,x);break a}F=F.next}C=C.next}while(C!==u)}break}}}}function A(u,v,z,t){const w=u.prev,x=u.next;if(0<=d(w,u,x))return!1;const C=w.x>u.x?
w.x>x.x?w.x:x.x:u.x>x.x?u.x:x.x,F=w.y>u.y?w.y>x.y?w.y:x.y:u.y>x.y?u.y:x.y,H=m(w.x<u.x?w.x<x.x?w.x:x.x:u.x<x.x?u.x:x.x,w.y<u.y?w.y<x.y?w.y:x.y:u.y<x.y?u.y:x.y,v,z,t);v=m(C,F,v,z,t);z=u.prevZ;for(t=u.nextZ;z&&z.z>=H&&t&&t.z<=v;){if(z!==u.prev&&z!==u.next&&l(w.x,w.y,u.x,u.y,x.x,x.y,z.x,z.y)&&0<=d(z.prev,z,z.next))return!1;z=z.prevZ;if(t!==u.prev&&t!==u.next&&l(w.x,w.y,u.x,u.y,x.x,x.y,t.x,t.y)&&0<=d(t.prev,t,t.next))return!1;t=t.nextZ}for(;z&&z.z>=H;){if(z!==u.prev&&z!==u.next&&l(w.x,w.y,u.x,u.y,x.x,
x.y,z.x,z.y)&&0<=d(z.prev,z,z.next))return!1;z=z.prevZ}for(;t&&t.z<=v;){if(t!==u.prev&&t!==u.next&&l(w.x,w.y,u.x,u.y,x.x,x.y,t.x,t.y)&&0<=d(t.prev,t,t.next))return!1;t=t.nextZ}return!0}function k(u,v,z,t){u=new q(u,v,z);t?(u.next=t.next,u.prev=t,t.next.prev=u,t.next=u):(u.prev=u,u.next=u);return u}function c(u){u.next.prev=u.prev;u.prev.next=u.next;u.prevZ&&(u.prevZ.nextZ=u.nextZ);u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function b(u){let v=u,z=u;do{if(v.x<z.x||v.x===z.x&&v.y<z.y)z=v;v=v.next}while(v!==u);
return z}function e(u,v){let z=v;const t=u.x,w=u.y;let x=-Infinity,C;do{if(w<=z.y&&w>=z.next.y&&z.next.y!==z.y){var F=z.x+(w-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(F<=t&&F>x){x=F;if(F===t){if(w===z.y)return z;if(w===z.next.y)return z.next}C=z.x<z.next.x?z:z.next}}z=z.next}while(z!==v);if(!C)return null;if(t===x)return C.prev;v=C;F=C.x;const H=C.y;let J=Infinity,K;for(z=C.next;z!==v;)t>=z.x&&z.x>=F&&t!==z.x&&l(w<H?t:x,w,F,H,w<H?x:t,w,z.x,z.y)&&(K=Math.abs(w-z.y)/(t-z.x),(K<J||K===J&&z.x>C.x)&&h(z,u)&&
(C=z,J=K)),z=z.next;return C}function a(u,v,z,t){for(var w;w!==u;w=w.next){w=w||u;null===w.z&&(w.z=m(w.x,w.y,v,z,t));if(w.prev.next!==w||w.next.prev!==w)return w.prev.next=w,w.next.prev=w,a(u,v,z,t);w.prevZ=w.prev;w.nextZ=w.next}u.prevZ.nextZ=null;u.prevZ=null;a:for(z=1;;){t=u;v=u=null;let x=0;for(;t;){x++;w=t;let C=0;for(;C<z&&w;C++)w=w.nextZ;let F=z;for(;0<C||0<F&&w;){let H;0===C?(H=w,w=w.nextZ,F--):0!==F&&w?t.z<=w.z?(H=t,t=t.nextZ,C--):(H=w,w=w.nextZ,F--):(H=t,t=t.nextZ,C--);v?v.nextZ=H:u=H;H.prevZ=
v;v=H}t=w}v.nextZ=null;z*=2;if(2>x)break a}return u}function d(u,v,z){return(v.y-u.y)*(z.x-v.x)-(v.x-u.x)*(z.y-v.y)}function f(u,v,z,t){return r(u,v)&&r(z,t)||r(u,t)&&r(z,v)?!0:0<d(u,v,z)!==0<d(u,v,t)&&0<d(z,t,u)!==0<d(z,t,v)}function n(u,v,z,t){let w=0;for(let x=v,C=z-t;x<z;x+=t)w+=(u[C]-u[x])*(u[x+1]+u[C+1]),C=x;return w}function l(u,v,z,t,w,x,C,F){return 0<=(w-C)*(v-F)-(u-C)*(x-F)&&0<=(u-C)*(t-F)-(z-C)*(v-F)&&0<=(z-C)*(x-F)-(w-C)*(t-F)}function h(u,v){return 0>d(u.prev,u,u.next)?0<=d(u,v,u.next)&&
0<=d(u,u.prev,v):0>d(u,v,u.prev)||0>d(u,u.next,v)}function m(u,v,z,t,w){u=32767*(u-z)*w;v=32767*(v-t)*w;u=(u|u<<8)&16711935;u=(u|u<<4)&252645135;u=(u|u<<2)&858993459;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=(v|v<<2)&858993459;return(u|u<<1)&1431655765|((v|v<<1)&1431655765)<<1}function r(u,v){return u.x===v.x&&u.y===v.y}function p(u,v){return u.x-v.x}function g(u,v){const z=new q(u.index,u.x,u.y),t=new q(v.index,v.x,v.y),w=u.next,x=v.prev;u.next=v;v.prev=u;z.next=w;w.prev=z;t.next=z;z.prev=t;x.next=
t;t.prev=x;return t}let q=function(u,v,z){this.index=u;this.x=v;this.y=z;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1};y.deviation=function(u,v,z,t){var w=v&&v.length;let x=Math.abs(n(u,0,w?v[0]*z:u.length,z));if(w)for(let C=0,F=v.length;C<F;C++)x-=Math.abs(n(u,v[C]*z,C<F-1?v[C+1]*z:u.length,z));v=0;for(w=0;w<t.length;w+=3){const C=t[w]*z,F=t[w+1]*z,H=t[w+2]*z;v+=Math.abs((u[C]-u[H])*(u[F+1]-u[C+1])-(u[C]-u[F])*(u[H+1]-u[C+1]))}return 0===x&&0===v?0:Math.abs((v-x)/x)};y.earcut=
function(u,v,z){var t=v&&v.length;const w=t?v[0]*z:u.length;var x=D(u,0,w,z,!0);const C=[];if(!x||x.next===x.prev)return C;let F,H;var J,K;if(t){t=[];for(let R=0,I=v.length;R<I;R++){var N=D(u,v[R]*z,R<I-1?v[R+1]*z:u.length,z,!1);N===N.next&&(N.steiner=!0);t.push(b(N))}t.sort(p);for(K of t){v=K;t=x;if(t=e(v,t))v=g(t,v),E(v,v.next);x=E(x,x.next)}}if(u.length>80*z){F=J=u[0];H=K=u[1];for(v=z;v<w;v+=z)t=u[v],N=u[v+1],F=Math.min(F,t),H=Math.min(H,N),J=Math.max(J,t),K=Math.max(K,N);J=Math.max(J-F,K-H);J=
0!==J?1/J:0}B(x,C,z,F,H,J);return C};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./GeometryUtils","./Geometry"],function(y,D,E,B,A){let k=function(a,d,f){this.ratio=a;this.x=d;this.y=f},c=function(){function a(f,n,l,h=8,m=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=h;this.pixelMargin=m;this.tileSize=E.TILE_SIZE*h;this.dz=f;this.yPos=
n;this.xPos=l}var d=a.prototype;d.setPixelMargin=function(f){f!==this.pixelMargin&&(this.pixelMargin=f,this.setExtent(this._extent))};d.setExtent=function(f){this._extent=f;this.finalRatio=this.tileSize/f*(1<<this.dz);let n=this.pixelRatio*this.pixelMargin;n/=this.finalRatio;f>>=this.dz;n>f&&(n=f);this.margin=n;this.xmin=f*this.xPos-n;this.ymin=f*this.yPos-n;this.xmax=this.xmin+f+2*n;this.ymax=this.ymin+f+2*n};d.reset=function(f){this.type=f;this.lines=[];this.starts=[];this.line=null;this.start=
0};d.moveTo=function(f,n){this._pushLine();this._prevIsIn=this._isIn(f,n);this._moveTo(f,n,this._prevIsIn);this._prevPt=new A.Point(f,n);this._firstPt=new A.Point(f,n);this._dist=0};d.lineTo=function(f,n){const l=this._isIn(f,n),h=new A.Point(f,n),m=A.Point.distance(this._prevPt,h);if(l)if(this._prevIsIn)this._lineTo(f,n,!0);else{var r=this._prevPt;var p=h;f=this._intersect(p,r);this.start=this._dist+m*(1-this._r);this._lineTo(f.x,f.y,!0);this._lineTo(p.x,p.y,!0)}else if(this._prevIsIn)p=this._prevPt,
r=h,f=this._intersect(p,r),this._lineTo(f.x,f.y,!0),this._lineTo(r.x,r.y,!1);else{const q=this._prevPt;if(!(q.x<=this.xmin&&h.x<=this.xmin||q.x>=this.xmax&&h.x>=this.xmax||q.y<=this.ymin&&h.y<=this.ymin||q.y>=this.ymax&&h.y>=this.ymax)){f=[];if(q.x<this.xmin&&h.x>this.xmin||q.x>this.xmin&&h.x<this.xmin){n=(this.xmin-q.x)/(h.x-q.x);var g=q.y+n*(h.y-q.y);g<=this.ymin?p=!1:g>=this.ymax?p=!0:f.push(new k(n,this.xmin,g))}if(q.x<this.xmax&&h.x>this.xmax||q.x>this.xmax&&h.x<this.xmax)n=(this.xmax-q.x)/(h.x-
q.x),g=q.y+n*(h.y-q.y),g<=this.ymin?p=!1:g>=this.ymax?p=!0:f.push(new k(n,this.xmax,g));if(q.y<this.ymin&&h.y>this.ymin||q.y>this.ymin&&h.y<this.ymin)n=(this.ymin-q.y)/(h.y-q.y),g=q.x+n*(h.x-q.x),g<=this.xmin?r=!1:g>=this.xmax?r=!0:f.push(new k(n,g,this.ymin));if(q.y<this.ymax&&h.y>this.ymax||q.y>this.ymax&&h.y<this.ymax)n=(this.ymax-q.y)/(h.y-q.y),g=q.x+n*(h.x-q.x),g<=this.xmin?r=!1:g>=this.xmax?r=!0:f.push(new k(n,g,this.ymax));if(0===f.length)r?p?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,
this.ymin,!0):p?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this.start=this._dist+m*f[1].ratio,this._lineTo(f[1].x,f[1].y,!0),this._lineTo(f[0].x,f[0].y,!0);else for(this.start=this._dist+m*f[0].ratio,r=0;r<f.length;r++)this._lineTo(f[r].x,f[r].y,!0)}this._lineTo(h.x,h.y,!1)}this._dist+=m;this._prevIsIn=l;this._prevPt=h};d.close=function(){if(2<this.line.length){var f=this._firstPt,n=this._prevPt;f.x===n.x&&f.y===n.y||this.lineTo(f.x,
f.y);f=this.line;for(n=f.length;4<=n;)if(f[0].x===f[1].x&&f[0].x===f[n-2].x||f[0].y===f[1].y&&f[0].y===f[n-2].y)f.pop(),f[0].x=f[n-2].x,f[0].y=f[n-2].y,--n;else break}};d.result=function(f=!0){this._pushLine();if(0===this.lines.length)return null;3===this.type&&f&&e.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};d.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();const f=this.lines,n=f.length;if(0===n)return null;const l=
[];for(let h=0;h<n;h++)l.push({line:f[h],start:this.starts[h]||0});return l};d._isIn=function(f,n){return f>=this.xmin&&f<=this.xmax&&n>=this.ymin&&n<=this.ymax};d._intersect=function(f,n){let l,h,m;if(n.x>=this.xmin&&n.x<=this.xmax)h=n.y<=this.ymin?this.ymin:this.ymax,m=(h-f.y)/(n.y-f.y),l=f.x+m*(n.x-f.x);else if(n.y>=this.ymin&&n.y<=this.ymax)l=n.x<=this.xmin?this.xmin:this.xmax,m=(l-f.x)/(n.x-f.x),h=f.y+m*(n.y-f.y);else{h=n.y<=this.ymin?this.ymin:this.ymax;l=n.x<=this.xmin?this.xmin:this.xmax;
const r=(l-f.x)/(n.x-f.x),p=(h-f.y)/(n.y-f.y);r<p?(m=r,h=f.y+r*(n.y-f.y)):(m=p,l=f.x+p*(n.x-f.x))}this._r=m;return new A.Point(l,h)};d._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};d._moveTo=function(f,n,l){3!==
this.type?l&&(f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line.push(new A.Point(f,n))):(l||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),n<this.ymin&&(n=this.ymin),n>this.ymax&&(n=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line.push(new A.Point(f,n)),this._is_v=this._is_h=!1)};d._lineTo=function(f,n,l){if(3!==this.type)if(l){f=
Math.round((f-(this.xmin+this.margin))*this.finalRatio);n=Math.round((n-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(l=this.line[this.line.length-1],l.equals(f,n)))return;this.line.push(new A.Point(f,n))}else this.line&&0<this.line.length&&this._pushLine();else if(l||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),n<this.ymin&&(n=this.ymin),n>this.ymax&&(n=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),
this.line&&0<this.line.length){l=this.line[this.line.length-1];const h=l.x===f,m=l.y===n;h&&m||(this._is_h&&h?(l.x=f,l.y=n,l=this.line[this.line.length-2],l.x===f&&l.y===n?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(l=this.line[this.line.length-2],this._is_h=l.x===f,this._is_v=l.y===n)):(this._is_h=l.x===f,this._is_v=l.y===n)):this._is_v&&m?(l.x=f,l.y=n,l=this.line[this.line.length-2],l.x===f&&l.y===n?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(l=this.line[this.line.length-
2],this._is_h=l.x===f,this._is_v=l.y===n)):(this._is_h=l.x===f,this._is_v=l.y===n)):(this.line.push(new A.Point(f,n)),this._is_h=h,this._is_v=m))}else this.line.push(new A.Point(f,n))};return a}(),b=function(){function a(){}var d=a.prototype;d.setExtent=function(f){this._ratio=4096===f?1:4096/f};d.reset=function(f){this.lines=[];this.line=null};d.moveTo=function(f,n){this.line&&this.lines.push(this.line);this.line=[];const l=this._ratio;this.line.push(new A.Point(f*l,n*l))};d.lineTo=function(f,n){const l=
this._ratio;this.line.push(new A.Point(f*l,n*l))};d.close=function(){const f=this.line;f&&!f[0].isEqual(f[f.length-1])&&f.push(f[0])};d.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};D._createClass(a,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return a}(),e=function(){function a(){}a.simplify=function(d,f,n){if(n){var l=-f,h=d+f,m=-f,r=d+f;d=[];f=[];var p=n.length;for(let g=0;g<p;++g){const q=n[g];if(!q||2>q.length)continue;
let u=q[0],v;const z=q.length;for(let t=1;t<z;++t)v=q[t],u.x===v.x&&(u.x<=l&&(u.y>v.y?(d.push(g),d.push(t),d.push(0),d.push(-1)):(f.push(g),f.push(t),f.push(0),f.push(-1))),u.x>=h&&(u.y<v.y?(d.push(g),d.push(t),d.push(1),d.push(-1)):(f.push(g),f.push(t),f.push(1),f.push(-1)))),u.y===v.y&&(u.y<=m&&(u.x<v.x?(d.push(g),d.push(t),d.push(2),d.push(-1)):(f.push(g),f.push(t),f.push(2),f.push(-1))),u.y>=r&&(u.x>v.x?(d.push(g),d.push(t),d.push(3),d.push(-1)):(f.push(g),f.push(t),f.push(3),f.push(-1)))),u=
v}0!==d.length&&0!==f.length&&(a.fillParent(n,f,d),a.fillParent(n,d,f),l=[],a.calcDeltas(l,f,d),a.calcDeltas(l,d,f),a.addDeltas(l,n))}};a.fillParent=function(d,f,n){const l=n.length,h=f.length;for(let q=0;q<h;q+=4){var m=f[q],r=f[q+1];const u=f[q+2],v=d[m][r-1];m=d[m][r];r=8092;let z=-1;for(let t=0;t<l;t+=4){if(n[t+2]!==u)continue;var p=n[t];const w=n[t+1];var g=d[p][w-1];p=d[p][w];switch(u){case 0:case 1:B.between(v.y,g.y,p.y)&&B.between(m.y,g.y,p.y)&&(g=Math.abs(p.y-g.y),g<r&&(r=g,z=t));break;case 2:case 3:B.between(v.x,
g.x,p.x)&&B.between(m.x,g.x,p.x)&&(g=Math.abs(p.x-g.x),g<r&&(r=g,z=t))}}f[q+3]=z}};a.calcDeltas=function(d,f,n){const l=f.length;for(let h=0;h<l;h+=4){const m=a.calcDelta(h,f,n,[]);d.push(f[h]);d.push(f[h+1]);d.push(f[h+2]);d.push(m)}};a.calcDelta=function(d,f,n,l){d=f[d+3];if(-1===d)return 0;const h=l.length;if(1<h&&l[h-2]===d)return 0;l.push(d);return a.calcDelta(d,n,f,l)+1};a.addDeltas=function(d,f){const n=d.length;let l=0;for(var h=0;h<n;h+=4){var m=d[h+3];m>l&&(l=m)}for(h=0;h<n;h+=4){m=f[d[h]];
const r=d[h+1],p=l-d[h+3];switch(d[h+2]){case 0:m[r-1].x-=p;m[r].x-=p;1===r&&(m[m.length-1].x-=p);r===m.length-1&&(m[0].x-=p);break;case 1:m[r-1].x+=p;m[r].x+=p;1===r&&(m[m.length-1].x+=p);r===m.length-1&&(m[0].x+=p);break;case 2:m[r-1].y-=p;m[r].y-=p;1===r&&(m[m.length-1].y-=p);r===m.length-1&&(m[0].y-=p);break;case 3:m[r-1].y+=p,m[r].y+=p,1===r&&(m[m.length-1].y+=p),r===m.length-1&&(m[0].y+=p)}}};return a}();y.SimpleBuilder=b;y.TileClipper=c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],
function(y){let D=function(){function E(A,k){this.x=A;this.y=k}var B=E.prototype;B.clone=function(){return new E(this.x,this.y)};B.equals=function(A,k){return A===this.x&&k===this.y};B.isEqual=function(A){return A.x===this.x&&A.y===this.y};B.setCoords=function(A,k){this.x=A;this.y=k};B.normalize=function(){var A=this.x;const k=this.y;A=Math.sqrt(A*A+k*k);this.x/=A;this.y/=A};B.rightPerpendicular=function(){const A=this.x;this.x=this.y;this.y=-A};B.move=function(A,k){this.x+=A;this.y+=k};B.assign=
function(A){this.x=A.x;this.y=A.y};B.assignAdd=function(A,k){this.x=A.x+k.x;this.y=A.y+k.y};B.assignSub=function(A,k){this.x=A.x-k.x;this.y=A.y-k.y};B.rotate=function(A,k){const c=this.x,b=this.y;this.x=c*A-b*k;this.y=c*k+b*A};B.scale=function(A){this.x*=A;this.y*=A};B.length=function(){const A=this.x,k=this.y;return Math.sqrt(A*A+k*k)};E.distance=function(A,k){const c=k.x-A.x;A=k.y-A.y;return Math.sqrt(c*c+A*A)};E.add=function(A,k){return new E(A.x+k.x,A.y+k.y)};E.sub=function(A,k){return new E(A.x-
k.x,A.y-k.y)};return E}();y.Point=D;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(y){function D(v,z,t,w,x,C,F){let H;t=0;for(let J=w,K=x-C;J<x;J+=C)t+=(v[K+z*C]-v[J+z*C])*(v[J+1+z*C]+v[K+1+z*C]),K=J;if(F===0<t)for(;w<x;w+=C)H=k(w+z*C,v[w+z*C],v[w+1+z*C],H);else for(x-=C;x>=w;x-=C)H=k(x+z*C,v[x+z*C],v[x+1+z*C],H);H&&m(H,H.next)&&(c(H),H=H.next);return H}function E(v,z=v){if(!v)return v;let t;do if(t=!1,v.steiner||
!m(v,v.next)&&0!==d(v.prev,v,v.next))v=v.next;else{c(v);v=z=v.prev;if(v===v.next)break;t=!0}while(t||v!==z);return z}function B(v,z,t,w,x,C,F,H){if(v){!H&&C&&(v=a(v,w,x,C));for(var J=v;v.prev!==v.next;){var K=v.prev,N=v.next;if(C)var R=A(v,w,x,C);else a:{R=v;var I=R.prev,L=R;const G=R.next;if(0<=d(I,L,G)){R=!1;break a}let M=R.next.next;const P=M;let T=0;for(;M!==R.prev&&(0===T||M!==P);){T++;if(n(I.x,I.y,L.x,L.y,G.x,G.y,M.x,M.y)&&0<=d(M.prev,M,M.next)){R=!1;break a}M=M.next}R=!0}if(R)z.push(K.index/
t+F),z.push(v.index/t+F),z.push(N.index/t+F),c(v),J=v=N.next;else if(v=N,v===J){if(!H)B(E(v),z,t,w,x,C,F,1);else if(1===H){H=z;J=t;K=F;N=v;do R=N.prev,I=N.next.next,!m(R,I)&&f(R,N,N.next,I)&&l(R,I)&&l(I,R)&&(H.push(R.index/J+K),H.push(N.index/J+K),H.push(I.index/J+K),c(N),c(N.next),N=v=I),N=N.next;while(N!==v);v=N;B(v,z,t,w,x,C,F,2)}else if(2===H)a:{H=v;do{for(J=H.next.next;J!==H.prev;){if(K=H.index!==J.index){R=R=R=void 0;K=H;N=J;if(R=K.next.index!==N.index&&K.prev.index!==N.index){b:{R=K;do{if(R.index!==
K.index&&R.next.index!==K.index&&R.index!==N.index&&R.next.index!==N.index&&f(R,R.next,K,N)){R=!0;break b}R=R.next}while(R!==K);R=!1}R=!R}if(R=R&&l(K,N)&&l(N,K)){R=K;I=!1;L=(K.x+N.x)/2;N=(K.y+N.y)/2;do R.y>N!==R.next.y>N&&R.next.y!==R.y&&L<(R.next.x-R.x)*(N-R.y)/(R.next.y-R.y)+R.x&&(I=!I),R=R.next;while(R!==K);R=I}K=R}if(K){v=p(H,J);H=E(H,H.next);v=E(v,v.next);B(H,z,t,w,x,C,F,0);B(v,z,t,w,x,C,F,0);break a}J=J.next}H=H.next}while(H!==v)}break}}}}function A(v,z,t,w){const x=v.prev,C=v.next;if(0<=d(x,
v,C))return!1;const F=x.x>v.x?x.x>C.x?x.x:C.x:v.x>C.x?v.x:C.x,H=x.y>v.y?x.y>C.y?x.y:C.y:v.y>C.y?v.y:C.y,J=h(x.x<v.x?x.x<C.x?x.x:C.x:v.x<C.x?v.x:C.x,x.y<v.y?x.y<C.y?x.y:C.y:v.y<C.y?v.y:C.y,z,t,w);z=h(F,H,z,t,w);t=v.prevZ;for(w=v.nextZ;t&&t.z>=J&&w&&w.z<=z;){if(t!==v.prev&&t!==v.next&&n(x.x,x.y,v.x,v.y,C.x,C.y,t.x,t.y)&&0<=d(t.prev,t,t.next))return!1;t=t.prevZ;if(w!==v.prev&&w!==v.next&&n(x.x,x.y,v.x,v.y,C.x,C.y,w.x,w.y)&&0<=d(w.prev,w,w.next))return!1;w=w.nextZ}for(;t&&t.z>=J;){if(t!==v.prev&&t!==
v.next&&n(x.x,x.y,v.x,v.y,C.x,C.y,t.x,t.y)&&0<=d(t.prev,t,t.next))return!1;t=t.prevZ}for(;w&&w.z<=z;){if(w!==v.prev&&w!==v.next&&n(x.x,x.y,v.x,v.y,C.x,C.y,w.x,w.y)&&0<=d(w.prev,w,w.next))return!1;w=w.nextZ}return!0}function k(v,z,t,w){v=g.create(v,z,t);w?(v.next=w.next,v.prev=w,w.next.prev=v,w.next=v):(v.prev=v,v.next=v);return v}function c(v){v.next.prev=v.prev;v.prev.next=v.next;v.prevZ&&(v.prevZ.nextZ=v.nextZ);v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function b(v){let z=v,t=v;do{if(z.x<t.x||z.x===t.x&&
z.y<t.y)t=z;z=z.next}while(z!==v);return t}function e(v,z){let t=z;const w=v.x,x=v.y;let C=-Infinity,F;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){var H=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(H<=w&&H>C){C=H;if(H===w){if(x===t.y)return t;if(x===t.next.y)return t.next}F=t.x<t.next.x?t:t.next}}t=t.next}while(t!==z);if(!F)return null;if(w===C)return F.prev;z=F;H=F.x;const J=F.y;let K=Infinity,N;for(t=F.next;t!==z;)w>=t.x&&t.x>=H&&w!==t.x&&n(x<J?w:C,x,H,J,x<J?C:w,x,t.x,t.y)&&(N=Math.abs(x-t.y)/(w-
t.x),(N<K||N===K&&t.x>F.x)&&l(t,v)&&(F=t,K=N)),t=t.next;return F}function a(v,z,t,w){for(var x;x!==v;x=x.next){x=x||v;null===x.z&&(x.z=h(x.x,x.y,z,t,w));if(x.prev.next!==x||x.next.prev!==x)return x.prev.next=x,x.next.prev=x,a(v,z,t,w);x.prevZ=x.prev;x.nextZ=x.next}v.prevZ.nextZ=null;v.prevZ=null;a:for(t=1;;){w=v;z=v=null;let C=0;for(;w;){C++;x=w;let F=0;for(;F<t&&x;F++)x=x.nextZ;let H=t;for(;0<F||0<H&&x;){let J;0===F?(J=x,x=x.nextZ,H--):0!==H&&x?w.z<=x.z?(J=w,w=w.nextZ,F--):(J=x,x=x.nextZ,H--):(J=
w,w=w.nextZ,F--);z?z.nextZ=J:v=J;J.prevZ=z;z=J}w=x}z.nextZ=null;t*=2;if(2>C)break a}return v}function d(v,z,t){return(z.y-v.y)*(t.x-z.x)-(z.x-v.x)*(t.y-z.y)}function f(v,z,t,w){return m(v,z)&&m(t,w)||m(v,w)&&m(t,z)?!0:0<d(v,z,t)!==0<d(v,z,w)&&0<d(t,w,v)!==0<d(t,w,z)}function n(v,z,t,w,x,C,F,H){return 0<=(x-F)*(z-H)-(v-F)*(C-H)&&0<=(v-F)*(w-H)-(t-F)*(z-H)&&0<=(t-F)*(C-H)-(x-F)*(w-H)}function l(v,z){return 0>d(v.prev,v,v.next)?0<=d(v,z,v.next)&&0<=d(v,v.prev,z):0>d(v,z,v.prev)||0>d(v,v.next,z)}function h(v,
z,t,w,x){v=32767*(v-t)*x;z=32767*(z-w)*x;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=(v|v<<2)&858993459;z=(z|z<<8)&16711935;z=(z|z<<4)&252645135;z=(z|z<<2)&858993459;return(v|v<<1)&1431655765|((z|z<<1)&1431655765)<<1}function m(v,z){return v.x===z.x&&v.y===z.y}function r(v,z){return v.x-z.x}function p(v,z){const t=g.create(v.index,v.x,v.y),w=g.create(z.index,z.x,z.y),x=v.next,C=z.prev;v.next=z;z.prev=v;t.next=x;x.prev=t;w.next=t;t.prev=w;C.next=w;w.prev=C;return w}let g=function(){function v(){this.y=
this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}v.create=function(z,t,w){const x=u<q.length?q[u++]:new v;x.index=z;x.x=t;x.y=w;x.prev=null;x.next=null;x.z=null;x.prevZ=null;x.nextZ=null;x.steiner=!1;return x};return v}();const q=[];let u=0;for(let v=0;8096>v;v++)q.push(new g);y.bufcut=function(v,z,t,w,x,C,F){u=0;var H=(w-t)*C,J=x&&x.length;const K=J?(x[0]-t)*C:H;var N=D(z,t,w,0,K,C,!0);if(N&&N.next!==N.prev){var R;if(J){J=[];for(let M=0,P=x.length;M<P;M++){const T=
D(z,t,w,x[M]*C,M<P-1?x[M+1]*C:w*C,C,!1);T===T.next&&(T.steiner=!0);J.push(b(T))}J.sort(r);for(var I of J){w=I;x=N;if(x=e(w,x))w=p(x,w),E(w,w.next);N=E(N,N.next)}}if(H>80*C){var L=H=z[t*C];var G=R=z[1+t*C];for(I=C;I<K;I+=C)w=z[I+t*C],x=z[I+1+t*C],L=Math.min(L,w),G=Math.min(G,x),H=Math.max(H,w),R=Math.max(R,x);R=Math.max(H-L,R-G);R=0!==R?1/R:0}B(N,v,C,L,G,R,F,0)}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["../../../../../core/Logger",
"../../../../../chunks/_commonjsHelpers"],function(y,D){var E=D.createCommonjsModule(function(A){(function(k){k=k();void 0!==k&&(A.exports=k)})(function(){var k={DEBUG:!1,assert:function(c,b){if(k.DEBUG&&!c)throw Error("Assertion failed"+(b?": "+b:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},
primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,
GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};k.geom.vertEq=function(c,b){return c.s===b.s&&c.t===b.t};k.geom.vertLeq=function(c,b){return c.s<b.s||c.s===b.s&&c.t<=b.t};k.geom.edgeEval=function(c,b,e){k.assert(k.geom.vertLeq(c,b)&&k.geom.vertLeq(b,e));var a=b.s-c.s,d=e.s-
b.s;return 0<a+d?a<d?b.t-c.t+a/(a+d)*(c.t-e.t):b.t-e.t+d/(a+d)*(e.t-c.t):0};k.geom.edgeSign=function(c,b,e){k.assert(k.geom.vertLeq(c,b)&&k.geom.vertLeq(b,e));var a=b.s-c.s,d=e.s-b.s;return 0<a+d?(b.t-e.t)*a+(b.t-c.t)*d:0};k.geom.transLeq=function(c,b){return c.t<b.t||c.t===b.t&&c.s<=b.s};k.geom.transEval=function(c,b,e){k.assert(k.geom.transLeq(c,b)&&k.geom.transLeq(b,e));var a=b.t-c.t,d=e.t-b.t;return 0<a+d?a<d?b.s-c.s+a/(a+d)*(c.s-e.s):b.s-e.s+d/(a+d)*(e.s-c.s):0};k.geom.transSign=function(c,b,
e){k.assert(k.geom.transLeq(c,b)&&k.geom.transLeq(b,e));var a=b.t-c.t,d=e.t-b.t;return 0<a+d?(b.s-e.s)*a+(b.s-c.s)*d:0};k.geom.edgeGoesLeft=function(c){return k.geom.vertLeq(c.dst(),c.org)};k.geom.edgeGoesRight=function(c){return k.geom.vertLeq(c.org,c.dst())};k.geom.vertL1dist=function(c,b){return Math.abs(c.s-b.s)+Math.abs(c.t-b.t)};k.geom.vertCCW=function(c,b,e){return 0<=c.s*(b.t-e.t)+b.s*(e.t-c.t)+e.s*(c.t-b.t)};k.geom.interpolate_=function(c,b,e,a){c=0>c?0:c;e=0>e?0:e;return c<=e?0===e?(b+a)/
2:b+c/(c+e)*(a-b):a+e/(c+e)*(b-a)};k.geom.edgeIntersect=function(c,b,e,a,d){if(!k.geom.vertLeq(c,b)){var f=c;c=b;b=f}k.geom.vertLeq(e,a)||(f=e,e=a,a=f);k.geom.vertLeq(c,e)||(f=c,c=e,e=f,f=b,b=a,a=f);if(k.geom.vertLeq(e,b))if(k.geom.vertLeq(b,a)){f=k.geom.edgeEval(c,e,b);var n=k.geom.edgeEval(e,b,a);0>f+n&&(f=-f,n=-n);d.s=k.geom.interpolate_(f,e.s,n,b.s)}else f=k.geom.edgeSign(c,e,b),n=-k.geom.edgeSign(c,a,b),0>f+n&&(f=-f,n=-n),d.s=k.geom.interpolate_(f,e.s,n,a.s);else d.s=(e.s+b.s)/2;k.geom.transLeq(c,
b)||(f=c,c=b,b=f);k.geom.transLeq(e,a)||(f=e,e=a,a=f);k.geom.transLeq(c,e)||(f=c,c=e,e=f,f=b,b=a,a=f);k.geom.transLeq(e,b)?k.geom.transLeq(b,a)?(f=k.geom.transEval(c,e,b),n=k.geom.transEval(e,b,a),0>f+n&&(f=-f,n=-n),d.t=k.geom.interpolate_(f,e.t,n,b.t)):(f=k.geom.transSign(c,e,b),n=-k.geom.transSign(c,a,b),0>f+n&&(f=-f,n=-n),d.t=k.geom.interpolate_(f,e.t,n,a.t)):d.t=(e.t+b.t)/2};k.mesh={};k.mesh.makeEdge=function(c){var b=k.mesh.makeEdgePair_(c.eHead);k.mesh.makeVertex_(b,c.vHead);k.mesh.makeVertex_(b.sym,
c.vHead);k.mesh.makeFace_(b,c.fHead);return b};k.mesh.meshSplice=function(c,b){var e=!1,a=!1;c!==b&&(b.org!==c.org&&(a=!0,k.mesh.killVertex_(b.org,c.org)),b.lFace!==c.lFace&&(e=!0,k.mesh.killFace_(b.lFace,c.lFace)),k.mesh.splice_(b,c),a||(k.mesh.makeVertex_(b,c.org),c.org.anEdge=c),e||(k.mesh.makeFace_(b,c.lFace),c.lFace.anEdge=c))};k.mesh.deleteEdge=function(c){var b=c.sym,e=!1;c.lFace!==c.rFace()&&(e=!0,k.mesh.killFace_(c.lFace,c.rFace()));c.oNext===c?k.mesh.killVertex_(c.org,null):(c.rFace().anEdge=
c.oPrev(),c.org.anEdge=c.oNext,k.mesh.splice_(c,c.oPrev()),e||k.mesh.makeFace_(c,c.lFace));b.oNext===b?(k.mesh.killVertex_(b.org,null),k.mesh.killFace_(b.lFace,null)):(c.lFace.anEdge=b.oPrev(),b.org.anEdge=b.oNext,k.mesh.splice_(b,b.oPrev()));k.mesh.killEdge_(c)};k.mesh.addEdgeVertex=function(c){var b=k.mesh.makeEdgePair_(c),e=b.sym;k.mesh.splice_(b,c.lNext);b.org=c.dst();k.mesh.makeVertex_(e,b.org);b.lFace=e.lFace=c.lFace;return b};k.mesh.splitEdge=function(c){var b=k.mesh.addEdgeVertex(c).sym;k.mesh.splice_(c.sym,
c.sym.oPrev());k.mesh.splice_(c.sym,b);c.sym.org=b.org;b.dst().anEdge=b.sym;b.sym.lFace=c.rFace();b.winding=c.winding;b.sym.winding=c.sym.winding;return b};k.mesh.connect=function(c,b){var e=!1,a=k.mesh.makeEdgePair_(c),d=a.sym;b.lFace!==c.lFace&&(e=!0,k.mesh.killFace_(b.lFace,c.lFace));k.mesh.splice_(a,c.lNext);k.mesh.splice_(d,b);a.org=c.dst();d.org=b.org;a.lFace=d.lFace=c.lFace;c.lFace.anEdge=d;e||k.mesh.makeFace_(a,c.lFace);return a};k.mesh.zapFace=function(c){var b=c.anEdge,e=b.lNext;do{var a=
e;e=a.lNext;a.lFace=null;if(null===a.rFace()){a.oNext===a?k.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,k.mesh.splice_(a,a.oPrev()));var d=a.sym;d.oNext===d?k.mesh.killVertex_(d.org,null):(d.org.anEdge=d.oNext,k.mesh.splice_(d,d.oPrev()));k.mesh.killEdge_(a)}}while(a!==b);b=c.prev;c=c.next;c.prev=b;b.next=c};k.mesh.meshUnion=function(c,b){var e=c.fHead,a=c.vHead,d=c.eHead,f=b.fHead,n=b.vHead;b=b.eHead;f.next!==f&&(e.prev.next=f.next,f.next.prev=e.prev,f.prev.next=e,e.prev=f.prev);n.next!==
n&&(a.prev.next=n.next,n.next.prev=a.prev,n.prev.next=a,a.prev=n.prev);b.next!==b&&(d.sym.next.sym.next=b.next,b.next.sym.next=d.sym.next,b.sym.next.sym.next=d,d.sym.next=b.sym.next);return c};k.mesh.deleteMesh=function(c){};k.mesh.makeEdgePair_=function(c){var b=new k.GluHalfEdge,e=new k.GluHalfEdge,a=c.sym.next;e.next=a;a.sym.next=b;b.next=c;c.sym.next=e;b.sym=e;b.oNext=b;b.lNext=e;e.sym=b;e.oNext=e;return e.lNext=b};k.mesh.splice_=function(c,b){var e=c.oNext,a=b.oNext;e.sym.lNext=b;a.sym.lNext=
c;c.oNext=a;b.oNext=e};k.mesh.makeVertex_=function(c,b){var e=b.prev,a=new k.GluVertex(b,e);e.next=a;b.prev=a;b=a.anEdge=c;do b.org=a,b=b.oNext;while(b!==c)};k.mesh.makeFace_=function(c,b){var e=b.prev,a=new k.GluFace(b,e);e.next=a;b.prev=a;a.anEdge=c;a.inside=b.inside;b=c;do b.lFace=a,b=b.lNext;while(b!==c)};k.mesh.killEdge_=function(c){var b=c.next;c=c.sym.next;b.sym.next=c;c.sym.next=b};k.mesh.killVertex_=function(c,b){var e=c.anEdge,a=e;do a.org=b,a=a.oNext;while(a!==e);b=c.prev;c=c.next;c.prev=
b;b.next=c};k.mesh.killFace_=function(c,b){var e=c.anEdge,a=e;do a.lFace=b,a=a.lNext;while(a!==e);b=c.prev;c=c.next;c.prev=b;b.next=c};k.normal={};k.normal.S_UNIT_X_=1;k.normal.S_UNIT_Y_=0;k.normal.projectPolygon=function(c,b,e,a){var d=!1,f=[b,e,a];0===b&&0===e&&0===a&&(k.normal.computeNormal_(c,f),d=!0);e=k.normal.longAxis_(f);b=c.mesh.vHead;if(k.TRUE_PROJECT){k.normal.normalize_(f);a=[0,0,0];var n=[0,0,0];a[e]=0;a[(e+1)%3]=k.normal.S_UNIT_X_;a[(e+2)%3]=k.normal.S_UNIT_Y_;e=k.normal.dot_(a,f);a[0]-=
e*f[0];a[1]-=e*f[1];a[2]-=e*f[2];k.normal.normalize_(a);n[0]=f[1]*a[2]-f[2]*a[1];n[1]=f[2]*a[0]-f[0]*a[2];n[2]=f[0]*a[1]-f[1]*a[0];k.normal.normalize_(n);for(f=b.next;f!==b;f=f.next)f.s=k.normal.dot_(f.coords,a),f.t=k.normal.dot_(f.coords,n)}else for(a=(e+1)%3,n=(e+2)%3,e=0<f[e]?1:-1,f=b.next;f!==b;f=f.next)f.s=f.coords[a],f.t=e*f.coords[n];d&&k.normal.checkOrientation_(c)};k.normal.dot_=function(c,b){return c[0]*b[0]+c[1]*b[1]+c[2]*b[2]};k.normal.normalize_=function(c){var b=c[0]*c[0]+c[1]*c[1]+
c[2]*c[2];k.assert(0<b);b=Math.sqrt(b);c[0]/=b;c[1]/=b;c[2]/=b};k.normal.longAxis_=function(c){var b=0;Math.abs(c[1])>Math.abs(c[0])&&(b=1);Math.abs(c[2])>Math.abs(c[b])&&(b=2);return b};k.normal.computeNormal_=function(c,b){var e=[-2*k.GLU_TESS_MAX_COORD,-2*k.GLU_TESS_MAX_COORD,-2*k.GLU_TESS_MAX_COORD],a=[2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD],d=[],f=[],n;c=c.mesh.vHead;for(n=c.next;n!==c;n=n.next)for(var l=0;3>l;++l){var h=n.coords[l];h<a[l]&&(a[l]=h,f[l]=n);h>e[l]&&
(e[l]=h,d[l]=n)}n=0;e[1]-a[1]>e[0]-a[0]&&(n=1);e[2]-a[2]>e[n]-a[n]&&(n=2);if(a[n]>=e[n])b[0]=0,b[1]=0,b[2]=1;else{e=0;a=f[n];d=d[n];f=[0,0,0];a=[a.coords[0]-d.coords[0],a.coords[1]-d.coords[1],a.coords[2]-d.coords[2]];l=[0,0,0];for(n=c.next;n!==c;n=n.next)l[0]=n.coords[0]-d.coords[0],l[1]=n.coords[1]-d.coords[1],l[2]=n.coords[2]-d.coords[2],f[0]=a[1]*l[2]-a[2]*l[1],f[1]=a[2]*l[0]-a[0]*l[2],f[2]=a[0]*l[1]-a[1]*l[0],h=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],h>e&&(e=h,b[0]=f[0],b[1]=f[1],b[2]=f[2]);0>=e&&(b[0]=
b[1]=b[2]=0,b[k.normal.longAxis_(a)]=1)}};k.normal.checkOrientation_=function(c){for(var b=0,e=c.mesh.fHead,a=e.next;a!==e;a=a.next){var d=a.anEdge;if(!(0>=d.winding)){do b+=(d.org.s-d.dst().s)*(d.org.t+d.dst().t),d=d.lNext;while(d!==a.anEdge)}}if(0>b)for(c=c.mesh.vHead,b=c.next;b!==c;b=b.next)b.t=-b.t};k.render={};k.render.renderMesh=function(c,b,e){for(var a=!1,d=-1,f=b.fHead.prev;f!==b.fHead;f=f.prev)if(f.inside){a||(c.callBeginCallback(k.primitiveType.GL_TRIANGLES),a=!0);var n=f.anEdge;k.assert(n.lNext.lNext.lNext===
n,"renderMesh called with non-triangulated mesh");do{if(e){var l=n.rFace().inside?0:1;d!==l&&(d=l,c.callEdgeFlagCallback(!!d))}c.callVertexCallback(n.org.data);n=n.lNext}while(n!==f.anEdge)}a&&c.callEndCallback()};k.render.renderBoundary=function(c,b){for(var e=b.fHead.next;e!==b.fHead;e=e.next)if(e.inside){c.callBeginCallback(k.primitiveType.GL_LINE_LOOP);var a=e.anEdge;do c.callVertexCallback(a.org.data),a=a.lNext;while(a!==e.anEdge);c.callEndCallback()}};k.sweep={};k.sweep.SENTINEL_COORD_=4*k.GLU_TESS_MAX_COORD;
k.sweep.TOLERANCE_NONZERO_=!1;k.sweep.computeInterior=function(c){c.fatalError=!1;k.sweep.removeDegenerateEdges_(c);k.sweep.initPriorityQ_(c);k.sweep.initEdgeDict_(c);for(var b;null!==(b=c.pq.extractMin());){for(;;){var e=c.pq.minimum();if(null===e||!k.geom.vertEq(e,b))break;e=c.pq.extractMin();k.sweep.spliceMergeVertices_(c,b.anEdge,e.anEdge)}k.sweep.sweepEvent_(c,b)}b=c.dict.getMin().getKey();c.event=b.eUp.org;k.sweep.doneEdgeDict_(c);k.sweep.donePriorityQ_(c);k.sweep.removeDegenerateFaces_(c.mesh);
c.mesh.checkMesh()};k.sweep.addWinding_=function(c,b){c.winding+=b.winding;c.sym.winding+=b.sym.winding};k.sweep.edgeLeq_=function(c,b,e){c=c.event;b=b.eUp;e=e.eUp;if(b.dst()===c)return e.dst()===c?k.geom.vertLeq(b.org,e.org)?0>=k.geom.edgeSign(e.dst(),b.org,e.org):0<=k.geom.edgeSign(b.dst(),e.org,b.org):0>=k.geom.edgeSign(e.dst(),c,e.org);if(e.dst()===c)return 0<=k.geom.edgeSign(b.dst(),c,b.org);b=k.geom.edgeEval(b.dst(),c,b.org);c=k.geom.edgeEval(e.dst(),c,e.org);return b>=c};k.sweep.deleteRegion_=
function(c,b){b.fixUpperEdge&&k.assert(0===b.eUp.winding);b.eUp.activeRegion=null;c.dict.deleteNode(b.nodeUp);b.nodeUp=null};k.sweep.fixUpperEdge_=function(c,b){k.assert(c.fixUpperEdge);k.mesh.deleteEdge(c.eUp);c.fixUpperEdge=!1;c.eUp=b;b.activeRegion=c};k.sweep.topLeftRegion_=function(c){var b=c.eUp.org;do c=c.regionAbove();while(c.eUp.org===b);c.fixUpperEdge&&(b=k.mesh.connect(c.regionBelow().eUp.sym,c.eUp.lNext),k.sweep.fixUpperEdge_(c,b),c=c.regionAbove());return c};k.sweep.topRightRegion_=function(c){var b=
c.eUp.dst();do c=c.regionAbove();while(c.eUp.dst()===b);return c};k.sweep.addRegionBelow_=function(c,b,e){var a=new k.ActiveRegion;a.eUp=e;a.nodeUp=c.dict.insertBefore(b.nodeUp,a);return e.activeRegion=a};k.sweep.isWindingInside_=function(c,b){switch(c.windingRule){case k.windingRule.GLU_TESS_WINDING_ODD:return 0!==(b&1);case k.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==b;case k.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<b;case k.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>b;case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=
b||-2>=b}k.assert(!1);return!1};k.sweep.computeWinding_=function(c,b){b.windingNumber=b.regionAbove().windingNumber+b.eUp.winding;b.inside=k.sweep.isWindingInside_(c,b.windingNumber)};k.sweep.finishRegion_=function(c,b){var e=b.eUp,a=e.lFace;a.inside=b.inside;a.anEdge=e;k.sweep.deleteRegion_(c,b)};k.sweep.finishLeftRegions_=function(c,b,e){var a=b;for(b=b.eUp;a!==e;){a.fixUpperEdge=!1;var d=a.regionBelow(),f=d.eUp;if(f.org!==b.org){if(!d.fixUpperEdge){k.sweep.finishRegion_(c,a);break}f=k.mesh.connect(b.lPrev(),
f.sym);k.sweep.fixUpperEdge_(d,f)}b.oNext!==f&&(k.mesh.meshSplice(f.oPrev(),f),k.mesh.meshSplice(b,f));k.sweep.finishRegion_(c,a);b=d.eUp;a=d}return b};k.sweep.addRightEdges_=function(c,b,e,a,d,f){var n=!0;do k.assert(k.geom.vertLeq(e.org,e.dst())),k.sweep.addRegionBelow_(c,b,e.sym),e=e.oNext;while(e!==a);for(null===d&&(d=b.regionBelow().eUp.rPrev());;){a=b.regionBelow();e=a.eUp.sym;if(e.org!==d.org)break;e.oNext!==d&&(k.mesh.meshSplice(e.oPrev(),e),k.mesh.meshSplice(d.oPrev(),e));a.windingNumber=
b.windingNumber-e.winding;a.inside=k.sweep.isWindingInside_(c,a.windingNumber);b.dirty=!0;!n&&k.sweep.checkForRightSplice_(c,b)&&(k.sweep.addWinding_(e,d),k.sweep.deleteRegion_(c,b),k.mesh.deleteEdge(d));n=!1;b=a;d=e}b.dirty=!0;k.assert(b.windingNumber-e.winding===a.windingNumber);f&&k.sweep.walkDirtyRegions_(c,b)};k.sweep.callCombine_=function(c,b,e,a,d){var f=[b.coords[0],b.coords[1],b.coords[2]];b.data=null;b.data=c.callCombineCallback(f,e,a);null===b.data&&(d?c.fatalError||(c.callErrorCallback(k.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
c.fatalError=!0):b.data=e[0])};k.sweep.spliceMergeVertices_=function(c,b,e){var a=[null,null,null,null];a[0]=b.org.data;a[1]=e.org.data;k.sweep.callCombine_(c,b.org,a,[.5,.5,0,0],!1);k.mesh.meshSplice(b,e)};k.sweep.vertexWeights_=function(c,b,e,a,d){var f=k.geom.vertL1dist(b,c),n=k.geom.vertL1dist(e,c),l=d+1;a[d]=.5*n/(f+n);a[l]=.5*f/(f+n);c.coords[0]+=a[d]*b.coords[0]+a[l]*e.coords[0];c.coords[1]+=a[d]*b.coords[1]+a[l]*e.coords[1];c.coords[2]+=a[d]*b.coords[2]+a[l]*e.coords[2]};k.sweep.getIntersectData_=
function(c,b,e,a,d,f){var n=[0,0,0,0],l=[e.data,a.data,d.data,f.data];b.coords[0]=b.coords[1]=b.coords[2]=0;k.sweep.vertexWeights_(b,e,a,n,0);k.sweep.vertexWeights_(b,d,f,n,2);k.sweep.callCombine_(c,b,l,n,!0)};k.sweep.checkForRightSplice_=function(c,b){var e=b.regionBelow(),a=b.eUp,d=e.eUp;if(k.geom.vertLeq(a.org,d.org)){if(0<k.geom.edgeSign(d.dst(),a.org,d.org))return!1;k.geom.vertEq(a.org,d.org)?a.org!==d.org&&(c.pq.remove(a.org.pqHandle),k.sweep.spliceMergeVertices_(c,d.oPrev(),a)):(k.mesh.splitEdge(d.sym),
k.mesh.meshSplice(a,d.oPrev()),b.dirty=e.dirty=!0)}else{if(0>k.geom.edgeSign(a.dst(),d.org,a.org))return!1;b.regionAbove().dirty=b.dirty=!0;k.mesh.splitEdge(a.sym);k.mesh.meshSplice(d.oPrev(),a)}return!0};k.sweep.checkForLeftSplice_=function(c,b){var e=b.regionBelow();c=b.eUp;var a=e.eUp;k.assert(!k.geom.vertEq(c.dst(),a.dst()));if(k.geom.vertLeq(c.dst(),a.dst())){if(0>k.geom.edgeSign(c.dst(),a.dst(),c.org))return!1;b.regionAbove().dirty=b.dirty=!0;e=k.mesh.splitEdge(c);k.mesh.meshSplice(a.sym,e);
e.lFace.inside=b.inside}else{if(0<k.geom.edgeSign(a.dst(),c.dst(),a.org))return!1;b.dirty=e.dirty=!0;e=k.mesh.splitEdge(a);k.mesh.meshSplice(c.lNext,a.sym);e.rFace().inside=b.inside}return!0};k.sweep.checkForIntersect_=function(c,b){var e=b.regionBelow(),a=b.eUp,d=e.eUp,f=a.org,n=d.org,l=a.dst(),h=d.dst(),m=new k.GluVertex;k.assert(!k.geom.vertEq(h,l));k.assert(0>=k.geom.edgeSign(l,c.event,f));k.assert(0<=k.geom.edgeSign(h,c.event,n));k.assert(f!==c.event&&n!==c.event);k.assert(!b.fixUpperEdge&&!e.fixUpperEdge);
if(f===n||Math.min(f.t,l.t)>Math.max(n.t,h.t))return!1;if(k.geom.vertLeq(f,n)){if(0<k.geom.edgeSign(h,f,n))return!1}else if(0>k.geom.edgeSign(l,n,f))return!1;k.geom.edgeIntersect(l,f,h,n,m);k.assert(Math.min(f.t,l.t)<=m.t);k.assert(m.t<=Math.max(n.t,h.t));k.assert(Math.min(h.s,l.s)<=m.s);k.assert(m.s<=Math.max(n.s,f.s));k.geom.vertLeq(m,c.event)&&(m.s=c.event.s,m.t=c.event.t);var r=k.geom.vertLeq(f,n)?f:n;k.geom.vertLeq(r,m)&&(m.s=r.s,m.t=r.t);if(k.geom.vertEq(m,f)||k.geom.vertEq(m,n))return k.sweep.checkForRightSplice_(c,
b),!1;if(!k.geom.vertEq(l,c.event)&&0<=k.geom.edgeSign(l,c.event,m)||!k.geom.vertEq(h,c.event)&&0>=k.geom.edgeSign(h,c.event,m)){if(h===c.event)return k.mesh.splitEdge(a.sym),k.mesh.meshSplice(d.sym,a),b=k.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,k.sweep.finishLeftRegions_(c,b.regionBelow(),e),k.sweep.addRightEdges_(c,b,a.oPrev(),a,a,!0),!0;if(l===c.event)return k.mesh.splitEdge(d.sym),k.mesh.meshSplice(a.lNext,d.oPrev()),e=b,b=k.sweep.topRightRegion_(b),f=b.regionBelow().eUp.rPrev(),e.eUp=d.oPrev(),
d=k.sweep.finishLeftRegions_(c,e,null),k.sweep.addRightEdges_(c,b,d.oNext,a.rPrev(),f,!0),!0;0<=k.geom.edgeSign(l,c.event,m)&&(b.regionAbove().dirty=b.dirty=!0,k.mesh.splitEdge(a.sym),a.org.s=c.event.s,a.org.t=c.event.t);0>=k.geom.edgeSign(h,c.event,m)&&(b.dirty=e.dirty=!0,k.mesh.splitEdge(d.sym),d.org.s=c.event.s,d.org.t=c.event.t);return!1}k.mesh.splitEdge(a.sym);k.mesh.splitEdge(d.sym);k.mesh.meshSplice(d.oPrev(),a);a.org.s=m.s;a.org.t=m.t;a.org.pqHandle=c.pq.insert(a.org);k.sweep.getIntersectData_(c,
a.org,f,l,n,h);b.regionAbove().dirty=b.dirty=e.dirty=!0;return!1};k.sweep.walkDirtyRegions_=function(c,b){for(var e=b.regionBelow();;){for(;e.dirty;)b=e,e=e.regionBelow();if(!b.dirty&&(e=b,b=b.regionAbove(),null===b||!b.dirty))break;b.dirty=!1;var a=b.eUp,d=e.eUp;a.dst()!==d.dst()&&k.sweep.checkForLeftSplice_(c,b)&&(e.fixUpperEdge?(k.sweep.deleteRegion_(c,e),k.mesh.deleteEdge(d),e=b.regionBelow(),d=e.eUp):b.fixUpperEdge&&(k.sweep.deleteRegion_(c,b),k.mesh.deleteEdge(a),b=e.regionAbove(),a=b.eUp));
if(a.org!==d.org)if(a.dst()===d.dst()||b.fixUpperEdge||e.fixUpperEdge||a.dst()!==c.event&&d.dst()!==c.event)k.sweep.checkForRightSplice_(c,b);else if(k.sweep.checkForIntersect_(c,b))break;a.org===d.org&&a.dst()===d.dst()&&(k.sweep.addWinding_(d,a),k.sweep.deleteRegion_(c,b),k.mesh.deleteEdge(a),b=e.regionAbove())}};k.sweep.connectRightVertex_=function(c,b,e){var a=e.oNext,d=b.regionBelow(),f=b.eUp,n=d.eUp,l=!1;f.dst()!==n.dst()&&k.sweep.checkForIntersect_(c,b);k.geom.vertEq(f.org,c.event)&&(k.mesh.meshSplice(a.oPrev(),
f),b=k.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,k.sweep.finishLeftRegions_(c,b.regionBelow(),d),l=!0);k.geom.vertEq(n.org,c.event)&&(k.mesh.meshSplice(e,n.oPrev()),e=k.sweep.finishLeftRegions_(c,d,null),l=!0);l?k.sweep.addRightEdges_(c,b,e.oNext,a,a,!0):(a=k.geom.vertLeq(n.org,f.org)?n.oPrev():f,a=k.mesh.connect(e.lPrev(),a),k.sweep.addRightEdges_(c,b,a,a.oNext,a.oNext,!1),a.sym.activeRegion.fixUpperEdge=!0,k.sweep.walkDirtyRegions_(c,b))};k.sweep.connectLeftDegenerate_=function(c,b,e){var a=
b.eUp;if(k.geom.vertEq(a.org,e))k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_&&k.sweep.spliceMergeVertices_(c,a,e.anEdge);else if(k.geom.vertEq(a.dst(),e)){if(k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_){b=k.sweep.topRightRegion_(b);a=b.regionBelow();var d=a.eUp.sym,f=d.oNext,n=f;a.fixUpperEdge&&(k.assert(f!==d),k.sweep.deleteRegion_(c,a),k.mesh.deleteEdge(d),d=f.oPrev());k.mesh.meshSplice(e.anEdge,d);k.geom.edgeGoesLeft(f)||(f=null);k.sweep.addRightEdges_(c,
b,d.oNext,n,f,!0)}}else k.mesh.splitEdge(a.sym),b.fixUpperEdge&&(k.mesh.deleteEdge(a.oNext),b.fixUpperEdge=!1),k.mesh.meshSplice(e.anEdge,a),k.sweep.sweepEvent_(c,e)};k.sweep.connectLeftVertex_=function(c,b){var e=new k.ActiveRegion;e.eUp=b.anEdge.sym;e=c.dict.search(e).getKey();var a=e.regionBelow(),d=e.eUp,f=a.eUp;0===k.geom.edgeSign(d.dst(),b,d.org)?k.sweep.connectLeftDegenerate_(c,e,b):(a=k.geom.vertLeq(f.dst(),d.dst())?e:a,e.inside||a.fixUpperEdge?(d=a===e?k.mesh.connect(b.anEdge.sym,d.lNext):
k.mesh.connect(f.dNext(),b.anEdge).sym,a.fixUpperEdge?k.sweep.fixUpperEdge_(a,d):k.sweep.computeWinding_(c,k.sweep.addRegionBelow_(c,e,d)),k.sweep.sweepEvent_(c,b)):k.sweep.addRightEdges_(c,e,b.anEdge,b.anEdge,null,!0))};k.sweep.sweepEvent_=function(c,b){c.event=b;for(var e=b.anEdge;null===e.activeRegion;)if(e=e.oNext,e===b.anEdge){k.sweep.connectLeftVertex_(c,b);return}b=k.sweep.topLeftRegion_(e.activeRegion);var a=b.regionBelow();e=a.eUp;a=k.sweep.finishLeftRegions_(c,a,null);a.oNext===e?k.sweep.connectRightVertex_(c,
b,a):k.sweep.addRightEdges_(c,b,a.oNext,e,e,!0)};k.sweep.addSentinel_=function(c,b){var e=new k.ActiveRegion,a=k.mesh.makeEdge(c.mesh);a.org.s=k.sweep.SENTINEL_COORD_;a.org.t=b;a.dst().s=-k.sweep.SENTINEL_COORD_;a.dst().t=b;c.event=a.dst();e.eUp=a;e.windingNumber=0;e.inside=!1;e.fixUpperEdge=!1;e.sentinel=!0;e.dirty=!1;e.nodeUp=c.dict.insert(e)};k.sweep.initEdgeDict_=function(c){c.dict=new k.Dict(c,k.sweep.edgeLeq_);k.sweep.addSentinel_(c,-k.sweep.SENTINEL_COORD_);k.sweep.addSentinel_(c,k.sweep.SENTINEL_COORD_)};
k.sweep.doneEdgeDict_=function(c){for(var b=0,e;null!==(e=c.dict.getMin().getKey());)e.sentinel||(k.assert(e.fixUpperEdge),k.assert(1===++b)),k.assert(0===e.windingNumber),k.sweep.deleteRegion_(c,e);c.dict=null};k.sweep.removeDegenerateEdges_=function(c){for(var b=c.mesh.eHead,e,a=b.next;a!==b;a=e){e=a.next;var d=a.lNext;k.geom.vertEq(a.org,a.dst())&&a.lNext.lNext!==a&&(k.sweep.spliceMergeVertices_(c,d,a),k.mesh.deleteEdge(a),a=d,d=a.lNext);if(d.lNext===a){if(d!==a){if(d===e||d===e.sym)e=e.next;k.mesh.deleteEdge(d)}if(a===
e||a===e.sym)e=e.next;k.mesh.deleteEdge(a)}}};k.sweep.initPriorityQ_=function(c){var b=new k.PriorityQ;c.pq=b;c=c.mesh.vHead;var e;for(e=c.next;e!==c;e=e.next)e.pqHandle=b.insert(e);b.init()};k.sweep.donePriorityQ_=function(c){c.pq.deleteQ();c.pq=null};k.sweep.removeDegenerateFaces_=function(c){for(var b,e=c.fHead.next;e!==c.fHead;e=b)b=e.next,e=e.anEdge,k.assert(e.lNext!==e),e.lNext.lNext===e&&(k.sweep.addWinding_(e.oNext,e),k.mesh.deleteEdge(e))};k.tessmono={};k.tessmono.tessellateMonoRegion_=function(c){c=
c.anEdge;for(k.assert(c.lNext!==c&&c.lNext.lNext!==c);k.geom.vertLeq(c.dst(),c.org);c=c.lPrev());for(;k.geom.vertLeq(c.org,c.dst());c=c.lNext);for(var b=c.lPrev(),e;c.lNext!==b;)if(k.geom.vertLeq(c.dst(),b.org)){for(;b.lNext!==c&&(k.geom.edgeGoesLeft(b.lNext)||0>=k.geom.edgeSign(b.org,b.dst(),b.lNext.dst()));)e=k.mesh.connect(b.lNext,b),b=e.sym;b=b.lPrev()}else{for(;b.lNext!==c&&(k.geom.edgeGoesRight(c.lPrev())||0<=k.geom.edgeSign(c.dst(),c.org,c.lPrev().org));)e=k.mesh.connect(c,c.lPrev()),c=e.sym;
c=c.lNext}for(k.assert(b.lNext!==c);b.lNext.lNext!==c;)e=k.mesh.connect(b.lNext,b),b=e.sym};k.tessmono.tessellateInterior=function(c){for(var b,e=c.fHead.next;e!==c.fHead;e=b)b=e.next,e.inside&&k.tessmono.tessellateMonoRegion_(e)};k.tessmono.discardExterior=function(c){for(var b,e=c.fHead.next;e!==c.fHead;e=b)b=e.next,e.inside||k.mesh.zapFace(e)};k.tessmono.setWindingNumber=function(c,b,e){for(var a,d=c.eHead.next;d!==c.eHead;d=a)a=d.next,d.rFace().inside!==d.lFace.inside?d.winding=d.lFace.inside?
b:-b:e?k.mesh.deleteEdge(d):d.winding=0};k.Dict=function(c,b){this.head_=new k.DictNode;this.frame_=c;this.leq_=b};k.Dict.prototype.deleteDict_=function(){};k.Dict.prototype.insertBefore=function(c,b){do c=c.prev;while(null!==c.key&&!this.leq_(this.frame_,c.key,b));b=new k.DictNode(b,c.next,c);c.next.prev=b;return c.next=b};k.Dict.prototype.insert=function(c){return this.insertBefore(this.head_,c)};k.Dict.prototype.deleteNode=function(c){c.next.prev=c.prev;c.prev.next=c.next};k.Dict.prototype.search=
function(c){var b=this.head_;do b=b.next;while(null!==b.key&&!this.leq_(this.frame_,c,b.key));return b};k.Dict.prototype.getMin=function(){return this.head_.next};k.Dict.prototype.getMax=function(){return this.head_.prev};k.DictNode=function(c,b,e){this.key=c||null;this.next=b||this;this.prev=e||this};k.DictNode.prototype.getKey=function(){return this.key};k.DictNode.prototype.getSuccessor=function(){return this.next};k.DictNode.prototype.getPredecessor=function(){return this.prev};k.GluTesselator=
function(){this.state_=k.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=k.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};k.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};k.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(k.GluTesselator.tessState_.T_DORMANT)};k.GluTesselator.prototype.gluTessProperty=function(c,b){switch(c){case k.gluEnum.GLU_TESS_TOLERANCE:return;case k.gluEnum.GLU_TESS_WINDING_RULE:switch(b){case k.windingRule.GLU_TESS_WINDING_ODD:case k.windingRule.GLU_TESS_WINDING_NONZERO:case k.windingRule.GLU_TESS_WINDING_POSITIVE:case k.windingRule.GLU_TESS_WINDING_NEGATIVE:case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=b;return}break;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!b;return;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(k.gluEnum.GLU_INVALID_VALUE)};k.GluTesselator.prototype.gluGetTessProperty=function(c){switch(c){case k.gluEnum.GLU_TESS_TOLERANCE:return 0;case k.gluEnum.GLU_TESS_WINDING_RULE:return c=this.windingRule,k.assert(c===k.windingRule.GLU_TESS_WINDING_ODD||c===k.windingRule.GLU_TESS_WINDING_NONZERO||c===k.windingRule.GLU_TESS_WINDING_POSITIVE||c===k.windingRule.GLU_TESS_WINDING_NEGATIVE||c===k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
c;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:return k.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}return!1};k.GluTesselator.prototype.gluTessNormal=function(c,b,e){this.normal_[0]=c;this.normal_[1]=b;this.normal_[2]=e};k.GluTesselator.prototype.gluTessCallback=function(c,b){b=b?b:null;switch(c){case k.gluEnum.GLU_TESS_BEGIN:case k.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=b;break;case k.gluEnum.GLU_TESS_EDGE_FLAG:case k.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
b;break;case k.gluEnum.GLU_TESS_VERTEX:case k.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=b;break;case k.gluEnum.GLU_TESS_END:case k.gluEnum.GLU_TESS_END_DATA:this.endCallback_=b;break;case k.gluEnum.GLU_TESS_ERROR:case k.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=b;break;case k.gluEnum.GLU_TESS_COMBINE:case k.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=b;break;case k.gluEnum.GLU_TESS_MESH:this.meshCallback_=b;break;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}};k.GluTesselator.prototype.gluTessVertex=
function(c,b){var e=!1,a=[0,0,0];this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);for(var d=0;3>d;++d){var f=c[d];f<-k.GLU_TESS_MAX_COORD&&(f=-k.GLU_TESS_MAX_COORD,e=!0);f>k.GLU_TESS_MAX_COORD&&(f=k.GLU_TESS_MAX_COORD,e=!0);a[d]=f}e&&this.callErrorCallback(k.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(a,b)};k.GluTesselator.prototype.gluTessBeginPolygon=function(c){this.requireState_(k.GluTesselator.tessState_.T_DORMANT);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new k.GluMesh;this.polygonData_=c};k.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);this.state_=k.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};k.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON};k.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=k.GluTesselator.tessState_.T_DORMANT;k.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);k.sweep.computeInterior(this);if(!this.fatalError){var c=this.mesh;this.boundaryOnly_?k.tessmono.setWindingNumber(c,1,!0):k.tessmono.tessellateInterior(c);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?k.render.renderBoundary(this,this.mesh):k.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){k.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}k.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};k.GluTesselator.prototype.requireState_=function(c){this.state_!==c&&this.gotoState_(c)};k.GluTesselator.prototype.gotoState_=function(c){for(;this.state_!==c;)if(this.state_<c)switch(this.state_){case k.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case k.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};k.GluTesselator.prototype.addVertex_=
function(c,b){var e=this.lastEdge_;null===e?(e=k.mesh.makeEdge(this.mesh),k.mesh.meshSplice(e,e.sym)):(k.mesh.splitEdge(e),e=e.lNext);e.org.data=b;e.org.coords[0]=c[0];e.org.coords[1]=c[1];e.org.coords[2]=c[2];e.winding=1;e.sym.winding=-1;this.lastEdge_=e};k.GluTesselator.prototype.callBeginCallback=function(c){this.beginCallback_&&this.beginCallback_(c,this.polygonData_)};k.GluTesselator.prototype.callVertexCallback=function(c){this.vertexCallback_&&this.vertexCallback_(c,this.polygonData_)};k.GluTesselator.prototype.callEdgeFlagCallback=
function(c){this.edgeFlagCallback_&&this.edgeFlagCallback_(c,this.polygonData_)};k.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};k.GluTesselator.prototype.callCombineCallback=function(c,b,e){return this.combineCallback_?this.combineCallback_(c,b,e,this.polygonData_)||null:null};k.GluTesselator.prototype.callErrorCallback=function(c){this.errorCallback_&&this.errorCallback_(c,this.polygonData_)};k.GluFace=function(c,b){this.next=c||this;
this.prev=b||this;this.anEdge=null;this.inside=!1};k.GluHalfEdge=function(c){this.next=c||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};k.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};k.GluHalfEdge.prototype.dst=function(){return this.sym.org};k.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};k.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};k.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
k.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};k.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};k.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};k.GluMesh=function(){this.vHead=new k.GluVertex;this.fHead=new k.GluFace;this.eHead=new k.GluHalfEdge;this.eHeadSym=new k.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};k.GluMesh.prototype.checkMesh=function(){if(k.DEBUG){var c=this.fHead,b=this.vHead,e=this.eHead,a,d;for(a=a=c;(d=
a.next)!==c;a=d){k.assert(d.prev===a);a=d.anEdge;do k.assert(a.sym!==a),k.assert(a.sym.sym===a),k.assert(a.lNext.oNext.sym===a),k.assert(a.oNext.sym.lNext===a),k.assert(a.lFace===d),a=a.lNext;while(a!==d.anEdge)}k.assert(d.prev===a&&null===d.anEdge);for(a=a=b;(c=a.next)!==b;a=c){k.assert(c.prev===a);a=c.anEdge;do k.assert(a.sym!==a),k.assert(a.sym.sym===a),k.assert(a.lNext.oNext.sym===a),k.assert(a.oNext.sym.lNext===a),k.assert(a.org===c),a=a.oNext;while(a!==c.anEdge)}k.assert(c.prev===a&&null===
c.anEdge&&null===c.data);for(b=b=e;(a=b.next)!==e;b=a)k.assert(a.sym.next===b.sym),k.assert(a.sym!==a),k.assert(a.sym.sym===a),k.assert(null!==a.org),k.assert(null!==a.dst()),k.assert(a.lNext.oNext.sym===a),k.assert(a.oNext.sym.lNext===a);k.assert(a.sym.next===b.sym&&a.sym===this.eHeadSym&&a.sym.sym===a&&null===a.org&&null===a.dst()&&null===a.lFace&&null===a.rFace())}};k.GluVertex=function(c,b){this.next=c||this;this.prev=b||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};k.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new k.PriorityQHeap};k.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};k.PriorityQ.prototype.init=function(){this.order_=[];for(var c=0;c<this.size_;c++)this.order_[c]=c;c=function(e){return function(a,d){return k.geom.vertLeq(e[a],e[d])?1:-1}}(this.verts_);this.order_.sort(c);this.initialized_=!0;this.heap_.init();if(k.DEBUG){var b=0+this.size_-1;for(c=0;c<
b;++c)k.assert(k.geom.vertLeq(this.verts_[this.order_[c+1]],this.verts_[this.order_[c]]))}};k.PriorityQ.prototype.insert=function(c){if(this.initialized_)return this.heap_.insert(c);var b=this.size_++;this.verts_[b]=c;return-(b+1)};k.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(k.geom.vertLeq(b,c))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return c};k.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(k.geom.vertLeq(b,c))return b}return c};k.PriorityQ.prototype.remove=function(c){if(0<=c)this.heap_.remove(c);else for(c=-(c+1),k.assert(c<this.verts_.length&&null!==this.verts_[c]),this.verts_[c]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};k.PriorityQHeap=function(){this.heap_=k.PriorityQHeap.reallocNumeric_([0],k.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=k.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};k.PriorityQHeap.INIT_SIZE_=32;k.PriorityQHeap.reallocNumeric_=function(c,b){for(var e=Array(b),a=0;a<c.length;a++)e[a]=c[a];for(;a<b;a++)e[a]=0;return e};k.PriorityQHeap.prototype.init=function(){for(var c=this.size_;1<=c;--c)this.floatDown_(c);
this.initialized_=!0};k.PriorityQHeap.prototype.insert=function(c){var b=++this.size_;2*b>this.max_&&(this.max_*=2,this.handles_=k.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));if(0===this.freeList_)var e=b;else e=this.freeList_,this.freeList_=this.handles_[this.freeList_];this.verts_[e]=c;this.handles_[e]=b;this.heap_[b]=e;this.initialized_&&this.floatUp_(b);return e};k.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};k.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
k.PriorityQHeap.prototype.extractMin=function(){var c=this.heap_,b=this.verts_,e=this.handles_,a=c[1],d=b[a];0<this.size_&&(c[1]=c[this.size_],e[c[1]]=1,b[a]=null,e[a]=this.freeList_,this.freeList_=a,0<--this.size_&&this.floatDown_(1));return d};k.PriorityQHeap.prototype.remove=function(c){var b=this.heap_,e=this.verts_,a=this.handles_;k.assert(1<=c&&c<=this.max_&&null!==e[c]);var d=a[c];b[d]=b[this.size_];a[b[d]]=d;d<=--this.size_&&(1>=d?this.floatDown_(d):k.geom.vertLeq(e[b[d>>1]],e[b[d]])?this.floatDown_(d):
this.floatUp_(d));e[c]=null;a[c]=this.freeList_;this.freeList_=c};k.PriorityQHeap.prototype.floatDown_=function(c){for(var b=this.heap_,e=this.verts_,a=this.handles_,d=b[c];;){var f=c<<1;f<this.size_&&k.geom.vertLeq(e[b[f+1]],e[b[f]])&&(f+=1);k.assert(f<=this.max_);var n=b[f];if(f>this.size_||k.geom.vertLeq(e[d],e[n])){b[c]=d;a[d]=c;break}b[c]=n;a[n]=c;c=f}};k.PriorityQHeap.prototype.floatUp_=function(c){for(var b=this.heap_,e=this.verts_,a=this.handles_,d=b[c];;){var f=c>>1,n=b[f];if(0===f||k.geom.vertLeq(e[n],
e[d])){b[c]=d;a[d]=c;break}b[c]=n;a[n]=c;c=f}};k.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};k.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};k.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return k})});const B=y.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");return function(){function A(){this._indexCounter=
this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new E.GluTesselator;this.glu.gluTessCallback(E.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(E.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(E.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(E.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(E.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));
this.glu.gluTessCallback(E.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(E.gluEnum.GLU_TESS_WINDING_RULE,E.windingRule.GLU_TESS_WINDING_ODD)}var k=A.prototype;k.beginPolygon=function(c,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(c);this._indices=b};k.endPolygon=function(){this.glu.gluTessEndPolygon()};k.beginContour=function(){this.glu.gluTessBeginContour()};
k.endContour=function(){this.glu.gluTessEndContour()};k.addVertex=function(c,b){this.glu.gluTessVertex(c,b)};k._vertexCallback=function(c,b){b[b.length]=c[0];b[b.length]=c[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(c=0;3>c;c++)-1===this._triangleIndices[c]&&(this._triangleIndices[c]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[c];this._currentVertexIndex=0}else this._currentVertexIndex++};k._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};k._endcallback=function(){this._currentVertexIndex=0};k._errorcallback=function(c){B.error(`Encountered error during tesselation: ${c}`)};k._combinecallback=function(c){return[c[0],c[1],c[2]]};k._edgeCallback=function(){};return A}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer",
"./WGLMeshTemplate"],function(y,D,E,B){const A=D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(k){function c(b){var e=k.call(this)||this;e._ongoingMaterialRequestMap=new Map;e._materialCache=new Map;e._dynamicPropertyMap=new Map;e._cimLayer=b;return e}y._inheritsLoose(c,k);c.prototype.analyze=function(b,e,a,d){e=e.readLegacyFeature();const f=this._materialCache,n=this._cimLayer.materialHash;if(!n)return A.error("A Dynamic mesh template must have a material hash value or function!"),
Promise.reject(null);const l="function"===typeof n?n(e,a,d):n;if(f.has(l))return b=f.get(l),Promise.resolve(b);if(this._ongoingMaterialRequestMap.has(l))return this._ongoingMaterialRequestMap.get(l);a=E.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);a.mosaicHash=l;b=b.getMosaicItem(a).then(h=>{this._ongoingMaterialRequestMap.delete(l);f.set(l,h);return h}).catch(h=>{this._ongoingMaterialRequestMap.delete(l);A.error(".analyze()",h.message);return null});this._ongoingMaterialRequestMap.set(l,
b);return b};return c}(B)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../util/Result ./util ./WGLDynamicMeshTemplate ./WGLBaseLineTemplate".split(" "),function(y,D,E,B,A,k,c,b,e,a){return function(d){function f(n){var l=d.call(this,n)||this;l._cimLineLayer=n;let h=0;b.isFunction(n.width)||(h=.5*
D.pt2px(n.width));l._dynamicPropertyMap.set("_halfWidth",(m,r,p)=>b.isFunction(n.width)?.5*D.pt2px(n.width(m,r,p)):h);b.isFunction(n.cap)?l._dynamicPropertyMap.set("_capType",n.cap):l._capType=n.cap;b.isFunction(n.join)?l._dynamicPropertyMap.set("_joinType",n.join):l._joinType=n.join;if(b.isFunction(n.color))l._dynamicPropertyMap.set("_fillColor",(m,r,p)=>(m=n.color(m,r,p))&&k.premultiplyAlphaRGBA(m)||0);else{const m=n.color;l._fillColor=m&&k.premultiplyAlphaRGBA(m)||0}b.isFunction(n.miterLimit)?
l._dynamicPropertyMap.set("_miterLimitCosine",(m,r,p)=>b.getLimitCosine(n.miterLimit(m,r,p))):l._miterLimitCosine=b.getLimitCosine(n.miterLimit);l._scaleFactor=n.scaleFactor||1;l._isDashed=n.isDashed;l._effects=n.effects;l.tessellationProperties._bitset=n.colorLocked?1:0;l._materialKey=n.materialKey;l._initializeTessellator(!0);return l}y._inheritsLoose(f,d);f.fromCIMLine=function(n){return new f(n)};f.prototype.bindFeature=function(n,l,h){const m=n.readLegacyFeature();this._dynamicPropertyMap.forEach((p,
g)=>{this[g]=p(m,l,h)});this._halfWidth*=this._scaleFactor;n=this._materialCache;var r=this._cimLineLayer.materialHash;r=r(m,l,h);r=n.get(r);n=null;r&&c.ok(r.spriteMosaicItem)&&(n=r.spriteMosaicItem);if(n){this._hasPattern=!0;const {rect:p,width:g,height:q}=n;r=p.x+E.SPRITE_PADDING;const u=p.y+E.SPRITE_PADDING,v=r+g,z=u+q;this.tessellationProperties._tl=B.i1616to32(r,u);this.tessellationProperties._br=B.i1616to32(v,z)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=
0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;r=A.LineMaterialKey.load(this._materialKey);n&&(r.sdf=n.sdf,r.pattern=!0,r.textureBinding=n.textureBinding);this._materialKey=r.data};return f}(a(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../number ../../enums ../../materialKey/MaterialKey ./templateUtils ../../TurboLine".split(" "),
function(y,D,E,B,A,k,c,b){const e=1/3.8,a=l=>h=>{const m=l.out;var r=Math.ceil(1024*l._halfWidth);const p=Math.ceil(1024*l._halfReferenceWidth);h.entry0=l.offset+l.vertexCount++;var g=B.i1616to32(h.distance,r),q=B.i8888to32(Math.round(31*h.prevNormal.x),Math.round(31*h.prevNormal.y),0,-31),u=B.i8888to32(0,0,0,l._bitset);m.vertexBounds(h.currentVertex.x,h.currentVertex.y,0,0);m.vertexWrite(B.i1616to32(8*h.currentVertex.x,8*h.currentVertex.y));m.vertexWrite(l.id);m.vertexWrite(l._fillColor);m.vertexWrite(q);
m.vertexWrite(g);m.vertexWrite(l._tl);m.vertexWrite(l._br);m.vertexWrite(u);m.vertexWrite(B.i1616to32(p,0));m.vertexEnd();h.entry2=l.offset+l.vertexCount++;g=B.i1616to32(h.distance,r);q=B.i8888to32(Math.round(31*-h.prevNormal.x),Math.round(31*-h.prevNormal.y),0,31);u=B.i8888to32(0,0,0,l._bitset);m.vertexBounds(h.currentVertex.x,h.currentVertex.y,0,0);m.vertexWrite(B.i1616to32(8*h.currentVertex.x,8*h.currentVertex.y));m.vertexWrite(l.id);m.vertexWrite(l._fillColor);m.vertexWrite(q);m.vertexWrite(g);
m.vertexWrite(l._tl);m.vertexWrite(l._br);m.vertexWrite(u);m.vertexWrite(B.i1616to32(p,0));m.vertexEnd();h.exit0=l.offset+l.vertexCount++;g=B.i1616to32(h.distance,r);q=B.i8888to32(Math.round(31*h.nextNormal.x),Math.round(31*h.nextNormal.y),0,-31);u=B.i8888to32(0,0,0,l._bitset);m.vertexBounds(h.currentVertex.x,h.currentVertex.y,0,0);m.vertexWrite(B.i1616to32(8*h.currentVertex.x,8*h.currentVertex.y));m.vertexWrite(l.id);m.vertexWrite(l._fillColor);m.vertexWrite(q);m.vertexWrite(g);m.vertexWrite(l._tl);
m.vertexWrite(l._br);m.vertexWrite(u);m.vertexWrite(B.i1616to32(p,0));m.vertexEnd();h.exit2=l.offset+l.vertexCount++;r=B.i1616to32(h.distance,r);g=B.i8888to32(Math.round(31*-h.nextNormal.x),Math.round(31*-h.nextNormal.y),0,31);q=B.i8888to32(0,0,0,l._bitset);m.vertexBounds(h.currentVertex.x,h.currentVertex.y,0,0);m.vertexWrite(B.i1616to32(8*h.currentVertex.x,8*h.currentVertex.y));m.vertexWrite(l.id);m.vertexWrite(l._fillColor);m.vertexWrite(g);m.vertexWrite(r);m.vertexWrite(l._tl);m.vertexWrite(l._br);
m.vertexWrite(q);m.vertexWrite(B.i1616to32(p,0));m.vertexEnd()},d=l=>h=>{const m=l.out;m.indexWrite(h.leftExit0);m.indexWrite(h.rightEntry0);m.indexWrite(h.leftExit2);m.indexWrite(h.rightEntry0);m.indexWrite(h.rightEntry2);m.indexWrite(h.leftExit2);l.indexCount+=6},f=l=>(h,m,r,p,g,q,u,v,z)=>{z=B.i1616to32(z,Math.ceil(1024*l._halfWidth));g=B.i8888to32(Math.round(31*g),Math.round(31*q),Math.round(31*u),Math.round(31*v));r=B.i8888to32(31*r,31*p,0,l._bitset);p=l.out;p.vertexBounds(h,m,1,1);p.vertexWrite(B.i1616to32(8*
h,8*m));p.vertexWrite(l.id);p.vertexWrite(l._fillColor);p.vertexWrite(g);p.vertexWrite(z);p.vertexWrite(l._tl);p.vertexWrite(l._br);p.vertexWrite(r);p.vertexWrite(B.i1616to32(Math.ceil(1024*l._halfReferenceWidth),0));p.vertexEnd();return l.offset+l.vertexCount++},n=l=>(h,m,r)=>{const p=l.out;p.indexWrite(h);p.indexWrite(m);p.indexWrite(r);l.indexCount+=3};return l=>function(h){function m(...p){p=h.call(this,...p)||this;p.tessellationProperties={};p._tessellationOptions={};p.geometryType=A.WGLGeometryType.LINE;
return p}y._inheritsLoose(m,h);var r=m.prototype;r._initializeTessellator=function(p){var g=k.LineMaterialKey.load(this._materialKey);const q=this._tessellationOptions;g=g.vvSizeFieldStops||g.vvSizeMinMaxValue||g.vvSizeScaleStops||g.vvSizeUnitValue;q.thin=this.tessellationProperties._halfWidth<E.THIN_LINE_THRESHOLD/2&&!p&&!g;q.trackDistance=this._isDashed||this._hasPattern;q.wrapDistance=65535;q.innerBisectorAutoSplitThreshold=e;q.outerBisectorAutoSplitThreshold=e;q.enableInnerBisectorSplit=this._isDashed||
this._hasPattern;q.enableOuterBisectorSplit=this._isDashed||this._hasPattern;q.thin?this._tessellationCallbacks={vertex:a(this.tessellationProperties),bridge:d(this.tessellationProperties)}:(p=new b.StandardTessellationCallbacks(f(this.tessellationProperties),n(this.tessellationProperties)),p.miterLimitCosine=this._miterLimitCosine,p.textured=this._isDashed||this._hasPattern,p.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=p)};r._write=function(p,g,q){const u="esriGeometryPoint"===g.geometryType;
p.recordStart(g.getDisplayId(),this._materialKey,this.geometryType,!1,u);this._writeGeometry(p,g,q,u);p.recordEnd()};r._writeGeometry=function(p,g,q,u){q=null!=q?q:g.readLegacyGeometry();u=this._getLines(q,u);D.isNone(u)||this._writeVertices(p,g,u)};r._getLines=function(p,g){if(D.isNone(p))return null;p=p.paths||p.rings;return D.isNone(p)?null:c.clipLinesMarshall(p,g?256:16)};r._writeVertices=function(p,g,q){g=g.getDisplayId();const u=p.vertexCount(),v=this.tessellationProperties;v.out=p;v.id=g;v.indexCount=
0;v.vertexCount=0;v.offset=u;for(const {line:z,start:t}of q)this._tessellationOptions.initialDistance=t%65535,this._tessellationCallbacks instanceof b.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),b.tessellate(z,this._tessellationOptions,this._tessellationCallbacks),b.cleanup()};return m}(l)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","./mesh/templates/util"],function(y,D){function E(){if(g.cosine<
d.innerBisectorAutoSplitThreshold){g.splitInner=!0;g.gapInner=!0;var v=Math.max(d.innerBisectorAutoSplitThreshold,g.cosine);v=Math.sqrt(1-v*v)/v;g.leftInner.x=g.nextNormal.x+g.sign*v*g.outbound.x;g.leftInner.y=g.nextNormal.y+g.sign*v*g.outbound.y;g.rightInner.x=g.prevNormal.x-g.sign*v*g.inbound.x;g.rightInner.y=g.prevNormal.y-g.sign*v*g.inbound.y}else d.enableInnerBisectorSplit&&(g.splitInner=!0,g.gapInner=!1,g.leftInner.x=g.rightInner.x=g.bisector.x/g.cosine,g.leftInner.y=g.rightInner.y=g.bisector.y/
g.cosine);g.cosine<d.outerBisectorAutoSplitThreshold?(g.splitOuter=!0,g.gapOuter=!0,v=Math.max(d.outerBisectorAutoSplitThreshold,g.cosine),v=Math.sqrt(1-v*v)/v,g.leftOuter.x=g.prevNormal.x-g.sign*v*g.inbound.x,g.leftOuter.y=g.prevNormal.y-g.sign*v*g.inbound.y,g.rightOuter.x=g.nextNormal.x+g.sign*v*g.outbound.x,g.rightOuter.y=g.nextNormal.y+g.sign*v*g.outbound.y):d.enableOuterBisectorSplit&&(g.splitOuter=!0,g.gapOuter=!1,g.leftOuter.x=g.rightOuter.x=g.bisector.x/g.cosine,g.leftOuter.y=g.rightOuter.y=
g.bisector.y/g.cosine)}function B(){if(m)g.distance=0,m=g.isCap=g.isFirstVertex=g.isLastVertex=!1;else{if(0===l)if(g.isFirstVertex=0===n,p=a[n],0===n){if(l=0,g.closed){g.inbound.x=p.x-a[a.length-2].x;g.inbound.y=p.y-a[a.length-2].y;var v=Math.sqrt(g.inbound.x*g.inbound.x+g.inbound.y*g.inbound.y);g.inbound.x/=v;g.inbound.y/=v}}else g.inbound.x=p.x-r.x,g.inbound.y=p.y-r.y,l=Math.sqrt(g.inbound.x*g.inbound.x+g.inbound.y*g.inbound.y),g.inbound.x/=l,g.inbound.y/=l;g.distance+l-h<=d.wrapDistance?(n<a.length-
1?(g.outbound.x=a[n+1].x-p.x,g.outbound.y=a[n+1].y-p.y,v=Math.sqrt(g.outbound.x*g.outbound.x+g.outbound.y*g.outbound.y),g.outbound.x/=v,g.outbound.y/=v):g.closed?(g.outbound.x=a[1].x-p.x,g.outbound.y=a[1].y-p.y,v=Math.sqrt(g.outbound.x*g.outbound.x+g.outbound.y*g.outbound.y),g.outbound.x/=v,g.outbound.y/=v):(g.outbound.x=g.inbound.x,g.outbound.y=g.inbound.y),0!==n||g.closed||(g.inbound.x=g.outbound.x,g.inbound.y=g.outbound.y),++n,g.isLastVertex=n===a.length,g.isCap=!g.closed&&(g.isFirstVertex||g.isLastVertex),
g.distance+=l-h,h=l=0,m=g.distance+l-h===d.wrapDistance,g.currentVertex.x=p.x,g.currentVertex.y=p.y,r=p,p=null):(g.outbound.x=g.inbound.x,g.outbound.y=g.inbound.y,h+=d.wrapDistance-g.distance,g.distance=d.wrapDistance,m=!0,v=h/l,g.currentVertex.x=(1-v)*r.x+v*p.x,g.currentVertex.y=(1-v)*r.y+v*p.y)}}function A(){g.prevNormal.x=-g.inbound.y;g.prevNormal.y=g.inbound.x;g.nextNormal.x=-g.outbound.y;g.nextNormal.y=g.outbound.x}function k(){A();g.bisector.x=g.prevNormal.x+g.nextNormal.x;g.bisector.y=g.prevNormal.y+
g.nextNormal.y;const v=Math.sqrt(g.bisector.x*g.bisector.x+g.bisector.y*g.bisector.y);.001>v?(g.bisector.x=void 0,g.bisector.y=void 0,g.cosine=0,g.sign=void 0):(g.bisector.x/=v,g.bisector.y/=v,g.cosine=g.bisector.x*g.nextNormal.x+g.bisector.y*g.nextNormal.y,g.sign=0<=g.prevNormal.x*g.nextNormal.y-g.prevNormal.y*g.nextNormal.x?1:-1)}function c(v){f.vertex(g);1===v?(g.leftEntry0=g.entry0,g.leftEntry1=g.entry1,g.leftEntry2=g.entry2,g.leftExit0=g.exit0,g.leftExit1=g.exit1,g.leftExit2=g.exit2):2===v&&
(g.rightEntry0=g.entry0,g.rightEntry1=g.entry1,g.rightEntry2=g.entry2,g.rightExit0=g.exit0,g.rightExit1=g.exit1,g.rightExit2=g.exit2)}function b(v){f.vertex(g);1===v?(g.leftEntry0=g.entry0,g.leftEntry2=g.entry2,g.leftExit0=g.exit0,g.leftExit2=g.exit2):2===v&&(g.rightEntry0=g.entry0,g.rightEntry2=g.entry2,g.rightExit0=g.exit0,g.rightExit2=g.exit2)}let e=function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};
this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}},a;const d={};let f,n=void 0,l,h,m,r,p;const g=new e;let q=function(){function v(t,w){this.writeVertex=t;this.writeTriangle=w;this.capType=0;this.joinType=2;this.miterLimitCosine=D.getLimitCosine(2);this.roundLimitCosine=
Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}var z=v.prototype;z.vertex=function(t){var w=2===this.joinType?this.miterLimitCosine:this.roundLimitCosine,x=t.isCap&&0!==this.capType,C=!1;t.cosine>this.almostParallelCosine?(t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance),t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/
t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):t.cosine<1-this.almostParallelCosine?(C=!t.isCap&&this.joinOnUTurn,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,
0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.canSplit?(E(),0<t.sign?(t.splitInner?(t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,t.leftInner.x,t.leftInner.y,0,-1,t.distance),t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.rightInner.x,t.rightInner.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,
t.distance),t.cosine<w?(C=!t.isCap,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.splitOuter?(C=C||t.gapOuter,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,-t.leftOuter.x,-t.leftOuter.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,
-t.rightOuter.x,-t.rightOuter.y,0,1,t.distance)):t.entry2=t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):(t.splitInner?(t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,-t.leftInner.x,-t.leftInner.y,0,1,t.distance),t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,-t.rightInner.x,-t.rightInner.y,0,1,t.distance)):t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,
t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance),t.cosine<w?(C=!t.isCap,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance)):t.splitOuter?(C=C||t.gapOuter,t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.leftOuter.x,t.leftOuter.y,0,-1,t.distance),t.exit0=
this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.outbound.x,t.outbound.y,t.rightOuter.x,t.rightOuter.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance))):0<t.sign?(t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,t.inbound.x,t.inbound.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance),t.cosine<w?(C=!t.isCap,t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,
0,0,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance),t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)):t.entry2=t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance)):(t.exit2=t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance),t.cosine<w?(C=!t.isCap,t.entry0=this.writeVertex(t.currentVertex.x,
t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance),t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance)):t.exit0=t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance));w=t.canSplit&&(t.splitInner||t.splitOuter)||C||x?t.entry1=t.exit1=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,0,0,0,0,t.distance):t.entry1=t.exit1=null;if(C&&1!==this.joinType)this.writeTriangle(w,
0<t.sign?t.exit2:t.entry0,0<t.sign?t.entry2:t.exit0);else if(x&&1===this.capType||C&&1===this.joinType){let I,L;if(t.isCap){C=Math.PI;x=Math.ceil(C/this.radsPerSlice);var F=C/x;if(t.isFirstVertex){var H=t.prevNormal.x;var J=t.prevNormal.y;I=t.entry0;L=t.entry2}else t.isLastVertex&&(H=-t.nextNormal.x,J=-t.nextNormal.y,I=t.exit2,L=t.exit0)}else H=2*Math.acos(t.cosine),x=Math.ceil(H/this.radsPerSlice),F=H/x,H=0<t.sign?-t.prevNormal.x:t.nextNormal.x,J=0<t.sign?-t.prevNormal.y:t.nextNormal.y,I=0<t.sign?
t.entry2:t.exit0,L=0<t.sign?t.exit2:t.entry0;C=Math.cos(F);F=Math.sin(F);var K=F*H+C*J;H=C*H-F*J;J=K;var N;for(K=0;K<x;++K){var R=N;K<x-1&&(N=t.isCap?this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,H,J,t.isFirstVertex?-1:1,0,t.distance):this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,H,J,0,t.sign,t.distance));this.writeTriangle(0===K?I:R,w,K===x-1?L:N);R=F*H+C*J;H=C*H-F*J;J=R}}else x&&2===this.capType&&(N=t.isFirstVertex?1:-1,this.textured?(H=this.writeVertex(t.currentVertex.x,t.currentVertex.y,
0,0,t.prevNormal.x-N*t.inbound.x,t.prevNormal.y-N*t.inbound.y,-N,-1,t.distance),J=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x-N*t.inbound.x,-t.prevNormal.y-N*t.inbound.y,-N,1,t.distance)):(H=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x-N*t.inbound.x,t.prevNormal.y-N*t.inbound.y,0,-1,t.distance),J=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x-N*t.inbound.x,-t.prevNormal.y-N*t.inbound.y,0,1,t.distance)),0<N?(this.writeTriangle(w,
t.entry2,J),this.writeTriangle(w,J,H),this.writeTriangle(w,H,t.entry0)):(this.writeTriangle(w,J,t.exit2),this.writeTriangle(w,H,J),this.writeTriangle(w,t.exit0,H)))};z.bridge=function(t){this.writeTriangle(t.leftExit0,t.rightEntry0,null!=t.leftExit1?t.leftExit1:t.leftExit2);this.writeTriangle(t.rightEntry0,null!=t.rightEntry1?t.rightEntry1:t.rightEntry2,null!=t.leftExit1?t.leftExit1:t.leftExit2);null!=t.leftExit1&&null!=t.rightEntry1?(this.writeTriangle(t.leftExit1,t.rightEntry1,t.leftExit2),this.writeTriangle(t.rightEntry1,
t.rightEntry2,t.leftExit2)):null!=t.leftExit1?this.writeTriangle(t.leftExit1,t.rightEntry2,t.leftExit2):null!=t.rightEntry1&&this.writeTriangle(t.rightEntry1,t.rightEntry2,t.leftExit2)};return v}(),u=function(){function v(t,w){this.writeVertex=t;this.writeTriangle=w}var z=v.prototype;z.vertex=function(t){t.entry0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance);t.entry2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.prevNormal.x,
-t.prevNormal.y,0,1,t.distance);t.exit0=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance);t.exit2=this.writeVertex(t.currentVertex.x,t.currentVertex.y,0,0,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance)};z.bridge=function(t){this.writeTriangle(t.leftExit0,t.rightEntry0,t.leftExit2);this.writeTriangle(t.rightEntry0,t.rightEntry2,t.leftExit2)};return v}();y.StandardTessellationCallbacks=q;y.TessellationState=e;y.ThinTessellationCallbacks=u;y.cleanup=
function(){f=a=null};y.splitVertex=E;y.tessellate=function(v,z,t){d.trackDistance=null!=z.trackDistance?z.trackDistance:!1;d.wrapDistance=null!=z.wrapDistance?z.wrapDistance:65535;d.thin=null!=z.thin?z.thin:!1;d.initialDistance=null!=z.initialDistance?z.initialDistance:0;d.enableOuterBisectorSplit=null!=z.enableOuterBisectorSplit?z.enableOuterBisectorSplit:!1;d.outerBisectorAutoSplitThreshold=null!=z.outerBisectorAutoSplitThreshold?z.outerBisectorAutoSplitThreshold:0;d.enableInnerBisectorSplit=null!=
z.enableOuterBisectorSplit?z.enableOuterBisectorSplit:!1;d.innerBisectorAutoSplitThreshold=null!=z.innerBisectorAutoSplitThreshold?z.innerBisectorAutoSplitThreshold:0;a=v;f=t;h=l=n=0;m=!1;p=r=null;g.currentVertex.x=null;g.currentVertex.y=null;g.distance=d.initialDistance;v=a[0];z=a[a.length-1];g.canSplit=!1;g.closed=v.x===z.x&&v.y===z.y;if(!(2>a.length||2===a.length&&g.closed))if(d.thin)if(d.trackDistance)for(B(),A(),b(1);l-h>d.wrapDistance||n<a.length;)B(),A(),b(2),f.bridge(g),g.leftExit0=g.rightExit0,
g.leftExit2=g.rightExit2;else for(;n<a.length;)0<n&&(g.inbound.x=g.outbound.x,g.inbound.y=g.outbound.y),n<a.length-1?(g.outbound.x=a[n+1].x-a[n].x,g.outbound.y=a[n+1].y-a[n].y,v=Math.sqrt(g.outbound.x*g.outbound.x+g.outbound.y*g.outbound.y),g.distance+=v,g.outbound.x/=v,g.outbound.y/=v):(g.outbound.x=g.inbound.x,g.outbound.y=g.inbound.y),0===n&&(g.inbound.x=g.outbound.x,g.inbound.y=g.outbound.y),g.currentVertex.x=a[n].x,g.currentVertex.y=a[n].y,g.prevNormal.x=-g.inbound.y,g.prevNormal.y=g.inbound.x,
g.nextNormal.x=-g.outbound.y,g.nextNormal.y=g.outbound.x,0===n?(f.vertex(g),g.leftEntry0=g.entry0,g.leftEntry2=g.entry2,g.leftExit0=g.exit0,g.leftExit2=g.exit2):(f.vertex(g),g.rightEntry0=g.entry0,g.rightEntry2=g.entry2,g.rightExit0=g.exit0,g.rightExit2=g.exit2,f.bridge(g),g.leftExit0=g.rightExit0,g.leftExit2=g.rightExit2),++n;else{if(d.enableOuterBisectorSplit||0<d.outerBisectorAutoSplitThreshold||d.enableInnerBisectorSplit||0<d.innerBisectorAutoSplitThreshold)for(g.canSplit=!0,B(),k(),g.splitInner=
g.gapInner=g.splitOuter=g.gapOuter=!1,c(1),g.closure0=g.leftEntry0,g.closure1=g.leftEntry1,g.closure2=g.leftEntry2;l-h>d.wrapDistance||n<a.length-1||n<a.length&&(!g.closed||d.trackDistance);)B(),k(),g.splitInner=g.gapInner=g.splitOuter=g.gapOuter=!1,c(2),f.bridge(g),g.leftExit0=g.rightExit0,g.leftExit1=g.rightExit1,g.leftExit2=g.rightExit2;else for(B(),k(),c(1),g.closure0=g.leftEntry0,g.closure1=g.leftEntry1,g.closure2=g.leftEntry2;l-h>d.wrapDistance||n<a.length-1||n<a.length&&(!g.closed||d.trackDistance);)B(),
k(),c(2),f.bridge(g),g.leftExit0=g.rightExit0,g.leftExit1=g.rightExit1,g.leftExit2=g.rightExit2;g.closed&&!d.trackDistance&&(g.rightEntry0=g.closure0,g.rightEntry1=g.closure1,g.rightEntry2=g.closure2,f.bridge(g),g.leftExit0=g.rightExit0,g.leftExit1=g.rightExit1,g.leftExit2=g.rightExit2)}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/screenUtils ../../definitions ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../materialKey/MaterialKey ../../color ../../util/Result ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h){const m=b.create(),r=c.create(),p=E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(g){function q(u){var v=g.call(this,u)||this;v._cimMarkerLayer=u;n.isFunction(u.color)?v._dynamicPropertyMap.set("_fillColor",(z,t,w)=>d.premultiplyAlphaRGBA(u.color(z,t,w))):v._fillColor=d.premultiplyAlphaRGBA(u.color);n.isFunction(u.outlineColor)?v._dynamicPropertyMap.set("_outlineColor",(z,t,w)=>d.premultiplyAlphaRGBA(u.outlineColor(z,t,w))):
v._outlineColor=d.premultiplyAlphaRGBA(u.outlineColor);n.isFunction(u.size)?v._dynamicPropertyMap.set("_size",(z,t,w)=>A.pt2px(u.size(z,t,w))):v._size=A.pt2px(u.size);n.isFunction(u.scaleX)?v._dynamicPropertyMap.set("_scaleX",u.scaleX):v._scaleX=u.scaleX;n.isFunction(u.offsetX)?v._dynamicPropertyMap.set("xOffset",(z,t,w)=>A.pt2px(u.offsetX(z,t,w))):v.xOffset=A.pt2px(u.offsetX);n.isFunction(u.offsetY)?v._dynamicPropertyMap.set("yOffset",(z,t,w)=>A.pt2px(u.offsetY(z,t,w))):v.yOffset=A.pt2px(u.offsetY);
n.isFunction(u.outlineWidth)?v._dynamicPropertyMap.set("_outlineWidth",(z,t,w)=>A.pt2px(u.outlineWidth(z,t,w))):v._outlineWidth=A.pt2px(u.outlineWidth);n.isFunction(u.rotation)?v._dynamicPropertyMap.set("_angle",u.rotation):v._angle=u.rotation;v._scaleFactor=D.unwrapOr(u.scaleFactor,1);v._markerPlacement=u.markerPlacement;v._effects=u.effects;v._bitSet=(1===u.alignment?1:0)|(u.colorLocked?1:0)<<1|(u.scaleSymbolsProportionally?1:0)<<3;v._materialKey=u.materialKey;return v}y._inheritsLoose(q,g);q.fromCIMMarker=
function(u){return new q(u)};q.prototype.bindFeature=function(u,v,z){const t=u.readLegacyFeature();this._dynamicPropertyMap.forEach((M,P)=>{this[P]=M(t,v,z)});u=this._cimMarkerLayer.materialHash;u="function"===typeof u?u(t,v,z):u;if((u=this._materialCache.get(u))&&f.ok(u.spriteMosaicItem)&&u.spriteMosaicItem){u=u.spriteMosaicItem;var w=this._cimMarkerLayer.sizeRatio,x=u.width/u.height*this._scaleX,C=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,F=this._size,H=F*x,J=this.xOffset,K=
this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/A.pt2px(this._cimMarkerLayer.frameHeight):1,R=this._outlineWidth*N,I=A.pt2px(this._cimMarkerLayer.referenceSize),L=N=0,G=this._cimMarkerLayer.anchorPoint;G&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(N=-G.x/(this._size*x),L=G.y/this._size):(N=G.x,L=G.y));this._sizeOutlineWidth=e.i8888to32(Math.round(Math.min(Math.sqrt(128*
H),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*R),255)),Math.round(Math.min(Math.sqrt(128*I),255)));this.angle=C;this._bitestAndDistRatio=e.i1616to32(this._bitSet,Math.round(64*w));x=u.rect.x+k.SPRITE_PADDING;C=u.rect.y+k.SPRITE_PADDING;R=x+u.width;I=C+u.height;this._texUpperLeft=e.i1616to32(x,C);this._texUpperRight=e.i1616to32(R,C);this._texBottomLeft=e.i1616to32(x,I);this._texBottomRight=e.i1616to32(R,I);x=a.MarkerMaterialKey.load(this._materialKey);x.sdf=
u.sdf;x.pattern=!0;x.textureBinding=u.textureBinding;this._materialKey=x.data;this._anchorX=.5-(.5+N)*u.width/u.width;this._anchorY=.5-(.5+L)*u.height/u.height;H=H*w*this._scaleFactor;F=F*w*this._scaleFactor;H*=u.rect.width/u.width;F*=u.rect.height/u.height;this._computedWidth=H;this._computedHeight=F;this._applyTransformation(r,m);this.xOffset=J;this.yOffset=K}else p.error(new B("mapview-cim","Encountered an error when binding feature"))};return q}(l(h))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],
function(y){y.codepoints=function(D){const E=Array(D.length);for(let B=0;B<D.length;B++)E[B]=D.charCodeAt(B);return E};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../materialKey/MaterialKey ../../color ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(y,D,E,B,A,k,c,b,e){return function(a){function d(n){var l=a.call(this,n)||this;l._horizontalAlignment="center";l._verticalAlignment="middle";l._textToGlyphs=new Map;var h=n.scaleFactor||1;l._cimTextLayer=n;k.isFunction(n.color)?l._dynamicPropertyMap.set("_color",(g,q,u)=>A.premultiplyAlphaRGBA(n.color(g,q,u))):l._color=A.premultiplyAlphaRGBA(n.color);k.isFunction(n.color)?l._dynamicPropertyMap.set("_haloColor",(g,q,u)=>A.premultiplyAlphaRGBA(n.outlineColor(g,q,u))):l._haloColor=A.premultiplyAlphaRGBA(n.outlineColor);
let m;k.isFunction(n.size)||(m=Math.min(Math.round(D.pt2px(n.size*n.sizeRatio)),127));l._dynamicPropertyMap.set("_size",(g,q,u)=>k.isFunction(n.size)?Math.min(Math.round(D.pt2px(n.size(g,q,u)*n.sizeRatio)),127):m);k.isFunction(n.outlineSize)?l._dynamicPropertyMap.set("_haloSize",(g,q,u)=>Math.min(Math.floor(5*D.pt2px(n.outlineSize(g,q,u)*n.sizeRatio)),127)):l._haloSize=Math.min(Math.floor(5*D.pt2px(n.outlineSize*n.sizeRatio)),127);let r;k.isFunction(n.offsetX)||(r=Math.round(D.pt2px(n.offsetX*n.sizeRatio)));
l._dynamicPropertyMap.set("_xOffset",(g,q,u)=>k.isFunction(n.offsetX)?Math.round(D.pt2px(n.offsetX(g,q,u)*n.sizeRatio)):r);let p;k.isFunction(n.offsetY)||(p=Math.round(D.pt2px(n.offsetY*n.sizeRatio)));l._dynamicPropertyMap.set("_yOffset",(g,q,u)=>k.isFunction(n.offsetY)?Math.round(D.pt2px(n.offsetY(g,q,u)*n.sizeRatio)):p);k.isFunction(n.angle)?l._dynamicPropertyMap.set("_angle",n.angle):l._angle=n.angle;k.isFunction(n.horizontalAlignment)?l._dynamicPropertyMap.set("_horizontalAlignment",n.horizontalAlignment):
l._horizontalAlignment=n.horizontalAlignment;k.isFunction(n.verticalAlignment)?l._dynamicPropertyMap.set("_verticalAlignment",n.verticalAlignment):l._verticalAlignment=n.verticalAlignment;l._scaleFactor=h;k.isFunction(n.text)?l._dynamicPropertyMap.set("_text",n.text):l._text=n.text;h=Math.min(Math.round(D.pt2px(n.referenceSize*n.sizeRatio)),127);l._referenceSize=Math.round(Math.sqrt(256*h));l._materialKey=n.materialKey;h=B.TextMaterialKey.load(l._materialKey);h.sdf=!0;l._bitset=(1===n.alignment?1:
0)|(n.colorLocked?1:0)<<1;l._materialKey=h.data;l._decoration="none";l._lineHeight=1;l._lineWidth=512;l._textPlacement=n.markerPlacement;l._effects=n.effects;l._isCIM=!0;return l}y._inheritsLoose(d,a);d.fromCIMText=function(n){return new d(n)};var f=d.prototype;f.analyze=async function(n,l,h,m){l=l.readLegacyFeature();var r=this._cimTextLayer;h="string"===typeof r.text?r.text:"function"===typeof r.text?r.text(l,h,m):"";n=await n.getMosaicItem(this._cimTextLayer.cim,e.codepoints(h));this._textToGlyphs.set(h,
n.glyphMosaicItems);return n};f.bindFeature=function(n,l,h){const m=n.readLegacyFeature();this._dynamicPropertyMap.forEach((r,p)=>{this[p]=r(m,l,h)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=E.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=E.getYAnchorDirection(this._verticalAlignment||"baseline"),n=this._textToGlyphs.get(this._text),this.bindTextInfo(n,
!1)):this._shapingInfo=null};return d}(c(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../GeometryUtils ./WGLMeshTemplate ./WGLBaseFillTemplate".split(" "),function(y,D,E,B,A,k,c,b,e,a){return function(d){function f(n,l,h,m,r,p,g,q,u){var v=d.call(this)||this;v._effects=
u;n=k.FillMaterialKey.load(n);l&&(n.sdf=l.sdf,n.pattern=!0,n.textureBinding=l.textureBinding);v.fillColor=h;v.tl=m;v.br=r;v.aux1=p;v.aux2=g;v.aux3=q;v._materialKey=n.data;return v}y._inheritsLoose(f,d);f.fromCIMFill=function(n,l){var h=n.color;h=h&&c.premultiplyAlphaRGBA(h)||0;const m=n.materialKey;if(!l)return l=A.i8888to32(0,0,0,n.colorLocked?1:0),new f(m,null,h,0,0,0,0,l,n.effects);const {rect:r,width:p,height:g}=l;var q=r.x+B.SPRITE_PADDING;const u=r.y+B.SPRITE_PADDING;var v=q+p;const z=u+g;var t=
D.nextHighestPowerOfTwo(g);255<t?t=255:0>=t&&(t=D.nextHighestPowerOfTwo(z-u));var w=D.nextHighestPowerOfTwo(p||0);255<w?w=255:0>=w&&(w=D.nextHighestPowerOfTwo(v-q));let x=E.pt2px(n.offsetX||0)+128;255<x&&(x=255);let C=E.pt2px(-n.offsetY||0)+128;255<C&&(C=255);var F=n.scaleX||1;q=A.i1616to32(q,u);v=A.i1616to32(v,z);t=A.i8888to32(w,t,x,C);F=A.i1616to32(128*F,128);w=A.i8888to32(0,0,b.degToByte(n.angle),n.colorLocked?1:0);return new f(m,l,h,q,v,t,F,w,n.effects)};f.fromSimpleFill=function(n,l,h=!1){var {color:m}=
n;m=m&&"esriSFSNull"!==n.style&&c.premultiplyAlphaRGBAArray(m)||0;h=A.i8888to32(0,0,0,h?255:0);n=n.materialKey;if(!l)return new f(n,null,m,0,0,0,0,h,null);const {rect:r,width:p,height:g}=l;var q=r.x+B.SPRITE_PADDING,u=r.y+B.SPRITE_PADDING;const v=q+p,z=u+g,t=A.i1616to32(q,u),w=A.i1616to32(v,z);q=A.i8888to32(D.nextHighestPowerOfTwo(v-q),D.nextHighestPowerOfTwo(z-u),0,0);u=A.i1616to32(128,128);return new f(n,l,m,t,w,q,u,h,null)};f.fromPictureFill=function(n,l,h=!1){const m=B.PICTURE_FILL_COLOR,{rect:r,
width:p,height:g}=l;var q=r.x+B.SPRITE_PADDING,u=r.y+B.SPRITE_PADDING,v=q+p,z=u+g;q=A.i1616to32(q,u);v=A.i1616to32(v,z);z=D.nextHighestPowerOfTwo(E.pt2px(n.width));255<z&&(z=255);u=D.nextHighestPowerOfTwo(E.pt2px(n.height));255<u&&(u=255);let t=E.pt2px(n.xoffset)+128;255<t&&(t=255);let w=E.pt2px(-n.yoffset)+128;255<w&&(w=255);z=A.i8888to32(z,u,t,w);u=A.i1616to32(128*n.xscale,128*n.yscale);h=A.i8888to32(0,0,0,h?255:0);return new f(n.materialKey,l,m,q,v,z,u,h,null)};return f}(a(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../Utils ./util ./WGLMeshTemplate ./WGLBaseLineTemplate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){const f=D.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(n){function l(h,m,r,p,g,q,u,v,z,t,w,x,C,F,H,J){var K=n.call(this)||this;h=k.LineMaterialKey.load(h);m&&(h.sdf=m.sdf,h.pattern=!0,h.textureBinding=m.textureBinding);K._capType=p;K._joinType=g;K._miterLimitCosine=e.getLimitCosine(q);K.tessellationProperties._fillColor=u;K.tessellationProperties._tl=v;K.tessellationProperties._br=z;K._hasPattern=t;K._isDashed=w;K._joinOnUTurn=H;K._isColorLocked=
x;K._zOrder=F;K._effects=J;K._materialKey=h.data;K.tessellationProperties._bitset=x?1:0;K.tessellationProperties._halfWidth=.5*r;K.tessellationProperties._halfReferenceWidth=.5*C;K._initializeTessellator(!1);return K}y._inheritsLoose(l,n);l.fromCIMLine=function(h,m,r){var p=h.color,g=h.scaleFactor||1;const q=h.isDashed;let u=h.cap;q&&1===u&&(u=2);const v=h.join;g*=E.pt2px(h.width);const z=E.pt2px(h.referenceWidth),t=E.pt2px(h.miterLimit);p=p&&c.premultiplyAlphaRGBA(p)||0;if(!m)return new l(h.materialKey,
m,g,u,v,t,p,0,0,!1,q,h.colorLocked,z,h.zOrder,r,h.effects);const {rect:w,width:x,height:C}=m;var F=w.x+B.SPRITE_PADDING;const H=w.y+B.SPRITE_PADDING;var J=F+x;const K=H+C;F=A.i1616to32(F,H);J=A.i1616to32(J,K);return new l(h.materialKey,m,g,u,v,t,p,F,J,!0,q,h.colorLocked,z,h.zOrder,r,h.effects)};l.fromSimpleLine=function(h,m,r){var {color:p}=h;const g="esriSLSSolid"!==h.style&&"esriSLSNull"!==h.style,q=b.getCapType(h.cap||"round",g),u=b.getJoinType(h.join||"round");p=p&&"esriSLSNull"!==h.style&&c.premultiplyAlphaRGBAArray(p)||
0;"esriSLSNull"===h.style&&(p=0);const v=E.pt2px(h.width),z=h.miterLimit;if(!m)return new l(h.materialKey,m,v,q,u,z,p,0,0,!1,g,!1,v,0,r,null);const {rect:t,width:w,height:x}=m;var C=t.x+B.SPRITE_PADDING;const F=t.y+B.SPRITE_PADDING;var H=C+w;const J=F+x;C=A.i1616to32(C,F);H=A.i1616to32(H,J);return new l(h.materialKey,m,v,q,u,z,p,C,H,!0,g,!1,v,0,r,null)};l.fromPictureLineSymbol=function(h,m,r,p){f.error("PictureLineSymbol support does not exist!");return null};return l}(d(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports",
"../../../../../core/promiseUtils"],function(y,D){let E=function(){function B(){this._resolver=null}var A=B.prototype;A.isHeld=function(){return!!this._resolver};A.acquire=async function(){if(!this._resolver)return this._resolver=D.createResolver(),Promise.resolve();await this._resolver.promise;await this.acquire()};A.release=function(){const k=this._resolver;this._resolver=null;k.resolve()};return B}();y.default=E;y.withLock=async function(B,A,k){try{await B.acquire(),await A(k),B.release()}catch(c){throw B.release(),
c;}};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../layers/features/support/AttributeStore ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),function(y,D,E,B,A,k,c,b,e){E=function(){function a(f,n,l){this._geometryType=
f;this._idField=n;this._templateStore=l}var d=a.prototype;d.update=function(f,n){B.isSome(f.mesh.labels)&&this._setLabelTemplates(f.mesh.labels,n)};d._setLabelTemplates=function(f,n){this._labelTemplates=f.map(l=>c.fromLabelClass(l,n))};d.analyze=async function(f,n,l,h,m,r){if(!A.isAborted(r)){var p;"dictionary"===n.type&&(p=await n.analyze(this._idField,f.copy(),h,m,r));for(var g=0;f.next();){var q=void 0;q=p?p[g++]:B.isSome(l)&&k.isAggregateId(f.getDisplayId())&&1!==f.readAttribute("cluster_count")?
l.match(this._idField,f,this._geometryType,h,m):n.match(this._idField,f,this._geometryType,h,m);f.setGroupId(q);if(e.isDynamicId(q)){q=this._templateStore.getDynamicTemplateGroup(q);for(const u of q)u&&u.analyze&&u.analyze(this._templateStore,f,h,m)}}return this._templateStore.finalize(r)}};d.analyzeGraphics=async function(f,n,l,h,m){if(!A.isAborted(m)){f=f.getCursor();for(n&&await n.analyze(this._idField,f.copy(),l,h,m);f.next();){let r=f.getGroupId();if(null==r||-1===r)r=n.match(this._idField,f,
f.geometryType,l,h),f.setGroupId(r);if(e.isDynamicId(r)){const p=this._templateStore.getDynamicTemplateGroup(r);for(const g of p)g&&g.analyze&&g.analyze(this._templateStore,f,l,h)}f.setGroupId(r)}return this._templateStore.finalize(m)}};d.writeGraphic=function(f,n){const l=n.getGroupId(),h=n.getDisplayId(),m=this._templateStore.getTemplateGroup(l);f.featureStart(n.insertAfter);if(null!=h){if(e.isDynamicId(l))for(const r of m)r.bindFeature(n,null,null);if(m){for(const r of m)r&&r.write(f,n);f.featureEnd()}}};
d.writeCursor=function(f,n,l,h,m,r){const p=n.getGroupId(),g=n.getDisplayId(),q=this._templateStore.getTemplateGroup(p);n.getObjectId();if(null!=g&&q){if(e.isDynamicId(p))for(const u of q)u.bindFeature(n,l,h);for(const u of q)u.write(f,n);B.isSome(r)&&f.hasRecords&&(l=r&&this._findLabelRef(q),this._writeLabels(f,n,r,l,m))}};d._findLabelRef=function(f){for(const n of f)if(n instanceof b)return n;return null};d._writeLabels=function(f,n,l,h,m){for(const r of l)if(B.isSome(r)&&r){const {glyphs:p,rtl:g,
index:q}=r;l=this._labelTemplates[q];l.setZoomLevel(m);l.bindReferenceTemplate(h);l.bindTextInfo(p,g);l.write(f,n)}};D._createClass(a,[{key:"templates",get:function(){return this._templateStore}}]);return a}();y.WGLMeshFactory=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../alignmentUtils ../../number ../../enums ./meshUtils ../../materialKey/MaterialKey ../../color ./segmentUtils ./WGLTextTemplate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h){const m=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),r=(g,q="mapview-labeling")=>m.error(new B(q,g)),p=function(g){const q=new Map;return u=>{q.has(u)||q.set(u,g(u));return q.get(u)}}(g=>{let q=0;if(0===g)return Infinity;for(;!(g%2);)q++,g/=2;return q});return function(g){function q(v,z,t,w){var x=g.call(this,v,t.font.size,t.haloSize||0,t.color&&n.premultiplyAlphaRGBAArray(t.color)||0,t.haloColor&&n.premultiplyAlphaRGBAArray(t.haloColor)||0,t.horizontalAlignment,
t.verticalAlignment,d.isMapAligned(z.labelPlacement)?1:0,t.font.decoration,!1,t.angle||0,t.xoffset,t.yoffset,t.lineWidth,t.lineHeight,null,null)||this;x._outLineLabelAngle=0;x._refPlacementPadding=0;x._refPlacementDirX=0;x._refPlacementDirY=0;x._refOffsetX=0;x._refOffsetY=0;x._zoomLevel=0;x.geometryType=a.WGLGeometryType.LABEL;var C=!!z.minScale&&w.scaleToZoom(z.minScale)||0;C=A.clamp(C,0,25.5);w=!!z.maxScale&&w.scaleToZoom(z.maxScale)||255;w=A.clamp(w,0,25.5);const [F,H]=b.getAlignmentFromPlacement(z.labelPlacement);
x._xAlignD=F;x._yAlignD=H;x._minZoom=C;x._maxZoom=w;x._refPlacementPadding=k.pt2px(t.haloSize)+c.TEXT_PLACEMENT_PADDING;v=f.LabelMaterialKey.load(v);v.sdf=!0;x._materialKey=v.data;return x}y._inheritsLoose(q,g);q.fromLabelClass=function(v,z){if("center-along"===v.labelPlacement){const t=v.symbol;t.xoffset=0;t.yoffset=0;t.angle=0;t.font.decoration="none"}return new q(v.materialKey,v,v.symbol,z)};var u=q.prototype;u.setZoomLevel=function(v){this._zoomLevel=v};u.bindReferenceTemplate=function(v){let z=
b.getXDirection(this._xAlignD),t=b.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(D.isNone(v))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*z+127),Math.floor(127*t+127));else{if("circle"===v.boundsType&&(z||t)){var w=Math.sqrt(z*z+t*t);z/=w;t/=w}w=Math.max(v.height,v.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,w,Math.floor(127*z+127),Math.floor(127*t+127));this._referenceSize=w;this._refPlacementDirX=z;this._refPlacementDirY=
t;this._refOffsetX=v.xOffset;this._refOffsetY=v.yOffset}};u._write=function(v,z){if(!D.isNone(this._shapingInfo)){var t=this._shapingInfo,w=z.getDisplayId(),x="esriGeometryPolygon"===z.geometryType?z.readLegacyCentroid():z.readLegacyGeometry();if(x)switch(this.current={out:v,inId:w,inShaping:t,zoomLevel:this._zoomLevel},z.geometryType){case "esriGeometryPolyline":this._placeLineLabels(x);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(x);break;default:r("mapview-labeling",
`Geometry of type ${z.geometryType} is not supported`)}}};u._isVisible=function(v,z){const t=Math.floor(10*this.current.zoomLevel);return Math.floor(10*v)<=t&&t<=Math.floor(10*z)};u._placePointLabels=function(v){const {out:z,inId:t,inShaping:w}=this.current;this._writeGlyphs(z,t,v,w)};u._placeLineLabels=function(v){v=l.smoothPaths(v.paths,this.current.inShaping.bounds.width);const z=this._placeSubdivGlyphs.bind(this),t=(this._shapedBox.width+128)/2;for(const w of v)l.pathDivide(w,t,z)};u._placeSubdivGlyphs=
function(v,z,t,w){var x=p(z);t=A.log2(Math.min(t,w-t)/(8+this._shapedBox.width/2/2));x=Math.max(this._minZoom,this.current.zoomLevel+1-(0===z?t:Math.min(x,t)));t=this._shapedBox.width/2*2**(this.current.zoomLevel-x);this.current.inShaping.isMultiline?0===z&&this._placeStraight(v,x):this._placeCurved(v,x,t)};u._placeStraight=function(v,z){const {out:t,inId:w,inShaping:x}=this.current;this._writeGlyphs(t,w,v,x,z)};u._placeCurved=function(v,z,t){const {out:w,inId:x}=this.current;w.metricStart(x,z,v.x,
v.y,0,0,0,0);const C=v.clone(),F=(180/Math.PI*v.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*v.angle%360*(254/360));this._placeFirst(C,z,1);this._placeBack(v,C,z,t,1);this._placeForward(v,C,z,t,1);this._outLineLabelAngle=Math.round(254/360*F);this._placeFirst(C,z,0);this._placeBack(v,C,z,t,0);this._placeForward(v,C,z,t,0);w.metricEnd()};u._placeBack=function(v,z,t,w,x){const C=v.clone();for(v=v.backwardLength+0;C.prev()&&!(v>=w);)this._placeOnSegment(C,z,v,t,-1,x),v+=C.length+0};
u._placeForward=function(v,z,t,w,x){const C=v.clone();for(v=v.remainingLength+0;C.next()&&!(v>=w);)this._placeOnSegment(C,z,v,t,1,x),v+=C.length+0};u._placeFirst=function(v,z,t){const w=this.current.inShaping;var x=w.glyphs;const C=this.current.zoomLevel,{out:F,inId:H}=this.current;for(const J of x)x=J.x>w.bounds.x?t:1-t,x=Math.max(0,C+A.log2(Math.abs(J.x+J.width/2-w.bounds.x)/(x*v.remainingLength+(1-x)*v.backwardLength))),x=Math.max(z,x),J.maxZoom=25,J.angle=v.angle+(1-t)*Math.PI,J.minZoom=x,0>v.x||
512<=v.x||0>v.y||512<=v.y||(this._writeGlyph(F,H,v.x,v.y,J),t&&this._isVisible(J.minZoom,J.maxZoom)&&(x=J.bounds,F.metricBoxWrite(x.center[0],x.center[1],x.width,x.height)))};u._placeOnSegment=function(v,z,t,w,x,C){var F=this.current.inShaping.glyphs;const {out:H,inId:J}=this.current,K=this.current.inShaping,N=this.current.zoomLevel;var R=v.x+v.dx/v.length*-x*t,I=v.y+v.dy/v.length*-x*t;for(const G of F)if((F=G.x>K.bounds.x?C:1-C)&&1===x||!F&&-1===x){var L=Math.abs(G.x+G.width/2-K.bounds.x);F=Math.max(0,
N+A.log2(L/t)-.1);L=Math.max(w,N+A.log2(L/(t+v.length+0)));0!==F&&(G.angle=v.angle+(1-C)*Math.PI,G.minZoom=L,G.maxZoom=F,0>R||512<=R||0>I||512<=I||(this._writeGlyph(H,J,R,I,G),C&&this._isVisible(G.minZoom,G.maxZoom)&&(F=G.bounds,H.metricBoxWrite(F.center[0]+(v.x-z.x),F.center[1]+(v.y-z.y),F.width,F.height))))}};u._writeGlyphs=function(v,z,t,w,x=this._minZoom){if(!(0>t.x||512<=t.x||0>t.y||512<=t.y)){var C=t.x+this._refOffsetX;t=t.y-this._refOffsetY;for(var F of w.glyphs)F.minZoom=x,F.maxZoom=this._maxZoom,
this._writeGlyph(v,z,C,t,F);F=f.LabelMaterialKey.load(this._materialKey);w=w.boundsT;v.metricStart(z,x,C,t,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,F.vvSizeFieldStops||F.vvSizeMinMaxValue||F.vvSizeScaleStops||F.vvSizeUnitValue?1:0);v.metricBoxWrite(w.center[0],w.center[1],w.width,w.height);v.metricEnd()}};u._writeVertexCommon=function(v,z,t,w){const x=this._color,C=this._haloColor,F=e.i8888to32(0,0,this._size,this._haloSize);w=e.i8888to32(Math.floor(10*Math.max(w.minZoom,
this._minZoom)),Math.floor(10*Math.min(w.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);v.vertexWrite(t);v.vertexWrite(z);v.vertexWrite(x);v.vertexWrite(C);v.vertexWrite(F);v.vertexWrite(this._refSymbolAndPlacementOffset);v.vertexWrite(w)};y._createClass(q,[{key:"_shapedBox",get:function(){return D.unwrap(this._shapingInfo).bounds}}]);return q}(h)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe",
"./util"],function(y,D,E,B){function A(a){return a.length-1}function k(a){let d=0;for(let f=0;f<A(a);f++)d+=c(a,f);return d}function c(a,d,f=1){const [n,l]=a[d+1];return Math.sqrt(n*n+l*l)*f}function b(a,d,f,n,l){if(!(f<d)){var h=n.clone().seek(f/2);E.isNone(h)||(a(h.clone(),f,l),f=(f-d)/2,h=E.unwrap(h.seek(d/2)),b(a,d,f,n,l+1),b(a,d,f,h,l+1))}}let e=function(){function a(f,n,l,h,m){this._segments=f;this._index=n;this._distance=l;this._xStart=h;this._yStart=m;this._done=!1}a.create=function(f){return new a(f,
0,0,f[0][0],f[0][1])};var d=a.prototype;d.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};d.equals=function(f){return this._index===f._index||f._index===this._index-1&&(0===this._distance||1===f._distance)||f._index===this._index+1&&(1===this._distance||0===f._distance)};d.leq=function(f){return this._index<f._index||this._index===f._index&&this._distance<=f._distance};d.geq=function(f){return this._index>f._index||this._index===f._index&&this._distance>=
f._distance};d.hasPrev=function(){return 0<=this._index-1};d.hasNext=function(){return this._index+1<A(this._segments)};d.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};d.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};d._seekBackwards=function(f,n){var l=this.backwardLength;if(f<=l)return this._distance=(l-f)/
this.length,this;for(l=this.backwardLength;this.prev();){if(l+this.length>f)return this._seekBackwards(f-l);l+=this.length}this._distance=0;return n?this:null};d.seek=function(f,n=!1){if(0>f)return this._seekBackwards(Math.abs(f),n);if(f<=this.remainingLength)return this._distance=(this.backwardLength+f)/this.length,this;let l=this.remainingLength;for(;this.next();){if(l+this.length>f)return this.seek(f-l,n);l+=this.length}this._distance=1;return n?this:null};D._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+
1]}},{key:"angle",get:function(){const f=this.dy;let n=Math.acos((0*f+-1*-this.dx)/(1*this.length));0<f&&(n=2*Math.PI-n);return n}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:f,dy:n}=this;return Math.sqrt(f*f+n*n)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return a}();y.SegmentCursor=e;y.pathDivide=function(a,d,f){const n=k(a);a=e.create(a);const l=n/2,h=Math.floor((n-d)/2/d);a.seek(l-h*d);for(let m=-h;m<=h;m++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&f(a.clone(),m,l+m*d,n),a.seek(d)};y.pathLength=k;y.pathSubdivide=function(a,d,f){b(f,d,k(a),e.create(a),0)};y.segmentAt=function(a,d){return a[d+1]};y.segmentCount=A;y.segmentLength=c;y.smoothPaths=function(a,d){for(let C=0;C<a.length;C++){var f=a[C];const F=[];F.push(f[0]);for(var n=1;n<f.length;n++){let [H,
J]=F[n-1];H+=f[n][0];J+=f[n][1];F.push([H,J])}a:{f=F;n=d;if(0>=n)break a;const H=f.length;if(3>H)break a;const J=[];var l=0;J.push(0);for(var h=1;h<H;h++)l+=B.dist(f[h],f[h-1]),J.push(l);n=Math.min(n,.2*l);l=[];l.push(f[0][0]);l.push(f[0][1]);h=f[H-1][0];const K=f[H-1][1];var m=B.sub([0,0],f[0],f[1]);B.normalize(m);f[0][0]+=n*m[0];f[0][1]+=n*m[1];B.sub(m,f[H-1],f[H-2]);B.normalize(m);f[H-1][0]+=n*m[0];f[H-1][1]+=n*m[1];for(m=1;m<H;m++)J[m]+=n;J[H-1]+=n;m=.5*n;for(let N=1;N<H-1;N++){let R=0,I=0,L=
0;for(var r=N-1;0<=r&&!(J[r+1]<J[N]-m);r--){var p=m+J[r+1]-J[N],g=J[r+1]-J[r],q=J[N]-J[r]<m?1:p/g;if(1E-6>Math.abs(q))break;var u=q*q,v=q*p-.5*u*g,z=q*g/n,t=f[r+1],w=f[r][0]-t[0],x=f[r][1]-t[1];R+=z/v*(t[0]*q*p+.5*u*(p*w-g*t[0])-u*q*g*w/3);I+=z/v*(t[1]*q*p+.5*u*(p*x-g*t[1])-u*q*g*x/3);L+=z}for(r=N+1;r<H&&!(J[r-1]>J[N]+m);r++){p=m-J[r-1]+J[N];g=J[r]-J[r-1];q=J[r]-J[N]<m?1:p/g;if(1E-6>Math.abs(q))break;u=q*q;v=q*p-.5*u*g;z=q*g/n;t=f[r-1];w=f[r][0]-t[0];x=f[r][1]-t[1];R+=z/v*(t[0]*q*p+.5*u*(p*w-g*t[0])-
u*q*g*w/3);I+=z/v*(t[1]*q*p+.5*u*(p*x-g*t[1])-u*q*g*x/3);L+=z}l.push(R/L);l.push(I/L)}l.push(h);l.push(K);for(let N=0,R=0;N<H;N++)f[N][0]=l[R++],f[N][1]=l[R++]}f=[];f.push(F[0]);for(n=1;n<F.length;n++){const [H,J]=F[n-1],[K,N]=F[n];f.push([Math.round(K-H),Math.round(N-J)])}a[C]=f}return a};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","./StaticBitSet","./displayIdUtils"],function(y,D,E){function B(k,
c,b){if(!(k.length>c))for(;k.length<=c;)k.push(b)}let A=function(){function k(){this._numerics=[];this._strings=[];this._idGenerator=new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var c=k.prototype;c.createBitset=function(){const b=this._bitsets.length;this._bitsets.push(D.StaticBitSet.create(this._allocatedSize,2147483647));return b+1};c.getBitset=function(b){return this._bitsets[b-1]};c._expand=function(){this._allocatedSize<<=1;for(const b of this._bitsets)b.resize(this._allocatedSize)};
c._ensureNumeric=function(b,e){this._numerics[b]||(this._numerics[b]=[]);B(this._numerics[b],e,0)};c._ensureInstanceId=function(b){B(this._instanceIds,b,0)};c._ensureString=function(b,e){this._strings[b]||(this._strings[b]=[]);B(this._strings[b],e,null)};c.createDisplayId=function(b=!1){const e=this._idGenerator.createId();e>this._allocatedSize&&this._expand();return((b?2147483648:0)|e)>>>0};c.releaseDisplayId=function(b){for(const e of this._bitsets)e.unset(b);return this._idGenerator.releaseId(b&
2147483647)};c.getComputedNumeric=function(b,e){return this.getComputedNumericAtIndex(b&2147483647,0)};c.setComputedNumeric=function(b,e,a){return this.setComputedNumericAtIndex(b&2147483647,a,0)};c.getComputedString=function(b,e){return this.getComputedStringAtIndex(b&2147483647,0)};c.setComputedString=function(b,e,a){return this.setComputedStringAtIndex(b&2147483647,0,a)};c.getComputedNumericAtIndex=function(b,e){b&=2147483647;this._ensureNumeric(e,b);return this._numerics[e][b]};c.setComputedNumericAtIndex=
function(b,e,a){b&=2147483647;this._ensureNumeric(e,b);this._numerics[e][b]=a};c.getInstanceId=function(b){b&=2147483647;this._ensureInstanceId(b);return this._instanceIds[b]};c.setInstanceId=function(b,e){b&=2147483647;this._ensureInstanceId(b);this._instanceIds[b]=e};c.getComputedStringAtIndex=function(b,e){b&=2147483647;this._ensureString(e,b);return this._strings[e][b]};c.setComputedStringAtIndex=function(b,e,a){b&=2147483647;this._ensureString(e,b);this._strings[e][b]=a};c.getXMin=function(b){return this._bounds[4*
(b&2147483647)]};c.getYMin=function(b){return this._bounds[4*(b&2147483647)+1]};c.getXMax=function(b){return this._bounds[4*(b&2147483647)+2]};c.getYMax=function(b){return this._bounds[4*(b&2147483647)+3]};c.setBounds=function(b,e){e=e.readHydratedGeometry();if(!e||!e.coords.length)return!1;let a=Infinity,d=Infinity,f=-Infinity,n=-Infinity;e.forEachVertex((l,h)=>{a=Math.min(a,l);d=Math.min(d,h);f=Math.max(f,l);n=Math.max(n,h)});b&=2147483647;B(this._bounds,4*b+4,0);this._bounds[4*b]=a;this._bounds[4*
b+1]=d;this._bounds[4*b+2]=f;this._bounds[4*b+3]=n;return!0};return k}();y.ComputedAttributeStorage=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["exports"],function(y){let D=function(){function E(){this._freeIds=[];this._idCounter=1}var B=E.prototype;B.createId=function(A=!1){var k=this._getFreeId();return((A?2147483648:0)|k)>>>0};B.releaseId=function(A){this._freeIds.push(A)};B._getFreeId=function(){return this._freeIds.length?
this._freeIds.pop():this._idCounter++};return E}();y.DISPLAY_ID_TYPE_AGGREGATE=1;y.DISPLAY_ID_TYPE_FEATURE=0;y.DisplayIdGenerator=D;y.getDisplayIdIndex=function(E){return E&2147483647};y.getDisplayIdType=function(E){return(E&2147483648)>>>31};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(y,D,E,B,A,k){k=function(c){function b(a,d){return c.call(this,a,d,null)||this}D._inheritsLoose(b,c);b.from=function(a){const d=A.FeatureSetReader.createInstance(),f=[];a=a.filter(n=>!!n.geometry);for(const n of a)a=E.getJsonType(n.geometry),B.convertFromGraphics(f,[n],a,!1,!1,"uid");return new b(d,f)};var e=b.prototype;e.readGraphic=function(){return this._current};e.getCursor=function(){return this.copy()};e.copy=function(){const a=new b(this.instance,this._features);this.copyInto(a);return a};
D._createClass(b,[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return b}(k.FeatureSetReaderJSON);y.GraphicsReader=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../geometry/support/jsonUtils ../../../../../geometry ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/centroid ./StaticBitSet".split(" "),
function(y,D,E,B,A,k,c,b,e,a){let d=0;E=function(){function f(l){this.type="FeatureSetReader";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._xmin=-1;this._ymax=this._ymin=this._xmax=0;this._deleted=null;this._joined=[];this.instance=l}f.createInstance=function(){d++;return d=65535<d?0:d};var n=f.prototype;n.setArcadeSpatialReference=function(l){this._arcadeSpatialReference=l};n.attachStorage=function(l){this._storage=l};n.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");
};n.getStorage=function(){return this._storage};n.getComputedNumeric=function(l){return this.getComputedNumericAtIndex(0)};n.setComputedNumeric=function(l,h){return this.setComputedNumericAtIndex(h,0)};n.getComputedString=function(l){return this.getComputedStringAtIndex(0)};n.setComputedString=function(l,h){return this.setComputedStringAtIndex(0,h)};n.getComputedNumericAtIndex=function(l){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),l)};n.setComputedNumericAtIndex=function(l,
h){this._storage.setComputedNumericAtIndex(this.getDisplayId(),l,h)};n.getComputedStringAtIndex=function(l){return this._storage.getComputedStringAtIndex(this.getDisplayId(),l)};n.setComputedStringAtIndex=function(l,h){return this._storage.setComputedStringAtIndex(this.getDisplayId(),l,h)};n.transform=function(l,h,m,r){const p=this.copy();p._tx+=l;p._ty+=h;p._sx*=m;p._sy*=r;return p};n.extent=function(l,h,m,r){const p=this.copy();p._xmin=l;p._xmax=m;p._ymin=h;p._ymax=r;return p};n.hasFilter=function(){return this._hasFilter};
n.readAttribute=function(l,h=!1){var m=this._readAttribute(l,h);if(void 0!==m)return m;for(const r of this._joined)if(r.setIndex(this.getIndex()),m=r._readAttribute(l,h),void 0!==m)return m};n.readAttributes=function(){return this._readAttributes()};n.joinAttributes=function(l){this._joined.push(l)};n.readArcadeFeature=function(){return this};n.geometry=function(){var l=this.readHydratedGeometry();l=b.convertToGeometry(l,this.geometryType,this.hasZ,this.hasM);l=A.fromJSON(l);l.spatialReference=this._arcadeSpatialReference;
return l};n.field=function(l){return this.readAttribute(l,!0)};n.hasField=function(l){return!0};n.setField=function(l,h){};n.keys=function(){return[]};n.castToText=function(){return""};n.removeAtIndex=function(l){B.isNone(this._deleted)&&(this._deleted=a.StaticBitSet.create(this.getApproximateSize()));this._deleted.set(l)};n._getExists=function(){return B.isNone(this._deleted)||!this._deleted.has(this.getIndex())};n._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;
const l=this.readUnquantizedGeometry();if(!l||l.hasIndeterminateRingOrder)return null;const h=B.unwrapOr(this.getQuantizationTransform(),null);return e.getCentroidOptimizedGeometry(new c,l,this.hasM,this.hasZ,h)};n.copyInto=function(l){l.seen=this.seen;l._storage=this._storage;l._arcadeSpatialReference=this._arcadeSpatialReference;l._joined=this._joined;l._tx=this._tx;l._ty=this._ty;l._sx=this._sx;l._sy=this._sy;l._xmin=this._xmin;l._xmax=this._xmax;l._ymin=this._ymin;l._ymax=this._ymax};D._createClass(f,
[{key:"isEmpty",get:function(){return B.isSome(this._deleted)&&this._deleted.countSet()===this.getApproximateSize()}},{key:"_hasFilter",get:function(){return-1!==this._xmin}}]);return f}();y.FeatureSetReader=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(y){function D(B,A,k,c,b,e,a=1){e=b?e?4:3:e?3:2;let d=k,f=k+e,n=0,l=0,h=k=0,m=0;for(let r=0,p=c-1;r<p;r++,d+=e,f+=e){c=A[d];const g=A[d+1],q=A[d+2],u=A[f],v=A[f+1],z=A[f+
2];let t=c*v-u*g;h+=t;n+=(c+u)*t;l+=(g+v)*t;b&&(t=c*z-u*q,k+=(q+z)*t,m+=t);c<B[0]&&(B[0]=c);c>B[1]&&(B[1]=c);g<B[2]&&(B[2]=g);g>B[3]&&(B[3]=g);b&&(q<B[4]&&(B[4]=q),q>B[5]&&(B[5]=q))}0<h*a&&(h*=-1);0<m*a&&(m*=-1);if(!h)return null;B=[n,l,.5*h];b&&(B[3]=k,B[4]=.5*m);return B}function E(B,A,k,c,b){b=c?b?4:3:b?3:2;let e=A,a=A+b,d=0,f=0,n=0,l=0;for(let p=0,g=k-1;p<g;p++,e+=b,a+=b){var h=B[e];const q=B[e+1],u=B[e+2],v=B[a],z=B[a+1],t=B[a+2];if(c){{var m=v-h;var r=z-q;const w=t-u;m=Math.sqrt(m*m+r*r+w*w)}}else m=
v-h,r=z-q,m=Math.sqrt(m*m+r*r);m&&(d+=m,c?(h=[h+.5*(v-h),q+.5*(z-q),u+.5*(t-u)],f+=m*h[0],n+=m*h[1],l+=m*h[2]):(h=[h+.5*(v-h),q+.5*(z-q)],f+=m*h[0],n+=m*h[1]))}return 0<d?c?[f/d,n/d,l/d]:[f/d,n/d]:0<k?c?[B[A],B[A+1],B[A+2]]:[B[A],B[A+1]]:null}y.getCentroidOptimizedGeometry=function(B,A,k,c,b){if(!A||!A.lengths.length)return null;const e="upperLeft"===(null==b?void 0:b.originPosition)?-1:1;B.lengths.length&&(B.lengths.length=0);B.coords.length&&(B.coords.length=0);b=B.coords;const a=[],d=k?[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:n}=A,l=k?c?4:3:c?3:2;let h=0;for(var m of f){const r=D(d,n,h,m,k,c,e);r&&a.push(r);h+=m*l}a.sort((r,p)=>{let g=e*r[2]-e*p[2];0===g&&k&&(g=r[4]-p[4]);return g});a.length&&(m=6*a[0][2],b[0]=a[0][0]/m,b[1]=a[0][1]/m,k&&(m=6*a[0][4],b[2]=0!==m?a[0][3]/m:0),b[0]<
d[0]||b[0]>d[1]||b[1]<d[2]||b[1]>d[3]||k&&(b[2]<d[4]||b[2]>d[5]))&&(b.length=0);if(!b.length)if(A=A.lengths[0]?E(n,0,f[0],k,c):null)b[0]=A[0],b[1]=A[1],k&&2<A.length&&(b[2]=A[2]);else return null;return B};y.lineCentroid=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../../../../../layers/graphics/featureConversionUtils","./FeatureSetReader"],
function(y,D,E,B,A){function k({coords:b,lengths:e}){let a=0;for(const d of e){for(e=1;e<d;e++)b[2*(a+e)]+=b[2*(a+e)-2],b[2*(a+e)+1]+=b[2*(a+e)-1];a+=d}}let c=function(b){function e(d,f,n){d=b.call(this,d)||this;d._featureIndex=-1;d._dateFields=new Set;d._geometryType=n;d._features=f;return d}D._inheritsLoose(e,b);e.fromFeatures=function(d,f,n){n=B.convertFromFeatures([],d,f,!1,!1,n);for(let l=0;l<n.length;l++)n[l].displayId=d[l].displayId;return e.fromOptimizedFeatures(n,f)};e.fromFeatureSet=function(d,
f){d=B.convertFromFeatureSet(d,f);return e.fromOptimizedFeatureSet(d)};e.fromOptimizedFeatureSet=function(d){const {features:f,geometryType:n}=d,l=e.fromOptimizedFeatures(f,n);l._exceededTransferLimit=d.exceededTransferLimit;l._transform=d.transform;for(const h of d.fields)"esriFieldTypeDate"===h.type&&l._dateFields.add(h.name);return l};e.fromOptimizedFeatures=function(d,f,n){const l=A.FeatureSetReader.createInstance();d=new e(l,d,f);d._transform=n;return d};var a=e.prototype;a.getApproximateSize=
function(){return this._features.length};a.getCursor=function(){return this.copy()};a.getQuantizationTransform=function(){return this._transform};a.getAttributeHash=function(){let d="";for(const f in this._current.attributes)d+=this._current.attributes[f];return d};a.getIndex=function(){return this._featureIndex};a.setIndex=function(d){this._featureIndex=d};a.getObjectId=function(){return this._current.objectId};a.getDisplayId=function(){return this._current.displayId};a.setDisplayId=function(d){this._current.displayId=
d};a.getGroupId=function(){return this._current.groupId};a.setGroupId=function(d){this._current.groupId=d};a.copy=function(){const d=new e(this.instance,this._features,this.geometryType);this.copyInto(d);return d};a.next=function(){for(;++this._featureIndex<this._features.length&&!this._passesFilter()&&!this._getExists(););return this._featureIndex<this._features.length};a.readLegacyFeature=function(){return B.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};a.readOptimizedFeature=
function(){return this._current};a.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};a.readLegacyGeometry=function(){const d=this.readGeometry();return B.convertToGeometry(d,this.geometryType,this.hasZ,this.hasM)};a.readLegacyCentroid=function(){const d=this.readCentroid();return d?{x:d.coords[0]*this._sx+this._tx,y:d.coords[1]*this._sy+this._ty}:null};a.readGeometryArea=function(){return B.getQuantizedArea(this._current.geometry,2)};a.readUnquantizedGeometry=
function(){var d=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!d)return d;d=d.clone();k(d);return d};a.readHydratedGeometry=function(){var d=this._current.geometry;if(!d)return null;d=d.clone();E.isSome(this._transform)&&B.unquantizeOptimizedGeometry(d,d,this.hasZ,this.hasM,this._transform);return d};a.getXHydrate=function(){const d=this._current.geometry.coords[0],f=this.getQuantizationTransform();return E.isNone(f)?d:d*f.scale[0]+f.translate[0]};a.getYHydrate=function(){const d=
this._current.geometry.coords[1],f=this.getQuantizationTransform();return E.isNone(f)?d:f.translate[1]-d*f.scale[1]};a.getX=function(){return this._current.geometry.coords[0]*this._sx+this._tx};a.getY=function(){return this._current.geometry.coords[1]*this._sy+this._ty};a.readGeometry=function(){if(!this._current.hasGeometry)return null;const d=this._current.geometry.clone();if(d.isPoint)return d.coords[0]=d.coords[0]*this._sx+this._tx,d.coords[1]=d.coords[1]*this._sy+this._ty,d;let f=0;for(const n of d.lengths)d.coords[2*
f]=d.coords[2*f]*this._sx+this._tx,d.coords[2*f+1]=d.coords[2*f+1]*this._sy+this._ty,f+=n;return d};a.readCentroid=function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var d=this._computeCentroid();if(!d)return null;d.coords[0]=(d.coords[0]-this._tx)/this._sx;d.coords[1]=(d.coords[1]-this._ty)/this._sy;this._current.centroid=d}d=this._current.centroid.clone();d.coords[0]=d.coords[0]*this._sx+this._tx;d.coords[1]=d.coords[1]*this._sx+this._ty;return d};a._readAttribute=
function(d,f){var n=this._current.attributes[d];if(void 0!==n)return null!=n&&f&&this._dateFields.has(d)?new Date(n):n;n=this.readAttributes();d=d.toLocaleLowerCase().trim();for(const l in n)if(l.toLocaleLowerCase().trim()===d)return d=this._current.attributes[l],null!=d&&f&&this._dateFields.has(l)?new Date(d):d};a.copyInto=function(d){b.prototype.copyInto.call(this,d);d._featureIndex=this._featureIndex;d._transform=this._transform;d._dateFields=this._dateFields};a._readAttributes=function(){return this._current.attributes};
a._passesFilter=function(){if(!this._hasFilter)return!0;var d=0;let f=0;switch(this.geometryType){case "esriGeometryPoint":d=this._current.geometry;if(!d)return!1;[d,f]=d.coords;break;case "esriGeometryPolygon":d=this.readCentroid();if(!d)return!1;[d,f]=d.coords;d-=this._tx;f-=this._ty;break;default:return!1}return d>=this._xmin&&d<=this._xmax&&f>=this._ymin&&f<=this._ymax?!0:!1};D._createClass(e,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},
{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return e}(A.FeatureSetReader);y.FeatureSetReaderJSON=c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Evented ../../../tiling/TileKey ../../../tiling/TileCoverage ./Tile ../../../../../chunks/rbush".split(" "),
function(y,D,E,B,A,k,c){const b={added:[],removed:[]},e=new Set,a=new B(0,0,0,0);return function(d){function f(l){var h=d.call(this)||this;h._tiles=new Map;h._index=c.rbush(9,D("csp-restrictions")?m=>({minX:m.bounds[0],minY:m.bounds[1],maxX:m.bounds[2],maxY:m.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);h.tiles=[];h.tileScheme=l;return h}y._inheritsLoose(f,d);var n=f.prototype;n.destroy=function(){this.clear()};n.clear=function(){this.tiles.length=0;this._tiles.clear();this._index.clear()};
n.has=function(l){return this._tiles.has(l)};n.get=function(l){return this._tiles.get(l)};n.findByKey=function(l){return this._tiles.get(l.id)};n.minLOD=function(){return Math.min(...this.tiles.map(l=>l.level))};n.intersections=function(l,h){var m="string"===typeof l?this.get(l):l;if(!m)return[];var r=h*m.resolution;h=m.bounds[0]-r;l=m.bounds[1]-r;const p=m.bounds[2]+r;m=m.bounds[3]+r;r=[];for(const g of this._index.search({minX:h,minY:l,maxX:p,maxY:m})){const q=g.bounds.slice();q[0]=Math.max(q[0],
h);q[1]=Math.max(q[1],l);q[2]=Math.min(q[2],p);q[3]=Math.min(q[3],m);0<q[2]-q[0]&&0<q[3]-q[1]&&r.push({bounds:q,tile:g})}return r};n.boundsIntersections=function(l){return this._index.search({minX:l[0],minY:l[1],maxX:l[2],maxY:l[3]})};n.updateTiles=function(l){const h={added:[],removed:[]};for(const m of l.added)if(!this.has(m)){const r=new k.Tile(this.tileScheme,m);this._tiles.set(m,r);this._index.insert(r);h.added.push(r)}for(const m of l.removed)this.has(m)&&(l=this.get(m),this._tiles.delete(m),
this._index.remove(l),h.removed.push(l));this.tiles.length=0;this._tiles.forEach(m=>this.tiles.push(m));(h.added.length||h.removed.length)&&this.emit("update",h)};n.setViewState=function(l){if(l=this.tileScheme.getTileCoverage(l,0)){var {spans:h,lodInfo:m}=l,{level:r}=m;if(0<h.length)for(const {row:g,colFrom:q,colTo:u}of h)for(var p=q;p<=u;p++){const v=a.set(r,g,m.normalizeCol(p),m.getWorldForColumn(p)).id;e.add(v);if(!this.has(v)){const z=new k.Tile(this.tileScheme,v);this._tiles.set(v,z);this._index.insert(z);
this.tiles.push(z);b.added.push(z)}}for(r=this.tiles.length-1;0<=r;r--)p=this.tiles[r],e.has(p.id)||(this._tiles.delete(p.id),this.tiles.splice(r,1),this._index.remove(p),b.removed.push(p));(b.added.length||b.removed.length)&&this.emit("update",b);A.pool.release(l);e.clear();b.added.length=0;b.removed.length=0}};return f}(E)})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(y,D){function E(h,m){if(!(this instanceof E))return new E(h,m);this._maxEntries=Math.max(4,h||9);
this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));m&&("function"===typeof m?this.toBBox=m:this._initFormat(m));this.clear()}function B(h,m){A(h,0,h.children.length,m,h)}function A(h,m,r,p,g){g||(g=n(null));g.minX=Infinity;g.minY=Infinity;g.maxX=-Infinity;g.maxY=-Infinity;for(var q;m<r;m++)q=h.children[m],k(g,h.leaf?p(q):q);return g}function k(h,m){h.minX=Math.min(h.minX,m.minX);h.minY=Math.min(h.minY,m.minY);h.maxX=Math.max(h.maxX,m.maxX);h.maxY=Math.max(h.maxY,m.maxY);return h}function c(h,
m){return h.minX-m.minX}function b(h,m){return h.minY-m.minY}function e(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function a(h){return h.maxX-h.minX+(h.maxY-h.minY)}function d(h,m){return h.minX<=m.minX&&h.minY<=m.minY&&m.maxX<=h.maxX&&m.maxY<=h.maxY}function f(h,m){return m.minX<=h.maxX&&m.minY<=h.maxY&&m.maxX>=h.minX&&m.maxY>=h.minY}function n(h){return{children:h,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function l(h,m,r,p,g){for(var q=[m,r],u;q.length;)r=q.pop(),
m=q.pop(),r-m<=p||(u=m+Math.ceil((r-m)/p/2)*p,D.quickselect(h,u,m,r,g),q.push(m,u,u,r))}E.prototype={all:function(){return this._all(this.data,[])},search:function(h){var m=this.data,r=[],p=this.toBBox;if(!f(h,m))return r;for(var g=[],q,u,v,z;m;){q=0;for(u=m.children.length;q<u;q++)v=m.children[q],z=m.leaf?p(v):v,f(h,z)&&(m.leaf?r.push(v):d(h,z)?this._all(v,r):g.push(v));m=g.pop()}return r},collides:function(h){var m=this.data,r=this.toBBox;if(!f(h,m))return!1;for(var p=[],g,q,u,v;m;){g=0;for(q=m.children.length;g<
q;g++)if(u=m.children[g],v=m.leaf?r(u):u,f(h,v)){if(m.leaf||d(h,v))return!0;p.push(u)}m=p.pop()}return!1},load:function(h){if(!h||!h.length)return this;if(h.length<this._minEntries){for(var m=0,r=h.length;m<r;m++)this.insert(h[m]);return this}h=this._build(h.slice(),0,h.length-1,0);this.data.children.length?this.data.height===h.height?this._splitRoot(this.data,h):(this.data.height<h.height&&(m=this.data,this.data=h,h=m),this._insert(h,this.data.height-h.height-1,!0)):this.data=h;return this},insert:function(h){h&&
this._insert(h,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(h,m){if(!h)return this;for(var r=this.data,p=this.toBBox(h),g=[],q=[],u,v,z,t;r||g.length;){r||(r=g.pop(),v=g[g.length-1],u=q.pop(),t=!0);if(r.leaf){a:{z=h;var w=r.children,x=m;if(x){for(var C=0;C<w.length;C++)if(x(z,w[C])){z=C;break a}z=-1}else z=w.indexOf(z)}if(-1!==z){r.children.splice(z,1);g.push(r);this._condense(g);break}}t||r.leaf||!d(r,p)?v?(u++,r=v.children[u],t=!1):r=null:(g.push(r),
q.push(u),u=0,v=r,r=r.children[0])}return this},toBBox:function(h){return h},compareMinX:c,compareMinY:b,toJSON:function(){return this.data},fromJSON:function(h){this.data=h;return this},_all:function(h,m){for(var r=[];h;)h.leaf?m.push.apply(m,h.children):r.push.apply(r,h.children),h=r.pop();return m},_build:function(h,m,r,p){var g=r-m+1,q=this._maxEntries;if(g<=q){var u=n(h.slice(m,r+1));B(u,this.toBBox);return u}p||(p=Math.ceil(Math.log(g)/Math.log(q)),q=Math.ceil(g/Math.pow(q,p-1)));u=n([]);u.leaf=
!1;u.height=p;g=Math.ceil(g/q);q=g*Math.ceil(Math.sqrt(q));var v;for(l(h,m,r,q,this.compareMinX);m<=r;m+=q){var z=Math.min(m+q-1,r);l(h,m,z,g,this.compareMinY);for(v=m;v<=z;v+=g){var t=Math.min(v+g-1,z);u.children.push(this._build(h,v,t,p-1))}}B(u,this.toBBox);return u},_chooseSubtree:function(h,m,r,p){for(var g,q,u,v,z,t,w,x;;){p.push(m);if(m.leaf||p.length-1===r)break;w=x=Infinity;g=0;for(q=m.children.length;g<q;g++)u=m.children[g],z=e(u),t=(Math.max(u.maxX,h.maxX)-Math.min(u.minX,h.minX))*(Math.max(u.maxY,
h.maxY)-Math.min(u.minY,h.minY))-z,t<x?(x=t,w=z<w?z:w,v=u):t===x&&z<w&&(w=z,v=u);m=v||m.children[0]}return m},_insert:function(h,m,r){var p=this.toBBox;r=r?h:p(h);p=[];var g=this._chooseSubtree(r,this.data,m,p);g.children.push(h);for(k(g,r);0<=m;)if(p[m].children.length>this._maxEntries)this._split(p,m),m--;else break;this._adjustParentBBoxes(r,p,m)},_split:function(h,m){var r=h[m],p=r.children.length,g=this._minEntries;this._chooseSplitAxis(r,g,p);p=this._chooseSplitIndex(r,g,p);p=n(r.children.splice(p,
r.children.length-p));p.height=r.height;p.leaf=r.leaf;B(r,this.toBBox);B(p,this.toBBox);m?h[m-1].children.push(p):this._splitRoot(r,p)},_splitRoot:function(h,m){this.data=n([h,m]);this.data.height=h.height+1;this.data.leaf=!1;B(this.data,this.toBBox)},_chooseSplitIndex:function(h,m,r){var p,g;var q=g=Infinity;for(p=m;p<=r-m;p++){var u=A(h,0,p,this.toBBox);var v=A(h,p,r,this.toBBox);var z=Math.max(0,Math.min(u.maxX,v.maxX)-Math.max(u.minX,v.minX))*Math.max(0,Math.min(u.maxY,v.maxY)-Math.max(u.minY,
v.minY));u=e(u)+e(v);if(z<q){q=z;var t=p;g=u<g?u:g}else z===q&&u<g&&(g=u,t=p)}return t},_chooseSplitAxis:function(h,m,r){var p=h.leaf?this.compareMinX:c,g=h.leaf?this.compareMinY:b,q=this._allDistMargin(h,m,r,p);m=this._allDistMargin(h,m,r,g);q<m&&h.children.sort(p)},_allDistMargin:function(h,m,r,p){h.children.sort(p);p=this.toBBox;var g=A(h,0,m,p),q=A(h,r-m,r,p),u=a(g)+a(q),v;for(v=m;v<r-m;v++){var z=h.children[v];k(g,h.leaf?p(z):z);u+=a(g)}for(v=r-m-1;v>=m;v--)z=h.children[v],k(q,h.leaf?p(z):z),
u+=a(q);return u},_adjustParentBBoxes:function(h,m,r){for(;0<=r;r--)k(m[r],h)},_condense:function(h){for(var m=h.length-1,r;0<=m;m--)0===h[m].children.length?0<m?(r=h[m-1].children,r.splice(r.indexOf(h[m]),1)):this.clear():B(h[m],this.toBBox)},_initFormat:function(h){var m=["return a"," - b",";"];this.compareMinX=new Function("a","b",m.join(h[0]));this.compareMinY=new Function("a","b",m.join(h[1]));this.toBBox=new Function("a","return {minX: a"+h[0]+", minY: a"+h[1]+", maxX: a"+h[2]+", maxY: a"+h[3]+
"};")}};y.rbush=E})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(y,D){D=D.createCommonjsModule(function(E){(function(B){B=B();void 0!==B&&(E.exports=B)})(function(){function B(c,b,e,a,d){for(;a>e;){if(600<a-e){var f=a-e+1,n=b-e+1,l=Math.log(f),h=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*h*(f-h)/f)*(0>n-f/2?-1:1);B(c,b,Math.max(e,Math.floor(b-n*h/f+l)),Math.min(a,Math.floor(b+(f-n)*h/f+l)),d)}f=c[b];n=e;h=a;A(c,e,b);for(0<d(c[a],f)&&A(c,e,a);n<h;){A(c,n,h);n++;for(h--;0>
d(c[n],f);)n++;for(;0<d(c[h],f);)h--}0===d(c[e],f)?A(c,e,h):(h++,A(c,h,a));h<=b&&(e=h+1);b<=h&&(a=h-1)}}function A(c,b,e){var a=c[b];c[b]=c[e];c[e]=a}function k(c,b){return c<b?-1:c>b?1:0}return function(c,b,e,a,d){B(c,b,e||0,a||c.length-1,d||k)}})});y.quickselect=D})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/has ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../core/unitUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/normalizeUtils ../../../../geometry/support/aaBoundingRect ./graphicsUtils ../../../../chunks/rbush ./GraphicStoreItem".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){function l(p,g,q,u,v){h.minX=g;h.minY=q;h.maxX=u;h.maxY=v;return p.search(h)}const h={minX:0,minY:0,maxX:0,maxY:0},m=a.create(),r=[];return function(){function p(q,u,v,z,t,w){this._graphics=z;this._onAdd=t;this._onRemove=w;this._index=f.rbush(9,y("csp-restrictions")?x=>({minX:x.bounds[0],minY:x.bounds[1],maxX:x.bounds[2],maxY:x.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);this._itemByGraphic=new Map;this._currentLevel=-Infinity;this._tileInfoView=
q;this._uidFieldName=v;if(u=q.getClosestInfoForScale(u))this._currentLevel=u.level,this._resolution=this._tileInfoView.getTileResolution(u.level);this._metersPerUnit=D.isValid(q.spatialReference)?c.getMetersPerUnit(q.spatialReference):1}var g=p.prototype;g.hitTest=function(q,u,v,z,t){q=e.normalizeMapX(q,this._tileInfoView.spatialReference);var w=.5*z*v;m[0]=q-w;m[1]=u-w;m[2]=q+w;m[3]=u+w;v=.5*z*(v+d.PIXEL_BUFFER);var x=l(this._index,q-v,u-v,q+v,u+v);if(!x||0===x.length)return[];v={x:q,y:u};w=[];for(const F of x)if(F.graphic.visible)switch(A.getJsonType(F.geometry)){case "esriGeometryPoint":{x=
F.symbol;if(!x)continue;const {x:H,y:J}=F.geometry;var C=z*this._metersPerUnit;let K;switch(x.type){case "esriTS":K=d.getTextSymbolBounds(H,J,x,F.size,z,t);break;case "expanded-cim":K=d.getCIMMarkerBounds(H,J,x,z,C,t);break;case "esriSMS":case "esriPMS":K=d.getMarkerSymbolBounds(H,J,x,z,C,t)}E.polygonContainsPoint(K,v)&&w.push(F)}break;case "esriGeometryPolyline":(x=F.symbol)&&x.layers.length&&(x=1.5*z*window.devicePixelRatio*k.pt2px(x.layers[0].width),d.isPointOnPolyline(F.geometry,q,u,x)&&w.push(F));
break;case "esriGeometryEnvelope":x=F.geometry;x=a.fromValues(x.xmin,x.ymin,x.xmax,x.ymax);a.intersects(x,m)&&w.push(F);break;case "esriGeometryPolygon":if(E.polygonContainsPoint(F.geometry,v)){w.push(F);break}x=B.getPolygonExtent(F.geometry);if(Math.abs(x.ymax-x.ymin)<5*z||Math.abs(x.xmax-x.xmin)<5*z)x=a.fromValues(x.xmin,x.ymin,x.xmax,x.ymax),a.intersects(x,m)&&w.push(F);break;case "esriGeometryMultipoint":{x=F.symbol;if(!x)continue;C=F.geometry.points;let H;for(let J=0;J<C.length;J++)if(H="esriTS"===
x.type?d.getTextSymbolBounds(C[J][0],C[J][1],x,F.size,z,t):d.getMarkerSymbolBounds(C[J][0],C[J][1],x,z,z*this._metersPerUnit,t),E.polygonContainsPoint(H,v)){w.push(F);break}}}w.sort((F,H)=>{const J=d.graphicGeometryToNumber(F.graphic),K=d.graphicGeometryToNumber(H.graphic);return J===K?H.zorder-F.zorder:J-K});return w.map(F=>F.graphic)};g.getGraphicsData=function(q,u,v){const z=this._searchForItems(u);if(0===z.length||0===v.length)return[];z.sort((F,H)=>F.zorder-H.zorder);z[0].insertAfter=-1;for(var t=
1;t<z.length;t++)z[t].insertAfter=z[t-1].graphic.uid;z.sort((F,H)=>F.graphic.uid-H.graphic.uid);v.sort((F,H)=>F.uid-H.uid);let w=t=0,x;const C=[];u={originPosition:"upperLeft",scale:[u.resolution,u.resolution],translate:[u.bounds[0],u.bounds[3]]};for(const F of v){for(w=-2;t<z.length;)if(x=z[t],t++,F.uid===x.graphic.uid){w=x.insertAfter;break}if(!x.geometry||-2===w)continue;v=x.getGeometryQuantized(u);const H={...x.graphic.attributes};H[this._uidFieldName]=F.uid;null==x.groupId&&(x.groupId=q.createTemplateGroup(x.symbol,
null));C.push({centroid:n.getCentroidQuantized(x,u),geometry:v,attributes:H,symbol:x.symbol,groupId:x.groupId,insertAfter:w,zorder:x.zorder})}C.sort((F,H)=>F.zorder-H.zorder);return C};g.queryTileData=function(q,u){const {bounds:v,resolution:z}=u;u=this._searchForItems(u);const t=[];this._createTileGraphics(t,q,u,{originPosition:"upperLeft",scale:[z,z],translate:[v[0],v[3]]});return t};g.has=function(q){return this._itemByGraphic.has(q)};g.getBounds=function(q){return this._itemByGraphic.has(q)?this._itemByGraphic.get(q).bounds:
null};g.addOrModify=function(q,u,v){if(q)return this.has(q)&&this.remove(q),this._onAdd(q),u=n.acquire(q,u,v,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(q,u),v&&this._index.insert(u),u.bounds};g.remove=function(q){if(this._itemByGraphic.has(q)){this._onRemove(q);var u=this._itemByGraphic.get(q);this._index.remove(u);this._itemByGraphic.delete(q)}};g.updateZ=function(){const q=this._graphics.items;for(let v=0;v<q.length;v++){var u=
q[v];if(u=this._itemByGraphic.get(u))u.zorder=v}};g.update=function(q,u,v){const z=this._itemByGraphic.get(q);z.groupId=null;const t=a.clone(z.bounds);z.size[0]=z.size[1]=0;this._index.remove(z);z.set(q,u,v,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);v&&this._index.insert(z);return{oldBounds:t,newBounds:z.bounds}};g.updateLevel=function(q){this._currentLevel!==q&&(this._currentLevel=q,this._resolution=this._tileInfoView.getTileResolution(q),this._index.clear(),
r.length=0,this._itemByGraphic.forEach(u=>{u.updateBounds(this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);u.geometry&&r.push(u)}),this._index.load(r))};g.clear=function(){this._itemByGraphic.clear();this._index.clear()};g._createTileGraphics=function(q,u,v,z){const t=this._uidFieldName;v.sort((H,J)=>H.zorder-J.zorder);let w,x,C,F;for(let H=0;H<v.length;H++){C=v[H];w=C.graphic;x=C.getGeometryQuantized(z);F=0===H?-1:v[H-1].graphic.uid;const J={...C.graphic.attributes};
J[t]=w.uid;null==C.groupId&&(C.groupId=u.createTemplateGroup(C.symbol,null));q.push({centroid:n.getCentroidQuantized(C,z),geometry:x,attributes:J,symbol:C.symbol,groupId:C.groupId,insertAfter:F,zorder:C.zorder})}};g._searchForItems=function(q){var u=this._tileInfoView.spatialReference,v=q.bounds;if(u.isWrappable){const [z,t]=b.getSpatialReferenceMinMaxX(u);u=1E-5>Math.abs(v[2]-t);const w=1E-5>Math.abs(v[0]-z);if(!(u&&w||!u&&!w))return q=q.resolution,q=u?a.create([z,v[1],z+q*d.PIXEL_BUFFER,v[3]]):
a.create([t-q*d.PIXEL_BUFFER,v[1],t,v[3]]),v=l(this._index,v[0],v[1],v[2],v[3]),q=l(this._index,q[0],q[1],q[2],q[3]),[...new Set([...v,...q])]}return l(this._index,v[0],v[1],v[2],v[3])};return p}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/aaBoundingRect ../../../../layers/graphics/OptimizedGeometry ../../../../layers/graphics/featureConversionUtils ../../../../geometry/support/quantizationUtils ./graphicsUtils".split(" "),
function(y,D,E,B,A,k,c,b,e){const a=new k,d=new k;k=function(){function f(){this.bounds=A.create();this.graphic=null;this.size=[0,0,0,0]}f.acquire=function(l=null,h,m,r,p,g){let q;0===f._pool.length?q=new f:(q=f._pool.pop(),this._set.delete(q));q.acquire(l,h,m,r,p,g);return q};f.release=function(l){l&&!this._set.has(l)&&(l.release(),this._pool.push(l),this._set.add(l))};f.getCentroidQuantized=function(l,h){if(B.isPolygon(l.geometry)){const m=l.symbol;if(D.isNone(m))return null;if(e.isMarkerSymbol(m.type)||
e.isTextSymbol(m.type))return l=E.polygonCentroid(l.geometry),b.quantizePoint(h,{},{x:l[0],y:l[1]},!1,!1)}return null};var n=f.prototype;n.acquire=function(l=null,h,m,r,p,g){l&&this.set(l,h,m,r,p,g)};n.release=function(){this.geometry=this.symbolResource=this.graphic=null};n.set=function(l,h,m,r,p,g){this.graphic=l;this.geometry=m;this.symbolResource=h;this.updateBounds(r,p,g)};n.updateBounds=function(l,h,m){e.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,l,h,m)};n.getGeometryQuantized=
function(l){if(B.isPolygon(this.geometry)){const h=this.geometry.rings;if(1===h.length&&2===h[0].length)return b.quantizeGeometry(l,{paths:[[h[0][0],h[0][1]]]})}else if(B.isPolyline(this.geometry))return a.coords.length=0,a.lengths.length=0,d.coords.length=0,d.lengths.length=0,c.convertFromPolyline(a,this.geometry),c.generalizeOptimizedGeometry(d,a,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",l.scale[0]),c.quantizeOptimizedGeometry(a,d,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",
l),c.convertToPolyline(a,this.geometry.hasZ,this.geometry.hasM);return b.quantizeGeometry(l,this.geometry)};y._createClass(f,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return f}();k._pool=[];k._set=new Set;return k})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Identifiable".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){y.GraphicsView=l=>{l=function(h){function m(){var r=h.apply(this,arguments)||this;r.graphics=null;r.renderer=null;r.view=null;return r}D._inheritsLoose(m,h);return m}(n.IdentifiableMixin(l));E.__decorate([c.property()],l.prototype,"graphics",void 0);E.__decorate([c.property()],l.prototype,"renderer",void 0);E.__decorate([c.property()],l.prototype,"updating",void 0);E.__decorate([c.property()],l.prototype,"view",void 0);return l=E.__decorate([e.subclass("esri.views.layers.GraphicsView")],
l)};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(y,D,E){return function(B){function A(){return B.apply(this,arguments)||this}y._inheritsLoose(A,B);var k=A.prototype;k.renderChildren=function(c){this.attributeView.bindTextures(c.context);this.children.some(b=>b.hasData)&&(B.prototype.renderChildren.call(this,c),c.drawPhase===
D.WGLDrawPhase.MAP&&this._renderChildren(c),c.drawPhase===D.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(c))};k._renderHighlight=function(c){var {painter:b}=c;b=b.effects.highlight;b.bind(c);this._renderChildren(c,b.defines);b.draw(c);b.unbind()};return A}(E)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer"],function(y,D){return function(E){function B(k){return E.call(this,k)||this}y._inheritsLoose(B,
E);var A=B.prototype;A.onTileData=function(k,c){k.patch(c);this.contains(k)||this.addChild(k);this.requestRender()};A.onTileError=function(k){k.clear();this.contains(k)||this.addChild(k)};A._renderChildren=function(k,c){for(const b of this.children)b.isReady&&b.hasData&&(b.commit(k),k.context.setStencilFunction(514,b.stencilRef,255),b._displayList.replay(k,b,c))};y._createClass(B,[{key:"hasLabels",get:function(){return!1}},{key:"labelsVisible",get:function(){return!1}}]);return B}(D.FeatureContainer)})},
"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(y,D,E,B,A,k,c){k=function(b){function e(d){var f=b.call(this,d)||this;f._rendererInfo=new c.WGLRendererInfo;f._materialItemsRequestQueue=new B;f.attributeView=new A.AttributeStoreView(()=>f.onAttributeStoreUpdate());return f}D._inheritsLoose(e,b);var a=
e.prototype;a.destroy=function(){this.removeAllChildren();this.children.forEach(d=>d.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(d,f,n){this._rendererInfo.setInfo(d,f,n);this.requestRender()};a.getMaterialItems=async function(d,f){if(!d||0===d.length)return null;const n=E.createResolver();this._materialItemsRequestQueue.push({items:d,abortOptions:f,resolver:n});this.requestRender();return n.promise};a.doRender=function(d){d.context.capabilities.enable("textureFloat");
d.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let f=this._materialItemsRequestQueue.pop();for(;f;)this._processMaterialItemRequest(d,f),f=this._materialItemsRequestQueue.pop()}b.prototype.doRender.call(this,d)};a.renderChildren=function(d){for(const f of this.children)f.commit(d);this._rendererInfo.update(d.state);b.prototype.renderChildren.call(this,d)};a.createRenderParams=function(d){return{...b.prototype.createRenderParams.call(this,d),rendererInfo:this._rendererInfo,
attributeView:this.attributeView}};a.onAttributeStoreUpdate=function(){};a._processMaterialItemRequest=function(d,{items:f,abortOptions:n,resolver:l}){const {painter:h,pixelRatio:m}=d;d=f.map(r=>h.textureManager.rasterizeItem(r.symbol,m,r.glyphIds,n));Promise.all(d).then(r=>{this.stage?(r=r.map((p,g)=>({id:f[g].id,mosaicItem:p})),l.resolve(r)):l.reject()},l.reject)};return e}(k["default"]);y.FeatureContainer=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/promiseUtils ./definitions ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Utils ./util/debug".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g){const q=A.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),u=g.createDebugLogger(g.DEBUG_ATTR_UPDATES,q);let v=function(){function z(w,x,C){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:F,pixelType:H,textureOnly:J}=w;w=p.getPixelArrayCtor(H);this.shared=C;this.pixelType=H;this.size=x;this.textureOnly=J;J||(this.data=new w(B.unwrap(F)));this._resetRange()}var t=z.prototype;t.destroy=function(){B.andThen(this._texture,
w=>w.dispose());for(const w in this._fbos)B.andThen(this._fbos[w],x=>{"0"===w&&x.detachColorTexture();x.dispose()}),this._fbos[w]=null;this._texture=null};t.setData=function(w,x,C){w&=2147483647;const F=B.unwrap(this.data);x=w*this.texelSize+x;!F||x>=F.length||(F[x]=C,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};t.getData=function(w,x){if(B.isNone(this.data))return null;w=(w&2147483647)*this.texelSize+x;return!this.data||w>=this.data.length?null:this.data[w]};
t.getTexture=function(w){return B.unwrapOr(this._texture,()=>this._initTexture(w))};t.getFBO=function(w,x=0){if(B.isNone(this._fbos[x])){const C=0===x?this.getTexture(w):this._textureDesc;this._fbos[x]=new l(w,{colorTarget:0,depthStencilTarget:0},C)}return this._fbos[x]};t.updateTexture=function(w){if(!this.locked)try{const G=this.dirtyStart,M=this.dirtyEnd;if(!(G>M)){this._resetRange();var x=B.unwrap(this.data).buffer,C=this.getTexture(w),F=(G-G%this.size)/this.size,H=(M-M%this.size)/this.size,J=
F*this.size*4,K=4*(this.size+H*this.size)-J,N=p.getPixelArrayCtor(this.pixelType),R=N.BYTES_PER_ELEMENT;try{new N(x,J*R,K)}catch(P){}var I=new N(x,J*R,K),L=this.size;w=H-F+1;w>this.size?q.error(new k("mapview-webgl","Out-of-bounds index when updating AttributeData")):C.updateData(0,0,F,L,w,I)}}catch(G){}};t.update=function(w){const {data:x,start:C,end:F}=w;if(B.isSome(x)){const H=this.data,J=C*this.texelSize;for(let K=0;K<x.length;K++)w.layout&1<<K%this.texelSize&&(H[J+K]=x[K])}this.dirtyStart=Math.min(this.dirtyStart,
C);this.dirtyEnd=Math.max(this.dirtyEnd,F)};t.resize=function(w,x){const C=this.size;this.size=x;this.textureOnly?C!==this.size&&(this._lastTexture=this._texture,this._texture=null):(x=p.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new x(B.unwrap(w.buffer)))};t._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._initTexture=function(w){const x=new d(w,this._textureDesc,B.unwrapOr(this.data,void 0));if(B.isSome(this._lastTexture)&&this._fbos[0]){const H=this._lastTexture.descriptor.width,
J=this._lastTexture.descriptor.height,K=this._lastTexture.descriptor.dataType,N=this._lastTexture.descriptor.pixelFormat,R=this.getFBO(w);var C=p.getPixelBytes(K),F=p.getPixelArrayCtor(K);C=new ArrayBuffer(H*J*C*this.texelSize);F=new F(C);C=w.getBoundFramebufferObject();const {x:I,y:L,width:G,height:M}=w.getViewport();w.bindFramebuffer(R);R.readPixels(0,0,H,J,N,K,F);x.updateData(0,0,0,2*H,J/2,F);w.setViewport(I,L,G,M);w.bindFramebuffer(C)}this.destroy();return this._texture=x};D._createClass(z,[{key:"_textureDesc",
get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"locked",get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&E("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}}]);return z}();A=function(){function z(w){this._onUpdate=w;this._locked=this._forceNextUpload=this._initialized=!1}var t=z.prototype;t.initialize=function(w){const {blocks:x,shared:C,size:F}=w;this.shared=
C;this.size=F;u("Initializing AttributeStoreView",w);if(B.isNone(this._data))this._data=B.mapMany(x,H=>new v(H,F,C));else for(w=0;w<this._data.length;w++){const H=this._data[w],J=x[w];B.isSome(J)&&(B.isNone(H)?this._data[w]=new v(J,F,C):H.resize(J,F))}this._initialized=!0};t.destroy=function(){B.andThen(this._data,w=>B.mapMany(w,x=>x.destroy()));B.andThen(this._defaultTexture,w=>w.dispose())};t.getBlock=function(w){return B.isNone(this._data)?null:this._data[w]};t.setLabelMinZoom=function(w,x){this.setData(w,
0,1,x)};t.getLabelMinZoom=function(w){return this.getData(w,0,1,255)};t.getFilterFlags=function(w){return this.getData(w,0,0,0)};t.getVVSize=function(w){return this.getData(w,b.ATTRIBUTE_DATA_VV,0,0)};t.getData=function(w,x,C,F){if(!this._data)return 0;x=B.unwrap(this._data)[x];if(B.isNone(x))return 0;w=x.getData(w,C);return B.isSome(w)?w:F};t.setData=function(w,x,C,F){x=B.unwrap(this._data)[x];B.unwrap(x).setData(w,C,F)};t.lockTextureUpload=function(){this._locked=!0};t.unlockTextureUpload=function(){this._locked=
!1};t.forceTextureUpload=function(){this._forceNextUpload=!0};t.requestUpdate=async function(w){if(this._pendingAttributeUpdate)q.error(new k("mapview-webgl","Tried to update attribute data with a pending update"));else{var x=c.createResolver();u("AttributeStoreView Update Requested",w);this._pendingAttributeUpdate={data:w,resolver:x};return x.promise}};t.update=function(){if(this._initialized&&(this._onUpdate(),B.isSome(this._pendingAttributeUpdate))){const {data:w,resolver:x}=this._pendingAttributeUpdate,
C=B.unwrap(this._data);for(let F=0;F<w.blocks.length;F++){const H=w.blocks[F];B.andThen(C[F],J=>B.andThen(H,K=>{u(`Updating block ${F}`,K);J.update(K)}))}this._pendingAttributeUpdate=null;x()}};t.bindTextures=function(w){this.update();const x=this._getDefaultTexture(w);if(this._initialized){var C=B.unwrap(this._data);if(!this._locked||this._forceNextUpload)B.forEachSome(C,F=>F.updateTexture(w)),this._forceNextUpload=!1;w.bindTexture(B.mapOr(C[0],x,F=>F.getTexture(w)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);
w.bindTexture(B.mapOr(C[1],x,F=>F.getTexture(w)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);w.bindTexture(B.mapOr(C[2],x,F=>F.getTexture(w)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_2);w.bindTexture(B.mapOr(C[3],x,F=>F.getTexture(w)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else w.bindTexture(x,b.TEXTURE_BINDING_ATTRIBUTE_DATA_0),w.bindTexture(x,b.TEXTURE_BINDING_ATTRIBUTE_DATA_1),w.bindTexture(x,b.TEXTURE_BINDING_ATTRIBUTE_DATA_2),w.bindTexture(x,b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};t._getDefaultTexture=function(w){B.isNone(this._defaultTexture)&&
(this._defaultTexture=new d(w,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return z}();y.AttributeStoreView=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./enums ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil ./WGLContainer".split(" "),function(y,D,E,B,A,k){const c=(b,e)=>0!==b.key.level-
e.key.level?b.key.level-e.key.level:0!==b.key.row-e.key.row?b.key.row-e.key.row:b.key.col-e.key.col;k=function(b){function e(d){var f=b.call(this)||this;f._tileInfoView=d;return f}D._inheritsLoose(e,b);var a=e.prototype;a.renderChildren=function(d){this.sortChildren(c);this.setStencilReference();b.prototype.renderChildren.call(this,d)};a.createRenderParams=function(d){const {state:f}=d;return{...b.prototype.createRenderParams.call(this,d),requiredLevel:this._tileInfoView.getClosestInfoForScale(f.scale).level,
displayLevel:this._tileInfoView.tileInfo.scaleToZoom(f.scale)}};a.prepareRenderPasses=function(d){const f=d.registerRenderPass({name:"stencil",brushes:[A],drawPhase:E.WGLDrawPhase.DEBUG|E.WGLDrawPhase.MAP|E.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}),n=d.registerRenderPass({name:"tileInfo",brushes:[B],drawPhase:E.WGLDrawPhase.DEBUG,target:()=>this.children,has:"esri-tiles-debug"});return[...b.prototype.prepareRenderPasses.call(this,d),f,n]};a.getStencilTarget=function(){return this.children};
a.updateTransforms=function(d){for(const f of this.children){const n=this._tileInfoView.getTileResolution(f.key);f.setTransform(d,n)}};a.setStencilReference=function(){let d=1;for(const f of this.children)f.stencilRef=d++};D._createClass(e,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return e}(k);y.default=k;y.sortByLevel=c;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ./enums ../Container ../brushes ./ClippingInfo".split(" "),
function(y,D,E,B,A,k,c){return function(b){function e(){var d=b.apply(this,arguments)||this;d.name=d.constructor.name;return d}y._inheritsLoose(e,b);var a=e.prototype;a.doRender=function(d){const f=this.createRenderParams(d),{painter:n,globalOpacity:l,profiler:h,drawPhase:m}=f,r=m===B.WGLDrawPhase.LABEL?1:l*this.computedOpacity;h.recordContainerStart(this.name);n.beforeRenderLayer(f,this._clippingInfos?255:0,r);this.updateTransforms(d.state);this.renderChildren(f);n.compositeLayer(f,r);h.recordContainerEnd()};
a.renderChildren=function(d){E.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(d.painter));for(const f of this.children)f.beforeRender(d);for(const f of this._renderPasses)try{f.render(d)}catch(n){}for(const f of this.children)f.afterRender(d)};a.createRenderParams=function(d){return{...d,requireFBO:this.requiresDedicatedFBO}};a.prepareRenderPasses=function(d){return[d.registerRenderPass({name:"clip",brushes:[k.brushes.clip],target:()=>this._clippingInfos,drawPhase:B.WGLDrawPhase.MAP|
B.WGLDrawPhase.LABEL|B.WGLDrawPhase.LABEL_ALPHA|B.WGLDrawPhase.DEBUG|B.WGLDrawPhase.HIGHLIGHT})]};a.updateTransforms=function(d){for(const f of this.children)f.setTransform(d)};a.onAttach=function(){b.prototype.onAttach.call(this);this._updateClippingInfo()};a.onDetach=function(){b.prototype.onDetach.call(this);this._updateClippingInfo()};a._updateClippingInfo=function(){E.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>f.destroy()),this._clippingInfos=null);if(this.stage){var d=this._clips;
E.isSome(d)&&d.length&&(this._clippingInfos=d.items.map(f=>c.fromClipArea(this.stage,f)));this.requestRender()}};y._createClass(e,[{key:"clips",set:function(d){this._clips=d;this.children.forEach(f=>f.clips=d);this._updateClippingInfo()}}]);return e}(A.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../webgl/VertexArrayObject ../DisplayObject ./Mesh2D".split(" "),
function(y,D,E,B,A,k,c){const b=E.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(e){function a(f,n){var l=e.call(this)||this;l._clip=n;l._cache={};l.stage=f;l._handle=n.watch("version",()=>l._invalidate());l.ready();return l}y._inheritsLoose(a,e);a.fromClipArea=function(f,n){return new a(f,n)};var d=a.prototype;d._destroyGL=function(){D.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);D.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};d.destroy=function(){this._destroyGL();this._handle.remove()};d.getVAO=function(f,n,l,h){const [m,r]=n.size;if("geometry"===this._clip.type||this._lastWidth!==m||this._lastHeight!==r)this._lastWidth=m,this._lastHeight=r,this._destroyGL();if(D.isNone(this._cache.vao)){n=this._createMesh(n,this._clip);const p=n.getIndexBuffer(f),g=n.getVertexBuffers(f);this._cache.mesh=n;this._cache.vao=new A(f,l,h,g,p)}return this._cache.vao};d._invalidate=function(){this._destroyGL();this.requestRender()};
d._createScreenRect=function(f,n){const [l,h]=f.size;f="string"===typeof n.left?parseFloat(n.left)/100*l:n.left;const m="string"===typeof n.right?parseFloat(n.right)/100*l:n.right,r="string"===typeof n.top?parseFloat(n.top)/100*h:n.top;n="string"===typeof n.bottom?parseFloat(n.bottom)/100*h:n.bottom;return{x:f,y:r,width:Math.max(l-m-f,0),height:Math.max(h-n-r,0)}};d._createMesh=function(f,n){switch(n.type){case "rect":return c.fromRect(this._createScreenRect(f,n));case "path":return c.fromPath(n);
case "geometry":return c.fromGeometry(f,n);default:return b.error(new B("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),c.fromRect({x:0,y:0,width:1,height:1})}};return a}(k.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../layers/graphics/OptimizedGeometry ../../../../layers/graphics/featureConversionUtils ../../../../chunks/vec2f64 ../../../../core/libs/earcut/earcut ../../../../chunks/vec2 ../../../webgl/BufferObject ./number".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d){const f=E.getLogger("esri.views.2d.engine.webgl.Mesh2D"),n=({coords:l,lengths:h},m)=>{const r=[];for(let q=0,u=0;q<h.length;u+=h[q],q+=1){const v=u;for(var p=[];q<h.length-1;q+=1,u+=h[q]){{var g=u+h[q];let z=0;for(let t=1;t<h[q+1];t++)z+=(l[2*(g+t)]-l[2*(g+t-1)])*(l[2*(g+t)+1]+l[2*(g+t-1)+1]);g=m?0<z:0>z}if(!g)break;p.push(u+h[q]-v)}g=l.slice(2*v,2*(u+h[q]));p=b.earcut(g,p,2);for(const z of p)r.push(z+v)}return r};return function(){function l(m,r,p,g=!1){this._cache=
{};this.vertices=m;this.indices=r;this.primitiveType=p;this.isMapSpace=g}l.fromRect=function({x:m,y:r,width:p,height:g}){return l.fromScreenExtent({xmin:m,ymin:r,xmax:m+p,ymax:r+g})};l.fromPath=function(m){var r=k.convertFromNestedArray(new A,m.path,!1,!1);m=r.coords;r=new Uint32Array(n(r,!0));const p=new Uint32Array(m.length/2);for(let g=0;g<p.length;g++)p[g]=d.i1616to32(Math.floor(m[2*g]),Math.floor(m[2*g+1]));return new l({geometry:p},r,4)};l.fromGeometry=function(m,r){const p=r.geometry.type;
switch(p){case "polygon":return l.fromPolygon(m,r.geometry);case "extent":return l.fromMapExtent(m,r.geometry);default:return f.error(new B("mapview-bad-type",`Unable to create a mesh from type ${p}`,r)),l.fromRect({x:0,y:0,width:1,height:1})}};l.fromPolygon=function(m,r){var p=k.convertFromPolygon(new A,r,!1,!1);r=p.coords;p=new Uint32Array(n(p,!1));const g=new Uint32Array(r.length/2),q=c.create(),u=c.create();for(let v=0;v<g.length;v++)e.set(q,r[2*v],r[2*v+1]),m.toScreen(u,q),g[v]=d.i1616to32(Math.floor(u[0]),
Math.floor(u[1]));return new l({geometry:g},p,4,!0)};l.fromScreenExtent=function({xmin:m,xmax:r,ymin:p,ymax:g}){m={geometry:new Uint32Array([d.i1616to32(m,p),d.i1616to32(r,p),d.i1616to32(m,g),d.i1616to32(m,g),d.i1616to32(r,p),d.i1616to32(r,g)])};r=new Uint32Array([0,1,2,3,4,5]);return new l(m,r,4)};l.fromMapExtent=function(m,r){const [p,g]=m.toScreen([0,0],[r.xmin,r.ymin]),[q,u]=m.toScreen([0,0],[r.xmax,r.ymax]);m={geometry:new Uint32Array([d.i1616to32(p,g),d.i1616to32(q,g),d.i1616to32(p,u),d.i1616to32(p,
u),d.i1616to32(q,g),d.i1616to32(q,u)])};r=new Uint32Array([0,1,2,3,4,5]);return new l(m,r,4)};var h=l.prototype;h.destroy=function(){D.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const m in this._cache.vertexBuffers)D.isSome(this._cache.vertexBuffers[m])&&this._cache.vertexBuffers[m].dispose()};h.getIndexBuffer=function(m,r=35044){this._cache.indexBuffer||(this._cache.indexBuffer=a.createIndex(m,r,this.indices));return this._cache.indexBuffer};h.getVertexBuffers=function(m,
r=35044){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((p,g)=>({...p,[g]:a.createVertex(m,r,this.vertices[g])}),{}));return this._cache.vertexBuffers};y._createClass(l,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var m=5121;break a;case 2:m=5123;break a;case 4:m=5125;break a;default:throw new B("Cannot get DataType of array");}return m}}]);return l}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../Color ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ../../../webgl/capabilities ./Utils".split(" "),
function(y,D,E,B,A,k,c,b,e,a){function d(l,h){const m=h.length;if(l<h[0].value||1===m)return h[0].size;for(let r=1;r<m;r++)if(l<h[r].value)return h[r-1].size+(l-h[r-1].value)/(h[r].value-h[r-1].value)*(h[r].size-h[r-1].size);return h[m-1].size}function f(l,h,m=0){if(E.isNone(h))l[m+0]=0,l[m+1]=0,l[m+2]=0,l[m+3]=0;else{var {r,g:p,b:g,a:q}=h;l[m+0]=r*q/255;l[m+1]=p*q/255;l[m+2]=g*q/255;l[m+3]=q}}let n=function(){function l(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=
new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var h=l.prototype;h.getSizeVVFieldStops=function(m){const r=this._vvSizeFieldStops;switch(r.type){case "static":return r;
case "level-dependent":return E.unwrapOr(r.levels[m],()=>{var p=Infinity,g=0;for(var q in r.levels){const u=parseFloat(q),v=Math.abs(m-u);v<p&&(p=v,g=u)}if(Infinity===p)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};p=2**((m-g)/2);g=E.unwrap(r.levels[g]);q=new Float32Array(g.values);q[2]*=p;q[3]*=p;return{sizes:E.unwrap(g.sizes),values:q}})}};h.update=function(m){E.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,m)};h.setInfo=function(m,
r,p){E.isSome(p)&&p.forEach(g=>this._updateEffects(g));this._vvInfo=r;switch(m.type){case "dot-density":this._updateDotDensityInfo(m)}};h.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:e().supportsTextureFloat}};h.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};h._updateEffects=function(m){E.isSome(m)&&m.filter&&m.filter.enabled&&(this.outsideLabelsVisible=m.excludedLabelsVisible)};
h._updateVisualVariables=function(m,r){const p=this._vvMaterialParameters;p.vvOpacityEnabled=!1;p.vvSizeEnabled=!1;p.vvColorEnabled=!1;p.vvRotationEnabled=!1;if(m){var g=m.size;if(g){p.vvSizeEnabled=!0;if(g.minMaxValue){const u=g.minMaxValue;let v;if(a.isDefined(u.minSize)&&a.isDefined(u.maxSize))if(a.isNumber(u.minSize)&&a.isNumber(u.maxSize)){v=A.pt2px(u.minSize);var q=A.pt2px(u.maxSize)}else q=r.scale,v=A.pt2px(d(q,u.minSize.stops)),q=A.pt2px(d(q,u.maxSize.stops));this.vvSizeMinMaxValue.set([u.minDataValue,
u.maxDataValue,v,q])}g.scaleStops&&(this.vvSizeScaleStopsValue=A.pt2px(d(r.scale,g.scaleStops.stops)));g.unitValue&&(this.vvSizeUnitValueToPixelsRatio=k.getMetersPerUnitForSR(r.spatialReference)/c.meterIn[g.unitValue.unit]/r.resolution);g.fieldStops&&(this._vvSizeFieldStops=g.fieldStops)}if(r=m.color)p.vvColorEnabled=!0,this.vvColorValues.set(r.values),this.vvColors.set(r.colors);if(r=m.opacity)p.vvOpacityEnabled=!0,this.vvOpacityValues.set(r.values),this.vvOpacities.set(r.opacities);if(m=m.rotation)p.vvRotationEnabled=
!0,p.vvRotationType=m.type}};h._updateDotDensityInfo=function(m){var r=m.attributes;this.ddDotValue=m.dotValue;this.ddDotScale=m.referenceScale;this.ddDotSize=m.dotSize;this.ddDotBlending=m.dotBlendingEnabled;this.ddSeed=m.seed;for(let p=0;p<b.DOT_DENSITY_MAX_FIELDS;p++){const g=p>=r.length?new B([0,0,0,0]):r[p].color;f(this.ddColors,g,4*p)}for(r=0;8>r;r++)this.ddActiveDots[r]=r<m.attributes.length?1:0;f(this.ddBackgroundColor,m.backgroundColor)};D._createClass(l,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);
return l}();y.WGLRendererInfo=n;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../geometry/Point ../../../Viewpoint ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g){const q=new l({targetGeometry:new n}),u=[0,0];E=function(v){function z(w){w=v.call(this,w)||this;w._endTimer=null;w.animationManager=null;return w}y._inheritsLoose(z,v);var t=z.prototype;t.initialize=function(){this.pan=new r({navigation:this});this.rotate=new g({navigation:this});this.pinch=new p({navigation:this});this.zoomBox=new m({view:this.view,navigation:this})};t.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};
t.begin=function(){this._set("interacting",!0)};t.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};t.zoom=async function(w,x=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>w?this.zoomIn(x):this.zoomOut(x);this.setViewpoint(x,w,0,[0,0])};t.zoomIn=async function(w){var x=this.view;x=x.constraints.snapToNextScale(x.scale);return this._zoomToScale(x,w)};t.zoomOut=async function(w){var x=
this.view;x=x.constraints.snapToPreviousScale(x.scale);return this._zoomToScale(x,w)};t.setViewpoint=function(w,x,C,F){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,w,x,C,F);this.end()};t.setViewpointImmediate=function(w,x=0,C=[0,0],F=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,F,w,x,C)};t.continousRotateClockwise=function(){const w=this.get("view.viewpoint");this.animationManager.animateContinous(w,
x=>{h.rotateBy(x,x,-1)})};t.continousRotateCounterclockwise=function(){const w=this.get("view.viewpoint");this.animationManager.animateContinous(w,x=>{h.rotateBy(x,x,1)})};t.resetRotation=function(){this.view.rotation=0};t.continousPanLeft=function(){this._continuousPan([-10,0])};t.continousPanRight=function(){this._continuousPan([10,0])};t.continousPanUp=function(){this._continuousPan([0,10])};t.continousPanDown=function(){this._continuousPan([0,-10])};t.stop=function(){this.pan.stopMomentumNavigation();
this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};t._continuousPan=function(w){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,C=>{h.translateBy(C,C,w);this.view.constraints.constrainByGeometry(C)})};t._startTimer=function(w){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const x=performance.now()-this._lastEventTimestamp;250>x?this._endTimer=
this._startTimer(x):this._set("interacting",!1)},w)};t._getDefaultAnchor=function(){const {size:w,padding:{left:x,right:C,top:F,bottom:H}}=this.view;u[0]=.5*(w[0]-C+x);u[1]=.5*(w[1]-H+F);return u};t._zoomToScale=async function(w,x=this._getDefaultAnchor()){const {view:C}=this,{constraints:F,scale:H,viewpoint:J,size:K,padding:N}=C,R=F.canZoomInTo(w),I=F.canZoomOutTo(w);if(!(w<H&&!R||w>H&&!I))return h.padAndScaleAndRotateBy(q,J,w/H,0,x,K,N),F.constrainByGeometry(q),C.goTo(q,{animate:!0})};t._scaleRotateTranslateViewpoint=
function(w,x,C,F,H){var {view:J}=this;const {size:K,padding:N,constraints:R,scale:I,viewpoint:L}=J;var G=I*C;J=R.canZoomInTo(G);G=R.canZoomOutTo(G);if(1>C&&!J||1<C&&!G)C=1;h.translateBy(L,L,H);h.padAndScaleAndRotateBy(w,L,C,F,x,K,N);return R.constrainByGeometry(w)};return z}(f);D.__decorate([k.property()],E.prototype,"animationManager",void 0);D.__decorate([k.property({type:Boolean,readOnly:!0})],E.prototype,"interacting",void 0);D.__decorate([k.property()],E.prototype,"pan",void 0);D.__decorate([k.property()],
E.prototype,"pinch",void 0);D.__decorate([k.property()],E.prototype,"rotate",void 0);D.__decorate([k.property()],E.prototype,"view",void 0);D.__decorate([k.property()],E.prototype,"zoomBox",void 0);return E=D.__decorate([b.subclass("esri.views.2d.navigation.MapViewNavigation")],E)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../core/screenUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n){E=function(l){function h(r){r=l.call(this,r)||this;r._container=null;r._overlay=null;r._backgroundShape=null;r._boxShape=null;r._box={x:0,y:0,width:0,height:0};r._redraw=r._redraw.bind(y._assertThisInitialized(r));return r}y._inheritsLoose(h,l);var m=h.prototype;m.destroy=function(){this.view=null};m._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};m._update=function(r,p,g,q){this._box.x=r;this._box.y=p;this._box.width=g;
this._box.height=q;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};m._end=function(r,p,g,q,u){const v=this.view;r=v.toMap(n.createScreenPoint(r+.5*g,p+.5*q));g=Math.max(g/v.width,q/v.height);-1===u&&(g=1/g);this._destroyOverlay();this.navigation.end();v.goTo({center:r,scale:v.scale*g})};m._updateBox=function(r,p,g,q){const u=this._boxShape;u.setAttributeNS(null,"x",""+r);u.setAttributeNS(null,"y",""+p);u.setAttributeNS(null,"width",""+g);u.setAttributeNS(null,"height",""+q);u.setAttributeNS(null,
"class","esri-zoom-box__outline")};m._updateBackground=function(r,p,g,q){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(r,p,g,q,this.view.width,this.view.height))};m._createContainer=function(){const r=document.createElement("div");r.className="esri-zoom-box__container";this.view.root.appendChild(r);this._container=r};m._createOverlay=function(){var r=this.view.width,p=this.view.height;const g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M 0 0 L "+
r+" 0 L "+r+" "+p+" L 0 "+p+" Z");g.setAttributeNS(null,"class","esri-zoom-box__overlay-background");r=document.createElementNS("http://www.w3.org/2000/svg","rect");p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");p.setAttributeNS(null,"class","esri-zoom-box__overlay");p.appendChild(g);p.appendChild(r);this._container.appendChild(p);this._backgroundShape=g;this._boxShape=r;this._overlay=p};
m._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};m._toSVGPath=function(r,p,g,q,u,v){g=r+g;q=p+q;return"M 0 0 L "+u+" 0 L "+u+" "+v+" L 0 "+v+" ZM "+r+" "+p+" L "+r+" "+q+" L "+g+" "+q+" L "+g+" "+p+" Z"};m._handleDrag=function(r,p){var g=r.x,q=r.y,u=r.origin.x;const v=r.origin.y;let z;g>u?(z=u,u=g-u):(z=g,u-=g);q>v?(g=v,q-=v):(g=q,q=v-q);switch(r.action){case "start":this._start();
break;case "update":this._update(z,g,u,q);break;case "end":this._end(z,g,u,q,p)}r.stopPropagation()};m._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:r,y:p,width:g,height:q}=this._box;this._updateBox(r,p,g,q);this._updateBackground(r,p,g,q);this._rafId=requestAnimationFrame(this._redraw)}};y._createClass(h,[{key:"view",set:function(r){this._handles&&this._handles.forEach(p=>{p.remove()});this._handles=null;this._destroyOverlay();this._set("view",r);r&&(r.on("drag",["Shift"],
p=>this._handleDrag(p,1)),r.on("drag",["Shift","Ctrl"],p=>this._handleDrag(p,-1)))}}]);return h}(f);D.__decorate([k.property()],E.prototype,"navigation",void 0);D.__decorate([k.property()],E.prototype,"view",null);return E=D.__decorate([b.subclass("esri.views.2d.navigation.ZoomBox")],E)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../Viewpoint ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q){E=function(u){function v(t){var w=u.call(this,t)||this;w.animationTime=0;w.momentumEstimator=new q.PanPlanarMomentumEstimator(500,6,.92);w.momentum=null;w.tmpMomentum=m.create();w.momentumFinished=!1;w.viewpoint=new p({targetGeometry:new n,scale:0,rotation:0});w.watch("momentumFinished",x=>{x&&w.navigation.stop()});return w}y._inheritsLoose(v,u);var z=v.prototype;z.begin=function(t,w){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(w);
this.previousDrag=w};z.update=function(t,w){this.addToEstimator(w);let x=w.center.x,C=w.center.y;const F=this.previousDrag;x=F?F.center.x-x:-x;C=F?C-F.center.y:C;t.viewpoint=g.translateBy(this.viewpoint,t.viewpoint,[x||0,C||0]);this.previousDrag=w};z.end=function(t,w){this.addToEstimator(w);this.momentum=t.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(t);this.previousDrag=null;this.navigation.end()};z.addToEstimator=
function(t){var w=t.center.x;const x=t.center.y,C=h.createScreenPointArray(-w,x);w=m.fromValues(-w,x,0);this.momentumEstimator.add(C,w,.001*t.timestamp)};z.onAnimationUpdate=function(t){this.navigation.animationManager.animateContinous(t.viewpoint,(w,x)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);x*=.001;if(!this.momentumFinished){const C=this.momentum.valueDelta(this.animationTime,x);r.scale(this.tmpMomentum,this.momentum.direction,C);g.translateBy(w,w,this.tmpMomentum);
t.constraints.constrainByGeometry(w)}this.animationTime+=x})};z.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return v}(f);D.__decorate([k.property()],E.prototype,"momentumFinished",void 0);D.__decorate([k.property()],E.prototype,"viewpoint",void 0);D.__decorate([k.property()],E.prototype,"navigation",void 0);return E=D.__decorate([b.subclass("esri.views.2d.navigation.actions.Pan")],E)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3f64 ../../chunks/vec3 ./FilteredFiniteDifference ./Momentum".split(" "),
function(y,D,E,B,A,k){let c=function(b){function e(a,d,f,n,l){a=b.call(this,a,d,f)||this;a.sceneVelocity=n;a.direction=l;return a}D._inheritsLoose(e,b);e.prototype.value=function(a){return b.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return e}(k.Momentum);k=function(){function b(a=300,d=12,f=.84){this.minimumInitialVelocity=a;this.stopVelocity=d;this.friction=f;this.enabled=!0;this.time=new A.FilteredFiniteDifference(.6);this.screen=[new A.FilteredFiniteDifference(.4),new A.FilteredFiniteDifference(.4)];
this.scene=[new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6)];this.tmpDirection=E.create()}var e=b.prototype;e.add=function(a,d,f){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(f)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(d[0]),this.scene[1].update(d[1]),this.scene[2].update(d[2]),this.time.update(f))};e.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};e.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const d=this.screen[1].filteredDelta;a=Math.sqrt(a*a+d*d)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};e.createMomentum=function(a,d,f){B.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const n=B.length(this.tmpDirection);0<n&&B.scale(this.tmpDirection,this.tmpDirection,1/n);return new c(a,d,f,n/this.time.filteredDelta,this.tmpDirection)};return b}();y.PanPlanarMomentum=c;y.PanPlanarMomentumEstimator=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(y,D){let E=function(){function B(k){this.gain=k}var A=B.prototype;A.update=function(k){if(this.hasLastValue){const c=
this.computeDelta(k);this.updateDelta(c)}this.lastValue=k};A.reset=function(){this.filteredDelta=this.lastValue=void 0};A.computeDelta=function(k){return k-this.lastValue};A.updateDelta=function(k){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*k:k};D._createClass(B,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return B}();y.FilteredFiniteDifference=E;Object.defineProperty(y,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(y,D){let E=function(){function B(k,c,b){this._initialVelocity=k;this._stopVelocity=c;this._friction=b;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var A=B.prototype;A.isFinished=function(k){return k>this.duration};A.value=function(k){return this.valueFromInitialVelocity(this._initialVelocity,
k)};A.valueDelta=function(k,c){const b=this.value(k);return this.value(k+c)-b};A.valueFromInitialVelocity=function(k,c){c=Math.min(c,this.duration);const b=1-this.friction;return k*(b**c-1)/Math.log(b)};D._createClass(B,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return B}();y.Momentum=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../Viewpoint ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q){E=function(u){function v(t){var w=u.call(this,t)||this;w._animationTime=0;w._momentumFinished=!1;w._rotationMomentumEstimator=new g.RotationMomentumEstimator(.6,.15,.95);w._rotationDirection=1;w._zoomDirection=1;w._zoomMomentumEstimator=new q.ZoomMomentumEstimator;w._zoomOnly=null;w.zoomMomentum=null;w.rotateMomentum=null;w.viewpoint=new h({targetGeometry:new n,scale:0,rotation:0});w.watch("_momentumFinished",x=>{x&&w.navigation.stop()});return w}
y._inheritsLoose(v,u);var z=v.prototype;z.begin=function(t,w){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=w.angle;this._previousRadius=this._startRadius=w.radius;this._previousCenter=w.center;this._updateTimestamp=null;t.constraints.rotationEnabled&&this.addToRotateEstimator(0,w.timestamp);this.addToZoomEstimator(w,1)};z.update=function(t,w){null===this._updateTimestamp&&(this._updateTimestamp=
w.timestamp);const x=w.angle,C=w.radius,F=w.center,H=Math.abs(180*(x-this._startAngle)/Math.PI),J=Math.abs(C-this._startRadius),K=this._startRadius/C;if(this._previousRadius){const N=C/this._previousRadius;let R=180*(x-this._previousAngle)/Math.PI;this._rotationDirection=0<=R?1:-1;this._zoomDirection=1<=N?1:-1;t.constraints.rotationEnabled?(null===this._zoomOnly&&200<w.timestamp-this._updateTimestamp&&(this._zoomOnly=0<J-H),null===this._zoomOnly||this._zoomOnly?R=0:this.addToRotateEstimator(x-this._startAngle,
w.timestamp)):R=0;this.addToZoomEstimator(w,K);this.navigation.setViewpoint([F.x,F.y],1/N,R,[this._previousCenter.x-F.x,F.y-this._previousCenter.y])}this._previousAngle=x;this._previousRadius=C;this._previousCenter=F};z.end=function(t){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(t);this.navigation.end()};z.addToRotateEstimator=
function(t,w){this._rotationMomentumEstimator.add(t,.001*w)};z.addToZoomEstimator=function(t,w){this._zoomMomentumEstimator.add(w,.001*t.timestamp)};z.canZoomIn=function(t){const w=t.scale;t=t.constraints.effectiveMaxScale;return 0===t||w>t};z.canZoomOut=function(t){const w=t.scale;t=t.constraints.effectiveMinScale;return 0===t||w<t};z.onAnimationUpdate=function(t){this.navigation.animationManager.animateContinous(t.viewpoint,(w,x)=>{var C=!this.canZoomIn(t)&&1<this._zoomDirection||!this.canZoomOut(t)&&
1>this._zoomDirection,F=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);C=C||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);x*=.001;this._momentumFinished=F&&C;if(!this._momentumFinished){F=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,x))*this._rotationDirection*180/Math.PI:0;C=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,x)):1;const J=m.create();var H=m.create();if(this._previousCenter){r.set(J,
this._previousCenter.x,this._previousCenter.y);p.getPaddingScreenTranslation(H,t.size,t.padding);r.add(J,J,H);const {constraints:K,scale:N}=t;H=N*C;1>C&&!K.canZoomInTo(H)?(C=N/K.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<C&&!K.canZoomOutTo(H)&&(C=N/K.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);p.scaleAndRotateBy(w,t.viewpoint,C,F,J,t.size);t.constraints.constrainByGeometry(w)}}this._animationTime+=x})};z.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return v}(f);D.__decorate([k.property()],E.prototype,"_momentumFinished",void 0);D.__decorate([k.property()],E.prototype,"viewpoint",void 0);D.__decorate([k.property()],E.prototype,"navigation",void 0);return E=D.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],E)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(y,D,E){E=function(B){function A(k=3,c=.01,b=.95,e=12){return B.call(this,k,c,b,e)||this}D._inheritsLoose(A,B);A.prototype.add=function(k,c){if(this.value.hasLastValue){const b=this.value.lastValue;for(k-=b;k>Math.PI;)k-=2*Math.PI;for(;k<-Math.PI;)k+=2*Math.PI;k=b+k}B.prototype.add.call(this,k,c)};return A}(E.MomentumEstimator);y.RotationMomentumEstimator=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(y,D,E,B){let A=function(){function k(b=2.5,e=.01,a=.95,d=12){this.minimumInitialVelocity=b;this.stopVelocity=e;this.friction=a;this.maxVelocity=d;this.enabled=!0;this.value=new E.FilteredFiniteDifference(.8);this.time=new E.FilteredFiniteDifference(.3)}var c=k.prototype;c.add=function(b,e){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(e))return;if(this.value.hasFilteredDelta){const a=this.value.computeDelta(b);
0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(e);this.value.update(b)}};c.reset=function(){this.value.reset();this.time.reset()};c.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let b=this.value.filteredDelta/this.time.filteredDelta;b=D.clamp(b,-this.maxVelocity,this.maxVelocity);return Math.abs(b)<this.minimumInitialVelocity?null:this.createMomentum(b,this.stopVelocity,this.friction)};c.createMomentum=function(b,e,a){return new B.Momentum(b,
e,a)};return k}();y.MomentumEstimator=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(y,D,E,B){let A=function(k){function c(e,a,d){return k.call(this,e,a,d)||this}D._inheritsLoose(c,k);var b=c.prototype;b.value=function(e){e=k.prototype.value.call(this,e);return Math.exp(e)};b.valueDelta=function(e,a){const d=k.prototype.value.call(this,
e);e=k.prototype.value.call(this,e+a);return Math.exp(e-d)};return c}(E.Momentum);E=function(k){function c(e=2.5,a=.01,d=.95,f=12){return k.call(this,e,a,d,f)||this}D._inheritsLoose(c,k);var b=c.prototype;b.add=function(e,a){k.prototype.add.call(this,Math.log(e),a)};b.createMomentum=function(e,a,d){return new A(e,a,d)};return c}(B.MomentumEstimator);y.ZoomMomentum=A;y.ZoomMomentumEstimator=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../Viewpoint ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../../viewpointUtils".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p){const g=m.create(),q=m.create();E=function(u){function v(t){t=u.call(this,t)||this;t._previousCenter=m.create();t.viewpoint=new h({targetGeometry:new n,scale:0,rotation:0});return t}y._inheritsLoose(v,u);var z=v.prototype;z.begin=function(t,w){this.navigation.begin();r.set(this._previousCenter,w.center.x,w.center.y)};z.update=function(t,w){const {state:{size:x,padding:C}}=t;r.set(g,w.center.x,w.center.y);p.getAnchor(q,x,C);t.viewpoint=p.rotateBy(this.viewpoint,
t.state.paddedViewState.viewpoint,p.angleBetween(q,this._previousCenter,g));r.copy(this._previousCenter,g)};z.end=function(){this.navigation.end()};return v}(f);D.__decorate([k.property()],E.prototype,"viewpoint",void 0);D.__decorate([k.property()],E.prototype,"navigation",void 0);return E=D.__decorate([b.subclass("esri.views.2d.actions.Rotate")],E)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/urlUtils ../../../core/promiseUtils ../../../core/mathUtils ../../../request ../../../core/Handles ../../../core/watchUtils ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../engine/DisplayObject ../../magnifier/resources ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m,r,p,g,q,u){return function(v){function z(){var w=v.call(this)||this;w._handles=new c;w._resourcePixelRatio=1;w.visible=!1;return w}y._inheritsLoose(z,v);var t=z.prototype;t.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};t.doRender=function(w){const x=w.context;if(!this._resourcesTask)this._reloadResources();else if(w.drawPhase===q.WGLDrawPhase.MAP&&
this._canRender()){this._updateResources(w);var C=this._magnifier;if(!D.isNone(C.position)){var F=w.pixelRatio,H=C.size*F,J=Math.ceil(1/C.factor*H);this._readbackTexture.resize(J,J);var {size:K}=w.state;w=F*K[0];K=F*K[1];var N=.5*J,R=.5*J,I=A.clamp(F*C.position.x,N,w-N-1),L=A.clamp(K-F*C.position.y,R,K-R-1);x.setBlendingEnabled(!0);N=I-N;R=L-R;var G=this._readbackTexture;x.bindTexture(G,0);x.gl.copyTexImage2D(G.descriptor.target,0,G.descriptor.pixelFormat,N,R,J,J,0);var M=(J=null==(M=this.background)?
void 0:M.color)?[J.a*J.r/255,J.a*J.g/255,J.a*J.b/255,J.a]:[1,1,1,1];J=-1+(I+C.offset.x*F)/w*2;F=-1+(L-C.offset.y*F)/K*2;w=H/w*2;H=H/K*2;K=this._program;x.bindVAO(this._vertexArrayObject);x.bindTexture(this._overlayTexture,6);x.bindTexture(this._maskTexture,7);x.bindProgram(K);K.setUniform4fv("u_background",M);K.setUniform1i("u_readbackTexture",0);K.setUniform1i("u_overlayTexture",6);K.setUniform1i("u_maskTexture",7);K.setUniform4f("u_drawPos",J,F,w,H);K.setUniform1i("u_maskEnabled",C.maskEnabled?
1:0);K.setUniform1i("u_overlayEnabled",C.overlayEnabled?1:0);x.setStencilTestEnabled(!1);x.setColorMask(!0,!0,!0,!0);x.drawArrays(5,0,4);x.bindVAO()}}};t._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};t._reloadResources=function(){this._resourcesTask&&this._resourcesTask.abort();const w=D.isSome(this._magnifier)?this._magnifier.maskUrl:null,x=D.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=B.createTask(async C=>{const F=D.isNone(w)||D.isNone(x)?
g.loadMagnifierResources(C):null,H=D.isSome(w)?k(w,{responseType:"image",signal:C}).then(N=>N.data):F.then(N=>N.mask);C=D.isSome(x)?k(x,{responseType:"image",signal:C}).then(N=>N.data):F.then(N=>N.overlay);const [J,K]=await Promise.all([H,C]);this.mask=J;this.overlay=K;this._disposeRenderResources();this.requestRender()})};t._disposeRenderResources=function(){this._readbackTexture=D.disposeMaybe(this._readbackTexture);this._overlayTexture=D.disposeMaybe(this._overlayTexture);this._maskTexture=D.disposeMaybe(this._maskTexture);
this._vertexArrayObject=D.disposeMaybe(this._vertexArrayObject);this._program=D.disposeMaybe(this._program)};t._updateResources=function(w){w.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var x=w.context;this._resourcePixelRatio=w.pixelRatio;var C=Math.ceil(this._magnifier.size*w.pixelRatio);this._program=u.createMagnifierProgram(x);var F=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new f(x,u.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",
count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:a.createVertex(x,35044,F)});this.overlay.width=C;this.overlay.height=C;this._overlayTexture=new d(x,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,preMultiplyAlpha:E.isSVG(this.overlay.src)&&w.driverTestResult.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);this.mask.width=C;this.mask.height=C;this._maskTexture=new d(x,{target:3553,pixelFormat:6406,internalFormat:6406,
dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);w=1/this._magnifier.factor;this._readbackTexture=new d(x,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:Math.ceil(w*C),height:Math.ceil(w*C)})}};y._createClass(z,[{key:"background",get:function(){return this._background},set:function(w){this._background=w;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(w){this._magnifier=
w;this._handles.removeAll();this._handles.add([b.init(w,"version",()=>{this.visible=w.visible&&D.isSome(w.position)&&0<w.size;this.requestRender()}),w.watch(["mask","overlay"],()=>this._reloadResources()),w.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return z}(p.DisplayObject)})},"esri/views/magnifier/resources":function(){define(["require","exports","../../core/promiseUtils","../../support/requestImageUtils"],function(y,D,E,B){D.loadMagnifierResources=async function(A){var k=
new Promise(function(b,e){y(["./mask-svg"],function(a){b(Object.freeze({__proto__:null,"default":a}))},e)}),c=new Promise(function(b,e){y(["./overlay-svg"],function(a){b(Object.freeze({__proto__:null,"default":a}))},e)});k=B.requestImage((await k).default,{signal:A});c=B.requestImage((await c).default,{signal:A});c={mask:await k,overlay:await c};E.throwIfAborted(A);return c};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../request"],
function(y,D){y.requestImage=async function(E,B){({data:E}=await D(E,{responseType:"image",...B}));return E};Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f){const n={shaders:{vertexShader:f.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:f.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};y.createMagnifierProgram=function(l){return b.createProgram(l,n)};y.magnifierProgramTemplate=n;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],function(y,D){y.mat4=D.mat4;Object.defineProperty(y,"__esModule",{value:!0})})},
"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(y,D){y.mat4f32=D.mat4f32;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(y,D){y.vec3f32=D.vec3f32;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/chunks/vec3f32":function(){define(["exports"],function(y){function D(){return new Float32Array(3)}function E(r){const p=new Float32Array(3);
p[0]=r[0];p[1]=r[1];p[2]=r[2];return p}function B(r,p,g){const q=new Float32Array(3);q[0]=r;q[1]=p;q[2]=g;return q}function A(r,p){return new Float32Array(r,p,3)}function k(){return D()}function c(){return B(1,1,1)}function b(){return B(1,0,0)}function e(){return B(0,1,0)}function a(){return B(0,0,1)}const d=D(),f=c(),n=b(),l=e(),h=a();var m=Object.freeze({__proto__:null,create:D,clone:E,fromValues:B,createView:A,zeros:k,ones:c,unitX:b,unitY:e,unitZ:a,ZEROS:d,ONES:f,UNIT_X:n,UNIT_Y:l,UNIT_Z:h});y.ONES=
f;y.UNIT_X=n;y.UNIT_Y=l;y.UNIT_Z=h;y.ZEROS=d;y.clone=E;y.create=D;y.createView=A;y.fromValues=B;y.ones=c;y.unitX=b;y.unitY=e;y.unitZ=a;y.vec3f32=m;y.zeros=k})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(y,D){y.vec4f32=D.vec4f32;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ./DisplayObject ./ImageryBitmapSource".split(" "),
function(y,D,E,B,A,k,c,b,e,a,d,f,n,l,h,m){function r(g){const q=document.createElement("canvas");q.width=g.width;q.height=g.height;g.render(q.getContext("2d"));return q}function p(g,q,u){const v={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};q&&u&&(v.width=q,v.height=u);return new b(g,v)}k=function(g){function q(v=null,z,t=!0){var w=g.call(this)||this;w.requestRenderOnSourceChangedEnabled=t;w._textureInvalidated=!0;w.stencilRef=0;w.coordScale=[1,1];w._height=void 0;
w.pixelRatio=1;w.resolution=0;w.rotation=0;w._source=null;w._width=void 0;w.x=0;w.y=0;w.transforms={dvs:B.create()};w.blendFunction=z;w.source=v;w.requestRender=w.requestRender.bind(D._assertThisInitialized(w));return w}D._inheritsLoose(q,g);var u=q.prototype;u.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};u.beforeRender=function(v){g.prototype.beforeRender.call(this,v);this.updateTexture(v)};u.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=
!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};u.setTransform=function(v){const z=E.identity(this.transforms.dvs),[t,w]=v.toScreenNoRotation([0,0],this.x,this.y);var x=this.resolution/this.pixelRatio/v.resolution;const C=x*this.width;x*=this.height;const F=Math.PI*this.rotation/180;E.translate(z,z,A.fromValues(t,w));E.translate(z,z,A.fromValues(C/2,x/2));E.rotate(z,z,-F);E.translate(z,z,A.fromValues(-C/2,-x/2));E.scaleByVec2(z,z,A.fromValues(C,x));E.multiply(this.transforms.dvs,
v.displayViewMat3,z)};u.setSamplingProfile=function(v){this._texture&&(v.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(v.samplingMode))};u.bind=function({context:v},z){this._texture&&v.bindTexture(this._texture,z)};u.updateTexture=function({context:v}){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?p(v,this.sourceWidth,this.sourceHeight):p(v)),(v=this.source)?(this._texture.resize(this.sourceWidth,
this.sourceHeight),v&&"render"in v?v instanceof m?(v=v.getRenderedRasterPixels(),this._texture.setData(v.renderedRasterPixels)):this._texture.setData(r(v)):!v||"render"in v||this._texture.setData(v),this.ready()):this._texture.setData(null));else{var z;null==(z=this._texture)?void 0:z.dispose();this._texture=null}};u.onAttach=function(){this.invalidateTexture()};u.onDetach=function(){this.invalidateTexture()};D._createClass(q,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||
this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(v){this._height=v}},{key:"source",get:function(){return this._source},set:function(v){this._source=v;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:
this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(v){this._width=v}}]);return q}(h.DisplayObject);y.Bitmap=k;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(y){return function(){function D(B,A,k){this.pixelBlock=B;this.extent=A;this.originalPixelBlock=k}var E=D.prototype;E.render=function(B){var A=this.pixelBlock;
if(A){var k=this.filter({pixelBlock:A});A=k.pixelBlock.getAsRGBA();k=B.createImageData(k.pixelBlock.width,k.pixelBlock.height);k.data.set(A);B.putImageData(k,0,0)}};E.getRenderedRasterPixels=function(){const B=this.filter({pixelBlock:this.pixelBlock});return{width:B.pixelBlock.width,height:B.pixelBlock.height,renderedRasterPixels:new Uint8Array(B.pixelBlock.getAsRGBA().buffer)}};y._createClass(D,[{key:"width",get:function(){return this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return this.pixelBlock?
this.pixelBlock.height:0}}]);return D}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./webgl/enums","./brushes","./webgl/WGLContainer"],function(y,D,E,B,A){A=function(k){function c(){return k.apply(this,arguments)||this}D._inheritsLoose(c,k);c.prototype.prepareRenderPasses=function(b){const e=b.registerRenderPass({name:"bitmap",brushes:[B.brushes.bitmap],target:()=>this.children,drawPhase:E.WGLDrawPhase.MAP});return[...k.prototype.prepareRenderPasses.call(this,
b),e]};D._createClass(c,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(b=>"additive"===b.blendFunction)}}]);return c}(A);y.BitmapContainer=A;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./webgl/TiledDisplayObject","./Bitmap"],function(y,D,E,B){E=function(A){function k(b,e,a,d=null){var f=A.call(this,b,e,a,a)||this;f.bitmap=new B.Bitmap(d,"standard",!1);f.bitmap.coordScale=
a;f.bitmap.once("isReady",()=>f.ready());return f}D._inheritsLoose(k,A);var c=k.prototype;c.destroy=function(){A.prototype.destroy.call(this);this.bitmap.destroy()};c.beforeRender=function(b){A.prototype.beforeRender.call(this,b);this.bitmap.beforeRender(b)};c.afterRender=function(b){A.prototype.afterRender.call(this,b);this.bitmap.afterRender(b)};c.setTransform=function(b,e){A.prototype.setTransform.call(this,b,e);this.bitmap.transforms.dvs=this.transforms.dvs};c.onAttach=function(){this.bitmap.stage=
this.stage};c.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};D._createClass(k,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(b){this.bitmap.stencilRef=b}}]);return k}(E.TiledDisplayObject);y.BitmapTile=E;Object.defineProperty(y,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./webgl/enums ./brushes ./webgl/TileContainer ./BitmapTile".split(" "),
function(y,D,E,B,A,k,c){k=function(b){function e(){return b.apply(this,arguments)||this}D._inheritsLoose(e,b);var a=e.prototype;a.createTile=function(d){const f=this._tileInfoView.getTileBounds(E.create(),d);return new c.BitmapTile(d,f,this._tileInfoView.tileInfo.size)};a.destroyTile=function(){};a.prepareRenderPasses=function(d){const f=d.registerRenderPass({name:"bitmap (tile)",brushes:[A.brushes.bitmap],target:()=>this.children.map(n=>n.bitmap),drawPhase:B.WGLDrawPhase.MAP});return[...b.prototype.prepareRenderPasses.call(this,
d),f]};a.doRender=function(d){this.visible&&d.drawPhase===B.WGLDrawPhase.MAP&&b.prototype.doRender.call(this,d)};D._createClass(e,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(d=>"additive"===d.bitmap.blendFunction)}}]);return e}(k["default"]);y.BitmapTileContainer=k;Object.defineProperty(y,"__esModule",{value:!0})})},"*noref":1}});
define("exports ./LabelManager ./engine/Stage ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(y,D,E,B,A,k,c){y.LabelManager=D;y.Stage=E.Stage;y.GraphicsView2D=B;y.GraphicContainer=A;y.MapViewNavigation=k;y.MagnifierView2D=c;Object.defineProperty(y,"__esModule",{value:!0})});