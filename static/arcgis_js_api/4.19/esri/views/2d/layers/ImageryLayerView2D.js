// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/layers/ImageryLayerView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../layers/support/commonProperties ../../tasks/support/Query ./support/popupUtils".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q){F=m=>{m=function(n){function a(){var e=n.apply(this,arguments)||this;e.view=null;return e}y._inheritsLoose(a,n);var d=a.prototype;d.fetchPopupFeatures=async function(e,g){const {layer:p}=this;if(!e)throw new H("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:p});var {popupEnabled:l}=p;g=q.getFetchPopupTemplate(p,g);if(!l||!I.isSome(g))throw new H("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",
{popupEnabled:l,popupTemplate:g});const r=await g.getRequiredFields();l=new h;l.geometry=e;l.outFields=r;l.outSpatialReference=e.spatialReference;e=this.view.resolution;e="2d"===this.view.type?new c(e,e,this.view.spatialReference):new c(.5*e,.5*e,this.view.spatialReference);const {returnTopmostRaster:t,showNoDataRecords:u}=g.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1};return p.queryVisibleRasters(l,{returnDomainValues:!0,returnTopmostRaster:t,pixelSize:e,showNoDataRecords:u}).then(v=>
v)};d.canResume=function(){var e;return!n.prototype.canResume.call(this)||null!=(e=this.timeExtent)&&e.isEmpty?!1:!0};return a}(m);w.__decorate([J.property()],m.prototype,"layer",void 0);w.__decorate([J.property()],m.prototype,"suspended",void 0);w.__decorate([J.property(f.combinedViewLayerTimeExtentProperty)],m.prototype,"timeExtent",void 0);w.__decorate([J.property()],m.prototype,"view",void 0);return m=w.__decorate([K.subclass("esri.views.layers.ImageryLayerView")],m)};A.ImageryLayerView=F;A.default=
F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../core/maybe","../../../layers/support/fieldUtils"],function(A,y,w){A.getFetchPopupTemplate=function(F,I){return F.popupTemplate?F.popupTemplate:y.isSome(I)&&I.defaultPopupTemplateEnabled&&y.isSome(F.defaultPopupTemplate)?F.defaultPopupTemplate:null};A.getRequiredFields=async function(F,I=F.popupTemplate){if(!y.isSome(I))return[];const C=await I.getRequiredFields(F.fields);
({lastEditInfoEnabled:I}=I);const {objectIdField:G,typeIdField:J,globalIdField:x,relationships:K}=F;if(C.includes("*"))return["*"];I=I?await w.getFeatureEditFields(F):[];const H=w.fixFields(F.fields,[...C,...I]);J&&H.push(J);H&&G&&w.hasField(F.fields,G)&&-1===H.indexOf(G)&&H.push(G);H&&x&&w.hasField(F.fields,x)&&-1===H.indexOf(x)&&H.push(x);K&&K.forEach(D=>{({keyField:D}=D);H&&D&&w.hasField(F.fields,D)&&-1===H.indexOf(D)&&H.push(D)});return H};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../layers/support/ClipArea ../../layers/support/ClipRect ../engine/Container ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q,m,n){const a=b.ofType({key:"type",base:f,typeMap:{rect:h,path:n,geometry:m}});A.LayerView2DMixin=d=>{d=function(e){function g(){var l=e.apply(this,arguments)||this;l.clips=new a;l.moving=!1;l.attached=!1;l.lastUpdateId=-1;l.updateRequested=!1;return l}y._inheritsLoose(g,e);var p=g.prototype;p.initialize=function(){var l;this.container||(this.container=new q.Container);this.container.fadeTransitionEnabled=!0;this.container.opacity=0;this.container.clips=
this.clips;this.handles.add([c.init(this,"suspended",r=>{this.container&&(this.container.visible=!r);this.view&&!r&&this.updateRequested&&this.view.requestUpdate()},!0),c.init(this,["layer.opacity","container"],()=>{if(this.container){var r,t;this.container.opacity=null!=(r=null==(t=this.layer)?void 0:t.opacity)?r:1}},!0),c.init(this,["layer.blendMode"],r=>{this.container&&(this.container.blendMode=r)},!0),c.init(this,["layer.effect"],r=>{this.container&&(this.container.effect=r)},!0),this.clips.on("change",
()=>{this.container.clips=this.clips;this.notifyChange("clips")})]);null!=(l=this.view)&&l.whenLayerView?this.view.whenLayerView(this.layer).then(r=>{r!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})};p.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.handles.remove("initialize");this.updateRequested=!1};p.isVisibleAtScale=
function(l){var r=!0,t=this.layer;const u=t.minScale;t=t.maxScale;if(null!=u&&null!=t){r=!u;let v=!t;!r&&l<=u&&(r=!0);!v&&l>=t&&(v=!0);r=r&&v}return r};p.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};p.processUpdate=function(l){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",l),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(l)))};p.isUpdating=
function(){return!1};p.isRendering=function(){return!1};p.canResume=function(){return e.prototype.canResume.call(this)?this.isVisibleAtScale(this.view.scale):!1};y._createClass(g,[{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}}]);return g}(d);w.__decorate([G.property({type:a,set(e){e=k.referenceSetter(e,this._get("clips"),a);this._set("clips",e)}})],d.prototype,"clips",void 0);w.__decorate([G.property()],d.prototype,"moving",void 0);
w.__decorate([G.property()],d.prototype,"attached",void 0);w.__decorate([G.property()],d.prototype,"container",void 0);w.__decorate([G.property()],d.prototype,"suspended",void 0);w.__decorate([G.property({readOnly:!0})],d.prototype,"updateParameters",void 0);w.__decorate([G.property()],d.prototype,"updateRequested",void 0);w.__decorate([G.property()],d.prototype,"updating",null);w.__decorate([G.property()],d.prototype,"view",void 0);return d=w.__decorate([x.subclass("esri.views.2d.layers.LayerView2D")],
d)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/JSONSupport".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D){w=function(b){function k(){return b.apply(this,arguments)||this}A._inheritsLoose(k,b);return k}(D.JSONSupport);return w=y.__decorate([J.subclass("esri.views.layers.support.ClipArea")],w)})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ./ClipArea".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D){var b;w=b=function(k){function c(){var f=k.apply(this,arguments)||this;f.type="rect";f.left=null;f.right=null;f.top=null;f.bottom=null;return f}A._inheritsLoose(c,k);c.prototype.clone=function(){return new b({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};A._createClass(c,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return c}(D);y.__decorate([C.property({type:[Number,String],json:{write:!0}})],w.prototype,"left",void 0);
y.__decorate([C.property({type:[Number,String],json:{write:!0}})],w.prototype,"right",void 0);y.__decorate([C.property({type:[Number,String],json:{write:!0}})],w.prototype,"top",void 0);y.__decorate([C.property({type:[Number,String],json:{write:!0}})],w.prototype,"bottom",void 0);y.__decorate([C.property({readOnly:!0})],w.prototype,"version",null);return w=b=y.__decorate([J.subclass("esri.views.layers.support.ClipRect")],w)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../geometry/Geometry ../../../geometry/Extent ../../../geometry/Polygon ../../../geometry/support/jsonUtils ../../../geometry ./ClipArea".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h){var q;w={base:D,key:"type",typeMap:{extent:b,polygon:k}};h=q=function(m){function n(){var a=m.apply(this,arguments)||this;a.type="geometry";a.geometry=null;return a}A._inheritsLoose(n,m);n.prototype.clone=function(){return new q({geometry:this.geometry.clone()})};A._createClass(n,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return n}(h);y.__decorate([C.property({types:w,json:{read:c.fromJSON,write:!0}})],h.prototype,"geometry",void 0);
y.__decorate([C.property({readOnly:!0})],h.prototype,"version",null);return h=q=y.__decorate([J.subclass("esri.views.layers.support.Geometry")],h)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ./ClipArea".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D){w=function(b){function k(){var c=b.apply(this,arguments)||this;c.type="path";c.path=[];return c}A._inheritsLoose(k,b);A._createClass(k,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return k}(D);y.__decorate([C.property({type:[[[Number]]],json:{write:!0}})],w.prototype,"path",void 0);y.__decorate([C.property({readOnly:!0})],w.prototype,"version",null);return w=y.__decorate([J.subclass("esri.views.layers.support.Path")],w)})},"esri/views/2d/layers/imagery/ImageryGraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/decorators/enumeration ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/promiseUtils ../../../../core/Accessor ../../../../geometry/Extent ../../../../core/screenUtils ../../../../request ../../../../Graphic ../../../../layers/support/rasterFunctions/vectorFieldUtils ../../../../support/GraphicsCollection ../../../../layers/support/rasterFunctions/rasterProjectionHelper ../../engine/Container ../graphics/GraphicsView2D ../graphics/GraphicContainer".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q,m,n,a,d,e){const g=F.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D");w=function(p){function l(){var t=p.apply(this,arguments)||this;t.attached=!1;t.container=new a.Container;t.updateRequested=!1;t._graphicsView=null;t._projectFullExtentPromise=null;t.type="Graphics";t._graphics=new m["default"];t._updateGraphics=D.debounce(async(u,v)=>{if(u.stationary){var B=u.state,z=new k({xmin:B.extent.xmin,ymin:B.extent.ymin,xmax:B.extent.xmax,ymax:B.extent.ymax,
spatialReference:B.spatialReference}),E=u.state.size[0],L=u.state.size[1];B={};B.timeExtent=t.timeExtent;B.requestAsImageElement=!1;B.signal=v;null==t._projectFullExtentPromise&&(t._projectFullExtentPromise=t._getProjectedFullExtent(z.spatialReference));v="vector-field"===t.layer.renderer.type?t.layer.renderer.symbolTileSize:50;var O=await t._projectFullExtentPromise;z=q.snapImageToSymbolTile(z,E,L,v,O);B=await t.layer.fetchImage(z.extent,z.width,z.height,B);E=t.layer.renderer;if("vector-field"===
E.type){t._pixelData={extent:z.extent,pixelBlock:B.pixelData.pixelBlock};const M=await E.getGraphicsFromPixelData(B.pixelData,"vector-uv"===t.layer.rasterInfo.dataType);t._graphicsView.update(u);await D.after(0).then(()=>{t._graphics.set("items",M)})}}});return t}A._inheritsLoose(l,p);var r=l.prototype;r.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.updateRequested=!1};r.update=function(t){this._updateGraphics(t).catch(u=>{D.isAbortError(u)||g.error(u)})};r.hitTest=function(t,
u){t=this.view.toMap(c.createScreenPoint(t,u));return Promise.resolve(new h({attributes:{},geometry:t,layer:this.layer}))};r.attach=function(){this._graphicsView=new d({view:this.view,graphics:this._graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new e(this.view.featuresTilingScheme)});this.attached=!0};r.detach=function(){this._graphics.destroy();this._graphicsView.destroy();this.container.removeChild(this._graphicsView.container);this._graphicsView=null};r.moveStart=function(){};
r.viewChange=function(){};r.moveEnd=function(){};r.install=function(t){this.container.addChild(this._graphicsView.container);t.addChild(this.container)};r.uninstall=function(t){this.container.removeChild(this._graphicsView.container);t.removeChild(this.container)};r.isUpdating=function(){return this._graphicsView.updating||this.updateRequested};r.getPixelData=function(){return this.updating?null:this._pixelData};r.redraw=function(){};r.requestUpdate=function(){this.updateRequested||(this.updateRequested=
!0,this.view.requestUpdate())};r._getProjectedFullExtent=async function(t){try{return await n.projectExtent(this.layer.fullExtent,t)}catch(u){try{const v=(await f(this.layer.url,{query:{option:"footprints",outSR:t.wkid||JSON.stringify(t.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return v?k.fromJSON(v):null}catch{return null}}};A._createClass(l,[{key:"updating",get:function(){return!this.attached||this.isUpdating()}}]);return l}(b);y.__decorate([C.property()],w.prototype,
"attached",void 0);y.__decorate([C.property()],w.prototype,"container",void 0);y.__decorate([C.property()],w.prototype,"layer",void 0);y.__decorate([C.property()],w.prototype,"timeExtent",void 0);y.__decorate([C.property()],w.prototype,"view",void 0);y.__decorate([C.property()],w.prototype,"updateRequested",void 0);y.__decorate([C.property()],w.prototype,"updating",null);y.__decorate([G.enumeration({graphics:"Graphics"})],w.prototype,"type",void 0);return w=y.__decorate([J.subclass("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],
w)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],function(A,y,w){function F(x,K="geographic"){const [H,D]=x;x=Math.sqrt(H*H+D*D);let b=Math.atan2(D,H)*C;b=(360+b)%360;"geographic"===K&&(b=(450-b)%360);return[x,b]}function I(x,K="geographic"){let H=x[1];"geographic"===K&&(H=(450-H)%360);H%=360;x=x[0];return[x*Math.cos(H/C),x*Math.sin(H/C)]}const C=180/Math.PI,G=function(x){return x&&"esri.layers.support.PixelBlock"===x.declaredClass&&
x.pixels&&0<x.pixels.length},J=new Map;J.set("meter-per-second",1);J.set("kilometer-per-hour",.277778);J.set("knots",.514444);J.set("feet-per-second",.3048);J.set("mile-per-hour",.44704);A.convertVectorFieldData=function(x,K,H="geographic",D=1){if(!G(x))return x;const {pixels:b,width:k,height:c}=x;var f=k*c;const h=b[0],q=b[1],m=w.createEmptyBand(x.pixelType,f);f=w.createEmptyBand(x.pixelType,f);let n=0;for(let a=0;a<c;a++)for(let d=0;d<k;d++)"vector-uv"===K?([m[n],f[n]]=F([h[n],q[n]],H),m[n]*=D):
([m[n],f[n]]=I([h[n],q[n]],H),m[n]*=D,f[n]*=D),n++;x=new w({pixelType:x.pixelType,width:x.width,height:x.height,mask:x.mask,validPixelCount:x.validPixelCount,maskIsAlpha:x.maskIsAlpha,pixels:[m,f]});x.updateStatistics();return x};A.convertVectorFieldUnit=function(x,K,H=1){if(1===H||!G(x))return x;x=x.clone();const {pixels:D,width:b,height:k}=x,c=D[0],f=D[1];let h=0;for(let q=0;q<k;q++)for(let m=0;m<b;m++)"vector-uv"===K?(c[h]*=H,f[h]*=H):c[h]*=H,h++;x.updateStatistics();return x};A.getUnitConversionFactor=
function(x,K){return J.get(x)/J.get(K)||1};A.isValidPixelBlock=G;A.snapImageToSymbolTile=function(x,K,H,D,b){if(!y.isSome(b)||!b.spatialReference.equals(x.spatialReference))return{extent:x,width:K,height:H};const k=b.xmin;b=b.ymax;D=Math.max(D||0,30);K=((x.xmax-x.xmin)/Math.ceil(1/D*K)+(x.ymax-x.ymin)/Math.ceil(1/D*H))/2;x.xmin=k+Math.floor((x.xmin-k)/K)*K;x.xmax=k+Math.ceil((x.xmax-k)/K)*K;x.ymin=b+Math.floor((x.ymin-b)/K)*K;x.ymax=b+Math.ceil((x.ymax-b)/K)*K;return{extent:x,width:Math.round(x.width/
K),height:Math.round(x.height/K)}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/lang ../../core/maybe ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/JSONSupport".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c){var f;const h=C.getLogger("esri.layers.support.PixelBlock");w=f=function(q){function m(a){a=q.call(this,a)||this;a.width=null;a.height=null;a.pixelType="f32";a.validPixelCount=null;a.mask=null;a.maskIsAlpha=!1;a.pixels=null;a.statistics=null;return a}A._inheritsLoose(m,q);m.createEmptyBand=function(a,d){return new (f.getPixelArrayConstructor(a))(d)};m.getPixelArrayConstructor=function(a){let d;switch(a){case "u1":case "u2":case "u4":case "u8":d=Uint8Array;break;
case "u16":d=Uint16Array;break;case "u32":d=Uint32Array;break;case "s8":d=Int8Array;break;case "s16":d=Int16Array;break;case "s32":d=Int32Array;break;case "u32":d=Uint32Array;break;case "f32":d=Float32Array;break;case "f64":d=Float64Array;break;case "c64":case "c128":case "unknown":d=Float32Array}return d};var n=m.prototype;n.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};n.getPlaneCount=function(){return this.pixels&&this.pixels.length};n.addData=function(a){if(!a.pixels||a.pixels.length!==this.width*this.height)throw new H("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(a.pixels);this.statistics.push(a.statistics||{minValue:null,maxValue:null})};n.getAsRGBA=function(){const a=new ArrayBuffer(this.width*
this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};n.getAsRGBAFloat=function(){const a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};n.updateStatistics=function(){this.statistics=this.pixels.map(e=>this._calculateBandStatistics(e,this.mask));const a=this.mask;let d=0;if(a)for(let e=0;e<a.length;e++)a[e]&&d++;else d=
this.width*this.height;this.validPixelCount=d};n.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){switch(a){case "u8":var d=[0,255];break;case "u16":d=[0,65535];break;case "u32":d=[0,4294967295];break;case "s8":d=[-128,127];break;case "s16":d=[-32768,32767];break;case "s32":d=[-2147483648,2147483647];break;default:d=[-3.4*1E39,3.4*1E39]}var [e,g]=d;d=this.pixels;var p=this.width*this.height,l=d.length,r=[];for(let B=0;B<l;B++){var t=f.createEmptyBand(a,p);var u=d[B];for(let z=0;z<p;z++){var v=u[z];t[z]=
v>g?g:v<e?e:v}r.push(t)}this.pixels=r;this.pixelType=a}};n.extractBands=function(a){if(I.isNone(a)||0===a.length||null==this.pixels||0===this.pixels.length)return this;var d=this.pixels.length;const e=a.some(g=>g>=this.pixels.length);d=d===a.length&&!a.some((g,p)=>g!==p);return e||d?this:new f({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:a.map(g=>this.pixels[g]),statistics:this.statistics&&a.map(g=>
this.statistics[g])})};n.clone=function(){const a=new f({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let d;const e=f.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=[];const g=this.pixels[0].slice;for(d=0;d<this.pixels.length;d++)a.pixels[d]=g?this.pixels[d].slice(0,this.pixels[d].length):
new e(this.pixels[d])}if(this.statistics)for(a.statistics=[],d=0;d<this.statistics.length;d++)a.statistics[d]=F.clone(this.statistics[d]);return a};n._fillFrom8Bit=function(a){const {mask:d,maskIsAlpha:e,pixels:g}=this;if(a&&g&&g.length){var p,l;var r=p=l=g[0];3<=g.length?(p=g[1],l=g[2]):2===g.length&&(p=g[1]);var t=new Uint32Array(a),u=this.width*this.height;if(r.length!==u)h.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(d&&d.length===u)if(e)for(a=0;a<u;a++)d[a]&&
(t[a]=d[a]<<24|l[a]<<16|p[a]<<8|r[a]);else for(a=0;a<u;a++)d[a]&&(t[a]=-16777216|l[a]<<16|p[a]<<8|r[a]);else for(a=0;a<u;a++)t[a]=-16777216|l[a]<<16|p[a]<<8|r[a]}else h.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};n._fillFromNon8Bit=function(a){const {pixels:d,mask:e,statistics:g}=this;if(a&&d&&d.length){var p=this.pixelType,l=1,r=0;l=1;g&&0<g.length?(r=g.map(z=>z.minValue).reduce((z,E)=>Math.min(z,E)),l=g.map(z=>z.maxValue-z.minValue).reduce((z,E)=>Math.max(z,
E)),l=255/l):(l=255,"s8"===p?(r=-128,l=127):"u16"===p?l=65535:"s16"===p?(r=-32768,l=32767):"u32"===p?l=4294967295:"s32"===p?(r=-2147483648,l=2147483647):"f32"===p?(r=-3.4*1E39,l=3.4*1E39):"f64"===p&&(r=-Number.MAX_VALUE,l=Number.MAX_VALUE),l=255/(l-r));a=new Uint32Array(a);p=this.width*this.height;var t,u,v;var B=t=u=d[0];if(B.length!==p)return h.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=d.length)if(t=d[1],3<=d.length&&(u=d[2]),e&&e.length===p)for(v=0;v<p;v++)e[v]&&
(a[v]=-16777216|(u[v]-r)*l<<16|(t[v]-r)*l<<8|(B[v]-r)*l);else for(v=0;v<p;v++)a[v]=-16777216|(u[v]-r)*l<<16|(t[v]-r)*l<<8|(B[v]-r)*l;else if(e&&e.length===p)for(v=0;v<p;v++)t=(B[v]-r)*l,e[v]&&(a[v]=-16777216|t<<16|t<<8|t);else for(v=0;v<p;v++)t=(B[v]-r)*l,a[v]=-16777216|t<<16|t<<8|t}else h.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};n._fillFrom32Bit=function(a){const {pixels:d,mask:e}=this;if(!a||!d||!d.length)return h.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");
let g,p,l,r;g=p=l=d[0];3<=d.length?(p=d[1],l=d[2]):2===d.length&&(p=d[1]);const t=this.width*this.height;if(g.length!==t)return h.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let u=0;if(e&&e.length===t)for(r=0;r<t;r++)a[u++]=g[r],a[u++]=p[r],a[u++]=l[r],a[u++]=e[r]&1;else for(r=0;r<t;r++)a[u++]=g[r],a[u++]=p[r],a[u++]=l[r],a[u++]=1};n._calculateBandStatistics=function(a,d){let e=Infinity,g=-Infinity;const p=a.length;let l,r=0;if(d)for(l=0;l<p;l++)d[l]&&(r=a[l],
e=r<e?r:e,g=r>g?r:g);else for(l=0;l<p;l++)r=a[l],e=r<e?r:e,g=r>g?r:g;return{minValue:e,maxValue:g}};return m}(c.JSONSupport);y.__decorate([G.property({json:{write:!0}})],w.prototype,"width",void 0);y.__decorate([G.property({json:{write:!0}})],w.prototype,"height",void 0);y.__decorate([G.property({json:{write:!0}})],w.prototype,"pixelType",void 0);y.__decorate([J.cast("pixelType")],w.prototype,"castPixelType",null);y.__decorate([G.property({json:{write:!0}})],w.prototype,"validPixelCount",void 0);
y.__decorate([G.property({json:{write:!0}})],w.prototype,"mask",void 0);y.__decorate([G.property({json:{write:!0}})],w.prototype,"maskIsAlpha",void 0);y.__decorate([G.property({json:{write:!0}})],w.prototype,"pixels",void 0);y.__decorate([G.property({json:{write:!0}})],w.prototype,"statistics",void 0);return w=f=y.__decorate([K.subclass("esri.layers.support.PixelBlock")],w)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../core/Error ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils ../../../geometry/Point ../../../geometry/Extent ../../../geometry ../../../core/unitUtils ../../../geometry/projection".split(" "),
function(A,y,w,F,I,C,G,J,x){function K(c,f,h,q=null){if(c.spatialReference.equals(f))return c;const m=k(c.spatialReference,f);if(m&&!x.isLoaded())throw new y("rasterprojectionhelper-projectResolution","projection engine is not loaded");h=h.center;c=new C({xmin:h.x-c.x/2,xmax:h.x+c.x/2,ymin:h.y-c.y/2,ymax:h.y+c.y/2,spatialReference:c.spatialReference});f=m?x.project(c,f,q):F.project(c,f);return null==f?null:{x:f.xmax-f.xmin,y:f.ymax-f.ymin}}function H(c,f=.01){return J.getMetersPerUnitForSR(c)?f/J.getMetersPerUnitForSR(c):
0}function D(c,f,h=null,q=!0){const m=c.spatialReference;if(m.equals(f))return c;const n=k(m,f);if(n&&!x.isLoaded())throw new y("rasterprojectionhelper-projectResolution","projection engine is not loaded");if((h=n?x.project(c,f,h):F.project(c,f))&&q&&f.isGeographic){var a,d;const [e,g]=m.isWebMercator?w.getInfo(m).origin:null!=(a=null==(d=w.getInfo(m))?void 0:d.valid)?a:[];(f=H(m))&&null!=e&&null!=g&&(Math.abs(c.x-e)<f&&5E-4>Math.abs(180-h.x)?h.x-=360:Math.abs(c.x-g)<f&&5E-4>Math.abs(180+h.x)&&(h.x+=
360))}return h}function b(c,f,h=null,q=!0){var m,n,a,d;const e=c.spatialReference;if(e.equals(f))return c;var g=k(e,f);if(g&&!x.isLoaded())throw new y("rasterprojectionhelper-projectExtent","projection engine is not loaded");g=g?x.project(c,f,h):F.project(c,f);let [p,l]=null!=(m=null==(n=w.getInfo(e))?void 0:n.origin)?m:[];g&&q&&e.isWebMercator&&f.isGeographic&&null!=p&&null!=l&&(.001>Math.abs(c.xmin-p)&&1E3<Math.abs(l-c.xmax)&&5E-4>Math.abs(180-g.xmax)&&(g.xmin=-180,q=[],q.push(new I(c.xmax,c.ymin,
e)),q.push(new I(c.xmax,(c.ymin+c.ymax)/2,e)),q.push(new I(c.xmax,c.ymax,e)),q=q.map(r=>D(r,f,h)).filter(r=>!isNaN(null==r?void 0:r.x)).map(r=>r.x),g.xmax=Math.max.apply(null,q)),.001>Math.abs(c.xmax-l)&&1E3<Math.abs(p-c.xmin)&&5E-4>Math.abs(180+g.xmin)&&(g.xmax=180,q=[],q.push(new I(c.xmin,c.ymin,e)),q.push(new I(c.xmin,(c.ymin+c.ymax)/2,e)),q.push(new I(c.xmin,c.ymax,e)),c=q.map(r=>D(r,f,h)).filter(r=>!isNaN(null==r?void 0:r.x)).map(r=>r.x),g.xmin=Math.min.apply(null,c)));[p,l]=f.isWebMercator?
w.getInfo(f).origin:null!=(a=null==(d=w.getInfo(f))?void 0:d.valid)?a:[];(a=H(f))&&null!=p&&null!=l&&(Math.abs(g.xmin-p)<a&&(g.xmin=p),Math.abs(g.xmax-l)<a&&(g.xmax=l));return g}const k=function(c,f){const h=(c.isWGS84||c.isWebMercator)&&(f.isWGS84||f.isWebMercator);return!(c.equals(f)||h)};A.computeProjectedScales=function(c,f,h=512,q=!0){const {extent:m,spatialReference:n,pixelSize:a}=c,d=K(new I({x:a.x,y:a.y,spatialReference:n}),f,m);if(null==d)return{projectedPixelSize:null,scales:null,srcResolutions:null,
isCustomTilingScheme:!1};var e=(d.x+d.y)/2,g=J.getMetersPerUnitForSR(f);e=e*g*96*39.37;var p=f.isGeographic?512/h*2.958287637958547E8:512/h*5.91657527591555E8;h=!1;const l=b(m,f);q&&(f.isGeographic||f.isWebMercator)&&(h=0>l.xmin*l.xmax);f=e;if(h)f=p,c=1128.497176*g,g=K(new I({x:.29858214164761665,y:.29858214164761665,spatialReference:{wkid:3857}}),n,l),g.x*=f/c,g.y*=f/c;else{g={x:a.x,y:a.y};c=Math.ceil(Math.log(Math.min(c.width,c.height)/32)/Math.LN2);for(q=0;f<.5005*p&&q<c;)q++,f*=2,g.x*=2,g.y*=
2;1.001>=Math.max(f,p)/Math.min(f,p)&&(f=p)}c=[f];p=[{x:g.x,y:g.y}];for(e=Math.min(70.5310735,e)/1.001;f>=e;)f/=2,g.x/=2,g.y/=2,c.push(f),p.push({x:g.x,y:g.y});return{projectedPixelSize:d,scales:c,srcResolutions:p,isCustomTilingScheme:!h}};A.defaultGridSpacing=32;A.getDefaultDatumTransformationForDataset=function(c,f,h){if(!k(c.spatialReference,f))return null;if(!x.isLoaded())throw new y("rasterprojectionhelper-projectResolution","projection engine is not loaded");return h?x.getTransformation(f,c.spatialReference,
c):x.getTransformation(c.spatialReference,f,c)};A.getProjectionOffsetGrid=function(c,f,h,q=null,m=null,n=!1,a=[32,32]){var d,e;if(k(c.spatialReference,f.spatialReference)&&!x.isLoaded())throw new y("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(c&&f&&h))return null;const {xmin:g,ymin:p,xmax:l,ymax:r}=c;var t=c.spatialReference,u=f.spatialReference;const [v,B]=null!=(d=null==(e=w.getInfo(t))?void 0:e.valid)?d:[];var z=a[0]*h.x,E=a[1]*h.y;h=Math.ceil((l-g)/z-.1)+
1;d=Math.ceil((r-p)/E-.1)+1;e=[];c=!1;for(var L=0;L<h;L++){var O=[];for(var M=0;M<d;M++){var N=new I({x:g+z*L,y:r-E*M,spatialReference:t});N=D(N,u,q);m&&(N=m.inverseTransform(N));O.push(N);0<L&&n&&N&&P[M]&&null!=v&&N.x<P[M].x&&(N.x+=B-v);N?(e.push((N.x-f.xmin)/(f.xmax-f.xmin)),e.push((f.ymax-N.y)/(f.ymax-f.ymin))):(e.push(NaN),e.push(NaN),c=!0)}var P=O}f=[Math.abs((e[0]+e[4]+e[4*h]+e[4*h+4])/4-e[2*d+2]),Math.abs((e[1]+e[5]+e[4*d+1]+e[4*d+5])/4-e[2*d+3])];q=new Float32Array((h-1)*(d-1)*12);m=new Float32Array([-0,
-1,1,-1,1,-0,1,-0,-0]);n=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(P=0;P<h-1;P++){for(t=0;t<d-1;t++){M=P*d*2+2*t;E=e[M];u=e[M+1];var S=e[M+2],T=e[M+3];M+=2*d;L=e[M];z=e[M+1];O=e[M+2];M=e[M+3];N=0;let Q=12*(t*(h-1)+P);for(let R=0;3>R;R++)q[Q++]=m[N++]*E+m[N++]*S+m[N++]*O;N=0;for(S=0;3>S;S++)q[Q++]=m[N++]*u+m[N++]*T+m[N++]*M;N=0;for(T=0;3>T;T++)q[Q++]=n[N++]*E+n[N++]*L+n[N++]*O;N=0;for(E=0;3>E;E++)q[Q++]=n[N++]*u+n[N++]*z+n[N++]*M}if(c)for(t=0;t<q.length;t++)isNaN(q[t])&&(q[t]=-1)}return{offsets:e,
error:f,coefficients:q,spacing:a,size:[h-1,d-1]}};A.load=async function(){if(x.isLoaded()||!x.isSupported())return null;await x.load()};A.projectExtent=b;A.projectPoint=D;A.projectResolution=K;A.snapPyramid=function(c,f,h){var q=Math.log(c.x/f.pixelSize.x)/Math.LN2;const m=Math.log(c.y/f.pixelSize.y)/Math.LN2;c=f.storageInfo.maximumPyramidLevel||0;h="down"===h?Math.floor(Math.min(q,m)):"up"===h?Math.ceil(Math.max(q,m)):Math.round((q+m)/2);q=!1;0>h?h=0:h>c&&(q=h>c+3,h=c);c=2**h;f=new I({x:c*f.nativePixelSize.x,
y:c*f.nativePixelSize.y,spatialReference:f.spatialReference});return{pyramidLevel:h,pyramidResolution:f,excessiveReading:q}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/imagery/ImageryView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/decorators/enumeration ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/promiseUtils ../../../../core/Accessor ../../../../core/screenUtils ../../../../Graphic ../../../../layers/support/rasterFunctions/pixelUtils ../../engine/Container ../../engine/ImageryBitmapSource ../../engine/BitmapContainer ../support/ExportStrategy".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q,m,n){const a=F.getLogger("esri.views.2d.layers.imagery.ImageryView2D");w=function(d){function e(){var p=d.apply(this,arguments)||this;p.attached=!1;p.container=new h.Container;p.updateRequested=!1;p.type="Imagery";p._bitmapView=null;return p}A._inheritsLoose(e,d);var g=e.prototype;g.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.updateRequested=!1};g.update=function(p){this.strategy.update(p).catch(l=>{D.isAbortError(l)||a.error(l)})};
g.detach=function(){this.strategy.destroy();this._bitmapView.removeAllChildren();this.container.removeAllChildren()};g.hitTest=function(p,l){p=this.view.toMap(k.createScreenPoint(p,l));return Promise.resolve(new c({attributes:{},geometry:p,layer:this.layer}))};g.attach=function(){const p=10<=this.layer.version,l=10.1<=this.layer.version?this.layer.imageMaxHeight:2048,r=10.1<=this.layer.version?this.layer.imageMaxWidth:2048;this._bitmapView=new m.BitmapContainer;this.strategy=new n({container:this._bitmapView,
imageNormalizationSupported:p,imageMaxHeight:l,imageMaxWidth:r,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()});this.attached=!0};g.moveStart=function(){};g.viewChange=function(){};g.moveEnd=function(){};g.install=function(p){this.container.addChild(this._bitmapView);p.addChild(this.container)};g.uninstall=function(p){this.container.removeChild(this._bitmapView);p.removeChild(this.container)};g.redraw=function(){this.strategy.updateExports(p=>{p.source instanceof HTMLImageElement?
p.requestRender():this.layer.applyRenderer({pixelBlock:p.source.pixelBlock}).then(l=>{const r=p.source;r.pixelBlock=l.pixelBlock;r.filter=t=>this.layer.applyFilter(t);this.container.requestRender()})})};g.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};g.isUpdating=function(){return this.strategy.updating||this.updateRequested};g.getPixelData=function(){if(this.updating)return null;var p=this.strategy.container.children;if(1===p.length&&p[0].source)return{extent:p[0].source.extent,
pixelBlock:p[0].source.originalPixelBlock};if(1<p.length){const l=this.view.extent;p=p.map(r=>r.source).filter(r=>r.extent&&r.extent.intersects(l)).map(r=>({extent:r.extent,pixelBlock:r.originalPixelBlock}));return(p=f.mosaicPixelData(p,l))?{extent:p.extent,pixelBlock:p.pixelBlock}:null}return null};g._fetchImage=function(p,l,r,t){t=t||{};t.timeExtent=this.timeExtent;t.requestAsImageElement=!0;return this.layer.fetchImage(p,l,r,t).then(u=>u.imageElement?u.imageElement:this.layer.applyRenderer(u.pixelData,
{signal:t.signal}).then(v=>{v=new q(v.pixelBlock,v.extent.clone(),u.pixelData.pixelBlock);v.filter=B=>this.layer.applyFilter(B);return v}))};A._createClass(e,[{key:"updating",get:function(){return!this.attached||this.isUpdating()}}]);return e}(b);y.__decorate([C.property()],w.prototype,"attached",void 0);y.__decorate([C.property()],w.prototype,"container",void 0);y.__decorate([C.property()],w.prototype,"layer",void 0);y.__decorate([C.property()],w.prototype,"strategy",void 0);y.__decorate([C.property()],
w.prototype,"timeExtent",void 0);y.__decorate([C.property()],w.prototype,"view",void 0);y.__decorate([C.property()],w.prototype,"updateRequested",void 0);y.__decorate([C.property()],w.prototype,"updating",null);y.__decorate([G.enumeration({imagery:"Imagery"})],w.prototype,"type",void 0);return w=y.__decorate([J.subclass("esri.views.2d.layers.imagery.ImageryView2D")],w)})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock"],function(A,y){function w(b,k){b=
Math.min(Math.max(b,-100),100);k=Math.min(Math.max(k,-100),100);let c,f;const h=new Uint8Array(256);for(c=0;256>c;c++)0<b&&100>b?f=(200*c-25500+510*k)/(2*(100-b))+128:0>=b&&-100<b?f=(200*c-25500+510*k)*(100+b)/2E4+128:100===b?(f=200*c-25500+256*(100-b)+510*k,f=0<f?255:0):-100===b&&(f=128),h[c]=255<f?255:0>f?0:f;return h}function F(b,k,c,f,h,q,m,n){return{xmin:h<=c*b?0:h<c*b+b?h-c*b:b,ymin:q<=f*k?0:q<f*k+k?q-f*k:k,xmax:h+m<=c*b?0:h+m<c*b+b?h+m-c*b:b,ymax:q+n<=f*k?0:q+n<f*k+k?q+n-f*k:k}}function I(b,
k,c,f){var h=b.filter(N=>D(N))[0];if(null==h)return null;const q=f?f.width:k.width;f=f?f.height:k.height;const m=h.width,n=h.height,a=k.width/m;k=k.height/n;const d=c?c.x:0;c=c?c.y:0;const e=h.pixelType;var g=y.getPixelArrayConstructor(e);const p=h.pixels.length;h=[];let l,r;let t,u,v,B,z,E,L;for(u=0;u<p;u++){r=new g(q*f);for(v=0;v<k;v++)for(B=0;B<a;B++){var O=b[v*a+B];if(D(O))for(l=O.pixels[u],L=F(m,n,B,v,d,c,q,f),z=L.ymin;z<L.ymax;z++)for(O=(v*n+z-c)*q+(B*m-d),t=z*m,E=L.xmin;E<L.xmax;E++)r[O+E]=
l[t+E]}h.push(r)}let M;if(b.some(N=>null==N||N.mask&&0<N.mask.length))for(M=new Uint8Array(q*f),v=0;v<k;v++)for(B=0;B<a;B++)if(g=(O=b[v*a+B])?O.mask:null,L=F(m,n,B,v,d,c,q,f),g)for(z=L.ymin;z<L.ymax;z++)for(O=(v*n+z-c)*q+(B*m-d),t=z*m,E=L.xmin;E<L.xmax;E++)M[O+E]=g[t+E];else if(O)for(z=L.ymin;z<L.ymax;z++)for(O=(v*n+z-c)*q+(B*m-d),t=z*m,E=L.xmin;E<L.xmax;E++)M[O+E]=1;else for(z=L.ymin;z<L.ymax;z++)for(O=(v*n+z-c)*q+(B*m-d),t=z*m,E=L.xmin;E<L.xmax;E++)M[O+E]=0;b=new y({width:q,height:f,pixels:h,pixelType:e,
mask:M});b.updateStatistics();return b}function C(b){if(!D(b))return null;const k=b.clone(),{width:c,height:f,pixels:h,mask:q}=b;var m=h[0];b=k.pixels[0];for(let d=2;d<f-1;d++){const e=new Map;for(var n=d-2;n<d+2;n++)for(var a=0;4>a;a++){const g=n*c+a;x(e,m[g],q?q[g]:1)}b[d*c]=G(e);b[d*c+1]=b[d*c+2]=b[d*c];for(n=3;n<c-1;n++)a=(d-2)*c+n+1,x(e,m[a],q?q[a]:1),a=(d-1)*c+n+1,x(e,m[a],q?q[a]:1),a=d*c+n+1,x(e,m[a],q?q[a]:1),a=(d+1)*c+n+1,x(e,m[a],q?q[a]:1),a=(d-2)*c+n-3,J(e,m[a],q?q[a]:1),a=(d-1)*c+n-3,
J(e,m[a],q?q[a]:1),a=d*c+n-3,J(e,m[a],q?q[a]:1),a=(d+1)*c+n-3,J(e,m[a],q?q[a]:1),b[d*c+n]=G(e);b[d*c+n+1]=b[d*c+n]}for(m=0;m<c;m++)b[m]=b[c+m]=b[2*c+m],b[(f-1)*c+m]=b[(f-2)*c+m];k.updateStatistics();return k}function G(b){if(0===b.size)return 0;let k=0,c=-1,f=0;const h=b.keys();let q=h.next();for(;!q.done;)f=b.get(q.value),f>k&&(c=q.value,k=f),q=h.next();return c}function J(b,k,c){0!==c&&(c=b.get(k),1===c?b.delete(k):b.set(k,c-1))}function x(b,k,c){0!==c&&b.set(k,b.has(k)?b.get(k)+1:1)}function K(b,
k,c){let {x:f,y:h}=k;const {width:q,height:m}=c;if(0===f&&0===h&&m===b.height&&q===b.width)return b;const {width:n,height:a}=b;k=Math.max(0,h);const d=Math.max(0,f),e=Math.min(f+q,n),g=Math.min(h+m,a);if(0>e||0>g||!D(b))return null;f=Math.max(0,-f);h=Math.max(0,-h);const {pixels:p,mask:l}=b;var r=q*m,t=p.length;const u=[];for(var v=0;v<t;v++){var B=p[v],z=y.createEmptyBand(b.pixelType,r);for(let E=k;E<g;E++){const L=E*n;let O=(E+h-k)*q+f;for(let M=d;M<e;M++)z[O++]=B[L+M]}u.push(z)}r=new Uint8Array(r);
for(t=k;t<g;t++)for(v=t*n,B=(t+h-k)*q+f,z=d;z<e;z++)r[B++]=l?l[v+z]:1;b=new y({width:c.width,height:c.height,pixelType:b.pixelType,pixels:u,mask:r});b.updateStatistics();return b}function H(b,k=!0){if(!D(b))return null;const {pixels:c,width:f,height:h,mask:q,pixelType:m}=b;b=[];const n=Math.round(f/2),a=Math.round(h/2),d=h-1,e=f-1;for(var g=0;g<c.length;g++){var p=c[g],l=y.createEmptyBand(m,n*a),r=0;for(var t=0;t<h;t+=2)for(var u=0;u<f;u+=2){var v=p[t*f+u];if(k){var B=u===e?v:p[t*f+u+1];const z=t===
d?v:p[t*f+u+f],E=u===e?z:t===d?B:p[t*f+u+f+1];l[r++]=(v+B+z+E)/4}else l[r++]=v}b.push(l)}g=null;if(q)for(g=new Uint8Array(n*a),p=0,l=0;l<h;l+=2)for(r=0;r<f;r+=2)t=q[l*f+r],k?(u=r===e?t:q[l*f+r+1],v=l===d?t:q[l*f+r+f],B=r===e?v:l===d?u:q[l*f+r+f+1],g[p++]=t*u*v*B?1:0):g[p++]=t;return new y({width:n,height:a,pixelType:m,pixels:b,mask:g})}const D=function(b){return b&&"esri.layers.support.PixelBlock"===b.declaredClass&&b.pixels&&0<b.pixels.length};A.approximateTransform=function(b,k,c,f,h="nearest"){if(!D(b))return null;
"majority"===h&&(b=C(b));const {pixels:q,mask:m,pixelType:n}=b,a=b.width;var d=b.height;b=y.getPixelArrayConstructor(n);var e=q.length;const {width:g,height:p}=k;k=f.cols;var l=f.rows;const r=Math.ceil(g/k),t=Math.ceil(p/l);f=!1;for(var u=0;u<c.length;u+=3)-1===c[u]&&-1===c[u+1]&&-1===c[u+2]&&(f=!0);let v,B,z,E,L,O;const M=new Float32Array(g*p),N=new Float32Array(g*p);u=0;let P,S;const T="majority"===h?0:.5;for(let U=0;U<t;U++)for(let V=0;V<r;V++){v=12*(U*r+V);h=c[v];B=c[v+1];z=c[v+2];E=c[v+3];L=
c[v+4];O=c[v+5];for(var Q=0;Q<l;Q++){u=(U*l+Q)*g+V*k;S=(Q+.5)/l;for(var R=0;R<Q;R++)P=(R+.5)/k,M[u+R]=Math.round((h*P+B*S+z)*a-T),N[u+R]=Math.round((E*P+L*S+O)*d-T)}v+=6;h=c[v];B=c[v+1];z=c[v+2];E=c[v+3];L=c[v+4];O=c[v+5];for(Q=0;Q<l;Q++)for(u=(U*l+Q)*g+V*k,S=(Q+.5)/l,R=Q;R<k;R++)P=(R+.5)/k,M[u+R]=Math.round((h*P+B*S+z)*a-T),N[u+R]=Math.round((E*P+L*S+O)*d-T)}c=(U,V)=>{for(let W=0;W<p;W++){v=W*g;for(let X=0;X<g;X++)U[v]=0>M[v]||0>N[v]?0:V[M[v]+N[v]*a],v++}};d=[];for(l=0;l<e;l++)k=new b(g*p),c(k,q[l]),
d.push(k);b=new y({width:g,height:p,pixelType:n,pixels:d});if(m)b.mask=new Uint8Array(g*p),c(b.mask,m);else if(f)for(b.mask=new Uint8Array(g*p),e=0;e<g*p;e++)b.mask[e]=0>M[e]||0>N[e]?0:1;b.updateStatistics();return b};A.clip=K;A.colorize=function(b,k){if(!D(b)||!k&&(k.indexedColormap||k.indexed2DColormap))return b;const c=b.clone();var f=c.pixels;let h=c.mask;const q=c.width*c.height;if(1!==f.length)return b;const {indexedColormap:m,indexed2DColormap:n,offset:a,alphaSpecified:d}=k;k=m.length-1;b=
0;f=f[0];const e=new Uint8Array(f.length),g=new Uint8Array(f.length),p=new Uint8Array(f.length);let l=0;if(m)if(h)for(b=0;b<q;b++)h[b]&&(l=4*(f[b]-a),l<a||l>k?h[b]=0:(e[b]=m[l],g[b]=m[l+1],p[b]=m[l+2],h[b]=m[l+3]));else{h=new Uint8Array(q);for(b=0;b<q;b++)l=4*(f[b]-a),l<a||l>k?h[b]=0:(e[b]=m[l],g[b]=m[l+1],p[b]=m[l+2],h[b]=m[l+3]);c.mask=h}else if(h)for(b=0;b<q;b++)h[b]&&(k=n[f[b]],e[b]=k[0],g[b]=k[1],p[b]=k[2],h[b]=k[3]);else{h=new Uint8Array(q);for(b=0;b<q;b++)k=n[f[b]],e[b]=k[0],g[b]=k[1],p[b]=
k[2],h[b]=k[3];c.mask=h}c.pixels=[e,g,p];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=d;return c};A.createColormapLUT=function(b){if(b){var k=b.colormap;if(k&&0!==k.length){k=k.sort((d,e)=>d[0]-e[0]);var c=0;0>k[0][0]&&(c=k[0][0]);var f=Math.max(256,k[k.length-1][0]-c+1),h=new Uint8Array(4*f),q=[],m=0,n=0,a=5===k[0].length;if(65536<f)return k.forEach(d=>{q[d[0]-c]=a?d.slice(1):d.slice(1).concat([255])}),{indexed2DColormap:q,offset:c,alphaSpecified:a};if(b.fillUnspecified)for(b=k[n],m=b[0]-c;m<
f;m++)h[4*m]=b[1],h[4*m+1]=b[2],h[4*m+2]=b[3],h[4*m+3]=a?b[4]:255,m===b[0]-c&&(b=n===k.length-1?b:k[++n]);else for(m=0;m<k.length;m++)b=k[m],n=4*(b[0]-c),h[n]=b[1],h[n+1]=b[2],h[n+2]=b[3],h[n+3]=a?b[4]:255;return{indexedColormap:h,offset:c,alphaSpecified:a}}}};A.createContrastBrightnessLUT=w;A.createHistogramEqualizationLUT=function(b,k=256){k=Math.min(k,256);const {size:c,counts:f}=b;b=new Uint8Array(c);var h=f.reduce((d,e)=>d+e/k,0);let q=0;var m=0;let n=0,a=h;for(let d=0;d<c;d++)if(n+=f[d],!(d<
c-1&&n+f[d+1]<a)){for(;q<k-1&&a<n;)q++,a+=h;for(;m<=d;m++)b[m]=q;m=d+1}for(h=m;h<c;h++)b[h]=k-1;return b};A.createStretchLUT=function(b){const {minCutOff:k,maxCutOff:c,gamma:f,pixelType:h}=b,q=b.outMin||0,m=b.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(h))return null;const n=k.length;let a;let d=0;"s8"===h?d=-127:"s16"===h&&(d=-32767);let e=256;-1<["u16","s16"].indexOf(h)&&(e=65536);const g=[],p=m-q;for(a=0;a<n;a++)g[a]=c[a]-k[a];var l=f&&f.length>=n;const r=[];if(l)for(a=0;a<n;a++)r[a]=1<
f[a]?2<f[a]?6.5+(f[a]-2)**2.5:6.5+100*(2-f[a])**4:1;let t;const u=[];let v,B,z;if(l)for(a=0;a<n;a++){z=[];for(l=0;l<e;l++)v=l+d,t=(v-k[a])/g[a],B=1,1<f[a]&&(B-=(1/p)**(t*r[a])),z[l]=v<c[a]&&v>k[a]?Math.floor(B*p*t**(1/f[a]))+q:v>=c[a]?m:q;u[a]=z}else for(a=0;a<n;a++){z=[];for(l=0;l<e;l++)v=l+d,z[l]=v<=k[a]?q:v>=c[a]?m:Math.floor((v-k[a])/g[a]*p)+q;u[a]=z}if(null!=b.contrastOffset)for(b=w(b.contrastOffset,b.brightnessOffset),a=0;a<n;a++)for(z=u[a],l=0;l<e;l++)z[l]=b[z[l]];return{lut:u,offset:d}};A.estimateStatisticsFromHistograms=
function(b){const k=[];for(let q=0;q<b.length;q++){const {min:m,max:n,size:a,counts:d}=b[q];let e=0;var c=0;for(var f=0;f<a;f++)e+=d[f],c+=f*d[f];c/=e;f=0;for(var h=0;h<a;h++)f+=d[h]*(h-c)**2;h=(n-m)/a;k.push({min:m,max:n,avg:(c+.5)*h+m,stddev:Math.sqrt(f/(e-1))*h})}return k};A.estimateStatisticsHistograms=function(b){if(!D(b))return null;b.statistics||b.updateStatistics();const {pixels:k,mask:c,pixelType:f,statistics:h}=b;b=b.width*b.height;const q=k.length;let m,n;let a;var d;const e=[],g=[];for(a=
0;a<q;a++){var p=new Uint32Array(256);var l=k[a];if("u8"===f)if(m=-.5,n=255.5,c)for(d=0;d<b;d++)c[d]&&p[l[d]]++;else for(d=0;d<b;d++)p[l[d]]++;else{m=h[a].minValue;n=h[a].maxValue;var r=(n-m)/256;var t=new Uint32Array(257);if(c)for(d=0;d<b;d++)c[d]&&t[Math.floor((l[d]-m)/r)]++;else for(d=0;d<b;d++)t[Math.floor((l[d]-m)/r)]++;for(d=0;255>d;d++)p[d]=t[d];p[255]=t[255]+t[256]}e.push({min:m,max:n,size:256,counts:p});for(d=l=t=r=0;256>d;d++)r+=p[d],t+=d*p[d];t/=r;for(d=0;256>d;d++)l+=p[d]*(d-t)**2;p=Math.sqrt(l/
(r-1));r=(n-m)/256;d=(t+.5)*r+m;p*=r;g.push({min:m,max:n,avg:d,stddev:p})}return{statistics:g,histograms:e}};A.extractBands=function(b,k){if(null==k||!k.length||!D(b))return b;const c=b.pixels.length;return k&&k.some(f=>f>=c)||1===c&&1===k.length&&0===k[0]||c===k.length&&!k.some((f,h)=>f!==h)?b:new y({pixelType:b.pixelType,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:k.map(f=>b.pixels[f]),statistics:b.statistics&&k.map(f=>b.statistics[f])})};
A.getClipBounds=F;A.lookupPixels=function(b,k){if(!D(b))return null;const {pixels:c,mask:f}=b,h=b.width*b.height,q=c.length;let m=k.lut;({offset:k}=k);let n,a;m&&1===m[0].length&&(m=c.map(()=>m));const d=[];let e,g,p;if(k)if(null==f)for(n=0;n<q;n++){e=c[n];g=m[n];p=new Uint8Array(h);for(a=0;a<h;a++)p[a]=g[e[a]-k];d.push(p)}else for(n=0;n<q;n++){e=c[n];g=m[n];p=new Uint8Array(h);for(a=0;a<h;a++)f[a]&&(p[a]=g[e[a]-k]);d.push(p)}else if(null==f)for(n=0;n<q;n++){e=c[n];g=m[n];p=new Uint8Array(h);for(a=
0;a<h;a++)p[a]=g[e[a]];d.push(p)}else for(n=0;n<q;n++){e=c[n];g=m[n];p=new Uint8Array(h);for(a=0;a<h;a++)f[a]&&(p[a]=g[e[a]]);d.push(p)}b=new y({width:b.width,height:b.height,pixels:d,mask:f,pixelType:"u8"});b.updateStatistics();return b};A.mosaic=I;A.mosaicPixelData=function(b,k){if(!b||0===b.length)return null;var c=b.filter(g=>g.pixelBlock)[0];if(!c)return null;var f=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width;const h=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,q=.01*Math.min(f,h),m=
b.sort((g,p)=>Math.abs(g.extent.ymax-p.extent.ymax)>q?p.extent.ymax-g.extent.ymax:Math.abs(g.extent.xmin-p.extent.xmin)>q?g.extent.xmin-p.extent.xmin:0);var n=Math.min.apply(null,m.map(g=>g.extent.xmin));const a=Math.min.apply(null,m.map(g=>g.extent.ymin)),d=Math.max.apply(null,m.map(g=>g.extent.xmax)),e=Math.max.apply(null,m.map(g=>g.extent.ymax));b={x:Math.round((k.xmin-n)/f),y:Math.round((e-k.ymax)/h)};n={width:Math.round((d-n)/f),height:Math.round((e-a)/h)};f={width:Math.round((k.xmax-k.xmin)/
f),height:Math.round((k.ymax-k.ymin)/h)};if(Math.round(n.width/c.pixelBlock.width)*Math.round(n.height/c.pixelBlock.height)!==m.length||0>b.x||0>b.y||n.width<f.width||n.height<f.height)return null;c=m.map(g=>g.pixelBlock);c=I(c,n,b,f);return{extent:k,pixelBlock:c}};A.remapColor=function(b,k){if(!D(b))return null;b=b.clone();var {pixels:c}=b;const f=b.width*b.height,h=k.length,q=Math.floor(h/2),m=k[Math.floor(q)];c=c[0];let n,a,d,e,g,p,l=!1;const r=new Uint8Array(f),t=new Uint8Array(f),u=new Uint8Array(f);
let v=b.mask;const B=4===k[0].mappedColor.length;v||(v=new Uint8Array(f),v.fill(B?255:1),b.mask=v);for(g=0;g<f;g++)if(v[g]){n=c[g];l=!1;p=q;a=m;d=0;for(e=h-1;1<e-d;){if(n===a.value){l=!0;break}n>a.value?d=p:e=p;p=Math.floor((d+e)/2);a=k[Math.floor(p)]}l||(n===k[d].value?(a=k[d],l=!0):n===k[e].value?(a=k[e],l=!0):n<k[d].value?(l=!1,a=null):n>k[d].value&&(n<k[e].value?(a=k[d],l=!0):e===h-1?(l=!1,a=null):(a=k[e],l=!0)));l?(r[g]=a.mappedColor[0],t[g]=a.mappedColor[1],u[g]=a.mappedColor[2],v[g]=a.mappedColor[3]):
r[g]=t[g]=u[g]=v[g]=0}b.pixels=[r,t,u];b.mask=v;b.pixelType="u8";b.maskIsAlpha=B;return b};A.resampleByMajority=C;A.setValidBoundary=function(b,k,c){if(!D(b))return null;const {width:f,height:h}=b,q=k.x;k=k.y;const m=c.width+q;c=c.height+k;if(0>q||0>k||m>f||c>h||0===q&&0===k&&m===f&&c===h)return b;b.mask||(b.mask=new Uint8Array(f*h));const n=b.mask;for(let a=0;a<h;a++){const d=a*f;for(let e=0;e<f;e++)n[d+e]=a<k||a>=c||e<q||e>=m?0:1}b.updateStatistics();return b};A.split=function(b,k,c){if(!D(b))return null;
const {width:f,height:h}=k;let {width:q,height:m}=b;const n=new Map,a={x:0,y:0};c=null==c?1:1+c;for(let d=0;d<c;d++){const e=Math.ceil(q/f),g=Math.ceil(m/h);for(let p=0;p<g;p++){a.y=p*h;for(let l=0;l<e;l++){a.x=l*f;const r=K(b,a,k);n.set(`${d}/${p}/${l}`,r)}}d<c-1&&(b=H(b));q=Math.round(q/2);m=Math.round(m/2)}return n};A.stretch=function(b,k){if(!D(b))return null;b=b.clone();const {pixels:c,mask:f}=b,{minCutOff:h,maxCutOff:q,gamma:m}=k,n=k.outMin||0;k=k.outMax||255;const a=b.width*b.height,d=c.length;
let e;let g,p,l;const r=k-n,t=[];for(e=0;e<d;e++)t[e]=q[e]-h[e];var u=m&&m.length>=d;const v=[];if(u)for(e=0;e<d;e++)v[e]=1<m[e]?2<m[e]?6.5+(m[e]-2)**2.5:6.5+100*(2-m[e])**4:1;if(u)if(null!=f)for(u=0;u<a;u++){if(f[u])for(e=0;e<d;e++)g=c[e][u],l=(g-h[e])/t[e],p=1,1<m[e]&&(p-=(1/r)**(l*v[e])),c[e][u]=g<q[e]&&g>h[e]?Math.floor(p*r*l**(1/m[e]))+n:g>=q[e]?k:n}else for(u=0;u<a;u++)for(e=0;e<d;e++)g=c[e][u],l=(g-h[e])/t[e],p=1,1<m[e]&&(p-=(1/r)**(l*v[e])),c[e][u]=g<q[e]&&g>h[e]?Math.floor(p*r*l**(1/m[e]))+
n:g>=q[e]?k:n;else if(null!=f)for(u=0;u<a;u++){if(f[u])for(e=0;e<d;e++)g=c[e][u],c[e][u]=g<q[e]&&g>h[e]?Math.floor((g-h[e])/t[e]*r)+n:g>=q[e]?k:n}else for(u=0;u<a;u++)for(e=0;e<d;e++)g=c[e][u],c[e][u]=g<q[e]&&g>h[e]?Math.floor((g-h[e])/t[e]*r)+n:g>=q[e]?k:n;b.pixelType="u8";b.updateStatistics();return b};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/support/ExportStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/promiseUtils ../../../../core/Accessor ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent ../../../../geometry/support/aaBoundingRect ../../../../layers/support/TileInfo ../../tiling/TileKey ../../tiling/TileInfoView ../../viewStateUtils ../../engine/Bitmap".split(" "),
function(A,y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q,m,n,a){const d=f.create(),e=[0,0],g=new q(0,0,0,0);w=function(p){function l(t){var u=p.call(this,t)||this;u._imagePromise=null;u.hidpi=!1;u.imageMaxWidth=2048;u.imageMaxHeight=2048;u.imageRotationSupported=!1;u.imageNormalizationSupported=!1;u.update=D.debounce(async(v,B)=>{const z=v.state;var E=k.getInfo(z.spatialReference);const L=u.hidpi?v.pixelRatio:1;if(!v.stationary||u.destroyed)return null;u.imageRotationSupported?(e[0]=z.size[0],e[1]=z.size[1]):
n.getOuterSize(e,z);v=E&&(z.extent.xmin<E.valid[0]||z.extent.xmax>E.valid[1]);v=!u.imageNormalizationSupported&&v;E=u.imageRotationSupported?z.rotation:0;if(Math.floor(e[0]*L)>u.imageMaxWidth||Math.floor(e[1]*L)>u.imageMaxHeight||v){let O=Math.min(u.imageMaxWidth,u.imageMaxHeight);v&&(O=Math.min(z.worldScreenWidth,O));u._imagePromise=u._tiledExport(z,O,E,L,B)}else u._imagePromise=u._singleExport(z,e,E,L,B);return u._imagePromise.then(async O=>{u._imagePromise=null;if(!u.destroyed){for(const M of u.container.children)O.includes(M)||
M.fadeOut().then(()=>{M.remove()});for(const M of O)u.container.addChild(M),M.fadeIn()}}).catch(O=>{u._imagePromise=null;throw O;})},5E3);return u}A._inheritsLoose(l,p);var r=l.prototype;r.destroy=function(){};r.updateExports=function(t){for(const u of this.container.children){if(!u.visible||!u.stage)break;t(u)?console.error("ExportStrategy.updateExports doesn't support promise yet"):(u.invalidateTexture(),u.requestRender())}};r._export=function(t,u,v,B,z,E){return Promise.resolve().then(()=>this.fetchSource(t,
Math.floor(u*z),Math.floor(v*z),{rotation:B,pixelRatio:z,signal:E})).then(L=>{L=new a.Bitmap(L,"additive");L.x=t.xmin;L.y=t.ymax;L.resolution=t.width/u;L.rotation=B;L.pixelRatio=z;return L})};r._singleExport=function(t,u,v,B,z){n.getBBox(d,t.center,t.resolution,u);t=new c(d[0],d[1],d[2],d[3],t.spatialReference);return this._export(t,u[0],u[1],v,B,z).then(E=>[E])};r._tiledExport=function(t,u,v,B,z){var E=h.create({size:u,spatialReference:t.spatialReference,scales:[t.scale]});const L=new m(E);E=L.getTileCoverage(t);
if(!E)return null;const O=[];E.forEach((M,N,P,S)=>{g.set(M,N,P,S);L.getTileBounds(d,g);M=new c(d[0],d[1],d[2],d[3],t.spatialReference);O.push(this._export(M,u,u,v,B,z))});return Promise.all(O)};A._createClass(l,[{key:"updating",get:function(){return null!==this._imagePromise}}]);return l}(b);y.__decorate([C.property()],w.prototype,"_imagePromise",void 0);y.__decorate([C.property()],w.prototype,"container",void 0);y.__decorate([C.property()],w.prototype,"fetchSource",void 0);y.__decorate([C.property()],
w.prototype,"hidpi",void 0);y.__decorate([C.property()],w.prototype,"imageMaxWidth",void 0);y.__decorate([C.property()],w.prototype,"imageMaxHeight",void 0);y.__decorate([C.property()],w.prototype,"imageRotationSupported",void 0);y.__decorate([C.property()],w.prototype,"imageNormalizationSupported",void 0);y.__decorate([C.property()],w.prototype,"requestUpdate",void 0);y.__decorate([C.property()],w.prototype,"updating",null);return w=y.__decorate([J.subclass("esri.views.2d.layers.support.ExportStrategy")],
w)})},"esri/views/2d/viewStateUtils":function(){define(["exports"],function(A){const y=Math.PI/180;A.bboxIntersects=function(w,F){const [I,C,G,J]=w,[x,K,H,D]=F;return!(I>H||G<x||C>D||J<K)};A.getBBox=function(w,F,I,C){const [G,J]=F,[x,K]=C;F=.5*I;w[0]=G-F*x;w[1]=J-F*K;w[2]=G+F*x;w[3]=J+F*K;return w};A.getOuterSize=function(w,F){var I=F.rotation*y;const C=Math.abs(Math.cos(I));I=Math.abs(Math.sin(I));const [G,J]=F.size;w[0]=Math.round(J*I+G*C);w[1]=Math.round(J*C+G*I);return w};A.snapToPixel=function(w,
F,I){const {resolution:C,size:G}=I;w[0]=C*(Math.round(F[0]/C)+G[0]%2*.5);w[1]=C*(Math.round(F[1]/C)+G[1]%2*.5);return w};Object.defineProperty(A,"__esModule",{value:!0})})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/watchUtils ../../layers/RefreshableLayerView ../../layers/LayerView ../../layers/ImageryLayerView ./LayerView2D ./imagery/ImageryGraphicsView2D ./imagery/ImageryView2D".split(" "),function(A,
y,w,F,I,C,G,J,x,K,H,D,b,k,c,f,h,q){w=function(m){function n(){var d=m.apply(this,arguments)||this;d._exportImageVersion=-1;return d}A._inheritsLoose(n,m);var a=n.prototype;a.initialize=function(){this.handles.add(D.init(this,["layer.blendMode"],d=>{this.subview&&(this.subview.container.blendMode=d)},!0))};a.hitTest=function(d,e){return this.suspended||!this.subview?Promise.resolve(null):this.subview.hitTest(d,e)};a.update=function(d){var e;null==(e=this.subview)?void 0:e.update(d)};a.attach=function(){this.layer.increaseRasterJobHandlerUsage();
this._setSubView();this.handles.add([D.init(this,"layer.exportImageServiceParameters.version",d=>{this._exportImageVersion!==d&&(this._exportImageVersion=d,this.requestUpdate())}),this.watch("timeExtent",()=>{this.subview.timeExtent=this.timeExtent;this.requestUpdate()}),this.layer.on("redraw",()=>this.subview.redraw()),D.watch(this.layer,"renderer",()=>this._setSubView())],"imagerylayerview-update")};a.detach=function(){this.layer.decreaseRasterJobHandlerUsage();this.subview.destroy();this.handles.remove("imagerylayerview-update");
this._exportImageVersion=-1};a.moveStart=function(){};a.viewChange=function(){};a.moveEnd=function(){this.requestUpdate()};a.doRefresh=async function(){this.requestUpdate()};a.isUpdating=function(){return!this.subview||!this.suspended&&this.subview.isUpdating()};a._setSubView=function(){var d;let e="Imagery";"vector-field"===(null==(d=this.layer.renderer)?void 0:d.type)&&"lerc"===this.layer.format&&(e="Graphics");if(!this.subview||this.subview.type!==e){var g,p;null==(g=this.subview)?void 0:g.uninstall(this.container);
null==(p=this.subview)?void 0:p.destroy();this.subview="Imagery"===e?new q({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new h({layer:this.layer,view:this.view,timeExtent:this.timeExtent});this.subview.attach();this.subview.install(this.container);this.subview.container.blendMode=this.layer.blendMode}this.requestUpdate()};A._createClass(n,[{key:"pixelData",get:function(){return this.updating?null:this.subview.getPixelData()}},{key:"updating",get:function(){return!(this.subview&&!this.subview.updating)}}]);
return n}(c.ImageryLayerView(b.RefreshableLayerView(f.LayerView2DMixin(k))));y.__decorate([C.property()],w.prototype,"pixelData",null);y.__decorate([C.property({readOnly:!0})],w.prototype,"updating",null);y.__decorate([C.property()],w.prototype,"subview",void 0);return w=y.__decorate([J.subclass("esri.views.2d.layers.ImageryLayerView2D")],w)});