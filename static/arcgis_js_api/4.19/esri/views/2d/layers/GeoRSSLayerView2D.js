// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Collection ../../../PopupTemplate ../../../Graphic ../../../renderers/SimpleRenderer ../../../renderers/support/jsonUtils ../../../core/watchUtils ../../../tasks/support/FeatureSet ../../layers/LayerView ./graphics/GraphicsView2D ./graphics/GraphicContainer ./LayerView2D".split(" "),
function(n,p,g,C,D,E,F,q,G,H,I,r,t,u,h,v,k,w,x,y,z,A){g=function(m){function l(){var a=m.apply(this,arguments)||this;a._graphicsViewMap={};a._popupTemplates=new Map;a.graphicsViews=[];return a}n._inheritsLoose(l,m);var e=l.prototype;e.hitTest=function(a,c){if(this.suspended||!this.graphicsViews.length)return Promise.resolve(null);const f=this.graphicsViews.reverse().map(b=>b.hitTest(a,c));return Promise.all(f).then(b=>b.filter((d,B)=>{d&&(d.popupTemplate=this._popupTemplates.get(this.graphicsViews[B]),
d.layer=this.layer,d.sourceLayer=this.layer);return!!d})[0]||null)};e.update=function(a){if(this.graphicsViews)for(const c of this.graphicsViews)c.processUpdate(a)};e.attach=function(){this.layer.featureCollections.forEach(a=>{const c=w.fromJSON(a.featureSet),f=new (r.ofType(u))(c.features);if(this._graphicsViewMap[c.geometryType]){var b=this._graphicsViewMap[c.geometryType];b.graphics.addMany(f)}else{b=a.layerDefinition.drawingInfo;a=a.popupInfo?t.fromJSON(a.popupInfo):null;const d=v.fromJSON(b.renderer);
b=new y({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:f,renderer:d,container:new z(this.view.featuresTilingScheme)});this._graphicsViewMap[c.geometryType]=b;this._popupTemplates.set(b,a);"polygon"!==c.geometryType||this.layer.polygonSymbol?"polyline"!==c.geometryType||this.layer.lineSymbol?"point"!==c.geometryType||this.layer.pointSymbol||(this.layer.pointSymbol=d.symbol):this.layer.lineSymbol=d.symbol:this.layer.polygonSymbol=d.symbol;this.graphicsViews.push(b);this.container.addChild(b.container)}});
this.handles.add([k.init(this.layer,"polygonSymbol",a=>{this._graphicsViewMap.polygon.renderer=new h({symbol:a})}),k.init(this.layer,"lineSymbol",a=>{this._graphicsViewMap.polyline.renderer=new h({symbol:a})}),k.init(this.layer,"pointSymbol",a=>{this._graphicsViewMap.point.renderer=new h({symbol:a})})])};e.detach=function(){this.container.removeAllChildren();for(const a of this.graphicsViews)a.destroy();this.graphicsViews.length=0};e.moveStart=function(){};e.moveEnd=function(){};e.viewChange=function(){for(const a of this.graphicsViews)a.viewChange()};
return l}(A.LayerView2DMixin(x));return g=p.__decorate([q.subclass("esri.views.2d.layers.GeoRSSLayerView2D")],g)});