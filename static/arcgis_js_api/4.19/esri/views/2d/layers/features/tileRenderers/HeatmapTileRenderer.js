// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/global","../../core/mathUtils"],function(q,v,t){function x(a,b,c,g,h){a=new Uint32Array(a*a);b="buffer"in b?b:new Float64Array(b);c="buffer"in c?new Uint32Array(c.buffer):new Uint32Array((new Uint8Array(c)).buffer);h=c.length/(h-g);for(let k=0;k<b.length;k++)a[k]=c[t.clamp(Math.floor((b[k]-g)*h),0,c.length-1)];return a.buffer}function y(a){const b=Math.round(3*a),c=2*a*a,g=new Float64Array(2*b+1);for(let h=
0;h<=g.length;h++)g[h]=Math.exp(-((h-b)**2)/c)/Math.sqrt(2*Math.PI)*(a/2);return g}function w(a,b){return"function"===typeof a?a:a?"string"===typeof b?c=>-1*+c[a]:c=>+c[a]+b:()=>1}function E(a,b){return null!=a?"string"===typeof b?c=>-1*+c.readAttribute(a):c=>+c.readAttribute(a)+b:c=>1}const C=(()=>{if(!("document"in v))return()=>null;const a=document.createElement("canvas"),b=a.getContext("2d");a.height=512;a.width=1;return c=>{b.clearRect(0,0,1,a.height);const g=b.createLinearGradient(0,0,0,a.height);
for(const {ratio:h,color:k}of c.colorStops)g.addColorStop(Math.max(h,.001),`rgba(${k[0]}, ${k[1]}, ${k[2]}, ${k[3]})`);b.fillStyle=g;b.fillRect(0,0,1,a.height);return b.getImageData(0,0,1,a.height).data}})();q.calculateHeatmapIntensityInfo=function(a,b,c,g){const {blurRadius:h,fieldOffset:k,field:n}=b;b=new Float64Array(c*g);const e=y(h),l=Math.round(3*h);let m=Number.NEGATIVE_INFINITY;const d=w(n,k);for(const {geometry:u,attributes:r}of a){a=u.x-l;const p=u.y-l,H=Math.max(0,a);var f=Math.max(0,p);
const F=Math.min(g,u.y+l),G=Math.min(c,u.x+l),I=+d(r);for(let z=f;z<F;z++){const A=e[z-p];for(let B=H;B<G;B++)f=b[z*c+B]+=A*e[B-a]*I,f>m&&(m=f)}}return{matrix:b.buffer,max:m}};q.calculateHeatmapIntensityInfoReaders=function(a,b,c,g){const {blurRadius:h,fieldOffset:k,field:n}=b;b=new Float64Array(c*g);const e=y(h),l=Math.round(3*h);let m=Number.NEGATIVE_INFINITY;const d=E(n,k),f=new Set;for(const H of a)for(a=H.getCursor();a.next();){var u=a.getObjectId();if(f.has(u))continue;f.add(u);var r=a.readLegacyPointGeometry();
if(-128>r.x||r.x>=c+128||-128>r.y||r.y>g+128)continue;u=+d(a);const F=Math.round(r.x)-l,G=Math.round(r.y)-l,I=Math.max(0,F);var p=Math.max(0,G);const z=Math.min(g,Math.round(r.y)+l);r=Math.min(c,Math.round(r.x)+l);for(let A=p;A<z;A++){const B=e[A-G];for(let D=I;D<r;D++)p=b[A*c+D]+=B*e[D-F]*u,p>m&&(m=p)}}return{matrix:b.buffer,max:m}};q.createHeatmapImageData=x;q.createKernel=y;q.createValueFunction=w;q.createValueFunctionCursor=E;q.drawHeatmap=function(a,b,c,g,h,k){a.canvas.width=a.canvas.height=
b;a.clearRect(0,0,b,b);const n=a.getImageData(0,0,b,b);c&&g&&n.data.set(new Uint8ClampedArray(x(b,c,g,h,k)));a.putImageData(n,0,0)};q.generateGradient=C;Object.defineProperty(q,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../core/HandleOwner".split(" "),
function(q,v,t,x,y,w,E,C,a,b,c,g){t=function(h){function k(e){e=h.call(this,e)||this;e.tiles=new Map;return e}q._inheritsLoose(k,h);var n=k.prototype;n.destroy=function(){this.tiles.clear();this.layer=this.layerView=this.tileInfoView=this.tiles=null};n.acquireTile=function(e){const l=this.createTile(e);l.once("isReady",()=>this.notifyChange("updating"));this.tiles.set(e.id,l);return l};n.forceAttributeTextureUpload=function(){};n.forEachTile=function(e){this.tiles.forEach(e)};n.releaseTile=function(e){this.tiles.delete(e.key.id);
this.disposeTile(e)};n.isUpdating=function(){let e=!0;this.tiles.forEach(l=>{e=e&&l.isReady});return!e};n.setHighlight=function(){};n.invalidateLabels=function(){};n.requestUpdate=function(){this.layerView.requestUpdate()};q._createClass(k,[{key:"updating",get:function(){return this.isUpdating()}}]);return k}(g.HandleOwner);v.__decorate([w.property()],t.prototype,"layer",void 0);v.__decorate([w.property()],t.prototype,"layerView",void 0);v.__decorate([w.property()],t.prototype,"tileInfoView",void 0);
v.__decorate([w.property()],t.prototype,"updating",null);return t=v.__decorate([C.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],t)})},"esri/views/2d/layers/features/tileRenderers/support/HeatmapSource":function(){define(["exports","../../../../../../renderers/support/heatmapUtils"],function(q,v){let t=function(){function x(){this.gradient=null;this.width=this.height=512}x.prototype.render=function(y){v.drawHeatmap(y,512,this.intensities,this.gradient,this.minPixelIntensity,
this.maxPixelIntensity)};return x}();q.HeatmapSource=t;Object.defineProperty(q,"__esModule",{value:!0})})},"*noref":1}});
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../renderers/support/heatmapUtils ../../../engine/BitmapTileContainer ./BaseTileRenderer ./support/HeatmapSource".split(" "),function(q,
v,t,x,y,w,E,C,a,b,c,g,h,k,n){t=function(e){function l(d){var f=e.call(this,d)||this;f._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0};f.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}};f._container=new h.BitmapTileContainer(d.tileInfoView);return f}q._inheritsLoose(l,e);var m=l.prototype;m.createTile=function(d){const f=this._container.createTile(d);this.tileInfoView.getTileCoords(f.bitmap,d);f.bitmap.resolution=this.tileInfoView.getTileResolution(d);
return f};m.onConfigUpdate=function(){const d=this.layer.renderer;if("heatmap"===d.type){const {minPixelIntensity:f,maxPixelIntensity:u}=d;this._intensityInfo.minPixelIntensity=f;this._intensityInfo.maxPixelIntensity=u;this._gradient=g.generateGradient(d.toJSON());this.tiles.forEach(r=>{const p=r.bitmap.source;p&&(p.minPixelIntensity=f,p.maxPixelIntensity=u,p.gradient=this._gradient,r.bitmap.invalidateTexture())})}};m.hitTest=function(){return Promise.resolve([])};m.install=function(d){d.addChild(this._container)};
m.uninstall=function(d){this._container.removeAllChildren();d.removeChild(this._container)};m.disposeTile=function(d){this._container.removeChild(d);d.destroy()};m.supportsRenderer=function(d){return d&&"heatmap"===d.type};m.onTileData=function(d){const f=this.tiles.get(d.tileKey);if(f){d=d.intensityInfo;var {minPixelIntensity:u,maxPixelIntensity:r}=this._intensityInfo,p=f.bitmap.source||new n.HeatmapSource;p.intensities=d&&d.matrix||null;p.minPixelIntensity=u;p.maxPixelIntensity=r;p.gradient=this._gradient;
f.bitmap.source=p;this._container.addChild(f);this.requestUpdate()}};m.onTileError=function(d){console.error(d)};m.lockGPUUploads=function(){};m.unlockGPUUploads=function(){};return l}(k);return t=v.__decorate([C.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],t)});