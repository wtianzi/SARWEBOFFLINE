// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/promiseUtils ../../../../engine/webgl/enums ../../../../engine/brushes ../../../../engine/FeatureContainer".split(" "),function(m,n,p,k,c,l){l=function(e){function g(a,b,f){a=e.call(this,a)||this;a._pointToCallbacks=new Map;a._layer=f;a._layerView=b;return a}n._inheritsLoose(g,e);var d=g.prototype;d.renderChildren=function(a){this.attributeView.update();this.hasAnimation&&a.painter.effects.integrate.draw(a,a.attributeView);
e.prototype.renderChildren.call(this,a)};d.hitTest=function(a,b){a=[a,b];b=p.createResolver();this._pointToCallbacks.set(a,b);this.requestRender();return b.promise};d.onTileData=function(a,b){a.patch(b);this.contains(a)||this.addChild(a);this.requestRender()};d.onTileError=function(a){this.contains(a)||this.addChild(a)};d.doRender=function(a){const {minScale:b,maxScale:f}=this._layer,h=a.state.scale;h<=(b||Infinity)&&h>=f&&e.prototype.doRender.call(this,a)};d.onAttributeStoreUpdate=function(){this.hasLabels&&
this._layerView.view.labelManager.requestUpdate()};d.prepareRenderPasses=function(a){const b=a.registerRenderPass({name:"label",brushes:[c.brushes.label],target:()=>this.hasLabels?this.children:null,drawPhase:k.WGLDrawPhase.LABEL|k.WGLDrawPhase.LABEL_ALPHA}),f=a.registerRenderPass({name:"geometry",brushes:[c.brushes.fill,c.brushes.line,c.brushes.marker,c.brushes.text],target:()=>this.children,enableDefaultDraw:()=>!this._layerView.hasEffects,effects:[{apply:a.effects.outsideEffect,enable:()=>this._layerView.hasEffects,
args:()=>this._layerView.effectLists.excluded},{apply:a.effects.insideEffect,enable:()=>this._layerView.hasEffects,args:()=>this._layerView.effectLists.included},{apply:a.effects.hittest,enable:()=>!!this._pointToCallbacks.size,args:()=>this._pointToCallbacks}]}),h=a.registerRenderPass({name:"highlight",brushes:[c.brushes.fill,c.brushes.line,c.brushes.marker,c.brushes.text],target:()=>this.children,drawPhase:k.WGLDrawPhase.HIGHLIGHT,enableDefaultDraw:()=>!1,effects:[{apply:a.effects.highlight,enable:()=>
!!this._layerView.hasHighlight()}]});return[...e.prototype.prepareRenderPasses.call(this,a),f,h,b]};n._createClass(g,[{key:"hasAnimation",get:function(){return this.hasLabels}},{key:"hasLabels",get:function(){var a=this._layer.featureReduction;a=a&&"cluster"===a.type&&a.labelsVisible&&a.labelingInfo&&a.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!a}},{key:"labelsVisible",get:function(){return this._layer.labelsVisible}}]);return g}(l.FeatureContainer);
m.WGLFeatureView=l;Object.defineProperty(m,"__esModule",{value:!0})});