// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/asyncUtils ../../../../../geometry/support/aaBoundingRect".split(" "),function(g,m,n,h,k,e){let p=function(){function f(a,b){this.data=a;this.resolution=b;this.state={type:0};this.alive=!0}var d=f.prototype;d.process=function(a){switch(this.state.type){case 0:return this.state=this.gotoFetchCount(this.state,a),this.state.task.promise.then(a.resume,a.resume);
case 2:return this.state=this.gotoFetchFeatures(this.state,a),this.state.task.promise.then(a.resume,a.resume);case 4:this.state=this.goToDone(this.state,a)}return null};d.gotoFetchCount=function(a,b){return{type:1,previous:a,task:h.createTask(async c=>{c=await k.resultOrAbort(b.fetchCount(this,c));1===this.state.type&&(this.state=this.gotoFetchedCount(this.state,c.ok?c.value:Infinity))})}};d.gotoFetchedCount=function(a,b){return{type:2,featureCount:b,previous:a}};d.gotoFetchFeatures=function(a,b){return{type:3,
previous:a,task:h.createTask(async c=>{c=await k.resultOrAbort(b.fetchFeatures(this,a.featureCount,c));3===this.state.type&&(this.state=this.gotoFetchedFeatures(this.state,c.ok?c.value:[]))})}};d.gotoFetchedFeatures=function(a,b){return{type:4,previous:a,features:b}};d.goToDone=function(a,b){b.finish(this,a.features);return{type:5,previous:a}};d.reset=function(){const a=this.state;this.state={type:0};switch(a.type){case 1:case 3:a.task.abort()}};d.intersects=function(a){if(n.isNone(a)||!this.data.extent)return!0;
e.fromExtent(a,l);return e.intersects(this.data.extent,l)};m._createClass(f,[{key:"debugInfo",get:function(){return{data:this.data,featureCount:this.featureCount,state:this.stateToString}}},{key:"featureCount",get:function(){switch(this.state.type){case 0:case 1:return 0;case 2:return this.state.featureCount;case 3:return this.state.previous.featureCount;case 4:return this.state.features.length;case 5:return this.state.previous.features.length}}},{key:"stateToString",get:function(){switch(this.state.type){case 0:return"created";
case 1:return"fetch-count";case 2:return"fetched-count";case 3:return"fetch-features";case 4:return"fetched-features";case 5:return"done"}}}]);return f}();const l=e.create();g.PendingFeatureTile=p;Object.defineProperty(g,"__esModule",{value:!0})});