// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../support/mathUtils ../lib/Util ../lib/localOrigin ../lib/WebGLLayer ../lib/RenderGeometry ../lib/ModelDirtySet".split(" "),
function(g,m,n,B,C,D,t,E,u,F,G,H,v,w,p,x,q,y,z){const h=p.assert,A=p.logWithBase;g.Model=function(r){function k(){var a=r.call(this)||this;a.dirtySet=new z({model:m._assertThisInitialized(a)});a._id2origin=new Map;a._content=new Map;return a}m._inheritsLoose(k,r);var d=k.prototype;d.getObject=function(a){return this._content.get(a)};d.add=function(a){const b=a.id;h(!this._content.has(b),"Model/Stage already contains object to be added");this._content.set(b,a);q.isWebGLLayer(a)&&this.dirtySet.layerAdded(a)};
d.remove=function(a){h(this._content.has(a.id),"Model/Stage doesn't contain object to be removed");this._content.delete(a.id);a.unload();q.isWebGLLayer(a)&&this.dirtySet.layerRemoved(a)};d.addMany=function(a){for(const b of a)h(!this._content.has(b.id),"Model/Stage already contains object to be added"),this._content.set(b.id,b)};d.removeMany=function(a){for(const b of a)h(this._content.has(b.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(b.id),b.unload()};d.forEachOfType=
function(a,b){this._content.forEach(c=>{c.type===a&&b(c)})};d._getOrigin=function(a){var b=0,c=10*a[3]/1E4;1<c&&(b=Math.ceil(A(c,2)));c=1E4*2**b;const e=Math.round(a[0]/c),l=Math.round(a[1]/c);a=Math.round(a[2]/c);b=b+"_"+e+"_"+l+"_"+a;let f=this._id2origin.get(b);null==f&&(f=x.fromValues(e*c,l*c,a*c,b),this._id2origin.set(b,f));return f};d.getRenderGeometry=function(a,b){const c=b.geometry,e=a.getCombinedStaticTransformation(b),l=w.maxScale(e),f=b.origin;a=new y.RenderGeometry(c,b.material,null,
null,c.boundingInfo,e,b.shaderTransformation,l,a.castShadow);a.id=b.id;a.origin=f||this._getOrigin(a.boundingSphere);a.instanceParameters=b.instanceParameters;return a};d.updateRenderGeometryTransformation=function(a,b,c){a=a.getCombinedStaticTransformation(b,c.transformation);c.updateTransformation(a);a=this._getOrigin(c.boundingSphere);return c.origin!==a};d.getStats=function(){const a={},b=Array.from(this._content.values());for(let c=0;5>c;++c)a[c]=b.filter(e=>e.type===c).length;return{contentTypes:a,
dirtySet:this.dirtySet.formatDebugInfo()}};m._createClass(k,[{key:"test",get:function(){return{content:Array.from(this._content.values())}}}]);return k}(v);n.__decorate([t.property({constructOnly:!0})],g.Model.prototype,"dirtySet",void 0);g.Model=n.__decorate([u.subclass("esri.views.3d.webgl-engine.parts.Model")],g.Model);Object.defineProperty(g,"__esModule",{value:!0})});