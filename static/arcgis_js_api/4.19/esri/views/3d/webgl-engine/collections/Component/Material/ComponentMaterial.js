// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/tslib.es6 ../../../../../../core/maybe ../../../../../../chunks/vec3 ../../../../../../chunks/vec4f64 ../../../../../../chunks/vec4 ../../../../../../chunks/vec4f32 ../../../../../../chunks/vec3f32 ../../../core/shaderLibrary/util/AlphaDiscard.glsl ../../../../../../chunks/ComponentShader.glsl ./ComponentTechnique ../../../core/material/MaterialBase".split(" "),function(u,q,d,l,p,y,t,z,A,C,D,B,c){function E(m){switch(m){case 0:return 0;
case 1:return 7;case 2:return 1;case 3:return 2;case 4:return 8}}let f=function(m){function k(){var a=m.call(this)||this;a.baseColor=z.fromValues(1,1,1,1);a.usePBR=!1;a.hasParametersFromSource=!1;a.mrrFactors=A.fromValues(1,1,.5);a.emissiveFactor=A.fromValues(0,0,0);a.baseColorTexture=null;a.metallicRoughnessTexture=null;a.emissionTexture=null;a.occlusionTexture=null;a.normalTexture=null;a.overlayTexOffset=y.fromValues(-1,-1,-1,-1);a.overlayTexScale=y.fromValues(0,0,0,0);a.overlayColorInner=null;
a.overlayColorOuter=null;a.overlayHighlightInner=null;a.overlayHighlightOuter=null;a.overlayNormalInner=null;a.overlayNormalOuter=null;a.objectOpacity=1;a.commonMaterialParameters=new v;a.componentParameters=new w;a.alphaCutoff=C.defaultMaskAlphaCutoff;a.alphaDiscardMode=1;a.isIntegratedMesh=!1;a.polygonOffsetEnabled=!1;a.ellipsoidMode=1;a.sceneHasOcludees=!1;a._techniqueConfig=new B.ComponentTechniqueConfiguration;return a}q._inheritsLoose(k,m);var g=k.prototype;g.dispose=function(a){this._technique&&
(a.release(this._technique),this._technique=void 0);this.normalTexture=this.occlusionTexture=this.emissionTexture=this.metallicRoughnessTexture=this.baseColorTexture=null};g.getTechnique=function(a,e,h){const b=this._techniqueConfig;b.hasVertexColors=h.colors;b.hasNormals=h.normals;b.vertexTextureCoordinates=h.textureCoordinates;b.usePBR=this.usePBR;b.hasMetalnessAndRoughnessTexture=l.isSome(this.metallicRoughnessTexture);b.hasEmissionTexture=l.isSome(this.emissionTexture);b.hasOcclusionTexture=l.isSome(this.occlusionTexture);
b.hasNormalTexture=l.isSome(this.normalTexture);b.transparencyPassType=0===e.identifier&&null!=e.transparencyPassType?e.transparencyPassType:3;b.multipassTerrainEnabled=0===e.identifier&&null!=e.multipassTerrainParams?e.multipassTerrainParams.multipassTerrainEnabled:!1;b.cullAboveGround=0===e.identifier&&null!=e.multipassTerrainParams?e.multipassTerrainParams.cullAboveGround:!1;b.ellipsoidMode=this.ellipsoidMode;this.dirty&&(b.componentData=this.componentParameters.type,b.cullFace=this.commonMaterialParameters.cullFace,
b.doubleSidedMode=this.commonMaterialParameters.doubleSided?1:0,b.baseColorTexture=l.isSome(this.baseColorTexture),b.isSchematic=this.hasParametersFromSource&&!l.isSome(this.baseColorTexture),h=this._computeWhichMaterialPass(),b.blendingEnabled=1===h||2===h,b.alphaDiscardMode=this.alphaDiscardMode,b.integratedMeshMode=this.isIntegratedMesh?this.overlayColorInner||this.overlayColorOuter?this.overlayNormalInner||this.overlayNormalOuter?3:2:1:0,b.polygonOffsetEnabled=this.polygonOffsetEnabled,this._setClean());
b.slicePlaneEnabled=e.slicePlaneEnabled&&this.commonMaterialParameters.slicePlaneEnabled;1===e.identifier?(b.output=3,b.vertexDiscardMode=0):2===e.identifier?(b.output=4,b.vertexDiscardMode=0):(2===this._computeWhichMaterialPass()?b.vertexDiscardMode=e.transparent?2:1:b.vertexDiscardMode=0,b.output=E(e.subPass),1===e.subPass&&(b.sceneHasOcludees=e.sceneHasOcludees),0===e.subPass?(b.receiveAmbientOcclusion=e.ambientOcclusionEnabled,b.sceneHasOcludees=e.sceneHasOcludees,b.receiveShadows=e.shadowsEnabled,
b.ssrEnabled=e.ssrParams.ssrEnabled):(b.receiveAmbientOcclusion=!1,b.receiveShadows=!1));return this._technique=a.repository.acquireAndReleaseExisting(B.ComponentTechnique,b,this._technique)};g.submit=function(a,e){const h=e.renderable.geometry;var b=e.components;const n=e.renderable.drawParameters;e=e.renderable.meta.cameraDepthSquared;const r=b.geometryRanges,x=b.highlightRanges;b=b.defaultShadowMapRanges;switch(this._computeWhichMaterialPass()){case 0:a.materialOpaque.submitDraw(this,h,r,n,e);
break;case 1:a.materialTransparent.submitDraw(this,h,r,n,e);break;case 2:a.materialOpaque.submitDraw(this,h,r,n,e);a.materialTransparent.submitDraw(this,h,r,n,e);break;case 3:a.materialIntegratedMesh.submitDraw(this,h,r,n,e),(this.overlayHighlightInner||this.overlayHighlightOuter)&&a.highlightIntegratedMesh.submitDraw(this,h,r,n,e)}l.isSome(a.shadowMap)&&2!==this.componentParameters.castShadows&&a.shadowMap.submitDraw(this,h,r,n,e);l.isSome(a.highlight)&&l.isSome(x)&&a.highlight.submitDraw(this,h,
x,n,e);l.isSome(a.highlightShadowMap)&&2!==this.componentParameters.castShadows&&l.isSome(x)&&a.highlightShadowMap.submitDraw(this,h,x,n,e);l.isSome(a.defaultShadowMap)&&2!==this.componentParameters.castShadows&&l.isSome(b)&&a.defaultShadowMap.submitDraw(this,h,b,n,e)};g._computeWhichMaterialPass=function(){return this.isIntegratedMesh?3:1>this.objectOpacity?1:0===this.componentParameters.opaqueOverride?0:1>this.baseColor[3]||0===this.alphaDiscardMode||3===this.alphaDiscardMode?1:2===this.componentParameters.transparent?
0:0===this.componentParameters.transparent?1:2};q._createClass(k,[{key:"attributeLocations",get:function(){return D.attributeLocations}}]);return k}(c.MaterialBase);d.__decorate([c.parameter({vectorOps:t.vec4})],f.prototype,"baseColor",void 0);d.__decorate([c.parameter()],f.prototype,"usePBR",void 0);d.__decorate([c.parameter()],f.prototype,"hasParametersFromSource",void 0);d.__decorate([c.parameter({vectorOps:p.vec3})],f.prototype,"mrrFactors",void 0);d.__decorate([c.parameter({vectorOps:p.vec3})],
f.prototype,"emissiveFactor",void 0);d.__decorate([c.parameter({dispose:!0})],f.prototype,"baseColorTexture",void 0);d.__decorate([c.parameter({dispose:!0})],f.prototype,"metallicRoughnessTexture",void 0);d.__decorate([c.parameter({dispose:!0})],f.prototype,"emissionTexture",void 0);d.__decorate([c.parameter({dispose:!0})],f.prototype,"occlusionTexture",void 0);d.__decorate([c.parameter({dispose:!0})],f.prototype,"normalTexture",void 0);d.__decorate([c.parameter({vectorOps:{equals:t.exactEquals,copy:t.copy}})],
f.prototype,"overlayTexOffset",void 0);d.__decorate([c.parameter({vectorOps:{equals:t.exactEquals,copy:t.copy}})],f.prototype,"overlayTexScale",void 0);d.__decorate([c.parameter()],f.prototype,"overlayColorInner",void 0);d.__decorate([c.parameter()],f.prototype,"overlayColorOuter",void 0);d.__decorate([c.parameter()],f.prototype,"overlayHighlightInner",void 0);d.__decorate([c.parameter()],f.prototype,"overlayHighlightOuter",void 0);d.__decorate([c.parameter()],f.prototype,"overlayNormalInner",void 0);
d.__decorate([c.parameter()],f.prototype,"overlayNormalOuter",void 0);d.__decorate([c.parameter()],f.prototype,"objectOpacity",void 0);d.__decorate([c.parameterBlock()],f.prototype,"commonMaterialParameters",void 0);d.__decorate([c.parameterBlock()],f.prototype,"componentParameters",void 0);d.__decorate([c.parameter()],f.prototype,"alphaCutoff",void 0);d.__decorate([c.parameter()],f.prototype,"alphaDiscardMode",void 0);d.__decorate([c.parameter()],f.prototype,"isIntegratedMesh",void 0);d.__decorate([c.parameter()],
f.prototype,"polygonOffsetEnabled",void 0);d.__decorate([c.parameter()],f.prototype,"ellipsoidMode",void 0);d.__decorate([c.parameter()],f.prototype,"sceneHasOcludees",void 0);let v=function(m){function k(){var g=m.apply(this,arguments)||this;g.doubleSided=!1;g.cullFace=2;g.slicePlaneEnabled=!0;return g}q._inheritsLoose(k,m);return k}(c.MaterialParameterBlock);d.__decorate([c.parameter()],v.prototype,"doubleSided",void 0);d.__decorate([c.parameter()],v.prototype,"cullFace",void 0);d.__decorate([c.parameter()],
v.prototype,"slicePlaneEnabled",void 0);let w=function(m){function k(){var g=m.apply(this,arguments)||this;g.externalColor=z.fromValues(1,1,1,1);g.externalColorMixMode=1;g.castShadows=0;return g}q._inheritsLoose(k,m);q._createClass(k,[{key:"transparent",get:function(){return 1>this.externalColor[3]?0:2}},{key:"opaqueOverride",get:function(){return 3===this.externalColorMixMode&&1===this.externalColor[3]?0:2}},{key:"visible",get:function(){return 0<this.externalColor[3]?0:2}},{key:"type",get:function(){return 0}}]);
return k}(c.MaterialParameterBlock);d.__decorate([c.parameter({vectorOps:t.vec4})],w.prototype,"externalColor",void 0);d.__decorate([c.parameter()],w.prototype,"externalColorMixMode",void 0);d.__decorate([c.parameter()],w.prototype,"castShadows",void 0);p=function(m){function k(){var g=m.apply(this,arguments)||this;g.texture=null;g.transparent=2;g.opaqueOverride=2;g.castShadows=2;return g}q._inheritsLoose(k,m);q._createClass(k,[{key:"type",get:function(){return 1}}]);return k}(c.MaterialParameterBlock);
d.__decorate([c.parameter()],p.prototype,"texture",void 0);d.__decorate([c.parameter()],p.prototype,"transparent",void 0);d.__decorate([c.parameter()],p.prototype,"opaqueOverride",void 0);d.__decorate([c.parameter()],p.prototype,"castShadows",void 0);u.CommonMaterialParameters=v;u.ComponentMaterial=f;u.ComponentParametersUniform=w;u.ComponentParametersVarying=p;Object.defineProperty(u,"__esModule",{value:!0})});