// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../chunks/vec4f64 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../../../webgl/Program ../../../webgl/renderState ../core/shaderLibrary/util/View.glsl ../core/shaderLibrary/Slice.glsl ../lib/OrderIndependentTransparency ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/ScreenSizeScaling.glsl ../../../../chunks/ShadedColorMaterial.glsl".split(" "),
function(x,n,u,g,y,e,p,f,z,r,t,A,q,B,C,D){p=function(m){function k(){return m.apply(this,arguments)||this}u._inheritsLoose(k,m);var d=k.prototype;d.initializeProgram=function(c){var b=k.shader.get();const a=this.configuration;b=b.build({output:a.output,slicePlaneEnabled:a.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:a.screenSizeEnabled,shadingEnabled:a.shadingEnabled,OITEnabled:0===a.transparencyPassType,multipassTerrainEnabled:a.multipassTerrainEnabled,
cullAboveGround:a.cullAboveGround});return new z(c.rctx,b.generateSource("vertex"),b.generateSource("fragment"),v)};d.bindPass=function(c,b,a){const {screenSizeEnabled:l,shadingEnabled:h}=this.configuration,{color:w,shadingTint:E,shadingDirection:F}=b;t.View.bindProjectionMatrix(this.program,a.camera.projectionMatrix);this.program.setUniform4fv("color",w);a.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",a.camera.nearFar),this.program.setUniform2fv("inverseViewport",a.inverseViewport),
B.bindMultipassTerrainUniforms(this.program,c,a));h&&(this.program.setUniform4fv("shadedColor",this.blendColor(G,E,w)),this.program.setUniform3fv("shadingDirection",F),this.program.setUniformMatrix4fv("viewNormal",a.camera.viewInverseTransposeMatrix));l&&C.ScreenSizeScaling.bindPassUniforms(this.program,b,a)};d.blendColor=function(c,b,a){const l=1-b[3],h=b[3]+a[3]*l;if(0===h)return c[3]=h,c;c[0]=(b[0]*b[3]+a[0]*a[3]*l)/h;c[1]=(b[1]*b[3]+a[1]*a[3]*l)/h;c[2]=(b[2]*b[3]+a[2]*a[3]*l)/h;c[3]=a[3];return c};
d.bindDraw=function(c){t.View.bindView(this.program,c);t.View.bindCamPosition(this.program,c.origin,c.camera.viewInverseTransposeMatrix);A.Slice.bindUniformsWithOrigin(this.program,this.configuration,c)};d.setPipelineState=function(c){const b=this.configuration,a=3===c,l=2===c;return r.makePipelineState({blending:0!==b.output&&7!==b.output||!b.transparent?null:a?q.blendingDefault:q.OITBlending(c),culling:(h=>0!==h&&{face:1===h?1028:1029,mode:2305})(b.cullFace),depthTest:{func:l?513:b.shadingEnabled?
515:513},depthWrite:a?b.writeDepth&&r.defaultDepthWriteParams:q.OITDepthWrite(c),colorWrite:r.defaultColorWriteParams,polygonOffset:a||l?null:q.OITPolygonOffset})};d.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)};return k}(p.ShaderTechnique);p.shader=new e.ReloadableShaderModule(D.ShadedColorMaterialShader,()=>new Promise(function(m,k){x(["./ShadedColorMaterial.glsl"],m,k)}));e=function(m){function k(){var d=m.apply(this,arguments)||this;d.output=
0;d.cullFace=0;d.slicePlaneEnabled=!1;d.transparent=!1;d.writeDepth=!0;d.screenSizeEnabled=!0;d.shadingEnabled=!0;d.transparencyPassType=3;d.multipassTerrainEnabled=!1;d.cullAboveGround=!0;return d}u._inheritsLoose(k,m);return k}(f.ShaderTechniqueConfiguration);g.__decorate([f.parameter({count:8})],e.prototype,"output",void 0);g.__decorate([f.parameter({count:3})],e.prototype,"cullFace",void 0);g.__decorate([f.parameter()],e.prototype,"slicePlaneEnabled",void 0);g.__decorate([f.parameter()],e.prototype,
"transparent",void 0);g.__decorate([f.parameter()],e.prototype,"writeDepth",void 0);g.__decorate([f.parameter()],e.prototype,"screenSizeEnabled",void 0);g.__decorate([f.parameter()],e.prototype,"shadingEnabled",void 0);g.__decorate([f.parameter({count:4})],e.prototype,"transparencyPassType",void 0);g.__decorate([f.parameter()],e.prototype,"multipassTerrainEnabled",void 0);g.__decorate([f.parameter()],e.prototype,"cullAboveGround",void 0);const v={position:0,normal:1,offset:2},G=y.create();n.ShadedColorMaterialTechnique=
p;n.ShadedColorMaterialTechniqueConfiguration=e;n.ShadedColorMaterialVertexAttrLocations=v;Object.defineProperty(n,"__esModule",{value:!0})});