// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ./Lightsources ../lib/LongVectorMath".split(" "),function(f,A,B,n,k,e){function p(d){return(d+1)*(d+1)}function w(d){return A.clamp(Math.floor(Math.sqrt(d)-1),0,2)}function q(d,b,a){const c=d[0],l=d[1];d=d[2];a=a||[];a.length=p(b);0<=b&&(a[0]=.28209479177);1<=b&&(a[1]=.4886025119*c,a[2]=.4886025119*d,a[3]=.4886025119*l);2<=b&&(a[4]=1.09254843059*c*l,a[5]=1.09254843059*l*d,a[6]=.31539156525*(3*d*d-1),a[7]=
1.09254843059*c*d,a[8]=.54627421529*(c*c-l*l));return a}function x(d,b){d=p(d);b=b||{r:[],g:[],b:[]};b.r.length=b.g.length=b.b.length=d;for(let a=0;a<d;a++)b.r[a]=b.g[a]=b.b[a]=0;return b}function y(d,b){const a=w(b.r.length);for(const c of d)n.negate(r,c.direction),q(r,a,g),e.elementwiseProduct(g,m),e.scalarProduct(g,c.intensity[0],h),e.add(b.r,h),e.scalarProduct(g,c.intensity[1],h),e.add(b.g,h),e.scalarProduct(g,c.intensity[2],h),e.add(b.b,h);return b}function z(d,b){q(r,0,g);for(const a of d)b.r[0]+=
g[0]*m[0]*a.intensity[0]*4*Math.PI,b.g[0]+=g[0]*m[0]*a.intensity[1]*4*Math.PI,b.b[0]+=g[0]*m[0]*a.intensity[2]*4*Math.PI;return b}const t=[],u=[],v=[],g=[0],h=[0],r=B.create(),m=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];f.combineLights=function(d,b,a){x(b,a.sphericalHarmonics.sh);n.set(a.main.intensity,0,0,0);b=!1;t.length=0;u.length=0;v.length=0;for(const c of d)c instanceof k.MainLight&&!b?(n.copy(a.main.direction,c.direction),a.main.intensity[0]=c.intensity[0],
a.main.intensity[1]=c.intensity[1],a.main.intensity[2]=c.intensity[2],a.main.castShadows=c.castShadows,b=!0):c instanceof k.MainLight||c instanceof k.FillLight?t.push(c):c instanceof k.AmbientLight?u.push(c):c instanceof k.SphericalHarmonicsLight&&v.push(c);y(t,a.sphericalHarmonics.sh);z(u,a.sphericalHarmonics.sh);for(const c of v)e.add(a.sphericalHarmonics.sh.r,c.sh.r),e.add(a.sphericalHarmonics.sh.g,c.sh.g),e.add(a.sphericalHarmonics.sh.b,c.sh.b)};f.computeCoefficients=q;f.initSHCoefficients=x;
f.numberOfCoefficients=p;f.numberOfCoefficientsInBand=function(d){return 2*d+1};f.orderFromNumberOfCoefficients=w;f.projectAmbientLights=z;f.projectFillLights=y;Object.defineProperty(f,"__esModule",{value:!0})});