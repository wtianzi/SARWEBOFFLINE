// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/PooledArray"],function(q,r,t){let u=function(){function m(d,c,e=0){this._rctx=d;this._techniqueRepository=c;this._sorting=e;this._draws=new t({initialSize:32,allocator:f=>f||{material:null,geometry:null,geometryRanges:null,bindDrawParams:null,depthSquaredHint:0,indexType:0}});this._passBoundTechniques=new Set;this._previouslyBoundMaterials=new Map;this._previouslyBoundDraw=new Map}var g=m.prototype;g.submitDraw=
function(d,c,e,f,n){const a=this._draws.pushNew();a.geometry=c;a.geometryRanges=e;a.material=d;a.bindDrawParams=f;a.depthSquaredHint=n;a.indexType=c.indexed?c.vao.indexBuffer.indexType:0};g.dispatch=function(d){const c=this._rctx;this._passBoundTechniques.clear();this._previouslyBoundMaterials.clear();this._previouslyBoundDraw.clear();let e=null;const f={repository:this._techniqueRepository},n=this._draws.length;for(let p=0;p<n;p++){const b=this._draws.data[p],h=b.geometry;var a=b.material.getTechnique(f,
d,h.parameters);this._passBoundTechniques.has(a)||(a.bindPass(c,d),this._passBoundTechniques.add(a));c.bindVAO(h.vao);if(a!==e||3!==a.configuration.transparencyPassType)c.bindProgram(a.program),c.setPipelineState(a.pipeline),e=a;this._previouslyBoundMaterials.get(a)!==b.material&&(a.bindMaterial(c,b.material,d),this._previouslyBoundMaterials.set(a,b.material));this._previouslyBoundDraw.get(a)!==b.bindDrawParams&&(a.bindDraw(b.bindDrawParams,b.material,d),this._previouslyBoundMaterials.set(a,b.material));
if(0!==b.indexType){a=k.get(b.indexType);for(let l=0;l<b.geometryRanges.length;l+=2)c.drawElements(h.primitiveType,b.geometryRanges[l+1],b.indexType,b.geometryRanges[l]*a)}else for(a=0;a<b.geometryRanges.length;a+=2)c.drawArrays(h.primitiveType,b.geometryRanges[a],b.geometryRanges[a+1])}};g.prepareSubmit=function(){this._draws.clear()};g.finishSubmit=function(){const d=0===this._sorting?1:-1;this._draws.sort((c,e)=>{const f=d*(c.depthSquaredHint-e.depthSquaredHint);return 0!==f?f:c.geometry.vao.size-
e.geometry.vao.size})};r._createClass(m,[{key:"count",get:function(){return this._draws.length}}]);return m}();const k=new Map;k.set(5121,1);k.set(5123,2);k.set(5125,4);q.RenderPass=u;Object.defineProperty(q,"__esModule",{value:!0})});