// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../../../support/buffer/BufferView","../../lib/Util"],function(p,z,A){function H(l,b,a,f){const c=a.typedBuffer;a=a.typedBufferStride;const h=l.length;f*=a;for(let d=0;d<h;++d){const g=2*l[d];c[f]=b[g];c[f+1]=b[g+1];f+=a}}function E(l,b,a,f,c){const h=a.typedBuffer;a=a.typedBufferStride;const d=l.length;f*=a;if(null==c||1===c)for(c=0;c<d;++c){var g=3*l[c];h[f]=b[g];h[f+1]=b[g+1];h[f+2]=b[g+2];f+=a}else for(g=0;g<d;++g){const e=3*l[g];for(let k=0;k<c;++k)h[f]=b[e],h[f+1]=b[e+1],
h[f+2]=b[e+2],f+=a}}function I(l,b,a,f,c=1){const h=a.typedBuffer;a=a.typedBufferStride;const d=l.length;f*=a;if(1===c)for(c=0;c<d;++c){var g=4*l[c];h[f]=b[g];h[f+1]=b[g+1];h[f+2]=b[g+2];h[f+3]=b[g+3];f+=a}else for(g=0;g<d;++g){const e=4*l[g];for(let k=0;k<c;++k)h[f]=b[e],h[f+1]=b[e+1],h[f+2]=b[e+2],h[f+3]=b[e+3],f+=a}}function J(l,b,a,f,c,h=1){if(a){const n=f.typedBuffer;f=f.typedBufferStride;const C=l.length,q=a[0],r=a[1],t=a[2],u=a[4],v=a[5],w=a[6],x=a[8],y=a[9],D=a[10],B=a[12],K=a[13];a=a[14];
c*=f;if(1===h)for(h=0;h<C;++h){var d=3*l[h],g=b[d],e=b[d+1];d=b[d+2];n[c]=q*g+u*e+x*d+B;n[c+1]=r*g+v*e+y*d+K;n[c+2]=t*g+w*e+D*d+a;c+=f}else for(g=0;g<C;++g){e=3*l[g];var k=b[e],m=b[e+1];const F=b[e+2];e=q*k+u*m+x*F+B;d=r*k+v*m+y*F+K;k=t*k+w*m+D*F+a;for(m=0;m<h;++m)n[c]=e,n[c+1]=d,n[c+2]=k,c+=f}}else E(l,b,f,c,h)}function L(l,b,a,f,c,h){if(a){const n=f.typedBuffer;f=f.typedBufferStride;const C=l.length,q=a[0],r=a[1],t=a[2],u=a[4],v=a[5],w=a[6],x=a[8],y=a[9];a=a[10];const D=1E-5<Math.abs(1-q*q+u*u+
x*x)||1E-5<Math.abs(1-r*r+v*v+y*y)||1E-5<Math.abs(1-t*t+w*w+a*a);c*=f;if(1===h)for(h=0;h<C;++h){var d=3*l[h],g=b[d],e=b[d+1],k=b[d+2];d=q*g+u*e+x*k;var m=r*g+v*e+y*k;g=t*g+w*e+a*k;D&&(e=d*d+m*m+g*g,.999999>e&&1E-6<e&&(e=Math.sqrt(e),d/=e,m/=e,g/=e));n[c+0]=d;n[c+1]=m;n[c+2]=g;c+=f}else for(d=0;d<C;++d){m=3*l[d];e=b[m];k=b[m+1];const B=b[m+2];m=q*e+u*k+x*B;g=r*e+v*k+y*B;e=t*e+w*k+a*B;D&&(k=m*m+g*g+e*e,.999999>k&&1E-6<k&&(k=Math.sqrt(k),m/=k,g/=k,e/=k));for(k=0;k<h;++k)n[c+0]=m,n[c+1]=g,n[c+2]=e,c+=
f}}else E(l,b,f,c,h)}function G(l,b,a,f,c,h=1){const d=f.typedBuffer;f=f.typedBufferStride;const g=l.length;c*=f;if(1===h)if(4===a)for(h=0;h<g;++h)a=4*l[h],d[c]=b[a],d[c+1]=b[a+1],d[c+2]=b[a+2],d[c+3]=b[a+3],c+=f;else{if(3===a)for(h=0;h<g;++h)a=3*l[h],d[c]=b[a],d[c+1]=b[a+1],d[c+2]=b[a+2],d[c+3]=255,c+=f}else if(4===a)for(a=0;a<g;++a){var e=4*l[a];for(var k=0;k<h;++k)d[c]=b[e],d[c+1]=b[e+1],d[c+2]=b[e+2],d[c+3]=b[e+3],c+=f}else if(3===a)for(a=0;a<g;++a)for(e=3*l[a],k=0;k<h;++k)d[c]=b[e],d[c+1]=b[e+
1],d[c+2]=b[e+2],d[c+3]=255,c+=f}p.writeBufferMat3f=function(l,b,a,f){const c=a.typedBuffer;a=a.typedBufferStride;const h=l.length;f*=a;for(let d=0;d<h;++d){const g=9*l[d];for(let e=0;9>e;++e)c[f+e]=b[g+e];f+=a}};p.writeBufferMat4f=function(l,b,a,f){const c=a.typedBuffer;a=a.typedBufferStride;const h=l.length;f*=a;for(let d=0;d<h;++d){const g=16*l[d];for(let e=0;16>e;++e)c[f+e]=b[g+e];f+=a}};p.writeBufferVec2=H;p.writeBufferVec3=E;p.writeBufferVec4=I;p.writeColor=G;p.writeDefaultAttributes=function(l,
b,a,f,c,h){for(const g of b.fieldNames){b=l.vertexAttributes.get(g);const e=l.indices.get(g);if(b&&e)switch(g){case "position":A.assert(3===b.size);var d=c.getField(g,z.BufferViewVec3f);d&&J(e,b.data,a,d,h);break;case "normal":A.assert(3===b.size);(d=c.getField(g,z.BufferViewVec3f))&&L(e,b.data,f,d,h,1);break;case "uv0":A.assert(2===b.size);(d=c.getField(g,z.BufferViewVec2f))&&H(e,b.data,d,h);break;case "color":A.assert(3===b.size||4===b.size);(d=c.getField(g,z.BufferViewVec4u8))&&G(e,b.data,b.size,
d,h);break;case "symbolColor":A.assert(3===b.size||4===b.size);(d=c.getField(g,z.BufferViewVec4u8))&&G(e,b.data,b.size,d,h);break;case "tangent":A.assert(4===b.size),(d=c.getField(g,z.BufferViewVec4f))&&I(e,b.data,d,h)}}};p.writeNormal=L;p.writePosition=J;Object.defineProperty(p,"__esModule",{value:!0})});