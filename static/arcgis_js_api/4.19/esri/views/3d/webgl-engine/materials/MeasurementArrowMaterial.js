// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../shaders/MeasurementArrowTechnique".split(" "),function(y,z,n,c,G,H,A,B){let L=function(g){function e(a){a=g.call(this,a,I)||this;a.techniqueConfig=new B.MeasurementArrowTechniqueConfiguration;return a}z._inheritsLoose(e,g);var b=e.prototype;b.getTechniqueConfig=function(){this.techniqueConfig.polygonOffsetEnabled=
this.params.polygonOffset;return this.techniqueConfig};b.dispose=function(){};b.getPassParameters=function(){return this.params};b.intersect=function(){};b.createBufferWriter=function(){return new J};b.getGLMaterial=function(a){return 0===a.output?new K(a):void 0};return e}(A.Material),K=function(g){function e(a){a=g.call(this,a)||this;a.updateParameters();return a}z._inheritsLoose(e,g);var b=e.prototype;b.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(B.MeasurementArrowTechnique,
this.material.getTechniqueConfig(),this.technique)};b.beginSlot=function(a){return 3===a};b.bind=function(a,h){a.bindProgram(this.technique.program);this.technique.bindPass(a,this.material.getPassParameters(),h)};return e}(H);const I={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1,...A.materialParametersDefaults},M=G.newLayout().vec3f("position").vec3f("normal").vec2f("uv0").f32("auxpos1"),k=n.create(),p=n.create(),
t=n.create(),l=n.create(),u=n.create();let J=function(){function g(){this.vertexBufferLayout=M}var e=g.prototype;e.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};e.elementCount=function(b){return 2*(b.indices.get("position").length/2+1)};e.write=function(b,a,h,C){var f=a.vertexAttributes.get("position").data;const x=a.vertexAttributes.get("normal").data,q=f.length/3;(a=a&&a.indices&&a.indices.get("position"))&&a.length!==2*(q-1)&&console.warn("MeasurementArrowMaterial does not support indices");
a=b.transformation;const D=b.invTranspTransformation,E=h.position,F=h.normal,v=h.uv0;b=0;for(let m=0;m<q;++m){var d=3*m;c.set(k,f[d],f[d+1],f[d+2]);m<q-1&&(d=3*(m+1),c.set(p,f[d],f[d+1],f[d+2]),c.set(u,x[d],x[d+1],x[d+2]),c.normalize(u,u),c.subtract(t,p,k),c.normalize(t,t),c.cross(l,u,t),c.normalize(l,l));d=c.distance(k,p);a&&D&&(c.transformMat4(k,k,a),c.transformMat4(p,p,a),c.transformMat4(l,l,D));const r=C+2*m,w=r+1;E.setVec(r,k);E.setVec(w,k);F.setVec(r,l);F.setVec(w,l);v.set(r,0,b);v.set(r,1,
-1);v.set(w,0,b);v.set(w,1,1);m<q-1&&(b+=d)}h=h.auxpos1;for(f=0;f<2*q;++f)h.set(C+f,b)};return g}();y.MeasurementArrowMaterial=L;Object.defineProperty(y,"__esModule",{value:!0})});