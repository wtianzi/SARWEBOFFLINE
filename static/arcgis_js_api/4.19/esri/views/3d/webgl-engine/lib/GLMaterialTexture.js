// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./DefaultTextureUnits","./GLMaterial"],function(h,d,c,k){return function(g){function f(a){var b=g.call(this,a)||this;b._textureIDs=new Set;b._textureRepository=a.textureRep;b._textureId=a.textureId;b._initTransparent=!!a.initTextureTransparent;b._texture=b._acquireIfNotUndefined(b._textureId);b._textureNormal=b._acquireIfNotUndefined(a.normalTextureId);b._textureEmissive=b._acquireIfNotUndefined(a.emissiveTextureId);
b._textureOcclusion=b._acquireIfNotUndefined(a.occlusionTextureId);b._textureMetallicRoughness=b._acquireIfNotUndefined(a.metallicRoughnessTextureId);return b}h._inheritsLoose(f,g);var e=f.prototype;e.dispose=function(){this._textureIDs.forEach(a=>this._textureRepository.release(a));this._textureIDs.clear()};e.updateTexture=function(a){a!==this._textureId&&(this._releaseIfNotUndefined(this._textureId),this._textureId=a,this._texture=this._acquireIfNotUndefined(this._textureId))};e.bindTexture=function(a,
b){d.isSome(this._texture)&&(b.setUniform1i("tex",c.DefaultTextureUnits.DIFFUSE),a.bindTexture(this._texture.glTexture,c.DefaultTextureUnits.DIFFUSE));d.isSome(this._textureNormal)&&(b.setUniform1i("normalTexture",c.DefaultTextureUnits.NORMAL),a.bindTexture(this._textureNormal.glTexture,c.DefaultTextureUnits.NORMAL));d.isSome(this._textureEmissive)&&(b.setUniform1i("texEmission",c.DefaultTextureUnits.EMISSION),a.bindTexture(this._textureEmissive.glTexture,c.DefaultTextureUnits.EMISSION));d.isSome(this._textureOcclusion)&&
(b.setUniform1i("texOcclusion",c.DefaultTextureUnits.OCCLUSION),a.bindTexture(this._textureOcclusion.glTexture,c.DefaultTextureUnits.OCCLUSION));d.isSome(this._textureMetallicRoughness)&&(b.setUniform1i("texMetallicRoughness",c.DefaultTextureUnits.METALLIC_ROUGHNESS),a.bindTexture(this._textureMetallicRoughness.glTexture,c.DefaultTextureUnits.METALLIC_ROUGHNESS))};e.bindTextureScale=function(a,b){(a=d.isSome(this._texture)&&this._texture.glTexture)&&a.descriptor.textureCoordinateScaleFactor?b.setUniform2fv("textureCoordinateScaleFactor",
a.descriptor.textureCoordinateScaleFactor):b.setUniform2f("textureCoordinateScaleFactor",1,1)};e._acquireIfNotUndefined=function(a){if(!d.isNone(a))return this._textureIDs.add(a),this._textureRepository.acquire(a,this._initTransparent)};e._releaseIfNotUndefined=function(a){d.isNone(a)||(this._textureIDs.delete(a),this._textureRepository.release(a))};return f}(k)});