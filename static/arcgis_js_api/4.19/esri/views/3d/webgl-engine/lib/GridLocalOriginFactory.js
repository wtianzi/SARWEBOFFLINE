// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../../../core/maybe ../../../../geometry/SpatialReference ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../geometry/projection ../../../../chunks/mat4f64 ./Geometry ./Object3D ./localOrigin ./WebGLLayer ../materials/RibbonLineMaterial".split(" "),function(r,t,u,v,w,x,y,z,m,A,B){let C=0,p=function(){function l(){this.ROOT_ORIGIN_ID="rg_root_"+C++;this._origins=new Map;this._gridSize=42E5}var q=l.prototype;q.getOrigin=function(b){var d=this._origins.get(this.ROOT_ORIGIN_ID);
if(null==d){if(r.isSome(l.testOrigin)){var a=l.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,m.fromValues(a[0],a[1],a[2],this.ROOT_ORIGIN_ID));return this.getOrigin(b)}a=m.fromValues(b[0]+Math.random()-.5,b[1]+Math.random()-.5,b[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);this._origins.set(this.ROOT_ORIGIN_ID,a);return a}v.subtract(f,b,d.vec3);f[0]=Math.abs(f[0]);f[1]=Math.abs(f[1]);f[2]=Math.abs(f[2]);a=this._gridSize;if(f[0]<a&&f[1]<a&&f[2]<a)return d;d=Math.round(b[0]/a);const g=Math.round(b[1]/
a);b=Math.round(b[2]/a);const h=`${"rg_"}${d}/${g}/${b}`;let e=this._origins.get(h);e||(e=m.fromValues(d*a,g*a,b*a,h),this._origins.set(h,e));return e};q._drawOriginBox=function(b){var d=window.view;const a=d._stage;if(null==this._object){this._material=new B.RibbonLineMaterial({width:2,color:[0,1,0,1]});a.add(this._material);var g=new A.WebGLLayer({isPickable:!1});this._object=new z.Object3D({castShadow:!1});a.add(this._object);g.add(this._object);a.add(g)}g=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,
0];const h=g.length,e=Array(3*h),n=new Uint16Array(2*(h-1)),k=.5*this._gridSize;for(let c=0;c<h;c++)e[3*c]=b[0]+(g[c]&1?k:-k),e[3*c+1]=b[1]+(g[c]&2?k:-k),e[3*c+2]=b[2]+(g[c]&4?k:-k),0<c&&(n[2*c]=c-1,n[2*c+1]=c);w.projectBuffer(e,t.WebMercator,0,e,d.spatialReference,0,h);d=new y.Geometry([["position",{size:3,data:e,exclusive:!0}]],[["position",n]],2);a.add(d);this._object.addGeometry(d,this._material,x.IDENTITY);console.log(this._origins.size,b)};return l}();const f=u.create();(p||(p={})).testOrigin=
null;return p});