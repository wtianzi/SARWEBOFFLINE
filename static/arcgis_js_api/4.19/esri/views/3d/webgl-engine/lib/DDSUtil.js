// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/Logger","../../../../core/mathUtils","../../../webgl/Texture"],function(l,u,n,v){function m(d){return d.charCodeAt(0)+(d.charCodeAt(1)<<8)+(d.charCodeAt(2)<<16)+(d.charCodeAt(3)<<24)}function p(d,a){var b=new Int32Array(d,0,31);if(542327876!==b[0])return k.error("Invalid magic number in DDS header"),null;if(!(b[20]&4))return k.error("Unsupported format, must contain a FourCC code"),null;var c=b[21];let g;switch(c){case w:c=8;g=33776;break;case x:c=16;g=33778;break;
case y:c=16;g=33779;break;default:return k.error("Unsupported FourCC code:",String.fromCharCode(c&255,c>>8&255,c>>16&255,c>>24&255)),null}let h=1,e=b[4],f=b[3];if(0!==(e&3)||0!==(f&3))k.warn("Rounding up compressed texture size to nearest multiple of 4."),e=e+3&-4,f=f+3&-4;const z=e,A=f;b[2]&131072&&!1!==a&&(h=Math.max(1,b[7]));1===h||n.isPowerOfTwo(e)&&n.isPowerOfTwo(f)||(k.warn("Ignoring mipmaps of non power of two sized compressed texture."),h=1);let q=b[1]+4;const r=[];for(let t=0;t<h;++t)b=(e+
3>>2)*(f+3>>2)*c,a=new Uint8Array(d,q,b),r.push(a),q+=b,e=Math.max(1,e>>1),f=Math.max(1,f>>1);return{textureData:{type:"compressed",levels:r},internalFormat:g,width:z,height:A}}const k=u.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),w=m("DXT1"),x=m("DXT3"),y=m("DXT5");l.createDDSTexture=function(d,a,b,c){const {textureData:g,internalFormat:h,width:e,height:f}=p(b,c);a.samplingMode=1<g.levels.length?9987:9729;a.hasMipmap=1<g.levels.length;a.internalFormat=h;a.width=e;a.height=f;a=new v(d,a,g);
d.bindTexture(a,0);return a};l.createDDSTextureData=p;Object.defineProperty(l,"__esModule",{value:!0})});