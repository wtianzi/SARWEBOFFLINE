// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/PooledArray ../../../../core/Evented ../../../../chunks/vec3f64 ../../../../core/Handles ./ContentObject ./DirtyEvents ./Octree".split(" "),function(g,m,e,n,p,l,q,h,r,t){h=function(f){function k(a,c=""){var b=f.call(this)||this;b.apiLayerUid=c;b.type=0;b.events=new p;b.isSliceable=!1;b._objects=new n;b._stageHandles=new q;b.apiLayerUid=c;a=a||{};b.group=a.group||"";b.isVisible=null!=a.isVisible?a.isVisible:
!0;b.isPickable=null!=a.isPickable?a.isPickable:!0;b.translation=a.translation?l.clone(a.translation):l.create();return b}m._inheritsLoose(k,f);var d=k.prototype;d.destroy=function(){this.detachStage();this._stage=null};d.attachStage=function(a){this.detachStage();this._stage=a;for(const c of r.DirtyEventNames)this._stageHandles.add(this.events.on(c,b=>a.handleEvent(c,b)))};d.detachStage=function(){this._stageHandles.removeAll();this.invalidateSpatialQueryAccelerator()};d.getObjectIds=function(){return this._objects.map(a=>
a.id)};d.getObjects=function(){return this._objects};d.add=function(a){this._objects.push(a);a.parentLayer=this;this.events.emit("layerObjectAdded",{layer:this,object:a});e.isSome(this._octree)&&this._octree.add([a])};d.remove=function(a){this._objects.removeUnordered(a)&&(a.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:a}),e.isSome(this._octree)&&this._octree.remove([a]))};d.addMany=function(a){this._objects.pushArray(a);for(const c of a)c.parentLayer=this;this.events.emit("layerObjectsAdded",
{layer:this,objects:a});e.isSome(this._octree)&&this._octree.add(a)};d.removeMany=function(a){const c=[];this._objects.removeUnorderedMany(a,a.length,c);if(0!==c.length){for(const b of c)b.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:c});e.isSome(this._octree)&&this._octree.remove(c)}};d.commit=function(){e.isSome(this._stage)&&this._stage.processDirtyLayer(this.id)};d.notifyObjectBBChanged=function(a,c){e.isSome(this._octree)&&this._octree.update(a,c)};d.getSpatialQueryAccelerator=
function(){e.isNone(this._octree)&&50<this._objects.length&&this._createOctree();return this._octree};d.shaderTransformationChanged=function(){this.invalidateSpatialQueryAccelerator();this.events.emit("shaderTransformationChanged",this)};d.invalidateSpatialQueryAccelerator=function(){this._octree=e.destroyMaybe(this._octree)};d._createOctree=function(){this._octree=new t(a=>a.getBounds());this._octree.add(this._objects.data,this._objects.length)};return k}(h.ContentObject);g.WebGLLayer=h;g.isWebGLLayer=
function(f){return e.isSome(f)&&0===f.type};Object.defineProperty(g,"__esModule",{value:!0})});