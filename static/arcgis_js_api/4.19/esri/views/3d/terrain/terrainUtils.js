// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../core/maybe ../../../layers/ElevationLayer ../../../layers/TileLayer ../../../layers/VectorTileLayer ../support/StreamDataLoader ../../2d/engine/vectorTiles/VectorTile ./RasterTile ../../../chunks/terrainUtilsPlanar ../../../chunks/terrainUtilsSpherical ./TileTexture".split(" "),function(b,m,w,x,y,z,A,B,C,D,E){function g(a){return"imagery-tile"===a.type||"wcs"===a.type}function h(a){return a&&"esri.views.3d.layers.ImageryTileLayerView3D"===a.declaredClass}function n(a){return a&&
"esri.views.3d.layers.TileLayerView3D"===a.declaredClass}function p(a){return a&&"esri.views.3d.layers.VectorTileLayerView3D"===a.declaredClass}function q(a){return a&&"esri.views.3d.layers.WMTSLayerView3D"===a.declaredClass}function r(a){return a&&"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function k(a,c,e,d){return t[2===d||"planar"===d?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(a,e,c)}const t={planar:C.terrainUtilsPlanar,spherical:D.terrainUtilsSpherical},F=80/180*
Math.PI,G=110/180*Math.PI,u={force512VTL:!1};b.checkIfTileInfoSupportedForView=k;b.computeSkirtScale=function(a,c,e){var d=t[a.manifold];if(d.isInsideExtent(a,c))a=m.unwrapOr(a.getElevation(c[0],c[1],c[1],a.spatialReference),0);else{if(!d.isInsideExtent(a,c,1.2))return 0;d=d.tiltToExtentEdge(a,c);if(d>F&&d<G)return 0;a=a.elevationBounds;a=.5*(a.min+a.max)}c=c[2]-a;return Math.abs(c)<e?0:0>c?-1:1};b.getLayerWithExtentRange=function(a){return h(a)?{fullExtent:a.fullExtent,minScale:a.layer.minScale,
maxScale:a.layer.maxScale,tilemapCache:null}:a.layer};b.getTiledLayerInfo=function(a,c,e){let d,f;if("wmts"===a.type){if(a=a.activeLayer){const l=a.tileMatrixSet;if(l)d=l.tileInfo,f=l.fullExtent;else if(a=a.tileMatrixSets)if(a=a.find(v=>null==k(v.tileInfo,v.fullExtent,c,e)))return{tileInfo:a.tileInfo,fullExtent:a.fullExtent}}}else f=g(a)?a.getCompatibleFullExtent(c):a.fullExtent,d="vector-tile"!==a.type||u.force512VTL?g(a)?a.getCompatibleTileInfo(c,f):a.tileInfo:a.compatibleTileInfo256;return d&&
f&&null==k(d,f,c,e)?{tileInfo:d,fullExtent:f}:{tileInfo:null,fullExtent:null}};b.isElevationLayerView=r;b.isImageryTileLayerView=h;b.isImageryTileRenderInfo=function(a){return a&&a.sourceLayerInfo&&a.sourceLayerInfo.data instanceof B};b.isProjectableRasterLayer=g;b.isRasterTileRenderInfo=function(a){a=a&&a.sourceLayerInfo&&a.sourceLayerInfo.data;return a instanceof HTMLImageElement||a instanceof z.ImageWithType||a instanceof HTMLCanvasElement||a instanceof ImageData};b.isSurfaceLayerView=function(a){return a&&
(n(a)||h(a)||r(a)||p(a)||q(a))};b.isTextureTileRenderInfo=function(a){return a&&a.sourceLayerInfo&&a.sourceLayerInfo.data instanceof E};b.isTileLayerView=n;b.isVectorTileLayer=function(a){return a&&a instanceof y};b.isVectorTileLayerView=p;b.isVectorTileRenderInfo=function(a){return a&&a.sourceLayerInfo&&a.sourceLayerInfo.data instanceof A.VectorTile};b.isWMTSLayerView=q;b.releaseTileData=function(a){m.isSome(a)&&"release"in a&&a.release();return null};b.test=u;b.useFetchTileForLayer=function(a){return a.fetchTile&&
!(a.fetchTile===x.prototype.fetchTile||a.fetchTile===w.prototype.fetchTile)};b.weakAssert=function(a,c){a||console.warn("Terrain: "+c)};Object.defineProperty(b,"__esModule",{value:!0})});