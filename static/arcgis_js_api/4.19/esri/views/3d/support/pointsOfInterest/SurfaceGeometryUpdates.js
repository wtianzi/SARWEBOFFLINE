// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../core/Evented ../../../../chunks/vec3f64 ../../../../core/Handles ../../../../geometry/support/aaBoundingRect ../../../support/Scheduler".split(" "),
function(b,r,d,B,C,D,g,E,t,F,G,H,u,v,p,w,l,x){b.SurfaceGeometryUpdates=function(q){function n(){var a=q.apply(this,arguments)||this;a.handles=new w;a._tileGeometryUpdateExtent=l.empty();a._tileGeometryUpdateSpatialReference=null;a.events=new v;a.updating=!1;return a}r._inheritsLoose(n,q);var h=n.prototype;h.initialize=function(){this.handles.add([this.surface.on("elevation-change",a=>this._tileGeometryChanged(a)),this.scheduler.registerTask(x.Task.SURFACE_GEOMETRY_UPDATES,()=>this.update(),()=>this.updating)])};
h.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null)};h.update=function(){this.updating&&(this._centerIntersectsExtent(this._tileGeometryUpdateExtent,this._tileGeometryUpdateSpatialReference)&&this.events.emit("request-update",y),l.empty(this._tileGeometryUpdateExtent),this._set("updating",!1))};h._tileGeometryChanged=function(a){this._tileGeometryUpdateSpatialReference=a.spatialReference;l.expand(this._tileGeometryUpdateExtent,a.tile.extent);this._set("updating",!0)};h._furthestCenterOnSurface=
function(){let a=this.centerOnSurfaces[0];for(let k=1;k<this.centerOnSurfaces.length;k++){const m=this.centerOnSurfaces[k];m.distance>a.distance&&(a=m)}return a};h._centerIntersectsExtent=function(a,k){const m=this.state.camera.eye,c=z,A=this._furthestCenterOnSurface();this.renderCoordsHelper.fromRenderCoords(m,e,k);this.renderCoordsHelper.fromRenderCoords(A.renderLocation,f,k);e[0]<f[0]?(c[0]=e[0],c[2]=f[0]):(c[0]=f[0],c[2]=e[0]);e[1]<f[1]?(c[1]=e[1],c[3]=f[1]):(c[1]=f[1],c[3]=e[1]);return l.intersects(c,
a)};return n}(u);d.__decorate([g.property({constructOnly:!0})],b.SurfaceGeometryUpdates.prototype,"state",void 0);d.__decorate([g.property({constructOnly:!0})],b.SurfaceGeometryUpdates.prototype,"centerOnSurfaces",void 0);d.__decorate([g.property({constructOnly:!0})],b.SurfaceGeometryUpdates.prototype,"renderCoordsHelper",void 0);d.__decorate([g.property({constructOnly:!0})],b.SurfaceGeometryUpdates.prototype,"scheduler",void 0);d.__decorate([g.property({constructOnly:!0})],b.SurfaceGeometryUpdates.prototype,
"surface",void 0);d.__decorate([g.property({readOnly:!0})],b.SurfaceGeometryUpdates.prototype,"updating",void 0);b.SurfaceGeometryUpdates=d.__decorate([t.subclass("esri.views.3d.support.SurfaceGeometryUpdates")],b.SurfaceGeometryUpdates);const y={},e=p.create(),f=p.create(),z=l.empty();b.default=b.SurfaceGeometryUpdates;Object.defineProperty(b,"__esModule",{value:!0})});