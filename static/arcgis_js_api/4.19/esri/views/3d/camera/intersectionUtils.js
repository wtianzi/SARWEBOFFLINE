// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../core/maybe ../../../chunks/vec3f64 ../../../chunks/vec3 ../../../geometry/projectionEllipsoid ../../../geometry/support/aaBoundingRect ../webgl-engine/lib/Intersector".split(" "),function(k,m,l,f,t,u,v){function n(a,b){return a.elevationProvider?m.unwrapOr(a.elevationProvider.getElevation(b[0],b[1],b[2],a.renderCoordsHelper.spatialReference,"ground"),0):0}function p(a,b,c){if(!a.state.isGlobal)return!1;const d=n(a,b);({far:a}=a.stateManager.constraintsManager.nearFarHeuristic.compute(b,
c,a.dataExtent,d,w));a*=a;return f.squaredDistance(b,c)>a}function x(a,b,c=l.create()){let d=q[a.viewingMode];d||(d=new v.Intersector(a.state.mode),d.options.backfacesTerrain=!a.state.isGlobal,d.options.invisibleTerrain=!0,q[a.viewingMode]=d);const {isGlobal:e}=a.state;return a.sceneIntersectionHelper.intersectRay(b,d,c)&&!p(a,b.origin,c)?!0:!a.renderCoordsHelper.intersectManifold(b,0,c)||p(a,b.origin,c)?e?(a=t.getReferenceEllipsoid(a.spatialReference).radius,a=f.dot(b.origin,b.origin)-a*a,f.scale(c,
b.direction,(0<a?Math.sqrt(a)/3:1)/f.length(b.direction)),f.add(c,c,b.origin),!0):!1:!0}const q={},r=l.create(),g=l.create(),h=l.create(),w={near:0,far:0};k.cameraOnContentAlongViewDirection=function(a,b,c,d){const e=a.state.camera.clone();b&&(e.eye=b);c&&(e.center=c);d&&(e.up=d);x(a,e.ray,g)||f.copy(g,e.center);c=a.state.constraints;d=c.minimumPoiDistance;f.squaredDistance(e.eye,g)<d&&(b=c.collision.enabled,f.copy(h,e.viewForward),f.scale(h,h,d),b?f.subtract(e.eye,g,h):f.add(g,e.eye,h),a=a.renderCoordsHelper,
d=a.getAltitude(e.eye),c=c.collision.elevationMargin,b&&d<c&&(f.subtract(h,g,e.eye),a.setAltitude(c,e.eye),f.add(g,e.eye,h)));e.center=g;return e};k.eyeWithinExtent=function(a,b,c,d){return m.isSome(a.renderCoordsHelper.fromRenderCoords(b.eye,r,d))&&u.containsPoint(c,r)};k.surfaceElevationBelowRenderLocation=n;Object.defineProperty(k,"__esModule",{value:!0})});