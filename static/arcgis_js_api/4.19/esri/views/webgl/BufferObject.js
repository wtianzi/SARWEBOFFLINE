// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["../../chunks/_rollupPluginBabelHelpers","../../core/typedArrayUtil","./checkWebGLError"],function(n,g,p){return function(){function e(a,b,d,c,f){this._context=a;this.bufferType=b;this.usage=d;this._glName=null;this._size=-1;this._indexType=void 0;a.instanceCounter.increment(1,this);this._glName=this._context.gl.createBuffer();p.checkWebGLError(this._context.gl);c&&this.setData(c,f)}e.createIndex=function(a,b,d,c){return new e(a,34963,b,d,c)};e.createVertex=function(a,b,d){return new e(a,
34962,b,d)};var l=e.prototype;l.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(1,this),this._context=null)};l.setData=function(a,b){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),34963===this.bufferType&&b)switch(this._indexType=b,this._size=a,b){case 5123:a*=2;break;case 5125:a*=4}}else b=a.byteLength,g.isUint16Array(a)&&(b/=2,this._indexType=5123),g.isUint32Array(a)&&
(b/=4,this._indexType=5125),this._size=b;b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this.bufferType,a,this.usage);this._context.bindVAO(b)}};l.setSubData=function(a,b=0,d=0,c=a.byteLength){if(a){(0>b||b>=this._size)&&console.error("offset is out of range!");var f=b,h=d,k=c,m=a.byteLength;g.isUint16Array(a)&&(m/=2,f*=2,h*=2,k*=2);g.isUint32Array(a)&&(m/=4,f*=4,h*=4,k*=4);void 0===c&&(c=m-1);d>=c&&console.error("end must be bigger than start!");
b+d-c>this._size&&console.error("An attempt to write beyond the end of the buffer!");b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);d=this._context.gl;c=ArrayBuffer.isView(a)?a.buffer:a;a=0===h&&k===a.byteLength?c:c.slice(h,k);d.bufferSubData(this.bufferType,f,a);this._context.bindVAO(b)}};n._createClass(e,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},
{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}}]);return e}()});