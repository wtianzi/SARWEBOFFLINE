// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/Collection ../support/WatchUpdatingTracking ../../libs/maquette/projection ../../libs/maquette/projector".split(" "),function(n,g,e,x,y,h,z,t,
A,B,C,u,v,w,D,p){e=function(q){function l(){var a=q.apply(this,arguments)||this;a.items=new v;a._watchUpdatingTracking=new w.WatchUpdatingTracking;a._callbacks=new Map;a._projector=p.createProjector();a._hiddenProjector=p.createProjector();return a}n._inheritsLoose(l,q);var f=l.prototype;f.initialize=function(){const a=document.createElement("div");a.className="esri-overlay-surface";this._set("surface",a);this._hiddenSurface=document.createElement("div");this._hiddenSurface.setAttribute("style","visibility: hidden;");
a.appendChild(this._hiddenSurface);this._watchUpdatingTracking.addOnCollectionChange(this.items,b=>{b.added.map(c=>{const d=()=>c.render();this._callbacks.set(c,d);this._projector.append(this.surface,d)});b.removed.map(c=>{const d=this._projector.detach(this._callbacks.get(c));this.surface.removeChild(d.domNode);this._callbacks.delete(c)})})};f.addItem=function(a){this.items.add(a)};f.removeItem=function(a){this.items.remove(a)};f.destroy=function(){this.items.removeAll();this._callbacks.forEach(a=>
this._projector.detach(a));this._projector=this._callbacks=null;this._watchUpdatingTracking.destroy()};f.render=function(){this._projector.renderNow()};f.computeBoundingRect=function(a){const b=this._hiddenSurface,c=this._hiddenProjector;let d=null;const r=()=>d=a.render();c.append(b,r);c.renderNow();const k={left:0,top:0,right:0,bottom:0};if(d&&d.domNode){const m=d.domNode.getBoundingClientRect();k.left=m.left;k.top=m.top;k.right=m.right;k.bottom=m.bottom}for(c.detach(r);b.firstChild;)b.removeChild(b.firstChild);
return k};f.overlaps=function(a,b){a=this.computeBoundingRect(a);b=this.computeBoundingRect(b);return Math.max(a.left,b.left)<=Math.min(a.right,b.right)&&Math.max(a.top,b.top)<=Math.min(a.bottom,b.bottom)};f.renderCanvas=function(a){if(this.items.some(c=>c.visible)){var b=a.getContext("2d");b.save();b.font=`10px ${getComputedStyle(this.surface).fontFamily}`;this.items.forEach(c=>{b.save();c.renderCanvas(b);b.restore()});b.restore()}};n._createClass(l,[{key:"needsRender",get:function(){return 0<this.items.length}},
{key:"hasVisibleItems",get:function(){return this.items.some(a=>a.visible)}}]);return l}(u);g.__decorate([h.property({readOnly:!0})],e.prototype,"surface",void 0);g.__decorate([h.property({readOnly:!0})],e.prototype,"items",void 0);g.__decorate([h.property({readOnly:!0})],e.prototype,"needsRender",null);g.__decorate([h.property({readOnly:!0})],e.prototype,"_watchUpdatingTracking",void 0);g.__decorate([h.property({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],e.prototype,"updating",void 0);
return e=g.__decorate([t.subclass("esri.views.overlay.ViewOverlay")],e)});