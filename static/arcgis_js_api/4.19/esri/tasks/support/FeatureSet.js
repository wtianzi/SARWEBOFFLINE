// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/JSONSupport ../../geometry/SpatialReference ../../geometry/support/jsonUtils ../../geometry ../../Graphic ../../layers/support/Field".split(" "),
function(C,m,l,u,J,K,n,D,z,E,A,L,M,N,F,w,v,G,B,H){const x=new D.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});l=function(q){function y(b){b=q.call(this,b)||this;b.displayFieldName=null;b.exceededTransferLimit=!1;b.features=[];b.fields=null;b.geometryType=null;b.hasM=!1;b.hasZ=!1;b.queryGeometry=null;b.spatialReference=null;return b}C._inheritsLoose(y,q);var p=
y.prototype;p.readFeatures=function(b,d){d=w.fromJSON(d.spatialReference);const c=[];for(let e=0;e<b.length;e++){var a=b[e];const f=B.fromJSON(a);a=a.geometry&&a.geometry.spatialReference;u.isSome(f.geometry)&&!a&&(f.geometry.spatialReference=d);c.push(f)}return c};p.writeGeometryType=function(b,d,c,a){if(b)x.write(b,d,c,a);else if({features:b}=this,b)for(const e of b)if(e&&u.isSome(e.geometry)){x.write(e.geometry.type,d,c,a);break}};p.readQueryGeometry=function(b,d){if(!b)return null;const c=!!b.spatialReference;
b=v.fromJSON(b);!c&&d.spatialReference&&(b.spatialReference=w.fromJSON(d.spatialReference));return b};p.writeSpatialReference=function(b,d){if(b)d.spatialReference=b.toJSON();else if({features:b}=this,b)for(const c of b)if(c&&u.isSome(c.geometry)&&c.geometry.spatialReference){d.spatialReference=c.geometry.spatialReference.toJSON();break}};p.toJSON=function(b){const d=this.write(null);if(d.features&&Array.isArray(b)&&0<b.length)for(let c=0;c<d.features.length;c++){const a=d.features[c];if(a.geometry){const e=
b&&b[c];a.geometry=e&&e.toJSON()||a.geometry}}return d};p.quantize=function(b){const {scale:[d,c],translate:[a,e]}=b,f=this.features,g=this._getQuantizationFunction(this.geometryType,k=>Math.round((k-a)/d),k=>Math.round((e-k)/c));for(let k=0,h=f.length;k<h;k++)g(u.unwrap(f[k].geometry))||(f.splice(k,1),k--,h--);this.transform=b;return this};p.unquantize=function(){const {geometryType:b,features:d,transform:c}=this;if(!c)return this;const {translate:[a,e],scale:[f,g]}=c,k=this._getHydrationFunction(b,
h=>h*f+a,h=>e-h*g);for(const {geometry:h}of d)u.isSome(h)&&k(h);this.transform=null;return this};p._quantizePoints=function(b,d,c){let a,e;const f=[];for(let k=0,h=b.length;k<h;k++){var g=b[k];if(0<k){const r=d(g[0]);g=c(g[1]);if(r!==a||g!==e)f.push([r-a,g-e]),a=r,e=g}else a=d(g[0]),e=c(g[1]),f.push([a,e])}return 0<f.length?f:null};p._getQuantizationFunction=function(b,d,c){return"point"===b?a=>{a.x=d(a.x);a.y=c(a.y);return a}:"polyline"===b||"polygon"===b?a=>{const e=v.isPolygon(a)?a.rings:a.paths,
f=[];for(let g=0,k=e.length;g<k;g++){const h=this._quantizePoints(e[g],d,c);h&&f.push(h)}return 0<f.length?(v.isPolygon(a)?a.rings=f:a.paths=f,a):null}:"multipoint"===b?a=>{const e=this._quantizePoints(a.points,d,c);return 0<e.length?(a.points=e,a):null}:"extent"===b?a=>a:null};p._getHydrationFunction=function(b,d,c){if("point"===b)return a=>{a.x=d(a.x);a.y=c(a.y)};if("polyline"===b||"polygon"===b)return a=>{a=v.isPolygon(a)?a.rings:a.paths;let e,f;for(let g=0,k=a.length;g<k;g++){const h=a[g];for(let r=
0,I=h.length;r<I;r++){const t=h[r];0<r?(e+=t[0],f+=t[1]):(e=t[0],f=t[1]);t[0]=d(e);t[1]=c(f)}}};if("extent"===b)return a=>{a.xmin=d(a.xmin);a.ymin=c(a.ymin);a.xmax=d(a.xmax);a.ymax=c(a.ymax)};if("multipoint"===b)return a=>{a=a.points;let e,f;for(let g=0,k=a.length;g<k;g++){const h=a[g];0<g?(e+=h[0],f+=h[1]):(e=h[0],f=h[1]);h[0]=d(e);h[1]=c(f)}}};return y}(F.JSONSupport);m.__decorate([n.property({type:String,json:{write:!0}})],l.prototype,"displayFieldName",void 0);m.__decorate([n.property({type:Boolean,
json:{write:{overridePolicy(q){return{enabled:q}}}}})],l.prototype,"exceededTransferLimit",void 0);m.__decorate([n.property({type:[B],json:{write:!0}})],l.prototype,"features",void 0);m.__decorate([z.reader("features")],l.prototype,"readFeatures",null);m.__decorate([n.property({type:[H],json:{write:!0}})],l.prototype,"fields",void 0);m.__decorate([n.property({type:"point multipoint polyline polygon extent mesh".split(" "),json:{read:{reader:x.read}}})],l.prototype,"geometryType",void 0);m.__decorate([A.writer("geometryType")],
l.prototype,"writeGeometryType",null);m.__decorate([n.property({type:Boolean,json:{write:{overridePolicy(q){return{enabled:q}}}}})],l.prototype,"hasM",void 0);m.__decorate([n.property({type:Boolean,json:{write:{overridePolicy(q){return{enabled:q}}}}})],l.prototype,"hasZ",void 0);m.__decorate([n.property({types:G.geometryTypes,json:{write:!0}})],l.prototype,"queryGeometry",void 0);m.__decorate([z.reader("queryGeometry")],l.prototype,"readQueryGeometry",null);m.__decorate([n.property({type:w,json:{write:!0}})],
l.prototype,"spatialReference",void 0);m.__decorate([A.writer("spatialReference")],l.prototype,"writeSpatialReference",null);m.__decorate([n.property({json:{write:!0}})],l.prototype,"transform",void 0);l=m.__decorate([E.subclass("esri.tasks.support.FeatureSet")],l);l.prototype.toJSON.isDefaultToJSON=!0;(function(q){})(l||(l={}));return l});