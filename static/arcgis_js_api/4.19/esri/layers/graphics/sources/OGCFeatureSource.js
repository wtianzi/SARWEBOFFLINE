// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/Error ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../geometry/support/spatialReferenceUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/typeUtils ../../../geometry ../../../core/Loadable ../../ogc/ogcFeatureUtils".split(" "),
function(c,u,e,K,y,L,M,f,N,z,A,O,P,Q,B,v,w,C,R,D,g){c.OGCFeatureSource=function(x){function m(){var a=x.apply(this,arguments)||this;a.collection=null;a.conformance=null;a.landingPage=null;a.layerDefinition=null;a.type="ogc-feature";return a}u._inheritsLoose(m,x);var h=m.prototype;h.load=function(a){a=y.isSome(a)?a.signal:null;const {collectionId:b,fields:d,geometryType:k,hasZ:p,objectIdField:q,timeInfo:n,url:l}=this.layer,E={fields:null==d?void 0:d.map(r=>r.toJSON()),geometryType:C.typeKebabDictionary.toJSON(k),
hasZ:p,objectIdField:q,timeInfo:null==n?void 0:n.toJSON()};this.addResolvingPromise(Promise.all([g.getServerLandingPage(l,a),g.getServerConformance(l,a),g.getServerCollection(l,b,a),g.getCollectionDefinition(l,b,E,a)]).then(r=>{const [F,t,G,H]=r;this.set({landingPage:F,conformance:t,collection:G,layerDefinition:H});const I=/^https?:\/\/www.opengis.net\/spec\/ogcapi-features-1\/1.0\/conf\/geojson$/i;if(null==t||!t.conformsTo.some(J=>I.test(J)))throw new A("ogc-feature-layer:no-geojson-support","Server does not support geojson");
}));return this.when()};h.getFeatureDefinition=function(){var a;const {collection:b,layer:{capabilities:d,collectionId:k,spatialReference:p,url:q},layerDefinition:n}=this,l=null!=(a=null==b?void 0:b.crs)?a:["http://www.opengis.net/def/crs/OGC/1.3/CRS84"];return{capabilities:d,collectionId:k,layerDefinition:n,spatialReference:p.toJSON(),supportedCrs:l,url:q}};h.queryExtent=function(a,b){return null};h.queryFeatureCount=function(a,b){return null};h.queryFeatures=function(a,b={}){const d=this.getFeatureDefinition();
return this.load(b).then(()=>g.queryFeatureSet(d,a,b))};h.queryFeaturesJSON=function(a,b={}){const d=this.getFeatureDefinition();return this.load(b).then(()=>g.queryFeatureSetJSON(d,a,b))};h.queryObjectIds=function(a,b){return null};h.supportsSpatialReference=function(a){var b,d;return a.isWGS84||a.isWebMercator?!0:(null!=(b=null==(d=this.collection)?void 0:d.crs)?b:["http://www.opengis.net/def/crs/OGC/1.3/CRS84"]).some(k=>(k=g.getSpatialReference(k))?B.equals(k,a):!1)};u._createClass(m,[{key:"fullExtent",
get:function(){var a,b;const d=null==(a=this.collection)?void 0:null==(b=a.extent)?void 0:b.spatial;if(!d)return null;a=d.bbox[0];b=4===a.length;return new w({xmin:a[0],ymin:a[1],xmax:b?a[2]:a[3],ymax:b?a[3]:a[4],zmin:b?void 0:a[2],zmax:b?void 0:a[5],spatialReference:v.WGS84})}},{key:"spatialReference",get:function(){var a;const b=null!=(a=this.collection.storageCrs)?a:"http://www.opengis.net/def/crs/OGC/1.3/CRS84";return(a=g.getSpatialReference(b))?a:v.WGS84}}]);return m}(D);e.__decorate([f.property()],
c.OGCFeatureSource.prototype,"collection",void 0);e.__decorate([f.property()],c.OGCFeatureSource.prototype,"conformance",void 0);e.__decorate([f.property({readOnly:!0,type:w})],c.OGCFeatureSource.prototype,"fullExtent",null);e.__decorate([f.property()],c.OGCFeatureSource.prototype,"landingPage",void 0);e.__decorate([f.property({constructOnly:!0})],c.OGCFeatureSource.prototype,"layer",void 0);e.__decorate([f.property()],c.OGCFeatureSource.prototype,"layerDefinition",void 0);e.__decorate([f.property()],
c.OGCFeatureSource.prototype,"spatialReference",null);e.__decorate([f.property()],c.OGCFeatureSource.prototype,"type",void 0);c.OGCFeatureSource=e.__decorate([z.subclass("esri.layers.graphics.sources.OGCFeatureSource")],c.OGCFeatureSource);c.default=c.OGCFeatureSource;Object.defineProperty(c,"__esModule",{value:!0})});