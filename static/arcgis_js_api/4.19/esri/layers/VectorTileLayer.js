// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/JSONSupport ../../geometry/support/spatialReferenceUtils ../../geometry/SpatialReference ../../geometry/support/webMercatorUtils ../../geometry/Point ../../geometry ../../core/unitUtils ../../geometry/support/aaBoundingRect ./LOD".split(" "),
function(f,w,q,a,k,m,g,c,p,h,t,B,z,d,l,u,H,F,N,L,C,v){var A;q=new g.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});d=A=function(M){function P(D){D=M.call(this,D)||this;D.dpi=96;D.format=null;D.origin=null;D.minScale=0;D.maxScale=0;D.size=null;D.spatialReference=null;return D}f._inheritsLoose(P,M);P.create=function(D=
{size:256,spatialReference:u.WebMercator}){var y=D.resolutionFactor||1,I=D.scales;const K=D.size||256,J=D.spatialReference||u.WebMercator;if(!l.isValid(J)){y=[];if(I)for(D=0;D<I.length;D++){var S=I[D];y.push({level:D,scale:S,resolution:S})}else for(I=5E-4,D=23;0<=D;D--)y.unshift({level:D,scale:I,resolution:I}),I*=2;return new A({dpi:96,lods:y,origin:new F(0,0,J),size:[K,K],spatialReference:J})}S=l.getInfo(J);D=D.origin?new F({x:D.origin.x,y:D.origin.y,spatialReference:J}):S?new F({x:S.origin[0],y:S.origin[1],
spatialReference:J}):new F({x:0,y:0,spatialReference:J});S=1/(39.37*L.getMetersPerUnitForSR(J)*96);const aa=[];if(I)for(y=0;y<I.length;y++){var Y=I[y];aa.push({level:y,scale:Y,resolution:Y*S})}else{var V=l.isGeographic(J)?512/K*5.916575275917094E8:256/K*5.91657527591555E8;I=Math.ceil(24/y);aa.push({level:0,scale:V,resolution:V*S});for(Y=1;Y<I;Y++)V/=2**y,aa.push({level:Y,scale:V,resolution:V*S})}return new A({dpi:96,lods:aa,origin:D,size:[K,K],spatialReference:J})};var O=P.prototype;O.readOrigin=
function(D,y){return F.fromJSON({spatialReference:y.spatialReference,...D})};O.readSize=function(D,y){return[y.cols,y.rows]};O.writeSize=function(D,y){y.cols=D[0];y.rows=D[0]};O.zoomToScale=function(D){const y=this.scales;if(0>=D)return y[0];if(D>=y.length)return y[y.length-1];{const I=Math.round(D);return y[I]+(I-D)*(y[Math.round(D-.5)]-y[I])}};O.scaleToZoom=function(D){const y=this.scales,I=y.length-1;let K=0;for(;K<I;K++){const J=y[K],S=y[K+1];if(J<=D)break;if(S===D)return K+1;if(J>D&&S<D)return K+
1-(D-S)/(J-S)}return K};O.snapScale=function(D,y=.95){D=this.scaleToZoom(D);return D%Math.floor(D)>=y?this.zoomToScale(Math.ceil(D)):this.zoomToScale(Math.floor(D))};O.tileAt=function(D,y,I,K){var J=this.lodAt(D);if(!J)return null;let S;if("number"===typeof y)S=y,y=I;else{if(l.equals(y.spatialReference,this.spatialReference))S=y.x,y=y.y;else{K=H.project(y,this.spatialReference);if(!K)return null;S=K.x;y=K.y}K=I}I=J.resolution*this.size[0];J=J.resolution*this.size[1];K||(K={id:null,level:0,row:0,col:0,
extent:C.create()});K.level=D;K.row=Math.floor((this.origin.y-y)/J+.001);K.col=Math.floor((S-this.origin.x)/I+.001);this.updateTileInfo(K);return K};O.updateTileInfo=function(D,y=0){var I=this.lodAt(D.level);I||1!==y||(y=this.lods[this.lods.length-1],y.level<D.level&&(I=y));if(I){var K=D.level-I.level;y=I.resolution*this.size[0]/2**K;I=I.resolution*this.size[1]/2**K;D.id=`${D.level}/${D.row}/${D.col}`;D.extent||(D.extent=C.create());D.extent[0]=this.origin.x+D.col*y;D.extent[1]=this.origin.y-(D.row+
1)*I;D.extent[2]=D.extent[0]+y;D.extent[3]=D.extent[1]+I}};O.upsampleTile=function(D){const y=this._upsampleLevels[D.level];if(!y||-1===y.parentLevel)return!1;D.level=y.parentLevel;D.row=Math.floor(D.row/y.factor+.001);D.col=Math.floor(D.col/y.factor+.001);this.updateTileInfo(D);return!0};O.getTileBounds=function(D,y){var {resolution:I}=this.lodAt(y.level);const K=I*this.size[0];I*=this.size[1];D[0]=this.origin.x+y.col*K;D[1]=this.origin.y-(y.row+1)*I;D[2]=D[0]+K;D[3]=D[1]+I;return D};O.lodAt=function(D){return this._levelToLOD&&
this._levelToLOD[D]||null};O.clone=function(){return A.fromJSON(this.write({}))};O._initializeUpsampleLevels=function(){const D=this.lods;this._upsampleLevels=[];let y=null;for(let I=0;I<D.length;I++){const K=D[I];this._upsampleLevels[K.level]={parentLevel:y?y.level:-1,factor:y?y.resolution/K.resolution:0};y=K}};f._createClass(P,[{key:"isWrappable",get:function(){const {spatialReference:D,origin:y}=this;if(D&&y){const I=l.getInfo(D);return D.isWrappable&&Math.abs(I.origin[0]-y.x)<=I.dx}return!1}},
{key:"lods",set:function(D){let y=0,I=0;const K=[];this._levelToLOD={};D&&(y=-Infinity,I=Infinity,D.forEach(J=>{K.push(J.scale);y=J.scale>y?J.scale:y;I=J.scale<I?J.scale:I;this._levelToLOD[J.level]=J}));this._set("scales",K);this._set("minScale",y);this._set("maxScale",I);this._set("lods",D);this._initializeUpsampleLevels()}}]);return P}(d.JSONSupport);w.__decorate([m.property({type:Number,json:{write:!0}})],d.prototype,"compressionQuality",void 0);w.__decorate([m.property({type:Number,json:{write:!0}})],
d.prototype,"dpi",void 0);w.__decorate([m.property({type:String,json:{read:q.read,write:q.write,origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"format",void 0);w.__decorate([m.property({readOnly:!0})],d.prototype,"isWrappable",null);w.__decorate([m.property({type:F,json:{write:!0}})],d.prototype,"origin",void 0);w.__decorate([c.reader("origin")],d.prototype,"readOrigin",null);w.__decorate([m.property({type:[v],value:null,json:{write:!0}})],d.prototype,"lods",null);w.__decorate([m.property({readOnly:!0})],
d.prototype,"minScale",void 0);w.__decorate([m.property({readOnly:!0})],d.prototype,"maxScale",void 0);w.__decorate([m.property({readOnly:!0})],d.prototype,"scales",void 0);w.__decorate([m.property({cast:M=>Array.isArray(M)?M:"number"===typeof M?[M,M]:[256,256]})],d.prototype,"size",void 0);w.__decorate([c.reader("size",["rows","cols"])],d.prototype,"readSize",null);w.__decorate([h.writer("size",{cols:{type:k.Integer},rows:{type:k.Integer}})],d.prototype,"writeSize",null);w.__decorate([m.property({type:u,
json:{write:!0}})],d.prototype,"spatialReference",void 0);return d=A=w.__decorate([p.subclass("esri.layers.support.TileInfo")],d)})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/maybe","../Extent"],function(f,w,q,a){function k(d=z){return[d[0],d[1],d[2],d[3]]}function m(d){return d[0]>=d[2]?0:d[2]-d[0]}function g(d){return d[1]>=d[3]?0:d[3]-d[1]}function c(d,l,u){return l>=d[0]&&u>=d[1]&&l<=d[2]&&u<=d[3]}function p(d,l){d[0]=l[0];d[1]=l[1];d[2]=
l[2];d[3]=l[3];return d}function h(d){return 4===d.length}function t(d,l,u){return d<l?l:d>u?u:d}const B=[Infinity,Infinity,-Infinity,-Infinity],z=[0,0,0,0];f.NEGATIVE_INFINITY=B;f.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];f.UNIT=[0,0,1,1];f.ZERO=z;f.allFinite=function(d){for(let l=0;4>l;l++)if(!isFinite(d[l]))return!1;return!0};f.area=function(d){return m(d)*g(d)};f.center=function(d,l=[0,0]){l[0]=(d[0]+d[2])/2;l[1]=(d[1]+d[3])/2;return l};f.clone=function(d){return[d[0],d[1],d[2],
d[3]]};f.contains=function(d,l){return l[0]>=d[0]&&l[2]<=d[2]&&l[1]>=d[1]&&l[3]<=d[3]};f.containsPoint=function(d,l){return c(d,l[0],l[1])};f.containsPointObject=function(d,l){return c(d,l.x,l.y)};f.containsPointWithMargin=function(d,l,u){return l[0]>=d[0]-u&&l[1]>=d[1]-u&&l[0]<=d[2]+u&&l[1]<=d[3]+u};f.containsXY=c;f.create=k;f.diameter=function(d){const l=m(d);d=g(d);return Math.sqrt(l*l+d*d)};f.distance=function(d,l){const u=(d[1]+d[3])/2,H=Math.max(Math.abs(l[0]-(d[0]+d[2])/2)-m(d)/2,0);d=Math.max(Math.abs(l[1]-
u)-g(d)/2,0);return Math.sqrt(H*H+d*d)};f.empty=function(d){return d?p(d,B):k(B)};f.equals=function(d,l,u){if(q.isNone(d)||q.isNone(l))return d===l;if(!h(d)||!h(l))return!1;if(u)for(let H=0;H<d.length;H++){if(!u(d[H],l[H]))return!1}else for(u=0;u<d.length;u++)if(d[u]!==l[u])return!1;return!0};f.expand=function(d,l,u=d){if("length"in l)if(h(l))u[0]=Math.min(d[0],l[0]),u[1]=Math.min(d[1],l[1]),u[2]=Math.max(d[2],l[2]),u[3]=Math.max(d[3],l[3]);else{if(2===l.length||3===l.length)u[0]=Math.min(d[0],l[0]),
u[1]=Math.min(d[1],l[1]),u[2]=Math.max(d[2],l[0]),u[3]=Math.max(d[3],l[1])}else switch(l.type){case "extent":u[0]=Math.min(d[0],l.xmin);u[1]=Math.min(d[1],l.ymin);u[2]=Math.max(d[2],l.xmax);u[3]=Math.max(d[3],l.ymax);break;case "point":u[0]=Math.min(d[0],l.x),u[1]=Math.min(d[1],l.y),u[2]=Math.max(d[2],l.x),u[3]=Math.max(d[3],l.y)}return u};f.expandPointInPlace=function(d,l){l[0]<d[0]&&(d[0]=l[0]);l[0]>d[2]&&(d[2]=l[0]);l[1]<d[1]&&(d[1]=l[1]);l[1]>d[3]&&(d[3]=l[1])};f.expandWithNestedArray=function(d,
l,u=d){const H=l.length;let F=d[0],N=d[1],L=d[2];d=d[3];for(let C=0;C<H;C++){const v=l[C];F=Math.min(F,v[0]);N=Math.min(N,v[1]);L=Math.max(L,v[0]);d=Math.max(d,v[1])}u[0]=F;u[1]=N;u[2]=L;u[3]=d;return u};f.fromExtent=function(d,l=k()){l[0]=d.xmin;l[1]=d.ymin;l[2]=d.xmax;l[3]=d.ymax;return l};f.fromValues=function(d,l,u,H,F=k()){F[0]=d;F[1]=l;F[2]=u;F[3]=H;return F};f.height=g;f.intersection=function(d,l,u=d){const H=l[0],F=l[1],N=l[2];l=l[3];u[0]=t(d[0],H,N);u[1]=t(d[1],F,l);u[2]=t(d[2],H,N);u[3]=
t(d[3],F,l);return u};f.intersects=function(d,l){return Math.max(l[0],d[0])<=Math.min(l[2],d[2])&&Math.max(l[1],d[1])<=Math.min(l[3],d[3])};f.is=h;f.isPoint=function(d){return(0===m(d)||!isFinite(d[0]))&&(0===g(d)||!isFinite(d[1]))};f.offset=function(d,l,u,H=d){H[0]=d[0]+l;H[1]=d[1]+u;H[2]=d[2]+l;H[3]=d[3]+u;return H};f.pad=function(d,l,u=d){u[0]=d[0]-l;u[1]=d[1]-l;u[2]=d[2]+l;u[3]=d[3]+l;return u};f.set=p;f.setMax=function(d,l,u=d){u[2]=l[0];u[3]=l[1];u!==d&&(u[0]=d[0],u[1]=d[1]);return d};f.setMin=
function(d,l,u=d){u[0]=l[0];u[1]=l[1];u!==d&&(u[2]=d[2],u[3]=d[3]);return u};f.size=function(d,l){l[0]=d[2]-d[0];l[1]=d[3]-d[1]};f.toExtent=function(d,l){return new a({xmin:d[0],ymin:d[1],xmax:d[2],ymax:d[3],spatialReference:l})};f.width=m;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/JSONSupport".split(" "),
function(f,w,q,a,k,m,g,c,p,h,t,B){var z;q=z=function(d){function l(u){u=d.call(this,u)||this;u.level=0;u.levelValue=null;u.resolution=0;u.scale=0;return u}f._inheritsLoose(l,d);l.prototype.clone=function(){return new z({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};return l}(B.JSONSupport);w.__decorate([m.property({type:k.Integer,json:{write:!0}})],q.prototype,"level",void 0);w.__decorate([m.property({type:String,json:{write:!0}})],q.prototype,"levelValue",
void 0);w.__decorate([m.property({type:Number,json:{write:!0}})],q.prototype,"resolution",void 0);w.__decorate([m.property({type:Number,json:{write:!0}})],q.prototype,"scale",void 0);return q=z=w.__decorate([c.subclass("esri.layers.support.LOD")],q)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/Accessor ../../request ../../core/Handles ../../core/LRUCache ../../core/watchUtils ./Tilemap".split(" "),
function(f,w,q,a,k,m,g,c,p,h,t,B,z,d,l,u,H,F,N,L,C,v){var A;const M=k.getLogger("esri.layers.support.TilemapCache");f.TilemapCache=A=function(P){function O(y){y=P.call(this,y)||this;y._handles=new N;y._pendingTilemapRequests={};y._availableLevels={};y.levels=5;y.cacheByteSize=2097152;y.request=F;y._prefetchingEnabled=!0;return y}w._inheritsLoose(O,P);var D=O.prototype;D.initialize=function(){this._tilemapCache=new L(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],
()=>this._initializeTilemapDefinition()),C.init(this,"layer.tileInfo.lods",y=>this._initializeAvailableLevels(y),!0)]);this._initializeTilemapDefinition()};D.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};D.castLevels=function(y){return 2>=y?(M.error("Minimum levels for Tilemap is 3, but got ",y),3):y};D.fetchTilemap=function(y,I,K,J){if(!this._availableLevels[y])return Promise.reject(new h("tilemap-cache:level-unavailable",`Level ${y} is unavailable in the service`));
const S=this._tmpTilemapDefinition;if(y=this._tilemapFromCache(y,I,K,S))return Promise.resolve(y);const aa=J&&J.signal;J={...J,signal:null};return new Promise((Y,V)=>{l.onAbort(aa,()=>V(l.createAbortError()));const ca=v.tilemapDefinitionId(S);let ea=this._pendingTilemapRequests[ca];if(!ea){ea=v.Tilemap.fromDefinition(S,J).then(ha=>{this._tilemapCache.put(ca,ha,ha.byteSize);return ha});const ka=()=>delete this._pendingTilemapRequests[ca];this._pendingTilemapRequests[ca]=ea;ea.then(ka,ka)}ea.then(Y,
V)})};D.getAvailability=function(y,I,K){return this._availableLevels[y]?(y=this._tilemapFromCache(y,I,K,this._tmpTilemapDefinition))?y.getAvailability(I,K):"unknown":"unavailable"};D.getAvailabilityUpsample=function(y,I,K,J){J.level=y;J.row=I;J.col=K;y=this.layer.tileInfo;for(y.updateTileInfo(J);;)if(I=this.getAvailability(J.level,J.row,J.col),"unavailable"===I){if(!y.upsampleTile(J))return"unavailable"}else return I};D.fetchAvailability=function(y,I,K,J){return this._availableLevels[y]?this.fetchTilemap(y,
I,K,J).catch(S=>S).then(S=>{if(S instanceof v.Tilemap)return S=S.getAvailability(I,K),"unavailable"===S?Promise.reject(new h("tile-map:tile-unavailable","Tile is not available",{level:y,row:I,col:K})):S;if(l.isAbortError(S))throw S;return"unknown"}):Promise.reject(new h("tilemap-cache:level-unavailable",`Level ${y} is unavailable in the service`))};D.fetchAvailabilityUpsample=function(y,I,K,J,S){J.level=y;J.row=I;J.col=K;const aa=this.layer.tileInfo;aa.updateTileInfo(J);const Y=this.fetchAvailability(y,
I,K,S).catch(V=>{if(l.isAbortError(V))throw V;if(aa.upsampleTile(J))return this.fetchAvailabilityUpsample(J.level,J.row,J.col,J);throw V;});this._fetchAvailabilityUpsamplePrefetch(J.id,y,I,K,S,Y);return Y};D._fetchAvailabilityUpsamplePrefetch=async function(y,I,K,J,S,aa){if(this._prefetchingEnabled){var Y=`prefetch-${y}`;if(!this._handles.has(Y)){var V=l.createAbortController();aa.then(()=>V.abort(),()=>V.abort());var ca=!1;this._handles.add({remove(){ca||(ca=!0,V.abort())}},Y);await u.waitTicks(10,
V.signal).catch(()=>{});ca||(ca=!0,this._handles.remove(Y));if(!l.isAborted(V))for(y={id:y,level:I,row:K,col:J},S={...S,signal:V.signal},I=this.layer.tileInfo,K=0;A._prefetches.length<A._maxPrefetch&&I.upsampleTile(y);++K){const ea=this.fetchAvailability(y.level,y.row,y.col,S);A._prefetches.push(ea);J=()=>{A._prefetches.removeUnordered(ea)};ea.then(J,J)}}}};D._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var y=this.layer.parsedUrl,I=y.query;this._tilemapCache.clear();this._tmpTilemapDefinition=
{service:{url:y.path,query:I?t.objectToQuery(I):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};D._tilemapFromCache=function(y,I,K,J){J.level=y;J.row=I-I%this.size;J.col=K-K%this.size;y=v.tilemapDefinitionId(J);return this._tilemapCache.get(y)};D._initializeAvailableLevels=function(y){this._availableLevels={};y&&y.forEach(I=>this._availableLevels[I.level]=!0)};w._createClass(O,[{key:"size",get:function(){return 1<<
this.levels}},{key:"test",get:function(){const y=this;return{get prefetchingEnabled(){return y._prefetchingEnabled},set prefetchingEnabled(I){y._prefetchingEnabled=I},hasTilemap(I,K,J){return!!y._tilemapFromCache(I,K,J,y._tmpTilemapDefinition)}}}}]);return O}(H);f.TilemapCache._maxPrefetch=4;f.TilemapCache._prefetches=new d({initialSize:A._maxPrefetch});q.__decorate([m.property({constructOnly:!0,type:Number})],f.TilemapCache.prototype,"levels",void 0);q.__decorate([g.cast("levels")],f.TilemapCache.prototype,
"castLevels",null);q.__decorate([m.property({readOnly:!0,type:Number})],f.TilemapCache.prototype,"size",null);q.__decorate([m.property({constructOnly:!0,type:Number})],f.TilemapCache.prototype,"cacheByteSize",void 0);q.__decorate([m.property({constructOnly:!0})],f.TilemapCache.prototype,"layer",void 0);q.__decorate([m.property({constructOnly:!0})],f.TilemapCache.prototype,"request",void 0);f.TilemapCache=A=q.__decorate([p.subclass("esri.layers.support.TilemapCache")],f.TilemapCache);Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/layers/support/Tilemap":function(){define(["exports","../../core/lang","../../core/Error","../../core/arrayUtils","../../request"],function(f,w,q,a,k){function m(c){if("vector-tile"===c.service.type)var p=`${c.service.url}/tilemap/${c.level}/${c.row}/${c.col}/${c.width}/${c.height}`;else p=c.service.tileServers,p=`${p&&p.length?p[c.row%p.length]:c.service.url}/tilemap/${c.level}/${c.row}/${c.col}/${c.width}/${c.height}`;(c=c.service.query)&&(p=`${p}?${c}`);return p}
let g=function(){function c(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var p=c.prototype;p.getAvailability=function(h,t){if("unknown"!==this._allAvailability)return this._allAvailability;h=(h-this.location.top)*this.location.width+(t-this.location.left);t=h>>3;const B=this._tileAvailabilityBitSet;return 0>t||t>B.length?"unknown":B[t]&1<<h%8?"available":"unavailable"};p._updateFromData=function(h){let t=!0,B=!0;const z=new Uint8Array(Math.ceil(this.location.width*
this.location.height/8));let d=0;for(let l=0;l<h.length;l++){const u=l%8;h[l]?(B=!1,z[d]|=1<<u):t=!1;7===u&&++d}B?this._allAvailability="unavailable":t?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=z,this.byteSize+=z.length)};c.fromDefinition=function(h,t){const B=h.service.request||k,{row:z,col:d,width:l,height:u}=h,H={query:{f:"json"}};t=t?{...H,...t}:H;return B(m(h),t).then(F=>F.data).catch(F=>{if(F&&F.details&&422===F.details.httpStatus)return{location:{top:z,
left:d,width:l,height:u},valid:!0,data:a.constant(l*u,0)};throw F;}).then(F=>{if(F.location&&(F.location.top!==z||F.location.left!==d||F.location.width!==l||F.location.height!==u))throw new q("tilemap:location-mismatch","Tilemap response for different location than requested",{response:F,definition:{top:z,left:d,width:l,height:u}});return c.fromJSON(F)})};c.fromJSON=function(h){c.validateJSON(h);const t=new c;t.location=Object.freeze(w.clone(h.location));t._updateFromData(h.data);return Object.freeze(t)};
c.validateJSON=function(h){if(!h||!h.location)throw new q("tilemap:missing-location","Location missing from tilemap response");if(!1===h.valid)throw new q("tilemap:invalid","Tilemap response was marked as invalid");if(!h.data)throw new q("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(h.data))throw new q("tilemap:data-mismatch","Data must be an array of numbers");if(h.data.length!==h.location.width*h.location.height)throw new q("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");
};return c}();f.Tilemap=g;f.default=g;f.tilemapDefinitionId=function(c){return`${c.level}/${c.row}/${c.col}/${c.width}/${c.height}`};f.tilemapDefinitionUrl=m;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/layers/mixins/ArcGISCachedService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/SpatialReference ../../geometry ../support/serviceTileInfoProperty ../support/TilemapCache".split(" "),
function(f,w,q,a,k,m,g,c,p,h,t,B,z,d,l,u,H){f.ArcGISCachedService=F=>{F=function(N){function L(){var v=N.apply(this,arguments)||this;v.copyright=null;v.minScale=0;v.maxScale=0;v.spatialReference=null;v.tileInfo=null;v.tilemapCache=null;return v}w._inheritsLoose(L,N);var C=L.prototype;C.readMinScale=function(v,A){return null!=A.minLOD&&null!=A.maxLOD?v:0};C.readMaxScale=function(v,A){return null!=A.minLOD&&null!=A.maxLOD?v:0};C.readTilemapCache=function(v,A){return A.capabilities&&-1<A.capabilities.indexOf("Tilemap")?
new H.TilemapCache({layer:this}):null};w._createClass(L,[{key:"supportsBlankTile",get:function(){return 10.2<=this.version}}]);return L}(F);q.__decorate([g.property({json:{read:{source:"copyrightText"}}})],F.prototype,"copyright",void 0);q.__decorate([g.property()],F.prototype,"minScale",void 0);q.__decorate([p.reader("service","minScale")],F.prototype,"readMinScale",null);q.__decorate([g.property()],F.prototype,"maxScale",void 0);q.__decorate([p.reader("service","maxScale")],F.prototype,"readMaxScale",
null);q.__decorate([g.property({type:d})],F.prototype,"spatialReference",void 0);q.__decorate([g.property({readOnly:!0})],F.prototype,"supportsBlankTile",null);q.__decorate([g.property(u.serviceTileInfoProperty)],F.prototype,"tileInfo",void 0);q.__decorate([g.property()],F.prototype,"tilemapCache",void 0);q.__decorate([p.reader("service","tilemapCache",["capabilities"])],F.prototype,"readTilemapCache",null);q.__decorate([g.property()],F.prototype,"version",void 0);return F=q.__decorate([h.subclass("esri.layers.mixins.ArcGISCachedService")],
F)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(f,w){function q(k,m,g,c){if(!k)return null;const {minScale:p,maxScale:h,minLOD:t,maxLOD:B}=m;if(null!=t&&null!=B)return c&&c.ignoreMinMaxLOD?w.fromJSON(k):w.fromJSON({...k,lods:k.lods.filter(({level:z})=>null!=z&&z>=t&&z<=B)});if(0!==p&&0!==h){const z=p?Math.round(1E4*p)/1E4:Infinity,d=h?Math.round(1E4*h)/1E4:-Infinity;return w.fromJSON({...k,lods:k.lods.filter(l=>
{l=Math.round(1E4*l.scale)/1E4;return l<=z&&l>=d})})}return w.fromJSON(k)}const a={type:w,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:q}}}}};f.readServiceTileInfo=q;f.serviceTileInfoProperty=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/layers/support/imageUtils":function(){define(["exports"],function(f){f.checkWebPSupport=function(w){const q={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA\x3d\x3d",
alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA\x3d\x3d",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise(a=>{const k=new Image;k.onload=()=>{k.onload=k.onerror=null;a(0<k.width&&0<k.height)};k.onerror=()=>{k.onload=k.onerror=null;a(!1)};k.src="data:image/webp;base64,"+q[w]})};Object.defineProperty(f,"__esModule",{value:!0})})},
"esri/layers/support/SpriteSource":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Logger","../../core/Error","../../core/urlUtils","../../request"],function(f,w,q,a,k){const m=w.getLogger("esri.layers.support.SpriteSource");return function(){function g(p,h,t,B){this.baseURL=p;this.devicePixelRatio=h;this.maxTextureSize=t;this._spriteImageFormat=B;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}var c=g.prototype;c.getSpriteInfo=
function(p){return this._spritesData[p]};c.load=async function(p){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(p),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"};c._loadSprites=function(p){this._isRetina=1.15<this.devicePixelRatio?!0:!1;const h=a.urlToObject(this.baseURL),t=h.query?"?"+a.objectToQuery(h.query):"",B=this._isRetina?"@2x":"",z=`${h.path}${B}.${this._spriteImageFormat}${t}`;return Promise.all([k(`${h.path}${B}.json${t}`,
p),k(z,{responseType:"image",...p})]).then(([d,l])=>{var u=Object.keys(d.data);if(!u||0===u.length||1===u.length&&"_ssl"===u[0]||!l||!l.data)return this._spritesData=this.image=null,this.width=this.height=0,Promise.resolve(null);this._spritesData=d.data;d=l.data;l=Math.max(this.maxTextureSize,4096);if(d.width>l||d.height>l)throw d=`Sprite resource for style ${h.path} is bigger than the maximum allowed of ${l} pixels}`,m.error(d),new q("SpriteSource",d);this.width=d.width;this.height=d.height;l=document.createElement("canvas");
u=l.getContext("2d");l.width=d.width;l.height=d.height;u.drawImage(d,0,0,d.width,d.height);d=u.getImageData(0,0,d.width,d.height);d=new Uint8Array(d.data);for(u=0;u<d.length;u+=4)l=d[u+3]/255,d[u]*=l,d[u+1]*=l,d[u+2]*=l;this.image=d})};f._createClass(g,[{key:"spriteNames",get:function(){const p=[];for(const h in this._spritesData)p.push(h);p.sort();return p}}]);return g}()})},"esri/layers/support/vectorTileLayerLoader":function(){define("exports ../../config ../../core/urlUtils ../../core/promiseUtils ../../request ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),
function(f,w,q,a,k,m){function g(z){z&&(z=q.getOrigin(z),B&&-1===B.indexOf(z)&&B.push(z))}function c(...z){let d=void 0;for(let l=0;l<z.length;++l)q.isProtocolRelative(z[l])?d&&(d=d.split("://")[0]+":"+z[l].trim()):d=q.isAbsolute(z[l])?z[l]:q.join(d,z[l]);return q.removeTrailingSlash(d)}async function p(z,d,l,u,H){a.throwIfAborted(H);if("string"===typeof l){u=q.normalize(l);g(u);var F=q.urlToObject(u);F=await k(F.path,{query:{f:"json"},responseType:"json",...H});l=u}else F={data:l},l=l.jsonUrl||null;
const N=F.data;F.ssl&&(l&&(l=l.replace(/^http:/i,"https:")),u&&(u=u.replace(/^http:/i,"https:")));return N.sources?(z.styleUrl=l||null,h(z,N,u,H)):N.sources?Promise.reject("You must specify the URL or the JSON for a service or for a style."):z.sourceUrl?t(z,N,u,!1,d,H):(z.sourceUrl=l||null,t(z,N,u,!0,d,H))}async function h(z,d,l,u){l=l?q.removeFile(l):q.appBaseUrl;z.styleBase=l;z.style=d;z.styleUrl&&g(z.styleUrl);d["sprite-format"]&&"webp"===d["sprite-format"].toLowerCase()&&(z.spriteFormat="webp");
const H=[];if(d.sources&&d.sources.esri){const F=d.sources.esri;F.url?await p(z,"esri",c(l,F.url),void 0,u):H.push(p(z,"esri",F,l,u))}for(const F of Object.keys(d.sources))"esri"!==F&&"vector"===d.sources[F].type&&(d.sources[F].url?H.push(p(z,F,c(l,d.sources[F].url),void 0,u)):d.sources[F].tiles&&H.push(p(z,F,d.sources[F],l,u)));await Promise.all(H)}async function t(z,d,l,u,H,F){l=l?q.removeTrailingSlash(l)+"/":q.appBaseUrl;if(d.hasOwnProperty("tileInfo"))var N=d;else{var L={xmin:-2.0037507067161843E7,
ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},C=78271.51696400007,v=2.958287637957775E8,A=[],M=d.hasOwnProperty("minzoom")?parseFloat(d.minzoom):0,P=d.hasOwnProperty("maxzoom")?parseFloat(d.maxzoom):22;for(let O=0;O<=P;O++)O>=M&&A.push({level:O,scale:v,resolution:C}),C/=2,v/=2;for(N of d.tiles)g(c(l,N));N={capabilities:"TilesOnly",initialExtent:L,fullExtent:L,minScale:0,maxScale:0,tiles:d.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",
origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:A,spatialReference:{wkid:102100}}}}L=new m(H,l,N);if(!u&&z.primarySourceName in z.sourceNameToSource){C=z.sourceNameToSource[z.primarySourceName];if(!C.isCompatibleWith(L))return Promise.resolve();null!=L.fullExtent&&(null!=C.fullExtent?C.fullExtent.union(L.fullExtent):C.fullExtent=L.fullExtent.clone());C.tileInfo.lods.length<L.tileInfo.lods.length&&(C.tileInfo=L.tileInfo)}u?(z.sourceBase=l,z.source=d,z.validatedSource=N,z.primarySourceName=H,
z.sourceUrl&&g(z.sourceUrl)):g(l);z.sourceNameToSource[H]=L;if(!z.style)return null==d.defaultStyles?Promise.reject():"string"===typeof d.defaultStyles?p(z,"",c(l,d.defaultStyles,"root.json"),void 0,F):p(z,"",d.defaultStyles,c(l,"root.json"),F)}const B=w.defaults&&w.defaults.io.corsEnabledServers;f.loadMetadata=async function(z,d){const l={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},
[u,H]="string"===typeof z?[z,null]:[null,z.jsonUrl],F=u?q.urlToObject(u):null;await p(l,"esri",z,H,d);z={layerDefinition:l.validatedSource,url:u,parsedUrl:F,serviceUrl:l.sourceUrl,style:l.style,styleUrl:l.styleUrl,spriteUrl:l.style.sprite&&c(l.styleBase,l.style.sprite),spriteFormat:l.spriteFormat,glyphsUrl:l.style.glyphs&&c(l.styleBase,l.style.glyphs),sourceNameToSource:l.sourceNameToSource,primarySourceName:l.primarySourceName};g(z.spriteUrl);g(z.glyphsUrl);return z};Object.defineProperty(f,"__esModule",
{value:!0})})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),function(f,w,q,a,k,m){return function(){function g(p,h,t){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=p;if(this.sourceUrl=
h)this.parsedUrl=w.urlToObject(this.sourceUrl);const B=this.parsedUrl.path,z=this.parsedUrl.query?"?"+w.objectToQuery(this.parsedUrl.query):"";p=f.clone(t);const d=p.tiles;h&&d.forEach((H,F)=>{w.isAbsolute(H)||(d[F]=w.join(B,H)+z)});this.tileServers=d;t.tileMap&&(this.tileMapURL=w.join(h,t.tileMap));var l=t.capabilities&&t.capabilities.split(",").map(H=>H.toLowerCase().trim());h=!!t.exportTilesAllowed;l=!!l&&-1!==l.indexOf("tilemap");const u=h&&t.hasOwnProperty("maxExportTilesCount")?t.maxExportTilesCount:
0;this.capabilities={operations:{supportsExportTiles:h,supportsTileMap:l},exportTiles:h?{maxExportTilesCount:+u}:null};this.tileInfo=a.readServiceTileInfo(p.tileInfo,p,null,{ignoreMinMaxLOD:!0});l&&(this.type="vector-tile",this.tilemapCache=new k.TilemapCache({layer:this}),this.tileIndex=new m(this.tilemapCache));this.fullExtent=q.fromJSON(t.fullExtent)}var c=g.prototype;c.getRefKey=function(p,h){return this.tileIndex?this.tileIndex.dataKey(p,h):Promise.resolve(p)};c.getSourceTileUrl=function(p,h,
t){let B=this.tileServers[h%this.tileServers.length];return B=B.replace(/\{z\}/gi,p.toString()).replace(/\{y\}/gi,h.toString()).replace(/\{x\}/gi,t.toString())};c.isCompatibleWith=function(p){var h=this.tileInfo;p=p.tileInfo;if(!h.spatialReference.equals(p.spatialReference)||!h.origin.equals(p.origin)||Math.round(h.dpi)!==Math.round(p.dpi))return!1;h=h.lods;p=p.lods;const t=Math.min(h.length,p.length);for(let B=0;B<t;B++){const z=h[B],d=p[B];if(z.level!==d.level||Math.round(z.scale)!==Math.round(d.scale))return!1}return!0};
return g}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(f,w,q){return function(){function a(m){if(m instanceof w.TilemapCache)this._tilemapCache=m;else if(m&&"index"in m)this._tilemap=m.index;else throw Error("Invalid tilemap!");}var k=a.prototype;k.dataKey=function(m,g){if(this._tilemapCache){const {level:c,row:p,col:h}=m,t=new q(m);return this._tilemapCache.fetchAvailabilityUpsample(c,
p,h,t,g).then(()=>{t.world=m.world;return t}).catch(B=>{if(f.isAbortError(B))throw B;return null})}return this._getIndexedDataKey(m)};k.forEach=function(m,g,c,p,h){this._callback=h;this._maxLevel=g+m;this._forEach(this._tilemap,g,c,p)};k._forEach=function(m,g,c,p){0!==m&&(this._callback(g,c,p),g!==this._maxLevel&&"object"===typeof m&&(this._forEach(m[0],g+1,2*c,2*p),this._forEach(m[1],g+1,2*c,2*p+1),this._forEach(m[2],g+1,2*c+1,2*p),this._forEach(m[3],g+1,2*c+1,2*p+1)))};k._getIndexedDataKey=function(m){const g=
[m];if(0>m.level||0>m.row||0>m.col||0<m.row>>m.level||0<m.col>>m.level)return Promise.resolve(null);for(;0!==m.level;)m=new q(m.level-1,m.row>>1,m.col>>1,m.world),g.push(m);m=this._tilemap;let c=g.pop(),p,h;if(1===m)return Promise.resolve(c);for(;g.length;)if(p=g.pop(),h=(p.col&1)+((p.row&1)<<1),m){if(0===m[h]){c=null;break}if(1===m[h]){c=p;break}c=p;m=m[h]}return Promise.resolve(c)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],
function(f,w){let q=function(){function a(m,g,c,p){this.set(m,g,c,p)}a.getId=function(m,g,c,p){return"object"===typeof m?`${m.level}/${m.row}/${m.col}/${m.world}`:`${m}/${g}/${c}/${p}`};var k=a.prototype;k.acquire=function(m,g,c,p){this.set(m,g,c,p)};k.contains=function(m){const g=m.level-this.level;return this.row===m.row>>g&&this.col===m.col>>g&&this.world===m.world};k.equals=function(m){return this.level===m.level&&this.row===m.row&&this.col===m.col&&this.world===m.world};k.clone=function(){return new a(this)};
k.release=function(){this.world=this.col=this.row=this.level=0};k.set=function(m,g,c,p){if(null==m)this.world=this.col=this.row=this.level=0;else if("object"===typeof m)this.level=m.level||0,this.row=m.row||0,this.col=m.col||0,this.world=m.world||0;else if("string"===typeof m){const [h,t,B,z]=m.split("/");this.level=parseFloat(h);this.row=parseFloat(t);this.col=parseFloat(B);this.world=parseFloat(z)}else this.level=+m,this.row=+g,this.col=+c,this.world=+p||0;return this};k.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};
k.getParentKey=function(){return 0>=this.level?null:new a(this.level-1,this.row>>1,this.col>>1,this.world)};k.getChildKeys=function(){const m=this.level+1,g=this.row<<1,c=this.col<<1,p=this.world;return[new a(m,g,c,p),new a(m,g,c+1,p),new a(m,g+1,c,p),new a(m,g+1,c+1,p)]};k.compareRowMajor=function(m){return this.row<m.row?-1:this.row>m.row?1:this.col<m.col?-1:this.col>m.col?1:0};f._createClass(a,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(m){this.set(m)}}]);
return a}();q.pool=new w(q,null,null,25,50);return q})},"esri/portal/support/jsonContext":function(){define(["exports","../../core/urlUtils","../Portal"],function(f,w,q){f.createForItem=function(a){return{origin:"portal-item",url:w.urlToObject(a.itemUrl),portal:a.portal||q.getDefault(),portalItem:a,readResourcePaths:[]}};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["../../../../layers/support/LOD","../../../../layers/support/TileInfo"],
function(f,w){return function(){function q(k,m){this.lockedSchemaPixelSize=k;this.isGCS=m}var a=q.prototype;a.getLevelRowColumn=function(k){return this.isGCS?[k[0],k[1]>>1,k[2]>>1]:256===this.lockedSchemaPixelSize&&0<k[0]?[k[0]-1,k[1]>>1,k[2]>>1]:k};a.adjustLevel=function(k){return this.isGCS?k:256===this.lockedSchemaPixelSize?0<k?k-1:0:k};a.getShift=function(k,m){let g=0,c=0;if(256===this.lockedSchemaPixelSize||this.isGCS)k[2]%2&&(g=m),k[1]%2&&(c=m);return[g,c]};a.getScale=function(k){if(this.isGCS){if(512===
this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===k)return 1;return 2};q.create256x256CompatibleTileInfo=function(k){if(!k)return null;if(256===k.size[0]&&256===k.size[1])return k;const m=k.spatialReference.isGeographic,g=[],c=k.lods.length;for(let p=0;p<c;p++){const h=k.lods[p];g.push(new f({level:h.level,scale:h.scale,resolution:m?h.resolution:2*h.resolution}))}return new w({size:[256,256],dpi:k.dpi,format:k.format,compressionQuality:k.compressionQuality,origin:k.origin,
spatialReference:k.spatialReference,lods:g})};q.create512x512CompatibleTileInfo=function(k){if(!k||256===k.size[0]||256===k.size[1])return null;const m=[],g=k.lods.length;for(let c=0;c<g;c++){const p=k.lods[c];m.push(new f({level:p.level,scale:p.scale,resolution:.5*p.resolution}))}return new w({size:[512,512],dpi:k.dpi,format:k.format,compressionQuality:k.compressionQuality,origin:k.origin,spatialReference:k.spatialReference,lods:m})};return q}()})},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["exports",
"../../../../layers/support/TileInfo"],function(f,w){f.areSchemasOverlapping=function(q,a){if(q===a)return!0;if(!q&&null!=a||null!=q&&!a||!q.spatialReference.equals(a.spatialReference)||q.dpi!==a.dpi)return!1;var k=q.origin;const m=a.origin;if(1E-6<=Math.abs(k.x-m.x)||1E-6<=Math.abs(k.y-m.y))return!1;q.lods[0].scale>a.lods[0].scale?(k=q,q=a):k=a;for(a=k.lods[0].scale;a>=q.lods[q.lods.length-1].scale-1E-6;a/=2)if(1E-6>Math.abs(a-q.lods[0].scale))return!0;return!1};f.unionTileInfos=function(q,a){if(q===
a)return q;if(!q&&null!=a)return a;if(null!=q&&!a)return q;const k=q.size[0],m=q.format,g=q.dpi,c={x:q.origin.x,y:q.origin.y},p=q.spatialReference.toJSON();var h=q.lods[0].scale>a.lods[0].scale?q.lods[0]:a.lods[0];q=(q.lods[q.lods.length-1].scale<=a.lods[a.lods.length-1].scale?q.lods[q.lods.length-1]:a.lods[a.lods.length-1]).scale;a=[];let t=h.scale;h=h.resolution;let B=0;for(;t>q;)a.push({level:B,resolution:h,scale:t}),B++,t/=2,h/=2;return new w({size:[k,k],dpi:g,format:m||"pbf",origin:c,lods:a,
spatialReference:p})};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleLayer"],function(f){return function(){function w(a,k){this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;a.layers||(a.layers=[]);this.version=parseFloat(a.version);this.sprite=k?k.spriteUrl:a.sprite;this.glyphs=k?k.glyphsUrl:a.glyphs;if(this.layers=a.layers.map((m,g,c)=>this._create(m,g,c)))for(k=0;k<
this.layers.length;k++)a=this.layers[k],this._layerByName[a.id.toLowerCase()]=a,this._uidToLayer.set(a.uid,a),0===a.type&&this.backgroundBucketIds.push(a.id);this._identifyRefLayers()}var q=w.prototype;q.isPainterDataDriven=function(a){return(a=this._layerByName[a.toLowerCase()])?a.isPainterDataDriven():!1};q.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};q.getStyleLayerByUID=function(a){a=this._uidToLayer.get(a);return null!=a?a:null};q.getStyleLayerIndex=function(a){return(a=
this._layerByName[a.toLowerCase()])?this.layers.indexOf(a):-1};q.setStyleLayer=function(a,k){if(a&&a.id){k&&k>=this.layers.length&&(k=this.layers.length-1);var m=!0,g;if(g=this._layerByName[a.id.toLowerCase()]){const c=this.layers.indexOf(g);k||(k=c);k===c?(m=!1,g=w._recreateLayer(a,g),this.layers[k]=g):(this.layers.splice(c,1),g=this._create(a,k,this.layers),this.layers.splice(k,0,g))}else g=this._create(a,k,this.layers),!k||k>=this.layers.length?this.layers.push(g):this.layers.splice(k,0,g);this._layerByName[a.id.toLowerCase()]=
g;this._uidToLayer.set(g.uid,g);m&&this._recomputeZValues();this._identifyRefLayers()}};q.getStyleLayer=function(a){return(a=this._layerByName[a.toLowerCase()])?{type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:a.paint}:null};q.deleteStyleLayer=function(a){const k=this._layerByName[a.toLowerCase()];k&&(delete this._layerByName[a.toLowerCase()],this._uidToLayer.delete(k.uid),a=this.layers.indexOf(k),this.layers.splice(a,
1),this._recomputeZValues(),this._identifyRefLayers())};q.getLayerById=function(a){return this._layerByName[a.toLowerCase()]};q.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};q.getPaintProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.paint:null};q.setPaintProperties=function(a,k){a=this._layerByName[a.toLowerCase()];if(!a)return"";k=w._recreateLayer({type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,
maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:k},a);const m=this.layers.indexOf(a);this.layers[m]=k;this._layerByName[a.id.toLowerCase()]=k;this._uidToLayer.set(a.uid,k);return a.id};q.setLayoutProperties=function(a,k){a=this._layerByName[a.toLowerCase()];if(!a)return"";k=w._recreateLayer({type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:k,paint:a.paint},a);const m=this.layers.indexOf(a);this.layers[m]=k;this._layerByName[a.id.toLowerCase()]=
k;this._uidToLayer.set(a.uid,k);return a.id};q.setStyleLayerVisibility=function(a,k){if(a=this._layerByName[a.toLowerCase()]){var m=a.layout||{};m.visibility=k;k=w._recreateLayer({type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:m,paint:a.paint},a);m=this.layers.indexOf(a);this.layers[m]=k;this._layerByName[a.id.toLowerCase()]=k;this._uidToLayer.set(a.uid,k)}};q.getStyleLayerVisibility=function(a){var k;a=this._layerByName[a.toLowerCase()];
if(!a)return"none";a=a.layout;return null!=(k=null==a?void 0:a.visibility)?k:"visible"};q._recomputeZValues=function(){const a=this.layers,k=1/(a.length+1);for(let m=0;m<a.length;m++)a[m].z=1-(1+m)*k};q._identifyRefLayers=function(){const a=[],k=[];let m=0;for(const p of this.layers){if(1===p.type){var g=p,c=p.source+"|"+p.sourceLayer;c+="|"+JSON.stringify(p.layout&&p.layout.visibility);c+="|"+JSON.stringify(p.minzoom);c+="|"+JSON.stringify(p.maxzoom);c+="|"+JSON.stringify(p.filter);if(g.hasDataDrivenFill||
g.hasDataDrivenOutline)c+="|"+JSON.stringify(m);a.push({key:c,layer:p})}2===p.type&&(g=p,c=p.source+"|"+p.sourceLayer,c+="|"+JSON.stringify(p.layout&&p.layout.visibility),c+="|"+JSON.stringify(p.minzoom),c+="|"+JSON.stringify(p.maxzoom),c+="|"+JSON.stringify(p.filter),c+="|"+JSON.stringify(p.layout&&p.layout["line-cap"]),c+="|"+JSON.stringify(p.layout&&p.layout["line-join"]),g.hasDataDrivenLine&&(c+="|"+JSON.stringify(m)),k.push({key:c,layer:p}));++m}this._assignRefLayers(a);this._assignRefLayers(k)};
q._assignRefLayers=function(a){a.sort((c,p)=>c.key<p.key?-1:c.key>p.key?1:0);let k,m;const g=a.length;for(let c=0;c<g;c++){const p=a[c];if(p.key===k)p.layer.refLayerId=m;else if(k=p.key,m=p.layer.id,1===p.layer.type&&!p.layer.getPaintProperty("fill-outline-color"))for(let h=c+1;h<g;h++){const t=a[h];if(t.key===k){if(t.layer.getPaintProperty("fill-outline-color")){a[c]=t;a[h]=p;m=t.layer.id;break}}else break}}};q._create=function(a,k,m){k=1-1/(m.length+1)*(1+k);m=this._runningId++;switch(a.type){case "background":return new f.BackgroundStyleLayer(0,
a,k,m);case "fill":return new f.FillStyleLayer(1,a,k,m);case "line":return new f.LineStyleLayer(2,a,k,m);case "symbol":return new f.SymbolStyleLayer(3,a,k,m);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new f.CircleStyleLayer(4,a,k,m)}throw Error("Unknown vector tile layer");};w._recreateLayer=function(a,k){switch(a.type){case "background":return new f.BackgroundStyleLayer(0,a,k.z,k.uid);case "fill":return new f.FillStyleLayer(1,a,k.z,k.uid);case "line":return new f.LineStyleLayer(2,
a,k.z,k.uid);case "symbol":return new f.SymbolStyleLayer(3,a,k.z,k.uid);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new f.CircleStyleLayer(4,a,k.z,k.uid)}};return w}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(f,w,q,a,k,m,g,c,p,h,t){let B=function(){function L(v,A,M,P){this.type=v;this.typeName=A.type;this.id=A.id;this.source=A.source;this.sourceLayer=A["source-layer"];this.minzoom=A.minzoom;this.maxzoom=A.maxzoom;this.filter=A.filter;this.layout=A.layout;this.paint=A.paint;this.z=M;this.uid=P;switch(v){case 0:this._layoutDefinition=p.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=p.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=p.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=p.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=p.StyleDefinition.lineLayoutDefinition;this._paintDefinition=p.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=p.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=p.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=p.StyleDefinition.circleLayoutDefinition,this._paintDefinition=p.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);
this._paintProperties=this._parsePaint(this.paint)}var C=L.prototype;C.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=c.createFilter(this.filter)};C.getLayoutProperty=function(v){return this._layoutProperties[v]};C.getPaintProperty=function(v){return this._paintProperties[v]};C.getLayoutValue=function(v,A,M){let P;const O=this._layoutProperties[v];O&&(P=O.getValue(A,M));void 0===P&&(P=this._layoutDefinition[v]["default"]);return P};C.getPaintValue=
function(v,A,M){let P;const O=this._paintProperties[v];O&&(P=O.getValue(A,M));void 0===P&&(P=this._paintDefinition[v]["default"]);return P};C.isPainterDataDriven=function(){const v=this._paintProperties;if(v)for(const A in v)if(v[A].isDataDriven)return!0;return!1};C._parseLayout=function(v){const A={};for(const M in v){const P=this._layoutDefinition[M];P&&(A[M]=new h(P,v[M]))}return A};C._parsePaint=function(v){const A={};for(const M in v){const P=this._paintDefinition[M];P&&(A[M]=new h(P,v[M]))}return A};
C.computeAttributesKey=function(v,A){let M=0,P=0;for(const O of A)A="icon-size"===O||"text-size"===O?this.getLayoutProperty(O):this.getPaintProperty(O),P|=(null!=A&&A.interpolator?2:null!=A&&A.isDataDriven?1:0)<<M,M+=2;return P<<3|v};return L}(),z=function(L){function C(v,A,M,P){v=L.call(this,v,A,M,P)||this;v.backgroundMaterial=new q.VTLBackgroundMaterial(v.computeAttributesKey(0,q.VTLBackgroundMaterial.ATTRIBUTES));return v}w._inheritsLoose(C,L);return C}(B),d=function(L){function C(v,A,M,P){v=L.call(this,
v,A,M,P)||this;A=v.getPaintProperty("fill-color");M=v.getPaintProperty("fill-opacity");P=v.getPaintProperty("fill-pattern");v.hasDataDrivenColor=null==A?void 0:A.isDataDriven;v.hasDataDrivenOpacity=null==M?void 0:M.isDataDriven;v.hasDataDrivenFill=v.hasDataDrivenColor||v.hasDataDrivenOpacity||(null==P?void 0:P.isDataDriven);M=v.getPaintProperty("fill-outline-color");v.outlineUsesFillColor=!M;v.hasDataDrivenOutlineColor=null==M?void 0:M.isDataDriven;v.hasDataDrivenOutline=M?M.isDataDriven:A?A.isDataDriven:
!1;v.hasDataDrivenOutline=(M?v.hasDataDrivenOutlineColor:v.hasDataDrivenColor)||v.hasDataDrivenOpacity;v.fillMaterial=new k.VTLFillMaterial(v.computeAttributesKey(1,k.VTLFillMaterial.ATTRIBUTES));v.outlineMaterial=new k.VTLOutlineMaterial(v.computeAttributesKey(2,v.outlineUsesFillColor?k.VTLOutlineMaterial.ATTRIBUTES_FILL:k.VTLOutlineMaterial.ATTRIBUTES_OUTLINE),v.outlineUsesFillColor);return v}w._inheritsLoose(C,L);return C}(B),l=function(L){function C(v,A,M,P){var O,D,y,I,K,J,S;v=L.call(this,v,
A,M,P)||this;v.lineMaterial=new m.VTLLineMaterial(v.computeAttributesKey(3,m.VTLLineMaterial.ATTRIBUTES));v.hasDataDrivenLine=(null==(O=v.getPaintProperty("line-blur"))?void 0:O.isDataDriven)||(null==(D=v.getPaintProperty("line-color"))?void 0:D.isDataDriven)||(null==(y=v.getPaintProperty("line-gap-width"))?void 0:y.isDataDriven)||(null==(I=v.getPaintProperty("line-offset"))?void 0:I.isDataDriven)||(null==(K=v.getPaintProperty("line-opacity"))?void 0:K.isDataDriven)||(null==(J=v.getPaintProperty("line-pattern"))?
void 0:J.isDataDriven)||(null==(S=v.getPaintProperty("line-width"))?void 0:S.isDataDriven);A=A.paint["line-width"];A||(A=p.StyleDefinition.linePaintDefinition["line-width"].default);O=v.getPaintProperty("line-width");v.isThinLine=!(null!=O&&O.isDataDriven)&&"number"===typeof A&&A<t.THIN_LINE_THRESHOLD;return v}w._inheritsLoose(C,L);return C}(B),u=function(L){function C(v,A,M,P){var O,D,y,I,K,J,S,aa,Y,V,ca,ea;v=L.call(this,v,A,M,P)||this;v.iconMaterial=new g.VTLIconMaterial(v.computeAttributesKey(4,
g.VTLIconMaterial.ATTRIBUTES));v.textMaterial=new g.VTLTextMaterial(v.computeAttributesKey(6,g.VTLTextMaterial.ATTRIBUTES));v.hasDataDrivenIcon=(null==(O=v.getPaintProperty("icon-color"))?void 0:O.isDataDriven)||(null==(D=v.getPaintProperty("icon-halo-blur"))?void 0:D.isDataDriven)||(null==(y=v.getPaintProperty("icon-halo-color"))?void 0:y.isDataDriven)||(null==(I=v.getPaintProperty("icon-halo-width"))?void 0:I.isDataDriven)||(null==(K=v.getPaintProperty("icon-opacity"))?void 0:K.isDataDriven)||(null==
(J=v.getLayoutProperty("icon-size"))?void 0:J.isDataDriven);v.hasDataDrivenText=(null==(S=v.getPaintProperty("text-color"))?void 0:S.isDataDriven)||(null==(aa=v.getPaintProperty("text-halo-blur"))?void 0:aa.isDataDriven)||(null==(Y=v.getPaintProperty("text-halo-color"))?void 0:Y.isDataDriven)||(null==(V=v.getPaintProperty("text-halo-width"))?void 0:V.isDataDriven)||(null==(ca=v.getPaintProperty("text-opacity"))?void 0:ca.isDataDriven)||(null==(ea=v.getLayoutProperty("text-size"))?void 0:ea.isDataDriven);
return v}w._inheritsLoose(C,L);return C}(B),H=function(L){function C(v,A,M,P){v=L.call(this,v,A,M,P)||this;v.circleMaterial=new a.VTLCircleMaterial(v.computeAttributesKey(5,a.VTLCircleMaterial.ATTRIBUTES));return v}w._inheritsLoose(C,L);return C}(B),F=function(){function L(C,v,A){var M,P,O,D,y;this.allowOverlap=C.getLayoutValue("icon-allow-overlap",v);this.ignorePlacement=C.getLayoutValue("icon-ignore-placement",v);this.keepUpright=C.getLayoutValue("icon-keep-upright",v);this.optional=C.getLayoutValue("icon-optional",
v);this.rotationAlignment=C.getLayoutValue("icon-rotation-alignment",v);2===this.rotationAlignment&&(this.rotationAlignment=A?0:1);A=C.getLayoutProperty("icon-anchor");null!=(M=A)&&M.isDataDriven?this._anchorProp=A:this.anchor=C.getLayoutValue("icon-anchor",v);A=C.getLayoutProperty("icon-offset");null!=(P=A)&&P.isDataDriven?this._offsetProp=A:this.offset=C.getLayoutValue("icon-offset",v);A=C.getLayoutProperty("icon-padding");null!=(O=A)&&O.isDataDriven?this._paddingProp=A:this.padding=C.getLayoutValue("icon-padding",
v);A=C.getLayoutProperty("icon-rotate");null!=(D=A)&&D.isDataDriven?this._rotateProp=A:this.rotate=C.getLayoutValue("icon-rotate",v);A=C.getLayoutProperty("icon-size");null!=(y=A)&&y.isDataDriven?this._sizeProp=A:this.size=C.getLayoutValue("icon-size",v)}L.prototype.update=function(C,v){this._anchorProp&&(this.anchor=this._anchorProp.getValue(C,v));this._offsetProp&&(this.offset=this._offsetProp.getValue(C,v));this._paddingProp&&(this.padding=this._paddingProp.getValue(C,v));this._rotateProp&&(this.rotate=
this._rotateProp.getValue(C,v));this._sizeProp&&(this.size=this._sizeProp.getValue(C,v))};return L}(),N=function(){function L(C,v,A){var M,P,O,D,y,I,K,J,S,aa,Y;this.allowOverlap=C.getLayoutValue("text-allow-overlap",v);this.ignorePlacement=C.getLayoutValue("text-ignore-placement",v);this.keepUpright=C.getLayoutValue("text-keep-upright",v);this.optional=C.getLayoutValue("text-optional",v);this.rotationAlignment=C.getLayoutValue("text-rotation-alignment",v);2===this.rotationAlignment&&(this.rotationAlignment=
A?0:1);A=C.getLayoutProperty("text-anchor");null!=(M=A)&&M.isDataDriven?this._anchorProp=A:this.anchor=C.getLayoutValue("text-anchor",v);A=C.getLayoutProperty("text-justify");null!=(P=A)&&P.isDataDriven?this._justifyProp=A:this.justify=C.getLayoutValue("text-justify",v);A=C.getLayoutProperty("text-letter-spacing");null!=(O=A)&&O.isDataDriven?this._letterSpacingProp=A:this.letterSpacing=C.getLayoutValue("text-letter-spacing",v);A=C.getLayoutProperty("text-line-height");null!=(D=A)&&D.isDataDriven?
this._lineHeightProp=A:this.lineHeight=C.getLayoutValue("text-line-height",v);A=C.getLayoutProperty("text-max-angle");null!=(y=A)&&y.isDataDriven?this._maxAngleProp=A:this.maxAngle=C.getLayoutValue("text-max-angle",v);A=C.getLayoutProperty("text-max-width");null!=(I=A)&&I.isDataDriven?this._maxWidthProp=A:this.maxWidth=C.getLayoutValue("text-max-width",v);A=C.getLayoutProperty("text-offset");null!=(K=A)&&K.isDataDriven?this._offsetProp=A:this.offset=C.getLayoutValue("text-offset",v);A=C.getLayoutProperty("text-padding");
null!=(J=A)&&J.isDataDriven?this._paddingProp=A:this.padding=C.getLayoutValue("text-padding",v);A=C.getLayoutProperty("text-rotate");null!=(S=A)&&S.isDataDriven?this._rotateProp=A:this.rotate=C.getLayoutValue("text-rotate",v);A=C.getLayoutProperty("text-size");null!=(aa=A)&&aa.isDataDriven?this._sizeProp=A:this.size=C.getLayoutValue("text-size",v);A=C.getLayoutProperty("text-writing-mode");null!=(Y=A)&&Y.isDataDriven?this._writingModeProp=A:this.writingMode=C.getLayoutValue("text-writing-mode",v)}
L.prototype.update=function(C,v){this._anchorProp&&(this.anchor=this._anchorProp.getValue(C,v));this._justifyProp&&(this.justify=this._justifyProp.getValue(C,v));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(C,v));this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(C,v));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(C,v));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(C,v));this._offsetProp&&(this.offset=this._offsetProp.getValue(C,
v));this._paddingProp&&(this.padding=this._paddingProp.getValue(C,v));this._rotateProp&&(this.rotate=this._rotateProp.getValue(C,v));this._sizeProp&&(this.size=this._sizeProp.getValue(C,v));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(C,v))};return L}();f.BackgroundStyleLayer=z;f.CircleStyleLayer=H;f.FillStyleLayer=d;f.IconLayout=F;f.LineStyleLayer=l;f.StyleLayer=B;f.SymbolStyleLayer=u;f.TextLayout=N;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(f,w,q){q=function(a){function k(g){return a.call(this,g)||this}w._inheritsLoose(k,a);var m=k.prototype;m.geometryInfo=function(){return k.GEOMETRY_LAYOUT};m.opacityInfo=function(){return null};m.attributes=function(){return k.ATTRIBUTES};m.attributesInfo=function(){return k.ATTRIBUTES_INFO};return k}(q.VTLMaterial);q.ATTRIBUTES=[];q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}];
q.ATTRIBUTES_INFO={};f.VTLBackgroundMaterial=q;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec4f32","../MemoryBuffer"],function(f,w,q,a){let k=function(){function g(p){this._color=q.create();this._key=p}var c=g.prototype;c.defines=function(){return[]};c.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};
c.getAttributeLocations=function(){this._locations||this._buildAttributesInfo();return this._locations};c.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};c.getEncodingInfos=function(){this._propertyEncodingInfo||this._buildAttributesInfo();return this._propertyEncodingInfo};c.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};c.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};
c.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};c.setDataUniforms=function(p,h,t,B){const z=this.getUniforms();for(const d in z){const l=z[d];switch(l.type){case "float":p.setUniform1f(l.name,l.getValue(t,h,B));break;case "vec2":p.setUniform2fv(l.name,l.getValue(t,h,B));break;case "vec4":{const u=l.getValue(t,h,B),H=u[3];this._color[0]=H*u[0];this._color[1]=H*u[1];this._color[2]=H*u[2];this._color[3]=H;p.setUniform4fv(l.name,this._color)}}}};c.encodeAttributes=
function(p,h,t){const B=this.attributesInfo(),z=this.getEncodingInfos(),d=[];for(const H of Object.keys(z)){var l,u=z[H];const {type:F,precisionFactor:N,isLayout:L}=B[H],C=L?t.getLayoutProperty(H):t.getPaintProperty(H),v=null==(l=C.interpolator)?void 0:l.getInterpolationRange(h);let A=0;for(const M of u){M.dataIndex>=d.length&&d.push(0);u=C.getValue(v?v[A]:h,p);switch(F){case 0:d[M.dataIndex]|=this._encodeByte(u*(N||1),8*M.offset);break;case 1:d[M.dataIndex]|=this._encodeByte(u*(N||1)+128,8*M.offset);
break;case 2:d[M.dataIndex]=this._encodeColor(u);break;default:throw Error("Unsupported encoding type");}++A}}return d};c.getAtributeState=function(p){const h=3+2*p;p=0|this._bit(h);return p|=this._bit(h+1)<<1};c._buildAttributesInfo=function(){const p=[],h={};var t={},B=-1,z=this.attributesInfo(),d=this.attributes();let l=-1;for(const F of d){++l;d=this.getAtributeState(l);if(0===d)continue;var u=z[F];const N=[];h[F]=N;u=u.type;for(let L=0;L<d;++L){const {dataType:C,bytesPerElement:v,count:A,normalized:M}=
g._encodingInfo[u],P=C<<2|A;let O=t[P];O&&4!==O.offset||(++B,t[P]=O={dataIndex:B,offset:0},p.push({location:-1,name:"a_data_"+B,count:4/v,type:C,normalized:M}));N.push({dataIndex:O.dataIndex,offset:O.offset});O.offset+=v*A}}this._buildVertexBufferLayout(p);t={};B=0;z=this._layoutInfo.geometry;for(var H of z)t[H.name]=B++;if(H=this._layoutInfo.opacity)for(const F of H)t[F.name]=B++;this._buildShaderInfo(p,h);this._propertyEncodingInfo=h;this._locations=t};c._buildVertexBufferLayout=function(p){const h=
{};var t=this.geometryInfo();let B=t[0].stride;if(0===p.length)h.geometry=t;else{const z=[];let d=B;B+=4*p.length;for(const l of t)t={...l},t.stride=B,z.push(t);for(const l of p)z.push({name:l.name,count:l.count,type:l.type,offset:d,stride:B,normalized:l.normalized||!1,divisor:0}),d+=m(l.type)*l.count;h.geometry=z}this.opacityInfo()&&(h.opacity=this.opacityInfo());this._layoutInfo=h;this._stride=B};c._buildShaderInfo=function(p,h){let t="\n",B="\n";const z=[];for(var d of p)t+=`attribute ${this._getType(d.count)} ${d.name};\n`;
var l=this.attributes();p=this.attributesInfo();d=-1;for(const F of l){++d;const {name:N,type:L,precisionFactor:C,isLayout:v}=p[F];l=C&&1!==C?` * ${1/C}`:"";const {bytesPerElement:A,count:M}=g._encodingInfo[L];var u=P=>`a_data_${P.dataIndex}${2===L?"":`[${P.offset/A}]`}`;switch(this.getAtributeState(d)){case 0:l=this._getType(M);var H=`u_${N}`;z.push({name:H,type:l,getValue:(P,O)=>v?P.getLayoutValue(F,O):P.getPaintValue(F,O)});t+=`uniform ${l} ${H};\n`;B+=`${l} ${N} = ${H};\n`;break;case 1:H=u(h[F][0]);
B+=`${this._getType(M)} ${N} = ${H}${l};\n`;break;case 2:{H=`u_t_${N}`;z.push({name:H,type:"float",getValue:(O,D,y)=>(v?O.getLayoutProperty(F):O.getPaintProperty(F)).interpolator.interpolationUniformValue(y,D)});t+=`uniform float ${H};\n`;const P=u(h[F][0]);u=u(h[F][1]);B+=`${this._getType(M)} ${N} = mix(${P}${l}, ${u}${l}, ${H});\n`}}}this._shaderHeader=t;this._shaderMain=B;this._uniforms=z};c._bit=function(p){return(this._key&1<<p)>>p};c._getType=function(p){switch(p){case 1:return"float";case 2:return"vec2";
case 4:return"vec4"}throw Error("Invalid count");};c._encodeColor=function(p){const h=255*p[3];return a.i8888to32(p[0]*h,p[1]*h,p[2]*h,h)};c._encodeByte=function(p,h){return(p&255)<<h};w._createClass(g,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return g}();k._encodingInfo=[{dataType:5121,bytesPerElement:1,count:1,normalized:!1},{dataType:5121,bytesPerElement:1,count:1,normalized:!1},{dataType:5121,bytesPerElement:1,count:4,normalized:!0}];const m=
g=>{switch(g){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1}};f.VTLMaterial=k;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/chunks/vec4f32":function(){define(["exports"],function(f){function w(){return new Float32Array(4)}function q(N){const L=new Float32Array(4);L[0]=N[0];L[1]=N[1];L[2]=N[2];L[3]=N[3];return L}function a(N,L,C,v){const A=new Float32Array(4);A[0]=N;A[1]=L;A[2]=C;A[3]=v;return A}function k(N,
L){return new Float32Array(N,L,4)}function m(){return w()}function g(){return a(1,1,1,1)}function c(){return a(1,0,0,0)}function p(){return a(0,1,0,0)}function h(){return a(0,0,1,0)}function t(){return a(0,0,0,1)}const B=w(),z=g(),d=c(),l=p(),u=h(),H=t();var F=Object.freeze({__proto__:null,create:w,clone:q,fromValues:a,createView:k,zeros:m,ones:g,unitX:c,unitY:p,unitZ:h,unitW:t,ZEROS:B,ONES:z,UNIT_X:d,UNIT_Y:l,UNIT_Z:u,UNIT_W:H});f.ONES=z;f.UNIT_W=H;f.UNIT_X=d;f.UNIT_Y=l;f.UNIT_Z=u;f.ZEROS=B;f.clone=
q;f.create=w;f.createView=k;f.fromValues=a;f.ones=g;f.unitW=t;f.unitX=c;f.unitY=p;f.unitZ=h;f.vec4f32=F;f.zeros=m})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(f){return function(){function w(a){this._array=[];0>=a&&console.error("strideInBytes must be positive!");this._stride=a}var q=w.prototype;q.reset=function(){this.array.length=0};q.toBuffer=function(){return(new Uint32Array(this._array)).buffer};w.i1616to32=function(a,
k){return 65535&a|k<<16};w.i8888to32=function(a,k,m,g){return a&255|(k&255)<<8|(m&255)<<16|g<<24};w.i8816to32=function(a,k,m){return a&255|(k&255)<<8|m<<16};f._createClass(w,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return w}()})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(f,w,q){q=function(a){function k(g){return a.call(this,g)||this}w._inheritsLoose(k,a);var m=k.prototype;m.geometryInfo=function(){return k.GEOMETRY_LAYOUT};m.opacityInfo=function(){return null};m.attributes=function(){return k.ATTRIBUTES};m.attributesInfo=function(){return k.ATTRIBUTES_INFO};return k}(q.VTLMaterial);q.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");
q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:0},"circle-color":{name:"color",type:2},"circle-opacity":{name:"opacity",type:0,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:0,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:2},"circle-stroke-opacity":{name:"stroke_opacity",type:0,precisionFactor:100},"circle-blur":{name:"blur",type:0,precisionFactor:32}};
f.VTLCircleMaterial=q;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(f,w,q){let a=function(k){function m(c){return k.call(this,c)||this}w._inheritsLoose(m,k);var g=m.prototype;g.geometryInfo=function(){return m.GEOMETRY_LAYOUT};g.opacityInfo=function(){return null};g.attributes=function(){return m.ATTRIBUTES};g.attributesInfo=function(){return m.ATTRIBUTES_INFO};
return m}(q.VTLMaterial);a.ATTRIBUTES=["fill-color","fill-opacity"];a.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];a.ATTRIBUTES_INFO={"fill-color":{name:"color",type:2},"fill-opacity":{name:"opacity",type:0,precisionFactor:100}};q=function(k){function m(c,p){c=k.call(this,c)||this;c.usefillColor=p;return c}w._inheritsLoose(m,k);var g=m.prototype;g.geometryInfo=function(){return m.GEOMETRY_LAYOUT};g.opacityInfo=function(){return null};g.attributes=function(){return this.usefillColor?
m.ATTRIBUTES_FILL:m.ATTRIBUTES_OUTLINE};g.attributesInfo=function(){return this.usefillColor?m.ATTRIBUTES_INFO_FILL:m.ATTRIBUTES_INFO_OUTLINE};return m}(q.VTLMaterial);q.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];q.ATTRIBUTES_FILL=["fill-color","fill-opacity"];q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,
normalized:!1,divisor:0}];q.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:2},"fill-opacity":{name:"opacity",type:0,precisionFactor:100}};q.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:2},"fill-opacity":{name:"opacity",type:0,precisionFactor:100}};f.VTLFillMaterial=a;f.VTLOutlineMaterial=q;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"./VTLMaterial"],function(f,w,q){q=function(a){function k(g){return a.call(this,g)||this}w._inheritsLoose(k,a);var m=k.prototype;m.geometryInfo=function(){return k.GEOMETRY_LAYOUT};m.opacityInfo=function(){return null};m.attributes=function(){return k.ATTRIBUTES};m.attributesInfo=function(){return k.ATTRIBUTES_INFO};return k}(q.VTLMaterial);q.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width".split(" ");q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,
stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO={"line-width":{name:"width",type:0,precisionFactor:2},"line-gap-width":{name:"gap_width",type:0,precisionFactor:2},"line-offset":{name:"offset",type:1,precisionFactor:2},"line-color":{name:"color",type:2},"line-opacity":{name:"opacity",type:0,precisionFactor:100},"line-blur":{name:"blur",
type:0,precisionFactor:4}};f.VTLLineMaterial=q;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(f,w,q){const a=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,
normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],k=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}];let m=function(g){function c(h){return g.call(this,h)||this}w._inheritsLoose(c,g);var p=c.prototype;p.geometryInfo=function(){return a};p.opacityInfo=function(){return k};p.attributes=function(){return c.ATTRIBUTES};p.attributesInfo=function(){return c.ATTRIBUTES_INFO};return c}(q.VTLMaterial);m.ATTRIBUTES=
"icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");m.ATTRIBUTES_INFO={"icon-color":{name:"color",type:2},"icon-opacity":{name:"opacity",type:0,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:2},"icon-halo-width":{name:"halo_width",type:0,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:0,precisionFactor:4},"icon-size":{name:"size",type:0,precisionFactor:32,isLayout:!0}};q=function(g){function c(h){return g.call(this,h)||this}w._inheritsLoose(c,
g);var p=c.prototype;p.geometryInfo=function(){return a};p.opacityInfo=function(){return k};p.attributes=function(){return c.ATTRIBUTES};p.attributesInfo=function(){return c.ATTRIBUTES_INFO};return c}(q.VTLMaterial);q.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");q.ATTRIBUTES_INFO={"text-color":{name:"color",type:2},"text-opacity":{name:"opacity",type:0,precisionFactor:100},"text-halo-color":{name:"halo_color",type:2},"text-halo-width":{name:"halo_width",
type:0,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:0,precisionFactor:4},"text-size":{name:"size",type:0,isLayout:!0}};f.VTLIconMaterial=m;f.VTLTextMaterial=q;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/types","../expression/expression"],function(f,w){return function(){function q(a){this._expression=a}q.prototype.filter=function(a,k){if(!this._expression)return!0;try{return this._expression.evaluate(a,
k)}catch(m){return console.log(m.message),!0}};q.createFilter=function(a){if(!a)return null;this.isLegacyFilter(a)&&(a=this.convertLegacyFilter(a));try{const k=w.createExpression(a,null,f.BooleanType);return new q(k)}catch(k){return console.log(k.message),null}};q.isLegacyFilter=function(a){if(!Array.isArray(a)||0===a.length)return!0;switch(a[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===a.length&&"string"===typeof a[1]&&!Array.isArray(a[2]);case "in":return 3<=
a.length&&"string"===typeof a[1]&&!Array.isArray(a[2]);case "!in":return!0;case "any":case "all":for(let k=1;k<a.length;k++)if(!this.isLegacyFilter(a[1]))return!1;return!0;case "none":return!0;case "has":return 2===a.length&&("$id"===a[1]||"$type"===a[1]);case "!has":return!0;default:return!1}};q.convertLegacyFilter=function(a){if(!Array.isArray(a)||0===a.length)return!0;const k=a[0];if(1===a.length)return"any"!==k;switch(k){case "\x3d\x3d":return q.convertComparison("\x3d\x3d",a[1],a[2]);case "!\x3d":return q.negate(q.convertComparison("\x3d\x3d",
a[1],a[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return q.convertComparison(k,a[1],a[2]);case "in":return q.convertIn(a[1],a.slice(2));case "!in":return q.negate(q.convertIn(a[1],a.slice(2)));case "any":case "all":case "none":return q.convertCombining(k,a.slice(1));case "has":return q.convertHas(a[1]);case "!has":return q.negate(q.convertHas(a[1]));default:throw Error("Unexpected legacy filter.");}};q.convertComparison=function(a,k,m){switch(k){case "$type":return[a,["geometry-type"],
m];case "$id":return[a,["id"],m];default:return[a,["get",k],m]}};q.convertIn=function(a,k){switch(a){case "$type":return["in",["geometry-type"],["literal",k]];case "$id":return["in",["id"],["literal",k]];default:return["in",["get",a],["literal",k]]}};q.convertHas=function(a){switch(a){case "$type":return!0;case "$id":return["has-id"];default:return["has",a]}};q.convertCombining=function(a,k){return[a].concat(k.map(this.convertLegacyFilter))};q.negate=function(a){return["!",a]};return q}()})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports",
"../../../../../Color"],function(f,w){function q(l,u){return{kind:"array",itemType:l,n:u}}function a(l){if("array"===l.kind){const u=a(l.itemType);return"number"===typeof l.n?`array<${u}, ${l.n}>`:"value"===l.itemType.kind?"array":`array<${u}>`}return l.kind}function k(l){if(null===l)return g;if("string"===typeof l)return p;if("boolean"===typeof l)return h;if("number"===typeof l)return c;if(l instanceof w)return t;if(Array.isArray(l)){let u;for(const H of l){const F=k(H);if(!u)u=F;else if(u!==F){u=
z;break}}return q(u||z,l.length)}return"object"===typeof l?B:z}function m(l,u){if("array"===u.kind)return"array"===l.kind&&(0===l.n&&"value"===l.itemType.kind||m(l.itemType,u.itemType))&&("number"!==typeof u.n||u.n===l.n);if("value"===u.kind)for(const H of d)if(m(l,H))return!0;return u.kind===l.kind}const g={kind:"null"},c={kind:"number"},p={kind:"string"},h={kind:"boolean"},t={kind:"color"},B={kind:"object"},z={kind:"value"},d=[g,c,p,h,t,B,q(z)];f.BooleanType=h;f.ColorType=t;f.NullType=g;f.NumberType=
c;f.ObjectType=B;f.StringType=p;f.ValueType=z;f.arrayType=q;f.getType=k;f.matchType=m;f.typeToString=a;f.valueToString=function(l){if(null===l)return"";const u=typeof l;return"string"===u?l:"number"===u||"boolean"===u?String(l):l instanceof w?l.toString():JSON.stringify(l)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types".split(" "),
function(f,w,q,a,k,m,g){function c(n,b,e){var r=typeof n;if("string"===r||"boolean"===r||"number"===r||null===n){if(e)switch(e.kind){case "string":"string"!==r&&(n=ia.toString(n));break;case "number":"number"!==r&&(n=ia.toNumber(n));break;case "color":n=ia.toColor(n)}n=["literal",n]}if(!Array.isArray(n)||0===n.length)throw Error("Expression must be a non empty array");r=n[0];if("string"!==typeof r)throw Error("First element of expression must be a string");const x=pa[r];if(void 0===x)throw Error(`Invalid expression operator "${r}"`);
if(!x)throw Error(`Unimplemented expression operator "${r}"`);return x.parse(n,b,e)}let p=function(){function n(e){this.parent=e;this.vars={}}var b=n.prototype;b.add=function(e,r){this.vars[e]=r};b.get=function(e){return this.vars[e]?this.vars[e]:this.parent?this.parent.get(e):null};return n}(),h=function(){function n(){this.type=g.ValueType}n.parse=function(b){if(1<b.length)throw Error('"id" does not expect arguments');return new n};n.prototype.evaluate=function(b,e){return b.id||null};return n}(),
t=function(){function n(){this.type=g.StringType}n.parse=function(b){if(1<b.length)throw Error('"geometry-type" does not expect arguments');return new n};n.prototype.evaluate=function(b,e){switch(b.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}};return n}(),B=function(){function n(){this.type=g.ObjectType}n.parse=function(b){if(1<b.length)throw Error('"properties" does not expect arguments');return new n};n.prototype.evaluate=function(b,e){return b.values};
return n}(),z=function(){function n(){this.type=g.NumberType}n.parse=function(b){if(1<b.length)throw Error('"zoom" does not expect arguments');return new n};n.prototype.evaluate=function(b,e){return e};return n}(),d=function(){function n(b,e,r){this.lhs=b;this.rhs=e;this.compare=r;this.type=g.BooleanType}n.parse=function(b,e,r){if(3!==b.length&&4!==b.length)throw Error(`"${b[0]}" expects 2 or 3 arguments`);if(4===b.length)throw Error(`"${b[0]}" collator not supported`);return new n(c(b[1],e),c(b[2],
e),r)};n.prototype.evaluate=function(b,e){return this.compare(this.lhs.evaluate(b,e),this.rhs.evaluate(b,e))};return n}(),l=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return d.parse(e,r,(x,G)=>x===G)};return b}(d),u=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return d.parse(e,r,(x,G)=>x!==G)};return b}(d),H=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,
n);b.parse=function(e,r){return d.parse(e,r,(x,G)=>x<G)};return b}(d),F=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return d.parse(e,r,(x,G)=>x<=G)};return b}(d),N=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return d.parse(e,r,(x,G)=>x>G)};return b}(d),L=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return d.parse(e,
r,(x,G)=>x>=G)};return b}(d),C=function(){function n(b){this.arg=b;this.type=g.BooleanType}n.parse=function(b,e){if(2!==b.length)throw Error('"!" expects 1 argument');return new n(c(b[1],e))};n.prototype.evaluate=function(b,e){return!this.arg.evaluate(b,e)};return n}(),v=function(){function n(b){this.args=b;this.type=g.BooleanType}n.parse=function(b,e){const r=[];for(let x=1;x<b.length;x++)r.push(c(b[x],e));return new n(r)};n.prototype.evaluate=function(b,e){for(const r of this.args)if(!r.evaluate(b,
e))return!1;return!0};return n}(),A=function(){function n(b){this.args=b;this.type=g.BooleanType}n.parse=function(b,e){const r=[];for(let x=1;x<b.length;x++)r.push(c(b[x],e));return new n(r)};n.prototype.evaluate=function(b,e){for(const r of this.args)if(r.evaluate(b,e))return!0;return!1};return n}(),M=function(){function n(b){this.args=b;this.type=g.BooleanType}n.parse=function(b,e){const r=[];for(let x=1;x<b.length;x++)r.push(c(b[x],e));return new n(r)};n.prototype.evaluate=function(b,e){for(const r of this.args)if(r.evaluate(b,
e))return!1;return!0};return n}(),P=function(){function n(b,e,r){this.type=b;this.args=e;this.fallback=r}n.parse=function(b,e,r){if(4>b.length)throw Error('"case" expects at least 3 arguments');if(1===b.length%2)throw Error('"case" expects an odd number of arguments');let x;const G=[];for(let Q=1;Q<b.length-1;Q+=2){const U=c(b[Q],e),T=c(b[Q+1],e,r);x||(x=T.type);G.push({condition:U,output:T})}b=c(b[b.length-1],e,r);x||(x=b.type);return new n(x,G,b)};n.prototype.evaluate=function(b,e){for(const r of this.args)if(r.condition.evaluate(b,
e))return r.output.evaluate(b,e);return this.fallback.evaluate(b,e)};return n}(),O=function(){function n(b,e){this.type=b;this.args=e}n.parse=function(b,e){if(2>b.length)throw Error('"coalesce" expects at least 1 argument');let r;const x=[];for(let G=1;G<b.length;G++){const Q=c(b[G],e);r||(r=Q.type);x.push(Q)}return new n(r,x)};n.prototype.evaluate=function(b,e){for(const r of this.args){const x=r.evaluate(b,e);if(null!==x)return x}return null};return n}(),D=function(){function n(b,e,r,x,G){this.type=
b;this.input=e;this.labels=r;this.outputs=x;this.fallback=G}n.parse=function(b,e){if(3>b.length)throw Error('"match" expects at least 3 arguments');if(0===b.length%2)throw Error('"case" expects an even number of arguments');let r;const x=c(b[1],e),G=[],Q={};let U;for(let ba=2;ba<b.length-1;ba+=2){var T=b[ba];Array.isArray(T)||(T=[T]);for(const ja of T){T=typeof ja;if("string"!==T&&"number"!==T)throw Error('"match" requires string or number literal as labels');if(!U)U=T;else if(T!==U)throw Error('"match" requires labels to have the same type');
Q[ja]=G.length}T=c(b[ba+1],e);r||(r=T.type);G.push(T)}return new n(r,x,Q,G,c(b[b.length-1],e))};n.prototype.evaluate=function(b,e){const r=this.input.evaluate(b,e);return(this.outputs[this.labels[r]]||this.fallback).evaluate(b,e)};return n}(),y=function(){function n(e,r,x,G,Q){this.operator=e;this.type=r;this.interpolation=x;this.input=G;this.stops=Q}n.parse=function(e,r,x){const G=e[0];if(5>e.length)throw Error(`"${G}" expects at least 4 arguments`);const Q=e[1];if(!Array.isArray(Q)||0===Q.length)throw Error(`"${Q}" is not a valid interpolation`);
switch(Q[0]){case "linear":if(1!==Q.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==Q.length||"number"!==typeof Q[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==Q.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var U=1;5>U;U++){var T=Q[U];if("number"!==typeof T||0>T||1<T)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${e[0]}" unknown interpolation type "${Q[0]}"`);}if(1!==e.length%2)throw Error(`"${G}" expects an even number of arguments`);U=c(e[2],r,g.NumberType);let ba;"interpolate-hcl"===G||"interpolate-lab"===G?ba=g.ColorType:x&&"value"!==x.kind&&(ba=x);x=[];for(T=3;T<e.length;T+=2){const ja=e[T];if("number"!==typeof ja)throw Error(`"${G}" requires stop inputs as literal numbers`);if(x.length&&x[x.length-1][0]>=ja)throw Error(`"${G}" requires strictly ascending stop inputs`);const qa=
c(e[T+1],r,ba);ba||(ba=qa.type);x.push([ja,qa])}if(ba&&ba!==g.ColorType&&ba!==g.NumberType&&("array"!==ba.kind||ba.itemType!==g.NumberType))throw Error(`"${G}" cannot interpolate type ${g.typeToString(ba)}`);return new n(G,ba,Q,U,x)};var b=n.prototype;b.evaluate=function(e,r){var x=this.stops;if(1===x.length)return x[0][1].evaluate(e,r);var G=this.input.evaluate(e,r);if(G<=x[0][0])return x[0][1].evaluate(e,r);if(G>=x[x.length-1][0])return x[x.length-1][1].evaluate(e,r);let Q=0;for(;++Q<x.length&&
!(G<x[Q][0]););const U=n.interpolationRatio(this.interpolation,G,x[Q-1][0],x[Q][0]);G=x[Q-1][1].evaluate(e,r);const T=x[Q][1].evaluate(e,r);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(G)&&Array.isArray(T))return G.map((ba,ja)=>m.interpolate(ba,T[ja],U));if("color"===this.type.kind&&G instanceof q&&T instanceof q)return G=new q(G),e=new q(T),new q([m.interpolate(G.r,e.r,U),m.interpolate(G.g,e.g,U),m.interpolate(G.b,e.b,U),m.interpolate(G.a,e.a,U)]);if("number"===this.type.kind&&
"number"===typeof G&&"number"===typeof T)return m.interpolate(G,T,U);throw Error(`"${this.operator}" cannot interpolate type ${g.typeToString(this.type)}`);}if("interpolate-hcl"===this.operator)return e=a.toLCH(G),r=a.toLCH(T),x=r.h-e.h,e=a.toRGB({h:e.h+U*(180<x||-180>x?x-360*Math.round(x/360):x),c:m.interpolate(e.c,r.c,U),l:m.interpolate(e.l,r.l,U)}),new q({a:m.interpolate(G.a,T.a,U),...e});if("interpolate-lab"===this.operator)return e=a.toLAB(G),r=a.toLAB(T),e=a.toRGB({l:m.interpolate(e.l,r.l,U),
a:m.interpolate(e.a,r.a,U),b:m.interpolate(e.b,r.b,U)}),new q({a:m.interpolate(G.a,T.a,U),...e});throw Error(`Unexpected operator "${this.operator}"`);};b.interpolationUniformValue=function(e,r){const x=this.stops;if(1===x.length||e>=x[x.length-1][0])return 0;let G=0;for(;++G<x.length&&!(e<x[G][0]););return n.interpolationRatio(this.interpolation,r,x[G-1][0],x[G][0])};b.getInterpolationRange=function(e){const r=this.stops;if(1===r.length)return e=r[0][0],[e,e];var x=r[r.length-1][0];if(e>=x)return[x,
x];for(x=0;++x<r.length&&!(e<r[x][0]););return[r[x-1][0],r[x][0]]};n.interpolationRatio=function(e,r,x,G){let Q=0;"linear"===e[0]?Q=n.exponentialInterpolationRatio(r,1,x,G):"exponential"===e[0]?Q=n.exponentialInterpolationRatio(r,e[1],x,G):"cubic-bezier"===e[0]&&(Q=k.unitBezier(e[1],e[2],e[3],e[4])(n.exponentialInterpolationRatio(r,1,x,G),1E-5));0>Q?Q=0:1<Q&&(Q=1);return Q};n.exponentialInterpolationRatio=function(e,r,x,G){G-=x;if(0===G)return 0;e-=x;return 1===r?e/G:(r**e-1)/(r**G-1)};return n}(),
I=function(){function n(b,e,r){this.type=b;this.input=e;this.stops=r}n.parse=function(b,e){if(5>b.length)throw Error('"step" expects at least 4 arguments');if(1!==b.length%2)throw Error('"step" expects an even number of arguments');const r=c(b[1],e,g.NumberType);let x;const G=[];G.push([-Infinity,c(b[2],e)]);for(let Q=3;Q<b.length;Q+=2){const U=b[Q];if("number"!==typeof U)throw Error('"step" requires stop inputs as literal numbers');if(G.length&&G[G.length-1][0]>=U)throw Error('"step" requires strictly ascending stop inputs');
const T=c(b[Q+1],e);x||(x=T.type);G.push([U,T])}return new n(x,r,G)};n.prototype.evaluate=function(b,e){const r=this.stops;if(1===r.length)return r[0][1].evaluate(b,e);const x=this.input.evaluate(b,e);let G=0;for(;++G<r.length&&!(x<r[G][0]););return this.stops[G-1][1].evaluate(b,e)};return n}(),K=function(){function n(b,e){this.type=b;this.output=e}n.parse=function(b,e,r){if(4>b.length)throw Error('"let" expects at least 3 arguments');if(1===b.length%2)throw Error('"let" expects an odd number of arguments');
const x=new p(e);for(let G=1;G<b.length-1;G+=2){const Q=b[G];if("string"!==typeof Q)throw Error(`"let" requires a string to define variable names - found ${Q}`);x.add(Q,c(b[G+1],e))}b=c(b[b.length-1],x,r);return new n(b.type,b)};n.prototype.evaluate=function(b,e){return this.output.evaluate(b,e)};return n}(),J=function(){function n(b,e){this.type=b;this.output=e}n.parse=function(b,e,r){if(2!==b.length||"string"!==typeof b[1])throw Error('"var" requires just one literal string argument');e=e.get(b[1]);
if(!e)throw Error(`${b[1]} must be defined before being used in a "var" expression`);return new n(r||g.ValueType,e)};n.prototype.evaluate=function(b,e){return this.output.evaluate(b,e)};return n}(),S=function(){function n(b,e,r){this.type=b;this.index=e;this.array=r}n.parse=function(b,e){if(3!==b.length)throw Error('"at" expects 2 arguments');const r=c(b[1],e,g.NumberType);b=c(b[2],e);return new n(b.type.itemType,r,b)};n.prototype.evaluate=function(b,e){const r=this.index.evaluate(b,e);b=this.array.evaluate(b,
e);if(0>r||r>=b.length)throw Error('"at" index out of bounds');if(r!==Math.floor(r))throw Error('"at" index must be an integer');return b[r]};return n}(),aa=function(){function n(b,e){this.key=b;this.obj=e;this.type=g.ValueType}n.parse=function(b,e){let r;switch(b.length){case 2:return r=c(b[1],e),new n(r);case 3:return r=c(b[1],e),b=c(b[2],e),new n(r,b);default:throw Error('"get" expects 1 or 2 arguments');}};n.prototype.evaluate=function(b,e){const r=this.key.evaluate(b,e);return this.obj?this.obj.evaluate(b,
e)[r]:b.values[r]};return n}(),Y=function(){function n(b,e){this.key=b;this.obj=e;this.type=g.BooleanType}n.parse=function(b,e){let r;switch(b.length){case 2:return r=c(b[1],e),new n(r);case 3:return r=c(b[1],e),b=c(b[2],e),new n(r,b);default:throw Error('"has" expects 1 or 2 arguments');}};n.prototype.evaluate=function(b,e){const r=this.key.evaluate(b,e);return this.obj?(b=this.obj.evaluate(b,e),r in b):void 0!==b.values[r]};return n}(),V=function(){function n(b,e){this.key=b;this.vals=e;this.type=
g.BooleanType}n.parse=function(b,e){if(3!==b.length)throw Error('"in" expects 2 arguments');return new n(c(b[1],e),c(b[2],e))};n.prototype.evaluate=function(b,e){const r=this.key.evaluate(b,e);return-1!==this.vals.evaluate(b,e).indexOf(r)};return n}(),ca=function(){function n(b,e,r){this.item=b;this.array=e;this.from=r;this.type=g.NumberType}n.parse=function(b,e){if(3>b.length||4<b.length)throw Error('"index-of" expects 3 or 4 arguments');const r=c(b[1],e),x=c(b[2],e);return 4===b.length?(b=c(b[3],
e,g.NumberType),new n(r,x,b)):new n(r,x)};n.prototype.evaluate=function(b,e){const r=this.item.evaluate(b,e),x=this.array.evaluate(b,e);if(this.from){b=this.from.evaluate(b,e);if(b!==Math.floor(b))throw Error('"index-of" index must be an integer');return x.indexOf(r,b)}return x.indexOf(r)};return n}(),ea=function(){function n(b){this.arg=b;this.type=g.NumberType}n.parse=function(b,e){if(2!==b.length)throw Error('"length" expects 2 arguments');b=c(b[1],e);return new n(b)};n.prototype.evaluate=function(b,
e){b=this.arg.evaluate(b,e);if("string"===typeof b||Array.isArray(b))return b.length;throw Error('"length" expects string or array');};return n}(),ka=function(){function n(b,e,r,x){this.type=b;this.array=e;this.from=r;this.to=x}n.parse=function(b,e){if(3>b.length||4<b.length)throw Error('"slice" expects 2 or 3 arguments');const r=c(b[1],e),x=c(b[2],e,g.NumberType);if(x.type!==g.NumberType)throw Error('"slice" index must return a number');if(4===b.length){b=c(b[3],e,g.NumberType);if(b.type!==g.NumberType)throw Error('"slice" index must return a number');
return new n(r.type,r,x,b)}return new n(r.type,r,x)};n.prototype.evaluate=function(b,e){const r=this.array.evaluate(b,e);if(!Array.isArray(r)&&"string"!==typeof r)throw Error('"slice" input must be an array or a string');const x=this.from.evaluate(b,e);if(0>x||x>=r.length)throw Error('"slice" index out of bounds');if(x!==Math.floor(x))throw Error('"slice" index must be an integer');if(this.to){b=this.to.evaluate(b,e);if(0>b||b>=r.length)throw Error('"slice" index out of bounds');if(b!==Math.floor(b))throw Error('"slice" index must be an integer');
return r.slice(x,b)}return r.slice(x)};return n}(),ha=function(){function n(){this.type=g.BooleanType}n.parse=function(b){if(1!==b.length)throw Error('"has-id" expects no arguments');return new n};n.prototype.evaluate=function(b,e){return void 0!==b.id};return n}(),da=function(){function n(b,e){this.args=b;this.calculate=e;this.type=g.NumberType}n.parse=function(b,e,r){b=b.slice(1).map(x=>c(x,e));return new n(b,r)};n.prototype.evaluate=function(b,e){let r;this.args&&(r=this.args.map(x=>x.evaluate(b,
e)));return this.calculate(r)};return n}(),W=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){switch(e.length){case 2:return da.parse(e,r,x=>-x[0]);case 3:return da.parse(e,r,x=>x[0]-x[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return b}(da),E=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return da.parse(e,r,x=>{let G=1;for(const Q of x)G*=Q;return G})};return b}(da),
R=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){if(3===e.length)return da.parse(e,r,x=>x[0]/x[1]);throw Error('"/" expects 2 arguments');};return b}(da),X=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){if(3===e.length)return da.parse(e,r,x=>x[0]%x[1]);throw Error('"%" expects 2 arguments');};return b}(da),fa=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,
n);b.parse=function(e,r){if(3===e.length)return da.parse(e,r,x=>x[0]**x[1]);throw Error('"^" expects 1 or 2 arguments');};return b}(da),ma=function(n){function b(){return n.apply(this,arguments)||this}w._inheritsLoose(b,n);b.parse=function(e,r){return da.parse(e,r,x=>{let G=0;for(const Q of x)G+=Q;return G})};return b}(da),Z=function(){function n(b,e){this.args=b;this.calculate=e;this.type=g.NumberType}n.parse=function(b,e){const r=b.slice(1).map(x=>c(x,e));return new n(r,n.ops[b[0]])};n.prototype.evaluate=
function(b,e){let r;this.args&&(r=this.args.map(x=>x.evaluate(b,e)));return this.calculate(r)};return n}();Z.ops={abs:n=>Math.abs(n[0]),acos:n=>Math.acos(n[0]),asin:n=>Math.asin(n[0]),atan:n=>Math.atan(n[0]),ceil:n=>Math.ceil(n[0]),cos:n=>Math.cos(n[0]),e:()=>Math.E,floor:n=>Math.floor(n[0]),ln:n=>Math.log(n[0]),ln2:()=>Math.LN2,log10:n=>Math.log(n[0])/Math.LN10,log2:n=>Math.log(n[0])/Math.LN2,max:n=>Math.max(...n),min:n=>Math.min(...n),pi:()=>Math.PI,round:n=>Math.round(n[0]),sin:n=>Math.sin(n[0]),
sqrt:n=>Math.sqrt(n[0]),tan:n=>Math.tan(n[0])};let na=function(){function n(b){this.args=b;this.type=g.StringType}n.parse=function(b,e){return new n(b.slice(1).map(r=>c(r,e)))};n.prototype.evaluate=function(b,e){return this.args.map(r=>r.evaluate(b,e)).join("")};return n}(),oa=function(){function n(b,e){this.arg=b;this.calculate=e;this.type=g.StringType}n.parse=function(b,e){if(2!==b.length)throw Error(`${b[0]} expects 1 argument`);e=c(b[1],e);return new n(e,n.ops[b[0]])};n.prototype.evaluate=function(b,
e){return this.calculate(this.arg.evaluate(b,e))};return n}();oa.ops={downcase:n=>n.toLowerCase(),upcase:n=>n.toUpperCase()};let ra=function(){function n(e){this.args=e;this.type=g.ColorType}n.parse=function(e,r){if(4!==e.length)throw Error('"rgb" expects 3 arguments');e=e.slice(1).map(x=>c(x,r));return new n(e)};var b=n.prototype;b.evaluate=function(e,r){const x=this._validate(this.args[0].evaluate(e,r)),G=this._validate(this.args[1].evaluate(e,r));e=this._validate(this.args[2].evaluate(e,r));return new q({r:x,
g:G,b:e})};b._validate=function(e){if("number"!==typeof e||0>e||255<e)throw Error(`${e}: invalid color component`);return Math.round(e)};return n}(),sa=function(){function n(e){this.args=e;this.type=g.ColorType}n.parse=function(e,r){if(5!==e.length)throw Error('"rgba" expects 4 arguments');e=e.slice(1).map(x=>c(x,r));return new n(e)};var b=n.prototype;b.evaluate=function(e,r){const x=this._validate(this.args[0].evaluate(e,r)),G=this._validate(this.args[1].evaluate(e,r)),Q=this._validate(this.args[2].evaluate(e,
r));e=this._validateAlpha(this.args[3].evaluate(e,r));return new q({r:x,g:G,b:Q,a:e})};b._validate=function(e){if("number"!==typeof e||0>e||255<e)throw Error(`${e}: invalid color component`);return Math.round(e)};b._validateAlpha=function(e){if("number"!==typeof e||0>e||1<e)throw Error(`${e}: invalid alpha color component`);return e};return n}(),ta=function(){function n(b){this.color=b;this.type=g.arrayType(g.NumberType,4)}n.parse=function(b,e){if(2!==b.length)throw Error('"to-rgba" expects 1 argument');
b=c(b[1],e);return new n(b)};n.prototype.evaluate=function(b,e){return(new q(this.color.evaluate(b,e))).toRgba()};return n}(),la=function(){function n(b,e){this.type=b;this.args=e}n.parse=function(b,e){var r=b[0];if(2>b.length)throw Error(`${r} expects at least one argument`);let x=1,G;if("array"===r){if(2<b.length){switch(b[1]){case "string":G=g.StringType;break;case "number":G=g.NumberType;break;case "boolean":G=g.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');
}x++}else G=g.ValueType;if(3<b.length){var Q=b[2];if(null!==Q&&("number"!==typeof Q||0>Q||Q!==Math.floor(Q)))throw Error('"array" length argument must be a positive integer literal');x++}G=g.arrayType(G,Q)}else switch(r){case "string":G=g.StringType;break;case "number":G=g.NumberType;break;case "boolean":G=g.BooleanType;break;case "object":G=g.ObjectType}for(r=[];x<b.length;x++)Q=c(b[x],e),r.push(Q);return new n(G,r)};n.prototype.evaluate=function(b,e){let r;for(const x of this.args){const G=x.evaluate(b,
e);r=g.getType(G);if(g.matchType(r,this.type))return G}throw Error(`Expected ${g.typeToString(this.type)} but got ${g.typeToString(r)}`);};return n}(),ia=function(){function n(b,e){this.type=b;this.args=e}n.parse=function(b,e){var r=b[0];const x=n.types[r];if(x===g.BooleanType||x===g.StringType){if(2!==b.length)throw Error(`${r} expects one argument`);}else if(2>b.length)throw Error(`${r} expects at least one argument`);r=[];for(let G=1;G<b.length;G++){const Q=c(b[G],e);r.push(Q)}return new n(x,r)};
n.prototype.evaluate=function(b,e){if(this.type===g.BooleanType)return!!this.args[0].evaluate(b,e);if(this.type===g.StringType)return g.valueToString(this.args[0].evaluate(b,e));if(this.type===g.NumberType){for(const x of this.args){var r=Number(x.evaluate(b,e));if(!isNaN(r))return r}return null}if(this.type===g.ColorType){for(r of this.args)try{const x=n.toColor(r.evaluate(b,e));if(x instanceof q)return x}catch{}return null}};n.toBoolean=function(b){return!!b};n.toString=function(b){return g.valueToString(b)};
n.toNumber=function(b){const e=Number(b);if(isNaN(e))throw Error(`"${b}" is not a number`);return e};n.toColor=function(b){if(b instanceof q)return b;if("string"===typeof b){const e=q.fromString(b);if(e)return e;throw Error(`"${b}" is not a color`);}if(Array.isArray(b))return q.fromArray(b);throw Error(`"${b}" is not a color`);};return n}();ia.types={"to-boolean":g.BooleanType,"to-color":g.ColorType,"to-number":g.NumberType,"to-string":g.StringType};let ua=function(){function n(b){this.val=b;this.type=
g.getType(b)}n.parse=function(b){if(2!==b.length)throw Error('"literal" expects 1 argument');return new n(b[1])};n.prototype.evaluate=function(b,e){return this.val};return n}(),va=function(){function n(b){this.arg=b;this.type=g.StringType}n.parse=function(b,e){if(2!==b.length)throw Error('"typeof" expects 1 argument');return new n(c(b[1],e))};n.prototype.evaluate=function(b,e){return g.typeToString(g.getType(this.arg.evaluate(b,e)))};return n}();const pa={array:la,"boolean":la,collator:null,format:null,
image:null,literal:ua,number:la,"number-format":null,object:la,string:la,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,"typeof":va,accumulated:null,"feature-state":null,"geometry-type":t,id:h,"line-progress":null,properties:B,at:S,get:aa,has:Y,"in":V,"index-of":ca,length:ea,slice:ka,"!":C,"!\x3d":u,"\x3c":H,"\x3c\x3d":F,"\x3d\x3d":l,"\x3e":N,"\x3e\x3d":L,all:v,any:A,"case":P,coalesce:O,match:D,within:null,interpolate:y,"interpolate-hcl":y,"interpolate-lab":y,step:I,let:K,"var":J,concat:na,
downcase:oa,"is-supported-script":null,"resolved-locale":null,upcase:oa,rgb:ra,rgba:sa,"to-rgba":ta,"-":W,"*":E,"/":R,"%":X,"^":fa,"+":ma,abs:Z,acos:Z,asin:Z,atan:Z,ceil:Z,cos:Z,e:Z,floor:Z,ln:Z,ln2:Z,log10:Z,log2:Z,max:Z,min:Z,pi:Z,round:Z,sin:Z,sqrt:Z,tan:Z,zoom:z,"heatmap-density":null,"has-id":ha,none:M};f.ALL=v;f.ANY=A;f.Add=ma;f.Assert=la;f.At=S;f.Calculate=Z;f.Case=P;f.Coalesce=O;f.Coerce=ia;f.Concat=na;f.Div=R;f.EQ=l;f.GE=L;f.GT=N;f.GeomType=t;f.Get=aa;f.Has=Y;f.HasID=ha;f.ID=h;f.In=V;f.IndexOf=
ca;f.Interpolate=y;f.LE=F;f.LT=H;f.Length=ea;f.Let=K;f.Literal=ua;f.Match=D;f.Mod=X;f.Mul=E;f.NE=u;f.NONE=M;f.NOT=C;f.Pow=fa;f.Properties=B;f.Rgb=ra;f.Rgba=sa;f.Slice=ka;f.Step=I;f.String=oa;f.Sub=W;f.ToRgba=ta;f.TypeOf=va;f.Var=J;f.Zoom=z;f.createExpression=c;f.ops=pa;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(f){function w(h,t){const B=[];let z,d;if(h[0].length!==t.length)throw"dimensions do not match";const l=h.length,u=h[0].length;
let H=0;for(z=0;z<l;z++){for(d=H=0;d<u;d++)H+=h[z][d]*t[d];B.push(H)}return B}function q(h){h=[h.r/255,h.g/255,h.b/255].map(t=>.04045>=t?t/12.92:((t+.055)/1.055)**2.4);h=w(c,h);return{x:100*h[0],y:100*h[1],z:100*h[2]}}function a(h){h=w(p,[h.x/100,h.y/100,h.z/100]).map(t=>Math.min(1,Math.max(.0031308>=t?12.92*t:1.055*t**(1/2.4)-.055,0)));return{r:Math.round(255*h[0]),g:Math.round(255*h[1]),b:Math.round(255*h[2])}}function k(h){h=[h.x/95.047,h.y/100,h.z/108.883].map(t=>t>(6/29)**3?t**(1/3):1/3*(29/
6)**2*t+4/29);return{l:116*h[1]-16,a:500*(h[0]-h[1]),b:200*(h[1]-h[2])}}function m(h){const t=h.l;h=[(t+16)/116+h.a/500,(t+16)/116,(t+16)/116-h.b/200].map(B=>B>6/29?B**3:3*(6/29)**2*(B-4/29));return{x:95.047*h[0],y:100*h[1],z:108.883*h[2]}}function g(h){if("r"in h&&"g"in h&&"b"in h)return h;if("l"in h&&"c"in h&&"h"in h){var t=h.c;var B=h.h;t={l:h.l,a:t*Math.cos(B),b:t*Math.sin(B)};return a(m(t))}if("l"in h&&"a"in h&&"b"in h)return a(m(h));if("x"in h&&"y"in h&&"z"in h)return a(h);if("h"in h&&"s"in
h&&"v"in h){{B=(h.h+360)%360/60;t=h.v/100*255;h=h.s/100*t;const z=h*(1-Math.abs(B%2-1));switch(Math.floor(B)){case 0:B={r:h,g:z,b:0};break;case 1:B={r:z,g:h,b:0};break;case 2:B={r:0,g:h,b:z};break;case 3:B={r:0,g:z,b:h};break;case 4:B={r:z,g:0,b:h};break;case 5:case 6:B={r:h,g:0,b:z};break;default:B={r:0,g:0,b:0}}B.r=Math.round(B.r+t-h);B.g=Math.round(B.g+t-h);B.b=Math.round(B.b+t-h);t=B}return t}return h}const c=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],p=[[3.2406,-1.5372,-.4986],
[-.9689,1.8758,.0415],[.0557,-.204,1.057]];f.darken=function(h,t){h=k(q(h));h.l*=1-t;return a(m(h))};f.toHSV=function(h){if("h"in h&&"s"in h&&"v"in h)return h;var t=g(h);{h=t.r;const B=t.g,z=t.b;t=Math.max(h,B,z);const d=t-Math.min(h,B,z);h=0===d?0:t===h?(B-z)/d%6:t===B?(z-h)/d+2:(h-B)/d+4;0>h&&(h+=6);h={h:60*h,s:100*(0===d?0:d/t),v:100/255*t}}return h};f.toLAB=function(h){return"l"in h&&"a"in h&&"b"in h?h:k(q(g(h)))};f.toLCH=function(h){if(!("l"in h&&"c"in h&&"h"in h)){{var t=k(q(g(h)));h=t.l;var B=
t.a;const z=t.b;t=Math.sqrt(B*B+z*z);B=Math.atan2(z,B);B=0<B?B:B+2*Math.PI;h={l:h,c:t,h:B}}}return h};f.toRGB=g;f.toXYZ=function(h){return"x"in h&&"y"in h&&"z"in h?h:q(g(h))};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/unitBezier":function(){define(["exports"],function(f){function w(k,m,g,c){function p(u,H){var F;let N,L;N=u;for(F=0;8>F;F++){L=((B*N+t)*N+h)*N-u;if(Math.abs(L)<H)return N;var C=(3*B*N+2*t)*N+h;if(1E-6>Math.abs(C))break;N-=L/C}C=0;F=1;N=u;if(N<C)return C;if(N>
F)return F;for(;C<F;){L=((B*N+t)*N+h)*N;if(Math.abs(L-u)<H)break;u>L?C=N:F=N;N=.5*(F-C)+C}return N}const h=3*k,t=3*(g-k)-h,B=1-h-t,z=3*m,d=3*(c-m)-z,l=1-z-d;return function(u,H=1E-6){u=p(u,H);return((l*u+d)*u+z)*u}}const q=/^cubic-bezier\((.*)\)/,a={};a.ease=w(.25,.1,.25,1);a.linear=w(0,0,1,1);a.easeIn=a["ease-in"]=w(.42,0,1,1);a.easeOut=a["ease-out"]=w(0,0,.58,1);a.easeInOut=a["ease-in-out"]=w(.42,0,.58,1);f.easingFunctions=a;f.parse=function(k){let m=a[k]||null;!m&&(k=q.exec(k))&&(k=k[1].split(",").map(g=>
parseFloat(g.trim())),4!==k.length||k.some(g=>isNaN(g))||(m=w.apply(w,k)));return m};f.unitBezier=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(f){function w(c,p){c%=p;return 0<=c?c:c+p}const q=Number.POSITIVE_INFINITY,a=Math.PI,k=128/a,m=256/360,g=1/Math.LN2;f.C_256_TO_RAD=a/128;f.C_2PI=2*a;f.C_DEG_TO_256=m;f.C_DEG_TO_RAD=a/180;f.C_INFINITY=q;f.C_PI=a;f.C_PI_BY_2=a/2;f.C_RAD_TO_256=k;f.C_SQRT2=1.414213562;
f.C_SQRT2_INV=1/1.414213562;f.between=function(c,p,h){return c>=p&&c<=h||c>=h&&c<=p};f.degToByte=function(c){return w(c*m,256)};f.interpolate=function(c,p,h){return c*(1-h)+p*h};f.log2=function(c){return Math.log(c)*g};f.positiveMod=w;f.radToByte=function(c){return w(c*k,256)};f.sqr=function(c){return c*c};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports"],function(f){let w=function(){};w.backgroundLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],default:0}};w.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};w.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};w.symbolLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},
"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),
default:0},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,
default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],
default:[0]}};w.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};w.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};w.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,
0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};w.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,
default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}};w.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,
maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",
values:["map","viewport"],default:0}};w.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};
w.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",
values:["map","viewport"],default:0}};f.StyleDefinition=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../GeometryUtils","../expression/types","../expression/expression"],function(f,w,q,a){return function(){function k(g,c){this.isDataDriven=!1;this.interpolator=null;switch(g.type){case "number":var p=!0;break;case "color":p=!0;break;case "array":p="number"===g.value;break;default:p=!1}null==c&&
(c=g.default);if(Array.isArray(c)&&0<c.length&&a.ops[c[0]]){p={number:q.NumberType,color:q.ColorType,string:q.StringType,boolean:q.BooleanType,enum:q.StringType};try{var h="array"===g.type?q.arrayType(p[g.value]||q.ValueType,g.length):p[g.type];const t=a.createExpression(c,null,h);this.getValue=this._buildExpression(t,g);this.isDataDriven=!0;t instanceof a.Interpolate&&t.input instanceof a.Zoom&&(this.interpolator=t)}catch(t){console.log(t.message),this.getValue=this._buildSimple(g.default)}}else{p&&
"interval"===c.type&&(p=!1);if(h=c&&c.stops&&0<c.stops.length)for(const t of c.stops)t[1]=this._validate(t[1],g);if(this.isDataDriven=c?!!c.property:!1)if(void 0!==c.default&&(c.default=this._validate(c.default,g)),h)switch(c.type){case "identity":this.getValue=this._buildIdentity(c,g);break;case "categorical":this.getValue=this._buildCategorical(c,g);break;default:this.getValue=p?this._buildInterpolate(c,g):this._buildInterval(c,g)}else this.getValue=this._buildIdentity(c,g);else h?this.getValue=
p?this._buildZoomInterpolate(c):this._buildZoomInterval(c):(c=this._validate(c,g),this.getValue=this._buildSimple(c))}}var m=k.prototype;m._validate=function(g,c){if("number"===c.type){if(g<c.minimum)return c.minimum;if(g>c.maximum)return c.maximum}else"color"===c.type?g=k._parseColor(g):"enum"===c.type?"string"===typeof g&&(g=c.values.indexOf(g)):"array"===c.type&&"enum"===c.value?g=g.map(p=>"string"===typeof g?c.values.indexOf(p):p):"string"===c.type&&(g=q.valueToString(g));return g};m._buildSimple=
function(g){return()=>g};m._buildExpression=function(g,c){return(p,h)=>{try{const t=g.evaluate(h,p);return void 0===t?c.default:this._validate(t,c)}catch(t){return console.log(t.message),c.default}}};m._buildIdentity=function(g,c){return(p,h)=>{let t;h&&(t=h.values[g.property]);return void 0!==t?this._validate(t,c):void 0!==g.default?g.default:c.default}};m._buildCategorical=function(g,c){return(p,h)=>{let t;h&&(t=h.values[g.property]);t=this._categorical(t,g.stops);return void 0!==t?t:void 0!==g.default?
g.default:c.default}};m._buildInterval=function(g,c){return(p,h)=>{let t;h&&(t=h.values[g.property]);return"number"===typeof t?this._interval(t,g.stops):void 0!==g.default?g.default:c.default}};m._buildInterpolate=function(g,c){return(p,h)=>{let t;h&&(t=h.values[g.property]);return"number"===typeof t?this._interpolate(t,g.stops,g.base||1):void 0!==g.default?g.default:c.default}};m._buildZoomInterpolate=function(g){return c=>this._interpolate(c,g.stops,g.base||1)};m._buildZoomInterval=function(g){return c=>
this._interval(c,g.stops)};m._categorical=function(g,c){const p=c.length;for(let h=0;h<p;h++)if(c[h][0]===g)return c[h][1]};m._interval=function(g,c){const p=c.length;let h=0;for(let t=0;t<p;t++)if(c[t][0]<=g)h=t;else break;return c[h][1]};m._interpolate=function(g,c,p){const h=c.length;for(let z=0;z<h;z++){const d=c[z];if(d[0]<=g)var t=d;else{var B=d;break}}if(t&&B){c=B[0]-t[0];g-=t[0];p=1===p?g/c:(p**g-1)/(p**c-1);if(Array.isArray(t[1])){t=t[1];B=B[1];g=[];for(c=0;c<t.length;c++)g.push(w.interpolate(t[c],
B[c],p));return g}return w.interpolate(t[1],B[1],p)}if(t)return t[1];if(B)return B[1]};k._isEmpty=function(g){for(const c in g)if(g.hasOwnProperty(c))return!1;return!0};k._parseColor=function(g){if(Array.isArray(g))return g;"string"===typeof g&&(g=new f(g));if(g instanceof f){if(!this._isEmpty(g))return f.toUnitRGBA(g)}else return g};return k}()})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(f){f.ANGLE_FACTOR_256=256/360;f.ATTRIBUTE_DATA_ANIMATION=1;f.ATTRIBUTE_DATA_DD0=
3;f.ATTRIBUTE_DATA_DD1=3;f.ATTRIBUTE_DATA_FILTER_FLAGS=0;f.ATTRIBUTE_DATA_VV=2;f.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;f.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};f.BUFFER_DATA_MINIMUM_SIZE=128;f.BUFFER_DATA_POOL_SIZE=4;f.COLLISION_BOX_PADDING=16;f.COLLISION_BUCKET_SIZE=128;f.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;f.COLLISION_MAX_ZOOM_DELTA=1;f.COLLISION_PLACEMENT_PADDING=8;f.COLLISION_TILE_BOX_SIZE=4;f.DEBUG_LABELS=!1;f.DISPLAY_RECORD_INT_PER_ELEMENT=7;f.DOT_DENSITY_MAX_FIELDS=
8;f.EFFECT_FLAG_0=4;f.ENABLE_EARLY_LABEL_DISCARD=!1;f.EXTRUDE_SCALE=64;f.FILTER_FLAG_0=2;f.GLYPH_SIZE=24;f.HEURISTIC_GLYPHS_PER_FEATURE=10;f.HEURISTIC_GLYPHS_PER_LINE=50;f.HIGHLIGHT_FLAG=1;f.HITTEST_SEARCH_SIZE=6;f.MAGIC_LABEL_LINE_HEIGHT=29;f.MAX_FILTERS=2;f.MAX_GPU_UPLOADS_PER_FRAME=2;f.NAN_MAGIC_NUMBER=1E-30;f.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;f.PICTURE_FILL_COLOR=4294967295;f.RASTER_TILE_SIZE=256;f.SPRITE_PADDING=2;f.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;f.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;f.TEXTURE_BINDING_ATTRIBUTE_DATA_2=
3;f.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;f.TEXTURE_BINDING_BITMAP=0;f.TEXTURE_BINDING_GLYPH_ATLAS=0;f.TEXTURE_BINDING_HIGHLIGHT_0=5;f.TEXTURE_BINDING_HIGHLIGHT_1=6;f.TEXTURE_BINDING_RENDERER_0=5;f.TEXTURE_BINDING_RENDERER_1=6;f.TEXTURE_BINDING_SPRITE_ATLAS=0;f.TEXT_PLACEMENT_PADDING=8;f.THIN_LINE_THRESHOLD=2.5;f.TILE_SIZE=512;f.VTL_HIGH_RES_CUTOFF=1.15;f.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;f.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;f.WEBGL_MAX_INNER_STOPS=6;f.WEBGL_MAX_STOPS=8;Object.defineProperty(f,"__esModule",
{value:!0})})},"esri/views/webgl/capabilities":function(){define(["./context-util"],function(f){function w(){const a={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};var k=document.createElement("canvas");if(!k)return a;var m=f.createContext(k,{failIfMajorPerformanceCaveat:!0},"webgl");
!m&&(m=f.createContext(k,{},"webgl"))&&(a.majorPerformanceCaveat=!0);if(!m)return a;k=m.getParameter(m.VERSION);if(!k)return a;if(k=k.match(/^WebGL\s+([\d.]*)/)){k=parseFloat(k[1]);a.available=.94<=k;if(k=m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.HIGH_FLOAT))a.supportsHighPrecisionFragment=0<k.precision;a.supportsVertexShaderSamplers=0<m.getParameter(m.MAX_VERTEX_TEXTURE_IMAGE_UNITS);a.supportsElementIndexUint=null!==m.getExtension("OES_element_index_uint");a.supportsStandardDerivatives=null!==
m.getExtension("OES_standard_derivatives");a.supportsInstancedArrays=null!==m.getExtension("ANGLE_instanced_arrays");a.supportsTextureFloat=null!==m.getExtension("OES_texture_float");a.supportsColorBufferFloat=null!==m.getExtension("WEBGL_color_buffer_float")&&null!==m.getExtension("EXT_float_blend")}a.maxTextureSize=m.getParameter(m.MAX_TEXTURE_SIZE);m=(m=document.createElement("canvas"))&&f.createContext(m,{},"webgl2")?!0:!1;a.version=m?2:1;return a}let q;return function(){q||(q=w());return q}})},
"esri/views/webgl/context-util":function(){define(["exports"],function(f){function w(a,k={},m){switch(m){case "webgl":m=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case "webgl2":m=["webgl2"];break;default:m=["webgl","experimental-webgl","webkit-3d","moz-webgl"]}let g=null;for(const c of m){try{g=a.getContext(c,k)}catch(p){}if(g)break}return g}function q(a,k){(a=a.parentNode)&&(a.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
k+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}f.createContext=w;f.createContextOrErrorHTML=function(a,k={},m){if(!window.WebGLRenderingContext)return q(a,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),null;k=w(a,k,m);return k?k:(q(a,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
null)};Object.defineProperty(f,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/global ../core/has ../core/lang ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/jsonMap ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/Error ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/promiseUtils ../geometry/SpatialReference ../geometry/Extent ../request ./Layer ../core/MultiOriginJSONSupport ./mixins/OperationalLayer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/TileInfo ./support/TilemapCache ./mixins/ArcGISCachedService ./support/imageUtils ./support/SpriteSource ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository ../views/webgl/capabilities".split(" "),function(f,
w,q,a,k,m,g,c,p,h,t,B,z,d,l,u,H,F,N,L,C,v,A,M,P,O,D,y,I,K,J,S,aa,Y,V,ca,ea,ka){a=function(ha){function da(...E){E=ha.call(this,...E)||this;E._spriteSourceMap=new Map;E.currentStyleInfo=null;E.style=null;E.isReference=null;E.operationalLayerType="VectorTileLayer";E.type="vector-tile";E.url=null;return E}f._inheritsLoose(da,ha);var W=da.prototype;W.normalizeCtorArgs=function(E,R){return"string"===typeof E?{url:E,...R}:E};W.destroy=function(){this._spriteSourceMap.clear()};W.prefetchResources=async function(E){await this.loadSpriteSource(q.devicePixelRatio||
1,E)};W.load=function(E){const R=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},E).then(async()=>{if(this.portalItem&&this.portalItem.id){var X=`${this.portalItem.itemUrl}/resources/styles/root.json`;(await L(X,{...E,query:{f:"json"}})).data&&this.read({url:X},Y.createForItem(this.portalItem))}}).then(()=>this._loadStyle(E),()=>this._loadStyle(E));this.addResolvingPromise(R);return Promise.resolve(this)};W.writeStyleUrl=function(E,R){E&&d.isProtocolRelative(E)&&(E=`https:${E}`);
R.styleUrl=E};W.readVersion=function(E,R){return R.version?parseFloat(R.version):parseFloat(R.currentVersion)};W.loadSpriteSource=async function(E=1,R){if(!this._spriteSourceMap.has(E)){var X=ka();X=new S(this.styleRepository.sprite,E,X.maxTextureSize,this.currentStyleInfo.spriteFormat);await X.load(R);this._spriteSourceMap.set(E,X)}return Promise.resolve(this._spriteSourceMap.get(E))};W.loadStyle=async function(E,R){const X=E||this.style||this.url;if(this._loadingPromise&&"string"===typeof X&&this.url===
X&&!H.isAborted(this._abortController))return this._loadingPromise;(E=this._abortController)&&E.abort();const fa=H.createAbortController();this._loadingPromise=new Promise((ma,Z)=>{const na={signal:fa.signal};this._spriteSourceMap.clear();this._getSourceAndStyle(X,na).then(ma,Z);H.onAbort(R,()=>{fa.abort()})});this._abortController=fa;return this._loadingPromise};W.getStyleLayerId=function(E){return this.styleRepository.getStyleLayerId(E)};W.getStyleLayerIndex=function(E){return this.styleRepository.getStyleLayerIndex(E)};
W.getPaintProperties=function(E){return k.clone(this.styleRepository.getPaintProperties(E))};W.setPaintProperties=function(E,R){const X=this.styleRepository.isPainterDataDriven(E);this.styleRepository.setPaintProperties(E,R);const fa=this.styleRepository.isPainterDataDriven(E);this.emit("paint-change",{layerName:E,paint:R,isDataDriven:X||fa})};W.getStyleLayer=function(E){return k.clone(this.styleRepository.getStyleLayer(E))};W.setStyleLayer=function(E,R){this.styleRepository.setStyleLayer(E,R);this.emit("style-layer-change",
{layer:E,index:R})};W.deleteStyleLayer=function(E){this.styleRepository.deleteStyleLayer(E);this.emit("delete-style-layer",{layerName:E})};W.getLayoutProperties=function(E){return k.clone(this.styleRepository.getLayoutProperties(E))};W.setLayoutProperties=function(E,R){this.styleRepository.setLayoutProperties(E,R);this.emit("layout-change",{layer:E,layout:R})};W.setStyleLayerVisibility=function(E,R){this.styleRepository.setStyleLayerVisibility(E,R);this.emit("style-layer-visibility-change",{layer:E,
visibility:R})};W.getStyleLayerVisibility=function(E){return this.styleRepository.getStyleLayerVisibility(E)};W.getTileUrl=function(E,R,X){let fa=this.tileServers[R%this.tileServers.length];return fa=fa.replace(/\{z\}/gi,E.toString()).replace(/\{y\}/gi,R.toString()).replace(/\{x\}/gi,X.toString())};W.write=function(E,R){return R&&R.origin&&!this.styleUrl?(R.messages&&R.messages.push(new z("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,
{layer:this})),null):ha.prototype.write.call(this,E,R)};W._getSourceAndStyle=async function(E,R){if(!E)throw Error("invalid style!");R=await aa.loadMetadata(E,R);"webp"!==R.spriteFormat||await J.checkWebPSupport("lossy")||(R.spriteFormat="png");this._set("currentStyleInfo",{...R});"string"===typeof E?(this.url=E,this.style=null):(this.url=null,this.style=E);this._set("sourceNameToSource",R.sourceNameToSource);this._set("primarySourceName",R.primarySourceName);this._set("styleRepository",new ea(R.style,
R));this.read(R.layerDefinition,{origin:"service"});this.emit("load-style",{})};W._getDefaultAttribution=function(E){var R=E.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);E="OpenStreetMap_v2 OpenStreetMap_Daylight_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84 World_Contours_v2".split(" ");
if(R){var X=R[2]&&R[2].toLowerCase();if(X){R=R[1]||"";for(const fa of E)if(-1<fa.toLowerCase().indexOf(X))return d.normalize(`//static.arcgis.com/attribution/Vector${R}/${fa}`)}}};W._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null};W._loadStyle=async function(E){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,E)};f._createClass(da,[{key:"attributionDataUrl",get:function(){var E=
this.currentStyleInfo;return(E=E&&E.serviceUrl&&d.urlToObject(E.serviceUrl))?this._getDefaultAttribution(E.path):null}},{key:"capabilities",get:function(){const E=this._getPrimarySource();return E?E.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}},{key:"fullExtent",get:function(){const E=this._getPrimarySource();return E?E.fullExtent:null}},{key:"parsedUrl",get:function(){return this.serviceUrl?d.urlToObject(this.serviceUrl):null}},{key:"serviceUrl",get:function(){return this.currentStyleInfo&&
this.currentStyleInfo.serviceUrl||null}},{key:"spatialReference",get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null}},{key:"styleUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}},{key:"tileIndexType",get:function(){const E=this._getPrimarySource();return E?E.type:""}},{key:"tileIndexUrl",get:function(){const E=this._getPrimarySource();return E?E.tileMapURL:""}},{key:"tileInfo",get:function(){var E;const R=[];for(var X in this.sourceNameToSource)R.push(this.sourceNameToSource[X]);
X=(null==(E=this._getPrimarySource())?void 0:E.tileInfo)||new y;if(1<R.length)for(E=0;E<R.length;E++)ca.areSchemasOverlapping(X,R[E].tileInfo)&&(X=ca.unionTileInfos(X,R[E].tileInfo));return X}},{key:"tilemapCache",get:function(){const E=this._getPrimarySource();return E?E.capabilities.operations.supportsTileMap?E.tilemapCache:null:null}},{key:"tileServers",get:function(){const E=this._getPrimarySource();return E?E.tileServers:[]}},{key:"compatibleTileInfo256",get:function(){return V.create256x256CompatibleTileInfo(this.tileInfo)}},
{key:"compatibleTileInfo512",get:function(){return V.create512x512CompatibleTileInfo(this.tileInfo)}}]);return da}(P.BlendLayer(D.ScaleRangeLayer(K.ArcGISCachedService(M.ArcGISService(A.OperationalLayer(O.PortalLayer(v.MultiOriginJSONMixin(C))))))));w.__decorate([c.property({readOnly:!0})],a.prototype,"attributionDataUrl",null);w.__decorate([c.property({type:["show","hide"]})],a.prototype,"listMode",void 0);w.__decorate([c.property({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],
json:{read:!1}})],a.prototype,"capabilities",null);w.__decorate([c.property({readOnly:!0})],a.prototype,"currentStyleInfo",void 0);w.__decorate([c.property({json:{read:!1},readOnly:!0,type:N})],a.prototype,"fullExtent",null);w.__decorate([c.property()],a.prototype,"style",void 0);w.__decorate([c.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],a.prototype,"isReference",void 0);w.__decorate([c.property({type:["VectorTileLayer"]})],a.prototype,"operationalLayerType",
void 0);w.__decorate([c.property({readOnly:!0})],a.prototype,"parsedUrl",null);w.__decorate([c.property({readOnly:!0})],a.prototype,"serviceUrl",null);w.__decorate([c.property({type:F,readOnly:!0})],a.prototype,"spatialReference",null);w.__decorate([c.property({readOnly:!0})],a.prototype,"styleRepository",void 0);w.__decorate([c.property({readOnly:!0})],a.prototype,"sourceNameToSource",void 0);w.__decorate([c.property({readOnly:!0})],a.prototype,"primarySourceName",void 0);w.__decorate([c.property({type:String,
readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],a.prototype,"styleUrl",null);w.__decorate([B.writer(["portal-item","web-document"],"styleUrl")],a.prototype,"writeStyleUrl",null);w.__decorate([c.property({json:{read:!1},readOnly:!0})],a.prototype,"tileIndexType",null);w.__decorate([c.property({json:{read:!1},readOnly:!0})],a.prototype,"tileIndexUrl",null);w.__decorate([c.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,
type:y})],a.prototype,"tileInfo",null);w.__decorate([c.property({json:{read:!1},readOnly:!0,type:I.TilemapCache})],a.prototype,"tilemapCache",null);w.__decorate([c.property({json:{read:!1},readOnly:!0})],a.prototype,"tileServers",null);w.__decorate([c.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],a.prototype,"type",void 0);w.__decorate([c.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],a.prototype,"url",void 0);
w.__decorate([c.property({readOnly:!0})],a.prototype,"version",void 0);w.__decorate([h.reader("version",["version","currentVersion"])],a.prototype,"readVersion",null);w.__decorate([c.property({readOnly:!0})],a.prototype,"compatibleTileInfo256",null);w.__decorate([c.property({readOnly:!0})],a.prototype,"compatibleTileInfo512",null);return a=w.__decorate([t.subclass("esri.layers.VectorTileLayer")],a)});