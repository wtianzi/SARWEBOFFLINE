// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/jsonMap ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../geometry/SpatialReference ../geometry/Extent ../geometry ./support/fieldUtils ../PopupTemplate ./Layer ../renderers/Renderer ../renderers/ClassBreaksRenderer ../renderers/UniqueValueRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/SimpleRenderer ../renderers/support/types ../renderers/support/jsonUtils ../core/ReadOnlyMultiOriginJSONSupport ../symbols/support/ElevationInfo ./support/Field ./support/FieldsIndex ./mixins/BlendLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/FeatureReduction ./support/LabelClass ./support/FeatureReductionCluster ./support/FeatureReductionSelection ./support/featureReductionUtils ./support/FeatureTemplate ./support/FeatureType ../support/popupUtils ../tasks/support/Query ./graphics/sources/GeoJSONSource".split(" "),
function(w,t,c,u,V,W,d,x,y,z,A,B,X,Y,v,C,Z,n,D,b,aa,ba,ca,da,ea,fa,ha,E,ia,F,G,H,I,J,K,L,M,N,O,P,Q,p,R,S,T,k,U){u=new x.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});b=function(q){function l(a){a=q.call(this,a)||this;a.copyright=null;a.definitionExpression=null;a.displayField=null;a.editingEnabled=!0;a.elevationInfo=null;a.featureReduction=null;a.fields=null;a.fullExtent=null;a.geometryType=null;a.hasZ=void 0;
a.labelsVisible=!0;a.labelingInfo=null;a.legendEnabled=!0;a.objectIdField=null;a.popupEnabled=!0;a.popupTemplate=null;a.screenSizePerspectiveEnabled=!0;a.source=null;a.spatialReference=v.WGS84;a.templates=null;a.title="GeoJSON";a.type="geojson";a.typeIdField=null;a.types=null;a.url=null;return a}t._inheritsLoose(l,q);var g=l.prototype;g.destroy=function(){var a;null==(a=this.source)?void 0:a.destroy()};g.load=function(a){const e=new U["default"]({layer:this});this._set("source",e);this.addResolvingPromise(e.load(a).then(()=>
{this.read(e.sourceJSON,{origin:"service",url:this.parsedUrl});this.revert(["objectIdField","fields","timeInfo"],"service");n.fixRendererFields(this.renderer,this.fields);n.fixTimeInfoFields(this.timeInfo,this.fields)}));return Promise.resolve(this)};g.readFeatureReduction=function(a,e){return p.read(a,e)};g.writeWebSceneFeatureReduction=function(a,e,f,h){p.writeTarget(a,e,"layerDefinition.featureReduction",h)};g.applyEdits=async function(a,e){const f=await new Promise(function(h,m){w(["./graphics/editingSupport"],
h,m)});await this.load();return f.applyEdits(this,this.source,a,e)};g.on=function(a,e){return q.prototype.on.call(this,a,e)};g.createPopupTemplate=function(a){return T.createPopupTemplate(this,a)};g.createQuery=function(){const a=new k,e=this.get("capabilities.data");a.returnGeometry=!0;e&&e.supportsZ&&(a.returnZ=!0);a.outFields=["*"];a.where=this.definitionExpression||"1\x3d1";const {timeOffset:f,timeExtent:h}=this;a.timeExtent=null!=f&&null!=h?h.offset(-f.value,f.unit):h||null;return a};g.getFieldDomain=
function(a,e){let f,h=!1;e=(e=e&&e.feature)&&e.attributes;const m=this.typeIdField&&e&&e[this.typeIdField];null!=m&&this.types&&(h=this.types.some(r=>r.id==m?((f=r.domains&&r.domains[a])&&"inherited"===f.type&&(f=this._getLayerDomain(a)),!0):!1));h||f||(f=this._getLayerDomain(a));return f};g.getField=function(a){return this.fieldsIndex.get(a)};g.queryFeatures=function(a,e){return this.load().then(()=>this.source.queryFeatures(k.from(a)||this.createQuery(),e)).then(f=>{if(f&&f.features)for(const h of f.features)h.layer=
h.sourceLayer=this;return f})};g.queryObjectIds=function(a,e){return this.load().then(()=>this.source.queryObjectIds(k.from(a)||this.createQuery(),e))};g.queryFeatureCount=function(a,e){return this.load().then(()=>this.source.queryFeatureCount(k.from(a)||this.createQuery(),e))};g.queryExtent=function(a,e){return this.load().then(()=>this.source.queryExtent(k.from(a)||this.createQuery(),e))};g._getLayerDomain=function(a){if(!this.fields)return null;let e=null;this.fields.some(f=>{f.name===a&&(e=f.domain);
return!!e});return e};t._createClass(l,[{key:"capabilities",get:function(){return this.source?this.source.capabilities:null}},{key:"createQueryVersion",get:function(){this.commitProperty("definitionExpression");this.commitProperty("timeExtent");this.commitProperty("timeOffset");this.commitProperty("geometryType");this.commitProperty("capabilities");return(this._get("createQueryVersion")||0)+1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"fieldsIndex",get:function(){return new I(this.fields)}},
{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},{key:"parsedUrl",get:function(){return this.url?B.urlToObject(this.url):null}},{key:"renderer",set:function(a){n.fixRendererFields(a,this.fields);this._set("renderer",a)}}]);return l}(J.BlendLayer(M.TemporalLayer(L.ScaleRangeLayer(K.RefreshableLayer(F.ReadOnlyMultiOriginJSONMixin(b))))));c.__decorate([d.property({readOnly:!0,json:{read:!1,write:!1}})],b.prototype,"capabilities",null);c.__decorate([d.property({type:String})],
b.prototype,"copyright",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"createQueryVersion",null);c.__decorate([d.property({readOnly:!0})],b.prototype,"defaultPopupTemplate",null);c.__decorate([d.property({type:String})],b.prototype,"definitionExpression",void 0);c.__decorate([d.property({type:String})],b.prototype,"displayField",void 0);c.__decorate([d.property({type:Boolean})],b.prototype,"editingEnabled",void 0);c.__decorate([d.property({type:G})],b.prototype,"elevationInfo",void 0);
c.__decorate([d.property({types:{key:"type",base:N["default"],typeMap:{selection:Q,cluster:P}},json:{write:{target:"layerDefinition.featureReduction"}}})],b.prototype,"featureReduction",void 0);c.__decorate([y.reader("featureReduction",["layerDefinition.featureReduction"])],b.prototype,"readFeatureReduction",null);c.__decorate([A.writer("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:p.webSceneFeatureReductionTypes}})],b.prototype,"writeWebSceneFeatureReduction",null);c.__decorate([d.property({type:[H]})],
b.prototype,"fields",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"fieldsIndex",null);c.__decorate([d.property({type:C,aliasOf:"source.fullExtent"})],b.prototype,"fullExtent",void 0);c.__decorate([d.property({type:["point","polygon","polyline","multipoint"],json:{read:{reader:u.read}}})],b.prototype,"geometryType",void 0);c.__decorate([d.property({type:Boolean})],b.prototype,"hasZ",void 0);c.__decorate([d.property({type:String})],b.prototype,"id",void 0);c.__decorate([d.property({type:Boolean,
readOnly:!0})],b.prototype,"isTable",null);c.__decorate([d.property({type:Boolean})],b.prototype,"labelsVisible",void 0);c.__decorate([d.property({type:[O]})],b.prototype,"labelingInfo",void 0);c.__decorate([d.property({type:Boolean})],b.prototype,"legendEnabled",void 0);c.__decorate([d.property({type:["show","hide"]})],b.prototype,"listMode",void 0);c.__decorate([d.property({type:String})],b.prototype,"objectIdField",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"parsedUrl",null);
c.__decorate([d.property({type:Boolean})],b.prototype,"popupEnabled",void 0);c.__decorate([d.property({type:D})],b.prototype,"popupTemplate",void 0);c.__decorate([d.property({types:E.rendererTypes,json:{read:{source:"drawingInfo.renderer"}}})],b.prototype,"renderer",null);c.__decorate([d.property({type:Boolean})],b.prototype,"screenSizePerspectiveEnabled",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"source",void 0);c.__decorate([d.property({type:v})],b.prototype,"spatialReference",
void 0);c.__decorate([d.property({type:[R]})],b.prototype,"templates",void 0);c.__decorate([d.property()],b.prototype,"title",void 0);c.__decorate([d.property({json:{read:!1},readOnly:!0})],b.prototype,"type",void 0);c.__decorate([d.property({type:String,readOnly:!0})],b.prototype,"typeIdField",void 0);c.__decorate([d.property({type:[S]})],b.prototype,"types",void 0);c.__decorate([d.property({type:String})],b.prototype,"url",void 0);return b=c.__decorate([z.subclass("esri.layers.GeoJSONLayer")],b)});