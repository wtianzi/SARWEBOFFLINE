// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["../../core/maybe","../../core/Error","../support/adapters/support/layerUtils","./summaryStatistics","./support/ageUtils"],function(l,e,k,m,d){async function n(a){if(!(a&&a.layer&&a.startTime&&a.endTime&&a.unit))throw new e("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");var b=[0,2,1,3];const {layer:f,...g}=a;var c=k.createLayerAdapter(f,b);a={layerAdapter:c,...g};if(!c)throw new e("summary-statistics-for-age:invalid-parameters",
"'layer' must be one of these types: "+k.getLayerTypeLabels(b).join(", "));b=a.view;const h=l.isSome(a.signal)?{signal:a.signal}:null;await Promise.all([b&&b.when(),c.load(h)]);if(c=d.verifyDates(c,a.startTime,a.endTime,"summary-statistics-for-age:invalid-parameters"))throw c;if(-1===d.supportedAgeUnits.indexOf(a.unit))throw new e("summary-statistics-for-age:invalid-parameters",`Supported units are: ${d.supportedAgeUnits.join(", ")}`);return a}return async function(a){const {layerAdapter:b,...f}=
await n(a),{view:g,startTime:c,endTime:h,unit:p,minValue:q,maxValue:r,signal:t}=f,{valueExpression:u,statisticsQuery:v}=d.getAgeExpressions({layer:b,startTime:c,endTime:h,unit:p});return m({layer:b,valueExpression:u,...v,minValue:q,maxValue:r,view:g,signal:t})}});