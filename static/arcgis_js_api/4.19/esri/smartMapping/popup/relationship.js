// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","../../core/Error","../../PopupTemplate","../../intl/messages","./support/utils"],function(h,f,m,n,k){async function p(b){const {layer:c,renderer:d}=b;await c.load();b=d||c.renderer;if("unique-value"!==b.type)throw new f("relationship-popup:invalid-parameters","renderer.type must be 'unique-value'");const a=b.authoringInfo;if(!a||"relationship"!==a.type)throw new f("relationship-popup:invalid-parameters","renderer.authoringInfo.type must be 'relationship'");if(!(a.field1&&a.field1.field&&
a.field2&&a.field2.field))throw new f("relationship-popup:invalid-parameters","'field1' and/or 'field2' properties are missing in renderer.authoringInfo");return{layer:c,renderer:b}}async function l(b,c,d="divide"){const {fieldInfos:a,expressionInfos:e}=await k.getFieldAndExpressionInfos({renderer:b,layer:c,normFieldExpressionTemplate:d});return new m({content:await k.getContentFromFieldInfos(c,{fieldInfos:a,expressionInfos:e}),fieldInfos:a,expressionInfos:e})}h.getTemplates=async function(b){const [{renderer:c,
layer:d},a]=await Promise.all([p(b),n.fetchMessageBundle("esri/smartMapping/t9n/smartMapping")]);b={name:"relationship",title:a.relationshipPopupTitle,value:await l(c,d)};const e=[];var g=c.authoringInfo;(g=!(!g.field1.normalizationField&&!g.field2.normalizationField))&&e.push({name:"relationship-percent",title:a.relationshipNormFieldAsPercent,value:await l(c,d,"percentage")});return{primaryTemplate:b,secondaryTemplates:e}};Object.defineProperty(h,"__esModule",{value:!0})});