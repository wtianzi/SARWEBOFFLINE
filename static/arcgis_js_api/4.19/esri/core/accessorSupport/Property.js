// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define(["exports","./tracking/ObservationHandle"],function(e,h){let f=!1,l=function(){function g(a,d,b){this.host=a;this.propertyName=d;this.metadata=b;this.flags=1;this._accessed=this._observers=null;this._handles=[];this.flags=1|(b.nonNullable?8:0)|(b.hasOwnProperty("value")?16:0)|(void 0===b.get?32:0)|(void 0===b.dependsOn?64:0)}var c=g.prototype;c.destroy=function(){this._accessed&&(this._accessed.clear(),this._accessed=null);this._observers&&(this._observers.clear(),this._observers=null);this._clearObservationHandles()};
c.onObservableAccessed=function(a){a!==this&&(null===this._accessed&&(this._accessed=new Set),this._accessed.add(a))};c.onTrackingEnd=function(){this._clearObservationHandles();this.flags|=32;const a=this._accessed;if(null!==a){var d=this._handles;for(const b of a)d.push(b.observe(this));a.clear()}};c.observe=function(a){null===this._observers&&(this._observers=new Set);return new h.ObservationHandle(this._observers.add(a),a)};c.notify=function(){~this.flags&2&&(this.flags|=1);this._notifyObservers()};
c.invalidate=function(){this.notify()};c.commit=function(){this.flags&=-2;this._notifyObservers()};c._notifyObservers=function(){if(null!==this._observers){var a=this._observers.size,d=Array(a);--a;for(var b of this._observers)d[a--]=b;for(b=!f;d.length;)if(a=d.pop(),void 0!==a.flags){if(~a.flags&2&&(a.flags|=1),null!==a._observers)for(const k of a._observers)d.push(k)}else b&&a.notify()}};c._clearObservationHandles=function(){for(const a of this._handles)a.remove();this._handles.length=0};return g}();
e.Property=l;e.isInvalidating=function(){return f};e.startInvalidating=function(){f=!0};e.stopInvalidating=function(){f=!1};Object.defineProperty(e,"__esModule",{value:!0})});