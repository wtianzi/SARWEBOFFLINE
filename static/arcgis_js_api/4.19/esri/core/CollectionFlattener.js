// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./Collection ./Handles".split(" "),function(p,g,h,q,l,r){let f=function(m){function k(a){a=m.call(this,a)||this;a._handles=new r;a.root=null;return a}p._inheritsLoose(k,m);var e=k.prototype;e.initialize=function(){this._handles.add(this.rootCollectionNames.map(a=>this.watch("root."+a,()=>this.updateCollections(),!0)));this.updateCollections()};e.destroy=function(){this.root=
null;this.refresh();this._handles.destroy();this._handles=null};e.updateCollections=function(){this._collections=this.rootCollectionNames.map(a=>this.get("root."+a)).filter(a=>null!=a);this.refresh()};e.refresh=function(){const a=this._handles;a.remove("collections");const b=[];let d=0;for(const c of this._collections)d=this._processCollection(b,d,c);this.splice(d,this.length);for(const c of b)a.add(c.on("after-changes",()=>this.refresh()),"collections")};e._createNewInstance=function(a){return new l(a)};
e._processCollection=function(a,b,d){if(!d)return b;a.push(d);d.forEach(c=>{if(c){if(!this.itemFilterFunction||this.itemFilterFunction(c)){const n=this.indexOf(c,b);0<=n?n!==b&&this.reorder(c,b):this.add(c,b);++b}this.getChildrenFunction&&(b=this._processCollection(a,b,this.getChildrenFunction(c)))}});return b};return k}(l);g.__decorate([h.property()],f.prototype,"rootCollectionNames",void 0);g.__decorate([h.property()],f.prototype,"root",void 0);g.__decorate([h.property()],f.prototype,"getChildrenFunction",
void 0);g.__decorate([h.property()],f.prototype,"itemFilterFunction",void 0);return f=g.__decorate([q.subclass("esri.core.CollectionFlattener")],f)});