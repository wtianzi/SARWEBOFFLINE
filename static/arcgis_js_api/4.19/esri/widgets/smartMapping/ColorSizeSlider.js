// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/aliasOf ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../renderers/visualVariables/support/ColorStop ../../renderers/visualVariables/support/SizeStop ../support/widgetUtils ../support/decorators/messageBundle ../../chunks/index ./support/utils ./SmartMappingSliderBase ../../renderers/visualVariables/support/ColorSizeStop ./ColorSizeSlider/ColorSizeSliderViewModel".split(" "),
function(L,r,q,v,R,S,B,x,T,M,F,U,V,W,G,H,N,O,u,I,P,J,Q){var C;q=C=function(K){function A(a,b){a=K.call(this,a,b)||this;a._bgFillId=null;a._backgroundFillColor="#e0e0e0";a._minRampFillWidth=.2;a._rampFillId=null;a._rampNode=null;a._maxRampFillWidth=1;a.handlesSyncedToPrimary=null;a.label=void 0;a.messages=null;a.persistSizeRangeEnabled=null;a.primaryHandleEnabled=null;a.stops=null;a.viewModel=new Q;a.zoomOptions=null;a._bgFillId=`${a.id}-bg-fill`;a._rampFillId=`${a.id}-linear-gradient`;return a}L._inheritsLoose(A,
K);A.fromRendererResult=function(a,b){const {renderer:{authoringInfo:{univariateTheme:f}},color:{visualVariable:{stops:e}},size:{visualVariables:g},statistics:p}=a,{avg:d,stddev:k}=p;if(!e)throw new F("ColorSizeSlider-fromRendererResult:invalid-renderer-result","'result' must include 'color' variable.");const l="above-and-below"===f;var h=a.renderer.authoringInfo.visualVariables[0];a=h.minSliderValue;h=h.maxSliderValue;const m=g.find(c=>"outline"!==(null==c?void 0:c.target)&&!!(null==c||!c.axis||
null!=c&&c.field||null!=c&&c.valueExpression)&&((null==c?void 0:c.field)||(null==c?void 0:c.valueExpression))),n=m.stops,z=e.map((c,t)=>{const {color:y,label:D,value:E}=c;return new J({color:y,label:D,value:E,size:n&&0<n.length?n[t].size:0===t?m.minSize:t===e.length-1?m.maxSize:null})});return new C({max:h,min:a,stops:z,primaryHandleEnabled:l,handlesSyncedToPrimary:l,persistSizeRangeEnabled:l,histogramConfig:{average:d,standardDeviation:k,bins:b?b.bins:[]}})};var w=A.prototype;w.updateFromRendererResult=
function(a,b){const {renderer:{authoringInfo:{univariateTheme:f}},color:{visualVariable:{stops:e}},size:{visualVariables:g},statistics:p}=a,{avg:d,stddev:k}=p;if(!e)throw new F("ColorSizeSlider-fromRendererResult:invalid-renderer-result","'result' must include 'color' variable.");const l="above-and-below"===f;var h=a.renderer.authoringInfo.visualVariables[0];a=h.minSliderValue;h=h.maxSliderValue;const m=g.find(c=>"outline"!==(null==c?void 0:c.target)&&!!(null==c||!c.axis||null!=c&&c.field||null!=
c&&c.valueExpression)&&((null==c?void 0:c.field)||(null==c?void 0:c.valueExpression))),n=m.stops,z=e.map((c,t)=>{const {color:y,label:D,value:E}=c;return new J({color:y,label:D,value:E,size:n&&0<n.length?n[t].size:0===t?m.minSize:t===e.length-1?m.maxSize:null})});this.set({max:h,min:a,stops:z,primaryHandleEnabled:l,handlesSyncedToPrimary:l,persistSizeRangeEnabled:l,histogramConfig:{average:d,standardDeviation:k,bins:b?b.bins:[]}})};w.updateRenderer=function(a){const {stops:b}=this,f=b[0],e=b[b.length-
1];var g=b[Math.floor(b.length/2)];a=a.clone();const p=a.visualVariables.map(d=>{if("size"===d.type){if("outline"===(null==d?void 0:d.target)||!(null==d||!d.axis||null!=d&&d.field||null!=d&&d.valueExpression))return d;v.isSome(d.minSize)&&v.isSome(d.maxSize)?d.set({maxDataValue:e.value,minDataValue:f.value,maxSize:e.size,minSize:f.size}):d.stops&&d.set({stops:b.map(k=>{const {label:l,size:h,value:m}=k;return new H({label:l,size:h,value:m})})})}else"color"===d.type&&d.set({stops:this.stops.map(k=>
{const {color:l,label:h,value:m}=k;return new G({color:l,label:h,value:m})})});return d});a.visualVariables=p;1<a.classBreakInfos.length&&(g=g.value,a.classBreakInfos[0].maxValue=g,a.classBreakInfos[1].minValue=g);return a};w.updateVisualVariables=function(a){return a.map(b=>{const f=b.clone();if("size"===b.type){if("outline"===(null==b?void 0:b.target)||!(null==b||!b.axis||null!=b&&b.field||null!=b&&b.valueExpression))return f;if(v.isSome(b.minSize)&&v.isSome(b.maxSize)){var {stops:e}=this;b=e[0];
e=e[e.length-1];f.set({maxDataValue:e.value,minDataValue:b.value,maxSize:e.size,minSize:b.size})}else b.stops&&f.set({stops:this.stops.map(g=>{const {label:p,size:d,value:k}=g;return new H({label:p,size:d,value:k})})})}else"color"===b.type&&f.set({stops:this.stops.map(g=>{const {color:p,label:d,value:k}=g;return new G({color:p,label:d,value:k})})});return f})};w.render=function(){const {state:a,label:b}=this,f="disabled"===a,e=this.classes("esri-color-size-slider","esri-widget","esri-widget--panel",
{["esri-disabled"]:f});return u.jsx("div",{"aria-label":b,class:e},f?null:this.renderContent(this.renderRamp(),"esri-color-size-slider__slider-container","esri-color-size-slider__histogram-container"))};w.renderRamp=function(){const {_bgFillId:a,_rampFillId:b,viewModel:f,zoomOptions:e}=this,g=f.getStopInfo();return u.jsx("div",{afterCreate:N.storeNode,bind:this,class:"esri-color-size-slider__ramp","data-node-ref":"_rampNode"},u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg"},u.jsx("defs",null,this.renderRampFillDefinition(b,
g),this.renderBackgroundFillDefinition(a)),u.jsx("rect",{x:"0",y:"0",fill:this._backgroundFillColor,height:"100%",width:"100%"}),this.renderPaths()),e?this.renderZoomCaps():null)};w.renderPaths=function(){if(this._rampNode){var {offsetHeight:a=0,offsetWidth:b=0}=this._rampNode;if(v.isSome(a)&&v.isSome(b)){var {primaryHandleEnabled:f,stops:e,values:g,viewModel:{max:p,min:d},_bgFillId:k,_maxRampFillWidth:l,_minRampFillWidth:h,_rampFillId:m}=this,n=[l,h];e[0].size<e[e.length-1].size&&n.reverse();var [z,
c]=n,[t,y]=g;n=f?I.getDynamicPathForSizeStops({max:p,min:d,pathHeight:a,pathWidth:b,stops:e,padding:h}):I.getPathForSizeStops({bottomValue:t,bottomWidth:z,max:p,min:d,pathHeight:a,pathWidth:b,topValue:y,topWidth:c});return[u.jsx("path",{key:"background",d:n,fill:`url(#${k})`}),u.jsx("path",{key:"fill",d:n,fill:`url(#${m})`})]}}};return A}(P.SmartMappingSliderBase);r.__decorate([x.aliasOf("viewModel.handlesSyncedToPrimary")],q.prototype,"handlesSyncedToPrimary",void 0);r.__decorate([B.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],q.prototype,"label",void 0);r.__decorate([B.property(),O.messageBundle("esri/widgets/smartMapping/ColorSizeSlider/t9n/ColorSizeSlider")],q.prototype,"messages",void 0);r.__decorate([x.aliasOf("viewModel.persistSizeRangeEnabled")],q.prototype,"persistSizeRangeEnabled",void 0);r.__decorate([x.aliasOf("viewModel.primaryHandleEnabled")],q.prototype,"primaryHandleEnabled",void 0);r.__decorate([x.aliasOf("viewModel.stops")],q.prototype,"stops",void 0);r.__decorate([B.property()],q.prototype,
"viewModel",void 0);r.__decorate([x.aliasOf("viewModel.zoomOptions")],q.prototype,"zoomOptions",void 0);return q=C=r.__decorate([M.subclass("esri.widgets.smartMapping.ColorSizeSlider")],q)});