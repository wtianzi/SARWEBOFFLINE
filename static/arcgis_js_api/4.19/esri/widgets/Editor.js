// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../core/Collection ./Settings ./FeatureSnappingLayerSource".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x){l=function(c){function m(h){h=c.call(this,h)||this;h.enabled=!1;h.enabledToggled=!1;h.selfEnabled=!0;h.featureEnabled=!0;h.featureSources=new D;h.distance=y.defaults.distance;h.touchSensitivityMultiplier=y.defaults.touchSensitivityMultiplier;return h}a._inheritsLoose(m,c);a._createClass(m,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return m}(v);e.__decorate([f.property()],l.prototype,"enabled",void 0);e.__decorate([f.property()],l.prototype,"enabledToggled",void 0);e.__decorate([f.property()],l.prototype,"selfEnabled",void 0);e.__decorate([f.property()],l.prototype,"featureEnabled",void 0);e.__decorate([f.property({type:D.ofType(x)})],l.prototype,"featureSources",void 0);e.__decorate([f.property()],l.prototype,"distance",void 0);
e.__decorate([f.property()],l.prototype,"touchSensitivityMultiplier",void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"effectiveEnabled",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"effectiveSelfEnabled",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"effectiveFeatureEnabled",null);return l=e.__decorate([b.subclass("esri.views.interactive.snapping.SnappingOptions")],l)})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ../../../core/JSONSupport ../../../Color".split(" "),
function(a,e,l,B,d,f,u){let b=function(p){function q(){var r=p.apply(this,arguments)||this;r.enabled=!0;return r}e._inheritsLoose(q,p);return q}(f.JSONSupport);l.__decorate([B.property({type:Boolean})],b.prototype,"enabled",void 0);b=l.__decorate([d.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],b);f=function(p){function q(r){r=p.call(this,r)||this;r.lineSnapper=new b;r.parallelLineSnapper=new b;r.rightAngleSnapper=new b;r.rightAngleTriangleSnapper=new b;r.shortLineThreshold=
15;r.distance=5;r.pointThreshold=1E-6;r.intersectionParallelLineThreshold=1E-6;r.parallelLineThreshold=1E-6;r.touchSensitivityMultiplier=1.5;r.pointOnLineThreshold=1E-6;r.orange=new u([255,127,0]);r.lineHintWidthReference=3;r.lineHintWidthTarget=3;r.lineHintFadedExtensions=.3;r.parallelLineHintWidth=2;r.parallelLineHintLength=24;r.parallelLineHintOffset=1.5;r.rightAngleHintSize=24;r.rightAngleHintOutlineSize=1.5;return r}e._inheritsLoose(q,p);return q}(f.JSONSupport);l.__decorate([B.property({type:b,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"lineSnapper",void 0);l.__decorate([B.property({type:b,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"parallelLineSnapper",void 0);l.__decorate([B.property({type:b,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleSnapper",void 0);l.__decorate([B.property({type:b,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleTriangleSnapper",void 0);l.__decorate([B.property({type:Number,
nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,"shortLineThreshold",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,"distance",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointThreshold",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"intersectionParallelLineThreshold",
void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"parallelLineThreshold",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"touchSensitivityMultiplier",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointOnLineThreshold",void 0);l.__decorate([B.property({type:u,nonNullable:!0})],f.prototype,"orange",void 0);
l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthReference",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthTarget",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],f.prototype,"lineHintFadedExtensions",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
f.prototype,"parallelLineHintWidth",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],f.prototype,"parallelLineHintLength",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],f.prototype,"parallelLineHintOffset",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],f.prototype,"rightAngleHintSize",void 0);l.__decorate([B.property({type:Number,nonNullable:!0,
range:{min:0,max:6},json:{write:!0}})],f.prototype,"rightAngleHintOutlineSize",void 0);f=l.__decorate([d.subclass("esri.views.interactive.snapping.Settings.Defaults")],f);l=new f;a.defaults=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){l=function(D){function y(x){x=D.call(this,x)||this;x.layer=null;x.enabled=!0;x.updating=!1;x.availability=1;return x}a._inheritsLoose(y,D);return y}(v);e.__decorate([f.property({constructOnly:!0})],l.prototype,"layer",void 0);e.__decorate([f.property()],l.prototype,"enabled",void 0);e.__decorate([f.property()],l.prototype,"updating",void 0);e.__decorate([f.property()],l.prototype,"availability",void 0);return l=e.__decorate([b.subclass("esri.views.interactive.snapping.SnappingLayerSource")],
l)})},"esri/widgets/FeatureForm":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../layers/support/domains ../layers/support/fieldUtils ../intl/locale ../intl ../intl/moment ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ../chunks/index ./Widget ./FeatureForm/FeatureFormViewModel".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){l=function(t){function A(w,F){var E=t.call(this,w,F)||this;E._activeDateEdit=null;E._activeInputName=null;E._fieldFocusNeeded=!1;E._fieldToInitialIncompatibleDomainValue=new Map;E._moment=null;E._userUpdatedInputFieldNames=new Set;E.description=null;E.feature=null;E.fieldConfig=null;E.formTemplate=null;E.groupDisplay="all";E.label=void 0;E.layer=null;E.messages=null;E.strict=null;E.title=null;E.viewModel=new C;E._handleRadioInputChange=N=>{E._updateFieldValue(N.target)};
E._handleFormKeyDown=E._handleFormKeyDown.bind(a._assertThisInitialized(E));E._handleInputBlur=E._handleInputBlur.bind(a._assertThisInitialized(E));E._handleInputFocus=E._handleInputFocus.bind(a._assertThisInitialized(E));E._handleNumberInputMouseDown=E._handleNumberInputMouseDown.bind(a._assertThisInitialized(E));E._handleInputKeyDown=E._handleInputKeyDown.bind(a._assertThisInitialized(E));E._handleOptionChange=E._handleOptionChange.bind(a._assertThisInitialized(E));E._handleGroupClick=E._handleGroupClick.bind(a._assertThisInitialized(E));
E._handleSubmit=E._handleSubmit.bind(a._assertThisInitialized(E));E._afterInputCreateOrUpdate=E._afterInputCreateOrUpdate.bind(a._assertThisInitialized(E));return E}a._inheritsLoose(A,t);var z=A.prototype;z.loadLocale=async function(){this._moment=await m.loadMoment()};z.initialize=function(){this.own(this.watch("feature",()=>{const w=this._getFocusableInput("forward");this._activeInputName=w&&w.name;this._userUpdatedInputFieldNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();this._fieldFocusNeeded=
!0}),this.on("submit",w=>{if(0<w.invalid.length){const [F]=w.invalid;w.invalid.forEach(E=>this._userUpdatedInputFieldNames.add(E));this._activeInputName=F;this._fieldFocusNeeded=!0;this.scheduleRender()}}))};z.destroy=function(){this._userUpdatedInputFieldNames.clear();this._userUpdatedInputFieldNames=null};z.getValues=function(){return null};z.submit=function(){return null};z.render=function(){const {state:w}=this.viewModel;return n.jsx("div",{class:this.classes("esri-feature-form","esri-widget",
"esri-widget--panel")},"ready"===w?this.renderForm():null)};z.renderForm=function(){var w=this.title?n.jsx("h2",{class:"esri-widget__heading",key:"title"},this.title):null;const F=this.description?n.jsx("p",{class:"esri-feature-form__description-text",key:"description"},this.description):null;w=w||F?n.jsx("div",{class:"esri-feature-form__form-header"},w,F):null;return n.jsx("form",{class:"esri-feature-form__form",novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},w,this.renderFields())};
z.renderFields=function(){const {viewModel:{inputFields:w}}=this;return w.map((F,E)=>F&&F.inputFields?this.renderGroup(F,E):this.renderLabeledField(F))};z.renderGroup=function(w,F){const {description:E,label:N,inputFields:U,state:S}=w;var I=this.viewModel.findField(this._activeInputName);I=!(!I||I.group!==w);const L=`${this.id}_group_${F}`,M=`${this.id}_group-label_${F}`,K=`${this.id}_group-description_${F}`,P=E?n.jsx("p",{class:this.classes("esri-feature-form__group-description","esri-feature-form__description-text"),
id:K},E):null,Q="sequential"===this.groupDisplay,R=Q?I:"expanded"===S,Y=R?"esri-icon-up":"esri-icon-down";return n.jsx("fieldset",{"aria-expanded":R.toString(),"aria-labelledby":M,"aria-describedby":E?K:"",class:this.classes("esri-feature-form__group",Q?"esri-feature-form__group--sequential":null,R?null:"esri-feature-form__group--collapsed",I?"esri-feature-form__group--active":null),"data-group":w,id:L,key:F,onclick:this._handleGroupClick},n.jsx("button",{role:Q?"presentation":void 0,class:"esri-feature-form__group-header",
type:"button",tabIndex:Q?-1:0},n.jsx("div",{class:"esri-feature-form__group-title"},n.jsx("h4",{class:this.classes("esri-feature-form__group-label","esri-widget__heading"),id:M},N),P),Q?null:n.jsx("span",{class:this.classes(Y,"esri-feature-form__group-toggle-icon")})),U.map(T=>this.renderLabeledField(T)))};z._getFocusableInput=function(w,F){var E=this.viewModel._allInputFields;E="forward"===w?E:E.slice().reverse();F?F&&F.inputFields?w=E.indexOf(F.inputFields[0]):(this._isFieldInClosedCollapsibleGroup(F)?
({inputFields:F}=F.group,w="forward"===w?F[F.length-1]:F[0]):w=F,w=E.indexOf(w)+1):w=0;for(;w<E.length;w++)if(F=E[w],F.visible&&F.editable)return F;return null};z.renderLabeledField=function(w){const {label:F,layer:E,type:N}=w;return n.jsx("label",{key:`${E.id}-${w.name}`,class:"esri-feature-form__label"},[F,"unsupported"!==N?this.renderInputField(w):this.renderUnsupportedField(w),this.renderAuxiliaryText(w)])};z.renderInputField=function(w){var {viewModel:F}=this;const {domain:E,editable:N,name:U,
type:S}=w;F=F.getValue(U);const I=!N,L=this.getCommonInputProps(w);return"coded-value"!==(null==E?void 0:E.type)||I?"text"===S&&"text-area"===w.editorType||"rich-text"===w.editorType?n.jsx("textarea",Object.assign({},L)):"datetime-picker"===w.editorType||"date"===S?this.renderDateInputField(F,L):n.jsx("input",Object.assign({type:"text"===S?"text":"number"},L)):"radio-buttons"===w.editorType?this.renderRadioButtonsInputField(F,E.codedValues.map(({code:M,name:K})=>({value:M,name:K})),L):this.renderSelectInputField(F,
E.codedValues.map(({code:M,name:K})=>({value:M,name:K})),L)};z.renderDateInputField=function(w,F){const {date:E,time:N}=this._formatDate(0);var U=`${this.id}-${F.key}`;const S=`${U}-date`;U=`${U}-time`;const I=F["data-field"],{includeTime:L}=I,{date:M,time:K}=this._formatDate(w);return n.jsx("div",{key:`${F.key}-date`,class:"esri-feature-form__date-input-container"},n.jsx("div",{class:this.classes("esri-feature-form__date-input-part",L?null:"esri-feature-form__date-input-part--lone")},n.jsx("input",
Object.assign({"aria-label":I.label,"aria-describedby":S,type:"text"},F,{"data-date-part":"date",class:this.classes(F.class,"esri-feature-form__input--date"),value:M})),n.jsx("div",{class:"esri-feature-form__date-format-hint",id:S},E)),L?n.jsx("div",{class:"esri-feature-form__date-input-part",key:"time-input"},n.jsx("input",Object.assign({"aria-describedby":U,"aria-label":I.label,type:"text"},F,{"data-date-part":"time",class:this.classes(F.class,"esri-feature-form__input--time"),value:K})),n.jsx("div",
{class:"esri-feature-form__date-format-hint",id:U},N)):null)};z.renderUnsupportedField=function(w){w=this.viewModel.getValue(w.name);return n.jsx("input",{class:this.classes("esri-input","esri-feature-form__input","esri-feature-form__input--disabled"),disabled:!0,type:"text",value:`${w}`})};z.renderSelectInputField=function(w,F,E){const N=F.map(I=>n.jsx("option",{value:`${I.value}`,key:I.name},I.name)),U=E["data-field"];this.registerIncompatibleValue(w,F,U,I=>{N.unshift(n.jsx("option",{value:`${I}`,
key:"incompatible-option",disabled:!0},I))});if(!U.required&&("combo-box"!==U.editorType||U.config.showNoValueOption)){var S;w=(null==(S=U.config)?void 0:S.noValueOptionLabel)||this.messages.empty;N.unshift(n.jsx("option",{value:"",key:"empty-option"},w))}return n.jsx("select",Object.assign({},E,{class:this.classes(E.class,"esri-select"),onchange:this._handleOptionChange}),N)};z.registerIncompatibleValue=function(w,F,E,N){const U=this._fieldToInitialIncompatibleDomainValue,S=U.has(E.name);if(S||null!=
w&&""!==w&&!F.find(I=>I.value===w)||S)S||U.set(E.name,w),null==N?void 0:N(U.get(E.name))};z.renderRadioButtonsInputField=function(w,F,E){const N=E["data-field"],U=F.map(I=>this.renderRadioButton({key:I.name,label:I.name,name:N.name,value:I.value,selected:I.value===w,props:E}));this.registerIncompatibleValue(w,F,N);if(!N.required&&(!N.config||N.config.showNoValueOption)){var S;F=(null==(S=N.config)?void 0:S.noValueOptionLabel)||this.messages.empty;U.unshift(this.renderRadioButton({key:"empty-option",
label:F,name:N.name,value:"",selected:""===w||null===w,props:E}))}return n.jsx("div",{key:`${E.key}-radio`,class:"esri-feature-form__input--radio-group"},U)};z.renderRadioButton=function({key:w,name:F,value:E,selected:N,label:U,props:S}){return n.jsx("label",{key:w,class:"esri-feature-form__input--radio-label"},n.jsx("input",Object.assign({},S,{class:"esri-feature-form__input--radio",name:F,type:"radio",value:E,checked:N,onchange:this._handleRadioInputChange})),U)};z.renderAuxiliaryText=function(w){if(this._userUpdatedInputFieldNames.has(w.name)&&
!w.valid)return n.jsx("div",{key:"error-message"},n.jsx("span",{class:this.classes("esri-feature-form__input-icon--invalid","esri-icon-notice-triangle")}),n.jsx("div",{class:"esri-feature-form__field-error-message"},w.errorMessage));if(w.description)return n.jsx("div",{key:"description",class:"esri-feature-form__description-text"},w.description)};z.getCommonInputProps=function(w){const {groupDisplay:F,viewModel:E}=this,{editable:N,group:U,hint:S,maxLength:I,minLength:L,name:M,required:K,type:P,valid:Q}=
w,R=E.getValue(M),Y=this._userUpdatedInputFieldNames.has(M),T=!N,V="all"===F&&"collapsed"===(null==U?void 0:U.state);return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":Q?"false":"true","class":this.classes("esri-input","esri-feature-form__input",T?"esri-feature-form__input--disabled":null,Y&&!Q?"esri-feature-form__input--invalid":null),key:M,minlength:-1<L?`${L}`:"",maxlength:-1<I?`${I}`:"",...this._getNumberFieldConstraints(w),disabled:T,value:null==
R?"":`${R}`,"data-field":w,onfocus:this._handleInputFocus,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===P?this._handleNumberInputMouseDown:null,placeholder:"number"===P||"text"===P?S:"",required:K,tabIndex:V?-1:0}};z._isFieldInClosedCollapsibleGroup=function(w){var F;return"all"===this.groupDisplay&&!(w&&w.inputFields)&&"collapsed"===(null==w?void 0:null==(F=w.group)?void 0:F.state)};z._handleNumberInputMouseDown=function({target:w}){w.disabled||w.focus();
this.scheduleRender()};z._getNumberFieldConstraints=function(w){return(w=D.getDomainRange(w.domain)||y.getFieldRange(w.field))&&w.max!==Number.MAX_VALUE&&w.min!==Number.MIN_VALUE?w:{min:null,max:null}};z._afterInputCreateOrUpdate=function(w){const F=w["data-field"],E=this.viewModel.findField(this._activeInputName),N=this._fieldToInitialIncompatibleDomainValue.get(F.name)===F.value;F.editable&&this._fieldFocusNeeded&&E===F&&("radio-buttons"!==F.editorType||N||w.checked)&&(this._fieldFocusNeeded=!1,
w.focus())};z._handleInputFocus=function(w){this._activeInputName=w.target["data-field"].name};z._handleInputBlur=function(w){var F=w.target;const E=F["data-field"],N=(w=w.relatedTarget)&&w["data-field"];this._syncDateEditsBeforeValueCommit(F);if(N&&"date"===E.type&&"date"===N.type&&E.field===N.field)""!==F.value&&""===w.value&&(F=w.getAttribute("data-date-part"),w.value=this._formatDate(Date.now())[F]);else if("radio-buttons"!==E.editorType||F.checked)this._commitValue(F),this.scheduleRender()};
z._commitValue=function(w){var F=w["data-field"];if(this._activeDateEdit){const {date:N,time:U}=this._activeDateEdit;var E=this._getDateEditValue(F,"date");F=this._getDateEditValue(F,"time");const S=""===E||""===F;if(N){const {input:I}=N;I.value=S?"":E}U&&({input:E}=U,E.value=S?"":F);this._activeDateEdit=null;if(N&&U){this._updateDateFieldValue(N.input,U.input);return}}this._updateFieldValue(w)};z._getDateEditValue=function(w,F){var E=this._activeDateEdit[F];if(E){var {value:N}=E;return""===N?"":
(E=this._parseDate(E.value,F))?this._formatDate(E.getTime())[F]:this._formatDate(w.value)[F]}};z._handleInputKeyDown=function(w){const {key:F,altKey:E,ctrlKey:N,metaKey:U,shiftKey:S}=w;var I=w.target,L=I["data-field"];if("Tab"===F){var M=S?"backward":"forward",K=I.getAttribute("data-date-part");this._syncDateEditsBeforeValueCommit(I);"backward"===M&&"time"===K||"forward"===M&&"date"===K&&L.includeTime||(this._commitValue(I),I=this.viewModel.findField(L.name),M=this._getFocusableInput(M,I),I=I.group===
(null==M?void 0:M.group),this._activeInputName=null==M?void 0:M.name,M&&("sequential"===this.groupDisplay||I)?(w.preventDefault(),this._fieldFocusNeeded=!0):this.renderNow())}else"Enter"!==F?({type:I}=L.field,M="single"===I||"double"===I,"integer"!==I&&"small-integer"!==I&&!M||E||N||U||1!==F.length||(I=Number(F),L=["-","+"],K=["e","."],M=M?[...L,...K]:L,isNaN(I)&&-1===M.indexOf(F)&&w.preventDefault())):this._isFieldInClosedCollapsibleGroup(L)?L.group.state="expanded":(this._updateFieldValue(w.target),
this.scheduleRender())};z._syncDateEditsBeforeValueCommit=function(w){if("date"===w["data-field"].type){var F=w.getAttribute("data-date-part");this._activeDateEdit={...this._activeDateEdit,[F]:{value:w.value,input:w}}}};z._updateFieldValue=function(w){const F=w["data-field"];this.viewModel.setValue(F.name,this._parseValue(w));this._userUpdatedInputFieldNames.add(F.name)};z._updateDateFieldValue=function(w,F){const E=w["data-field"];this.viewModel.setValue(E.name,this._parseDateTimeValue(w,F));this._userUpdatedInputFieldNames.add(E.name)};
z._parseValue=function(w){var F=w["data-field"],E=w.value;if("radio-buttons"===F.editorType&&"radio"===w.type&&!w.checked)return F.value;var {type:N}=F;if("number"===N)return E?parseFloat(E):null;if("date"===N){if(!E)return null;N=Number(E);if(!isNaN(N))return N;w=w.getAttribute("data-date-part");N=this._parseDate(E,w);if(!N)return null;E=this._moment;N=E(N);var U=F.domain;const S=E();let I=S;U&&"range"===U.type&&(U=E(U.maxValue),S.isAfter(U)||(I=U));F=this.viewModel.getValue(F.name);F=E(null!=F?
F:I);"date"===w?(N.hour(F.hour()),N.minutes(F.minutes()),N.seconds(F.seconds())):(N.date(F.date()),N.month(F.month()),N.year(F.year()));return N.valueOf()}return E};z._parseDateTimeValue=function(w,F){w=w.value;F=F.value;if(!w||!F)return null;w=this._parseDate(w,"date");F=this._parseDate(F,"time");if(!w||!F)return null;w=this._moment(w);F=this._moment(F);w.hour(F.hour());w.minutes(F.minutes());w.seconds(F.seconds());return w.valueOf()};z._handleOptionChange=function(w){this._updateFieldValue(w.target);
this.scheduleRender()};z._handleGroupClick=function(w){var F;const E=w.currentTarget["data-group"],N="expanded"===E.state,U="sequential"===this.groupDisplay;if(!N||w.target.closest(".esri-feature-form__group-header")){this._activeInputName=null==(F=this._getFocusableInput("forward",E))?void 0:F.name;if(U){w=w.target.closest(".esri-feature-form__group-header");if(N&&!w)return;this.viewModel.inputFields.forEach(S=>{S&&S.inputFields&&S!==E&&(S.state="collapsed")})}E.state=N?"collapsed":"expanded";this._fieldFocusNeeded=
U;this.scheduleRender()}};z._handleSubmit=function(w){w.preventDefault()};z._handleFormKeyDown=function(w){"Enter"===w.key&&this.viewModel.submit()};z._formatDate=function(w){if(null==w)return{date:"",time:""};w=this._moment(w);return{date:w.format("L"),time:w.format("LTS")}};z._parseDate=function(w,F){if(null==w||""===w)return null;w=this._moment(w,"date"===F?"L":"LTS",x.getLocale(),!1);return w.isValid()?w.toDate():null};return A}(G);e.__decorate([u.aliasOf("viewModel.description")],l.prototype,
"description",void 0);e.__decorate([u.aliasOf("viewModel.feature")],l.prototype,"feature",void 0);e.__decorate([u.aliasOf("viewModel.fieldConfig")],l.prototype,"fieldConfig",void 0);e.__decorate([u.aliasOf("viewModel.formTemplate")],l.prototype,"formTemplate",void 0);e.__decorate([f.property()],l.prototype,"groupDisplay",void 0);e.__decorate([f.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l.prototype,"label",void 0);e.__decorate([u.aliasOf("viewModel.layer")],l.prototype,"layer",
void 0);e.__decorate([f.property(),g.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],l.prototype,"messages",void 0);e.__decorate([u.aliasOf("viewModel.strict")],l.prototype,"strict",void 0);e.__decorate([u.aliasOf("viewModel.title")],l.prototype,"title",void 0);e.__decorate([f.property(),k.vmEvent(["value-change","submit"])],l.prototype,"viewModel",void 0);e.__decorate([u.aliasOf("viewModel.getValues")],l.prototype,"getValues",null);e.__decorate([u.aliasOf("viewModel.submit")],l.prototype,
"submit",null);return l=e.__decorate([p.subclass("esri.widgets.FeatureForm")],l)})},"esri/intl/moment":function(){define(["require","exports","./locale"],function(a,e,l){const B=new Map([["ar",()=>(new Promise(function(d,f){a(["../chunks/ar"],d,f)})).then(function(d){return d.ar})],["ar-dz",()=>(new Promise(function(d,f){a(["../chunks/ar-dz"],d,f)})).then(function(d){return d.arDz})],["ar-kw",()=>(new Promise(function(d,f){a(["../chunks/ar-kw"],d,f)})).then(function(d){return d.arKw})],["ar-ly",()=>
(new Promise(function(d,f){a(["../chunks/ar-ly"],d,f)})).then(function(d){return d.arLy})],["ar-ma",()=>(new Promise(function(d,f){a(["../chunks/ar-ma"],d,f)})).then(function(d){return d.arMa})],["ar-sa",()=>(new Promise(function(d,f){a(["../chunks/ar-sa"],d,f)})).then(function(d){return d.arSa})],["ar-tn",()=>(new Promise(function(d,f){a(["../chunks/ar-tn"],d,f)})).then(function(d){return d.arTn})],["bs",()=>(new Promise(function(d,f){a(["../chunks/bs"],d,f)})).then(function(d){return d.bs})],["ca",
()=>(new Promise(function(d,f){a(["../chunks/ca"],d,f)})).then(function(d){return d.ca})],["cs",()=>(new Promise(function(d,f){a(["../chunks/cs"],d,f)})).then(function(d){return d.cs})],["da",()=>(new Promise(function(d,f){a(["../chunks/da"],d,f)})).then(function(d){return d.da})],["de",()=>(new Promise(function(d,f){a(["../chunks/de"],d,f)})).then(function(d){return d.de})],["de-at",()=>(new Promise(function(d,f){a(["../chunks/de-at"],d,f)})).then(function(d){return d.deAt})],["de-ch",()=>(new Promise(function(d,
f){a(["../chunks/de-ch"],d,f)})).then(function(d){return d.deCh})],["el",()=>(new Promise(function(d,f){a(["../chunks/el"],d,f)})).then(function(d){return d.el})],["en-au",()=>(new Promise(function(d,f){a(["../chunks/en-au"],d,f)})).then(function(d){return d.enAu})],["en-ca",()=>(new Promise(function(d,f){a(["../chunks/en-ca"],d,f)})).then(function(d){return d.enCa})],["en-gb",()=>(new Promise(function(d,f){a(["../chunks/en-gb"],d,f)})).then(function(d){return d.enGb})],["en-ie",()=>(new Promise(function(d,
f){a(["../chunks/en-ie"],d,f)})).then(function(d){return d.enIe})],["en-il",()=>(new Promise(function(d,f){a(["../chunks/en-il"],d,f)})).then(function(d){return d.enIl})],["en-in",()=>(new Promise(function(d,f){a(["../chunks/en-in"],d,f)})).then(function(d){return d.enIn})],["en-nz",()=>(new Promise(function(d,f){a(["../chunks/en-nz"],d,f)})).then(function(d){return d.enNz})],["en-sg",()=>(new Promise(function(d,f){a(["../chunks/en-sg"],d,f)})).then(function(d){return d.enSg})],["es",()=>(new Promise(function(d,
f){a(["../chunks/es"],d,f)})).then(function(d){return d.es})],["es-do",()=>(new Promise(function(d,f){a(["../chunks/es-do"],d,f)})).then(function(d){return d.esDo})],["es-mx",()=>(new Promise(function(d,f){a(["../chunks/es-mx"],d,f)})).then(function(d){return d.esMx})],["es-us",()=>(new Promise(function(d,f){a(["../chunks/es-us"],d,f)})).then(function(d){return d.esUs})],["et",()=>(new Promise(function(d,f){a(["../chunks/et"],d,f)})).then(function(d){return d.et})],["fi",()=>(new Promise(function(d,
f){a(["../chunks/fi"],d,f)})).then(function(d){return d.fi})],["fr",()=>(new Promise(function(d,f){a(["../chunks/fr"],d,f)})).then(function(d){return d.fr})],["fr-ca",()=>(new Promise(function(d,f){a(["../chunks/fr-ca"],d,f)})).then(function(d){return d.frCa})],["fr-ch",()=>(new Promise(function(d,f){a(["../chunks/fr-ch"],d,f)})).then(function(d){return d.frCh})],["he",()=>(new Promise(function(d,f){a(["../chunks/he"],d,f)})).then(function(d){return d.he})],["hr",()=>(new Promise(function(d,f){a(["../chunks/hr"],
d,f)})).then(function(d){return d.hr})],["hu",()=>(new Promise(function(d,f){a(["../chunks/hu"],d,f)})).then(function(d){return d.hu})],["id",()=>(new Promise(function(d,f){a(["../chunks/id"],d,f)})).then(function(d){return d.id})],["it",()=>(new Promise(function(d,f){a(["../chunks/it"],d,f)})).then(function(d){return d.it})],["it-ch",()=>(new Promise(function(d,f){a(["../chunks/it-ch"],d,f)})).then(function(d){return d.itCh})],["ja",()=>(new Promise(function(d,f){a(["../chunks/ja"],d,f)})).then(function(d){return d.ja})],
["ko",()=>(new Promise(function(d,f){a(["../chunks/ko"],d,f)})).then(function(d){return d.ko})],["lt",()=>(new Promise(function(d,f){a(["../chunks/lt"],d,f)})).then(function(d){return d.lt})],["lv",()=>(new Promise(function(d,f){a(["../chunks/lv"],d,f)})).then(function(d){return d.lv})],["nb",()=>(new Promise(function(d,f){a(["../chunks/nb"],d,f)})).then(function(d){return d.nb})],["nl",()=>(new Promise(function(d,f){a(["../chunks/nl"],d,f)})).then(function(d){return d.nl})],["nl-be",()=>(new Promise(function(d,
f){a(["../chunks/nl-be"],d,f)})).then(function(d){return d.nlBe})],["pl",()=>(new Promise(function(d,f){a(["../chunks/pl"],d,f)})).then(function(d){return d.pl})],["pt",()=>(new Promise(function(d,f){a(["../chunks/pt"],d,f)})).then(function(d){return d.pt})],["pt-br",()=>(new Promise(function(d,f){a(["../chunks/pt-br"],d,f)})).then(function(d){return d.ptBr})],["ro",()=>(new Promise(function(d,f){a(["../chunks/ro"],d,f)})).then(function(d){return d.ro})],["ru",()=>(new Promise(function(d,f){a(["../chunks/ru"],
d,f)})).then(function(d){return d.ru})],["sk",()=>(new Promise(function(d,f){a(["../chunks/sk"],d,f)})).then(function(d){return d.sk})],["sl",()=>(new Promise(function(d,f){a(["../chunks/sl"],d,f)})).then(function(d){return d.sl})],["sr",()=>(new Promise(function(d,f){a(["../chunks/sr"],d,f)})).then(function(d){return d.sr})],["sr-cyrl",()=>(new Promise(function(d,f){a(["../chunks/sr-cyrl"],d,f)})).then(function(d){return d.srCyrl})],["sv",()=>(new Promise(function(d,f){a(["../chunks/sv"],d,f)})).then(function(d){return d.sv})],
["th",()=>(new Promise(function(d,f){a(["../chunks/th"],d,f)})).then(function(d){return d.th})],["tr",()=>(new Promise(function(d,f){a(["../chunks/tr"],d,f)})).then(function(d){return d.tr})],["uk",()=>(new Promise(function(d,f){a(["../chunks/uk"],d,f)})).then(function(d){return d.uk})],["vi",()=>(new Promise(function(d,f){a(["../chunks/vi"],d,f)})).then(function(d){return d.vi})],["zh-cn",()=>(new Promise(function(d,f){a(["../chunks/zh-cn"],d,f)})).then(function(d){return d.zhCn})],["zh-hk",()=>
(new Promise(function(d,f){a(["../chunks/zh-hk"],d,f)})).then(function(d){return d.zhHk})],["zh-mo",()=>(new Promise(function(d,f){a(["../chunks/zh-mo"],d,f)})).then(function(d){return d.zhMo})],["zh-tw",()=>(new Promise(function(d,f){a(["../chunks/zh-tw"],d,f)})).then(function(d){return d.zhTw})]]);e.loadMoment=async function(d=l.getLocale()){const f=(await (new Promise(function(b,p){a(["../chunks/moment"],b,p)})).then(function(b){return b.moment})).default;let u=B.has(d);if(!u){const b=d.split("-");
1<b.length&&B.has(b[0])&&(d=b[0],u=!0)}u?await B.get(d)():d="en";d!==f.locale()&&f.locale(d);return f};Object.defineProperty(e,"__esModule",{value:!0})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/ReentrantObjectPool ../../core/Evented ../../support/arcadeOnDemand ../../intl/locale ../../intl/messages ../../intl ../../Graphic ../../core/watchUtils ../../form/FormTemplate ../../core/HandleOwner ./FieldConfig ./FieldGroupConfig ./InputField ./InputFieldGroup ./support/formTemplateUtils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z){function w(N){return!!N.fieldConfig}const F=new h({attributes:{}}),E=B.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel");l=function(N){function U(I){I=N.call(this,I)||this;I._arcade=null;I._fieldPool=new v.ReentrantObjectPool(t);I._fieldGroupPool=new v.ReentrantObjectPool(A);I._featureClone=F.clone();I._initialFeature=F.clone();I._needsArcade=!1;I.messages=null;I.strict=!1;return I}a._inheritsLoose(U,N);var S=U.prototype;S.initialize=
function(){const I=async()=>this.messages=await c.fetchMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm");I();this.handles.add(x.onLocaleChange(I));const L=g.init(this,"fieldConfig",async M=>{const K=[];M&&M.forEach(Q=>{K.push(Q.visibilityExpression);Q.fieldConfig?Q.fieldConfig.forEach(({requiredExpression:R,visibilityExpression:Y})=>{K.push(R,Y)}):K.push(Q.requiredExpression)});M=K.filter(Q=>!!Q);const P=0<M.length;if(P){const Q=await y.loadArcade(),{arcadeUtils:R}=Q;M.some(Y=>R.hasGeometryOperations(Y))&&
(await R.enableGeometryOperations(),L.remove());this._arcade=Q;this.notifyChange("inputFields")}this._needsArcade=P});this.handles.add(L)};S.destroy=function(){this.layer=this.feature=this.fieldConfig=null;this._fieldPool.destroy();this._fieldGroupPool.destroy()};S.castFieldConfig=function(I){return I?I.map(L=>L instanceof G||L instanceof C?L:L.fieldConfig?new C(L):new G(L)):null};S.findField=function(I){return this._allInputFields.find(L=>L.name===I)};S.getValue=function(I){var L;const {_featureClone:M,
layer:K}=this,P=!(null==K||!K.getField(I));return null!=(L=M.getAttribute(I))?L:P?null:void 0};S.setValue=function(I,L){const {_featureClone:M,strict:K}=this,P=this.findField(I);L=""===L?null:L;if(P&&M.getAttribute(I)!==L){P.value=L;if(this.get("layer.typeIdField")===P.name){const Q=new Set;this.layer.types.forEach(R=>Object.keys(R.domains).forEach(Y=>Q.add(Y)));Q.forEach(R=>{(R=this.findField(R))&&R.notifyChange("domain")})}if(!K||P.valid)M.setAttribute(I,L),this.notifyChange("inputFields"),this._emitChangeEvent(P)}};
S.getValues=function(){return{...this._featureClone.attributes}};S.submit=function(){var I=this._allInputFields;const L=I.filter(K=>K.valid).map(({name:K})=>K);I=I.filter(K=>!K.valid).map(({name:K})=>K);const M=this.getValues();this.emit("submit",{valid:L,invalid:I,values:M})};S._disposeInputOrGroup=function(I){I.inputFields?this._disposeGroup(I):this._disposeInput(I)};S._disposeGroup=function(I){I.inputFields.forEach(L=>this._disposeInput(L));this._fieldGroupPool.release(I)};S._disposeInput=function(I){this._fieldPool.release(I)};
S._emitChangeEvent=function({name:I,valid:L,value:M}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:I,value:M,valid:L})};a._createClass(U,[{key:"_allInputFields",get:function(){return this.inputFields.reduce((I,L)=>L.inputFields?[...I,...L.inputFields]:[...I,L],[])}},{key:"_inputFieldCache",get:function(){const I=this._get("_inputFieldCache")||new Map;I.forEach(L=>this._disposeInputOrGroup(L));I.clear();(this.get("layer.fields")||[]).forEach(L=>I.set(L,this._fieldPool.acquire()));
return I}},{key:"_inputFieldGroupCache",get:function(){const I=this._get("_inputFieldGroupCache")||new Map;I.forEach(L=>this._disposeInputOrGroup(L));I.clear();(this.fieldConfig||[]).filter(w).forEach(L=>I.set(L,this._fieldGroupPool.acquire()));return I}},{key:"description",get:function(){var I;return null==(I=this.formTemplate)?void 0:I.description},set:function(I){void 0===I?this._clearOverride("description"):this._override("description",I)}},{key:"feature",get:function(){return this._get("feature")},
set:function(I){this._featureClone=I?I.clone():F.clone();this._initialFeature=this._featureClone.clone();this._set("feature",I)}},{key:"fieldConfig",get:function(){const {formTemplate:I}=this;if(!I)return null;const {config:L,encounteredUnsupportedTypes:M}=z.fieldConfigsFromFormTemplate(I);0<M.length&&E.warn("form-info::unsupported-type","encountered unsupported elements/types when parsing form info",M);return L},set:function(I){I?this._override("fieldConfig",I):this._clearOverride("fieldConfig")}},
{key:"formTemplate",get:function(){var I;return null==(I=this.layer)?void 0:I.formTemplate},set:function(I){void 0===I?this._clearOverride("formTemplate"):this._override("formTemplate",I)}},{key:"inputFields",get:function(){const {_arcade:I,_inputFieldCache:L,_inputFieldGroupCache:M,_featureClone:K,messages:P,_needsArcade:Q,layer:R,state:Y}=this,T=K.clone();if("ready"!==Y||Q&&!I)return[];const V=this.get("layer.fields")||[],W=this.fieldConfig||[];return(0!==W.length?W.map(X=>{if(X.fieldConfig){const H=
M.get(X);var oa=X.fieldConfig.map(J=>{const aa=V.find(ja=>ja.name===J.name),fa=L.get(aa);fa.set({arcade:I,field:aa,config:J,feature:T,group:H,initialFeature:this._initialFeature,layer:R,messages:P,value:this.getValue(aa.name)});return fa}).filter(J=>J.visible);H.set({arcade:I,config:X,feature:T,inputFields:oa});return H}oa=V.find(H=>H.name===X.name);const ua=L.get(oa);ua.set({arcade:I,field:oa,config:X,feature:T,group:null,initialFeature:this._initialFeature,layer:R,messages:P,value:this.getValue(oa.name)});
return ua}):V.map(X=>{const oa=L.get(X);oa.set({arcade:I,config:null,field:X,feature:T,group:null,initialFeature:this._initialFeature,layer:R,messages:P,value:this.getValue(X.name)});return oa})).filter(X=>X.visible)}},{key:"layer",get:function(){return this.get("feature.layer")},set:function(I){I?this._override("layer",I):this._clearOverride("layer")}},{key:"state",get:function(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}},{key:"title",get:function(){var I;return null==(I=
this.formTemplate)?void 0:I.title},set:function(I){void 0===I?this._clearOverride("title"):this._override("title",I)}},{key:"valid",get:function(){const I=this._allInputFields;return 0<I.length&&I.every(({valid:L})=>L)}}]);return U}(n.HandleOwnerMixin(D.EventedAccessor));e.__decorate([d.property({readOnly:!0})],l.prototype,"_allInputFields",null);e.__decorate([d.property({readOnly:!0})],l.prototype,"_inputFieldCache",null);e.__decorate([d.property({readOnly:!0})],l.prototype,"_inputFieldGroupCache",
null);e.__decorate([d.property()],l.prototype,"description",null);e.__decorate([d.property()],l.prototype,"feature",null);e.__decorate([d.property()],l.prototype,"fieldConfig",null);e.__decorate([f.cast("fieldConfig")],l.prototype,"castFieldConfig",null);e.__decorate([d.property({type:k})],l.prototype,"formTemplate",null);e.__decorate([d.property({readOnly:!0,dependsOn:"messages feature fieldConfig layer.fields layer.loaded state".split(" ")})],l.prototype,"inputFields",null);e.__decorate([d.property()],
l.prototype,"layer",null);e.__decorate([d.property()],l.prototype,"messages",void 0);e.__decorate([d.property()],l.prototype,"state",null);e.__decorate([d.property()],l.prototype,"strict",void 0);e.__decorate([d.property()],l.prototype,"title",null);e.__decorate([d.property()],l.prototype,"valid",null);e.__decorate([d.property()],l.prototype,"getValues",null);e.__decorate([d.property()],l.prototype,"submit",null);return l=e.__decorate([b.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],
l)})},"esri/widgets/FeatureForm/FieldConfig":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ./Format".split(" "),function(a,e,l,B,d,f,u,b,p,q,r,v,D){l=function(y){function x(c){c=y.call(this,
c)||this;c.description=null;c.domain=null;c.editable=!0;c.editorType=null;c.format=null;c.hint=null;c.includeTime=!0;c.label=null;c.maxLength=-1;c.minLength=-1;c.name=null;c.noValueOptionLabel=null;c.required=!1;c.requiredExpression=null;c.showNoValueOption=!1;c.visibilityExpression=null;return c}a._inheritsLoose(x,y);return x}(v);e.__decorate([f.property()],l.prototype,"description",void 0);e.__decorate([f.property()],l.prototype,"domain",void 0);e.__decorate([f.property()],l.prototype,"editable",
void 0);e.__decorate([f.property()],l.prototype,"editorType",void 0);e.__decorate([f.property({type:D})],l.prototype,"format",void 0);e.__decorate([f.property()],l.prototype,"hint",void 0);e.__decorate([f.property()],l.prototype,"includeTime",void 0);e.__decorate([f.property()],l.prototype,"label",void 0);e.__decorate([f.property()],l.prototype,"maxLength",void 0);e.__decorate([f.property()],l.prototype,"minLength",void 0);e.__decorate([f.property()],l.prototype,"name",void 0);e.__decorate([f.property()],
l.prototype,"noValueOptionLabel",void 0);e.__decorate([f.property()],l.prototype,"required",void 0);e.__decorate([f.property()],l.prototype,"requiredExpression",void 0);e.__decorate([f.property()],l.prototype,"showNoValueOption",void 0);e.__decorate([f.property()],l.prototype,"visibilityExpression",void 0);return l=e.__decorate([b.subclass("esri.widgets.FeatureForm.FieldConfig")],l)})},"esri/widgets/FeatureForm/Format":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/JSONSupport ../../core/date".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D){l=function(y){function x(c){c=y.call(this,c)||this;c.digitSeparator=!1;c.dateFormat=null;c.places=null;return c}a._inheritsLoose(x,y);return x}(v.JSONSupport);e.__decorate([f.property()],l.prototype,"digitSeparator",void 0);e.__decorate([f.property({json:{read:{source:"dateFormat",reader:D.fromJSON}}})],l.prototype,"dateFormat",void 0);e.__decorate([f.property()],l.prototype,"places",void 0);return l=e.__decorate([b.subclass("esri.widgets.FeatureForm.Format")],
l)})},"esri/widgets/FeatureForm/FieldGroupConfig":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ./FieldConfig".split(" "),function(a,e,l,B,d,f,u,b,p,q,r,v,D){l=function(y){function x(c){c=
y.call(this,c)||this;c.description=null;c.fieldConfig=null;c.label=null;c.state="expanded";c.visibilityExpression=null;return c}a._inheritsLoose(x,y);x.prototype.castFieldConfig=function(c){return c?c.map(m=>m.declaredClass?m:new D(m)):null};return x}(v);e.__decorate([d.property()],l.prototype,"description",void 0);e.__decorate([d.property()],l.prototype,"fieldConfig",void 0);e.__decorate([f.cast("fieldConfig")],l.prototype,"castFieldConfig",null);e.__decorate([d.property()],l.prototype,"label",void 0);
e.__decorate([d.property()],l.prototype,"state",void 0);e.__decorate([d.property()],l.prototype,"visibilityExpression",void 0);return l=e.__decorate([b.subclass("esri.widgets.FeatureForm.FieldGroupConfig")],l)})},"esri/widgets/FeatureForm/InputField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../layers/support/CodedValueDomain ../../layers/support/domains ../../layers/support/fieldUtils ../../intl/substitute ../../intl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){const h={type:"number"},g={type:"number",intlOptions:{notation:"scientific"}},k={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}};l=function(n){function G(t){t=n.call(this,t)||this;t.arcade=null;t.config=null;t.feature=null;t.field=null;t.initialFeature=null;t.layer=null;t.description=null;t.editorType=null;t.error=null;t.format=null;t.group=null;t.hint=null;t.messages=null;t.name=null;
return t}a._inheritsLoose(G,n);var C=G.prototype;C._isDomainCompatible=function(t){const {field:A}=this;if("coded-value"===(null==t?void 0:t.type)){const z=typeof t.codedValues[0].code;if("string"===z&&x.isStringField(A)||"number"===z&&x.isNumericField(A))return!0}return"range"===(null==t?void 0:t.type)&&x.isNumericField(A)||x.isDateField(A)?!0:!1};C._validate=function(){const {domain:t,field:A,initialFeature:z,minLength:w,required:F,type:E,value:N}=this,U=F&&null===N;return U||z.getAttribute(A.name)!==
N?"text"===E&&-1<w&&"string"===typeof N&&N.length<w?"length-validation-error::too-short":t?null!==N||F?y.validateDomainValue(t,N):null:U?x.TypeValidationError.INVALID_TYPE:x.validateFieldValue(A,N):null};C._shownByDefault=function(){var t;const A=null==(t=this.field)?void 0:t.type;return"oid"!==A&&"global-id"!==A&&!this._isGeometryField()};C._isEditorField=function(){return-1<x.getFeatureEditFields(this.layer).indexOf(this.name)};C._isGeometryField=function(){return-1<x.getFeatureGeometryFields(this.layer).indexOf(this.name)};
C._toErrorMessage=function(){const {domain:t,field:A,messages:z,minLength:w,value:F,required:E,type:N}=this;var U=this.error;return E&&null===F?z.validationErrors.cannotBeNull:U===y.DomainValidationError.VALUE_OUT_OF_RANGE||U===x.NumericRangeValidationError.OUT_OF_RANGE?(U=y.getDomainRange(t)||x.getFieldRange(A),c.substitute(z.validationErrors.outsideRange,U,{format:{max:"date"===N?k:U.isInteger?h:g,min:"date"===N?k:U.isInteger?h:g}})):U===y.DomainValidationError.INVALID_CODED_VALUE?z.validationErrors.invalidCodedValue:
U===x.TypeValidationError.INVALID_TYPE?z.validationErrors.invalidType:"length-validation-error::too-short"===U?c.substitute(z.validationErrors.tooShort,{min:w}):null};a._createClass(G,[{key:"compiledFunc",get:function(){var t;const {arcade:A}=this;return A&&A.arcadeUtils.createFunction(null==(t=this.config)?void 0:t.visibilityExpression)}},{key:"compiledRequiredFunc",get:function(){var t;const {arcade:A}=this;return A&&A.arcadeUtils.createFunction(null==(t=this.config)?void 0:t.requiredExpression)}},
{key:"evaluatedRequirement",get:function(){const t=this.compiledRequiredFunc;if(!t)return null;const {arcade:A}=this;return A.arcadeUtils.executeFunction(t,A.arcadeUtils.createExecContext(this.feature))}},{key:"evaluatedVisibility",get:function(){const t=this.compiledFunc;if(!t)return null;const {arcade:A}=this;return A.arcadeUtils.executeFunction(t,A.arcadeUtils.createExecContext(this.feature))}},{key:"domain",get:function(){var t,A,{typeIdField:z}=this.layer;const w=z===this.name;var F=null==(t=
this.field)?void 0:t.domain;if(w&&!F)return new D({name:"__internal-type-based-coded-value-domain__",codedValues:this.layer.types.map(({id:E,name:N})=>({code:E,name:N}))});({feature:t}=this);z=z&&this.layer.getFieldDomain(this.name,{feature:t})||F;F=null==(A=this.config)?void 0:A.domain;return this._isDomainCompatible(F)?F:z}},{key:"editable",get:function(){var t;return this.layer.capabilities.operations.supportsEditing&&this.field.editable&&!1!==(null==(t=this.config)?void 0:t.editable)}},{key:"errorMessage",
get:function(){return this._toErrorMessage()}},{key:"includeTime",get:function(){var t;const A=null==(t=this.config)?void 0:t.includeTime;return void 0===A?!0:A}},{key:"label",get:function(){var t;return(null==(t=this.config)?void 0:t.label)||this.field.alias||this.field.name}},{key:"maxLength",get:function(){var t,A;if("date"===this.type)return-1;const z=null==(t=this.field)?void 0:t.length;t=null==(A=this.config)?void 0:A.maxLength;return!isNaN(t)&&-1<=t&&(-1===z||t<=z)?t:z}},{key:"minLength",get:function(){var t,
A;if("date"===this.type)return-1;const z=null==(t=this.field)?void 0:t.length;t=null==(A=this.config)?void 0:A.minLength;return!isNaN(t)&&-1<=t&&(-1===z||t<=z)?t:-1}},{key:"required",get:function(){var t,A;return this.editable?null!=(t=this.field)&&t.nullable?"boolean"===typeof this.evaluatedRequirement?this.evaluatedRequirement:!0===(null==(A=this.config)?void 0:A.required):!0:!1}},{key:"type",get:function(){const {field:t}=this;return x.isNumericField(t)?"number":x.isStringField(t)?"text":x.isDateField(t)?
"date":"unsupported"}},{key:"valid",get:function(){const t=this.editable?this._validate():null;this._set("error",t);return null===t}},{key:"value",get:function(){return this._get("value")},set:function(t){this.notifyChange("evaluatedVisibility");this._set("value",t)}},{key:"visible",get:function(){return this._isEditorField()?!1:"boolean"===typeof this.evaluatedVisibility?this.evaluatedVisibility:!!this.config||this._shownByDefault()}}]);return G}(v);e.__decorate([f.property()],l.prototype,"arcade",
void 0);e.__decorate([f.property()],l.prototype,"compiledFunc",null);e.__decorate([f.property()],l.prototype,"compiledRequiredFunc",null);e.__decorate([f.property()],l.prototype,"config",void 0);e.__decorate([f.property()],l.prototype,"evaluatedRequirement",null);e.__decorate([f.property()],l.prototype,"evaluatedVisibility",null);e.__decorate([f.property()],l.prototype,"feature",void 0);e.__decorate([f.property()],l.prototype,"field",void 0);e.__decorate([f.property()],l.prototype,"initialFeature",
void 0);e.__decorate([f.property()],l.prototype,"layer",void 0);e.__decorate([f.property({aliasOf:"config.description"})],l.prototype,"description",void 0);e.__decorate([f.property()],l.prototype,"domain",null);e.__decorate([f.property()],l.prototype,"editable",null);e.__decorate([f.property({aliasOf:"config.editorType"})],l.prototype,"editorType",void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"error",void 0);e.__decorate([f.property({dependsOn:["error","messages","value"]})],l.prototype,
"errorMessage",null);e.__decorate([f.property({aliasOf:"config.format"})],l.prototype,"format",void 0);e.__decorate([f.property()],l.prototype,"group",void 0);e.__decorate([f.property({aliasOf:"config.hint"})],l.prototype,"hint",void 0);e.__decorate([f.property()],l.prototype,"includeTime",null);e.__decorate([f.property()],l.prototype,"label",null);e.__decorate([f.property()],l.prototype,"maxLength",null);e.__decorate([f.property()],l.prototype,"minLength",null);e.__decorate([f.property()],l.prototype,
"messages",void 0);e.__decorate([f.property({aliasOf:"field.name"})],l.prototype,"name",void 0);e.__decorate([f.property()],l.prototype,"required",null);e.__decorate([f.property()],l.prototype,"type",null);e.__decorate([f.property()],l.prototype,"valid",null);e.__decorate([f.property({value:null})],l.prototype,"value",null);e.__decorate([f.property()],l.prototype,"visible",null);return l=e.__decorate([b.subclass("esri.widgets.FeatureForm.InputField")],l)})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/aliasOf ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/HandleOwner".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){l=function(x){function c(m){m=x.call(this,m)||this;m.arcade=null;m.config=null;m.description=null;m.feature=null;m.label=null;m.state=null;m.visibilityExpression=null;return m}a._inheritsLoose(c,x);c.prototype._dirtyEvaluatedVisibility=function(){this.visibilityExpression&&this.notifyChange("evaluatedVisibility")};a._createClass(c,[{key:"compiledFunc",get:function(){const {arcade:m}=this;return m&&m.arcadeUtils.createFunction(this.visibilityExpression)}},{key:"evaluatedVisibility",
get:function(){const m=this.compiledFunc;if(m){var {arcade:h}=this;return h.arcadeUtils.executeFunction(m,h.arcadeUtils.createExecContext(this.feature))}}},{key:"inputFields",get:function(){return this._get("inputFields")},set:function(m){this.handles.removeAll();m&&this.handles.add(m.map(h=>h.watch("visible",this._dirtyEvaluatedVisibility)));this._set("inputFields",m)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibility&&this.inputFields&&this.inputFields.some(m=>m.visible)}}]);return c}(y.HandleOwnerMixin(D));
e.__decorate([f.property()],l.prototype,"arcade",void 0);e.__decorate([f.property()],l.prototype,"compiledFunc",null);e.__decorate([f.property()],l.prototype,"config",void 0);e.__decorate([f.property()],l.prototype,"evaluatedVisibility",null);e.__decorate([u.aliasOf("config.description")],l.prototype,"description",void 0);e.__decorate([f.property()],l.prototype,"feature",void 0);e.__decorate([f.property()],l.prototype,"inputFields",null);e.__decorate([u.aliasOf("config.label")],l.prototype,"label",
void 0);e.__decorate([u.aliasOf("config.state")],l.prototype,"state",void 0);e.__decorate([u.aliasOf("config.visibilityExpression")],l.prototype,"visibilityExpression",void 0);e.__decorate([f.property()],l.prototype,"visible",null);return l=e.__decorate([p.subclass("esri.widgets.FeatureForm.InputFieldGroup")],l)})},"esri/widgets/FeatureForm/support/formTemplateUtils":function(){define(["exports","../../../layers/support/RangeDomain","../FieldConfig","../FieldGroupConfig"],function(a,e,l,B){function d(f,
u,b,p=!0){return f.map(q=>{if("field"===q.type){{const {description:v,domain:D,editable:y,fieldName:x,hint:c,input:m,label:h,requiredExpression:g,visibilityExpression:k}=q;q=new l({description:v,domain:D,editable:y,hint:c,label:h,name:x,requiredExpression:u[g]||null,visibilityExpression:u[k]||null});if(m)if("barcode-scanner"===m.type||"text-area"===m.type||"text-box"===m.type)q.editorType=m.type,q.minLength=m.minLength,q.maxLength=m.maxLength;else if("combo-box"===m.type||"radio-buttons"===m.type)q.editorType=
m.type,q.noValueOptionLabel=m.noValueOptionLabel,q.showNoValueOption=m.showNoValueOption;else if("datetime-picker"===m.type){q.editorType=m.type;q.includeTime=m.includeTime;const {max:n,min:G}=m;if(n||G){var r="range"===(null==D?void 0:D.type)?Math.min(null==n?void 0:n.getTime(),D.maxValue):null==n?void 0:n.getTime();const C="range"===(null==D?void 0:D.type)?Math.max(null==G?void 0:G.getTime(),D.minValue):null==G?void 0:G.getTime();q.domain=new e({maxValue:r,minValue:C,name:"__internal-range-domain-based-on-datetime-picker-input__"})}}else b.push({type:"unsupported-input-type",
details:m})}return q}if("group"===q.type){if(!p)return b.push({type:"nested-group",details:q}),null;r=u[q.visibilityExpression]||null;return new B({description:q.description,state:q.initialState,fieldConfig:d(q.elements,u,b,!1),label:q.label,visibilityExpression:r})}b.push({type:"unsupported-element-type",details:q});return null}).filter(q=>!!q)}a.fieldConfigsFromFormTemplate=function(f){var u;const b={},p=[];null==(u=f.expressionInfos)?void 0:u.map(q=>b[q.name]=q.expression);return{config:d(f.elements,
b,p),encounteredUnsupportedTypes:p}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/widgetUtils","../../chunks/index"],function(a,e,l){function B(q){const {identify:r,items:v,renderIcon:D,filterText:y,onItemMouseLeave:x,onItemMouseEnter:c,onItemSelect:m}=q;return 0===v.length?l.jsx("div",{class:p.noMatchesMessage,key:"no-matches"},q.messages.noMatches):v[0].items?l.jsx("div",{class:p.scroller,key:"item-container"},
v.map(h=>u({group:h,filterText:y,identify:r,renderIcon:D,onItemMouseLeave:x,onItemMouseEnter:c,onItemSelect:m}))):l.jsx("ul",{class:e.classes(p.list,p.scroller),key:"item-container"},v.map(h=>f({item:h,identify:r,grouped:!0,onItemMouseLeave:x,onItemMouseEnter:c,onItemSelect:m,renderIcon:D,filterText:y})))}function d(q){const r=`${q.id}-placeholder`;return l.jsx("div",{class:p.filterContainer,key:"filter"},l.jsx("input",{"aria-labelledby":r,class:e.classes(p.input,p.filterInput),oninput:v=>{v=v.currentTarget;
q.onFilterChange&&q.onFilterChange(v.value)},value:q.filterText,type:"search"}),q.filterText?null:l.jsx("div",{class:p.filterPlaceholder,id:r,key:"placeholder"},l.jsx("span",{class:p.searchIcon,"aria-hidden":"true"}),l.jsx("div",{class:p.filterPlaceholderText},q.messages.filterPlaceholder)))}function f(q){const {identify:r,item:v,grouped:D,filterText:y,onItemSelect:x,onItemMouseEnter:c,onItemMouseLeave:m,renderIcon:h}=q;q=`${r&&r(v)||v.id}__${v.label}`;return l.jsx("li",{"aria-level":D?"2":"",class:p.item,
"data-item":v,key:q,onclick:g=>{g=g.currentTarget["data-item"];x&&x(g)},onmouseenter:g=>{g=g.currentTarget["data-item"];c&&c(g)},onkeydown:g=>{if("Enter"===g.key||"Space"===g.key)g=g.currentTarget["data-item"],x&&x(g)},onmouseleave:g=>{g=g.currentTarget["data-item"];m&&m(g)},tabIndex:0},l.jsx("div",{class:p.itemContainer},h&&h({item:v}),b({text:v.label,match:y})))}function u(q){const {group:r,identify:v,onItemMouseLeave:D,onItemMouseEnter:y,onItemSelect:x,filterText:c,renderIcon:m}=q;q=`${v&&v(r)||
r.id}-heading`;return l.jsx("section",{"aria-labelledby":q,class:p.group,key:r.label},l.jsx("h4",{"aria-level":"1",id:q,class:e.classes(p.groupHeader)},b({text:r.label,match:c})),l.jsx("ul",{class:p.list},r.items.map(h=>f({item:h,identify:v,grouped:!0,onItemMouseLeave:D,onItemMouseEnter:y,onItemSelect:x,renderIcon:m,filterText:c}))))}function b(q){const {match:r,text:v}=q;q=null;if(r){q=v.toLowerCase();var D=r.toLowerCase(),y=q.indexOf(D);-1===y?q=v:(q=v.substring(0,y),D=v.substr(y,r.length),y=v.substring(y+
r.length),q=l.jsx("span",null,q,l.jsx("strong",null,D),y))}else q=v;return l.jsx("span",{class:p.itemLabel},q)}const p={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group-header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",noMatchesMessage:"esri-item-list__no-matches-message",
noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",heading:"esri-widget__heading",input:"esri-input"};a.ItemList=function(q){const {id:r,identify:v,filterEnabled:D=!0,items:y,messages:x,filterText:c="",onFilterChange:m,renderIcon:h,onItemMouseLeave:g,
onItemMouseEnter:k,onItemSelect:n}=q;return l.jsx("div",{class:e.classes(p.base,p.widget)},D?d({filterText:c,messages:x,onFilterChange:m,id:r}):null,B({identify:v,items:y,messages:x,filterText:c,renderIcon:h,onItemMouseLeave:g,onItemMouseEnter:k,onItemSelect:n}))};a.renderGroup=u;a.renderItem=f;a.renderLabel=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/widgets/FeatureTemplates":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/accessorSupport/decorators/cast ../core/deprecate ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/watchUtils ../core/HandleOwner ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ../chunks/index ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G){function C(z){return z.label}const t=B.getLogger("esri.widgets.FeatureTemplates"),A={filter:!0};l=function(z){function w(E,N){E=z.call(this,E,N)||this;E._iconIntersectionObserver=new IntersectionObserver((U,S)=>{U.forEach(async I=>{if(I.isIntersecting&&(I=I.target,!I["data-has-icon"])){const L=I["data-item"];I["data-has-icon"]=!0;S.unobserve(I);await L.fetchThumbnail();I["data-item"]===L&&L.thumbnail?I.appendChild(L.thumbnail):(I["data-has-icon"]=
!1,S.observe(I))}})});E.filterFunction=null;E.filterText="";E.groupBy=null;E.label=void 0;E.layers=null;E.messages=null;E.viewModel=new n;E.visibleElements={...A};E.renderItemIcon=E.renderItemIcon.bind(a._assertThisInitialized(E));E._afterItemCreateOrUpdate=E._afterItemCreateOrUpdate.bind(a._assertThisInitialized(E));E._afterItemRemoved=E._afterItemRemoved.bind(a._assertThisInitialized(E));return E}a._inheritsLoose(w,z);var F=w.prototype;F.initialize=function(){const E=({label:N})=>!this.filterText||
-1<N.toLowerCase().indexOf(this.filterText.toLowerCase());this.own(y.init(this,"viewModel",(N,U)=>{N&&!N.filterFunction&&(this.filterFunction=E);U&&U!==N&&U.filterFunction===E&&(U.filterFunction=null)}))};F.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};F.castVisibleElements=function(E){return{...A,...E}};F.render=function(){const {filterText:E,messages:N,viewModel:{items:U,state:S}}=this,I=this.visibleElements.filter;
return g.jsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":N.widgetLabel},"loading"===S?this.renderLoader():"ready"===S?G.ItemList({id:this.id,identify:C,filterText:E,items:U,messages:{filterPlaceholder:N.filterPlaceholder,noItems:N.noItems,noMatches:N.noMatches},filterEnabled:I,onItemSelect:L=>{this.viewModel.select(L)},onFilterChange:L=>{this.filterText=L;this.viewModel.refresh()},renderIcon:this.renderItemIcon}):null)};F.renderItemIcon=function({item:E}){return g.jsx("span",
{key:"icon",class:"esri-feature-templates__list-item-icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":E,"data-has-icon":!1})};F.renderLoader=function(){return g.jsx("div",{class:"esri-feature-templates__loader",key:"loader"})};F._afterItemCreateOrUpdate=function(E){this._iconIntersectionObserver.observe(E)};F._afterItemRemoved=function(E){this._iconIntersectionObserver.unobserve(E)};a._createClass(w,[{key:"filterEnabled",
set:function(E){b.deprecatedProperty(t,"filterEnabled",{replacement:"visibleElements.filter",version:"4.15"});this.visibleElements={...this.visibleElements,filter:E}}}]);return w}(x.HandleOwnerMixin(k));e.__decorate([d.property()],l.prototype,"filterEnabled",null);e.__decorate([f.aliasOf("viewModel.filterFunction")],l.prototype,"filterFunction",void 0);e.__decorate([d.property()],l.prototype,"filterText",void 0);e.__decorate([f.aliasOf("viewModel.groupBy")],l.prototype,"groupBy",void 0);e.__decorate([d.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],l.prototype,"label",void 0);e.__decorate([f.aliasOf("viewModel.layers")],l.prototype,"layers",void 0);e.__decorate([d.property(),m.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],l.prototype,"messages",void 0);e.__decorate([d.property(),h.vmEvent("select")],l.prototype,"viewModel",void 0);e.__decorate([d.property()],l.prototype,"visibleElements",void 0);e.__decorate([u.cast("visibleElements")],l.prototype,"castVisibleElements",null);return l=e.__decorate([q.subclass("esri.widgets.FeatureTemplates")],
l)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/ObjectPool ../../core/Evented ../../core/watchUtils ../../core/HandleOwner ./TemplateItem ./TemplateItemGroup".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){const h=({layer:k})=>({key:k,label:k.title}),g=({layer:k})=>k.geometryType;l=function(k){function n(C){C=k.call(this,C)||this;C._templateToLayer=new Map;C._itemPool=new v(c);C._groupPool=new v(m);C.filterFunction=null;C.groupBy="layer";return C}a._inheritsLoose(n,k);var G=n.prototype;G.destroy=function(){this._templateToLayer.clear();this._templateToLayer=null};G.refresh=function(){this.notifyChange("items")};G.select=function(C){C=C.clone();this.emit("select",
{item:C,template:C.template})};G._getTemplatesForLayer=function(C){const t=C.templates||[];C=(C.types||[]).map(A=>A.templates).reduce((A,z)=>[...A,...z],[]);return[...t,...C]};G._createItem=function(C){const t=this._itemPool.acquire();t.set({template:C,layer:this._templateToLayer.get(C)});return t};G._createGroup=function(C,t){const A=this._groupPool.acquire();A.set("label",C);A.items=t;return A};G._destroyItems=function(C){C&&(C[0]instanceof c?C.forEach(t=>this._destroyItem(t)):C.forEach(t=>this._destroyGroup(t)))};
G._destroyGroup=function(C){C.items.forEach(t=>this._destroyItem(t));C.items.length=0;this._groupPool.release(C)};G._destroyItem=function(C){C.layer=null;C.template=null;this._itemPool.release(C)};a._createClass(n,[{key:"layers",get:function(){return this._get("layers")},set:function(C){this.handles.removeAll();if(C){const t=()=>this.notifyChange("state");this.handles.add(C.map(A=>y.when(A,"loadStatus",t)))}this._set("layers",C)}},{key:"state",get:function(){const {layers:C}=this;return C&&0!==C.length?
C.some(t=>"loading"===t.loadStatus||"not-loaded"===t.loadStatus)?"loading":"ready":"disabled"}},{key:"items",get:function(){var {layers:C}=this;this._destroyItems(this._get("items"));if(!C||0===C.length)return[];this._templateToLayer.clear();C=C.filter(({capabilities:w,loaded:F})=>F&&w.operations.supportsEditing&&w.operations.supportsAdd).map(w=>{const F=this._getTemplatesForLayer(w);if(0<F.length)return F.forEach(E=>this._templateToLayer.set(E,w)),F}).filter(w=>null!=w);const {groupBy:t}=this;if("none"===
t)return C.map(w=>w.filter(({name:F})=>!this.filterFunction||this.filterFunction({label:F}))).map(w=>w.map(F=>this._createItem(F))).reduce((w,F)=>[...w,...F],[]);C=C.reduce((w,F)=>{F.forEach(E=>{var N=("layer"===t?h:"geometry"===t?g:t)({template:E,layer:this._templateToLayer.get(E)});if(N){const U="string"===typeof N?N:N.key;N="string"===typeof N?N:N.label;w.has(U)||w.set(U,{label:N,templates:[]});w.get(U).templates.push(E)}});return w},new Map);if(0===C.size)return[];const A=[],{filterFunction:z}=
this;C.forEach(w=>{const {label:F,templates:E}=w;!z||this.filterFunction(w)?A.push(this._createGroup(F,E.map(N=>this._createItem(N)))):(w=E.filter(({name:N})=>this.filterFunction({label:N})).map(N=>this._createItem(N)),0<w.length&&A.push(this._createGroup(F,w)))});return A}}]);return n}(x.HandleOwnerMixin(D.EventedAccessor));e.__decorate([f.property()],l.prototype,"filterFunction",void 0);e.__decorate([f.property()],l.prototype,"groupBy",void 0);e.__decorate([f.property()],l.prototype,"layers",null);
e.__decorate([f.property()],l.prototype,"state",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"items",null);return l=e.__decorate([b.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],l)})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../Graphic ../../core/watchUtils ../../core/HandleOwner ../../symbols/support/symbolUtils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){function h(k){return Object.freeze({__proto__:null,"default":k})}var g;B=g=function(k){function n(C){C=k.call(this,C)||this;C._activeFetchInfo={id:null,request:null};C.description=null;C.label=null;C.layer=null;C.template=null;C.thumbnail=null;return C}e._inheritsLoose(n,k);var G=n.prototype;G.initialize=function(){this.handles.add(x.init(this,["layer.renderer","template"],()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",
null)}))};G.clone=function(){const C=this.thumbnail?this.thumbnail.cloneNode(!0):null,t=new g({layer:this.layer,template:this.template});t._set("thumbnail",C);return t};G.fetchThumbnail=async function(){const {_activeFetchInfo:C}=this;if(`${this.label}-${this.layer.id}`===C.id)return C.request;C.id=`${this.label}-${this.layer.id}`;C.request=this._getPreviewSymbol().then(async t=>{var A;if(`${this.label}-${this.layer.id}`===C.id){var z={maxSize:36};"dictionary"===(null==(A=this.layer.renderer)?void 0:
A.type)&&(z.fieldMap=this.layer.renderer.fieldMap,z.feature={attributes:this.template.prototype.attributes});t=await m.renderPreviewHTML(t,z);`${this.label}-${this.layer.id}`===C.id&&this._set("thumbnail",t)}});return C.request};G._getPreviewSymbol=async function(){const {layer:C,template:t,layer:{renderer:A}}=this;if(A){var z=new y({attributes:t.prototype.attributes});if(z=await A.getSymbolAsync(z))return z}return this._getFallbackSymbolFromGeometry(C)};G._getFallbackSymbolFromGeometry=function(C){({geometryType:C}=
C);if("point"===C||"multipoint"===C)return(new Promise(function(t,A){a(["../../symbols/SimpleMarkerSymbol"],function(z){t(h(z))},A)})).then(t=>new t.default);if("polyline"===C)return(new Promise(function(t,A){a(["../../symbols/SimpleLineSymbol"],function(z){t(h(z))},A)})).then(t=>new t.default);if("polygon"===C||"mesh"===C||"multipatch"===C)return(new Promise(function(t,A){a(["../../symbols/SimpleFillSymbol"],function(z){t(h(z))},A)})).then(t=>new t.default)};return n}(c.HandleOwnerMixin(D));l.__decorate([u.property({aliasOf:"template.description"})],
B.prototype,"description",void 0);l.__decorate([u.property({aliasOf:"template.name"})],B.prototype,"label",void 0);l.__decorate([u.property()],B.prototype,"layer",void 0);l.__decorate([u.property()],B.prototype,"template",void 0);l.__decorate([u.property({readOnly:!0})],B.prototype,"thumbnail",void 0);return B=g=l.__decorate([p.subclass("esri.widgets.FeatureTemplates.TemplateItem")],B)})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/Identifiable".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D){l=function(y){function x(c){c=y.call(this,c)||this;c.items=null;c.label=null;return c}a._inheritsLoose(x,y);return x}(D.IdentifiableMixin(v));e.__decorate([f.property()],l.prototype,"items",void 0);e.__decorate([f.property()],l.prototype,"label",void 0);return l=e.__decorate([b.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],l)})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/aliasOf ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Evented ../../core/Collection ../../core/watchUtils ../../core/HandleOwner ../../layers/GraphicsLayer ../Attachments/AttachmentsViewModel ../Spinner/SpinnerViewModel ../../views/interactive/snapping/SnappingOptions ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../../layers/graphics/editingSupport ./CreateWorkflow ./UpdateWorkflow ../Sketch/SketchViewModel".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z,w){function F(I,L,M){U.error(new q(I,L,M))}function E(I){return I&&t.isEditableLayer(I.layer)}function N(I,L){return I&&I.find(M=>M.layer===L)}const U=B.getLogger("esri.widgets.Editor.EditorViewModel"),S=["create","update"];l=function(I){function L(K){K=I.call(this,K)||this;K._sketchGraphicsLayer=new h({listMode:"hide",internal:!0});K.activeWorkflow=null;K.activityQueue=[];K.failures=[];K.attachmentsViewModel=new g({abilities:{editing:!0}});
K.featureFormViewModel=new G;K.featureTemplatesViewModel=new C;K.layerInfos=null;K.sketchViewModel=new w({layer:K._sketchGraphicsLayer});K.snappingOptions=new n;K.spinnerViewModel=new k;return K}a._inheritsLoose(L,I);var M=L.prototype;M.initialize=function(){this.handles.add([c.on(this,"activeWorkflow","cancel",()=>this.emit("workflow-cancel")),c.on(this,"activeWorkflow","commit",()=>this.emit("workflow-commit")),c.on(this,"view.allLayerViews","change",()=>{this.handles.remove("all-layer-views-prop-watcher");
this.notifyChange("editableItems")}),c.watch(this,"editableItems",()=>{const {activeWorkflow:K}=this;if(K){var {stepId:P}=K;"create"===K.type?(this.refreshCreationTemplates(),"awaiting-feature-creation-info"!==P||this.canCreate||this._cancelWorkflow()):"update"===K.type&&("awaiting-feature-to-update"===P&&!this.canUpdate||"awaiting-update-feature-candidate"===P&&!K.data.candidates.some(Q=>{const R=this.editableItems.find(Y=>Y.layer===Q.layer);return R&&-1<R.supports.indexOf("update")}))&&this._cancelWorkflow()}})])};
M.destroy=function(){this._cancelWorkflow().then(()=>this.view=null)};M.startCreateWorkflowAtFeatureTypeSelection=async function(){if(this.canCreate){await this._cancelWorkflow();var K=this._createCreateWorkflow();await K.start();this._set("activeWorkflow",K)}else F("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};M.startCreateWorkflowAtFeatureCreation=async function(K){if(this.canCreate){await this._cancelWorkflow();var P=this._createCreateWorkflow("awaiting-feature-to-create");
P.data.creationInfo=K;await P.start();this._set("activeWorkflow",P)}else F("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};M.startCreateWorkflowAtFeatureEdit=async function(K){if(this.canCreate){await this._cancelWorkflow();var P=this._createCreateWorkflow("editing-new-feature");P.data.edits.feature=K;await P.start();this._set("activeWorkflow",P)}else F("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};M.startUpdateWorkflowAtFeatureSelection=
async function(){if(this.canUpdate){await this._cancelWorkflow();var K=this._createUpdateWorkflow();await K.start();this._set("activeWorkflow",K)}else F("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};M.startUpdateWorkflowAtMultipleFeatureSelection=async function(K){if(this.canUpdate){await this._cancelWorkflow();var P=this._createUpdateWorkflow("awaiting-update-feature-candidate");P.data.candidates=K;await P.start();this._set("activeWorkflow",P)}else F("editing:unsupported-workflow",
"Update workflow is unsupported or disabled.")};M.startUpdateWorkflowAtFeatureEdit=async function(K){if(this.canUpdate){await this._cancelWorkflow();var P=this._createUpdateWorkflow("editing-existing-feature");P.data.edits.feature=K;await P.start();this._set("activeWorkflow",P)}else F("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};M.deleteFeatureFromWorkflow=async function(){const {activeWorkflow:K}=this;K&&"create"!==K.type?(await this._delete(K.data.edits.feature),
await K.reset()):F("editing:unsupported-workflow","Deleting requires an active update workflow.")};M.cancelWorkflow=async function(K){return this._cancelWorkflow({warn:!0,...K})};M.refreshCreationTemplates=function(){this.featureTemplatesViewModel.layers=this.editableItems.filter(({supports:K})=>-1<K.indexOf("create")).map(({layer:K})=>K).toArray()};M._cancelWorkflow=async function(K){const P=this.activeWorkflow;P?K&&!1===K.force?(await P.cancel(K),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),
this._set("activeWorkflow",null),await P.cancel(K)):K&&K.warn&&F("editing:no-active-workflow","There is no active workflow to cancel.")};M._createCreateWorkflow=function(K){return A.create(this,K,P=>this._create(P))};M._createUpdateWorkflow=function(K){return z.create(this,K,P=>this._update(P))};M._create=async function(K){await this._applyEdits(K.layer,{addFeatures:[K]})};M._delete=async function(K){await this._applyEdits(K.layer,{deleteFeatures:[K]})};M._update=async function(K){await this._applyEdits(K.layer,
{updateFeatures:[K]})};M._applyEdits=async function(K,P){await this._queueOperation(()=>K.applyEdits(P));const Q=await this.view.whenLayerView(K);await c.whenFalseOnce(Q,"updating")};M._queueOperation=function(K){this.activityQueue.push(K);this.notifyChange("syncing");const P=(Q,R)=>{Q=R.indexOf(Q);-1<Q&&R.splice(Q,1)};return K().then(({addFeatureResults:Q,deleteFeatureResults:R,updateFeatureResults:Y})=>{if(Q=Q.find(T=>!!T.error)||Y.find(T=>!!T.error)||R.find(T=>!!T.error))throw Q.error;}).catch(Q=>
{F("editing:operation-error","An error occurred.",{error:Q});const R={error:Q,retry:()=>{P(R,this.failures);return this._queueOperation(K)},cancel:()=>{P(R,this.failures)}};this._set("failures",[...this.failures,R])}).then(()=>{P(K,this.activityQueue);this.notifyChange("syncing")})};a._createClass(L,[{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(K){K&&0!==K.length||(K=[...S]);this._set("allowedWorkflows",K)}},{key:"canCreate",get:function(){return this.editableItems.some(K=>
-1<K.supports.indexOf("create"))}},{key:"canUpdate",get:function(){return this.editableItems.some(K=>-1<K.supports.indexOf("update"))}},{key:"editableItems",get:function(){const K=this.get("view.allLayerViews");if(!K)return new x;const P=()=>this.notifyChange("editableItems");return K.filter(E).map(Q=>{this.handles.add(c.watch(Q,["suspended","layer.editingEnabled"],P),"all-layer-views-prop-watcher");const {layer:R,suspended:Y}=Q,{data:T,operations:V}=R.capabilities,W=N(this.layerInfos,R);Q="supportsAttachment"in
T&&T.supportsAttachment&&(!W||!1!==W.allowAttachments);if(Y)return{hasAttachments:Q,layer:R,supports:[]};const X=this.allowedWorkflows.filter(H=>W?!1!==W.enabled&&("create"===H&&!1!==W.addEnabled||"update"===H&&!1!==W.updateEnabled):!0),oa=H=>X.find(J=>J===H),ua=[];oa("create")&&V.supportsAdd&&ua.push("create");oa("update")&&V.supportsUpdate&&ua.push("update");!1!==(W&&W.deleteEnabled)&&V.supportsDelete&&ua.push("delete");return{hasAttachments:Q,layer:R,supports:ua}}).reverse()}},{key:"state",get:function(){if(!this.get("view.ready")||
0===this.editableItems.length)return"disabled";var K=this.attachmentsViewModel.mode;if("add"===K)return"adding-attachment";if("edit"===K)return"editing-attachment";({activeWorkflow:K}=this);return K?K.stepId:"ready"}},{key:"syncing",get:function(){return 0<this.activityQueue.length}},{key:"view",set:function(K){this.sketchViewModel.view=K;this.spinnerViewModel.view=K;this._set("view",K)}}]);return L}(m.HandleOwnerMixin(y.EventedAccessor));e.__decorate([f.property({readOnly:!0})],l.prototype,"activeWorkflow",
void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"activityQueue",void 0);e.__decorate([f.property({value:[...S]})],l.prototype,"allowedWorkflows",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"canCreate",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"canUpdate",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"editableItems",null);e.__decorate([f.property({readOnly:!0})],l.prototype,"failures",void 0);e.__decorate([f.property()],l.prototype,"attachmentsViewModel",
void 0);e.__decorate([f.property()],l.prototype,"featureFormViewModel",void 0);e.__decorate([f.property()],l.prototype,"featureTemplatesViewModel",void 0);e.__decorate([f.property()],l.prototype,"layerInfos",void 0);e.__decorate([f.property()],l.prototype,"sketchViewModel",void 0);e.__decorate([u.aliasOf("sketchViewModel.snappingOptions")],l.prototype,"snappingOptions",void 0);e.__decorate([f.property()],l.prototype,"spinnerViewModel",void 0);e.__decorate([f.property()],l.prototype,"state",null);
e.__decorate([f.property({readOnly:!0})],l.prototype,"syncing",null);e.__decorate([f.property()],l.prototype,"view",null);return l=e.__decorate([p.subclass("esri.widgets.Editor.EditorViewModel")],l)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ./Layer ../symbols/support/ElevationInfo ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){l=function(m){function h(k){k=m.call(this,k)||this;k.elevationInfo=null;k.graphics=new c["default"];k.screenSizePerspectiveEnabled=!0;k.type="graphics";k.internal=!1;return k}a._inheritsLoose(h,m);var g=h.prototype;g.destroy=function(){this.removeAll();this.graphics.destroy()};g.add=function(k){this.graphics.add(k);return this};g.addMany=function(k){this.graphics.addMany(k);return this};g.removeAll=function(){this.graphics.removeAll();return this};g.remove=
function(k){this.graphics.remove(k)};g.removeMany=function(k){this.graphics.removeMany(k)};g.on=function(k,n){return m.prototype.on.call(this,k,n)};g.graphicChanged=function(k){this.emit("graphic-update",k)};return h}(y.BlendLayer(x.ScaleRangeLayer(v)));e.__decorate([f.property({type:D})],l.prototype,"elevationInfo",void 0);e.__decorate([f.property(c.graphicsCollectionProperty())],l.prototype,"graphics",void 0);e.__decorate([f.property({type:["show","hide"]})],l.prototype,"listMode",void 0);e.__decorate([f.property()],
l.prototype,"screenSizePerspectiveEnabled",void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"type",void 0);e.__decorate([f.property({constructOnly:!0})],l.prototype,"internal",void 0);return l=e.__decorate([b.subclass("esri.layers.GraphicsLayer")],l)})},"esri/layers/graphics/editingSupport":function(){define("exports ../../core/lang ../../core/maybe ../../core/Error ../../core/urlUtils ../../core/Collection ../../Graphic ../../geometry/support/normalizeUtils".split(" "),function(a,e,l,
B,d,f,u,b){async function p(x,c,m,h){await x.load();if(!c||null==c.applyEdits)return Promise.reject(new B(`${x.type}-layer:no-editing-support`,"Layer source does not support applyEdits capability",{layer:x}));if(!x.editingEnabled)throw new B(`${x.type}-layer:editing-disabled`,"Editing is disabled for layer",{layer:x});x=await q(x,m,h);return x.addFeatures.length||x.updateFeatures.length||x.deleteFeatures.length||x.addAttachments.length||x.updateAttachments.length||x.deleteAttachments.length?{edits:x,
results:await c.applyEdits(x,h)}:{edits:x,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}function q(x,c,m){var h=c&&(c.addFeatures||c.updateFeatures||c.deleteFeatures);const g=c&&(c.addAttachments||c.updateAttachments||c.deleteAttachments);if(!c||!h&&!g)throw new B(`${x.type}-layer:missing-parameters`,"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");
if(!x.capabilities.data.isVersioned&&m&&m.gdbVersion)throw new B(`${x.type}-layer:invalid-parameter`,"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");if(!x.capabilities.editing.supportsRollbackOnFailure&&m&&m.rollbackOnFailureEnabled)throw new B(`${x.type}-layer:invalid-parameter`,"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");if(!x.capabilities.editing.supportsGlobalId&&
m&&m.globalIdUsed)throw new B(`${x.type}-layer:invalid-parameter`,"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");if(!x.capabilities.editing.supportsGlobalId&&g)throw new B(`${x.type}-layer:invalid-parameter`,"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");if((!m||!m.globalIdUsed)&&g)throw new B(`${x.type}-layer:invalid-parameter`,
"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");h={...c};h.addFeatures=c&&f.isCollection(c.addFeatures)?c.addFeatures.toArray():h.addFeatures||[];h.updateFeatures=c&&f.isCollection(c.updateFeatures)?c.updateFeatures.toArray():h.updateFeatures||[];h.deleteFeatures=c&&f.isCollection(c.deleteFeatures)?c.deleteFeatures.toArray():h.deleteFeatures||[];if(h.addFeatures.length&&!x.capabilities.operations.supportsAdd)throw new B(`${x.type}-layer:unsupported-operation`,
"Layer does not support adding features.");if(h.updateFeatures.length&&!x.capabilities.operations.supportsUpdate)throw new B(`${x.type}-layer:unsupported-operation`,"Layer does not support updating features.");if(h.deleteFeatures.length&&!x.capabilities.operations.supportsDelete)throw new B(`${x.type}-layer:unsupported-operation`,"Layer does not support deleting features.");h.addAttachments=h.addAttachments||[];h.updateAttachments=h.updateAttachments||[];h.deleteAttachments=h.deleteAttachments||[];
h.addFeatures=h.addFeatures.map(y);h.updateFeatures=h.updateFeatures.map(y);const k=m&&m.globalIdUsed;h.addFeatures.forEach(n=>{r(n,x,k)});h.updateFeatures.forEach(n=>{r(n,x,k);if("geometry"in n&&l.isSome(n.geometry)&&!x.capabilities.editing.supportsGeometryUpdate)throw new B(`${x.type}-layer:unsupported-operation`,"Layer does not support geometry updates.");});h.deleteFeatures.forEach(n=>{r(n,x,k)});h.addAttachments.forEach(n=>v(n,x));h.updateAttachments.forEach(n=>v(n,x));return D(h)}function r(x,
c,m){if(m){if("attributes"in x&&!x.attributes[c.globalIdField])throw new B(`${c.type}-layer:invalid-parameter`,"Feature should have 'globalId' when 'globalIdUsed' is true");if(!("attributes"in x||x.globalId))throw new B(`${c.type}-layer:invalid-parameter`,"'globalId' of the feature should be passed when 'globalIdUsed' is true");}if("geometry"in x&&l.isSome(x.geometry)){if(x.geometry.hasZ&&!1===c.capabilities.data.supportsZ)throw new B(`${c.type}-layer:z-unsupported`,"Layer does not support z values while feature has z values.");
if(x.geometry.hasM&&!1===c.capabilities.data.supportsM)throw new B(`${c.type}-layer:m-unsupported`,"Layer does not support m values while feature has m values.");}}function v(x,c){const {feature:m,attachment:h}=x;if(!m||"attributes"in m&&!m.attributes[c.globalIdField])throw new B(`${c.type}-layer:invalid-parameter`,"Attachment should have reference to a feature with 'globalId'");if(!("attributes"in m||m.globalId))throw new B(`${c.type}-layer:invalid-parameter`,"Attachment should have reference to 'globalId' of the parent feature");
if(!h.globalId)throw new B(`${c.type}-layer:invalid-parameter`,"Attachment should have 'globalId'");if(!h.data&&!h.uploadId)throw new B(`${c.type}-layer:invalid-parameter`,"Attachment should have 'data' or 'uploadId'");if(!(h.data instanceof File&&h.data.name||h.name))throw new B(`${c.type}-layer:invalid-parameter`,"'name' is required when attachment is specified as Base64 encoded string using 'data'");if(!c.capabilities.editing.supportsUploadWithItemId&&h.uploadId)throw new B(`${c.type}-layer:invalid-parameter`,
"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"===typeof h.data&&(x=d.dataComponents(h.data))&&!x.isBase64)throw new B(`${c.type}-layer:invalid-parameter`,"Attachment 'data' should be a Blob, File or Base64 encoded string");}async function D(x){var c=x.addFeatures,m=x.updateFeatures,h=c.concat(m).map(g=>g.geometry);h=await b.normalizeCentralMeridian(h);c=c.length;m=m.length;h.slice(0,c).forEach((g,k)=>{x.addFeatures[k].geometry=
g});h.slice(c,c+m).forEach((g,k)=>{x.updateFeatures[k].geometry=g});return x}function y(x){const c=new u;x.attributes||(x.attributes={});c.geometry=x.geometry;c.attributes=x.attributes;return c}a.applyEdits=async function(x,c,m,h){let g,k;const n={edits:m,result:new Promise((G,C)=>{g=G;k=C})};x.emit("apply-edits",n);try{const {results:G,edits:C}=await p(x,c,m,h);c=A=>A.filter(z=>!z.error).map(e.clone);const t={edits:C,addedFeatures:c(G.addFeatureResults),updatedFeatures:c(G.updateFeatureResults),
deletedFeatures:c(G.deleteFeatureResults),addedAttachments:c(G.addAttachmentResults),updatedAttachments:c(G.updateAttachmentResults),deletedAttachments:c(G.deleteAttachmentResults)};(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length)&&x.emit("edits",t);g(t);return G}catch(G){throw k(G),G;}};a.isEditableLayer=function(x){var c,m;return!0===(null==x?void 0:null==(c=x.capabilities)?void 0:null==
(m=c.operations)?void 0:m.supportsEditing)&&x&&(!("editingEnabled"in x)||x.editingEnabled)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){function m(g){if(1!==g.length)return null;[g]=g;if("items"in g){if(1===g.items.length)return g.items[0]}else return g;return null}var h;l=h=function(g){function k(n){n=g.call(this,n)||this;n.type="create";return n}a._inheritsLoose(k,g);k.create=function(n,G,C){n=new D({edits:new y,viewModel:n});C=new h({data:n,afterCommit:C});C._set("steps",this._createWorkflowSteps(C,G));return C};k._createWorkflowSteps=function(n,G="awaiting-feature-creation-info"){const {data:C,
handles:t}=n,A={"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){C.creationInfo=null;C.edits.feature=null;t.add(C.viewModel.featureTemplatesViewModel.on("select",({item:E})=>{C.creationInfo={layer:E.layer,template:E.template};C.viewModel.activeWorkflow.next()}),this.id)},async tearDown(){t.remove(this.id)}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",async setUp(){t.add(await c.setUpFeatureAdd(C.viewModel.sketchViewModel,C.creationInfo,
C.viewModel.view,E=>{C.edits.feature=E;C.viewModel.activeWorkflow.next()}),this.id)},async tearDown(){t.remove(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){const E=C.edits.feature,N=C.viewModel,U=c.findLayerInfo(N.layerInfos,E.layer);N.featureFormViewModel.set({feature:E,fieldConfig:U&&U.fieldConfig});const S=c.getVisualVariableAttributes(E),{interactive:I,visual:L}=await c.setUpGeometryUpdate(E,S,N.sketchViewModel,N.view,({geometry:M,attributes:K})=>{if(B.isSome(S.rotation)){var {field:P}=
S.rotation;N.featureFormViewModel.setValue(P,K[P])}B.isSome(S.size)&&({field:P}=S.size,N.featureFormViewModel.setValue(P,K[P]));C.edits.updateAttributes(K);C.edits.updateGeometry(M)});t.add([C.viewModel.featureFormViewModel.on("value-change",()=>{C.edits.updateAttributes(C.viewModel.featureFormViewModel.getValues());E.attributes=C.edits.feature.attributes}),I,L],this.id)},async tearDown(){t.remove(this.id)}})};let z=!1;n=["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature"].filter(E=>
z?!0:z=E===G).map(E=>A[E]());C.viewModel.refreshCreationTemplates();const w=m(C.viewModel.featureTemplatesViewModel.items),[F]=n;if("awaiting-feature-creation-info"===F.id&&w){const {layer:E,template:N}=w;C.creationInfo={layer:E,template:N};n.shift()}return n};return k}(x);return l=h=e.__decorate([p.subclass("esri.widgets.Editor.CreateWorkflow")],l)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){l=function(D){function y(x){x=D.call(this,x)||this;x.creationInfo=null;x.edits=null;x.viewModel=null;return x}a._inheritsLoose(y,D);return y}(v);e.__decorate([f.property()],l.prototype,"creationInfo",void 0);e.__decorate([f.property()],l.prototype,"edits",void 0);e.__decorate([f.property()],l.prototype,"viewModel",void 0);return l=e.__decorate([b.subclass("esri.widgets.Editor.CreateWorkflowData")],l)})},"esri/widgets/Editor/Edits":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/HandleOwner".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){function x(c){return B.isNone(c)?null:JSON.stringify(c)}l=function(c){function m(g){g=c.call(this,g)||this;g._baselineAttributesJSON=null;g._baselineGeometryJSON=null;g.feature=null;return g}a._inheritsLoose(m,c);var h=m.prototype;h.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=x(this.feature.attributes),this._baselineGeometryJSON=x(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};h.updateAttributes=
function(g){this.feature.attributes=g;this.notifyChange("attributesModified")};h.updateGeometry=function(g){this.feature.geometry=g;this.notifyChange("geometryModified")};a._createClass(m,[{key:"attributesModified",get:function(){const {_baselineAttributesJSON:g,feature:k}=this;return!(!k||g===x(k.attributes))}},{key:"geometryModified",get:function(){const {_baselineGeometryJSON:g,feature:k}=this;return!(!k||g===x(k.geometry))}},{key:"modified",get:function(){return this.attributesModified||this.geometryModified}}]);
return m}(y.HandleOwnerMixin(D));e.__decorate([u.property()],l.prototype,"attributesModified",null);e.__decorate([u.property()],l.prototype,"feature",void 0);e.__decorate([u.property()],l.prototype,"geometryModified",null);e.__decorate([u.property()],l.prototype,"modified",null);return l=e.__decorate([p.subclass("esri.widgets.Editor.Edits")],l)})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Evented ../../core/HandleOwner".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){l=function(x){function c(h){h=x.call(this,h)||this;h._indexHistory=[];h._lastStepIndex=-1;h._stepIndex=-1;h._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};h.data=null;h.started=!1;h.steps=null;h.type=null;return h}a._inheritsLoose(c,x);var m=c.prototype;m.cancel=async function(h={force:!0}){return!1!==h.force?this._cancel():new Promise((g,k)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(g)},deny:()=>k(new p("workflow:cancel-denied",
"Request to cancel workflow was denied."))}})})};m.commit=async function(){const {data:h}=this;this.handles.remove(this._handleKeys.beforeCommit);const g=h.edits.feature,k=g.clone();if(!h.edits.attributesModified){const {objectIdField:n}=g.layer;k.attributes={[n]:g.getAttribute(n)}}h.edits.geometryModified||(k.geometry=null);await this.afterCommit(k);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit");this.started&&await this.reset()};m.go=async function(h){var {steps:g}=this;g=
g.findIndex(k=>k.id===h);this._indexHistory.push(this._stepIndex);await this._go(g)};m.next=async function(){this._indexHistory.push(this._stepIndex);await this._go(this._stepIndex+1)};m.previous=async function(){await this._go(this._indexHistory.pop())};m.reset=async function(){await this._cancel(!1);await this.start()};m.start=async function(){this._set("started",!0);await this._go(-1===this._stepIndex?0:this._stepIndex)};m._cancel=async function(h=!0){this.started&&(this._set("started",!1),await this.steps[this._stepIndex].tearDown());
this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]);this._resetIndexing(h);h&&this.emit("cancel")};m._go=async function(h=-1){-1>=h||h>=this.steps.length||(this.started&&(-1<this._lastStepIndex&&await this.steps[this._lastStepIndex].tearDown(),await this.steps[h].setUp(),this._lastStepIndex=h),this._stepIndex=h,this._notifyStepProps())};m._resetIndexing=function(h=!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;h&&this._notifyStepProps()};m._notifyStepProps=
function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};a._createClass(c,[{key:"hasNextStep",get:function(){const {steps:h}=this;return!!(h&&this._stepIndex<h.filter(g=>!g.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"stepId",get:function(){var {steps:h}=this;return(h=h&&h[this._stepIndex])&&h.id}}]);return c}(y.HandleOwnerMixin(D.EventedAccessor));e.__decorate([f.property()],l.prototype,"afterCommit",
void 0);e.__decorate([f.property()],l.prototype,"data",void 0);e.__decorate([f.property()],l.prototype,"hasNextStep",null);e.__decorate([f.property()],l.prototype,"hasPreviousStep",null);e.__decorate([f.property()],l.prototype,"started",void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"stepId",null);e.__decorate([f.property()],l.prototype,"steps",void 0);e.__decorate([f.property()],l.prototype,"type",void 0);e.__decorate([f.property()],l.prototype,"commit",null);return l=e.__decorate([b.subclass("esri.widgets.Editor.Workflow")],
l)})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../core/has ../../core/maybe ../../core/promiseUtils ../../layers/support/fieldUtils ../../core/screenUtils ../../Graphic ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../core/accessorSupport/diffUtils ../../symbols/support/symbolUtils ../../views/support/hitTestSelectUtils ../../renderers/support/clickToleranceUtils ../../views/support/drapedUtils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){function h(E){const N=E.layer;a:switch(N.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":var U=!0;break a;default:U=!1}var S=(E=U&&r.getVisualVariableValues(N.renderer,E))?E.map(L=>L.variable):[];U=S.filter(L=>"rotation"===L.type&&(!L.axis||"heading"===L.axis));E=U[0];U=1===U.length&&E.field&&!E.valueExpression;var I=S.filter(L=>"size"===L.type);S=I[0];I=1===I.length&&"real-world-size"===p.getTransformationType(S)&&
S.field&&!S.useSymbolValue&&!S.valueExpression;return{rotation:U?g(E,N):null,size:I?G(S,N):null}}function g(E,N){const U="heading"===(E.axis||"heading")&&"arithmetic"===E.rotationType?-1:1,S=E.field,I=(E=N.fields&&N.fields.filter(K=>K.name===S))&&1===E.length?E[0].type:"double";var L=0,M=0;return{field:S,getDefault:()=>Promise.resolve(0),getValue:K=>{M=L-U*K;return C((M+360)%360,I)},initValue:K=>{L=null!=K?K:M;M=0},isUpdatingInteractively:!1}}function k(E,N){switch(N){case "width":return E[0];case "depth":return E[1];
case "height":return E[2];default:return E[2]||E[1]||E[0]}}async function n(E,N,U){if(B.isNone(N))return 0;({symbol:N}=v.to3D(N));if(B.isNone(N)||"web-style"===N.type)return 0;N=N.symbolLayers.getItemAt(0);if(!N)return 0;switch(N.type){case "icon":return{computeIconLayerResourceSize:U}=await new Promise(function(S,I){a(["../../symbols/support/symbolLayerUtils"],S,I)}),N.size||Math.min(F.icon,(await U(N,F.icon))[0])||F.icon;case "text":return N.size||F.text;case "line":return N.size||F.line;case "object":{const {computeObjectLayerResourceSize:S}=
await new Promise(function(I,L){a(["../../symbols/support/symbolLayerUtils"],I,L)});E=await S(N,E.scale/F.viewScaleSizeFactor);return k(E,U)}case "path":case "extrude":return N.size||E.scale/F.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}}function G(E,N){const U=E.field,S=E.axis,I=(N=N.fields&&N.fields.filter(Q=>Q.name===U))&&1===N.length?N[0].type:"double";var L=0,M=0;const K=q.meterIn[E.valueUnit];let P;P="area"===E.valueRepresentation?Q=>(Q*K/2)**2*Math.PI:"radius"===
E.valueRepresentation||"distance"===E.valueRepresentation?Q=>Q*K/2:Q=>Q*K;return{field:U,getDefault:async(Q,R)=>C(P(await n(R,Q,S)),I),getValue:(Q,R)=>{L||(L=R.pixelSizeAt(R.center));M=L*Q;return C(M,I)},initValue:Q=>{L=null!=Q?Q:M;M=0},isUpdatingInteractively:!1}}function C(E,N){switch(N){case "small-integer":case "integer":case "long":return Math.round(E);case "double":case "single":return E;default:return 0}}async function t(E){const N=await y.getDisplayedSymbol(E,{ignoreGraphicSymbol:!0}),U=D.diff(E.symbol,
N);B.isSome(U)&&(E.symbol=N)}async function A(E,N,U){var S;if("3d"===U.type){var I=N.layer;N={...N.template.prototype.attributes};I=new b({layer:I,sourceLayer:I,attributes:N});var {rotation:L,size:M}=h(I),K=await y.getDisplayedSymbol(I),P=!1;for(const Q of[M,L])B.isNone(Q)||null!=N[Q.field]||(N[Q.field]=await Q.getDefault(K,U),P=!0);P&&(K=await y.getDisplayedSymbol(I));switch(null==(S=K)?void 0:S.type){case "simple-fill":case "polygon-3d":E.polygonSymbol=K;break;case "simple-line":case "line-3d":E.polylineSymbol=
K;break;case "simple-marker":case "point-3d":E.pointSymbol=K}}}async function z(E,N,U,S){if(0===E.length)return[];const {updatable:I,graphicsByLayer:L}=await U.async(async()=>{var {results:M}=await d.whenOrAbort(x.hitTestSelectSameDistance(N,U),S);const K=new Map,P=({layer:Q})=>{var R=K.get(Q);return R?R:(R=[],K.set(Q,R),R)};M.forEach(({graphic:Q})=>P(Q).push(Q));M=E.filter(({supports:Q,layer:R})=>-1<Q.indexOf("update")&&K.has(R));0!==M.length&&U.stopPropagation();return{updatable:M,graphicsByLayer:K}});
return d.whenOrAbort(d.eachAlways(I.map(async({layer:M})=>{const {objectIdField:K,displayField:P}=M,Q=[K];f.hasField(M.fields,P)&&Q.push(P);const R=L.get(M);if(R.some(Y=>Q.some(T=>!(T in Y.attributes)))){const Y=M.createQuery();Y.outFields=Q;Y.returnGeometry=!1;Y.objectIds=R.map(T=>T.getObjectId());return M.queryFeatures(Y,{signal:S}).then(({features:T})=>T)}return R})),S)}async function w(E,N,U,S){if(0===E.length)return[];const I=await U.async(async()=>{var {results:L}=await d.whenOrAbort(N.hitTest(U),
S);if(0===L.length)return[];const M=new Set;L.forEach(({graphic:K})=>M.add(K.layer));L=E.items.filter(({layer:K,supports:P})=>-1<P.indexOf("update")&&M.has(K));0<L.length&&U.stopPropagation();return L});return d.whenOrAbort(d.eachAlways(I.map(({layer:L})=>{const {objectIdField:M,displayField:K}=L;var P=[M];f.hasField(L.fields,K)&&P.push(K);const Q=L.createQuery();Q.outFields=P;Q.returnGeometry=!1;P=c.calculateTolerance({renderer:L.renderer,event:U});Q.geometry=m.createQueryGeometry(U.mapPoint,P,N);
Q.outSpatialReference=N.spatialReference;return L.queryFeatures(Q,{signal:S}).then(({features:R})=>R)})),S)}const F={icon:u.px2pt(24),text:u.px2pt(12),line:u.px2pt(1),viewScaleSizeFactor:100};e.fetchCandidates=async function(E,N,U,S){switch(N.type){case "3d":return z(E,N,U,S);case "2d":return w(E,N,U,S)}};e.fetchFullFeature=async function(E,N,U){const S=E.layer,I=S.createQuery();I.objectIds=[E.getAttribute(S.objectIdField)];I.outFields=["*"];I.outSpatialReference=N.spatialReference;I.returnM=S.capabilities.data.supportsM;
I.returnZ=S.capabilities.data.supportsZ;return(await S.queryFeatures(I,{signal:U})).features[0]};e.findLayerInfo=function(E,N){return E&&E.find(U=>U.layer===N)};e.getVisualVariableAttributes=h;e.setUpFeatureAdd=async function(E,N,U,S){const I=N.layer;await A(E,N,U);E.layer.elevationInfo=I.elevationInfo;await E.create(I.geometryType,{hasZ:I.capabilities.data.supportsZ});const L=E.on("create",async M=>{const {state:K,graphic:P}=M;"cancel"===K?E.create(I.geometryType,{hasZ:I.capabilities.data.supportsZ}):
"complete"===K&&(M=P.clone(),M.attributes={...N.template.prototype.attributes},M.layer=I,E.layer.remove(P),await t(M),S(M))});U.map.add(E.layer);return{remove:()=>{L.remove();U.map.remove(E.layer);E.cancel()}}};e.setUpGeometryUpdate=async function(E,N,U,S,I){const L=E.clone();await t(L);U.layer.add(L);L.sourceLayer=E.layer;const M=(()=>{const {layer:X}=E;if("graphics"===X.type)return{remove(){}};const {objectIdField:oa}=X,ua=E.attributes[oa],H=S.whenLayerView(X);H.then(J=>J.setVisibility(ua,!1),()=>
{});return{remove(){H.then(J=>J.setVisibility(ua,!0),()=>{})}}})(),K=E.layer,P=N.size,Q=N.rotation,R={multipleSelectionEnabled:!1};"point"===K.geometryType&&(R.enableRotation=!!Q,R.enableScaling=!!P);U.layer.elevationInfo=K.elevationInfo;U.update(L,R);const Y=(B.isSome(P)||B.isSome(Q))&&E.watch("attributes",async X=>{let oa=!1;for(const ua in X){const H=X[ua];H!==L.attributes[ua]&&(L.setAttribute(ua,H),oa=!0,B.isSome(P)&&!P.isUpdatingInteractively&&P.field===ua&&P.initValue(H),B.isSome(Q)&&!Q.isUpdatingInteractively&&
Q.field===ua&&Q.initValue(H))}oa&&"3d"===S.type&&await t(L)});[Q,P].forEach(async X=>{if(!B.isNone(X)){var oa=E.attributes[X.field];null!=oa?X.initValue(oa):(oa=await X.getDefault(L.symbol,S),X.initValue(oa),L.setAttribute(X.field,oa),"3d"===S.type&&await t(L))}});const T=U.on("update",async X=>{const {graphics:[oa],state:ua,toolEventInfo:H}=X;if("complete"===ua)U.update(oa,R);else{if(B.isSome(Q)&&H){const {field:J,getValue:aa,initValue:fa}=Q;"rotate-stop"===H.type?(Q.isUpdatingInteractively=!1,fa()):
null!=H.angle&&(Q.isUpdatingInteractively=!0,L.attributes[J]=aa(H.angle,S))}if(B.isSome(P)&&H){const {field:J,getValue:aa,initValue:fa}=P;"scale-stop"===H.type?(P.isUpdatingInteractively=!1,fa()):null!=H.xScale&&(P.isUpdatingInteractively=!0,L.attributes[J]=aa(H.xScale,S))}"3d"===S.type&&await t(L);I(oa.clone())}}),V=U.on(["undo","redo"],async X=>{({graphics:[X]}=X);I(X.clone())});S.map.add(U.layer);const W=()=>{};return{interactive:{remove(){V.remove();T.remove();U.cancel();Y&&Y.remove();this.remove=
W}},visual:{remove(){M.remove();S.map.remove(U.layer);U.layer.removeAll();this.remove=W}}}};e.sizeDefaults=F;Object.defineProperty(e,"__esModule",{value:!0})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],function(a){a.hitTestSelectSameDistance=async function(e,l){if("2d"===e.type)return e.hitTest(l);e=await e.hitTest(l);const B=e.results[0];l=e.results.findIndex(d=>d.distance!==B.distance);-1!==l&&(e.results=e.results.slice(0,l));return e};Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function e(d,f){return f?"xoffset"in f&&f.xoffset?Math.max(d,Math.abs(f.xoffset)):"yoffset"in f&&f.yoffset?Math.max(d,Math.abs(f.yoffset||0)):d:d}function l(d,f){if("number"===typeof d)return d;if(d&&d.stops&&d.stops.length){{d=d.stops;let u=f=0;for(let b=0;b<d.length;b++){const p=d[b].size;"number"===typeof p&&(f+=p,u++)}d=f/u}return d}return f}function B(d,f){if(!f)return d;f=f.filter(p=>"size"===
p.type).map(p=>{const {maxSize:q,minSize:r}=p;return(l(q,d)+l(r,d))/2});let u=0;const b=f.length;if(0===b)return d;for(let p=0;p<b;p++)u+=f[p];return Math.max(Math.floor(u/b),d)}a.calculateTolerance=function(d){const f=d&&d.renderer;d="touch"===(d&&d.event&&d.event.pointerType)?9:6;if(!f)return d;d="visualVariables"in f?B(d,f.visualVariables):d;if("simple"===f.type)return e(d,f.symbol);if("unique-value"===f.type){let u=d;f.uniqueValueInfos.forEach(b=>{u=e(u,b.symbol)});return u}if("class-breaks"===
f.type){let u=d;f.classBreakInfos.forEach(b=>{u=e(u,b.symbol)});return u}return d};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/support/drapedUtils":function(){define("exports ../../core/maybe ../../geometry/Extent ../../geometry ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),function(a,e,l,B,d,f){function u(p,q,r,v=new l){let D;if("2d"===r.type)D=q*r.resolution;else if("3d"===r.type){var y=r.overlayPixelSizeInMapUnits(p),x=r.basemapSpatialReference;
D=e.isSome(x)&&!x.equals(r.spatialReference)?d.getMetersPerUnitForSR(x)/d.getMetersPerUnitForSR(r.spatialReference):q*y}q=p.x-D;y=p.y-D;x=p.x+D;p=p.y+D;({spatialReference:r}=r);v.xmin=Math.min(q,x);v.ymin=Math.min(y,p);v.xmax=Math.max(q,x);v.ymax=Math.max(y,p);v.spatialReference=r;return v}const b=new l;a.createQueryGeometry=u;a.intersectsDrapedGeometry=function(p,q,r){p=r.toMap(p);if(e.isNone(p))return!1;const v=f.calculateTolerance();return u(p,v,r,b).intersects(q)};Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/handleUtils ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/watchUtils ../../views/support/layerViewUtils ./Edits ./Workflow ./workflowUtils ./UpdateWorkflowData".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k){var n;l=n=function(G){function C(A){A=G.call(this,A)||this;A.type="update";return A}a._inheritsLoose(C,G);C.create=function(A,z,w){A=new k({edits:new m,viewModel:A});w=new n({data:A,afterCommit:w});w._set("steps",this._createWorkflowSteps(w,z));return w};var t=C.prototype;t.highlight=function(A){var {data:{viewModel:{view:z}}}=this;z=A&&z.allLayerViews.items.find(({layer:w})=>w===A.layer);c.highlightsSupported(z)&&this.handles.add(z.highlight(A),"candidate-highlight")};
t.unhighlight=function(){this.handles.remove("candidate-highlight")};C._createWorkflowSteps=function(A,z="awaiting-feature-to-update"){const {data:w,handles:F}=A,E={"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const {spinnerViewModel:U,view:S}=w.viewModel;let I=null;F.add({remove(){I&&(I.abort(),I=null)}},this.id);w.edits.feature=null;const L=S.on("immediate-click",M=>{U.location=M.mapPoint;U.visible=!0;I&&I.abort();const {editableItems:K}=w.viewModel;I=y.createAbortController();
(new Promise((P,Q)=>{y.onAbort(I.signal,()=>Q(y.createAbortError()));P(g.fetchCandidates(K,S,M,I.signal))})).then(P=>{w.viewModel.spinnerViewModel.visible=!1;y.throwIfAborted(I);w.candidates=P.reduce((Q,R)=>R.error?Q:[...Q,...R.value],[]);0!==w.candidates.length&&(1===w.candidates.length?(w.edits.feature=w.candidates[0],w.viewModel.activeWorkflow.go("editing-existing-feature")):w.viewModel.activeWorkflow.next())})});F.add(L,this.id)},async tearDown(){F.remove(this.id)}}),"awaiting-update-feature-candidate":()=>
({id:"awaiting-update-feature-candidate",async setUp(){const {edits:U}=w;U.feature=null;F.add(x.watch(U,"feature",S=>{A.unhighlight();A.highlight(S)}),this.id)},async tearDown(){A.unhighlight();F.remove(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const U=w.edits.feature,S=w.viewModel;w.editableItem=S.editableItems.find(R=>R.layer===U.layer);const I=y.createAbortController();F.add({remove:()=>I.abort()},this.id);var L=S.view.whenLayerView(U.layer),M=g.fetchFullFeature(U,
S.view,I.signal);L=await L;const K=await M;if(!y.isAborted(I)){w.edits.updateGeometry(K.geometry);w.edits.updateAttributes(K.attributes);w.edits.trackChanges();M=K.layer;var P=g.findLayerInfo(S.layerInfos,M);P=P&&P.fieldConfig;S.attachmentsViewModel.set({graphic:K,mode:"view"});S.featureFormViewModel.set({feature:K,fieldConfig:P});var Q="createInteractiveEditSession"in L?L.createInteractiveEditSession(U):null;L=[S.featureFormViewModel.on("value-change",R=>{w.edits.updateAttributes(S.featureFormViewModel.getValues());
K.attributes=w.edits.feature.attributes;Q&&Q.setAttribute(R.fieldName,R.value)}),S.attachmentsViewModel.watch("mode",R=>{"add"===R&&w.viewModel.activeWorkflow.go("adding-attachment");"edit"===R&&w.viewModel.activeWorkflow.go("editing-attachment")})];Q&&(L.push(u.makeHandle(()=>Q.rollback())),F.add(u.makeHandle(()=>Q.commit()),A._handleKeys.afterCommit));({supportsGeometryUpdate:M}=M.capabilities.editing);if(M){const R=g.getVisualVariableAttributes(K),{interactive:Y,visual:T}=await g.setUpGeometryUpdate(K,
R,S.sketchViewModel,S.view,({geometry:V,attributes:W})=>{if(B.isSome(R.rotation)){var {field:X}=R.rotation;S.featureFormViewModel.setValue(X,W[X])}B.isSome(R.size)&&({field:X}=R.size,S.featureFormViewModel.setValue(X,W[X]));w.edits.updateAttributes(W);w.edits.updateGeometry(V)});L.push(Y,T);F.add(Y,A._handleKeys.beforeCommit);F.add(T,A._handleKeys.afterCommit)}else A.highlight(K);F.add(L,this.id)}},async tearDown(){A.unhighlight();F.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",
parent:"editing-existing-feature",async setUp(){},async tearDown(){}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){}})};let N=!1;return["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"].filter(U=>N?!0:N=U===z).map(U=>E[U]())};return C}(h);return l=n=e.__decorate([q.subclass("esri.widgets.Editor.UpdateWorkflow")],l)})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){l=function(D){function y(x){x=D.call(this,x)||this;x.candidates=null;x.editableItem=null;x.edits=null;x.viewModel=null;return x}a._inheritsLoose(y,D);return y}(v);e.__decorate([f.property()],l.prototype,"candidates",void 0);e.__decorate([f.property()],l.prototype,"editableItem",void 0);e.__decorate([f.property()],l.prototype,"edits",void 0);e.__decorate([f.property()],l.prototype,"viewModel",void 0);return l=e.__decorate([b.subclass("esri.widgets.Editor.UpdateWorkflowData")],
l)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../geometry/Point ../../geometry/support/coordsUtils ../../geometry ../../core/Evented ../../core/Collection ../../symbols/CIMSymbol ../../core/screenUtils ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleMarkerSymbol ../../symbols ../../Graphic ../../core/Handles ../../geometry/projectionEllipsoid ../../core/watchUtils ../../layers/GraphicsLayer ../../views/input/InputManager ../../views/DOMContainer ../../views/support/screenUtils ../../views/draw/Draw ../../views/interactive/snapping/SnappingOptions ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/createUtilsAsync ../../views/draw/support/layerUtils ../../views/interactive/snapping/SnappingManager ./support/OperationHandle".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z,w,F,E,N,U,S,I,L,M,K,P,Q,R,Y,T,V,W,X){function oa(Z){return Object.freeze({__proto__:null,"default":Z})}function ua(Z,ia){const ha=Z.history.undo.pop().updates,O=[];ia.forEach((ca,ea)=>{ea=ha[ea];const ba={};null!=ea&&(d.isSome(ea.geometry)&&(ba.geometry=ca.geometry,ca.geometry=ea.geometry),d.isSome(ea.symbol)&&(ba.symbol=ca.symbol,ca.symbol=ea.symbol),O.push(ba))});Z.history.redo.push({updates:O})}function H(Z,ia){const ha=Z.history.redo.pop().updates,
O=[];ia.forEach((ca,ea)=>{ea=ha[ea];const ba={};null!=ea&&(d.isSome(ea.geometry)&&(ba.geometry=ca.geometry,ca.geometry=ea.geometry),d.isSome(ea.symbol)&&(ba.symbol=ca.symbol,ca.symbol=ea.symbol),O.push(ba))});Z.history.undo.push({updates:O})}function J(Z){return{updates:Z.map(ia=>({geometry:ia.geometry}))}}function aa(Z){return{updates:Z.map(ia=>({symbol:ia.symbol}))}}function fa(Z){return"requireError"in Z&&"aborted"===Z.requireError}const ja=f.getLogger("esri.widgets.Sketch.SketchViewModel");var la=
["Backspace","Delete"];const da={defaultZ:0},ka={enableMidpoints:!0,enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,tool:"transform",enableZ:!0,enableMoveGraphic:!0};B=function(Z){function ia(O){O=Z.call(this,O)||this;O._activeFillGraphic=null;O._activeLineGraphic=null;O._centerIndicatorGraphic=null;O._centerSymbol=new A({style:"cross",size:6,color:[255,255,255]});O._defaultSegmentOffset=48;O._numUpdating=0;O._handles=
new F;O._internalGraphicsLayer=new U({listMode:"hide",internal:!0});O._lineGraphic=null;O._operationHandle=null;O._vertexGraphics=[];O._viewHandles=new F;O._doUnnormalization=!1;O._moveOperationCloneInfos=[];O.activeFillSymbol=new t({style:"solid",color:[150,150,150,.2],outline:{color:[50,50,50],width:0}});O.activeLineSymbol=new n({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",
controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}});O.activeVertexSymbol=new A({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});O.layer=null;O.pointSymbol=new A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});O.polygonSymbol=new t({color:[150,150,150,
.2],outline:{color:[50,50,50],width:2}});O.polylineSymbol=new C({color:[130,130,130,1],width:2});O._snappingManager=null;O.updateGraphics=new k;O.updateOnGraphicClick=!0;O.updatePointSymbol=new A({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});O.updatePolygonSymbol=new t({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});O.updatePolylineSymbol=new C({color:[12,207,255],width:2});O.vertexSymbol=new A({style:"circle",size:6,color:[255,255,255],outline:{color:[50,
50,50],width:1}});O._moduleLoaderAbortController=null;O._viewReadyAbortController=null;O._originalAutoOpenEnabled=null;O.defaultCreateOptions=da;O.defaultUpdateOptions=ka;O.snappingOptions=new K;return O}e._inheritsLoose(ia,Z);var ha=ia.prototype;ha.initialize=function(){this._handles.add([N.watch(this,"layer",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=d.isSome(this.layer)?this.layer.elevationInfo:null}),N.on(this,"view.map.layers","change",O=>{0<=O.removed.indexOf(this.layer)&&
this.cancel()}),N.on(this,"layer.graphics","change",O=>{if(d.isSome(this._operationHandle))for(const ca of O.removed)this.updateGraphics.includes(ca)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(ca):this._operationHandle.cancel())}),N.init(this,"layer.elevationInfo",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=d.isSome(this.layer)?this.layer.elevationInfo:null},!0),N.init(this,"view",O=>{d.destroyMaybe(this._snappingManager);O&&(this._snappingManager=new W.SnappingManager({view:O,
options:this.snappingOptions}))},!0)])};ha.destroy=function(){this.cancel();this._handles=d.destroyMaybe(this._handles);this._viewHandles=d.destroyMaybe(this._viewHandles);this._removeDefaultLayer();d.destroyMaybe(this._draw);d.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};ha.cancel=function(){this._moduleLoaderAbortController=d.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=d.abortMaybe(this._viewReadyAbortController);this._operationHandle&&
this._operationHandle.cancel()};ha.complete=function(){this._operationHandle&&this._operationHandle.complete()};ha.delete=function(){const {state:O,updateGraphics:ca}=this;if("active"===O&&ca.length){const {activeTool:ea,layer:ba}=this,qa=ca.toArray();ba.removeMany(qa);this.cancel();this._emitDeleteEvent({graphics:qa,tool:ea})}};ha.create=async function(O,ca){await this._waitViewReady();if("disabled"===this.state)throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),
this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),x.createAbortError();this.cancel();if(O){var ea=await this._setupCreateOperation(O,ca);d.isNone(ea)||this.destroyed||(V.addUniqueLayer(this.view,this._internalGraphicsLayer),ea.on("complete",()=>{if(ea===this._operationHandle){const ba=this.createGraphic,qa=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&
this.view.map.remove(this._internalGraphicsLayer);ea.cancelled||null==ba||this.layer.add(ba);this.emit("create",{graphic:ba,state:qa?"cancel":"complete",tool:O,toolEventInfo:null,type:"create"})}}),this._operationHandle=ea,this.view.ready&&I.isDOMContainer(this.view)&&this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};ha.update=async function(O,ca){await this._waitViewReady();const {layer:ea,view:ba,state:qa}=this;if("disabled"===qa)throw ba||this._logError("sketch:missing-property",
"Property 'view' is missing on SketchViewModel."),ea||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),x.createAbortError();this.cancel();const na=Array.isArray(O)?O:[O];null!=O&&na&&na.length?na.some(sa=>sa.layer!==ea?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):d.isNone(sa.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),
!0):"2d"!==ba.type||ba.spatialReference.equals(sa.geometry.spatialReference)?!1:(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied MapView."),!0))||(O=await this._setupUpdateOperation(na,ca),this.destroyed||d.isNone(O)||fa(O)||(V.addUniqueLayer(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(O,ca),this.emit("update",{graphics:na,state:"start",aborted:!1,tool:O.tool,toolEventInfo:null,
type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")};ha.undo=function(){this.canUndo()&&this._operationHandle.undo()};ha.redo=function(){this.canRedo()&&this._operationHandle.redo()};ha.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};ha.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};ha.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};
ha._getFirstHit=async function(O){const ca=[];switch(this.view.type){case "2d":var ea=await this.view.hitTest(O);if(0<ea.results.length&&(ea=ea.results[0],ea.graphic)){var ba,qa;const na=ea.graphic;"vector-tile"!==(null==(ba=na.layer)?void 0:ba.type)&&"imagery"!==(null==(qa=na.layer)?void 0:qa.type)&&ca.push(ea)}break;case "3d":{const na=[this.view.map.ground];this.view.map.allLayers.forEach(sa=>{"integrated-mesh"===sa.type&&na.push(sa)});ba=await this.view.hitTest(O,{exclude:na});0<ba.results.length&&
(qa=ba.results[0],(!ba.ground.mapPoint||1>this.view.map.ground.opacity||ba.ground.distance-qa.distance>-Math.min(3*ba.ground.distance,"global"===this.view.viewingMode?E.getReferenceEllipsoid(this.view.renderCoordsHelper.spatialReference).radius/this.view.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY))&&ca.push(qa))}}return{screenPoint:O,results:ca}};ha._generateViewHandles=function(O){return[O.on("immediate-click",ca=>{const {_operationHandle:ea,defaultUpdateOptions:ba,layer:qa,state:na,
updateGraphics:sa,updateOnGraphicClick:wa}=this,ra="active"===na&&"create"===ea.type;"disabled"!==na&&!ra&&wa&&(this._beginAsyncOperation(),this._getFirstHit(L.createScreenPointFromEvent(ca)).then(xa=>{xa=xa.results;if(xa.length)for(let za=0;za<xa.length;++za){var va=xa[za];if(va.graphic){va=va.graphic;if(-1<sa.indexOf(va)||va.layer===qa)return ca.stopPropagation(),va;"2d"!==O.type||this._isComponentGraphic(va)||"active"!==na||this.cancel()}}else"active"===na&&this.cancel();return null}).then(xa=>
d.isSome(xa)&&-1===sa.indexOf(xa)?this.update([xa],{...ba}):null).then(()=>{this._endAsyncOperation()}))},S.ViewEventPriorities.WIDGET)]};ha._setupCreateOperation=async function(O,ca){if(!O)return null;ca={hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...ca};let ea;if("2d"===this.view.type)switch(O){case "point":ea=this._setupCreatePointOperation(O,ca);break;case "multipoint":ea=await this._setupCreateMultipointOperation(O,ca);break;case "polygon":ea=await this._setupCreatePolyOperation(O,
ca);break;case "polyline":ea=await this._setupCreatePolyOperation(O,ca);break;case "rectangle":ea=await this._setupCreateRectangleOperation(O,ca);break;case "circle":ea=await this._setupCreateCircleOperation(O,ca)}else{O=await this._setupCreate3DOperation(O,this.view,ca);if(d.isNone(O)||fa(O))return null;ea=O}return ea};ha._setupCreate3DOperation=async function(O,ca,ea){if("multipoint"===O)return null;const ba={point:this.pointSymbol,multipoint:null,polyline:this.polylineSymbol,polygon:this.polygonSymbol,
rectangle:this.polygonSymbol,circle:this.polygonSymbol}[O];this._removeCreateOperationGraphics();const qa="rectangle"===O?!1:!0,na="rectangle"===O?!1:!0;this.snappingOptions.enabledToggled=!1;ca={view:ca,mode:"rectangle"===O||"circle"===O?"hybrid":"click",...ea,elevationInfo:this.layer.elevationInfo,geometryType:O,createGraphicSymbol:ba,snapToScene:d.isSome(this.layer.elevationInfo)?"absolute-height"===this.layer.elevationInfo.mode:!0,snappingManager:this._snappingManager,forceUniformSize:na,centered:qa};
ea=await this._requireModule(new Promise(function(va,za){a(["../../views/3d/interactive/editingTools"],va,za)}));if(fa(ea))return ea;if(this.destroyed)return null;const sa=new ea.module.DrawGraphicTool(ca);this.view.tools.add(sa);let wa=null;this.view.activeTool=sa;const ra=[],xa=new X.OperationHandle({activeComponent:sa,tool:O,type:"update",onEnd:()=>{var va;ra.forEach(za=>za.remove());ra.length=0;null==(va=this.view.tools)?void 0:va.remove(sa);sa.destroy()},undo:()=>{sa.canUndo&&sa.undo()},redo:()=>
{sa.canRedo&&sa.redo()},canUndo:()=>sa.canUndo,canRedo:()=>sa.canRedo});ra.push(this.view.on("key-down",va=>{" "===va.key?(va.stopPropagation(),va.repeat||(sa.enabled=!1)):"c"===va.key?(va.stopPropagation(),sa.completeCreateOperation()):"z"===va.key?(va.stopPropagation(),xa.undo()):"r"===va.key?(va.stopPropagation(),xa.redo()):"Control"!==va.key||"rectangle"===O||"circle"===O||va.repeat?"Control"!==va.key||"rectangle"!==O&&"circle"!==O||va.repeat?"Alt"!==va.key||va.repeat||(sa.centered=!qa,va.stopPropagation()):
(sa.forceUniformSize=!na,va.stopPropagation()):(this.snappingOptions.enabledToggled=!0,va.stopPropagation())},S.ViewEventPriorities.WIDGET),this.view.on("key-up",va=>{" "===va.key?sa.enabled=!0:"Control"===va.key&&"rectangle"!==O&&"circle"!==O?(this.snappingOptions.enabledToggled=!1,va.stopPropagation()):"Control"!==va.key||"rectangle"!==O&&"circle"!==O?"Alt"===va.key&&(sa.centered=qa,va.stopPropagation()):(sa.forceUniformSize=na,va.stopPropagation())},S.ViewEventPriorities.WIDGET),sa.on("vertex-add",
va=>{wa=d.isNone(wa)?"start":"active";switch(va.operation){case "apply":this.emit("create",{graphic:d.unwrap(sa.createGraphic),state:wa,tool:this.activeTool,toolEventInfo:va,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[d.unwrap(sa.createGraphic)],tool:O});break;case "redo":this._emitRedoEvent({graphics:[d.unwrap(sa.createGraphic)],tool:O})}}),sa.on("cursor-update",va=>{0<sa.drawOperation.numCommittedVertices&&this.emit("create",{graphic:d.unwrap(sa.createGraphic),state:"active",
tool:this.activeTool,toolEventInfo:{coordinates:va.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),sa.on("vertex-remove",va=>{switch(va.operation){case "apply":this.emit("create",{graphic:d.unwrap(sa.createGraphic),state:"active",tool:this.activeTool,toolEventInfo:va,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[d.unwrap(sa.createGraphic)],tool:O});break;case "redo":this._emitRedoEvent({graphics:[d.unwrap(sa.createGraphic)],tool:O})}}),sa.on("complete",va=>{this._removeCreateOperationGraphics();
this._set("createGraphic",d.unwrap(va.graphic));wa="complete";va.aborted?xa&&xa.cancel():xa&&xa.complete()}));return xa};ha._setupCreatePointOperation=function(O,ca){ca=this._draw.create(O,{elevationInfo:this.layer.elevationInfo,hasZ:ca.hasZ,defaultZ:ca.defaultZ,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});const ea=[ca.on("cursor-update",na=>{d.isSome(na.vertexIndex)?this._displayCrosshairCursor():this._displayDefaultCursor()}),ca.on("draw-complete",na=>{na=this.createPointFromVertex(na.vertices[0]);
na=new w(na,this.pointSymbol);this._set("createGraphic",na);qa&&qa.complete()})],ba=[this.view.on("key-down",na=>{"Escape"===na.key&&(qa&&qa.cancel(),na.stopPropagation())},S.ViewEventPriorities.WIDGET)],qa=this._operationHandleForCreateAction(ca,[...ea,...ba],O);return qa};ha._setupCreateMultipointOperation=async function(O,ca){const ea=await T.loadCreateUtils();ca=this._draw.create(O,{...ca,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});
let ba=null;const qa=[],na=this._operationHandleForCreateAction(ca,qa,O);qa.push(ca.on("vertex-add",sa=>{const {type:wa,vertexIndex:ra,vertices:xa}=sa,va=xa[ra];ba=sa;this._drawMultipointGraphic(ea,xa,!0);this.emit("create",{graphic:this.createGraphic,state:1===xa.length?"start":"active",tool:O,toolEventInfo:{added:va,vertices:[{coordinates:va,componentIndex:0,vertexIndex:ra}],type:wa},type:"create"})}),ca.on("vertex-remove",sa=>{const {type:wa,vertexIndex:ra,vertices:xa}=sa,va=xa[ra];ba=sa;this._drawMultipointGraphic(ea,
xa,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{removed:va,vertices:[{coordinates:va,componentIndex:0,vertexIndex:ra}],type:wa},type:"create"})}),ca.on("vertex-update",sa=>{const {type:wa,vertexIndex:ra,vertices:xa}=sa,va=xa[ra];ba=sa;this._drawMultipointGraphic(ea,xa,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{type:wa,updated:va,vertices:[{coordinates:va,componentIndex:0,vertexIndex:ra}]},type:"create"})}),ca.on("cursor-update",
sa=>{ba=sa}),ca.on("draw-complete",sa=>{sa=sa.vertices.slice(0);(sa=ea.createMultipoint(sa,this.view.spatialReference))&&this.createGraphic&&(this.createGraphic.geometry=sa);na&&na.complete()}),ca.on("undo",sa=>{sa=sa.vertices;const wa=ba&&"cursor-update"!==ba.type;this._resetCreateOperationGraphics();sa.length&&this._drawMultipointGraphic(ea,sa,wa)}),ca.on("redo",sa=>{sa=sa.vertices;const wa=ba&&"cursor-update"!==ba.type;this._resetCreateOperationGraphics();sa.length&&this._drawMultipointGraphic(ea,
sa,wa)}));qa.push(this.view.on("pointer-move",()=>this._displayCrosshairCursor(),S.ViewEventPriorities.WIDGET),this.view.on("key-down",sa=>this._getCommonUpdateOperationKeyDownHandlers(na,sa),S.ViewEventPriorities.WIDGET));return na};ha._setupCreatePolyOperation=async function(O,ca){const ea=await T.loadCreateUtils();ca={...ca,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0};let ba=null;"polyline"===O?ba=this._draw.create(O,ca):"polygon"===O&&
(ba=this._draw.create(O,ca));let qa=null;ca=[ba.on("vertex-add",wa=>{const {type:ra,vertexIndex:xa,vertices:va}=wa,za=va[xa];this._snapLastPolygonVertexToFirst(O,va);qa=wa;this._drawVertexGraphics(ea,O,va,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:1===va.length?"start":"active",tool:O,toolEventInfo:{added:za,vertices:[{coordinates:za,componentIndex:0,vertexIndex:xa}],type:ra},type:"create"})}),ba.on("vertex-remove",wa=>{const {type:ra,vertexIndex:xa,vertices:va}=wa,za=
va[xa];this._snapLastPolygonVertexToFirst(O,va);qa=wa;this._drawVertexGraphics(ea,O,va,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{removed:za,vertices:[{coordinates:za,componentIndex:0,vertexIndex:xa}],type:ra},type:"create"})}),ba.on("vertex-update",wa=>{const {type:ra,vertexIndex:xa,vertices:va}=wa,za=va[xa];this._snapLastPolygonVertexToFirst(O,va);qa=wa;this._drawVertexGraphics(ea,O,va,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,
state:"active",tool:O,toolEventInfo:{type:ra,updated:za,vertices:[{coordinates:za,componentIndex:0,vertexIndex:xa}]},type:"create"})}),ba.on("cursor-update",wa=>{const {type:ra,vertices:xa}=wa;wa.mapPoint&&(this._snapLastPolygonVertexToFirst(O,xa),qa=wa,this._drawVertexGraphics(ea,O,xa,{userClicked:!1}),1<xa.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{coordinates:xa[xa.length-1],type:ra},type:"create"}))}),ba.on("draw-complete",wa=>{wa=wa.vertices.slice(0);
let ra=null;"polyline"===O?ra=ea.createPolyline([wa],this.view.spatialReference,this._doUnnormalization):"polygon"===O&&(ra=ea.createPolygon([wa],this.view.spatialReference,this._doUnnormalization,!0));ra&&(this.createGraphic.geometry=ra);sa&&sa.complete()}),ba.on("undo",wa=>{wa=wa.vertices;const ra=qa&&"cursor-update"!==qa.type;this._resetCreateOperationGraphics();this._snapLastPolygonVertexToFirst(O,wa);wa.length&&this._drawVertexGraphics(ea,O,wa,{userClicked:ra})}),ba.on("redo",wa=>{wa=wa.vertices;
const ra=qa&&"cursor-update"!==qa.type;this._resetCreateOperationGraphics();this._snapLastPolygonVertexToFirst(O,wa);wa.length&&this._drawVertexGraphics(ea,O,wa,{userClicked:ra})})];const na=[this.view.on("pointer-move",wa=>{d.isSome(ba.getCoordsFromScreenPoint(G.createScreenPoint(wa.x,wa.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),this.view.on("key-down",wa=>{"Control"!==wa.key||wa.repeat?"z"===wa.key&&sa&&sa.canUndo()?(wa.stopPropagation(),sa.undo()):
"r"===wa.key&&sa&&sa.canRedo()?(wa.stopPropagation(),sa.redo()):"Escape"===wa.key&&sa&&sa.cancel():(this.snappingOptions.enabledToggled=!0,wa.stopPropagation())},S.ViewEventPriorities.WIDGET),this.view.on("key-up",wa=>{"Control"===wa.key&&(this.snappingOptions.enabledToggled=!1,wa.stopPropagation())},S.ViewEventPriorities.WIDGET)];if("polygon"===O){const wa=(va,za,Ba)=>{if(!va||!va.layer||!va.visible)return!1;va=this.view.toScreen(va.geometry);return this._isWithinScreenDistance(va,za,Ba)},ra=va=>
{if(!(2>=this._vertexGraphics.length))return wa(this._vertexGraphics[0],va,this._getVertexIntersectDistance())};let xa=!1;na.push(this.view.on("pointer-move",()=>{xa=!1},S.ViewEventPriorities.WIDGET),this.view.on("pointer-down",va=>{ra(va)?(xa=!0,va.stopPropagation()):this._vertexGraphics.some(za=>wa(za,va,this._getVertexIntersectDistance()))&&va.stopPropagation()},S.ViewEventPriorities.WIDGET),this.view.on("pointer-up",va=>{xa&&(va.stopPropagation(),ba.complete())}))}const sa=this._operationHandleForCreateAction(ba,
[...ca,...na],O);return sa};ha._setupCreateCircleOperation=async function(O,ca){const ea=await T.loadCreateUtils(),ba=this._draw.create(O,{...ca,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});let qa=!1,na=!0;ca=[ba.on("vertex-add",ra=>{const {type:xa,vertexIndex:va,vertices:za}=ra;ra=za[va];this._drawSegmentGraphic(ea,O,za,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===
za.length?"start":"active",tool:O,toolEventInfo:{added:ra,vertices:[{coordinates:ra,componentIndex:0,vertexIndex:va}],type:xa},type:"create"})}),ba.on("cursor-update",ra=>{const {type:xa,vertices:va}=ra;this._drawSegmentGraphic(ea,O,va,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem);2===va.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{coordinates:va[va.length-1],type:xa},type:"create"})}),ba.on("draw-complete",ra=>{ra=ra.vertices.slice(0);
1===ra.length?(ra.push(ba.viewAlignedCoordinateSystem.makeMapPoint(ra[0][0]+this._defaultSegmentOffset*this.view.resolution,ra[0][1])),ra=ea.createCircle(ra,ba.viewAlignedCoordinateSystem,!0,this.view.resolution)):ra=qa?ea.createEllipse(ra,ba.viewAlignedCoordinateSystem,na):ea.createCircle(ra,ba.viewAlignedCoordinateSystem,na,this.view.resolution);this.createGraphic?this.createGraphic.geometry=ra:(this._removeCreateGraphic(),this._set("createGraphic",new w(ra,this.polygonSymbol)));wa&&wa.complete()})];
const sa=[this.view.on("pointer-move",ra=>{d.isSome(ba.getCoordsFromScreenPoint(G.createScreenPoint(ra.x,ra.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),this.view.on("key-down",ra=>{"Control"===ra.key?qa||(qa=!0,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):"Alt"===ra.key?na&&(na=!1,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):
"Escape"===ra.key&&wa&&wa.cancel()},S.ViewEventPriorities.WIDGET),this.view.on("key-up",ra=>{"Control"===ra.key?(qa=!1,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):"Alt"===ra.key&&(na=!0,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem))},S.ViewEventPriorities.WIDGET)],wa=this._operationHandleForCreateAction(ba,[...ca,...sa],O);return wa};ha._setupCreateRectangleOperation=async function(O,
ca){const ea=await T.loadCreateUtils(),ba=this._draw.create(O,{...ca,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});let qa=!1,na=!1;ca=[ba.on("vertex-add",ra=>{const {type:xa,vertexIndex:va,vertices:za}=ra;ra=za[va];this._drawSegmentGraphic(ea,O,za,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===za.length?"start":"active",tool:O,toolEventInfo:{added:ra,vertices:[{coordinates:ra,
componentIndex:0,vertexIndex:va}],type:xa},type:"create"})}),ba.on("cursor-update",ra=>{const {type:xa,vertices:va}=ra;this._drawSegmentGraphic(ea,O,va,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem);2===va.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:O,toolEventInfo:{coordinates:va[va.length-1],type:xa},type:"create"})}),ba.on("draw-complete",ra=>{ra=ra.vertices.slice(0);let xa=null;1===ra.length&&(na=qa=!1);xa=qa?ea.createSquare(ra,ba.viewAlignedCoordinateSystem,
na):ea.createRectangle(ra,ba.viewAlignedCoordinateSystem,na);this.createGraphic?this.createGraphic.geometry=xa:(this._removeCreateGraphic(),this._set("createGraphic",new w(xa,this.polygonSymbol)));wa&&wa.complete()})];const sa=[this.view.on("pointer-move",ra=>{d.isSome(ba.getCoordsFromScreenPoint(G.createScreenPoint(ra.x,ra.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),this.view.on("key-down",ra=>{"Control"===ra.key?qa||(qa=!0,this._drawSegmentGraphic(ea,
O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):"Alt"===ra.key?na||(na=!0,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):"Escape"===ra.key&&wa&&wa.cancel()},S.ViewEventPriorities.WIDGET),this.view.on("key-up",ra=>{"Control"===ra.key?(qa=!1,this._drawSegmentGraphic(ea,O,ba.vertices,{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem)):"Alt"===ra.key&&(na=!1,this._drawSegmentGraphic(ea,O,ba.vertices,
{centered:na,constrainToggle:qa},ba.viewAlignedCoordinateSystem))},S.ViewEventPriorities.WIDGET)],wa=this._operationHandleForCreateAction(ba,[...ca,...sa],O);return wa};ha._setupUpdateOperation=async function(O,ca){const {_defaultUpdateTool:ea,defaultUpdateOptions:ba,layer:qa,view:na}=this;ca={...ba,...ca};var sa=ca.tool||ea;for(var wa of O)qa.remove(wa),qa.add(wa);if("3d"===na.type){if(0===O.length)return null;switch(sa){case "move":return this._setupMove3DOperation(O,ca,na,sa);case "reshape":if(1<
O.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;sa=R.isSupportedGraphic(O[0]);if(0===sa)return this._setupReshape3DOperation(O[0],ca,na);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${P.isSupportedGraphicResultMessage(sa)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(O,ca,na)}}if("move"===sa)return this._setupMoveOperation(O,ca,na);if(1<O.length)return"reshape"===
sa?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshapeOperation(O,sa,ca,na);if(1===O.length){wa=d.get(O[0].geometry,"type");if("point"===wa||"multipoint"===wa)return this._setupMoveOperation(O,ca,na);if("transform"===sa||"reshape"===sa)return this._setupTransformOrReshapeOperation(O,sa,ca,na)}return null};ha._setupMove3DOperation=async function(O,ca,ea,ba,qa=!1){for(var na of O){const xa=Q.isSupportedGraphic(na);if(0!==
xa)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${P.isSupportedGraphicResultMessage(xa)}).`),null}na=await this._requireModule(new Promise(function(xa,va){a(["../../views/3d/interactive/editingTools"],xa,va)}));if(fa(na))return na;const sa=new na.module.GraphicMoveTool({view:ea,enableZ:ca.enableZ,snappingManager:this._snappingManager});this.view.tools.add(sa);sa.graphics.addMany(O);qa||this.updateGraphics.addMany(O);const wa=[],ra=new X.OperationHandle({activeComponent:sa,
tool:ba,type:"update",onEnd:()=>{var xa;wa.forEach(va=>va.remove());wa.length=0;null==(xa=this.view.tools)?void 0:xa.remove(sa);sa.destroyed||sa.destroy()},undo:()=>{ua(ra,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ba})},redo:()=>{H(ra,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ba})},addToSelection:xa=>{this.updateGraphics.push(xa);sa.graphics.push(xa);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[xa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:xa=>{const va=this.updateGraphics.indexOf(xa);ra.history.undo.forEach(za=>za.updates.splice(va,1));ra.history.redo.forEach(za=>za.updates.splice(va,1));this.updateGraphics.remove(xa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[xa],type:"selection-change"},type:"update"});
0===this.updateGraphics.length?ra.complete():sa.graphics.remove(xa)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==ca.toggleToolOnClick&&"transform"===ba){var xa=this.updateGraphics.getItemAt(0);0===R.isSupportedGraphic(xa)&&(xa=await this._setupReshape3DOperation(xa,ca,ea,!0),fa(xa)||(ra.onEnd(),ra.destroy(),this._setUpdateOperationHandle(xa,ca)))}}});wa.push(...this._getHandlesForComponent(ra,ca),this.view.on("immediate-click",xa=>this._getCommonUpdateOperationClickHandlers(ra,xa,
ca),S.ViewEventPriorities.WIDGET),this.view.on("key-down",xa=>this._getCommonUpdateOperationKeyDownHandlers(ra,xa),S.ViewEventPriorities.WIDGET));return ra};ha._setupGraphicTransform3DOperation=function(O,ca,ea,ba=!1){if(1===O.length&&0===Y.isSupportedGraphic(O[0])){const qa=O[0];if(d.isSome(qa.geometry)&&"point"===qa.geometry.type)return this._setupPointTransform3DOperation(qa,ca,ea);if(d.isSome(qa.geometry)&&("polygon"===qa.geometry.type||"polyline"===qa.geometry.type))return this._setupPolyTransform3DOperation(qa,
ca,ea,ba)}return this._setupMove3DOperation(O,ca,ea,"transform",ba)};ha._setupPointTransform3DOperation=async function(O,ca,ea){const {enableRotation:ba,enableScaling:qa,enableZ:na}=ca,sa=await this._requireModule(new Promise(function(va,za){a(["../../views/3d/interactive/editingTools"],va,za)}));if(fa(sa))return sa;const wa=new sa.module.GraphicTransformTool({graphic:O,view:ea,enableRotation:ba,enableScaling:qa,enableZ:na,snappingManager:this._snappingManager});this.view.tools.add(wa);this.updateGraphics.add(O);
const ra=[],xa=new X.OperationHandle({activeComponent:wa,tool:"transform",type:"update",onEnd:()=>{var va;ra.forEach(za=>za.remove());ra.length=0;null==(va=this.view.tools)?void 0:va.remove(wa);wa.destroyed||wa.destroy()},undo:()=>{ua(xa,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{H(xa,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async va=>{this.updateGraphics.add(va);
va=await this._setupMove3DOperation(this.updateGraphics.toArray(),ca,ea,"transform",!0);fa(va)||(xa.onEnd(),xa.destroy(),this._setUpdateOperationHandle(va,ca))}});ra.push(...this._getHandlesForComponent(xa,ca),this.view.on("immediate-click",va=>this._getCommonUpdateOperationClickHandlers(xa,va,ca),S.ViewEventPriorities.WIDGET),this.view.on("key-down",va=>this._getCommonUpdateOperationKeyDownHandlers(xa,va),S.ViewEventPriorities.WIDGET));return xa};ha._setupPolyTransform3DOperation=async function(O,
ca,ea,ba=!1){const {enableRotation:qa,enableScaling:na,enableZ:sa,preserveAspectRatio:wa}=ca,ra=await this._requireModule(new Promise(function(Ba,Ea){a(["../../views/3d/interactive/editingTools"],Ba,Ea)}));if(fa(ra))return ra;const xa=new ra.module.ExtentTransformTool({graphic:O,view:ea,enableRotation:qa,enableScaling:na,enableZ:sa,preserveAspectRatio:wa});this.view.tools.add(xa);ba||this.updateGraphics.add(O);const va=[],za=new X.OperationHandle({activeComponent:xa,tool:"transform",type:"update",
onEnd:()=>{var Ba;va.forEach(Ea=>Ea.remove());va.length=0;null==(Ba=this.view.tools)?void 0:Ba.remove(xa);xa.destroyed||xa.destroy()},canUndo:()=>xa.canUndo(),undo:()=>{xa.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>xa.canRedo(),redo:()=>{xa.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async Ba=>{this.updateGraphics.add(Ba);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Ba],removed:[],type:"selection-change"},type:"update"});Ba=await this._setupMove3DOperation(this.updateGraphics.toArray(),ca,ea,"transform",!0);fa(Ba)||(za.onEnd(),za.destroy(),this._setUpdateOperationHandle(Ba,ca))},removeFromSelection:async Ba=>{this.updateGraphics.remove(Ba);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Ba],type:"selection-change"},
type:"update"});za.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==ca.toggleToolOnClick){var Ba=this.updateGraphics.getItemAt(0);0===R.isSupportedGraphic(Ba)&&(Ba=await this._setupReshape3DOperation(Ba,ca,ea,!0),fa(Ba)||(za.onEnd(),za.destroy(),this._setUpdateOperationHandle(Ba,ca)))}}});va.push(...this._getHandlesForComponent(za,ca),this.view.on("immediate-click",Ba=>this._getCommonUpdateOperationClickHandlers(za,Ba,ca),S.ViewEventPriorities.WIDGET),this.view.on("key-down",
Ba=>this._getCommonUpdateOperationKeyDownHandlers(za,Ba),S.ViewEventPriorities.WIDGET),this.view.on("key-down",Ba=>{"Control"!==Ba.key||Ba.repeat||(xa.preserveAspectRatio=!xa.preserveAspectRatio,Ba.stopPropagation())},S.ViewEventPriorities.WIDGET),this.view.on("key-up",Ba=>{"Control"===Ba.key&&(xa.preserveAspectRatio=!xa.preserveAspectRatio,Ba.stopPropagation())},S.ViewEventPriorities.WIDGET));return za};ha._setupMoveOperation=async function(O,ca,ea){this.updateGraphics.addMany(O);const ba=await this._getGraphicMover(O,
ca,ea);if(fa(ba))return ba;this._syncCloneInfos();const qa=new X.OperationHandle({activeComponent:ba,tool:"move",type:"update",onEnd:()=>{var wa;this._displayDefaultCursor();sa.forEach(ra=>ra.remove());na.forEach(ra=>ra.remove());sa=[];na=[];ba.destroy();null==(wa=this._internalGraphicsLayer)?void 0:wa.removeMany([...this.updateGraphics.toArray()]);this._removeCloneGraphics()},undo:()=>{const wa=this.updateGraphics.toArray();ua(qa,wa);this._syncCloneInfos();this._emitUndoEvent({graphics:wa,tool:"move"})},
redo:()=>{const wa=this.updateGraphics.toArray();H(qa,wa);this._syncCloneInfos();this._emitRedoEvent({graphics:wa,tool:"move"})},addToSelection:wa=>{this.updateGraphics.push(wa);ba.graphics=this.updateGraphics.toArray();const ra=this._createClone(wa);this._moveOperationCloneInfos.push({graphic:wa,clone:ra});this._internalGraphicsLayer.add(ra);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[wa],removed:[],type:"selection-change"},
type:"update"})},removeFromSelection:wa=>{const ra=this.updateGraphics.indexOf(wa);qa.history.undo.forEach(va=>va.updates.splice(ra,1));qa.history.redo.forEach(va=>va.updates.splice(ra,1));var xa=this._moveOperationCloneInfos.findIndex(va=>va.graphic===wa);this._internalGraphicsLayer.remove(this._moveOperationCloneInfos[xa].clone);this.updateGraphics.remove(wa);this._moveOperationCloneInfos.splice(xa,1);xa=this.updateGraphics.toArray();this.emit("update",{graphics:xa,state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[wa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?qa.complete():ba.graphics=xa}});let na=[ea.on("immediate-click",wa=>this._getCommonUpdateOperationClickHandlers(qa,wa,ca),S.ViewEventPriorities.WIDGET),ea.on("key-down",wa=>{this._getCommonUpdateOperationKeyDownHandlers(qa,wa);"Control"!==wa.key||wa.repeat||(ba.enableMoveAllGraphics=!ba.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET),ea.on("key-up",wa=>{"Control"===wa.key&&(ba.enableMoveAllGraphics=
!ba.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET)],sa=this._getHandlesForComponent(qa,ca);sa.push(ba.on("graphic-move",wa=>{this._moveOperationCloneInfos.forEach(ra=>{const xa=wa.allGraphics.find(va=>va===ra.graphic);xa&&(ra.clone.geometry=xa.geometry)})}));return qa};ha._removeCloneGraphics=function(){if(this._moveOperationCloneInfos.length){for(const {clone:O}of this._moveOperationCloneInfos)this._internalGraphicsLayer.remove(O),O.destroy();this._moveOperationCloneInfos=[]}};ha._syncCloneInfos=
function(){this._removeCloneGraphics();this._moveOperationCloneInfos=this._generateCloneInfos(this.updateGraphics.toArray());for(const {clone:O}of this._moveOperationCloneInfos)this._internalGraphicsLayer.add(O)};ha._generateCloneInfos=function(O){return(null==O?void 0:O.map(ca=>({graphic:ca,clone:this._createClone(ca)})))||[]};ha._createClone=function(O){const ca=O.clone();ca.symbol=this._getSymbolForClone(O);return ca};ha._getSymbolForClone=function(O){if(d.isNone(O.symbol))return null;switch(O.symbol.type){case "cim":return new A({style:"circle",
size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case "picture-marker":{const {xoffset:ca,yoffset:ea,height:ba,width:qa}=O.symbol;return new A({xoffset:ca,yoffset:ea,size:ba===qa?qa:Math.max(ba,qa),style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case "simple-marker":{const {xoffset:ca,yoffset:ea,size:ba,style:qa}=O.symbol;return new A({xoffset:ca,yoffset:ea,style:"circle"===qa?"circle":"square",size:ba+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case "simple-fill":return new t({color:[0,
0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case "simple-line":return new C({color:[255,127,0,1],style:"dash",width:1});case "text":{const {xoffset:ca,yoffset:ea}=O.symbol;return new A({xoffset:ca,yoffset:ea,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}};ha._setupReshape3DOperation=async function(O,ca,ea,ba=!1){const qa=await this._requireModule(new Promise(function(ra,xa){a(["../../views/3d/interactive/editingTools"],ra,xa)}));if(fa(qa))return qa;
this.snappingOptions.enabledToggled=!1;const na=new qa.module.GraphicReshapeTool({view:ea,graphic:O,enableZ:ca.enableZ,enableMoveGraphic:ca.enableMoveGraphic,snappingManager:this._snappingManager});ea.tools.add(na);ba||this.updateGraphics.add(O);const sa=[],wa=new X.OperationHandle({activeComponent:na,tool:"reshape",type:"update",onEnd:()=>{var ra;sa.forEach(xa=>xa.remove());sa.length=0;null==(ra=this.view.tools)?void 0:ra.remove(na);na.destroyed||na.destroy()},undo:()=>{na.beforeUndo();ua(wa,this.updateGraphics.toArray());
this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},redo:()=>{H(wa,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async ra=>{this.updateGraphics.add(ra);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ra],removed:[],type:"selection-change"},type:"update"});ra=await this._setupMove3DOperation(this.updateGraphics.toArray(),
ca,ea,"transform",!0);fa(ra)||(wa.onEnd(),wa.destroy(),this._setUpdateOperationHandle(ra,ca))},removeFromSelection:async ra=>{this.updateGraphics.remove(ra);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ra],type:"selection-change"},type:"update"});wa.complete()},toggleTool:async()=>{if(!1!==ca.toggleToolOnClick){var ra=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),ca,ea,!0);fa(ra)||
(wa.onEnd(),wa.destroy(),this._setUpdateOperationHandle(ra,ca))}}});sa.push(...this._getHandlesForComponent(wa,ca),ea.on("immediate-click",ra=>this._getCommonUpdateOperationClickHandlers(wa,ra,ca),S.ViewEventPriorities.WIDGET),ea.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(wa,ra);"Control"===ra.key&&(this.snappingOptions.enabledToggled=!0,ra.stopPropagation())},S.ViewEventPriorities.WIDGET),ea.on("key-up",ra=>{"Control"===ra.key&&(this.snappingOptions.enabledToggled=!1,ra.stopPropagation())},
S.ViewEventPriorities.WIDGET));return wa};ha._setupTransformOrReshapeOperation=async function(O,ca,ea,ba){const {multipleSelectionEnabled:qa}=ea;this.updateGraphics.addMany(O);ca="transform"===ca?await this._getBox(O,ea,ba):await this._getReshape(O,ea,ba);if(fa(ca))return ca;const na=new X.OperationHandle({activeComponent:ca,type:"update",onEnd:()=>{wa.forEach(ra=>ra.remove());sa.forEach(ra=>ra.remove());wa=[];sa=[];na.activeComponent&&!na.activeComponent.destroyed&&na.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},
undo:()=>{ua(na,this.updateGraphics.toArray());na.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:na.tool})},redo:()=>{H(na,this.updateGraphics.toArray());na.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:na.tool})},addToSelection:ra=>{const xa=na.activeComponent;this.updateGraphics.add(ra);xa.graphics=this.updateGraphics.toArray();xa.refresh();na.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ra],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ra=>{const xa=na.activeComponent,va=this.updateGraphics.indexOf(ra);na.history.undo.forEach(Ba=>Ba.updates.splice(va,1));na.history.redo.forEach(Ba=>Ba.updates.splice(va,1));this.updateGraphics.remove(ra);const za=this.updateGraphics.toArray();this.emit("update",{graphics:za,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ra],type:"selection-change"},
type:"update"});0===this.updateGraphics.length?na.complete():xa.graphics=za},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var ra=null;"transform"===na.tool?ra=await this._getReshape(O,ea,ba):"reshape"===na.tool&&(ra=await this._getBox(O,ea,ba));fa(ra)||(na.activeComponent.destroy(),na.activeComponent=ra,na.activeComponent&&(wa.forEach(xa=>xa.remove()),wa=this._getHandlesForComponent(na,ea)))}}});let sa=[ba.on("immediate-click",ra=>{this._getFirstHit(L.createScreenPointFromEvent(ra)).then(xa=>
{var va;if(na)if(null!=(va=xa.results)&&va.length){var za=na.activeComponent;xa.results.some(Ba=>{if(Ba.graphic){var Ea;Ba=Ba.graphic;if("box"===(null==za?void 0:za.type)&&null!=(Ea=ra.native)&&Ea.shiftKey&&qa)return na.addToSelection(Ba),!0;Ba.layer===this.layer&&na.complete()}return!1})&&ra.stopPropagation()}else na.complete()})},S.ViewEventPriorities.WIDGET),ba.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(na,ra);"Control"!==ra.key||ra.repeat||(this.snappingOptions.enabledToggled=
!0,ra.stopPropagation());"Control"===ra.key&&!ra.repeat&&na&&(ra=na.activeComponent)&&"box"===ra.type&&(ra.preserveAspectRatio=!ra.preserveAspectRatio)},S.ViewEventPriorities.WIDGET),ba.on("key-up",ra=>{var xa;"Control"===ra.key&&"reshape"===(null==na?void 0:null==(xa=na.activeComponent)?void 0:xa.type)&&(this.snappingOptions.enabledToggled=!1,ra.stopPropagation());"Control"===ra.key&&na&&(ra=na.activeComponent)&&"box"===ra.type&&(ra.preserveAspectRatio=!ra.preserveAspectRatio)},S.ViewEventPriorities.WIDGET)],
wa=this._getHandlesForComponent(na,ea);return na};ha._getGraphicMover=async function(O,ca,ea){({enableMoveAllGraphics:ca}=ca);const ba=await this._requireModule(new Promise(function(qa,na){a(["../../views/draw/support/GraphicMover"],function(sa){qa(oa(sa))},na)}));return fa(ba)?ba:new ba.module.default({enableMoveAllGraphics:ca,graphics:O,view:ea,callbacks:{onGraphicMoveStart:({dx:qa,dy:na,graphic:sa})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:na,mover:sa,type:"move-start"},type:"update"})},onGraphicMove:({dx:qa,dy:na,graphic:sa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:na,mover:sa,type:"move"},type:"update"}),onGraphicMoveStop:({dx:qa,dy:na,graphic:sa})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,
dy:na,mover:sa,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};ha._getBox=async function(O,ca,ea){const {enableRotation:ba,enableScaling:qa,preserveAspectRatio:na}=ca;ca=await this._requireModule(new Promise(function(sa,wa){a(["../../views/draw/support/Box"],function(ra){sa(oa(ra))},wa)}));return fa(ca)?ca:new ca.module.default({graphics:O,enableRotation:ba,enableScaling:qa,preserveAspectRatio:na,layer:this._internalGraphicsLayer,
view:ea,callbacks:{onMoveStart:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onMove:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onMoveStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScaleStart:sa=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScale:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScaleStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onRotateStart:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onRotate:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onRotateStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"})}})};ha._getReshape=async function(O,ca,ea){({enableMidpoints:ca=!0}=ca);const ba=await this._requireModule(new Promise(function(qa,
na){a(["../../views/draw/support/Reshape"],function(sa){qa(oa(sa))},na)}));return fa(ba)?ba:new ba.module.default({enableMidpoints:ca,graphic:O[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,view:ea,callbacks:{onReshapeStart:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onReshape:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...qa},type:"update"}),onReshapeStop:({mover:qa,type:na})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:qa,type:na},type:"update"}),onMoveStart:({dx:qa,dy:na,mover:sa,type:wa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:na,mover:sa,type:wa},type:"update"}),onMove:({dx:qa,dy:na,mover:sa,type:wa})=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:na,mover:sa,type:wa},type:"update"}),onMoveStop:({dx:qa,dy:na,mover:sa,type:wa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:na,mover:sa,type:wa},type:"update"}),onVertexAdd:({added:qa,type:na,vertices:sa})=>{qa=qa.map(wa=>m.geometryToCoordinates(wa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:qa,vertices:sa,type:na},type:"update"})},onVertexRemove:({removed:qa,type:na,vertices:sa})=>{qa=qa.map(wa=>m.geometryToCoordinates(wa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:qa,vertices:sa,type:na},type:"update"})}}})};ha._getHandlesForComponent=function(O,ca){const ea=O.activeComponent;switch(ea.type){case "graphic-mover":return[ea.on("graphic-click",
({graphic:ba,viewEvent:qa})=>{var na;null!=(na=qa.native)&&na.shiftKey&&(qa.stopPropagation(),O.removeFromSelection(ba))}),ea.on("graphic-move-start",ba=>O.addToHistory(J(ba.allGraphics)))];case "box":return[ea.on("graphic-click",ba=>this._onTransformOrReshape2DGraphicClick(O,ca,ba)),ea.on("move-start",ba=>O.addToHistory(J(ba.graphics))),ea.on("rotate-start",ba=>O.addToHistory(J(ba.graphics))),ea.on("scale-start",ba=>O.addToHistory(J(ba.graphics)))];case "reshape":return[ea.on("graphic-click",ba=>
this._onTransformOrReshape2DGraphicClick(O,ca,ba)),ea.on("move-start",ba=>O.addToHistory(J([ba.mover]))),ea.on("reshape-start",ba=>O.addToHistory(J([ba.graphic]))),ea.on("vertex-add",ba=>O.addToHistory(J([ba.oldGraphic]))),ea.on("vertex-remove",ba=>O.addToHistory(J([ba.oldGraphic])))];case "move-3d":return[ea.on("graphic-move-start",ba=>{O.addToHistory(J(ba.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,
mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move-start"},type:"update"})}),ea.on("graphic-move",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba.dx,dy:ba.dy,mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move"},type:"update"})}),ea.on("graphic-move-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,
mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move-stop"},type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],O,ca):O.toggleTool()})];case "transform-3d":return[ea.on("graphic-translate-start",ba=>{O.addToHistory(J([ba.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move-start"},type:"update"})}),ea.on("graphic-translate-stop",
ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move-stop"},type:"update"})}),ea.on("graphic-rotate-start",ba=>{O.addToHistory(aa([ba.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,angle:ba.angle,type:"rotate-start"},type:"update"})}),ea.on("graphic-rotate-stop",ba=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,angle:ba.angle,type:"rotate-stop"},type:"update"})}),ea.on("graphic-scale-start",ba=>{O.addToHistory(aa([ba.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale-start"},type:"update"})}),ea.on("graphic-scale-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale-stop"},type:"update"})}),ea.on("graphic-translate",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move"},type:"update"})}),ea.on("graphic-rotate",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:ba.graphic,angle:ba.angle,type:"rotate"},type:"update"})}),ea.on("graphic-scale",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale"},type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],O,ca):O.toggleTool()})];case "reshape-3d":return[ea.on("reshape",ba=>{"reshape-start"===ba.type&&O.addToHistory(J([ba.mover]));
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("move",ba=>{"move-start"===ba.type&&O.addToHistory(J([ba.mover]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("vertex-add",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,
type:"update"})}),ea.on("vertex-remove",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],O,ca):O.toggleTool()})];case "draw":case "draw-3d":return null}};ha._onTransformOrReshape2DGraphicClick=function(O,ca,ea){var ba;const {graphic:qa,viewEvent:na}=ea;null!=(ba=na.native)&&ba.shiftKey?(na.stopPropagation(),O.removeFromSelection(qa)):
ca.toggleToolOnClick&&(d.isNone(qa.geometry)||"extent"!==qa.geometry.type?(na.stopPropagation(),O.toggleTool()):this._logError("sketch:reshape-extent","Reshape operation does not support graphics with geometry of type 'extent'."))};ha._setUpdateOperationHandle=function(O,ca){this._operationHandle=O;const ea=this.view.map;this._disablePopup(ca);O.on("complete",()=>{if(O===this._operationHandle){const ba=this.updateGraphics.toArray(),qa=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=
null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();ea&&ea.remove(this._internalGraphicsLayer);this._restorePopup(ca);this.emit("update",{graphics:ba,state:"complete",aborted:O.cancelled,tool:qa,toolEventInfo:null,type:"update"})}})};ha._getCommonUpdateOperationClickHandlers=function(O,ca,ea){const ba=L.createScreenPointFromEvent(ca);this._getFirstHit(ba).then(qa=>{qa=qa.results;qa.length?ca.native.shiftKey&&this._toggleSelection(qa.map(na=>na.graphic),
O,ea)?ca.stopPropagation():qa.some(na=>na.graphic&&-1<this.updateGraphics.indexOf(na.graphic))?ca.stopPropagation():O.complete():O.complete()})};ha._toggleSelection=function(O,ca,ea){const ba=!!ea.multipleSelectionEnabled;return O.some(qa=>null==qa?!1:ba&&qa.layer===this.layer?(-1===this.updateGraphics.indexOf(qa)?ca.addToSelection(qa):ca.removeFromSelection(qa),!0):!1)};ha._getCommonUpdateOperationKeyDownHandlers=function(O,ca){if(O){var ea=ca.key;"z"===ea&&O.canUndo()?(ca.stopPropagation(),O.undo()):
"r"===ea&&O.canRedo()?(ca.stopPropagation(),O.redo()):"Escape"===ea?(ca.stopPropagation(),O.cancel()):0<=la.indexOf(ea)&&this._onDeleteKey(ca)}};ha._onDeleteKey=function(O){if(this._operationHandle&&"update"===this._operationHandle.type){var ca=this.activeComponent;d.isNone(ca)||"reshape"===ca.type||"reshape-3d"===ca.type||(O.stopPropagation(),O=this.updateGraphics.toArray(),this.layer.removeMany(O),this._emitDeleteEvent({graphics:O,tool:this.activeTool}))}};ha._drawMultipointGraphic=function(O,ca,
ea){var ba=null;!ea&&1<ca.length?(ba=ca.slice(0),ba.pop(),ba=O.createMultipoint(ba,this.view.spatialReference)):ba=O.createMultipoint(ca,this.view.spatialReference);this.createGraphic?this.createGraphic.geometry=ba:this._set("createGraphic",new w(ba,this.pointSymbol));ea&&1===ca.length&&this._internalGraphicsLayer.add(this.createGraphic)};ha._drawVertexGraphics=function(O,ca,ea,ba){if(ea.length){var {_doUnnormalization:qa,activeLineSymbol:na,activeVertexSymbol:sa,polygonSymbol:wa,polylineSymbol:ra,
vertexSymbol:xa,view:{spatialReference:va}}=this,za=!(!ba||!ba.userClicked),Ba="polygon"===ca;ba=Ba?wa:ra;if(1===ea.length){this._removeLineGraphic();this._removeActiveLineGraphic();var Ea=this.createPointFromVertex(ea[0]);ea=Ba?O.createPolygon([ea],va,qa,!0):O.createPolyline([ea],va,qa);this._vertexGraphics.length?this._vertexGraphics[0].geometry=Ea:this._vertexGraphics.push(new w(Ea,sa));this.createGraphic?this.createGraphic.set({geometry:ea,symbol:ba}):this._set("createGraphic",new w(ea,ba));za&&
this._internalGraphicsLayer.add(this._vertexGraphics[0])}else if(2===ea.length){var Ha=this.createPointFromVertex(ea[1]);Ea=O.createPolyline([ea],va,qa);O=Ba?O.createPolygon([ea],va,qa,!0):O.createPolyline([ea],va,qa);this._vertexGraphics.length||(ea=this.createPointFromVertex(ea[0]),ea=new w(ea,xa),this._vertexGraphics.push(ea));1===this._vertexGraphics.length?(ea=this._vertexGraphics[0],Ha=new w(Ha,xa),this._removeLineGraphic(),this._removeActiveFillGraphic(),this._vertexGraphics.push(Ha),this._internalGraphicsLayer.remove(ea),
this._internalGraphicsLayer.add(ea)):this._vertexGraphics[1].geometry=Ha;this._showActiveLineGraphic(Ea);ea=this._vertexGraphics[0];za&&(this._activeLineGraphic.symbol=ra,ea.symbol=xa,this._internalGraphicsLayer.add(this._vertexGraphics[1]));this.createGraphic?this.createGraphic.set({geometry:O,symbol:ba}):this._set("createGraphic",new w(O,ba));this._internalGraphicsLayer.remove(ea);this._internalGraphicsLayer.add(ea)}else if(2<ea.length){Ha=Ba?O.createPolygon([ea],va,qa,!0):O.createPolyline([ea],
va,qa);"polygon"===ca&&this._showFillGraphic(Ha);Ba=ea.map(Pa=>Pa.slice());ca=Ba.pop();const Oa=[Ba[Ba.length-1],ca];ca=O.createPolyline([Ba],va,qa);O=O.createPolyline([Oa],va,qa);this._showLineGraphic(ca);this._showActiveLineGraphic(O);for(O=0;O<Ba.length;O++)(ca=this._vertexGraphics[O])?ca.symbol=za||O!==this._vertexGraphics.length-1?xa:sa:(ca=this.createPointFromVertex(ea[O]),this._showVertexGraphic(ca));za?(this._activeLineGraphic.symbol=ra,za=this.createPointFromVertex(ea[ea.length-1]),this._showVertexGraphic(za)):
this._activeLineGraphic.symbol=na;this.createGraphic?this.createGraphic.set({geometry:Ha,symbol:ba}):(this._removeCreateGraphic(),this._set("createGraphic",new w(Ha,ba)));for(Ea of this._vertexGraphics)this._internalGraphicsLayer.remove(Ea),this._internalGraphicsLayer.add(Ea)}}};ha._drawSegmentGraphic=function(O,ca,ea,ba,qa){if(ea.length){var na=!(null==ba||!ba.centered);ba=!(null==ba||!ba.constrainToggle);var sa;1===ea.length?this._removeCenterIndicatorGraphic():("rectangle"===ca?sa=ba?O.createSquare(ea,
qa,na):O.createRectangle(ea,qa,na):"circle"===ca&&(sa=ba?O.createEllipse(ea,qa,na):O.createCircle(ea,qa,na,this.view.resolution)),d.isSome(sa)&&sa.extent&&sa.extent.center&&this._showCenterIndicatorGraphic(sa.extent.center));sa?this.createGraphic?this.createGraphic.geometry=sa:(this._removeCreateGraphic(),this._set("createGraphic",new w(sa,this.polygonSymbol)),this._internalGraphicsLayer.add(this.createGraphic)):this._removeCreateGraphic()}};ha._showCenterIndicatorGraphic=function(O){this._centerIndicatorGraphic?
this._centerIndicatorGraphic.geometry=O:(this._centerIndicatorGraphic=new w(O,this._centerSymbol),this._internalGraphicsLayer.add(this._centerIndicatorGraphic))};ha._removeCenterIndicatorGraphic=function(){this._centerIndicatorGraphic&&(this._internalGraphicsLayer.remove(this._centerIndicatorGraphic),this._centerIndicatorGraphic.destroy(),this._centerIndicatorGraphic=null)};ha._showActiveLineGraphic=function(O){this._activeLineGraphic?(this._activeLineGraphic.set({geometry:O,symbol:this.activeLineSymbol}),
this._internalGraphicsLayer.remove(this._activeLineGraphic)):this._activeLineGraphic=new w(O,this.activeLineSymbol);this._internalGraphicsLayer.add(this._activeLineGraphic)};ha._showFillGraphic=function(O){this._activeFillGraphic?(this._activeFillGraphic.set({geometry:O,symbol:this.activeFillSymbol}),this._internalGraphicsLayer.remove(this._activeFillGraphic)):this._activeFillGraphic=new w(O,this.activeFillSymbol);this._internalGraphicsLayer.add(this._activeFillGraphic)};ha._showLineGraphic=function(O){this._lineGraphic?
(this._lineGraphic.set({geometry:O,symbol:this.polylineSymbol}),this._internalGraphicsLayer.remove(this._lineGraphic)):this._lineGraphic=new w(O,this.polylineSymbol);this._internalGraphicsLayer.add(this._lineGraphic)};ha._showVertexGraphic=function(O,ca){O=new w(O,ca?this.activeVertexSymbol:this.vertexSymbol);this._vertexGraphics.push(O);this._internalGraphicsLayer.add(O)};ha._resetCreateOperationGraphics=function(){this._removeActiveFillGraphic();this._removeLineGraphic();this._removeActiveLineGraphic();
this._removeVertexGraphics();this._removeCloneGraphics()};ha._removeCreateGraphic=function(){this.createGraphic&&(this._internalGraphicsLayer.remove(this.createGraphic),this._set("createGraphic",null))};ha._removeCreateOperationGraphics=function(){this._removeCenterIndicatorGraphic();this._removeActiveLineGraphic();this._removeActiveFillGraphic();this._removeLineGraphic();this._removeVertexGraphics()};ha._removeActiveLineGraphic=function(){this._activeLineGraphic&&(this._internalGraphicsLayer.remove(this._activeLineGraphic),
this._activeLineGraphic.destroy(),this._activeLineGraphic=null)};ha._removeActiveFillGraphic=function(){this._activeFillGraphic&&(this._internalGraphicsLayer.remove(this._activeFillGraphic),this._activeFillGraphic.destroy(),this._activeFillGraphic=null)};ha._removeLineGraphic=function(){this._lineGraphic&&(this._internalGraphicsLayer.remove(this._lineGraphic),this._lineGraphic.destroy(),this._lineGraphic=null)};ha._removeVertexGraphics=function(){this._vertexGraphics.length&&(this._internalGraphicsLayer.removeMany(this._vertexGraphics),
this._vertexGraphics.forEach(O=>O.destroy()),this._vertexGraphics=[])};ha._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer.destroy(),this._internalGraphicsLayer=null)};ha._operationHandleForCreateAction=function(O,ca,ea){return new X.OperationHandle({activeComponent:this._draw,tool:ea,type:"create",onEnd:()=>{ca.forEach(ba=>ba.remove());ca.length=0;this._removeCreateOperationGraphics();
this._internalGraphicsLayer&&this._internalGraphicsLayer.remove(this.createGraphic);this._displayDefaultCursor()},undo:()=>{O.undo();this._emitUndoEvent({graphics:[this.createGraphic],tool:ea})},redo:()=>{O.redo();this._emitRedoEvent({graphics:[this.createGraphic],tool:ea})},canUndo:()=>O&&O.canUndo(),canRedo:()=>O&&O.canRedo()})};ha._isComponentGraphic=function(O){const {activeComponent:ca}=this;return!O||d.isNone(ca)?!1:O.attributes&&O.attributes.esriSketchTool?!0:("box"===ca.type||"reshape"===
ca.type)&&ca.isUIGraphic(O)};ha._snapLastPolygonVertexToFirst=function(O,ca){if(!("polygon"!==O&&2>=ca.length)){O=ca[0];ca=ca[ca.length-1];var ea=this.view.toScreen(new c(O[0],O[1],this.view.spatialReference)),ba=this.view.toScreen(new c(ca[0],ca[1],this.view.spatialReference));this._isWithinScreenDistance(ea,ba,this._getVertexIntersectDistance())&&(ca[0]=O[0],ca[1]=O[1])}};ha._getVertexIntersectDistance=function(){return this.vertexSymbol&&"simple-marker"===this.vertexSymbol.type?G.pt2px(this.vertexSymbol.size)/
2+3:3};ha._isWithinScreenDistance=function(O,ca,ea){const ba=O.x-ca.x;O=O.y-ca.y;return Math.sqrt(ba*ba+O*O)<=ea};ha._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};ha._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};ha._displayCrosshairCursor=function(){this.view&&this.view.container&&"crosshair"!==this.view.cursor&&(this.view.cursor="crosshair")};
ha._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};ha._logError=function(O,ca,ea){ja.error(new r(O,ca,ea))};ha._requireModule=async function(O){const ca=new AbortController;this._moduleLoaderAbortController=ca;O=await O;return this._moduleLoaderAbortController!==ca||ca.signal.aborted?{requireError:"aborted"}:{module:O}};ha._emitUndoEvent=function(O){this.emit("undo",{...O,type:"undo"})};ha._emitRedoEvent=function(O){this.emit("redo",
{...O,type:"redo"})};ha._emitDeleteEvent=function(O){this.emit("delete",{...O,type:"delete"})};ha.createPointFromVertex=function(O){return 2<O.length?new c(O[0],O[1],O[2],this.view.spatialReference):new c(O[0],O[1],this.view.spatialReference)};ha.test=function(){return this._operationHandle};ha.wait=function(){return N.whenNotOnce(this,"updating")};ha._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};ha._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};
ha._disablePopupEnabled=function(O){var ca;return"3d"!==(null==(ca=this.view)?void 0:ca.type)||this.updateOnGraphicClick||d.isSome(O)&&O.toggleToolOnClick};ha._disablePopup=function(O){this._disablePopupEnabled(O)&&(O=this.view.popup)&&d.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=O.autoOpenEnabled,O.autoOpenEnabled=!1)};ha._restorePopup=function(O){this._disablePopupEnabled(O)&&(O=this.view.popup)&&d.isSome(this._originalAutoOpenEnabled)&&(O.autoOpenEnabled=this._originalAutoOpenEnabled,
this._originalAutoOpenEnabled=null)};ha._waitViewReady=async function(){this.view&&(d.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=x.createAbortController(),await x.whenOrAbort(N.whenOnce(this.view,"ready"),this._viewReadyAbortController.signal))};e._createClass(ia,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view.type?"move":"transform"}},{key:"_draw",get:function(){return"ready"===this.state||"active"===this.state?new M({view:this.view}):null}},{key:"updating",
get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return this.view&&"3d"===this.view.type&&d.isSome(this.activeComponent)&&"draw-3d"===this.activeComponent.type?d.unwrap(this.activeComponent.createGraphic):this._get("createGraphic")}},
{key:"defaultCreateOptions",set:function(O){this._set("defaultCreateOptions",{...da,...O})}},{key:"defaultUpdateOptions",set:function(O){this._set("defaultUpdateOptions",{...ka,...O})}},{key:"snappingOptions",set:function(O){d.isSome(this._snappingManager)&&(this._snappingManager.options=O);this._set("snappingOptions",O)}},{key:"state",get:function(){var O;const ca=!(null==(O=this.view)||!O.ready||!this.layer);O=this._operationHandle;return ca&&O?"active":ca?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},
set:function(O){const ca=this._get("view");if(ca){const {container:ea,map:ba}=ca;ea&&(ca.cursor=null);ba&&ba.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._doUnnormalization=null!=O&&"3d"===O.type&&"global"===O.viewingMode;this._handles.remove("view-ready");O&&this._handles.add(N.when(O,"ready",ea=>{this._viewHandles.removeAll();ea&&this._viewHandles.add(this._generateViewHandles(O))},!0),"view-ready");this._set("view",O)}}]);return ia}(g.EventedAccessor);l.__decorate([b.property({readOnly:!0})],
B.prototype,"_draw",null);l.__decorate([b.property()],B.prototype,"updating",null);l.__decorate([b.property()],B.prototype,"_operationHandle",void 0);l.__decorate([b.property({readOnly:!0})],B.prototype,"activeTool",null);l.__decorate([b.property()],B.prototype,"activeFillSymbol",void 0);l.__decorate([b.property()],B.prototype,"activeLineSymbol",void 0);l.__decorate([b.property()],B.prototype,"activeVertexSymbol",void 0);l.__decorate([b.property({readOnly:!0})],B.prototype,"createGraphic",null);l.__decorate([b.property()],
B.prototype,"defaultCreateOptions",null);l.__decorate([b.property()],B.prototype,"defaultUpdateOptions",null);l.__decorate([b.property()],B.prototype,"layer",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"pointSymbol",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"polygonSymbol",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"polylineSymbol",void 0);l.__decorate([b.property({type:K,nonNullable:!0})],B.prototype,"snappingOptions",
null);l.__decorate([b.property()],B.prototype,"_snappingManager",void 0);l.__decorate([b.property({readOnly:!0})],B.prototype,"state",null);l.__decorate([b.property({readOnly:!0})],B.prototype,"updateGraphics",void 0);l.__decorate([b.property()],B.prototype,"updateOnGraphicClick",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"updatePointSymbol",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"updatePolygonSymbol",void 0);l.__decorate([b.property({types:z.symbolTypes})],
B.prototype,"updatePolylineSymbol",void 0);l.__decorate([b.property({types:z.symbolTypes})],B.prototype,"vertexSymbol",void 0);l.__decorate([b.property({value:null})],B.prototype,"view",null);l.__decorate([b.property()],B.prototype,"cancel",null);l.__decorate([b.property()],B.prototype,"complete",null);l.__decorate([b.property()],B.prototype,"delete",null);l.__decorate([b.property()],B.prototype,"create",null);l.__decorate([b.property()],B.prototype,"update",null);l.__decorate([b.property()],B.prototype,
"undo",null);l.__decorate([b.property()],B.prototype,"redo",null);l.__decorate([b.property()],B.prototype,"canUndo",null);l.__decorate([b.property()],B.prototype,"canRedo",null);l.__decorate([b.property()],B.prototype,"toggleUpdateTool",null);return B=l.__decorate([q.subclass("esri.widgets.Sketch.SketchViewModel")],B)})},"esri/views/draw/Draw":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../chunks/MultipointDrawAction ./PointDrawAction ./PolygonDrawAction ./PolylineDrawAction ./SegmentDrawAction".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){l=function(h){function g(){var n=h.apply(this,arguments)||this;n.activeAction=null;n.type="draw";n.view=null;return n}a._inheritsLoose(g,h);var k=g.prototype;k.destroy=function(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)};k.create=function(n,G){this.reset();G={view:this.view,...G};switch(n){case "point":G.editGeometryType="point";this.activeAction=new y.PointDrawAction(G);break;case "polyline":G.editGeometryType="polyline";
this.activeAction=new c.PolylineDrawAction(G);break;case "multipoint":G.editGeometryType="polygon";this.activeAction=new D.MultipointDrawAction(G);break;case "polygon":G.editGeometryType="polygon";this.activeAction=new x.PolygonDrawAction(G);break;case "rectangle":case "circle":case "ellipse":case "triangle":G.editGeometryType="polygon",this.activeAction=new m.SegmentDrawAction(G)}return this.activeAction};k.complete=function(){this.activeAction&&this.activeAction.complete();this.activeAction=null};
k.reset=function(){this.activeAction&&this.activeAction.destroy();this.activeAction=null};return g}(v);e.__decorate([f.property()],l.prototype,"activeAction",void 0);e.__decorate([f.property({readOnly:!0})],l.prototype,"type",void 0);e.__decorate([f.property()],l.prototype,"view",void 0);return l=e.__decorate([b.subclass("esri.views.draw.Draw")],l)})},"esri/chunks/MultipointDrawAction":function(){define("exports ./_rollupPluginBabelHelpers ./tslib.es6 ../core/has ../core/maybe ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../geometry/Point ../geometry ../core/Handles ../views/input/InputManager ../views/support/screenUtils ../views/draw/DrawAction ../views/draw/input/DrawEvents ../views/draw/input/Keys".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n){a.MultipointDrawAction=function(G){function C(A){A=G.call(this,A)||this;A._cursorScreenPoint=null;A._popVertexOnPointerMove=!1;A._addVertexOnPointerUp=!1;A._activePointerId=null;A._viewHandles=new c;A._undoRedoHandles=new c;return A}e._inheritsLoose(C,G);var t=C.prototype;t.initialize=function(){this._addViewHandles();this._addUndoRedoHandles()};t.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this._removeUndoRedoHandles();
this._undoRedoHandles.destroy();this.emit("destroy")};t.undo=function(){G.prototype.undo.call(this);this.notifyChange("vertices")};t.redo=function(){G.prototype.redo.call(this);this.notifyChange("vertices")};t.complete=function(){this._completeDrawing()};t._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("click",A=>{A.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",A=>{this._shouldHandlePointerEvent(A)&&(this._snappingTask=d.abortMaybe(this._snappingTask),
this._activePointerId=A.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(A),"touch"===A.pointerType&&this._updateCursor(A.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",A=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1);this._snappingTask=d.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(A);"touch"!==A.pointerType&&this._updateCursor(A.native)},m.ViewEventPriorities.TOOL),
this.view.on("pointer-drag",A=>{this._shouldHandlePointerEvent(A)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._addVertexOnPointerUp=!1)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",A=>{this._shouldHandlePointerEvent(A)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._vertexAddHandler(A):this._updateCursor(A.native,"touch"===A.pointerType))},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],A=>{A.stopPropagation()},
m.ViewEventPriorities.TOOL),this.view.on("double-click",A=>{A.stopPropagation();this._drawCompleteHandler(A)},m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],A=>{A.stopPropagation();this._drawCompleteHandler(A)},m.ViewEventPriorities.TOOL),this.view.on("key-down",A=>{const {key:z,repeat:w}=A;z===n.KEYS.vertexAddKey&&!w&&this._cursorScreenPoint?(A.stopPropagation(),this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler(A)):z===n.KEYS.drawCompleteKey&&!w&&this._cursorScreenPoint&&
2<this.vertices.length?(A.stopPropagation(),this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler(A),this._drawCompleteHandler(A)):z!==n.KEYS.undoKey||this.interactiveUndoDisabled||w?z!==n.KEYS.redoKey||this.interactiveUndoDisabled||w?z!==n.KEYS.panKey||w||A.stopPropagation():(A.stopPropagation(),this.redo()):(A.stopPropagation(),this.undo())},m.ViewEventPriorities.TOOL),this.view.on("key-up",A=>{A.key===n.KEYS.panKey&&A.stopPropagation()},m.ViewEventPriorities.TOOL)])};t._addUndoRedoHandles=
function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",A=>{this.notifyChange("vertices");if("undo"===A.operation){const z=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(z);const w=[...this._committedVertices];d.isSome(this._stagedVertex)&&w.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("undo",new k.VertexRemoveEvent(this.view,z,A.vertices[0].index,w))}}),this._editGeometry.on("vertex-add",
A=>{this.notifyChange("vertices");if("apply"===A.operation)A=new k.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",A),A.defaultPrevented&&(this._popVertexOnPointerMove=!0);else if("redo"===A.operation){const z=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(z);const w=[...this._committedVertices];d.isSome(this._stagedVertex)&&w.push(this._coordinateHelper.pointToArray(this._stagedVertex));
this.emit("redo",new k.VertexAddEvent(this.view,z,A.vertices[0].index,w))}})])};t._removeViewHandles=function(){this._viewHandles.removeAll()};t._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};t._addVertex=function(A,z){A=this._coordinateHelper.fromArray(A);this._isDuplicateOfLastVertex(A)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(A),z=z||new Event("placeholder"),this._nativeEventHistory.undoStack.push(z))};
t._updateCursor=function(A,z=!1){this._popCursorVertex();if(this._cursorScreenPoint){var w=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(d.isSome(w)&&!z){this._pushCursorVertex(w.vertex);const F=()=>new k.CursorUpdateEvent(this.view,A,this._activeComponent.vertices.length,this.vertices,d.isSome(this._stagedVertex)?new y(this._stagedVertex):null);this.emit("cursor-update",F());d.isSome(this._snappingTask)&&this._snappingTask.promise.then(E=>{E.valid&&this.emit("cursor-update",F())},
()=>{})}}};t._completeDrawing=function(A){this._activePointerId=null;this._popCursorVertex();this._snappingTask=d.abortMaybe(this._snappingTask);d.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();2>this.vertices.length||(A=new k.DrawCompleteEvent(A,this.vertices),this.emit("draw-complete",A),A.defaultPrevented||this._removeViewHandles())};t._shouldHandlePointerEvent=function(A){return("mouse"!==A.pointerType||0===A.button)&&(d.isNone(this._activePointerId)||this._activePointerId===
A.pointerId)};t._vertexAddHandler=function(A){const z=d.isSome(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);d.isSome(z)&&this._addVertex(z,A.native)};t._drawCompleteHandler=function(A){this._completeDrawing(A.native)};return C}(g);a.MultipointDrawAction=l.__decorate([q.subclass("esri.views.draw.MultipointDrawAction")],a.MultipointDrawAction);l=Object.freeze({__proto__:null,get MultipointDrawAction(){return a.MultipointDrawAction}});
a.MultipointDrawAction$1=l})},"esri/views/draw/DrawAction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/Evented ../../core/screenUtils ../../layers/graphics/dehydratedFeatures ../2d/interactive/SnappingVisualizer2D ../interactive/coordinateHelper ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryHelper ../interactive/snapping/SnappingContext".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n){l=function(t){function A(w){var F;var E=t.call(this,w)||this;E._hasZ=null;E._snappingTask=null;E._stagedVertex=null;E._stagedVertexUnsnapped=null;E._lastVertexUnsnapped=null;E._nativeEventHistory={undoStack:[],redoStack:[]};E.interactiveUndoDisabled=!1;E.history=[];E.redoHistory=[];E.snapToScene=!1;E.view=null;E.elevationInfo=null;E.defaultZ=0;E._coordinateHelper=h.createCoordinateHelper(w.hasZ,!1,w.view.spatialReference,"local");E._snappingManager=
w.snappingManager;E._editGeometry=new k.EditGeometryHelper(new g.EditGeometry(E._coordinateHelper),null!=(F=w.editGeometryType)?F:"polygon");E._snappingContext=new n.SnappingContext({geometry:E._editGeometry,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new m.SnappingVisualizer2D});E._activeComponent=new g.Component(E._editGeometry.editGeometry);E._editGeometry.editGeometry.components.push(E._activeComponent);return E}a._inheritsLoose(A,t);var z=A.prototype;z.destroy=function(){this._snappingTask=
B.abortMaybe(this._snappingTask);B.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();this._editGeometry.destroy()};z.canUndo=function(){return this._editGeometry.editGeometry.canUndo};z.canRedo=function(){return this._editGeometry.editGeometry.canRedo};z.undo=function(){this.canUndo()&&this._editGeometry.undo()};z.redo=function(){this.canRedo()&&this._editGeometry.redo()};z.getCoordsFromScreenPoint=function(w){w=this.screenToMap(w);return B.isSome(w)?w.hasZ?[w.x,w.y,w.z]:[w.x,w.y]:
null};z.getCoordsAndPointFromScreenPoint=function(w){w=this.screenToMap(w);return B.isSome(w)?w.hasZ?{vertex:[w.x,w.y,w.z],mapPoint:w}:{vertex:[w.x,w.y],mapPoint:w}:null};z._pushCursorVertex=function(w){const F=c.makeDehydratedPoint(w[0],w[1],null,this.view.spatialReference);this._stagedVertexUnsnapped=F;B.isNone(this._snappingManager)?this._stagedVertex=F:(this._stagedVertex=this._snappingManager.update(F,this._snappingContext),this._snappingTask=D.createTask(async E=>B.isSome(this._snappingManager)?
(E=await this._snappingManager.snap(F,this._snappingContext,E),E.valid&&(this._stagedVertex=E.apply(),this.notifyChange("vertices")),E):null))};z._popCursorVertex=function(){this._stagedVertexUnsnapped=this._stagedVertex=null;this.notifyChange("vertices")};z.getGeometryZValue=function(){return this.defaultZ};z.screenToMap=function(w){var F=null;"3d"===this.view.type?this.hasZ?(F=B.unwrapOr(this.elevationInfo,G),F=this.view.sceneIntersectionHelper.intersectElevationFromScreen(x.createScreenPointArray(w.x,
w.y),F,this.getGeometryZValue())):(F=B.unwrapOr(this.elevationInfo,C),F=this.view.sceneIntersectionHelper.intersectElevationFromScreen(x.createScreenPointArray(w.x,w.y),F,0),B.isSome(F)&&(F.z=void 0)):(F=this.view.toMap(w),B.isSome(F)&&(F.z=this.hasZ?this.getGeometryZValue():void 0));return F};z._isDuplicateOfLastVertex=function(w){const F=this._editGeometry.editGeometry.components[0].getLastVertex();if(B.isSome(F)&&w[0]===F[0]&&w[1]===F[1])return!0;const {x:E,y:N}=this._coordinateHelper.createDehydratedPoint(w);
return B.isSome(this._lastVertexUnsnapped)&&E===this._lastVertexUnsnapped.x&&N===this._lastVertexUnsnapped.y?!0:!1};a._createClass(A,[{key:"_committedVertices",get:function(){return this._editGeometry.editGeometry.components[0].vertices.map(w=>w.pos)}},{key:"vertices",get:function(){return B.isSome(this._stagedVertex)?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:this._committedVertices}},{key:"hasZ",get:function(){return B.isSome(this._hasZ)?this._hasZ:"3d"===
this.view.type},set:function(w){this._hasZ=w;this.notifyChange("hasZ")}}]);return A}(y.EventedAccessor);e.__decorate([u.property({readOnly:!0})],l.prototype,"vertices",null);e.__decorate([u.property({type:Boolean,nonNullable:!0})],l.prototype,"interactiveUndoDisabled",void 0);e.__decorate([u.property({readOnly:!0})],l.prototype,"history",void 0);e.__decorate([u.property({readOnly:!0})],l.prototype,"redoHistory",void 0);e.__decorate([u.property()],l.prototype,"snapToScene",void 0);e.__decorate([u.property()],
l.prototype,"view",void 0);e.__decorate([u.property()],l.prototype,"elevationInfo",void 0);e.__decorate([u.property({nonNullable:!0})],l.prototype,"defaultZ",void 0);e.__decorate([u.property()],l.prototype,"hasZ",null);l=e.__decorate([p.subclass("esri.views.draw.DrawAction")],l);const G={mode:"absolute-height",offset:0},C={mode:"on-the-ground",offset:0};return l})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../core/has ../../core/typedArrayUtil ../../core/maybe ../../geometry/SpatialReference ../../geometry/support/typeUtils ../../core/uid ../../geometry/support/aaBoundingRect ../support/Field ../../core/byteSizeEstimations ../../geometry/support/aaBoundingBox ../../geometry/support/quantizationUtils ./dehydratedFeatureComparison".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D){function y(k,n,G){if(!k)return null;switch(n){case "point":return{x:k.x,y:k.y,z:k.z,m:k.m,hasZ:null!=k.z,hasM:null!=k.m,type:"point",spatialReference:G};case "polyline":return{paths:k.paths,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"polyline",spatialReference:G};case "polygon":return{rings:k.rings,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"polygon",spatialReference:G};case "multipoint":return{points:k.points,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"multipoint",spatialReference:G}}}function x(k){if(B.isNone(k))return 0;
let n=32;switch(k.type){case "point":n+=42;break;case "polyline":case "polygon":{var G=0;const C=2+(k.hasZ?1:0)+(k.hasM?1:0);k="polyline"===k.type?k.paths:k.rings;for(const t of k)G+=t.length;n+=8*G*C+64;n+=128*G;n=n+34+32*(k.length+1);break}case "multipoint":G=k.points.length;n+=8*G*(2+(k.hasZ?1:0)+(k.hasM?1:0))+64;n+=128*G;n=n+34+32;break;case "extent":n+=98;k.hasM&&(n+=32);k.hasZ&&(n+=32);break;case "mesh":n+=l.estimateSize(k.vertexAttributes.position),n+=l.estimateSize(k.vertexAttributes.normal),
n+=l.estimateSize(k.vertexAttributes.uv),n+=l.estimateSize(k.vertexAttributes.tangent)}return n}function c(k,n){r.empty(n);"mesh"===k.type&&(k=k.extent);switch(k.type){case "point":n[0]=n[3]=k.x;n[1]=n[4]=k.y;k.hasZ&&(n[2]=n[5]=k.z);break;case "polyline":for(var G=0;G<k.paths.length;G++)r.expandWithNestedArray(n,k.paths[G],k.hasZ);break;case "polygon":for(G=0;G<k.rings.length;G++)r.expandWithNestedArray(n,k.rings[G],k.hasZ);break;case "multipoint":r.expandWithNestedArray(n,k.points,k.hasZ);break;
case "extent":n[0]=k.xmin,n[1]=k.ymin,n[3]=k.xmax,n[4]=k.ymax,null!=k.zmin&&(n[2]=k.zmin),null!=k.zmax&&(n[5]=k.zmax)}}function m(k,n){b.empty(n);"mesh"===k.type&&(k=k.extent);switch(k.type){case "point":n[0]=n[2]=k.x;n[1]=n[3]=k.y;break;case "polyline":for(var G=0;G<k.paths.length;G++)b.expandWithNestedArray(n,k.paths[G]);break;case "polygon":for(G=0;G<k.rings.length;G++)b.expandWithNestedArray(n,k.rings[G]);break;case "multipoint":b.expandWithNestedArray(n,k.points);break;case "extent":n[0]=k.xmin,
n[1]=k.ymin,n[2]=k.xmax,n[3]=k.ymax}}const h=r.create(),g=b.create();a.equals=D.equals;a.DehydratedFeatureClass=function(k,n,G){this.uid=k;this.geometry=n;this.attributes=G;this.visible=!0;this.centroid=this.objectId=null};a.DehydratedFeatureSetClass=function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null};a.computeAABB=
c;a.computeAABR=m;a.estimateGeometryObjectSize=x;a.estimateSize=function(k){let n;n=32+q.estimateAttributesObjectSize(k.attributes);return n=n+3+(8+x(k.geometry))};a.expandAABB=function(k,n){c(k,h);r.expandWithAABB(n,h)};a.expandAABR=function(k,n){m(k,g);b.expand(n,g)};a.fromFeatureSetJSON=function(k){const n=f.featureGeometryTypeKebabDictionary.fromJSON(k.geometryType),G=d.fromJSON(k.spatialReference),C=k.transform,t=k.features.map(A=>{var z=k.objectIdFieldName;A={uid:u.generateUID(),objectId:z&&
A.attributes?A.attributes[z]:null,attributes:A.attributes,geometry:y(A.geometry,n,G),visible:!0};if((z=A.geometry)&&C)switch(z.type){case "point":A.geometry=v.unquantizePoint(C,z,z,z.hasZ,z.hasM);break;case "multipoint":A.geometry=v.unquantizeMultipoint(C,z,z,z.hasZ,z.hasM);break;case "polygon":A.geometry=v.unquantizePolygon(C,z,z,z.hasZ,z.hasM);break;case "polyline":A.geometry=v.unquantizePolyline(C,z,z,z.hasZ,z.hasM)}return A});return{geometryType:n,features:t,spatialReference:G,fields:k.fields?
k.fields.map(A=>p.fromJSON(A)):null,objectIdFieldName:k.objectIdFieldName,globalIdFieldName:k.globalIdFieldName,geohashFieldName:k.geohashFieldName,geometryProperties:k.geometryProperties,hasZ:k.hasZ,hasM:k.hasM,exceededTransferLimit:k.exceededTransferLimit,transform:null}};a.fromJSONGeometry=y;a.getObjectId=function(k,n){return null!=k.objectId?k.objectId:k.attributes&&n?k.attributes[n]:null};a.hasGeometry=function(k){return B.isSome(k.geometry)};a.hasVertices=function(k){if(!k)return!1;switch(k.type){case "extent":case "point":return!0;
case "polyline":for(const n of k.paths)if(0<n.length)return!0;return!1;case "polygon":for(const n of k.rings)if(0<n.length)return!0;return!1;case "multipoint":return 0<k.points.length;case "mesh":return k.vertexAttributes&&k.vertexAttributes.position&&0<k.vertexAttributes.position.length}};a.isDehydratedPoint=function(k){return"point"===k.type};a.isFeatureGeometry=function(k){return f.isFeatureGeometryType(k.type)};a.makeDehydratedPoint=function(k,n,G,C){return{x:k,y:n,z:G,hasZ:null!=G,hasM:!1,spatialReference:C,
type:"point"}};a.numVertices=function(k){if(B.isNone(k))return 0;switch(k.type){case "point":return 1;case "polyline":var n=0;for(var G of k.paths)n+=G.length;return n;case "polygon":G=0;for(n of k.rings)G+=n.length;return G;case "multipoint":return k.points.length;case "extent":return 2;case "mesh":return(k=k.vertexAttributes&&k.vertexAttributes.position)?k.length/3:0}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has",
"../../core/maybe","../Extent"],function(a,e,l,B){function d(y=D){return[y[0],y[1],y[2],y[3]]}function f(y){return y[0]>=y[2]?0:y[2]-y[0]}function u(y){return y[1]>=y[3]?0:y[3]-y[1]}function b(y,x,c){return x>=y[0]&&c>=y[1]&&x<=y[2]&&c<=y[3]}function p(y,x){y[0]=x[0];y[1]=x[1];y[2]=x[2];y[3]=x[3];return y}function q(y){return 4===y.length}function r(y,x,c){return y<x?x:y>c?c:y}const v=[Infinity,Infinity,-Infinity,-Infinity],D=[0,0,0,0];a.NEGATIVE_INFINITY=v;a.POSITIVE_INFINITY=[-Infinity,-Infinity,
Infinity,Infinity];a.UNIT=[0,0,1,1];a.ZERO=D;a.allFinite=function(y){for(let x=0;4>x;x++)if(!isFinite(y[x]))return!1;return!0};a.area=function(y){return f(y)*u(y)};a.center=function(y,x=[0,0]){x[0]=(y[0]+y[2])/2;x[1]=(y[1]+y[3])/2;return x};a.clone=function(y){return[y[0],y[1],y[2],y[3]]};a.contains=function(y,x){return x[0]>=y[0]&&x[2]<=y[2]&&x[1]>=y[1]&&x[3]<=y[3]};a.containsPoint=function(y,x){return b(y,x[0],x[1])};a.containsPointObject=function(y,x){return b(y,x.x,x.y)};a.containsPointWithMargin=
function(y,x,c){return x[0]>=y[0]-c&&x[1]>=y[1]-c&&x[0]<=y[2]+c&&x[1]<=y[3]+c};a.containsXY=b;a.create=d;a.diameter=function(y){const x=f(y);y=u(y);return Math.sqrt(x*x+y*y)};a.distance=function(y,x){const c=(y[1]+y[3])/2,m=Math.max(Math.abs(x[0]-(y[0]+y[2])/2)-f(y)/2,0);y=Math.max(Math.abs(x[1]-c)-u(y)/2,0);return Math.sqrt(m*m+y*y)};a.empty=function(y){return y?p(y,v):d(v)};a.equals=function(y,x,c){if(l.isNone(y)||l.isNone(x))return y===x;if(!q(y)||!q(x))return!1;if(c)for(let m=0;m<y.length;m++){if(!c(y[m],
x[m]))return!1}else for(c=0;c<y.length;c++)if(y[c]!==x[c])return!1;return!0};a.expand=function(y,x,c=y){if("length"in x)if(q(x))c[0]=Math.min(y[0],x[0]),c[1]=Math.min(y[1],x[1]),c[2]=Math.max(y[2],x[2]),c[3]=Math.max(y[3],x[3]);else{if(2===x.length||3===x.length)c[0]=Math.min(y[0],x[0]),c[1]=Math.min(y[1],x[1]),c[2]=Math.max(y[2],x[0]),c[3]=Math.max(y[3],x[1])}else switch(x.type){case "extent":c[0]=Math.min(y[0],x.xmin);c[1]=Math.min(y[1],x.ymin);c[2]=Math.max(y[2],x.xmax);c[3]=Math.max(y[3],x.ymax);
break;case "point":c[0]=Math.min(y[0],x.x),c[1]=Math.min(y[1],x.y),c[2]=Math.max(y[2],x.x),c[3]=Math.max(y[3],x.y)}return c};a.expandPointInPlace=function(y,x){x[0]<y[0]&&(y[0]=x[0]);x[0]>y[2]&&(y[2]=x[0]);x[1]<y[1]&&(y[1]=x[1]);x[1]>y[3]&&(y[3]=x[1])};a.expandWithNestedArray=function(y,x,c=y){const m=x.length;let h=y[0],g=y[1],k=y[2];y=y[3];for(let n=0;n<m;n++){const G=x[n];h=Math.min(h,G[0]);g=Math.min(g,G[1]);k=Math.max(k,G[0]);y=Math.max(y,G[1])}c[0]=h;c[1]=g;c[2]=k;c[3]=y;return c};a.fromExtent=
function(y,x=d()){x[0]=y.xmin;x[1]=y.ymin;x[2]=y.xmax;x[3]=y.ymax;return x};a.fromValues=function(y,x,c,m,h=d()){h[0]=y;h[1]=x;h[2]=c;h[3]=m;return h};a.height=u;a.intersection=function(y,x,c=y){const m=x[0],h=x[1],g=x[2];x=x[3];c[0]=r(y[0],m,g);c[1]=r(y[1],h,x);c[2]=r(y[2],m,g);c[3]=r(y[3],h,x);return c};a.intersects=function(y,x){return Math.max(x[0],y[0])<=Math.min(x[2],y[2])&&Math.max(x[1],y[1])<=Math.min(x[3],y[3])};a.is=q;a.isPoint=function(y){return(0===f(y)||!isFinite(y[0]))&&(0===u(y)||!isFinite(y[1]))};
a.offset=function(y,x,c,m=y){m[0]=y[0]+x;m[1]=y[1]+c;m[2]=y[2]+x;m[3]=y[3]+c;return m};a.pad=function(y,x,c=y){c[0]=y[0]-x;c[1]=y[1]-x;c[2]=y[2]+x;c[3]=y[3]+x;return c};a.set=p;a.setMax=function(y,x,c=y){c[2]=x[0];c[3]=x[1];c!==y&&(c[0]=y[0],c[1]=y[1]);return y};a.setMin=function(y,x,c=y){c[0]=x[0];c[1]=x[1];c!==y&&(c[2]=y[2],c[3]=y[3]);return c};a.size=function(y,x){x[0]=y[2]-y[0];x[1]=y[3]-y[1]};a.toExtent=function(y,x){return new B({xmin:y[0],ymin:y[1],xmax:y[2],ymax:y[3],spatialReference:x})};
a.width=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(a){function e(l){return 32+l.length}a.estimateAttributesObjectSize=function(l){if(!l)return 0;let B=32;for(const d in l)if(l.hasOwnProperty(d)){const f=l[d];switch(typeof f){case "string":B+=e(f);break;case "number":B+=16;break;case "boolean":B+=4}}return B};a.estimateFixedArraySize=function(l,B){return 32+l.length*B};a.estimateNumberByteSize=function(){return 16};a.estimateStringByteSize=
e;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent","./aaBoundingRect"],function(a,e,l,B){function d(c=y){return[c[0],c[1],c[2],c[3],c[4],c[5]]}function f(c,m,h,g,k,n,G=d()){G[0]=c;G[1]=m;G[2]=h;G[3]=g;G[4]=k;G[5]=n;return G}function u(c){return c[0]>=c[3]?0:c[3]-c[0]}function b(c){return c[1]>=c[4]?0:c[4]-c[1]}function p(c){return c[2]>=c[5]?0:c[5]-c[2]}function q(c,m){return Math.max(m[0],c[0])<=
Math.min(m[3],c[3])&&Math.max(m[1],c[1])<=Math.min(m[4],c[4])&&Math.max(m[2],c[2])<=Math.min(m[5],c[5])}function r(c,m){c[0]=m[0];c[1]=m[1];c[2]=m[2];c[3]=m[3];c[4]=m[4];c[5]=m[5];return c}function v(c){return 6===c.length}const D=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],y=[0,0,0,0,0,0],x=d();a.NEGATIVE_INFINITY=D;a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.ZERO=y;a.allFinite=function(c){for(let m=0;6>m;m++)if(!isFinite(c[m]))return!1;return!0};
a.center=function(c,m=[0,0,0]){m[0]=c[0]+u(c)/2;m[1]=c[1]+b(c)/2;m[2]=c[2]+p(c)/2;return m};a.contains=function(c,m){return m[0]>=c[0]&&m[1]>=c[1]&&m[2]>=c[2]&&m[3]<=c[3]&&m[4]<=c[4]&&m[5]<=c[5]};a.containsPoint=function(c,m){return m[0]>=c[0]&&m[1]>=c[1]&&m[2]>=c[2]&&m[0]<=c[3]&&m[1]<=c[4]&&m[2]<=c[5]};a.containsPointWithMargin=function(c,m,h){return m[0]>=c[0]-h&&m[1]>=c[1]-h&&m[2]>=c[2]-h&&m[0]<=c[3]+h&&m[1]<=c[4]+h&&m[2]<=c[5]+h};a.create=d;a.depth=b;a.diameter=function(c){const m=u(c),h=p(c);
c=b(c);return Math.sqrt(m*m+h*h+c*c)};a.empty=function(c){return c?r(c,D):d(D)};a.equals=function(c,m,h){if(e.isNone(c)||e.isNone(m))return c===m;if(!v(c)||!v(m))return!1;if(h)for(let g=0;g<c.length;g++){if(!h(c[g],m[g]))return!1}else for(h=0;h<c.length;h++)if(c[h]!==m[h])return!1;return!0};a.expandWithAABB=function(c,m){c[0]=Math.min(c[0],m[0]);c[1]=Math.min(c[1],m[1]);c[2]=Math.min(c[2],m[2]);c[3]=Math.max(c[3],m[3]);c[4]=Math.max(c[4],m[4]);c[5]=Math.max(c[5],m[5])};a.expandWithBuffer=function(c,
m,h=0,g=m.length/3){let k=c[0],n=c[1],G=c[2],C=c[3],t=c[4],A=c[5];for(let z=0;z<g;z++)k=Math.min(k,m[h+3*z]),n=Math.min(n,m[h+3*z+1]),G=Math.min(G,m[h+3*z+2]),C=Math.max(C,m[h+3*z]),t=Math.max(t,m[h+3*z+1]),A=Math.max(A,m[h+3*z+2]);c[0]=k;c[1]=n;c[2]=G;c[3]=C;c[4]=t;c[5]=A};a.expandWithNestedArray=function(c,m,h){const g=m.length;let k=c[0],n=c[1],G=c[2],C=c[3],t=c[4],A=c[5];if(h)for(h=0;h<g;h++){var z=m[h];k=Math.min(k,z[0]);n=Math.min(n,z[1]);G=Math.min(G,z[2]);C=Math.max(C,z[0]);t=Math.max(t,z[1]);
A=Math.max(A,z[2])}else for(h=0;h<g;h++)z=m[h],k=Math.min(k,z[0]),n=Math.min(n,z[1]),C=Math.max(C,z[0]),t=Math.max(t,z[1]);c[0]=k;c[1]=n;c[2]=G;c[3]=C;c[4]=t;c[5]=A};a.expandWithOffset=function(c,m,h,g){c[0]=Math.min(c[0],c[0]+m);c[3]=Math.max(c[3],c[3]+m);c[1]=Math.min(c[1],c[1]+h);c[4]=Math.max(c[4],c[4]+h);c[2]=Math.min(c[2],c[2]+g);c[5]=Math.max(c[5],c[5]+g)};a.expandWithRect=function(c,m){c[0]=Math.min(c[0],m[0]);c[1]=Math.min(c[1],m[1]);c[3]=Math.max(c[3],m[2]);c[4]=Math.max(c[4],m[3])};a.expandWithVec3=
function(c,m){c[0]=Math.min(c[0],m[0]);c[1]=Math.min(c[1],m[1]);c[2]=Math.min(c[2],m[2]);c[3]=Math.max(c[3],m[0]);c[4]=Math.max(c[4],m[1]);c[5]=Math.max(c[5],m[2])};a.fromExtent=function(c,m=d()){m[0]=c.xmin;m[1]=c.ymin;m[2]=c.zmin;m[3]=c.xmax;m[4]=c.ymax;m[5]=c.zmax;return m};a.fromMinMax=function(c,m,h=d()){h[0]=c[0];h[1]=c[1];h[2]=c[2];h[3]=m[0];h[4]=m[1];h[5]=m[2];return h};a.fromRect=function(c,m){c[0]=m[0];c[1]=m[1];c[2]=Number.NEGATIVE_INFINITY;c[3]=m[2];c[4]=m[3];c[5]=Number.POSITIVE_INFINITY;
return c};a.fromValues=f;a.getMax=function(c,m){m[0]=c[3];m[1]=c[4];m[2]=c[5];return m};a.getMin=function(c,m){m[0]=c[0];m[1]=c[1];m[2]=c[2];return m};a.height=p;a.intersects=q;a.intersectsClippingArea=function(c,m){return e.isNone(m)?!0:q(c,m)};a.is=v;a.isPoint=function(c){return 0===u(c)&&0===b(c)&&0===p(c)};a.maximumDimension=function(c){return Math.max(u(c),p(c),b(c))};a.offset=function(c,m,h,g,k=c){k[0]=c[0]+m;k[1]=c[1]+h;k[2]=c[2]+g;k[3]=c[3]+m;k[4]=c[4]+h;k[5]=c[5]+g;return k};a.scale=function(c,
m,h=c){const g=c[0]+u(c)/2,k=c[1]+b(c)/2,n=c[2]+p(c)/2;h[0]=g+(c[0]-g)*m;h[1]=k+(c[1]-k)*m;h[2]=n+(c[2]-n)*m;h[3]=g+(c[3]-g)*m;h[4]=k+(c[4]-k)*m;h[5]=n+(c[5]-n)*m;return h};a.set=r;a.setMax=function(c,m,h=c){h[3]=m[0];h[4]=m[1];h[5]=m[2];h!==c&&(h[0]=c[0],h[1]=c[1],h[2]=c[2]);return c};a.setMin=function(c,m,h=c){h[0]=m[0];h[1]=m[1];h[2]=m[2];h!==c&&(h[3]=c[3],h[4]=c[4],h[5]=c[5]);return h};a.size=function(c,m=[0,0,0]){m[0]=u(c);m[1]=b(c);m[2]=p(c);return m};a.toExtent=function(c,m){return isFinite(c[2])||
isFinite(c[5])?new l({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],zmin:c[2],zmax:c[5],spatialReference:m}):new l({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],spatialReference:m})};a.toRect=function(c,m){m||(m=B.create());m[0]=c[0];m[1]=c[1];m[2]=c[3];m[3]=c[4];return m};a.width=u;a.wrap=function(c,m,h,g,k,n){return f(c,m,h,g,k,n,x)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(a,e){function l({scale:z,translate:w},
F){return Math.round((F-w[0])/z[0])}function B({scale:z,translate:w},F){return Math.round((w[1]-F)/z[1])}function d(z,w,F){const E=[];let N,U,S,I;for(let L=0;L<F.length;L++){const M=F[L];if(0<L){if(S=l(z,M[0]),I=B(z,M[1]),S!==N||I!==U)E.push(w(M,S-N,I-U)),N=S,U=I}else N=l(z,M[0]),U=B(z,M[1]),E.push(w(M,N,U))}return 0<E.length?E:null}function f(z,w,F,E){return d(z,F?E?A:t:E?t:C,w)}function u(z,w,F,E){const N=[];F=F?E?A:t:E?t:C;for(E=0;E<w.length;E++){const U=d(z,F,w[E]);U&&3<=U.length&&N.push(U)}return N.length?
N:null}function b(z,w,F,E){const N=[];F=F?E?A:t:E?t:C;for(E=0;E<w.length;E++){const U=d(z,F,w[E]);U&&2<=U.length&&N.push(U)}return N.length?N:null}function p({scale:z,translate:w},F){return F*z[0]+w[0]}function q({scale:z,translate:w},F){return w[1]-F*z[1]}function r(z,w,F){const E=Array(F.length);if(!F.length)return E;const [N,U]=z.scale;let S=p(z,F[0][0]);z=q(z,F[0][1]);E[0]=w(F[0],S,z);for(let I=1;I<F.length;I++){const L=F[I];S+=L[0]*N;z-=L[1]*U;E[I]=w(L,S,z)}return E}function v(z,w,F){const E=
Array(F.length);for(let N=0;N<F.length;N++)E[N]=r(z,w,F[N]);return E}function D(z,w,F,E){return r(z,F?E?A:t:E?t:C,w)}function y(z,w,F,E){return v(z,F?E?A:t:E?t:C,w)}function x(z,w,F,E){return v(z,F?E?A:t:E?t:C,w)}function c(z,w,F){let [E,N]=F[0],U=Math.min(E,w[0]),S=Math.min(N,w[1]),I=Math.max(E,w[2]);w=Math.max(N,w[3]);for(let L=1;L<F.length;L++){const [M,K]=F[L];E+=M;N+=K;0>M&&(U=Math.min(U,E));0<M&&(I=Math.max(I,E));0>K?S=Math.min(S,N):0<K&&(w=Math.max(w,N))}z[0]=U;z[1]=S;z[2]=I;z[3]=w;return z}
function m(z,w){if(!w.length)return null;z[0]=z[1]=Number.POSITIVE_INFINITY;z[2]=z[3]=Number.NEGATIVE_INFINITY;for(let F=0;F<w.length;F++)c(z,z,w[F]);return z}function h(z,w,F,E,N){w.xmin=l(z,F.xmin);w.ymin=B(z,F.ymin);w.xmax=l(z,F.xmax);w.ymax=B(z,F.ymax);w!==F&&(E&&(w.zmin=F.zmin,w.zmax=F.zmax),N&&(w.mmin=F.mmin,w.mmax=F.mmax));return w}function g(z,w,F,E,N){w.points=f(z,F.points,E,N);return w}function k(z,w,F,E,N){w.x=l(z,F.x);w.y=B(z,F.y);w!==F&&(E&&(w.z=F.z),N&&(w.m=F.m));return w}function n(z,
w,F,E,N){z=u(z,F.rings,E,N);if(!z)return null;w.rings=z;return w}function G(z,w,F,E,N){z=b(z,F.paths,E,N);if(!z)return null;w.paths=z;return w}const C=(z,w,F)=>[w,F],t=(z,w,F)=>[w,F,z[2]],A=(z,w,F)=>[w,F,z[2],z[3]];a.equals=function(z,w){if(z===w||null==z&&null==w)return!0;if(null==z||null==w)return!1;let F,E,N,U;z&&"upperLeft"===z.originPosition?(F=z.translate[0],E=z.translate[1],z=z.scale[0]):(F=z.extent.xmin,E=z.extent.ymax,z=z.tolerance);w&&"upperLeft"===w.originPosition?(N=w.translate[0],U=w.translate[1],
w=w.scale[0]):(N=w.extent.xmin,U=w.extent.ymax,w=w.tolerance);return F===N&&E===U&&z===w};a.getQuantizedBoundsCoordsArray=c;a.getQuantizedBoundsCoordsArrayArray=m;a.getQuantizedBoundsPaths=function(z){return m([0,0,0,0],z)};a.getQuantizedBoundsPoints=function(z){const w=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return c(w,w,z)};a.getQuantizedBoundsRings=function(z){return m([0,0,0,0],z)};a.quantizeBounds=function(z,w,F){w[0]=l(z,F[0]);w[3]=
B(z,F[1]);w[2]=l(z,F[2]);w[1]=B(z,F[3]);return w};a.quantizeExtent=h;a.quantizeGeometry=function(z,w){return z&&w?e.isPoint(w)?k(z,{},w,!1,!1):e.isPolyline(w)?G(z,{},w,!1,!1):e.isPolygon(w)?n(z,{},w,!1,!1):e.isMultipoint(w)?g(z,{},w,!1,!1):e.isExtent(w)?h(z,{},w,!1,!1):null:null};a.quantizeMultipoint=g;a.quantizePaths=b;a.quantizePoint=k;a.quantizePoints=f;a.quantizePolygon=n;a.quantizePolyline=G;a.quantizeRings=u;a.quantizeX=l;a.quantizeY=B;a.toQuantizationTransform=function(z){return z?{originPosition:"upper-left"===
z.originPosition?"upperLeft":"lower-left"===z.originPosition?"lowerLeft":z.originPosition,scale:z.tolerance?[z.tolerance,z.tolerance]:[1,1],translate:z.extent?[z.extent.xmin,z.extent.ymax]:[0,0]}:null};a.unquantizeBounds=function(z,w,F){return F?(w[0]=p(z,F[0]),w[1]=q(z,F[3]),w[2]=p(z,F[2]),w[3]=q(z,F[1]),w):[p(z,w[0]),q(z,w[3]),p(z,w[2]),q(z,w[1])]};a.unquantizeCoordsArray=r;a.unquantizeCoordsArrayArray=v;a.unquantizeExtent=function(z,w,F,E,N){w.xmin=p(z,F.xmin);w.ymin=q(z,F.ymin);w.xmax=p(z,F.xmax);
w.ymax=q(z,F.ymax);w!==F&&(E&&(w.zmin=F.zmin,w.zmax=F.zmax),N&&(w.mmin=F.mmin,w.mmax=F.mmax));return w};a.unquantizeMultipoint=function(z,w,F,E,N){w.points=D(z,F.points,E,N);return w};a.unquantizePaths=y;a.unquantizePoint=function(z,w,F,E,N){w.x=p(z,F.x);w.y=q(z,F.y);w!==F&&(E&&(w.z=F.z),N&&(w.m=F.m));return w};a.unquantizePoints=D;a.unquantizePolygon=function(z,w,F,E,N){w.rings=x(z,F.rings,E,N);return w};a.unquantizePolyline=function(z,w,F,E,N){w.paths=y(z,F.paths,E,N);return w};a.unquantizeRings=
x;a.unquantizeX=p;a.unquantizeY=q;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../core/maybe"],function(a,e,l){function B(q,r){if(q===r)return!0;if(null==q||null==r||q.length!==r.length)return!1;for(let v=0;v<q.length;v++){const D=q[v],y=r[v];if(D.length!==y.length)return!1;for(let x=0;x<D.length;x++)if(D[x]!==y[x])return!1}return!0}function d(q,r){if(q===r)return!0;if(null==q||null==r||q.length!==
r.length)return!1;for(let v=0;v<q.length;v++)if(!B(q[v],r[v]))return!1;return!0}function f(q,r){return u(q.spatialReference,r.spatialReference)?q.x===r.x&&q.y===r.y&&q.z===r.z&&q.m===r.m:!1}function u(q,r){return q===r||q&&r&&q.equals(r)}function b(q,r){if(q===r)return!0;if(l.isNone(q)||l.isNone(r)||q.type!==r.type)return!1;switch(q.type){case "point":return f(q,r);case "extent":return q=q.hasZ!==r.hasZ||q.hasM!==r.hasM?!1:u(q.spatialReference,r.spatialReference)?q.xmin===r.xmin&&q.ymin===r.ymin&&
q.zmin===r.zmin&&q.xmax===r.xmax&&q.ymax===r.ymax&&q.zmax===r.zmax:!1,q;case "polyline":return q=q.hasZ!==r.hasZ||q.hasM!==r.hasM?!1:u(q.spatialReference,r.spatialReference)?d(q.paths,r.paths):!1,q;case "polygon":return q=q.hasZ!==r.hasZ||q.hasM!==r.hasM?!1:u(q.spatialReference,r.spatialReference)?d(q.rings,r.rings):!1,q;case "multipoint":return q=q.hasZ!==r.hasZ||q.hasM!==r.hasM?!1:u(q.spatialReference,r.spatialReference)?B(q.points,r.points):!1,q;case "mesh":return!1}}function p(q,r){if(q===r)return!0;
if(!q||!r)return!1;const v=Object.keys(q),D=Object.keys(r);if(v.length!==D.length)return!1;for(const y of v)if(q[y]!==r[y])return!1;return!0}a.equals=function(q,r){return q===r?!0:null!=q&&null!=r&&q.objectId===r.objectId&&b(q.geometry,r.geometry)&&p(q.attributes,r.attributes)?!0:!1};a.pointEquals=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/2d/interactive/SnappingVisualizer2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/handleUtils ../../../geometry/Point ../../../geometry/Polyline ../../../geometry ../../../symbols/CIMSymbol ../../../core/screenUtils ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol ../../../symbols ../../../Graphic ../../../chunks/vec3f64 ../../../chunks/vec2f64 ../../../chunks/vec2 ../../draw/support/settings ../../interactive/snapping/Settings ../../interactive/snapping/SnappingVisualizer".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h){f=function(F){function E(){return F.apply(this,arguments)||this}e._inheritsLoose(E,F);var N=E.prototype;N.visualizeIntersectionPoint=function(U,S){return this._visualizeSnappingIndicator({geometry:new B({x:U.intersectionPoint[0],y:U.intersectionPoint[1],spatialReference:S.coordinateHelper.spatialReference}),symbol:n,context:S})};N.visualizePoint=function(U,S){return this._visualizeSnappingIndicator({geometry:new B({x:U.point[0],y:U.point[1],spatialReference:S.coordinateHelper.spatialReference}),
symbol:G,context:S})};N.visualizeLine=function(U,S){return this._visualizeSnappingIndicator({geometry:new d({paths:[[U.lineStart,U.lineEnd]],spatialReference:S.coordinateHelper.spatialReference}),symbol:C,context:S})};N.visualizeParallelSign=function(U,S){return this._visualizeSnappingIndicator({geometry:new d({paths:[[U.lineStart,U.lineEnd]],spatialReference:S.coordinateHelper.spatialReference}),symbol:t,context:S})};N.visualizeRightAngleQuad=function(U,S){return this._visualizeSnappingIndicator({geometry:new d({paths:[[U.previousVertex,
U.centerVertex,U.nextVertex]],spatialReference:S.coordinateHelper.spatialReference}),symbol:w(U),context:S})};N._visualizeSnappingIndicator=function(U){const {geometry:S,symbol:I,context:L}=U,M=new v({geometry:S,symbol:I});L.view.graphics.add(M);return l.makeHandle(()=>{L.view.graphics.remove(M)})};return E}(h.SnappingVisualizer);const g=c.colors.main.toArray(),k=[...c.colors.main.toRgb(),100],n=new q({outline:new p({width:1.5,color:g}),size:15,color:[0,0,0,0]}),G=new q({outline:{width:.5,color:[0,
0,0,1]},size:10,color:g}),C=new u({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:b.px2pt(m.defaults.lineHintWidthTarget),color:g}]}}}),t=new u({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,
relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:g}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,
ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:g}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});p=F=>new u({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:b.px2pt(m.defaults.rightAngleHintSize),rotation:F,markerPlacement:{type:"CIMMarkerPlacementOnVertices",
placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:b.px2pt(m.defaults.rightAngleHintOutlineSize),color:g},{type:"CIMSolidFill",enable:!0,color:k}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});const A=p(45),z=p(225),w=(()=>{const F=
y.create(),E=y.create(),N=D.create();return U=>{x.subtract(F,U.centerVertex,U.previousVertex);x.subtract(E,U.nextVertex,U.previousVertex);x.cross(N,F,E);return 0>N[2]?A:z}})();a.SnappingVisualizer2D=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/vec2f64":function(){define(["exports"],function(a){function e(){return[0,0]}function l(c){return[c[0],c[1]]}function B(c,m){return[c,m]}function d(c){const m=[0,0],h=Math.min(2,c.length);for(let g=0;g<h;++g)m[g]=c[g];return m}function f(c,
m){return new Float64Array(c,m,2)}function u(){return[0,0]}function b(){return[1,1]}function p(){return[1,0]}function q(){return[0,1]}const r=[0,0],v=[1,1],D=[1,0],y=[0,1];var x=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,fromArray:d,createView:f,zeros:u,ones:b,unitX:p,unitY:q,ZEROS:r,ONES:v,UNIT_X:D,UNIT_Y:y});a.ONES=v;a.UNIT_X=D;a.UNIT_Y=y;a.ZEROS=r;a.clone=l;a.create=e;a.createView=f;a.fromArray=d;a.fromValues=B;a.ones=b;a.unitX=p;a.unitY=q;a.vec2f64=x;a.zeros=u})},"esri/chunks/vec2":function(){define(["exports",
"./common"],function(a,e){function l(P,Q){P[0]=Q[0];P[1]=Q[1];return P}function B(P,Q,R){P[0]=Q;P[1]=R;return P}function d(P,Q,R){P[0]=Q[0]+R[0];P[1]=Q[1]+R[1];return P}function f(P,Q,R){P[0]=Q[0]-R[0];P[1]=Q[1]-R[1];return P}function u(P,Q,R){P[0]=Q[0]*R[0];P[1]=Q[1]*R[1];return P}function b(P,Q,R){P[0]=Q[0]/R[0];P[1]=Q[1]/R[1];return P}function p(P,Q){P[0]=Math.ceil(Q[0]);P[1]=Math.ceil(Q[1]);return P}function q(P,Q){P[0]=Math.floor(Q[0]);P[1]=Math.floor(Q[1]);return P}function r(P,Q,R){P[0]=Math.min(Q[0],
R[0]);P[1]=Math.min(Q[1],R[1]);return P}function v(P,Q,R){P[0]=Math.max(Q[0],R[0]);P[1]=Math.max(Q[1],R[1]);return P}function D(P,Q){P[0]=Math.round(Q[0]);P[1]=Math.round(Q[1]);return P}function y(P,Q,R){P[0]=Q[0]*R;P[1]=Q[1]*R;return P}function x(P,Q,R,Y){P[0]=Q[0]+R[0]*Y;P[1]=Q[1]+R[1]*Y;return P}function c(P,Q){const R=Q[0]-P[0];P=Q[1]-P[1];return Math.sqrt(R*R+P*P)}function m(P,Q){const R=Q[0]-P[0];P=Q[1]-P[1];return R*R+P*P}function h(P){const Q=P[0];P=P[1];return Math.sqrt(Q*Q+P*P)}function g(P){const Q=
P[0];P=P[1];return Q*Q+P*P}function k(P,Q){P[0]=-Q[0];P[1]=-Q[1];return P}function n(P,Q){P[0]=1/Q[0];P[1]=1/Q[1];return P}function G(P,Q){var R=Q[0];const Y=Q[1];R=R*R+Y*Y;0<R&&(R=1/Math.sqrt(R),P[0]=Q[0]*R,P[1]=Q[1]*R);return P}function C(P,Q){return P[0]*Q[0]+P[1]*Q[1]}function t(P,Q,R){Q=Q[0]*R[1]-Q[1]*R[0];P[0]=P[1]=0;P[2]=Q;return P}function A(P,Q,R,Y){const T=Q[0];Q=Q[1];P[0]=T+Y*(R[0]-T);P[1]=Q+Y*(R[1]-Q);return P}function z(P,Q){Q=Q||1;const R=2*e.RANDOM()*Math.PI;P[0]=Math.cos(R)*Q;P[1]=
Math.sin(R)*Q;return P}function w(P,Q,R){const Y=Q[0];Q=Q[1];P[0]=R[0]*Y+R[2]*Q;P[1]=R[1]*Y+R[3]*Q;return P}function F(P,Q,R){const Y=Q[0];Q=Q[1];P[0]=R[0]*Y+R[2]*Q+R[4];P[1]=R[1]*Y+R[3]*Q+R[5];return P}function E(P,Q,R){const Y=Q[0];Q=Q[1];P[0]=R[0]*Y+R[3]*Q+R[6];P[1]=R[1]*Y+R[4]*Q+R[7];return P}function N(P,Q,R){const Y=Q[0];Q=Q[1];P[0]=R[0]*Y+R[4]*Q+R[12];P[1]=R[1]*Y+R[5]*Q+R[13];return P}function U(P,Q,R,Y){const T=Q[0]-R[0];Q=Q[1]-R[1];const V=Math.sin(Y);Y=Math.cos(Y);P[0]=T*Y-Q*V+R[0];P[1]=
T*V+Q*Y+R[1];return P}function S(P,Q){var R=P[0];P=P[1];const Y=Q[0];Q=Q[1];let T=R*R+P*P;0<T&&(T=1/Math.sqrt(T));let V=Y*Y+Q*Q;0<V&&(V=1/Math.sqrt(V));R=(R*Y+P*Q)*T*V;return 1<R?0:-1>R?Math.PI:Math.acos(R)}function I(P){return"vec2("+P[0]+", "+P[1]+")"}function L(P,Q){return P[0]===Q[0]&&P[1]===Q[1]}function M(P,Q){const R=P[0];P=P[1];const Y=Q[0];Q=Q[1];return Math.abs(R-Y)<=e.EPSILON*Math.max(1,Math.abs(R),Math.abs(Y))&&Math.abs(P-Q)<=e.EPSILON*Math.max(1,Math.abs(P),Math.abs(Q))}var K=Object.freeze({__proto__:null,
copy:l,set:B,add:d,subtract:f,multiply:u,divide:b,ceil:p,floor:q,min:r,max:v,round:D,scale:y,scaleAndAdd:x,distance:c,squaredDistance:m,length:h,squaredLength:g,negate:k,inverse:n,normalize:G,dot:C,cross:t,lerp:A,random:z,transformMat2:w,transformMat2d:F,transformMat3:E,transformMat4:N,rotate:U,angle:S,str:I,exactEquals:L,equals:M,len:h,sub:f,mul:u,div:b,dist:c,sqrDist:m,sqrLen:g});a.add=d;a.angle=S;a.ceil=p;a.copy=l;a.cross=t;a.dist=c;a.distance=c;a.div=b;a.divide=b;a.dot=C;a.equals=M;a.exactEquals=
L;a.floor=q;a.inverse=n;a.len=h;a.length=h;a.lerp=A;a.max=v;a.min=r;a.mul=u;a.multiply=u;a.negate=k;a.normalize=G;a.random=z;a.rotate=U;a.round=D;a.scale=y;a.scaleAndAdd=x;a.set=B;a.sqrDist=m;a.sqrLen=g;a.squaredDistance=m;a.squaredLength=g;a.str=I;a.sub=f;a.subtract=f;a.transformMat2=w;a.transformMat2d=F;a.transformMat3=E;a.transformMat4=N;a.vec2=K})},"esri/views/draw/support/settings":function(){define(["exports","../../../Color"],function(a,e){function l(q,r){if(r)for(const v in r)q[v]=r[v]}const B=
{main:new e([255,127,0]),selected:new e([255,255,255]),outline:new e([0,0,0,.5]),selectedOutline:new e([255,255,255]),hoverOutline:new e([255,255,255]),secondary:new e([255,255,255]),secondaryOutline:new e([100,100,100]),transparent:new e([0,0,0,0])};let d=function(q){this.size=8;this.hoverSize=10;this.hoverColor=this.color=B.main;this.outlineColor=B.outline;this.hoverOutlineColor=B.hoverOutline;l(this,q)},f=function(q){this.color=B.secondary;this.hoverColor=B.main;l(this,q)},u=function(q){this.hoverColor=
this.color=B.transparent;this.hoverOutlineColor=this.outlineColor=B.main;this.stagedColor=B.transparent;this.stagedOutlineColor=B.secondary;l(this,q)},b=function(q){this.vertex=new d;this.midpoint=new d({color:B.secondary,outlineColor:B.secondaryOutline,size:6});this.selected=new d({color:B.selected,hoverColor:B.selected,hoverOutlineColor:B.hoverOutline});l(this,q)},p=function(q){this.center=new d({color:B.secondaryOutline});this.fill=new u;this.line=new f;this.vertex=new d({color:B.selected,outlineColor:B.main,
hoverColor:B.selected,hoverOutlineColor:B.secondaryOutline});l(this,q)};e=new function(q){this.reshapeGraphics=new b;this.transformGraphics=new p;l(this,q)};a.colors=B;a.settings=e;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingVisualizer":function(){define("exports ../../../core/handleUtils ./hints/IntersectionSnappingHint ./hints/LineSnappingHint ./hints/ParallelSnappingHint ./hints/PointSnappingHint ./hints/RightAngleSnappingHint".split(" "),function(a,
e,l,B,d,f,u){let b=function(){function p(){}var q=p.prototype;q.draw=function(r,v){r=this.getUniqueHints(r);const D=[];for(const y of r)y instanceof l.IntersectionSnappingHint&&D.push(this.visualizeIntersectionPoint(y,v)),y instanceof B.LineSnappingHint&&D.push(this.visualizeLine(y,v)),y instanceof d.ParallelSnappingHint&&D.push(this.visualizeParallelSign(y,v)),y instanceof u.RightAngleSnappingHint&&D.push(this.visualizeRightAngleQuad(y,v)),y instanceof f.PointSnappingHint&&D.push(this.visualizePoint(y,
v));return e.handlesGroup(D)};q.getUniqueHints=function(r){const v=[];for(const D of r){r=!0;for(const y of v)if(D.equals(y)){r=!1;break}r&&v.push(D)}return v};return p}();a.SnappingVisualizer=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../snappingUtils","./SnappingHint"],function(a,e,l,B){B=function(d){function f(u){var b=d.call(this)||this;b.intersectionPoint=
u;return b}e._inheritsLoose(f,d);f.prototype.equals=function(u){return u instanceof f?l.objectEqual(this.intersectionPoint,u.intersectionPoint):!1};return f}(B.SnappingHint);a.IntersectionSnappingHint=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../geometry/Point ../../../core/screenUtils ../../../chunks/vec3f64 ../../../chunks/vec2 ../../../support/elevationInfoUtils".split(" "),function(a,e,l,B,d,f){function u(r,
v,D,y,x=B.create()){r=v.toXYZ(r);r[2]=f.getConvertedElevationFromVector(y,r,v.spatialReference,D)||0;y.renderCoordsHelper.toRenderCoords(r,v.spatialReference,x);return x}const b=B.create(),p=l.createScreenPointArray(),q=new e;a.anyMapPointToRender=u;a.anyMapPointToScreenPoint=function(r,v,D,y){if("2d"===y.type)return y.toScreen(v.toPoint(r,q));u(r,v,D,y,b);y.state.camera.projectToScreen(b,p);return l.createScreenPoint(p[0],p[1])};a.anyMapPointsToRenderWithEqualZ=function(r,v,D,y,x,c,m){r=D.toXYZ(r);
v=D.toXYZ(v);const h=f.getConvertedElevationFromVector(x,r,D.spatialReference,y);y=f.getConvertedElevationFromVector(x,v,D.spatialReference,y);y=(null==h?y:null==y?h:Math.min(h,y))||0;r[2]=y;v[2]=y;x.renderCoordsHelper.toRenderCoords(r,D.spatialReference,c);x.renderCoordsHelper.toRenderCoords(v,D.spatialReference,m)};a.objectEqual=function(r,v){const D=r.length===v.length&&r[0]===v[0]&&r[1]===v[1];switch(r.length){case 2:return D;case 3:return D&&r[2]===v[2];case 4:return D&&r[3]===v[3]}return!1};
a.sortCandidatesInPlace=function(r,v){v.sort((D,y)=>{D=d.squaredDistance(D.targetPoint,r);y=d.squaredDistance(y.targetPoint,r);return D-y})};a.squareDistance=function(r,v){const D=r.x-v.x;r=r.y-v.y;return D*D+r*r};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(a,e,l){function B(q,r){return e.isNone(r)||!r.mode?q?"absolute-height":"on-the-ground":r.mode}function d(q,
r){return B(e.isSome(q)?q.hasZ:!1,r)}function f(q){const r=u(q);return d(q.geometry,r)}function u(q){return q.layer&&"elevationInfo"in q.layer?q.layer.elevationInfo:null}function b(q,r,v,D,y,x,c=null){if(!e.isNone(x)){var m=e.isSome(c)?c.mode:"absolute-height";if("on-the-ground"===m)return 0;a:{x=p(r,v,D,y,q,x);c=e.isSome(c)&&e.isSome(c.offset)?c.offset:0;switch(m){case "absolute-height":q=x-c;break a;case "relative-to-ground":q=x-(e.unwrapOr(q.elevationProvider.getElevation(r,v,D,y,"ground"),0)+
c);break a;case "relative-to-scene":q=x-(e.unwrapOr(q.elevationProvider.getElevation(r,v,D,y,"scene"),0)+c);break a}q=void 0}return q}}function p(q,r,v,D,y,x){const c=e.isSome(x.offset)?x.offset:0;switch(x.mode){case "absolute-height":return v+c;case "on-the-ground":return e.unwrapOr(y.elevationProvider.getElevation(q,r,0,D,"ground"),0);case "relative-to-ground":return v+e.unwrapOr(y.elevationProvider.getElevation(q,r,v,D,"ground"),0)+c;case "relative-to-scene":return v+e.unwrapOr(y.elevationProvider.getElevation(q,
r,v,D,"scene"),0)+c}}a.getConvertedElevation=function(q,r,v,D=null){return b(q,r.x,r.y,r.hasZ?r.z:0,r.spatialReference,v,D)};a.getConvertedElevationFromVector=function(q,r,v,D,y=null){return b(q,r[0],r[1],2<r.length?r[2]:0,v,D,y)};a.getEffectiveElevationMode=B;a.getGeometryEffectiveElevationMode=d;a.getGraphicEffectiveElevationInfo=function(q){var r=u(q);q=d(q.geometry,r);r=e.isSome(r)&&"on-the-ground"!==q?e.unwrapOr(r.offset,0)*l.getMetersPerUnit(e.unwrapOr(r.unit,"meters")):0;return{mode:q,offset:r}};
a.getGraphicEffectiveElevationMode=f;a.getZForElevationMode=function(q,r,v){if(!e.isNone(v)&&v.mode){var D=q.hasZ?q.z:0,y=e.isSome(v.offset)?v.offset:0;switch(v.mode){case "absolute-height":return D-y;case "on-the-ground":return 0;case "relative-to-ground":return q=e.unwrapOr(r.elevationProvider.getElevation(q.x,q.y,q.z,q.spatialReference,"ground"),0)+y,D-q;case "relative-to-scene":return q=e.unwrapOr(r.elevationProvider.getElevation(q.x,q.y,q.z,q.spatialReference,"scene"),0)+y,D-q}}};a.hasGraphicFeatureExpressionInfo=
function(q){if("on-the-ground"===f(q))return!1;q=u(q);q=e.isSome(q)&&q.featureExpressionInfo?q.featureExpressionInfo.expression:null;return!(!q||"0"===q)};a.zValueInAbsoluteHeightMode=p;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){a.SnappingHint=function(){};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),
function(a,e,l,B,d,f){B.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");l=function(u){function b(p,q,r,v=!0,D=!0){var y=u.call(this)||this;y.type=p;y.lineStart=q;y.lineEnd=r;y.fadeLeft=v;y.fadeRight=D;return y}e._inheritsLoose(b,u);b.prototype.equals=function(p){return p instanceof b?this.type===p.type&&d.objectEqual(this.lineStart,p.lineStart)&&d.objectEqual(this.lineEnd,p.lineEnd)&&this.fadeLeft===p.fadeLeft&&this.fadeRight===p.fadeRight:!1};return b}(f.SnappingHint);a.LineSnappingHint=
l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(a,e,l,B,d,f){B.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");l=function(u){function b(p,q){var r=u.call(this)||this;r.lineStart=p;r.lineEnd=q;return r}e._inheritsLoose(b,u);b.prototype.equals=
function(p){return p instanceof b?d.objectEqual(this.lineStart,p.lineStart)&&d.objectEqual(this.lineEnd,p.lineEnd):!1};return b}(f.SnappingHint);a.ParallelSnappingHint=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/PointSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../snappingUtils","./SnappingHint"],function(a,e,l,B){B=function(d){function f(u){var b=d.call(this)||this;b.point=u;return b}e._inheritsLoose(f,
d);f.prototype.equals=function(u){return u instanceof f?l.objectEqual(this.point,u.point):!1};return f}(B.SnappingHint);a.PointSnappingHint=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(a,e,l,B,d,f){B.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");
l=function(u){function b(p,q,r){var v=u.call(this)||this;v.previousVertex=p;v.centerVertex=q;v.nextVertex=r;return v}e._inheritsLoose(b,u);b.prototype.equals=function(p){return p instanceof b?d.objectEqual(this.previousVertex,p.previousVertex)&&d.objectEqual(this.centerVertex,p.centerVertex)&&d.objectEqual(this.nextVertex,p.nextVertex):!1};return b}(f.SnappingHint);a.RightAngleSnappingHint=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../geometry/support/spatialReferenceUtils ../../geometry/Point ../../geometry ../../chunks/vec3f64 ../../chunks/vec3 ../../chunks/vec2f64 ../../chunks/vec4f64 ../../chunks/vec2 ../../chunks/vec4 ../3d/support/stack".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r){function v(m,h){if(h.supported){var g=Infinity,k=-Infinity,n=h.upperBoundX-h.lowerBoundX;m.forEach(C=>{let t=C.pos[0];for(;t<h.lowerBoundX;)t+=n;for(;t>h.upperBoundX;)t-=n;g=Math.min(g,t);k=Math.max(k,t);C.pos[0]=t});var G=k-g;n-G<G&&m.forEach(C=>{0>C.pos[0]&&(C.pos[0]+=n)})}}function D(m,h){m=e.getInfo(m);return"global"===h&&m?{supported:!0,lowerBoundX:m.valid[0],upperBoundX:m.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}let y=function(){function m(g,
k){this.spatialReference=g;this.viewingMode=k;this._unnormalizationInfo=D(g,k)}var h=m.prototype;h.tag=function(g){return g};h.createNew=function(){return this.tag(u.create())};h.fromPoint=function(g){return this.tag(u.fromValues(g.x,g.y))};h.fromArray=function(g){return this.tag(u.fromValues(g[0],g[1]))};h.toArray=function(g){return[g[0],g[1]]};h.clone=function(g){return this.tag(u.fromArray(g))};h.toPoint=function(g,k){k.x=g[0];k.y=g[1];k.hasZ=!1;k.hasM=!1;k.spatialReference=this.spatialReference;
return k};h.createPoint=function(g){return new l({x:g[0],y:g[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};h.createPointFromArray=function(g){return new l({x:g[0],y:g[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};h.createDehydratedPoint=function(g){return{x:g[0],y:g[1],z:void 0,m:void 0,hasZ:!1,hasM:!1,spatialReference:this.spatialReference,type:"point"}};h.lerp=function(g,k,n,G){return p.lerp(G,g,k,n)};h.addDelta=function(g,k,n){g[0]+=k;g[1]+=n};h.scale=function(g,
k,n,G){const C=r.sv2d.get();k=p.subtract(C,g,k);n=p.scale(C,n,p.dot(n,k));p.scaleAndAdd(g,g,n,G-1)};h.rotate=function(g,k,n){p.rotate(g,g,k,n)};h.pointToArray=function(g){return[g.x,g.y]};h.getZ=function(g,k){return k};h.hasZ=function(){return!1};h.unnormalize=function(g){v(g,this._unnormalizationInfo)};h.fromXYZ=function(g){return this.tag(u.fromValues(g[0],g[1]))};h.toXYZ=function(g,k=0){return d.fromValues(g[0],g[1],k)};return m}(),x=function(){function m(g,k,n){this.valueType=g;this.spatialReference=
k;this._unnormalizationInfo=D(k,n)}var h=m.prototype;h.tag=function(g){return g};h.createNew=function(){return this.tag(d.create())};h.fromPoint=function(g){return this.tag(d.fromValues(g.x,g.y,0===this.valueType?g.z:g.m))};h.fromArray=function(g){return this.tag(d.fromValues(g[0],g[1],g[2]||0))};h.toArray=function(g){return[g[0],g[1],g[2]]};h.clone=function(g){return this.tag(d.fromArray(g))};h.toPoint=function(g,k){k.x=g[0];k.y=g[1];0===this.valueType?(k.z=g[2],k.hasZ=!0,k.hasM=!1):(k.m=g[2],k.hasZ=
!1,k.hasM=!0);k.spatialReference=this.spatialReference;return k};h.createPoint=function(g){return new l({x:g[0],y:g[1],z:0===this.valueType?g[2]:void 0,m:1===this.valueType?g[2]:void 0,spatialReference:this.spatialReference})};h.createPointFromArray=function(g){return new l({x:g[0],y:g[1],z:0===this.valueType?g[2]:void 0,m:1===this.valueType?g[2]:void 0,spatialReference:this.spatialReference})};h.createDehydratedPoint=function(g){const k=0===this.valueType,n=1===this.valueType;return{x:g[0],y:g[1],
z:k?g[2]:void 0,m:n?g[2]:void 0,hasZ:k,hasM:n,spatialReference:this.spatialReference,type:"point"}};h.lerp=function(g,k,n,G){return f.lerp(G,g,k,n)};h.addDelta=function(g,k,n,G){g[0]+=k;g[1]+=n;0===this.valueType&&(g[2]+=G)};h.scale=function(g,k,n,G){const C=r.sv2d.get();k=p.subtract(C,g,k);n=p.scale(C,n,p.dot(n,k));p.scaleAndAdd(g,g,n,G-1)};h.rotate=function(g,k,n){p.rotate(g,g,k,n)};h.pointToArray=function(g){return 0===this.valueType?[g.x,g.y,g.z]:[g.x,g.y,g.m]};h.getZ=function(g,k){return 0===
this.valueType?g[2]:k};h.hasZ=function(){return 0===this.valueType};h.unnormalize=function(g){v(g,this._unnormalizationInfo)};h.fromXYZ=function(g,k=0,n=0){return this.tag(d.fromValues(g[0],g[1],0===this.valueType?2<g.length?g[2]:k:n))};h.toXYZ=function(g,k=0){return this.tag(d.fromValues(g[0],g[1],0===this.valueType?g[2]:k))};return m}(),c=function(){function m(g,k){this.spatialReference=g;this._unnormalizationInfo=D(g,k)}var h=m.prototype;h.tag=function(g){return g};h.createNew=function(){return this.tag(b.create())};
h.fromPoint=function(g){return this.tag(b.fromValues(g.x,g.y,g.z,g.m))};h.fromArray=function(g){return this.tag(b.fromValues(g[0],g[1],g[2]||0,g[3]||0))};h.toArray=function(g){return[g[0],g[1],g[2],g[3]]};h.clone=function(g){return this.tag(b.fromArray(g))};h.toPoint=function(g,k){k.x=g[0];k.y=g[1];k.z=g[2];k.m=g[3];k.hasZ=!0;k.hasM=!0;k.spatialReference=this.spatialReference;return k};h.createPoint=function(g){return new l({x:g[0],y:g[1],z:g[2],m:g[3],spatialReference:this.spatialReference})};h.createPointFromArray=
function(g){return new l({x:g[0],y:g[1],z:g[2],m:g[3],spatialReference:this.spatialReference})};h.createDehydratedPoint=function(g){return{x:g[0],y:g[1],z:g[2],m:g[3],hasZ:!0,hasM:!0,spatialReference:this.spatialReference,type:"point"}};h.lerp=function(g,k,n,G){return q.lerp(G,g,k,n)};h.addDelta=function(g,k,n,G){g[0]+=k;g[1]+=n;g[2]+=G};h.scale=function(g,k,n,G){const C=r.sv2d.get();k=p.subtract(C,g,k);n=p.scale(C,n,p.dot(n,k));p.scaleAndAdd(g,g,n,G-1)};h.rotate=function(g,k,n){p.rotate(g,g,k,n)};
h.pointToArray=function(g){return[g.x,g.y,g.z,g.m]};h.getZ=function(g){return g[2]};h.hasZ=function(){return!0};h.unnormalize=function(g){v(g,this._unnormalizationInfo)};h.fromXYZ=function(g,k=0,n=0){return this.tag(b.fromValues(g[0],g[1],2<g.length?g[2]:k,n))};h.toXYZ=function(g){return d.fromValues(g[0],g[1],g[2])};return m}();a.CoordinateHelper2D=y;a.CoordinateHelper3D=x;a.CoordinateHelper4D=c;a.createCoordinateHelper=function(m,h,g,k){return m&&h?new c(g,k):h?new x(1,g,k):m?new x(0,g,k):new y(g,
k)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/vec4f64":function(){define(["exports"],function(a){function e(){return[0,0,0,0]}function l(k){return[k[0],k[1],k[2],k[3]]}function B(k,n,G,C){return[k,n,G,C]}function d(k){const n=e(),G=Math.min(4,k.length);for(let C=0;C<G;++C)n[C]=k[C];return n}function f(k,n){return new Float64Array(k,n,4)}function u(){return e()}function b(){return[1,1,1,1]}function p(){return[1,0,0,0]}function q(){return[0,1,0,0]}function r(){return[0,0,1,0]}
function v(){return[0,0,0,1]}const D=e(),y=b(),x=p(),c=q(),m=r(),h=v();var g=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,fromArray:d,createView:f,zeros:u,ones:b,unitX:p,unitY:q,unitZ:r,unitW:v,ZEROS:D,ONES:y,UNIT_X:x,UNIT_Y:c,UNIT_Z:m,UNIT_W:h});a.ONES=y;a.UNIT_W=h;a.UNIT_X=x;a.UNIT_Y=c;a.UNIT_Z=m;a.ZEROS=D;a.clone=l;a.create=e;a.createView=f;a.fromArray=d;a.fromValues=B;a.ones=b;a.unitW=v;a.unitX=p;a.unitY=q;a.unitZ=r;a.vec4f64=g;a.zeros=u})},"esri/chunks/vec4":function(){define(["exports",
"./common"],function(a,e){function l(S,I){S[0]=I[0];S[1]=I[1];S[2]=I[2];S[3]=I[3];return S}function B(S,I,L,M,K){S[0]=I;S[1]=L;S[2]=M;S[3]=K;return S}function d(S,I,L){S[0]=I[0]+L[0];S[1]=I[1]+L[1];S[2]=I[2]+L[2];S[3]=I[3]+L[3];return S}function f(S,I,L){S[0]=I[0]-L[0];S[1]=I[1]-L[1];S[2]=I[2]-L[2];S[3]=I[3]-L[3];return S}function u(S,I,L){S[0]=I[0]*L[0];S[1]=I[1]*L[1];S[2]=I[2]*L[2];S[3]=I[3]*L[3];return S}function b(S,I,L){S[0]=I[0]/L[0];S[1]=I[1]/L[1];S[2]=I[2]/L[2];S[3]=I[3]/L[3];return S}function p(S,
I){S[0]=Math.ceil(I[0]);S[1]=Math.ceil(I[1]);S[2]=Math.ceil(I[2]);S[3]=Math.ceil(I[3]);return S}function q(S,I){S[0]=Math.floor(I[0]);S[1]=Math.floor(I[1]);S[2]=Math.floor(I[2]);S[3]=Math.floor(I[3]);return S}function r(S,I,L){S[0]=Math.min(I[0],L[0]);S[1]=Math.min(I[1],L[1]);S[2]=Math.min(I[2],L[2]);S[3]=Math.min(I[3],L[3]);return S}function v(S,I,L){S[0]=Math.max(I[0],L[0]);S[1]=Math.max(I[1],L[1]);S[2]=Math.max(I[2],L[2]);S[3]=Math.max(I[3],L[3]);return S}function D(S,I){S[0]=Math.round(I[0]);
S[1]=Math.round(I[1]);S[2]=Math.round(I[2]);S[3]=Math.round(I[3]);return S}function y(S,I,L){S[0]=I[0]*L;S[1]=I[1]*L;S[2]=I[2]*L;S[3]=I[3]*L;return S}function x(S,I,L,M){S[0]=I[0]+L[0]*M;S[1]=I[1]+L[1]*M;S[2]=I[2]+L[2]*M;S[3]=I[3]+L[3]*M;return S}function c(S,I){const L=I[0]-S[0],M=I[1]-S[1],K=I[2]-S[2];S=I[3]-S[3];return Math.sqrt(L*L+M*M+K*K+S*S)}function m(S,I){const L=I[0]-S[0],M=I[1]-S[1],K=I[2]-S[2];S=I[3]-S[3];return L*L+M*M+K*K+S*S}function h(S){const I=S[0],L=S[1],M=S[2];S=S[3];return Math.sqrt(I*
I+L*L+M*M+S*S)}function g(S){const I=S[0],L=S[1],M=S[2];S=S[3];return I*I+L*L+M*M+S*S}function k(S,I){S[0]=-I[0];S[1]=-I[1];S[2]=-I[2];S[3]=-I[3];return S}function n(S,I){S[0]=1/I[0];S[1]=1/I[1];S[2]=1/I[2];S[3]=1/I[3];return S}function G(S,I){const L=I[0],M=I[1],K=I[2];I=I[3];let P=L*L+M*M+K*K+I*I;0<P&&(P=1/Math.sqrt(P),S[0]=L*P,S[1]=M*P,S[2]=K*P,S[3]=I*P);return S}function C(S,I){return S[0]*I[0]+S[1]*I[1]+S[2]*I[2]+S[3]*I[3]}function t(S,I,L,M){const K=I[0],P=I[1],Q=I[2];I=I[3];S[0]=K+M*(L[0]-
K);S[1]=P+M*(L[1]-P);S[2]=Q+M*(L[2]-Q);S[3]=I+M*(L[3]-I);return S}function A(S,I){I=I||1;let L,M,K,P;let Q;do{L=2*e.RANDOM()-1;M=2*e.RANDOM()-1;var R=L*L+M*M}while(1<=R);do K=2*e.RANDOM()-1,P=2*e.RANDOM()-1,Q=K*K+P*P;while(1<=Q);R=Math.sqrt((1-R)/Q);S[0]=I*L;S[1]=I*M;S[2]=I*K*R;S[3]=I*P*R;return S}function z(S,I,L){const M=I[0],K=I[1],P=I[2];I=I[3];S[0]=L[0]*M+L[4]*K+L[8]*P+L[12]*I;S[1]=L[1]*M+L[5]*K+L[9]*P+L[13]*I;S[2]=L[2]*M+L[6]*K+L[10]*P+L[14]*I;S[3]=L[3]*M+L[7]*K+L[11]*P+L[15]*I;return S}function w(S,
I,L){var M=I[0];const K=I[1],P=I[2],Q=L[0],R=L[1],Y=L[2];L=L[3];const T=L*M+R*P-Y*K,V=L*K+Y*M-Q*P,W=L*P+Q*K-R*M;M=-Q*M-R*K-Y*P;S[0]=T*L+M*-Q+V*-Y-W*-R;S[1]=V*L+M*-R+W*-Q-T*-Y;S[2]=W*L+M*-Y+T*-R-V*-Q;S[3]=I[3];return S}function F(S){return"vec4("+S[0]+", "+S[1]+", "+S[2]+", "+S[3]+")"}function E(S,I){return S[0]===I[0]&&S[1]===I[1]&&S[2]===I[2]&&S[3]===I[3]}function N(S,I){const L=S[0],M=S[1],K=S[2];S=S[3];const P=I[0],Q=I[1],R=I[2];I=I[3];return Math.abs(L-P)<=e.EPSILON*Math.max(1,Math.abs(L),Math.abs(P))&&
Math.abs(M-Q)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(Q))&&Math.abs(K-R)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(R))&&Math.abs(S-I)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(I))}var U=Object.freeze({__proto__:null,copy:l,set:B,add:d,subtract:f,multiply:u,divide:b,ceil:p,floor:q,min:r,max:v,round:D,scale:y,scaleAndAdd:x,distance:c,squaredDistance:m,length:h,squaredLength:g,negate:k,inverse:n,normalize:G,dot:C,lerp:t,random:A,transformMat4:z,transformQuat:w,str:F,exactEquals:E,equals:N,sub:f,
mul:u,div:b,dist:c,sqrDist:m,len:h,sqrLen:g});a.add=d;a.ceil=p;a.copy=l;a.dist=c;a.distance=c;a.div=b;a.divide=b;a.dot=C;a.equals=N;a.exactEquals=E;a.floor=q;a.inverse=n;a.len=h;a.length=h;a.lerp=t;a.max=v;a.min=r;a.mul=u;a.multiply=u;a.negate=k;a.normalize=G;a.random=A;a.round=D;a.scale=y;a.scaleAndAdd=x;a.set=B;a.sqrDist=m;a.sqrLen=g;a.squaredDistance=m;a.squaredLength=g;a.str=F;a.sub=f;a.subtract=f;a.transformMat4=z;a.transformQuat=w;a.vec4=U})},"esri/views/3d/support/stack":function(){define(["exports",
"../../../core/VectorStack"],function(a,e){const l=e.VectorStack.createVec2f64(),B=e.VectorStack.createVec3f64(),d=e.VectorStack.createVec4f64(),f=e.VectorStack.createMat3f64(),u=e.VectorStack.createMat4f64();e=e.VectorStack.createQuatf64();a.sm3d=f;a.sm4d=u;a.sq4d=e;a.sv2d=l;a.sv3d=B;a.sv4d=d;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/core/VectorStack":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./maybe ./nextTick ../chunks/vec3f64 ../chunks/mat3f64 ../chunks/mat4f64 ../chunks/quatf64 ../chunks/vec2f64 ../chunks/vec4f64".split(" "),
function(a,e,l,B,d,f,u,b,p,q){let r=function(){function v(y,x,c){this.itemByteSize=y;this.itemCreate=x;this.buffers=[];this.items=[];this.itemsPtr=this.itemsPerBuffer=0;this.itemsPerBuffer=Math.ceil(c/this.itemByteSize);this.tickHandle=B.before(()=>this.reset())}var D=v.prototype;D.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=l.nullifyNonnullableForDispose(this.tickHandle));this.itemsPtr=0;this.items=l.nullifyNonnullableForDispose(this.items);this.buffers=l.nullifyNonnullableForDispose(this.buffers)};
D.get=function(){0===this.itemsPtr&&B(()=>{});const y=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=y;){const x=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let c=0;c<this.itemsPerBuffer;++c)this.items.push(this.itemCreate(x,c*this.itemByteSize));this.buffers.push(x)}return this.items[this.itemsPtr++]};D.reset=function(){const y=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>y;)this.buffers.pop(),this.items.length=this.buffers.length*
this.itemsPerBuffer;this.itemsPtr=0};v.createVec2f64=function(y=4096){return new v(16,p.createView,y)};v.createVec3f64=function(y=4096){return new v(24,d.createView,y)};v.createVec4f64=function(y=4096){return new v(32,q.createView,y)};v.createMat3f64=function(y=4096){return new v(72,f.createView,y)};v.createMat4f64=function(y=4096){return new v(128,u.createView,y)};v.createQuatf64=function(y=4096){return new v(32,b.createView,y)};e._createClass(v,[{key:"test",get:function(){return{size:this.buffers.length*
this.itemsPerBuffer*this.itemByteSize}}}]);return v}();a.VectorStack=r;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/mat3f64":function(){define(["exports"],function(a){function e(){return[1,0,0,0,1,0,0,0,1]}function l(u){return[u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8]]}function B(u,b,p,q,r,v,D,y,x){return[u,b,p,q,r,v,D,y,x]}function d(u,b){return new Float64Array(u,b,9)}var f=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d});a.clone=l;a.create=e;a.createView=
d;a.fromValues=B;a.mat3f64=f})},"esri/chunks/mat4f64":function(){define(["exports"],function(a){function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function l(b){return[b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13],b[14],b[15]]}function B(b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){return[b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C]}function d(b,p){return new Float64Array(b,p,16)}const f=e();var u=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d,IDENTITY:f});a.IDENTITY=
f;a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.mat4f64=u})},"esri/chunks/quatf64":function(){define(["exports"],function(a){function e(){return[0,0,0,1]}function l(b){return[b[0],b[1],b[2],b[3]]}function B(b,p,q,r){return[b,p,q,r]}function d(b,p){return new Float64Array(b,p,4)}const f=e();var u=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d,IDENTITY:f});a.IDENTITY=f;a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.quatf64=u})},"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry ../../../core/Evented ../coordinateHelper".split(" "),
function(a,e,l,B,d,f,u,b){let p=function(){function v(D){this.right=this.left=null;this.type="vertex";this.index=null;this.component=D}e._createClass(v,[{key:"pos",get:function(){return this._pos},set:function(D){this._pos=D;this.component.unnormalizeVertexPositions()}}]);return v}(),q=function(v,D,y){this.type="edge";this.component=v;this.left=D;this.right=y;D.right=this;y.left=this},r=function(){function v(y){this.vertices=[];this.edges=[];this.data=y}var D=v.prototype;D.unnormalizeVertexPositions=
function(){1>=this.vertices.length||this.data.coordinateHelper.unnormalize(this.vertices)};D.updateVertexIndex=function(y,x){if(0!==this.vertices.length){var c=this.vertices[0],m=null;do m=y,m.index=x++,y=m.right?m.right.right:null;while(null!=y&&y!==c);m.left&&m!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(m),this.vertices.length-1)}};D.getFirstVertex=function(){return 0===this.vertices.length?null:this.vertices[0]};D.getLastVertex=function(){return 0===this.vertices.length?
null:this.vertices[this.vertices.length-1]};D.swapVertices=function(y,x){const c=this.vertices[y];this.vertices[y]=this.vertices[x];this.vertices[x]=c};D.iterateVertices=function(y){if(0!==this.vertices.length){var x=this.vertices[0],c=x;do y(c,c.index),c=l.isSome(c.right)?c.right.right:null;while(c!==x&&null!=c)}};return v}();f=function(v){function D(x){var c=v.call(this)||this;c.coordinateHelper=x;c.undoStack=[];c.redoStack=[];c.components=[];return c}e._inheritsLoose(D,v);var y=D.prototype;y.apply=
function(x,c=1){if(0===c||l.isNone(this.lastOperation)||!this.lastOperation.accumulate(x))x.apply(),this.undoStack.push(x),this.redoStack=[]};y.undo=function(){if(0<this.undoStack.length){const x=this.undoStack.pop();x.undo();this.redoStack.push(x);return x}return null};y.redo=function(){if(0<this.redoStack.length){const x=this.redoStack.pop();x.apply();this.undoStack.push(x);return x}return null};y.toPoint=function(){return 0===this.components.length||0===this.components[0].vertices.length?null:
this.coordinateHelper.createPoint(this.components[0].vertices[0].pos)};y.toPolyline=function(){const x=[],c=this.coordinateHelper.toArray;this.components.forEach((m,h)=>{h=[];const g=m=m.vertices.find(k=>null==k.left);do h.push(c(m.pos)),m=m.right?m.right.right:null;while(m&&m!==g);x.push(h)});return new d({paths:x,spatialReference:this.coordinateHelper.spatialReference})};y.toPolygon=function(){const x=[],c=this.coordinateHelper.toArray;this.components.forEach((m,h)=>{h=[];let g=m=m.vertices[0];
const k=g;do h.push(c(g.pos)),g=l.isSome(g.right)?g.right.right:null;while(g&&g!==k);h.push(c(m.pos));x.push(h)});return new B({rings:x,spatialReference:this.coordinateHelper.spatialReference})};D.fromGeometry=function(x,c){var m=b.createCoordinateHelper(x.hasZ,x.hasM,x.spatialReference,c);c=new D(m);switch(x.type){case "polygon":var h=x.rings;for(x=0;x<h.length;++x){var g=h[x],k=new r(c),n=g.length-1;for(var G=0;G<n;++G){const C=m.fromArray(g[G]),t=new p(k);k.vertices.push(t);t.pos=C;t.index=G}g=
k.vertices.length-1;for(n=0;n<g;++n)G=new q(k,k.vertices[n],k.vertices[n+1]),k.edges.push(G);g=new q(k,k.vertices[k.vertices.length-1],k.vertices[0]);k.edges.push(g);c.components.push(k)}break;case "polyline":for(h of x.paths){x=new r(c);k=h.length;for(g=0;g<k;++g)n=m.fromArray(h[g]),G=new p(x),x.vertices.push(G),G.pos=n,G.index=g;k=x.vertices.length-1;for(g=0;g<k;++g)n=new q(x,x.vertices[g],x.vertices[g+1]),x.edges.push(n);c.components.push(x)}break;case "point":m=new r(c),h=new p(m),h.index=0,h.pos=
c.coordinateHelper.fromPoint(x),m.vertices.push(h),c.components.push(m)}return c};e._createClass(D,[{key:"canUndo",get:function(){return 0<this.undoStack.length}},{key:"lastOperation",get:function(){return 0<this.undoStack.length?this.undoStack[this.undoStack.length-1]:null}},{key:"canRedo",get:function(){return 0<this.redoStack.length}}]);return D}(u);a.Component=r;a.Edge=q;a.EditGeometry=f;a.Vertex=p;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/EditGeometryHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ./EditGeometry ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/MoveVertex ./operations/RotateVertex ./operations/ScaleVertex".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){l=function(D){function y(c,m){var h=D.call(this)||this;h.editGeometry=c;h.type=m;h._geometry=null;h._dirty=!0;h._listener=h.editGeometry.on("change",g=>{g.addedVertices&&h.emit("vertex-add",{type:"vertex-add",vertices:g.addedVertices,operation:g.operation});g.removedVertices&&h.emit("vertex-remove",{type:"vertex-remove",vertices:g.removedVertices,operation:g.operation});g.updatedVertices&&h.emit("vertex-update",{type:"vertex-update",vertices:g.updatedVertices,operation:g.operation});
h._dirty=!0});return h}e._inheritsLoose(y,D);var x=y.prototype;x.destroy=function(){this._listener.remove()};x.splitEdge=function(c,m){c=new b.SplitEdge(this.editGeometry,c,m);this.editGeometry.apply(c);return c};x.updateVertices=function(c,m,h=1){c=new f.UpdateVertices(this.editGeometry,c,m);this.editGeometry.apply(c,h);return c};x.moveVertices=function(c,m,h,g,k=1){return this.updateVertices(c,new q.MoveVertex(this.editGeometry.coordinateHelper,m,h,g),k)};x.scaleVertices=function(c,m,h,g,k,n=1,
G=0){return this.updateVertices(c,new v.ScaleVertex(this.editGeometry.coordinateHelper,m,h,g,k,G),n)};x.rotateVertices=function(c,m,h,g=1,k=0){return this.updateVertices(c,new r.RotateVertex(this.editGeometry.coordinateHelper,m,h,k),g)};x.removeVertices=function(c){let m=0;switch(this.type){case "point":m=1;break;case "polyline":m=2;break;case "polygon":m=3}c=new u.RemoveVertices(this.editGeometry,c,m);this.editGeometry.apply(c);return c};x.appendVertex=function(c){if(0===this.editGeometry.components.length)return null;
c=new d.AppendVertex(this.editGeometry,this.editGeometry.components[0],c);this.editGeometry.apply(c);return c};x.canRemoveVertex=function(){let c=0;switch(this.type){case "point":c=1;break;case "polyline":c=2;break;case "polygon":c=3}return this.editGeometry.components[0].vertices.length>c};x.undo=function(){return this.editGeometry.undo()};x.redo=function(){return this.editGeometry.redo()};e._createClass(y,[{key:"canUndo",get:function(){return this.editGeometry.canUndo}},{key:"canRedo",get:function(){return this.editGeometry.canRedo}},
{key:"geometry",get:function(){if(this._dirty){switch(this.type){case "point":this._geometry=this.editGeometry.toPoint();break;case "polyline":this._geometry=this.editGeometry.toPolyline();break;case "polygon":this._geometry=this.editGeometry.toPolygon()}this._dirty=!1}return this._geometry}}]);return y}(l);a.Component=B.Component;a.Edge=B.Edge;a.EditGeometry=B.EditGeometry;a.Vertex=B.Vertex;a.EditGeometryHelper=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports",
"../../../../core/maybe","../EditGeometry"],function(a,e,l){let B=function(){function d(u,b,p){this.editGeometry=u;this.component=b;this.pos=p;this.right=this.left=this.originalEdge=this.addedVertex=null}var f=d.prototype;f.apply=function(){let u="redo";e.isNone(this.addedVertex)&&(u="apply",this.addedVertex=new l.Vertex(this.component));if(0===this.component.vertices.length)this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{const b=e.unwrap(this.component.getLastVertex());
let p=null;b.right&&(this.originalEdge=b.right,p=this.originalEdge.right,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),1));this.component.vertices.push(this.addedVertex);this.addedVertex.pos=this.pos;e.isNone(this.left)&&(this.left=new l.Edge(this.component,b,this.addedVertex));this.component.edges.push(this.left);b.right=this.left;e.isSome(this.originalEdge)&&e.isSome(p)&&(e.isNone(this.right)&&(this.right=new l.Edge(this.component,this.addedVertex,p)),this.component.edges.push(this.right),
p.left=this.right);this.component.updateVertexIndex(this.addedVertex,b.index+1)}this.editGeometry.emit("change",{addedVertices:[this.addedVertex],operation:u})};f.undo=function(){if(e.isNone(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1);e.isSome(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.left.right=null);e.isSome(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),
1),this.right.right.left=null);e.isSome(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.left.right=this.originalEdge,this.originalEdge.right.left=this.originalEdge);e.isSome(this.left)?this.component.updateVertexIndex(this.left.left,this.left.left.index):this.component.updateVertexIndex(this.addedVertex,0);this.editGeometry.emit("change",{removedVertices:[this.addedVertex],operation:"undo"})};f.accumulate=function(u){return!1};return d}();a.AppendVertex=B;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],function(a){let e=function(){function l(d,f,u){this.editGeometry=d;this.vertices=f;this.operation=u;this.undone=!1}var B=l.prototype;B.apply=function(){this.vertices.forEach(d=>this.operation.apply(d));this.editGeometry.components.forEach(d=>d.unnormalizeVertexPositions());this.editGeometry.emit("change",{updatedVertices:this.vertices,operation:this.undone?"redo":"apply"})};B.undo=
function(){this.vertices.forEach(d=>{this.operation.undo(d)});this.editGeometry.emit("change",{updatedVertices:this.vertices,operation:"undo"});this.undone=!0};B.canAccumulate=function(d){if(this.undone||d.vertices.length!==this.vertices.length)return!1;for(let f=0;f<d.vertices.length;++f)if(d.vertices[f]!==this.vertices[f])return!1;return this.operation.canAccumulate(d.operation)};B.accumulate=function(d){return d instanceof l&&this.canAccumulate(d)?(this.vertices.forEach(f=>this.operation.accumulate(f,
d.operation)),this.operation.accumulateParams(d.operation),this.editGeometry.components.forEach(f=>f.unnormalizeVertexPositions()),this.editGeometry.emit("change",{updatedVertices:this.vertices,operation:"apply"}),!0):!1};return l}();a.PerVertexOperation=function(l){this.helper=l};a.UpdateVertices=e;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../../../../core/maybe","../EditGeometry"],function(a,
e,l){let B=function(){function d(u,b,p=0){this.editGeometry=u;this.removedVertices=null;this._minNumberOfVertices=0;this.vertices=b;this._minNumberOfVertices=p}var f=d.prototype;f.apply=function(){let u="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach(b=>{b=this._removeVertex(b);e.isSome(b)&&this.removedVertices.push(b)}),u="apply"):this.removedVertices.forEach(b=>{this._redoRemoveVertex(b)});this.editGeometry.emit("change",{removedVertices:this.vertices,operation:u})};
f.undo=function(){this.removedVertices.forEach(u=>{this._undoRemoveVertex(u)});this.editGeometry.emit("change",{addedVertices:this.vertices,operation:"undo"})};f.accumulate=function(u){return!1};f._removeVertex=function(u){const b=u.component;if(b.vertices.length<=this._minNumberOfVertices)return null;const p={removedVertex:u,createdEdge:null},q=u.left,r=u.right;b.vertices.splice(b.vertices.indexOf(u),1);q&&(b.edges.splice(b.edges.indexOf(q),1),q.left.right=null);r&&(b.edges.splice(b.edges.indexOf(r),
1),r.right.left=null);0===u.index&&r&&0<this.vertices.length&&b.swapVertices(b.vertices.indexOf(r.right),0);q&&r&&(p.createdEdge=new l.Edge(b,q.left,r.right),b.edges.push(p.createdEdge));r&&b.updateVertexIndex(r.right,r.right.index-1);return p};f._redoRemoveVertex=function(u){console.warn("redo remove vertex not implemented yet")};f._undoRemoveVertex=function(u){const b=u.removedVertex,p=u.removedVertex.component,q=b.left,r=b.right;u.createdEdge&&p.edges.splice(p.edges.indexOf(u.createdEdge),1);p.vertices.push(b);
q&&(p.edges.push(q),q.left.right=q);r&&(p.edges.push(r),r.right.left=r);p.updateVertexIndex(b,b.index)};return d}();a.RemoveVertices=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports","../../../../core/maybe","../EditGeometry"],function(a,e,l){let B=function(){function d(u,b,p){this.editGeometry=u;this.edge=b;this.t=p;this.right=this.left=this.createdVertex=null}var f=d.prototype;f.apply=function(){let u="redo";
const b=this.edge,p=b.component,q=b.component.data,r=b.left,v=b.right;p.edges.splice(p.edges.indexOf(b),1);e.isNone(this.createdVertex)&&(u="apply",this.createdVertex=new l.Vertex(b.component));p.vertices.push(this.createdVertex);this.createdVertex.pos=q.coordinateHelper.lerp(b.left.pos,b.right.pos,this.t,q.coordinateHelper.createNew());e.isNone(this.left)&&(this.left=new l.Edge(p,r,this.createdVertex));this.left.left.left?p.edges.push(this.left):p.edges.unshift(this.left);r.right=this.left;e.isNone(this.right)&&
(this.right=new l.Edge(p,this.createdVertex,v));p.edges.push(this.right);v.left=this.right;p.updateVertexIndex(this.createdVertex,r.index+1);this.editGeometry.emit("change",{addedVertices:[this.createdVertex],operation:u})};f.undo=function(){if(e.isNone(this.createdVertex)||e.isNone(this.left)||e.isNone(this.right))return null;const u=this.edge,b=u.component,p=this.createdVertex.left.left,q=this.createdVertex.right.right;b.vertices.splice(b.vertices.indexOf(this.createdVertex),1);b.edges.splice(b.edges.indexOf(this.left),
1);b.edges.splice(b.edges.indexOf(this.right),1);this.edge.left.left?b.edges.push(this.edge):b.edges.unshift(this.edge);p.right=u;q.left=u;b.updateVertexIndex(p,p.index);this.editGeometry.emit("change",{removedVertices:[this.createdVertex],operation:"undo"})};f.accumulate=function(u){return!1};return d}();a.SplitEdge=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports","../../../../core/maybe"],function(a,
e){let l=function(){function B(f,u,b){this.editGeometry=f;this.vertex=u;this.pos=b}var d=B.prototype;d.apply=function(){let f="redo";e.isNone(this.originalPosition)&&(f="apply",this.originalPosition=this.vertex.pos);this._apply(f)};d.undo=function(){this.vertex.pos=e.unwrap(this.originalPosition);this.editGeometry.emit("change",{updatedVertices:[this.vertex],operation:"undo"})};d.accumulate=function(f){return f instanceof B&&f.vertex===this.vertex?(this.pos=f.pos,this._apply("apply"),!0):!1};d._apply=
function(f){this.vertex.pos=this.pos;this.editGeometry.components.forEach(u=>u.unnormalizeVertexPositions());this.editGeometry.emit("change",{updatedVertices:[this.vertex],operation:f})};return B}();a.SetVertexPosition=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./UpdateVertices"],function(a,e,l){l=function(B){function d(u,b,p,q){u=B.call(this,u)||this;
u.dx=b;u.dy=p;u.dz=q;return u}e._inheritsLoose(d,B);var f=d.prototype;f.move=function(u,b,p,q){this.helper.addDelta(u.pos,b,p,q)};f.apply=function(u){this.move(u,this.dx,this.dy,this.dz)};f.undo=function(u){this.move(u,-this.dx,-this.dy,-this.dz)};f.canAccumulate=function(u){return u instanceof d};f.accumulate=function(u,b){this.move(u,b.dx,b.dy,b.dz)};f.accumulateParams=function(u){this.dx+=u.dx;this.dy+=u.dy;this.dz+=u.dz};return d}(l.PerVertexOperation);a.MoveVertex=l;Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/arrayUtils","./UpdateVertices"],function(a,e,l,B){B=function(d){function f(b,p,q,r=0){b=d.call(this,b)||this;b.origin=p;b.angle=q;b.accumulationType=r;return b}e._inheritsLoose(f,d);var u=f.prototype;u.rotate=function(b,p){this.helper.rotate(b.pos,this.origin,p)};u.apply=function(b){this.rotate(b,this.angle)};u.undo=function(b){this.rotate(b,
-this.angle)};u.canAccumulate=function(b){return b instanceof f&&l.equals(this.origin,b.origin)};u.accumulate=function(b,p){this.rotate(b,1===p.accumulationType?p.angle-this.angle:p.angle)};u.accumulateParams=function(b){this.angle=1===b.accumulationType?b.angle:this.angle+b.angle};return f}(B.PerVertexOperation);a.RotateVertex=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/arrayUtils ../../../../chunks/vec2f64 ../../../../chunks/vec2 ./UpdateVertices".split(" "),
function(a,e,l,B,d,f){f=function(u){function b(q,r,v,D,y,x=0){q=u.call(this,q)||this;q.origin=r;q.axis1=v;q.factor1=D;q.factor2=y;q.accumulationType=x;q.axis2=d.set(B.create(),v[1],-v[0]);return q}e._inheritsLoose(b,u);var p=b.prototype;p.scale=function(q,r,v){this.helper.scale(q.pos,this.origin,this.axis1,r);this.helper.scale(q.pos,this.origin,this.axis2,v)};p.apply=function(q){this.scale(q,this.factor1,this.factor2)};p.undo=function(q){this.scale(q,1/this.factor1,1/this.factor2)};p.canAccumulate=
function(q){return q instanceof b&&l.equals(this.origin,q.origin)&&l.equals(this.axis1,q.axis1)};p.accumulate=function(q,r){1===r.accumulationType?this.scale(q,r.factor1/this.factor1,r.factor2/this.factor2):this.scale(q,r.factor1,r.factor2)};p.accumulateParams=function(q){const r=1===q.accumulationType;this.factor1=r?q.factor1:this.factor1*q.factor1;this.factor2=r?q.factor2:this.factor2*q.factor2};return b}(f.PerVertexOperation);a.ScaleVertex=f;Object.defineProperty(a,"__esModule",{value:!0})})},
"esri/views/interactive/snapping/SnappingContext":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(d){this.visualizer=this.excludeFeature=this.vertexHandle=null;this.geometry=d.geometry;this.elevationInfo=d.elevationInfo;this.pointer=d.pointer;this.vertexHandle=d.vertexHandle;this.excludeFeature=d.excludeFeature;this.visualizer=d.visualizer}e._createClass(B,[{key:"coordinateHelper",get:function(){return this.geometry.editGeometry.coordinateHelper}}]);
return B}();a.SnappingContext=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/input/DrawEvents":function(){define(["exports"],function(a){let e=function(){function u(b,p,q,r){this.view=b;this.native=p;this.vertexIndex=q;this.vertices=r;this.defaultPrevented=!1;this.type="vertex-add"}u.prototype.preventDefault=function(){this.defaultPrevented=!0};return u}(),l=function(){function u(b,p,q,r){this.view=b;this.native=p;this.vertexIndex=q;this.vertices=r;this.defaultPrevented=!1;
this.type="vertex-update"}u.prototype.preventDefault=function(){this.defaultPrevented=!0};return u}(),B=function(){function u(b,p,q,r){this.view=b;this.native=p;this.vertexIndex=q;this.vertices=r;this.defaultPrevented=!1;this.type="vertex-remove"}u.prototype.preventDefault=function(){this.defaultPrevented=!0};return u}(),d=function(){function u(b,p,q,r,v=null){this.view=b;this.native=p;this.vertexIndex=q;this.vertices=r;this.mapPoint=v;this.coordinates=null;this.defaultPrevented=!1;this.type="cursor-update";
this.coordinates=1===r.length?r[0]:null}u.prototype.preventDefault=function(){this.defaultPrevented=!0};return u}(),f=function(){function u(b,p){this.native=b;this.vertices=p;this.coordinates=null;this.defaultPrevented=!1;this.type="draw-complete";this.coordinates=1===p.length?p[0]:null}u.prototype.preventDefault=function(){this.defaultPrevented=!0};return u}();a.CursorUpdateEvent=d;a.DrawCompleteEvent=f;a.VertexAddEvent=e;a.VertexRemoveEvent=B;a.VertexUpdateEvent=l;Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/views/draw/input/Keys":function(){define(["exports"],function(a){a.KEYS={drawCompleteKey:"c",redoKey:"r",undoKey:"z",vertexAddKey:"f",panKey:" "};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/PointDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/deprecate ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../geometry ../../core/Handles ../input/InputManager ../support/screenUtils ./DrawAction ./input/DrawEvents ./input/Keys ../3d/interactive/editingTools/draw/DrawTool".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){a.PointDrawAction=function(t){function A(w){w=t.call(this,w)||this;w._cursorScreenPoint=null;w._addVertexOnPointerUp=!1;w._activePointerId=null;w._viewHandles=new m;return w}e._inheritsLoose(A,t);var z=A.prototype;z.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};z.destroy=function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};
z.complete=function(){"2d"===this.view.type?this._cursorScreenPoint&&this._completeDrawing():this._drawTool.completeCreateOperation()};z._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("pointer-down",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=w.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=g.createScreenPointFromEvent(w),"touch"===w.pointerType&&this._updateCursor(w.native))},
h.ViewEventPriorities.TOOL),this.view.on("pointer-move",w=>{this._snappingTask=d.abortMaybe(this._snappingTask);this._cursorScreenPoint=g.createScreenPointFromEvent(w);"touch"!==w.pointerType&&this._updateCursor(w.native)},h.ViewEventPriorities.TOOL),this.view.on("pointer-drag",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._addVertexOnPointerUp=!1)},h.ViewEventPriorities.TOOL),this.view.on("pointer-up",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=
d.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?(w.stopPropagation(),this._vertexAddHandler()):this._updateCursor(w.native,"touch"===w.pointerType))},h.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],w=>{w.stopPropagation()},h.ViewEventPriorities.TOOL),this.view.on("key-down",w=>{w.key===G.KEYS.drawCompleteKey&&this._cursorScreenPoint&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler())},h.ViewEventPriorities.TOOL)])};z._removeViewHandles=
function(){this._viewHandles.removeAll()};z._addDrawTool=function(w){this._drawTool=new C.DrawTool({view:w,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("cursor-update",F=>{1===F.vertices.length&&this.emit("cursor-update",new n.CursorUpdateEvent(this.view,null,F.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",F=>
{this.emit("draw-complete",new n.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));this._removeDrawTool()})};z._removeDrawTool=function(){d.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};z._addVertex=function(w){w=this._coordinateHelper.fromArray(w);this._isDuplicateOfLastVertex(w)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(w),this.notifyChange("vertices"))};
z._updateCursor=function(w,F=!1){this._popCursorVertex();if(this._cursorScreenPoint){var E=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(d.isSome(E)&&!F){this._pushCursorVertex(E.vertex);const N=()=>new n.CursorUpdateEvent(this.view,w,this._activeComponent.vertices.length,this.vertices,d.isSome(this._stagedVertex)?new x(this._stagedVertex):null);this.emit("cursor-update",N());d.isSome(this._snappingTask)&&this._snappingTask.promise.then(U=>{U.valid&&this.emit("cursor-update",N())},
()=>{})}}};z._completeDrawing=function(w){this._activePointerId=null;this._popCursorVertex();this._snappingTask=d.abortMaybe(this._snappingTask);d.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();w=new n.DrawCompleteEvent(w,this.vertices);this.emit("draw-complete",w);w.defaultPrevented||this._removeViewHandles()};z._shouldHandlePointerEvent=function(w){return("mouse"!==w.pointerType||0===w.button)&&(d.isNone(this._activePointerId)||this._activePointerId===w.pointerId)};z._vertexAddHandler=
function(){const w=d.isSome(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);d.isSome(w)&&(this._addVertex(w),this._completeDrawing())};e._createClass(A,[{key:"coordinates",get:function(){p.deprecatedProperty(f.getLogger("esri.views.draw.PointDrawAction"),"coordinates",{replacement:"vertices",version:"4.19"});return this.vertices[0]}}]);return A}(k);l.__decorate([b.property({readOnly:!0})],a.PointDrawAction.prototype,
"coordinates",null);a.PointDrawAction=l.__decorate([r.subclass("esri.views.draw.PointDrawAction")],a.PointDrawAction);Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawTool":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../core/Evented ./DrawOperation ./drawSurfaces ../../../../interactive/InteractiveToolBase".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){a.DrawTool=function(h){function g(n){n=h.call(this,n)||this;n.drawOperation=null;n.hasZ=!0;n.defaultZ=0;n.elevationInfo=null;n.snapToScene=null;n.mode=null;n.geometryType=null;n.type="draw-3d";return n}e._inheritsLoose(g,h);var k=g.prototype;k.initialize=function(){const n=d.unwrapOr(this.elevationInfo,{mode:this.hasZ?"absolute-height":"on-the-ground",offset:0});this.drawOperation=new x.DrawOperation({view:this.view,manipulators:this.manipulators,geometryType:this.geometryType,
drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,snappingDrawSurface:new c.SceneDrawSurface(this.view,n),elevationDrawSurface:new c.ElevationDrawSurface(n,this.defaultZ,this.view),hasM:!1,elevationInfo:n});this.drawOperation.on("vertex-add",G=>this.onVertexAdd(G));this.drawOperation.on("vertex-remove",G=>this.onVertexRemove(G));this.drawOperation.on("vertex-update",G=>this.onVertexUpdate(G));this.drawOperation.on("cursor-update",G=>this.onCursorUpdate(G));
this.drawOperation.on("complete",G=>this.onComplete(G))};k.destroy=function(){this.drawOperation.destroy();this.drawOperation=null;this._set("view",null)};k.onInputEvent=function(n){this.drawOperation.onInputEvent(n)};k.reset=function(){};k.redo=function(){this.drawOperation.redo()};k.undo=function(){this.drawOperation.undo()};k.completeCreateOperation=function(){this.drawOperation.complete()};k.activate=function(){};k.deactivate=function(){this.drawOperation.isCompleted||this.drawOperation.cancel()};
k.getVertexCoords=function(){return this.drawOperation.vertices};k.onVertexAdd=function(n){this.emit("vertex-add",n)};k.onVertexRemove=function(n){this.emit("vertex-remove",n)};k.onVertexUpdate=function(n){this.emit("vertex-update",n)};k.onCursorUpdate=function(n){this.emit("cursor-update",n)};k.onComplete=function(n){this.emit("complete",n)};e._createClass(g,[{key:"enabled",set:function(n){this.drawOperation.interactive=n;this._set("enabled",n)}},{key:"canRedo",get:function(){return this.drawOperation.canRedo}},
{key:"canUndo",get:function(){return this.drawOperation.canUndo}}]);return g}(y.EventedMixin(m.InteractiveToolBase));l.__decorate([b.property({constructOnly:!0,nonNullable:!0})],a.DrawTool.prototype,"view",void 0);l.__decorate([b.property({value:!0})],a.DrawTool.prototype,"enabled",null);l.__decorate([b.property({constructOnly:!0})],a.DrawTool.prototype,"hasZ",void 0);l.__decorate([b.property({constructOnly:!0,nonNullable:!0})],a.DrawTool.prototype,"defaultZ",void 0);l.__decorate([b.property({constructOnly:!0})],
a.DrawTool.prototype,"elevationInfo",void 0);l.__decorate([b.property()],a.DrawTool.prototype,"snapToScene",void 0);l.__decorate([b.property({constructOnly:!0})],a.DrawTool.prototype,"mode",void 0);l.__decorate([b.property({constructOnly:!0})],a.DrawTool.prototype,"geometryType",void 0);l.__decorate([b.property({readOnly:!0})],a.DrawTool.prototype,"type",void 0);a.DrawTool=l.__decorate([q.subclass("esri.views.3d.interactive.editingTools.draw.DrawTool")],a.DrawTool);Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawOperation":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/lang ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../core/promiseUtils ../../../../../geometry/Point ../../../../../geometry ../../../../../core/Evented ../../../../../core/screenUtils ../../../../../core/Handles ../../../../support/Scheduler ../../../../../layers/graphics/dehydratedFeatureComparison ../../../../interactive/coordinateHelper ../../../../interactive/editGeometry/EditGeometry ../../../../interactive/editGeometry/EditGeometryHelper ../../../../interactive/snapping/SnappingContext ../../../../interactive/dragEventPipeline ../../SnappingDragPipelineStep ../../SnappingVisualizer3D ./DrawManipulator ../../../../draw/DrawingMode".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z,w,F,E,N,U){a.DrawOperation=function(I){function L(K){var P,Q;var R=I.call(this)||this;R._manipulator=null;R._stagedVertex=null;R.geometryType=null;R.elevationInfo=null;R.snapToSceneEnabled=null;R._handles=new k;R._defaultZ=0;R._elevationDrawSurface=null;R._snappingDrawSurface=null;R._snappingManager=null;R._snappingPipeline=new F.SnappingPipeline;R._createOperationCompleted=!1;R._pointerDownStates=new Set;R._snappingTask=null;R.view=K.view;
R.drawingMode=f.unwrapOr(K.drawingMode,U.defaultDrawingMode);R.geometryType=K.geometryType;R.elevationInfo=K.elevationInfo;R.coordinateHelper=C.createCoordinateHelper(K.hasZ,K.hasM,R.view.spatialReference,R.view.viewingMode);R._defaultZ=K.defaultZ;R.snapToSceneEnabled=K.snapToSceneEnabled;R._snappingDrawSurface=f.unwrap(K.snappingDrawSurface);R._snappingManager=K.snappingManager;const Y=null==(P=K.view)?void 0:null==(Q=P.resourceController)?void 0:Q.scheduler;R._frameTask=Y?Y.registerTask(n.Task.SNAPPING,
T=>R._frameTask.processQueue(T),()=>!1):n.ImmediateTask;R._elevationDrawSurface=K.elevationDrawSurface;R._editGeometry=new A.EditGeometryHelper(new t.EditGeometry(R.coordinateHelper),"segment"===R.geometryType?"polyline":R.geometryType);R._activeComponent=new t.Component(R._editGeometry.editGeometry);R._editGeometry.editGeometry.components.push(R._activeComponent);R._editGeometry.on(["vertex-add","vertex-update","vertex-remove"],T=>{const V=T.vertices.map(X=>({componentIndex:0,vertexIndex:X.index,
coordinates:R.coordinateHelper.toArray(X.pos)})),W=V.map(X=>X.coordinates);switch(T.type){case "vertex-add":R.emit(T.type,{...T,added:W,vertices:V});break;case "vertex-update":R.emit(T.type,{...T,updated:W,vertices:V});break;case "vertex-remove":R.emit(T.type,{...T,removed:W,vertices:V})}});R._manipulator=new N.DrawManipulator({grabbableForEvent:T=>"click"!==R.drawingMode?!0:"touch"===T.pointerType&&R._snappingEnabled&&1===R._pointerDownStates.size});K.manipulators.add(R._manipulator);R._manipulator.grabbable=
"point"!==R.geometryType;K=R.createManipulatorDragPipeline(R._manipulator);P=R._manipulator.events.on("immediate-double-click",T=>{R._manipulator.dragging||"point"===R.geometryType||(R.complete(),T.stopPropagation())});Q=R._manipulator.events.on("immediate-click",T=>{if(!R._manipulator.dragging){var V=R._activeComponent,W=R._closeOnClickVertexIndex(T.screenPoint);if(f.isSome(W))R.discardStagedVertex(),R.complete();else if(W=R._screenToMap(T.screenPoint),f.isSome(W))switch(R.drawingMode){case "click":case "hybrid":R._snappingTask=
f.abortMaybe(R._snappingTask),R.hasStagedVertex?R.commitStagedVertex():R._editGeometry.appendVertex(R.coordinateHelper.fromPoint(W)),("point"===R.geometryType||"segment"===R.geometryType&&2===V.vertices.length||"segment"===R.geometryType&&"hybrid"===R.drawingMode&&1===V.vertices.length)&&R.complete()}T.stopPropagation()}});R._handles.add([K,Q,P]);return R}e._inheritsLoose(L,I);var M=L.prototype;M.createManipulatorDragPipeline=function(K){switch(this.drawingMode){case "click":return this.createManipulatorDragPipelineClick(K);
case "freehand":return this.createManipulatorDragPipelineFreehand(K);case "hybrid":return this.createManipulatorDragPipelineHybrid(K)}};M.createManipulatorDragPipelineClick=function(K){return w.createManipulatorDragEventPipeline(K,(P,Q,R,Y)=>{const T="touch"===Y&&this._snappingEnabled;!this.isCompleted&&T&&(Q.next(this._screenToMapDragEventStep()).next(V=>{"start"===V.action&&(this.stagedVertex=V.mapStart,("segment"===this.geometryType||T&&0===this.vertices.length)&&this.commitStagedVertex());return V}).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>
T,cancel:R,snappingManager:this._snappingManager,snappingContext:new z.SnappingContext({geometry:this._editGeometry,elevationInfo:this.elevationInfo,pointer:Y,visualizer:new E.SnappingVisualizer3D})}),this._snappingPipeline.next).next(V=>{T&&(this.stagedVertex=V.mapEnd,"end"===V.action&&this.commitStagedVertex());return V}).next(V=>{"end"!==V.action||"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete();return V}),R.next(()=>{T&&f.isSome(this._snappingManager)&&this._snappingManager.doneSnapping()}))})};
M.createManipulatorDragPipelineFreehand=function(K){return w.createManipulatorDragEventPipeline(K,(P,Q)=>{this.isCompleted||Q.next(this._screenToMapDragEventStep()).next(R=>{"start"===R.action&&(this.stagedVertex=R.mapStart,"segment"===this.geometryType&&this.commitStagedVertex());return R}).next(R=>{switch(R.action){case "start":case "update":this.stagedVertex=R.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return R})})};
M.createManipulatorDragPipelineHybrid=function(K){return w.createManipulatorDragEventPipeline(K,(P,Q)=>{this.isCompleted||Q.next(this._screenToMapDragEventStep()).next(R=>{"start"===R.action&&(this.stagedVertex=R.mapStart,this.commitStagedVertex());return R}).next(R=>{switch(R.action){case "start":case "update":this.stagedVertex=R.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"segment"!==this.geometryType&&"point"!==this.geometryType||
this.complete()}return R})})};M.destroy=function(){this._handles.destroy();this._handles=null;this._editGeometry.destroy();this._frameTask.remove()};M.onInputEvent=function(K){switch(K.type){case "pointer-down":this._pointerDownStates.add(K.pointerId);break;case "pointer-up":this._pointerDownStates.delete(K.pointerId)}switch(K.type){case "pointer-move":return this._onPointerMove(K);case "hold":return this._onHold(K)}};M.redo=function(){this._editGeometry.redo()};M.undo=function(){f.isSome(this._snappingManager)&&
this._snappingManager.doneSnapping();this._editGeometry.undo()};M.complete=function(K=!1){f.abortMaybe(this._snappingTask);this.commitStagedVertex();this._createOperationCompleted=!0;f.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();this.emit("complete",{vertices:this.vertices.map((P,Q)=>({componentIndex:0,vertexIndex:Q,coordinates:P})),aborted:K,type:"complete"})};M.cancel=function(){this.complete(!0)};M.commitStagedVertex=function(){this._snappingTask=f.abortMaybe(this._snappingTask);
if(f.isSome(this._stagedVertex)){const K=this._stagedVertex;this._stagedVertex=null;this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(K))}};M.discardStagedVertex=function(){this._stagedVertex=null};M._onPointerMove=function(K){f.abortMaybe(this._snappingTask);if(!(this._manipulator.dragging||this._pointerDownStates.has(K.pointerId)||this._manipulator.grabbing)&&this._manipulator.interactive){var P=g.createScreenPoint(K.x,K.y),Q=this._closeOnClickVertexIndex(P);if(f.isSome(Q))this.discardStagedVertex(),
P={componentIndex:0,vertexIndex:Q,coordinates:this.coordinateHelper.toArray(this._activeComponent.vertices[Q].pos)},this.emit("cursor-update",{updated:null,vertices:[P],operation:"apply",type:"vertex-update"});else{const R=this._screenToMap(P);this._manipulator.cursor=f.isSome(R)?"crosshair":null;if(f.isSome(R))if(f.isSome(this._snappingManager)){const Y=this._snappingManager,T=new z.SnappingContext({geometry:this._editGeometry,elevationInfo:this.elevationInfo,pointer:K.pointerType,visualizer:new E.SnappingVisualizer3D});
this.stagedVertex=Y.update(R,T);this._snappingTask=x.createTask(async V=>{const W=await this._frameTask.schedule(()=>Y.snap(R,T,V),V);W.valid&&await this._frameTask.schedule(()=>{this.stagedVertex=W.apply()},V)})}else this.stagedVertex=R}K.stopPropagation()}};M._onHold=function(K){f.abortMaybe(this._snappingTask);"click"===this.drawingMode&&"touch"===K.pointerType&&this._snappingEnabled&&(this.stagedVertex=K.mapPoint);K.stopPropagation()};M._screenToMapDragEventStep=function(){let K=null;return P=>
{"start"===P.action&&(K=this._screenToMap(P.screenStart));if(f.isNone(K))return null;const Q=this._screenToMap(P.screenEnd);return f.isSome(Q)?{...P,mapStart:K,mapEnd:Q}:null}};M._screenToMap=function(K){return this._getDrawSurface().screenToMap(K)};M._mapToScreen=function(K){return this._getDrawSurface().mapToScreen(K)};M._getDrawSurface=function(){var K=null;if(this.coordinateHelper.hasZ){K=this._defaultZ;let P=!1;f.isSome(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(P=!0);
f.isSome(this.snapToSceneEnabled)&&(P=this.snapToSceneEnabled);f.isSome(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(P=!1);const Q=this._activeComponent.vertices.length;("segment"===this.geometryType||"polygon"===this.geometryType)&&0<Q&&(K=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),P=!1);P?K=this._snappingDrawSurface:(this._elevationDrawSurface.defaultZ=K,K=this._elevationDrawSurface)}else this._elevationDrawSurface.defaultZ=null,K=this._elevationDrawSurface;
return K};M._vertexWithinPointerDistance=function(K,P){const Q=this._mapToScreen(K);f.isSome(Q)?(K=Q.x-P.x,P=Q.y-P.y,P=25>=K*K+P*P):P=!1;return P};M._closeOnClickVertexIndex=function(K){const P=this._activeComponent;if("polygon"===this.geometryType&&2<P.vertices.length){if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(P.vertices[0].pos,S),K))return 0;if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(P.vertices[P.vertices.length-1].pos,S),K))return P.vertices.length-
1}return null};e._createClass(L,[{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"_snappingEnabled",get:function(){return f.isSome(this._snappingManager)&&this._snappingManager.options.effectiveEnabled}},{key:"canRedo",get:function(){return this._editGeometry.canRedo}},{key:"canUndo",get:function(){return this._editGeometry.canUndo}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(K){this._manipulator.interactive=K}},{key:"numVertices",
get:function(){return f.isSome(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"vertices",get:function(){const K=this._activeComponent.vertices.map(P=>this.coordinateHelper.toArray(P.pos));f.isSome(this._stagedVertex)&&K.push(this.coordinateHelper.pointToArray(this._stagedVertex));return K}},{key:"spatialReference",get:function(){return this.view.spatialReference}},
{key:"hasStagedVertex",get:function(){return f.isSome(this._stagedVertex)}},{key:"stagedVertex",get:function(){return this._stagedVertex},set:function(K){f.isNone(K)?this.discardStagedVertex():f.isSome(this._stagedVertex)&&G.pointEquals(this._stagedVertex,K)||(f.isNone(this._stagedVertex)?this._stagedVertex=d.clone(K):(this._stagedVertex.x=K.x,this._stagedVertex.y=K.y,this._stagedVertex.z=K.z,this._stagedVertex.m=K.m,this._stagedVertex.hasZ=K.hasZ,this._stagedVertex.hasM=K.hasM,this._stagedVertex.spatialReference=
K.spatialReference),K={componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(K)},this.emit("cursor-update",{updated:null,vertices:[K],operation:"apply",type:"vertex-update"}))}}]);return L}(h);a.DrawOperation=l.__decorate([r.subclass("esri.views.3d.interactive.editingTools.draw3D.DrawOperation")],a.DrawOperation);const S=new c({x:0,y:0,z:0});Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../core/lang ../../core/maybe ../../core/handleUtils ../../geometry/support/webMercatorUtils ../../core/mathUtils ../../core/screenUtils ../draw/support/drawUtils".split(" "),
function(a,e,l,B,d,f,u,b){function p(c,m){let h=null,g=null;return k=>{if("cancel"===k.action)l.isSome(g)&&(g.execute({action:"cancel"}),g=h=null);else{var n={action:k.action,screenStart:k.start,screenEnd:k.screenPoint};"start"===k.action&&l.isNone(h)&&(h=new x,g=new x,m(c,h,g,k.pointerType,n));l.isSome(h)&&h.execute(n);"end"===k.action&&l.isSome(h)&&(g=h=null)}}}function q(c,m){return c.events.on("drag",p(c,m))}function r(c,m){let h=null;const g=l.isSome(c[m])?c[m].spatialReference:null;return k=>
{if("start"===k.action&&l.isSome(c[m])){var n=c[m],G=k.mapStart.spatialReference;h=l.isNone(n)||"mesh"===n.type?null:n.spatialReference.equals(G)?n.clone():d.canProject(n,G)?d.project(n,G):null}if(l.isNone(h))return null;n=k.mapEnd.x-k.mapStart.x;G=k.mapEnd.y-k.mapStart.y;const C=k.mapEnd.z-k.mapStart.z,t=b.move(h.clone(),n,G,C);t.spatialReference.equals(g)?c[m]=t:c[m]=d.project(t,g);return{...k,translationX:n,translationY:G,translationZ:C}}}function v(c){return r(c,"geometry")}function D(c,m){const h=
new Map;for(const g of m)h.set(g,e.clone(c[g]));return g=>{h.forEach((k,n)=>{c[n]=k});return g}}function y(c){return D(c,["geometry"])}let x=function(){function c(){this.execute=()=>{}}c.prototype.next=function(m,h=new c){l.isSome(m)&&(this.execute=g=>{g=m(g);l.isSome(g)&&h.execute(g)});return h};return c}();a.EventPipeline=x;a.addMapDelta=function(){let c=0,m=0,h=0;return g=>{"start"===g.action&&(c=g.mapStart.x,m=g.mapStart.y,h=g.mapStart.z);const k=g.mapEnd.x-c,n=g.mapEnd.y-m,G=g.mapEnd.z-h;c=g.mapEnd.x;
m=g.mapEnd.y;h=g.mapEnd.z;return{...g,mapDeltaX:k,mapDeltaY:n,mapDeltaZ:G,mapDeltaSpatialReference:g.mapStart.spatialReference}}};a.addScreenDelta=function(){let c=0,m=0;return h=>{"start"===h.action&&(c=h.screenStart.x,m=h.screenStart.y);const g=h.screenEnd.x-c,k=h.screenEnd.y-m;c=h.screenEnd.x;m=h.screenEnd.y;return{...h,screenDeltaX:g,screenDeltaY:k}}};a.constrainToMapAxis=function(c,m){const h=[c.x,c.y,c.z],g=[Math.cos(m),Math.sin(m)];c=Math.sqrt(g[0]*g[0]+g[1]*g[1]);if(0===c)return null;g[0]/=
c;g[1]/=c;const k=n=>{const G=(n.x-h[0])*g[0]+(n.y-h[1])*g[1];n.x=h[0]+G*g[0];n.y=h[1]+G*g[1]};return n=>{k(n.mapStart);k(n.mapEnd);return n}};a.createDragEventPipelineCallback=p;a.createManipulatorDragEventPipeline=q;a.createManipulatorDragEventPipelineMany=function(c,m){const h=[];for(const g of c)h.push(q(g,m));return B.handlesGroup(h)};a.dragAtLocation=function(c,m){let h=null,g=0,k=0;return n=>{"start"===n.action&&(h=c.toScreen(m),0>h.x||h.x>c.width||0>h.y||h.y>c.height?h=null:(g=n.screenStart.x-
h.x,k=n.screenStart.y-h.y));if(null==h)return null;var G=f.clamp(n.screenEnd.x-g,0,c.width);const C=f.clamp(n.screenEnd.y-k,0,c.height);G=u.createScreenPoint(G,C);n.screenStart=h;n.screenEnd=G;return n}};a.dragGeometry=r;a.dragGraphic=v;a.dragGraphicMany=function(c){const m=c.map(h=>l.unwrap(v(h))).filter(h=>l.isSome(h));return h=>{const g=h.mapEnd.x-h.mapStart.x,k=h.mapEnd.y-h.mapStart.y,n=h.mapEnd.z-h.mapStart.z;m.forEach(G=>G(h));return{...h,translationX:g,translationY:k,translationZ:n}}};a.resetGraphic=
y;a.resetGraphicMany=function(c){const m=c.map(h=>l.unwrap(y(h))).filter(h=>l.isSome(h));return h=>{m.forEach(g=>g(h));return h}};a.resetProperties=D;a.resetSymbol=function(c){const m=l.isSome(c.symbol)?c.symbol.clone():null;return h=>{c.symbol=m;return h}};a.screenToMap=function(c,m=null,h){let g=null;const k=l.isSome(m)&&!c.spatialReference.equals(m)?G=>l.isSome(G)?d.project(G,m):G:G=>G,n={exclude:[],...h};return G=>{"start"===G.action&&(g=k(c.toMap(G.screenStart,n)));if(l.isNone(g))return null;
const C=k(c.toMap(G.screenEnd,n));return l.isSome(C)?{...G,mapStart:g,mapEnd:C}:null}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/support/drawUtils":function(){define(["exports","../../../geometry/support/coordsUtils","../../../geometry/support/boundsUtils","../../../geometry/support/aaBoundingRect"],function(a,e,l,B){function d(b,p,q,r){null==r||b.hasZ||(r=void 0);if("point"===b.type)return b.x+=p,b.y+=q,b.hasZ&&null!=r&&(b.z+=r),b;if("multipoint"===b.type){var v=b.points;
for(var D=0;D<v.length;D++)v[D]=f(v[D],p,q,r);return b}if("extent"===b.type)return b.xmin+=p,b.xmax+=p,b.ymin+=q,b.ymax+=q,null!=r&&(b.zmin+=r,b.zmax+=r),b;v=e.geometryToCoordinates(b);D="polyline"===b.type?b.paths:b.rings;for(let y=0;y<v.length;y++){const x=v[y];for(let c=0;c<x.length;c++)x[c]=f(x[c],p,q,r)}"paths"in b?b.paths=D:b.rings=D;return b}function f(b,p,q,r){return u(b,b[0]+p,b[1]+q,null!=b[2]&&null!=r?b[2]+r:void 0)}function u(b,p,q,r){p=[p,q];2<b.length&&p.push(null!=r?r:b[2]);3<b.length&&
p.push(b[3]);return p}a.cloneMove=function(b,p,q,r,v){b=b.clone();var D=r.resolution;if("point"===b.type)return v?d(b,p*D,-q*D):(v=r.state.transform,r=r.state.inverseTransform,D=v[0]*b.x+v[2]*b.y+v[4],v=v[1]*b.x+v[3]*b.y+v[5],b.x=r[0]*(D+p)+r[2]*(v+q)+r[4],b.y=r[1]*(D+p)+r[3]*(v+q)+r[5]),b;if("multipoint"===b.type){if(v)d(b,p*D,-q*D);else{v=b.points;D=r.state.transform;r=r.state.inverseTransform;for(var y=0;y<v.length;y++){var x=v[y],c=D[0]*x[0]+D[2]*x[1]+D[4],m=D[1]*x[0]+D[3]*x[1]+D[5];v[y]=u(x,
r[0]*(c+p)+r[2]*(m+q)+r[4],r[1]*(c+p)+r[3]*(m+q)+r[5],void 0)}}return b}if("extent"===b.type)return v?d(b,p*D,-q*D):(v=r.state.transform,r=r.state.inverseTransform,D=v[0]*b.xmin+v[2]*b.ymin+v[4],y=v[1]*b.xmin+v[3]*b.ymin+v[5],x=v[0]*b.xmax+v[2]*b.ymax+v[4],v=v[1]*b.xmax+v[3]*b.ymax+v[5],b.xmin=r[0]*(D+p)+r[2]*(y+q)+r[4],b.ymin=r[1]*(D+p)+r[3]*(y+q)+r[5],b.xmax=r[0]*(x+p)+r[2]*(v+q)+r[4],b.ymax=r[1]*(x+p)+r[3]*(v+q)+r[5]),b;if(v)d(b,p*D,-q*D);else{v=e.geometryToCoordinates(b);D="polyline"===b.type?
b.paths:b.rings;y=r.state.transform;r=r.state.inverseTransform;for(x=0;x<v.length;x++)for(c=v[x],m=0;m<c.length;m++){const h=c[m],g=y[0]*h[0]+y[2]*h[1]+y[4],k=y[1]*h[0]+y[3]*h[1]+y[5];c[m]=u(h,r[0]*(g+p)+r[2]*(k+q)+r[4],r[1]*(g+p)+r[3]*(k+q)+r[5],void 0)}"paths"in b?b.paths=D:b.rings=D}return b};a.getRotationAngle=function(b,p,q,r,v,D){return 180*Math.atan2(p-D,b-v)/Math.PI-180*Math.atan2(p-r,b-q)/Math.PI};a.getScaleRatio=function(b,p,q,r,v,D){return Math.sqrt((v-b)*(v-b)+(D-p)*(D-p))/Math.sqrt((q-
b)*(q-b)+(r-p)*(r-p))};a.move=d;a.scale=function(b,p,q,r){if("point"===b.type){const {x:k,y:n}=b;var v=r?r[0]:k,D=r?r[1]:n;b=b.clone();q=(n-D)*q+D;b.x=(k-v)*p+v;b.y=q;return b}if("multipoint"===b.type){v=e.geometryToCoordinates(b);D=B.create();const [k,n,G,C]=l.getRingsOrPathsBounds(D,[v]);v=r?r[0]:(k+G)/2;D=r?r[1]:(C+n)/2;b=b.clone();r=b.points;for(var y=0;y<r.length;y++){var x=r[y];const [t,A]=x;r[y]=u(x,(t-v)*p+v,(A-D)*q+D,void 0)}return b}if("extent"===b.type){const {xmin:k,xmax:n,ymin:G,ymax:C}=
b;v=r?r[0]:(k+n)/2;D=r?r[1]:(C+G)/2;b=b.clone();b.xmin=(k-v)*p+v;b.ymax=(C-D)*q+D;b.xmax=(n-v)*p+v;b.ymin=(G-D)*q+D;b.xmin>b.xmax&&(p=b.xmin,b.xmin=b.xmax,b.xmax=p);b.ymin>b.ymax&&(p=b.ymin,b.ymin=b.ymax,b.ymax=p);return b}v=e.geometryToCoordinates(b);D=B.create();const [c,m,h,g]=l.getRingsOrPathsBounds(D,v);D=r?r[0]:(c+h)/2;r=r?r[1]:(g+m)/2;b=b.clone();y="polyline"===b.type?b.paths:b.rings;for(x=0;x<v.length;x++){const k=v[x];for(let n=0;n<k.length;n++){const G=k[n],[C,t]=G;y[x][n]=u(G,(C-D)*p+D,
(t-r)*q+r,void 0)}}"paths"in b?b.paths=y:b.rings=y;return b};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/SnappingDragPipelineStep":function(){define("exports ../../../core/maybe ../../../core/promiseUtils ../../support/Scheduler ../../../layers/graphics/dehydratedFeatureComparison ../../interactive/snapping/SnappingContext ../../interactive/dragEventPipeline".split(" "),function(a,e,l,B,d,f,u){let b=function(){function p(){this.next=new u.EventPipeline}p.prototype.createSnapDragEventPipelineStep=
function({predicate:q=()=>!0,cancel:r,snappingManager:v,snappingContext:D}){if(e.isNone(v))return m=>m;let y=null,x=null;const c=()=>{y=e.abortMaybe(y);v.doneSnapping();e.isSome(x)&&x.frameTask.remove();x=null};r.next(m=>{c();return m});this.next=new u.EventPipeline;return m=>{if(!q(m))return m;y=e.abortMaybe(y);if("start"===m.action){const h="3d"===v.view.type?v.view.resourceController.scheduler.registerTask(B.Task.SNAPPING,g=>e.unwrap(h).processQueue(g),()=>!1):B.ImmediateTask;x={context:new f.SnappingContext({geometry:D.geometry,
elevationInfo:D.elevationInfo,pointer:D.pointer,vertexHandle:e.isSome(m.info)?m.info.handle:null,excludeFeature:D.excludeFeature,visualizer:D.visualizer}),originalPos:e.isSome(m.snapOrigin)?D.coordinateHelper.createDehydratedPoint(m.snapOrigin):m.mapStart,frameTask:h}}if(e.isSome(x)){const h=x.context.coordinateHelper.createDehydratedPoint(x.context.coordinateHelper.fromArray([x.originalPos.x,x.originalPos.y,x.originalPos.z]));h.x+=m.mapEnd.x-m.mapStart.x;h.y+=m.mapEnd.y-m.mapStart.y;const g=m.mapStart.x-
x.originalPos.x,k=m.mapStart.y-x.originalPos.y,n={...m,action:"udpate"},G=x.context,C=v.update(h,x.context);m.mapEnd.x=C.x+g;m.mapEnd.y=C.y+k;if("end"!==m.action){const t=x.frameTask;y=l.createTask(async A=>{const z=await t.schedule(()=>v.snap(h,G,A),A);if(z.valid){const w=await t.schedule(()=>z.apply(),A);d.pointEquals(w,C)||(n.mapEnd.x=w.x+g,n.mapEnd.y=w.y+k,this.next.execute(n))}})}}"end"===m.action&&c();return m}};return p}();a.SnappingPipeline=b;Object.defineProperty(a,"__esModule",{value:!0})})},
"esri/views/3d/interactive/SnappingVisualizer3D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../core/handleUtils ../../../Color ../../../chunks/vec3f64 ../../../chunks/vec3 ../../interactive/snapping/Settings ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){l=function(x){function c(){return x.apply(this,arguments)||this}e._inheritsLoose(c,x);var m=c.prototype;m.visualizeIntersectionPoint=function(h,g){const {coordinateHelper:k,elevationInfo:n,view:G}=g;return B.destroyHandle(new D.PointVisualElement({view:G,primitive:"circle",geometry:k.createPoint(h.intersectionPoint),elevationInfo:n,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:d.toUnitRGBA(b.defaults.orange),pixelSnappingEnabled:!1}))};m.visualizePoint=function(h,
g){const {coordinateHelper:k,elevationInfo:n,view:G}=g;return B.destroyHandle(new D.PointVisualElement({view:G,primitive:"circle",geometry:k.createPoint(h.point),elevationInfo:n,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:d.toUnitRGBA(b.defaults.orange),pixelSnappingEnabled:!1}))};m.visualizeLine=function(h,g){const {coordinateHelper:k,elevationInfo:n,view:G}=g;return B.destroyHandle(this.createLineSegmentHintFromMap(h.type,h.lineStart,h.lineEnd,k,n,G,h.fadeLeft,h.fadeRight))};m.visualizeParallelSign=
function(h,g){const {coordinateHelper:k,elevationInfo:n,view:G}=g,C=p.anyMapPointToRender(h.lineStart,k,n,g.view);h=p.anyMapPointToRender(h.lineEnd,k,n,g.view);h=u.lerp(h,C,h,.5);g=new v.ParallelLineVisualElement({view:G,attached:!1,offset:b.defaults.parallelLineHintOffset,length:b.defaults.parallelLineHintLength,width:b.defaults.parallelLineHintWidth,color:d.toUnitRGBA(b.defaults.orange),location:h,renderOccluded:16});g.setDirectionFromPoints(C,h);g.attached=!0;return B.destroyHandle(g)};m.visualizeRightAngleQuad=
function(h,g){const {coordinateHelper:k,elevationInfo:n,view:G}=g;return B.destroyHandle(new y.RightAngleQuadVisualElement({view:G,attached:!0,color:d.toUnitRGBA(b.defaults.orange),renderOccluded:2,outlineRenderOccluded:16,outlineColor:d.toUnitRGBA(b.defaults.orange),outlineSize:b.defaults.rightAngleHintOutlineSize,size:b.defaults.rightAngleHintSize,geometry:{previous:p.anyMapPointToRender(h.previousVertex,k,n,G),center:p.anyMapPointToRender(h.centerVertex,k,n,G),next:p.anyMapPointToRender(h.nextVertex,
k,n,G)}}))};m.createLineSegmentHintFromMap=function(h,g,k,n,G,C,t=!0,A=!0){const z=f.create(),w=f.create();p.anyMapPointsToRenderWithEqualZ(g,k,n,G,C,z,w);return this.createLineSegmentHint(h,C,z,w,t,A)};m.createLineSegmentHint=function(h,g,k,n,G=!0,C=!0){g=new r.ExtendedLineVisualElement({view:g,extensionType:3,start:k,end:n,color:d.toUnitRGBA(b.defaults.orange),renderOccluded:16});switch(h){case 0:g.width=b.defaults.lineHintWidthTarget;g.fadedExtensions={start:0,end:b.defaults.lineHintFadedExtensions};
break;case 2:g.width=b.defaults.lineHintWidthReference;g.fadedExtensions={start:0,end:0};break;case 1:g.width=b.defaults.lineHintWidthReference,g.fadedExtensions={start:G?b.defaults.lineHintFadedExtensions:0,end:C?b.defaults.lineHintFadedExtensions:0}}g.attached=!0;return g};return c}(q.SnappingVisualizer);a.SnappingVisualizer3D=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/ExtendedLineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../core/Handles ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../chunks/clipRay ../../support/geometryUtils ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/RibbonLineMaterial ./LaserlineVisualElement ./Object3DVisualElement".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x){l=function(n){function G(t){var A=n.call(this,t)||this;A._ray=r.ray.create();A._externalResources=null;A._handles=new u;A._isWorldDown=!1;A._start=d.create();A._end=d.fromValues(1,0,0);A._width=1;A._color=p.fromValues(1,0,1,1);A._polygonOffset=!1;A._writeDepthEnabled=!0;A._innerWidth=0;A._innerColor=p.fromValues(1,1,1,1);A._stippleIntegerRepeats=!0;A._stipplePattern=null;A._stippleOffColor=null;A._falloff=0;A._extensionType=0;A._laserlineStyle=null;A._laserlineEnabled=
!1;A._renderOccluded=4;A._fadedExtensions=k;A.applyProps(t);return A}e._inheritsLoose(G,n);var C=G.prototype;C.createExternalResources=function(){const t=new D.RibbonLineMaterial(this.materialParameters);this._handles.add(this.view.state.watch("camera",()=>{this.updateGeometry()}));const A=new y.LaserlineVisualElement({view:this.view,attached:this._laserlineEnabled});this._externalResources={material:t,laserline:A}};C.destroyExternalResources=function(){B.isSome(this._externalResources)&&this._externalResources.laserline.destroy();
this._externalResources=null;this._handles.removeAll()};C.forEachExternalMaterial=function(t){B.isSome(this._externalResources)&&t(this._externalResources.material)};C.createGeometries=function(t){var A=[d.create(),d.create()],z=3===this.extensionType;z&&A.push(d.create(),d.create());z=z?new Float32Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]):null;A=v.createPolylineGeometry(A,null,z);t.addGeometry(A,B.unwrap(this._externalResources).material);this.updateVertices(A)};C.updateVisibility=function(t){n.prototype.updateVisibility.call(this,
t);B.isSome(this._externalResources)&&(this._externalResources.laserline.visible=t)};C.setStartEndFromWorldDownAtLocation=function(t){this._isWorldDown=!0;f.copy(this._start,t);this.view.renderCoordsHelper.worldUpAtPosition(t,this._end);f.subtract(this._end,t,this._end);r.ray.fromPoints(this._start,this._end,this._ray);this.updateGeometry()};C.updateMaterial=function(){B.isNone(this._externalResources)||this._externalResources.material.setParameterValues(this.materialParameters)};C.updateGeometry=
function(){B.isSome(this.object)&&this.updateVertices(this.object.geometries[0])};C.updateVertices=function(t){const A=3===this._extensionType?this.updateLineSegmentFinite(g):this.updateLineSegmentInfinite(this._extensionType,g);this.updateVertexAttributes(t,A);B.isSome(this._externalResources)&&(this._externalResources.laserline.intersectsLine=A)};C.updateLineSegmentFinite=function(t){return r.lineSegment.fromPoints(this._start,this._end,t)};C.updateLineSegmentInfinite=function(t,A){var z=this.view.state.camera;
q.fromRay(this._ray,c);switch(t){case 0:c.c0=-Number.MAX_VALUE;break;case 1:case 2:var w=this._ray.origin;t=B.unwrapOr(this.view.elevationProvider.getElevation(w[0],w[1],w[2],this.view.renderCoordsHelper.spatialReference,"ground"),0);w=this.view.renderCoordsHelper.getAltitude(w);this._isWorldDown&&w<t&&f.negate(c.ray.direction,c.ray.direction);2===this._extensionType&&null!=t&&(c.c1=Math.abs(w-t))}if(!r.frustum.intersectClipRay(z.frustum,c))return r.lineSegment.fromPoints(this._start,this._end,A);
z=q.getStart(c,m);t=q.getEnd(c,h);return r.lineSegment.fromPoints(z,t,A)};C.updateVertexAttributes=function(t,A){t=t.getMutableAttribute("position").data;if(3===this.extensionType){var z=r.lineSegment.pointAt(A,-this.fadedExtensions.start,m);t[0]=z[0];t[1]=z[1];t[2]=z[2];z=r.lineSegment.pointAt(A,0,m);t[3]=z[0];t[4]=z[1];t[5]=z[2];z=r.lineSegment.pointAt(A,1,m);t[6]=z[0];t[7]=z[1];t[8]=z[2];A=r.lineSegment.pointAt(A,1+this.fadedExtensions.end,m);t[9]=A[0];t[10]=A[1];t[11]=A[2]}else z=r.lineSegment.pointAt(A,
0,m),t[0]=z[0],t[1]=z[1],t[2]=z[2],A=r.lineSegment.pointAt(A,1,m),t[3]=A[0],t[4]=A[1],t[5]=A[2];B.isSome(this.object)&&this.object.geometryVertexAttrsUpdated(0)};e._createClass(G,[{key:"start",get:function(){return this._start},set:function(t){this._isWorldDown=!1;f.exactEquals(this._start,t)||(f.copy(this._start,t),r.ray.fromPoints(this._start,this._end,this._ray),this.updateGeometry())}},{key:"end",get:function(){return this._end},set:function(t){this._isWorldDown=!1;f.exactEquals(this._end,t)||
(f.copy(this._end,t),r.ray.fromPoints(this._start,this._end,this._ray),this.updateGeometry())}},{key:"width",get:function(){return this._width},set:function(t){t!==this._width&&(this._width=t,this.updateMaterial())}},{key:"color",get:function(){return this._color},set:function(t){b.exactEquals(t,this._color)||(b.copy(this._color,t),this.updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(t){t!==this._polygonOffset&&(this._polygonOffset=t,this.updateMaterial())}},
{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(t){this._writeDepthEnabled!==t&&(this._writeDepthEnabled=t,this.updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(t){t!==this._innerWidth&&(this._innerWidth=t,this.updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(t){b.exactEquals(t,this._innerColor)||(b.copy(this._innerColor,t),this.updateMaterial())}},{key:"stippleIntegerRepeats",
get:function(){return this._stippleIntegerRepeats},set:function(t){t!==this._stippleIntegerRepeats&&(this._stippleIntegerRepeats=t,this.updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(t){const A=B.isSome(t)!==B.isSome(this._stipplePattern);this._stipplePattern=t;A?this.recreate():this.updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(t){if(B.isNone(t)||B.isNone(this._stippleOffColor)||!b.exactEquals(t,
this._stippleOffColor))this._stippleOffColor=B.isSome(t)?p.clone(t):null,this.updateMaterial()}},{key:"falloff",get:function(){return this._falloff},set:function(t){t!==this._falloff&&(this._falloff=t,this.updateMaterial())}},{key:"extensionType",get:function(){return this._extensionType},set:function(t){t!==this._extensionType&&(this._extensionType=t,this.updateGeometry())}},{key:"_laserlineAttached",get:function(){return this._laserlineEnabled&&B.isSome(this._laserlineStyle)}},{key:"laserlineStyle",
get:function(){return this._laserlineStyle},set:function(t){this._laserlineStyle=t;B.isSome(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached,B.isSome(t)&&(this._externalResources.laserline.style=t))}},{key:"laserlineEnabled",get:function(){return this._laserlineEnabled},set:function(t){this._laserlineEnabled!==t&&(this._laserlineEnabled=t,B.isSome(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached))}},{key:"renderOccluded",
get:function(){return this._renderOccluded},set:function(t){t!==this._renderOccluded&&(this._renderOccluded=t,this.updateMaterial())}},{key:"fadedExtensions",get:function(){return this._fadedExtensions},set:function(t){this._fadedExtensions=B.unwrapOr(t,k);this.recreateGeometry()}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stippleIntegerRepeats:this._stippleIntegerRepeats,innerWidth:this._innerWidth,
innerColor:this._innerColor,falloff:this._falloff,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}}]);return G}(x.Object3DVisualElement);const c=q.create(),m=d.create(),h=d.create(),g=r.lineSegment.create();x=1/3;const k={start:x,end:x};a.ExtendedLineVisualElement=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/vec4f32":function(){define(["exports"],function(a){function e(){return new Float32Array(4)}function l(g){const k=
new Float32Array(4);k[0]=g[0];k[1]=g[1];k[2]=g[2];k[3]=g[3];return k}function B(g,k,n,G){const C=new Float32Array(4);C[0]=g;C[1]=k;C[2]=n;C[3]=G;return C}function d(g,k){return new Float32Array(g,k,4)}function f(){return e()}function u(){return B(1,1,1,1)}function b(){return B(1,0,0,0)}function p(){return B(0,1,0,0)}function q(){return B(0,0,1,0)}function r(){return B(0,0,0,1)}const v=e(),D=u(),y=b(),x=p(),c=q(),m=r();var h=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d,
zeros:f,ones:u,unitX:b,unitY:p,unitZ:q,unitW:r,ZEROS:v,ONES:D,UNIT_X:y,UNIT_Y:x,UNIT_Z:c,UNIT_W:m});a.ONES=D;a.UNIT_W=m;a.UNIT_X=y;a.UNIT_Y=x;a.UNIT_Z=c;a.ZEROS=v;a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.ones=u;a.unitW=r;a.unitX=b;a.unitY=p;a.unitZ=q;a.vec4f32=h;a.zeros=f})},"esri/chunks/clipRay":function(){define(["exports","./vec3","../core/ObjectStack","../views/3d/support/stack","./ray"],function(a,e,l,B,d){function f(m){return m?{ray:d.create(m.ray),c0:m.c0,c1:m.c1}:{ray:d.create(),
c0:0,c1:Number.MAX_VALUE}}function u(m,h,g){const k=c.get();k.ray=m;k.c0=h;k.c1=g;return k}function b(m,h=f()){return p(m.ray,m.c0,m.c1,h)}function p(m,h,g,k=f()){d.copy(m,k.ray);k.c0=h;k.c1=g;return k}function q(m,h=f()){d.copy(m,h.ray);h.c0=0;h.c1=Number.MAX_VALUE;return h}function r(m,h=f()){const g=e.normalize(B.sv3d.get(),m.vector);return v(m,g,h)}function v(m,h,g=f()){const k=e.length(m.vector);d.fromValues(m.origin,h,g.ray);g.c0=0;g.c1=k;return g}function D(m,h){return x(m,m.c0,h)}function y(m,
h){return x(m,m.c1,h)}function x(m,h,g){return e.add(g,m.ray.origin,e.scale(g,m.ray.direction,h))}const c=new l.ObjectStack(()=>({c0:0,c1:0,ray:null}));l=Object.freeze({__proto__:null,create:f,wrap:u,copy:b,fromValues:p,fromRay:q,fromLineSegment:r,fromLineSegmentAndDirection:v,getStart:D,getEnd:y,getAt:x});a.clipRayModule=l;a.copy=b;a.create=f;a.fromLineSegment=r;a.fromLineSegmentAndDirection=v;a.fromRay=q;a.fromValues=p;a.getAt=x;a.getEnd=y;a.getStart=D;a.wrap=u})},"esri/core/ObjectStack":function(){define(["exports",
"./maybe","./nextTick"],function(a,e,l){let B=function(){function d(u){this.allocator=u;this.items=[];this.itemsPtr=0;this.tickHandle=l.before(()=>this.reset());this.grow()}var f=d.prototype;f.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=e.nullifyNonnullableForDispose(this.tickHandle));this.items=e.nullifyNonnullableForDispose(this.items)};f.get=function(){0===this.itemsPtr&&l(()=>{});this.itemsPtr===this.items.length&&this.grow();return this.items[this.itemsPtr++]};
f.reset=function(){this.items.length=Math.min(Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3072),this.items.length);this.itemsPtr=0};f.grow=function(){for(let u=0;u<Math.max(8,Math.min(this.items.length,1024));u++)this.items.push(this.allocator())};return d}();a.ObjectStack=B;a.default=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/ray":function(){define("exports ../core/maybe ../core/screenUtils ./vec3f64 ./vec3 ../core/ObjectStack ./vec2 ../views/3d/support/stack".split(" "),
function(a,e,l,B,d,f,u,b){function p(C){return C?{origin:B.clone(C.origin),direction:B.clone(C.direction)}:{origin:B.create(),direction:B.create()}}function q(C,t){const A=G.get();A.origin=C;A.direction=t;return A}function r(C,t=p()){return D(C.origin,C.direction,t)}function v(C,t,A=p()){d.copy(A.origin,C);d.subtract(A.direction,t,C);return A}function D(C,t,A=p()){d.copy(A.origin,C);d.copy(A.direction,t);return A}function y(C,t,A=p()){return x(C,C.screenToRender(t,l.castRenderScreenPointArray3(b.sv3d.get())),
A)}function x(C,t,A=p()){const z=l.castRenderScreenPointArray3(u.copy(b.sv3d.get(),t));z[2]=0;if(!C.unprojectFromRenderScreen(z,A.origin))return null;t=l.castRenderScreenPointArray3(u.copy(b.sv3d.get(),t));t[2]=1;C=C.unprojectFromRenderScreen(t,b.sv3d.get());if(e.isNone(C))return null;d.subtract(A.direction,C,A.origin);return A}function c(C,t,A=p()){return m(C,C.screenToRender(t,l.castRenderScreenPointArray3(b.sv3d.get())),A)}function m(C,t,A=p()){d.copy(A.origin,C.eye);t=d.set(b.sv3d.get(),t[0],
t[1],1);C=C.unprojectFromRenderScreen(t,b.sv3d.get());if(e.isNone(C))return null;d.subtract(A.direction,C,A.origin);return A}function h(C,t){C=d.cross(b.sv3d.get(),d.normalize(b.sv3d.get(),C.direction),d.subtract(b.sv3d.get(),t,C.origin));return d.dot(C,C)}function g(C,t){return Math.sqrt(h(C,t))}function k(C,t,A){t=d.dot(C.direction,d.subtract(A,t,C.origin));d.add(A,C.origin,d.scale(A,C.direction,t));return A}function n(){return{origin:null,direction:null}}const G=new f.ObjectStack(n);f=Object.freeze({__proto__:null,
create:p,wrap:q,copy:r,fromPoints:v,fromValues:D,fromScreen:y,fromRender:x,fromScreenAtEye:c,fromRenderAtEye:m,distance2:h,distance:g,closestPoint:k,createWrapper:n});a.closestPoint=k;a.copy=r;a.create=p;a.createWrapper=n;a.distance=g;a.distance2=h;a.fromPoints=v;a.fromRender=x;a.fromRenderAtEye=m;a.fromScreen=y;a.fromScreenAtEye=c;a.fromValues=D;a.rayModule=f;a.wrap=q})},"esri/views/3d/support/geometryUtils":function(){define("exports ../../../chunks/vector ../../../chunks/axisAngle ../../../chunks/lineSegment ../../../chunks/ray ../../../chunks/sphere ../../../chunks/plane ../../../chunks/boundedPlane ../../../chunks/clipRay ../../../chunks/frustum ../../../chunks/triangle".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r){u=u.planeModule;b=b.boundedPlaneModule;r=r.triangleModule;B=B.lineSegmentModule;d=d.rayModule;p=p.clipRayModule;f=f.sphereModule;q=q.frustumModule;e=e.vectorModule;a.axisAngle=l.axisAngleModule;a.boundedPlane=b;a.clipRay=p;a.frustum=q;a.lineSegment=B;a.plane=u;a.ray=d;a.sphere=f;a.triangle=r;a.vector=e;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/vector":function(){define(["exports","../core/mathUtils","./vec3f64","./vec3"],function(a,e,l,B){function d(r,
v,D){v=B.dot(r,v)/B.dot(r,r);return B.scale(D,r,v)}function f(r,v){return B.dot(r,v)/B.length(r)}function u(r,v){r=B.dot(r,v)/(B.length(r)*B.length(v));return-e.acosClamped(r)}function b(r,v,D){B.normalize(p,r);B.normalize(q,v);r=B.dot(p,q);r=e.acosClamped(r);v=B.cross(p,p,q);return 0>B.dot(v,D)?2*Math.PI-r:r}const p=l.create(),q=l.create();l=Object.freeze({__proto__:null,projectPoint:d,projectPointSignedLength:f,angle:u,angleAroundAxis:b});a.angle=u;a.angleAroundAxis=b;a.projectPoint=d;a.projectPointSignedLength=
f;a.vectorModule=l})},"esri/chunks/axisAngle":function(){define(["exports","./vec3","../views/3d/support/stack","./vector"],function(a,e,l,B){function d(x=D){return[x[0],x[1],x[2],x[3]]}function f(x,c,m,h){return p(x,c,m,h,l.sv4d.get())}function u(x,c){return p(x[0],x[1],x[2],c,l.sv4d.get())}function b(x,c=d()){return p(x[0],x[1],x[2],x[3],c)}function p(x,c,m,h,g=d()){g[0]=x;g[1]=c;g[2]=m;g[3]=h;return g}function q(x,c,m=d()){e.copy(m,x);m[3]=c;return m}function r(x,c,m=d()){e.cross(m,x,c);e.normalize(m,
m);m[3]=B.angle(x,c);return m}function v(x){return x}const D=[0,0,1,0];var y=Object.freeze({__proto__:null,create:d,wrap:f,wrapAxisAngle:u,copy:b,fromValues:p,fromAxisAndAngle:q,fromPoints:r,axis:v,UP:D});a.UP=D;a.axis=v;a.axisAngleModule=y;a.copy=b;a.create=d;a.fromAxisAndAngle=q;a.fromPoints=r;a.fromValues=p;a.wrap=f;a.wrapAxisAngle=u})},"esri/chunks/lineSegment":function(){define("exports ../core/mathUtils ./vec3f64 ./vec3 ../core/ObjectStack ../views/3d/support/stack".split(" "),function(a,e,
l,B,d,f){function u(C){return C?{origin:l.clone(C.origin),vector:l.clone(C.vector)}:{origin:l.create(),vector:l.create()}}function b(C,t){const A=G.get();A.origin=C;A.vector=t;return A}function p(C,t=u()){return q(C.origin,C.vector,t)}function q(C,t,A=u()){B.copy(A.origin,C);B.copy(A.vector,t);return A}function r(C,t,A=u()){B.copy(A.origin,C);B.subtract(A.vector,t,C);return A}function v(C,t){t=B.subtract(f.sv3d.get(),t,C.origin);var A=B.dot(C.vector,t);const z=B.dot(C.vector,C.vector);A=e.clamp(A/
z,0,1);C=B.subtract(f.sv3d.get(),B.scale(f.sv3d.get(),C.vector,A),t);return B.dot(C,C)}function D(C,t){return Math.sqrt(v(C,t))}function y(C,t,A){return c(C,t,0,1,A)}function x(C,t,A){return B.add(A,C.origin,B.scale(A,C.vector,t))}function c(C,t,A,z,w){const {vector:F,origin:E}=C;t=B.subtract(f.sv3d.get(),t,E);t=B.dot(F,t)/B.squaredLength(F);B.scale(w,F,e.clamp(t,A,z));return B.add(w,w,C.origin)}function m(C,t){if(k(C,b(t.origin,t.direction),!1,n)){const {tA:A,pB:z,distance2:w}=n;if(0<=A&&1>=A)return w;
if(0>A)return B.squaredDistance(C.origin,z);if(1<A)return B.squaredDistance(B.add(f.sv3d.get(),C.origin,C.vector),z)}return null}function h(C,t,A){return k(C,t,!0,n)?(B.copy(A,n.pA),!0):!1}function g(C,t){return k(C,t,!0,n)?n.distance2:null}function k(C,t,A,z){const w=C.origin;var F=B.add(f.sv3d.get(),w,C.vector);C=t.origin;var E=B.add(f.sv3d.get(),C,t.vector),N=f.sv3d.get();t=f.sv3d.get();N[0]=w[0]-C[0];N[1]=w[1]-C[1];N[2]=w[2]-C[2];t[0]=E[0]-C[0];t[1]=E[1]-C[1];t[2]=E[2]-C[2];if(1E-6>Math.abs(t[0])&&
1E-6>Math.abs(t[1])&&1E-6>Math.abs(t[2]))return!1;E=f.sv3d.get();E[0]=F[0]-w[0];E[1]=F[1]-w[1];E[2]=F[2]-w[2];if(1E-6>Math.abs(E[0])&&1E-6>Math.abs(E[1])&&1E-6>Math.abs(E[2]))return!1;F=N[0]*t[0]+N[1]*t[1]+N[2]*t[2];var U=t[0]*E[0]+t[1]*E[1]+t[2]*E[2];const S=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],I=(E[0]*E[0]+E[1]*E[1]+E[2]*E[2])*S-U*U;if(1E-6>Math.abs(I))return!1;N=(F*U-(N[0]*E[0]+N[1]*E[1]+N[2]*E[2])*S)/I;F=(F+U*N)/S;A&&(N=e.clamp(N,0,1),F=e.clamp(F,0,1));A=f.sv3d.get();U=f.sv3d.get();A[0]=w[0]+N*E[0];
A[1]=w[1]+N*E[1];A[2]=w[2]+N*E[2];U[0]=C[0]+F*t[0];U[1]=C[1]+F*t[1];U[2]=C[2]+F*t[2];z.tA=N;z.tB=F;z.pA=A;z.pB=U;z.distance2=B.squaredDistance(A,U);return!0}const n={tA:0,tB:0,pA:l.create(),pB:l.create(),distance2:0},G=new d.ObjectStack(()=>({origin:null,vector:null}));d=Object.freeze({__proto__:null,create:u,wrap:b,copy:p,fromValues:q,fromPoints:r,distance2:v,distance:D,projectPoint:y,pointAt:x,projectPointClamp:c,closestRayDistance2:m,closestLineSegmentPoint:h,closestLineSegmentDistance2:g});a.closestLineSegmentDistance2=
g;a.closestLineSegmentPoint=h;a.closestRayDistance2=m;a.copy=p;a.create=u;a.distance=D;a.distance2=v;a.fromPoints=r;a.fromValues=q;a.lineSegmentModule=d;a.pointAt=x;a.projectPoint=y;a.projectPointClamp=c;a.wrap=b})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/maybe ../core/Logger ../core/mathUtils ./vec3f64 ./vec3 ../views/3d/support/mathUtils ./mat4 ./vec4f64 ./vec4 ../views/3d/support/stack ./vector ./ray".split(" "),function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){function x(){return q.create()}
function c(W,X=x()){return r.copy(X,W)}function m(W,X){return q.fromValues(W[0],W[1],W[2],X)}function h(W){return W}function g(W){W[0]=W[1]=W[2]=W[3]=0}function k(W){return W}function n(W){return Array.isArray(W)?W[3]:W}function G(W){return Array.isArray(W)?W:T}function C(W,X,oa,ua){return q.fromValues(W,X,oa,ua)}function t(W,X,oa){W!==oa&&u.copy(oa,W);oa[3]=W[3]+X;return oa}function A(W,X,oa){Q.error("sphere.setExtent is not yet supported");return W===oa?oa:c(W,oa)}function z(W,X,oa){if(l.isNone(X))return!1;
var ua=u.subtract(v.sv3d.get(),X.origin,G(W)),H=u.dot(X.direction,X.direction);const J=2*u.dot(X.direction,ua);W=u.dot(ua,ua)-W[3]*W[3];W=J*J-4*H*W;if(0>W)return!1;ua=Math.sqrt(W);W=(-J-ua)/(2*H);H=(-J+ua)/(2*H);if(0>W||H<W&&0<H)W=H;if(0>W)return!1;oa&&u.add(oa,X.origin,u.scale(v.sv3d.get(),X.direction,W));return!0}function w(W,X,oa,ua){X=y.fromScreenAtEye(X,oa,Y);return z(W,X,ua)}function F(W,X){return z(W,X,null)}function E(W,X,oa){if(z(W,X,oa))return oa;W=N(W,X,v.sv3d.get());u.add(oa,X.origin,
u.scale(v.sv3d.get(),X.direction,u.distance(X.origin,W)/u.length(X.direction)));return oa}function N(W,X,oa){const ua=v.sv3d.get(),H=v.sm4d.get();u.cross(ua,X.origin,X.direction);const J=n(W);u.cross(oa,ua,X.origin);u.scale(oa,oa,1/u.length(oa)*J);W=L(W,X.origin);X=D.angle(X.origin,oa);p.identity(H);p.rotate(H,H,X+W,ua);u.transformMat4(oa,oa,H);return oa}function U(W,X,oa){if(z(W,X,oa))return oa;y.closestPoint(X,G(W),oa);return S(W,oa,oa)}function S(W,X,oa){X=u.subtract(v.sv3d.get(),X,G(W));X=u.scale(v.sv3d.get(),
X,W[3]/u.length(X));return u.add(oa,X,G(W))}function I(W,X){X=u.subtract(v.sv3d.get(),X,G(W));X=u.squaredLength(X);return Math.sqrt(Math.abs(X-W[3]*W[3]))}function L(W,X){X=u.subtract(v.sv3d.get(),X,G(W));X=u.length(X);W=n(W);return d.acosClamped(W/(W+Math.abs(W-X)))}function M(W,X,oa,ua){W=u.subtract(R,X,G(W));switch(oa){case 0:return oa=b.cartesianToSpherical(W,R)[2],u.set(ua,-Math.sin(oa),Math.cos(oa),0);case 1:return W=b.cartesianToSpherical(W,R),oa=W[1],W=W[2],X=Math.sin(oa),u.set(ua,-X*Math.cos(W),
-X*Math.sin(W),Math.cos(oa));case 2:return u.normalize(ua,W)}}function K(W,X){X=u.subtract(V,X,G(W));return u.length(X)-W[3]}function P(W,X,oa,ua){const H=K(W,X);W=M(W,X,2,V);oa=u.scale(V,W,oa-H);u.add(ua,X,oa);return ua}const Q=B.getLogger("esri.views.3d.support.geometryUtils.sphere"),R=f.create(),Y=y.create(),T=f.create(),V=f.create();Object.freeze(T);e=Object.freeze({__proto__:null,create:x,copy:c,fromCenterAndRadius:m,wrap:h,clear:g,fromRadius:k,getRadius:n,getCenter:G,fromValues:C,elevate:t,
setExtent:A,intersectRay:z,intersectScreen:w,intersectsRay:F,intersectRayClosestSilhouette:E,closestPointOnSilhouette:N,closestPoint:U,projectPoint:S,distanceToSilhouette:I,angleToSilhouette:L,axisAt:M,altitudeAt:K,setAltitudeAt:P});a.altitudeAt=K;a.angleToSilhouette=L;a.axisAt=M;a.clear=g;a.closestPoint=U;a.closestPointOnSilhouette=N;a.copy=c;a.create=x;a.distanceToSilhouette=I;a.elevate=t;a.fromCenterAndRadius=m;a.fromRadius=k;a.fromValues=C;a.getCenter=G;a.getRadius=n;a.intersectRay=z;a.intersectRayClosestSilhouette=
E;a.intersectScreen=w;a.intersectsRay=F;a.projectPoint=S;a.setAltitudeAt=P;a.setExtent=A;a.sphereModule=e;a.wrap=h})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(a,e,l){function B(H,J){H[0]=J[0];H[1]=J[1];H[2]=J[2];H[3]=J[3];H[4]=J[4];H[5]=J[5];H[6]=J[6];H[7]=J[7];H[8]=J[8];H[9]=J[9];H[10]=J[10];H[11]=J[11];H[12]=J[12];H[13]=J[13];H[14]=J[14];H[15]=J[15];return H}function d(H,J,aa,fa,ja,la,da,ka,Z,ia,ha,O,ca,ea,ba,qa,na){H[0]=J;H[1]=aa;H[2]=fa;H[3]=ja;H[4]=la;
H[5]=da;H[6]=ka;H[7]=Z;H[8]=ia;H[9]=ha;H[10]=O;H[11]=ca;H[12]=ea;H[13]=ba;H[14]=qa;H[15]=na;return H}function f(H){H[0]=1;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=1;H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[10]=1;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function u(H,J){if(H===J){const aa=J[1],fa=J[2],ja=J[3],la=J[6],da=J[7],ka=J[11];H[1]=J[4];H[2]=J[8];H[3]=J[12];H[4]=aa;H[6]=J[9];H[7]=J[13];H[8]=fa;H[9]=la;H[11]=J[14];H[12]=ja;H[13]=da;H[14]=ka}else H[0]=J[0],H[1]=J[4],H[2]=J[8],H[3]=J[12],H[4]=J[1],H[5]=J[5],
H[6]=J[9],H[7]=J[13],H[8]=J[2],H[9]=J[6],H[10]=J[10],H[11]=J[14],H[12]=J[3],H[13]=J[7],H[14]=J[11],H[15]=J[15];return H}function b(H,J){const aa=J[0],fa=J[1],ja=J[2],la=J[3],da=J[4],ka=J[5],Z=J[6],ia=J[7],ha=J[8],O=J[9],ca=J[10],ea=J[11],ba=J[12],qa=J[13],na=J[14];J=J[15];const sa=aa*ka-fa*da,wa=aa*Z-ja*da,ra=aa*ia-la*da,xa=fa*Z-ja*ka,va=fa*ia-la*ka,za=ja*ia-la*Z,Ba=ha*qa-O*ba,Ea=ha*na-ca*ba,Ha=ha*J-ea*ba,Oa=O*na-ca*qa,Pa=O*J-ea*qa,Ja=ca*J-ea*na;let Ka=sa*Ja-wa*Pa+ra*Oa+xa*Ha-va*Ea+za*Ba;if(!Ka)return null;
Ka=1/Ka;H[0]=(ka*Ja-Z*Pa+ia*Oa)*Ka;H[1]=(ja*Pa-fa*Ja-la*Oa)*Ka;H[2]=(qa*za-na*va+J*xa)*Ka;H[3]=(ca*va-O*za-ea*xa)*Ka;H[4]=(Z*Ha-da*Ja-ia*Ea)*Ka;H[5]=(aa*Ja-ja*Ha+la*Ea)*Ka;H[6]=(na*ra-ba*za-J*wa)*Ka;H[7]=(ha*za-ca*ra+ea*wa)*Ka;H[8]=(da*Pa-ka*Ha+ia*Ba)*Ka;H[9]=(fa*Ha-aa*Pa-la*Ba)*Ka;H[10]=(ba*va-qa*ra+J*sa)*Ka;H[11]=(O*ra-ha*va-ea*sa)*Ka;H[12]=(ka*Ea-da*Oa-Z*Ba)*Ka;H[13]=(aa*Oa-fa*Ea+ja*Ba)*Ka;H[14]=(qa*wa-ba*xa-na*sa)*Ka;H[15]=(ha*xa-O*wa+ca*sa)*Ka;return H}function p(H,J){const aa=J[0],fa=J[1],ja=
J[2],la=J[3],da=J[4],ka=J[5],Z=J[6],ia=J[7],ha=J[8],O=J[9],ca=J[10],ea=J[11],ba=J[12],qa=J[13],na=J[14];J=J[15];H[0]=ka*(ca*J-ea*na)-O*(Z*J-ia*na)+qa*(Z*ea-ia*ca);H[1]=-(fa*(ca*J-ea*na)-O*(ja*J-la*na)+qa*(ja*ea-la*ca));H[2]=fa*(Z*J-ia*na)-ka*(ja*J-la*na)+qa*(ja*ia-la*Z);H[3]=-(fa*(Z*ea-ia*ca)-ka*(ja*ea-la*ca)+O*(ja*ia-la*Z));H[4]=-(da*(ca*J-ea*na)-ha*(Z*J-ia*na)+ba*(Z*ea-ia*ca));H[5]=aa*(ca*J-ea*na)-ha*(ja*J-la*na)+ba*(ja*ea-la*ca);H[6]=-(aa*(Z*J-ia*na)-da*(ja*J-la*na)+ba*(ja*ia-la*Z));H[7]=aa*(Z*
ea-ia*ca)-da*(ja*ea-la*ca)+ha*(ja*ia-la*Z);H[8]=da*(O*J-ea*qa)-ha*(ka*J-ia*qa)+ba*(ka*ea-ia*O);H[9]=-(aa*(O*J-ea*qa)-ha*(fa*J-la*qa)+ba*(fa*ea-la*O));H[10]=aa*(ka*J-ia*qa)-da*(fa*J-la*qa)+ba*(fa*ia-la*ka);H[11]=-(aa*(ka*ea-ia*O)-da*(fa*ea-la*O)+ha*(fa*ia-la*ka));H[12]=-(da*(O*na-ca*qa)-ha*(ka*na-Z*qa)+ba*(ka*ca-Z*O));H[13]=aa*(O*na-ca*qa)-ha*(fa*na-ja*qa)+ba*(fa*ca-ja*O);H[14]=-(aa*(ka*na-Z*qa)-da*(fa*na-ja*qa)+ba*(fa*Z-ja*ka));H[15]=aa*(ka*ca-Z*O)-da*(fa*ca-ja*O)+ha*(fa*Z-ja*ka);return H}function q(H){const J=
H[0],aa=H[1],fa=H[2],ja=H[3],la=H[4],da=H[5],ka=H[6],Z=H[7],ia=H[8],ha=H[9],O=H[10],ca=H[11],ea=H[12],ba=H[13],qa=H[14];H=H[15];return(J*da-aa*la)*(O*H-ca*qa)-(J*ka-fa*la)*(ha*H-ca*ba)+(J*Z-ja*la)*(ha*qa-O*ba)+(aa*ka-fa*da)*(ia*H-ca*ea)-(aa*Z-ja*da)*(ia*qa-O*ea)+(fa*Z-ja*ka)*(ia*ba-ha*ea)}function r(H,J,aa){const fa=J[0],ja=J[1],la=J[2],da=J[3],ka=J[4],Z=J[5],ia=J[6],ha=J[7],O=J[8],ca=J[9],ea=J[10],ba=J[11],qa=J[12],na=J[13],sa=J[14];J=J[15];let wa=aa[0],ra=aa[1],xa=aa[2],va=aa[3];H[0]=wa*fa+ra*ka+
xa*O+va*qa;H[1]=wa*ja+ra*Z+xa*ca+va*na;H[2]=wa*la+ra*ia+xa*ea+va*sa;H[3]=wa*da+ra*ha+xa*ba+va*J;wa=aa[4];ra=aa[5];xa=aa[6];va=aa[7];H[4]=wa*fa+ra*ka+xa*O+va*qa;H[5]=wa*ja+ra*Z+xa*ca+va*na;H[6]=wa*la+ra*ia+xa*ea+va*sa;H[7]=wa*da+ra*ha+xa*ba+va*J;wa=aa[8];ra=aa[9];xa=aa[10];va=aa[11];H[8]=wa*fa+ra*ka+xa*O+va*qa;H[9]=wa*ja+ra*Z+xa*ca+va*na;H[10]=wa*la+ra*ia+xa*ea+va*sa;H[11]=wa*da+ra*ha+xa*ba+va*J;wa=aa[12];ra=aa[13];xa=aa[14];va=aa[15];H[12]=wa*fa+ra*ka+xa*O+va*qa;H[13]=wa*ja+ra*Z+xa*ca+va*na;H[14]=
wa*la+ra*ia+xa*ea+va*sa;H[15]=wa*da+ra*ha+xa*ba+va*J;return H}function v(H,J,aa){const fa=aa[0],ja=aa[1];aa=aa[2];let la=void 0,da=void 0,ka=void 0,Z=void 0,ia=void 0,ha=void 0,O=void 0,ca=void 0,ea=void 0,ba=void 0,qa=void 0,na=void 0;J===H?(H[12]=J[0]*fa+J[4]*ja+J[8]*aa+J[12],H[13]=J[1]*fa+J[5]*ja+J[9]*aa+J[13],H[14]=J[2]*fa+J[6]*ja+J[10]*aa+J[14],H[15]=J[3]*fa+J[7]*ja+J[11]*aa+J[15]):(la=J[0],da=J[1],ka=J[2],Z=J[3],ia=J[4],ha=J[5],O=J[6],ca=J[7],ea=J[8],ba=J[9],qa=J[10],na=J[11],H[0]=la,H[1]=da,
H[2]=ka,H[3]=Z,H[4]=ia,H[5]=ha,H[6]=O,H[7]=ca,H[8]=ea,H[9]=ba,H[10]=qa,H[11]=na,H[12]=la*fa+ia*ja+ea*aa+J[12],H[13]=da*fa+ha*ja+ba*aa+J[13],H[14]=ka*fa+O*ja+qa*aa+J[14],H[15]=Z*fa+ca*ja+na*aa+J[15]);return H}function D(H,J,aa){const fa=aa[0],ja=aa[1];aa=aa[2];H[0]=J[0]*fa;H[1]=J[1]*fa;H[2]=J[2]*fa;H[3]=J[3]*fa;H[4]=J[4]*ja;H[5]=J[5]*ja;H[6]=J[6]*ja;H[7]=J[7]*ja;H[8]=J[8]*aa;H[9]=J[9]*aa;H[10]=J[10]*aa;H[11]=J[11]*aa;H[12]=J[12];H[13]=J[13];H[14]=J[14];H[15]=J[15];return H}function y(H,J,aa,fa){let ja=
fa[0],la=fa[1];fa=fa[2];let da=Math.sqrt(ja*ja+la*la+fa*fa);var ka=void 0,Z=void 0;let ia=void 0,ha=void 0,O=void 0,ca=void 0,ea=void 0,ba=void 0,qa=void 0,na=void 0,sa=void 0,wa=void 0,ra=void 0,xa=void 0,va=void 0,za=void 0,Ba=void 0,Ea=void 0,Ha=void 0,Oa=void 0,Pa=void 0,Ja=void 0;Z=ka=void 0;if(da<l.EPSILON)return null;da=1/da;ja*=da;la*=da;fa*=da;ka=Math.sin(aa);Z=Math.cos(aa);ia=1-Z;ha=J[0];O=J[1];ca=J[2];ea=J[3];ba=J[4];qa=J[5];na=J[6];sa=J[7];wa=J[8];ra=J[9];xa=J[10];va=J[11];za=ja*ja*ia+
Z;Ba=la*ja*ia+fa*ka;Ea=fa*ja*ia-la*ka;Ha=ja*la*ia-fa*ka;Oa=la*la*ia+Z;Pa=fa*la*ia+ja*ka;Ja=ja*fa*ia+la*ka;ka=la*fa*ia-ja*ka;Z=fa*fa*ia+Z;H[0]=ha*za+ba*Ba+wa*Ea;H[1]=O*za+qa*Ba+ra*Ea;H[2]=ca*za+na*Ba+xa*Ea;H[3]=ea*za+sa*Ba+va*Ea;H[4]=ha*Ha+ba*Oa+wa*Pa;H[5]=O*Ha+qa*Oa+ra*Pa;H[6]=ca*Ha+na*Oa+xa*Pa;H[7]=ea*Ha+sa*Oa+va*Pa;H[8]=ha*Ja+ba*ka+wa*Z;H[9]=O*Ja+qa*ka+ra*Z;H[10]=ca*Ja+na*ka+xa*Z;H[11]=ea*Ja+sa*ka+va*Z;J!==H&&(H[12]=J[12],H[13]=J[13],H[14]=J[14],H[15]=J[15]);return H}function x(H,J,aa){const fa=
Math.sin(aa);aa=Math.cos(aa);const ja=J[4],la=J[5],da=J[6],ka=J[7],Z=J[8],ia=J[9],ha=J[10],O=J[11];J!==H&&(H[0]=J[0],H[1]=J[1],H[2]=J[2],H[3]=J[3],H[12]=J[12],H[13]=J[13],H[14]=J[14],H[15]=J[15]);H[4]=ja*aa+Z*fa;H[5]=la*aa+ia*fa;H[6]=da*aa+ha*fa;H[7]=ka*aa+O*fa;H[8]=Z*aa-ja*fa;H[9]=ia*aa-la*fa;H[10]=ha*aa-da*fa;H[11]=O*aa-ka*fa;return H}function c(H,J,aa){const fa=Math.sin(aa);aa=Math.cos(aa);const ja=J[0],la=J[1],da=J[2],ka=J[3],Z=J[8],ia=J[9],ha=J[10],O=J[11];J!==H&&(H[4]=J[4],H[5]=J[5],H[6]=J[6],
H[7]=J[7],H[12]=J[12],H[13]=J[13],H[14]=J[14],H[15]=J[15]);H[0]=ja*aa-Z*fa;H[1]=la*aa-ia*fa;H[2]=da*aa-ha*fa;H[3]=ka*aa-O*fa;H[8]=ja*fa+Z*aa;H[9]=la*fa+ia*aa;H[10]=da*fa+ha*aa;H[11]=ka*fa+O*aa;return H}function m(H,J,aa){const fa=Math.sin(aa);aa=Math.cos(aa);const ja=J[0],la=J[1],da=J[2],ka=J[3],Z=J[4],ia=J[5],ha=J[6],O=J[7];J!==H&&(H[8]=J[8],H[9]=J[9],H[10]=J[10],H[11]=J[11],H[12]=J[12],H[13]=J[13],H[14]=J[14],H[15]=J[15]);H[0]=ja*aa+Z*fa;H[1]=la*aa+ia*fa;H[2]=da*aa+ha*fa;H[3]=ka*aa+O*fa;H[4]=Z*
aa-ja*fa;H[5]=ia*aa-la*fa;H[6]=ha*aa-da*fa;H[7]=O*aa-ka*fa;return H}function h(H,J){H[0]=1;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=1;H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[10]=1;H[11]=0;H[12]=J[0];H[13]=J[1];H[14]=J[2];H[15]=1;return H}function g(H,J){H[0]=J[0];H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=J[1];H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[10]=J[2];H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function k(H,J,aa){let fa=aa[0],ja=aa[1];aa=aa[2];let la=Math.sqrt(fa*fa+ja*ja+aa*aa),da=void 0,ka=void 0,Z=void 0;if(la<l.EPSILON)return null;
la=1/la;fa*=la;ja*=la;aa*=la;da=Math.sin(J);ka=Math.cos(J);Z=1-ka;H[0]=fa*fa*Z+ka;H[1]=ja*fa*Z+aa*da;H[2]=aa*fa*Z-ja*da;H[3]=0;H[4]=fa*ja*Z-aa*da;H[5]=ja*ja*Z+ka;H[6]=aa*ja*Z+fa*da;H[7]=0;H[8]=fa*aa*Z+ja*da;H[9]=ja*aa*Z-fa*da;H[10]=aa*aa*Z+ka;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function n(H,J){const aa=Math.sin(J);J=Math.cos(J);H[0]=1;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=J;H[6]=aa;H[7]=0;H[8]=0;H[9]=-aa;H[10]=J;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function G(H,J){const aa=Math.sin(J);
J=Math.cos(J);H[0]=J;H[1]=0;H[2]=-aa;H[3]=0;H[4]=0;H[5]=1;H[6]=0;H[7]=0;H[8]=aa;H[9]=0;H[10]=J;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function C(H,J){const aa=Math.sin(J);J=Math.cos(J);H[0]=J;H[1]=aa;H[2]=0;H[3]=0;H[4]=-aa;H[5]=J;H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[10]=1;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function t(H,J,aa){var fa=J[0],ja=J[1],la=J[2],da=J[3],ka=fa+fa,Z=ja+ja;const ia=la+la;J=fa*ka;const ha=fa*Z;fa*=ia;const O=ja*Z;ja*=ia;la*=ia;ka*=da;Z*=da;da*=ia;H[0]=1-(O+la);
H[1]=ha+da;H[2]=fa-Z;H[3]=0;H[4]=ha-da;H[5]=1-(J+la);H[6]=ja+ka;H[7]=0;H[8]=fa+Z;H[9]=ja-ka;H[10]=1-(J+O);H[11]=0;H[12]=aa[0];H[13]=aa[1];H[14]=aa[2];H[15]=1;return H}function A(H,J){const aa=ua,fa=-J[0],ja=-J[1],la=-J[2],da=J[3],ka=J[4],Z=J[5],ia=J[6],ha=J[7],O=fa*fa+ja*ja+la*la+da*da;0<O?(aa[0]=2*(ka*da+ha*fa+Z*la-ia*ja)/O,aa[1]=2*(Z*da+ha*ja+ia*fa-ka*la)/O,aa[2]=2*(ia*da+ha*la+ka*ja-Z*fa)/O):(aa[0]=2*(ka*da+ha*fa+Z*la-ia*ja),aa[1]=2*(Z*da+ha*ja+ia*fa-ka*la),aa[2]=2*(ia*da+ha*la+ka*ja-Z*fa));t(H,
J,aa);return H}function z(H,J){H[0]=J[12];H[1]=J[13];H[2]=J[14];return H}function w(H,J){const aa=J[0],fa=J[1],ja=J[2],la=J[4],da=J[5],ka=J[6],Z=J[8],ia=J[9];J=J[10];H[0]=Math.sqrt(aa*aa+fa*fa+ja*ja);H[1]=Math.sqrt(la*la+da*da+ka*ka);H[2]=Math.sqrt(Z*Z+ia*ia+J*J);return H}function F(H,J){const aa=J[0]+J[5]+J[10];let fa=0;0<aa?(fa=2*Math.sqrt(aa+1),H[3]=.25*fa,H[0]=(J[6]-J[9])/fa,H[1]=(J[8]-J[2])/fa,H[2]=(J[1]-J[4])/fa):J[0]>J[5]&&J[0]>J[10]?(fa=2*Math.sqrt(1+J[0]-J[5]-J[10]),H[3]=(J[6]-J[9])/fa,H[0]=
.25*fa,H[1]=(J[1]+J[4])/fa,H[2]=(J[8]+J[2])/fa):J[5]>J[10]?(fa=2*Math.sqrt(1+J[5]-J[0]-J[10]),H[3]=(J[8]-J[2])/fa,H[0]=(J[1]+J[4])/fa,H[1]=.25*fa,H[2]=(J[6]+J[9])/fa):(fa=2*Math.sqrt(1+J[10]-J[0]-J[5]),H[3]=(J[1]-J[4])/fa,H[0]=(J[8]+J[2])/fa,H[1]=(J[6]+J[9])/fa,H[2]=.25*fa);return H}function E(H,J,aa,fa){var ja=J[0],la=J[1],da=J[2],ka=J[3],Z=ja+ja,ia=la+la,ha=da+da;J=ja*Z;const O=ja*ia;ja*=ha;const ca=la*ia;la*=ha;da*=ha;Z*=ka;ia*=ka;ka*=ha;ha=fa[0];const ea=fa[1];fa=fa[2];H[0]=(1-(ca+da))*ha;H[1]=
(O+ka)*ha;H[2]=(ja-ia)*ha;H[3]=0;H[4]=(O-ka)*ea;H[5]=(1-(J+da))*ea;H[6]=(la+Z)*ea;H[7]=0;H[8]=(ja+ia)*fa;H[9]=(la-Z)*fa;H[10]=(1-(J+ca))*fa;H[11]=0;H[12]=aa[0];H[13]=aa[1];H[14]=aa[2];H[15]=1;return H}function N(H,J,aa,fa,ja){var la=J[0],da=J[1],ka=J[2],Z=J[3],ia=la+la,ha=da+da,O=ka+ka;J=la*ia;var ca=la*ha,ea=la*O;la=da*ha;da*=O;var ba=ka*O;ka=Z*ia;ha*=Z;const qa=Z*O;var na=fa[0],sa=fa[1];O=fa[2];fa=ja[0];Z=ja[1];ja=ja[2];ia=(1-(la+ba))*na;const wa=(ca+qa)*na;na*=ea-ha;ca=(ca-qa)*sa;ba=(1-(J+ba))*
sa;sa*=da+ka;ea=(ea+ha)*O;da=(da-ka)*O;J=(1-(J+la))*O;H[0]=ia;H[1]=wa;H[2]=na;H[3]=0;H[4]=ca;H[5]=ba;H[6]=sa;H[7]=0;H[8]=ea;H[9]=da;H[10]=J;H[11]=0;H[12]=aa[0]+fa-(ia*fa+ca*Z+ea*ja);H[13]=aa[1]+Z-(wa*fa+ba*Z+da*ja);H[14]=aa[2]+ja-(na*fa+sa*Z+J*ja);H[15]=1;return H}function U(H,J){var aa=J[0],fa=J[1],ja=J[2];J=J[3];var la=aa+aa,da=fa+fa;const ka=ja+ja;aa*=la;const Z=fa*la;fa*=da;const ia=ja*la,ha=ja*da;ja*=ka;la*=J;da*=J;J*=ka;H[0]=1-fa-ja;H[1]=Z+J;H[2]=ia-da;H[3]=0;H[4]=Z-J;H[5]=1-aa-ja;H[6]=ha+la;
H[7]=0;H[8]=ia+da;H[9]=ha-la;H[10]=1-aa-fa;H[11]=0;H[12]=0;H[13]=0;H[14]=0;H[15]=1;return H}function S(H,J,aa,fa,ja,la,da){const ka=1/(aa-J),Z=1/(ja-fa),ia=1/(la-da);H[0]=2*la*ka;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=2*la*Z;H[6]=0;H[7]=0;H[8]=(aa+J)*ka;H[9]=(ja+fa)*Z;H[10]=(da+la)*ia;H[11]=-1;H[12]=0;H[13]=0;H[14]=da*la*2*ia;H[15]=0;return H}function I(H,J,aa,fa,ja){J=1/Math.tan(J/2);let la=void 0;H[0]=J/aa;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=J;H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[11]=-1;H[12]=0;H[13]=0;H[15]=0;
null!=ja&&Infinity!==ja?(la=1/(fa-ja),H[10]=(ja+fa)*la,H[14]=2*ja*fa*la):(H[10]=-1,H[14]=-2*fa);return H}function L(H,J,aa,fa){const ja=Math.tan(J.upDegrees*Math.PI/180),la=Math.tan(J.downDegrees*Math.PI/180),da=Math.tan(J.leftDegrees*Math.PI/180);J=Math.tan(J.rightDegrees*Math.PI/180);const ka=2/(da+J),Z=2/(ja+la);H[0]=ka;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=Z;H[6]=0;H[7]=0;H[8]=-((da-J)*ka*.5);H[9]=(ja-la)*Z*.5;H[10]=fa/(aa-fa);H[11]=-1;H[12]=0;H[13]=0;H[14]=fa*aa/(aa-fa);H[15]=0;return H}function M(H,
J,aa,fa,ja,la,da){const ka=1/(J-aa),Z=1/(fa-ja),ia=1/(la-da);H[0]=-2*ka;H[1]=0;H[2]=0;H[3]=0;H[4]=0;H[5]=-2*Z;H[6]=0;H[7]=0;H[8]=0;H[9]=0;H[10]=2*ia;H[11]=0;H[12]=(J+aa)*ka;H[13]=(ja+fa)*Z;H[14]=(da+la)*ia;H[15]=1;return H}function K(H,J,aa,fa){let ja=void 0,la=void 0;var da=void 0,ka=void 0;let Z=void 0,ia=void 0;var ha=void 0,O=void 0;let ca=void 0,ea=void 0;const ba=J[0],qa=J[1];J=J[2];da=fa[0];ka=fa[1];fa=fa[2];ha=aa[0];O=aa[1];aa=aa[2];if(Math.abs(ba-ha)<l.EPSILON&&Math.abs(qa-O)<l.EPSILON&&
Math.abs(J-aa)<l.EPSILON)return f(H);ha=ba-ha;O=qa-O;ca=J-aa;ea=1/Math.sqrt(ha*ha+O*O+ca*ca);ha*=ea;O*=ea;ca*=ea;ja=ka*ca-fa*O;la=fa*ha-da*ca;da=da*O-ka*ha;(ea=Math.sqrt(ja*ja+la*la+da*da))?(ea=1/ea,ja*=ea,la*=ea,da*=ea):da=la=ja=0;ka=O*da-ca*la;Z=ca*ja-ha*da;ia=ha*la-O*ja;(ea=Math.sqrt(ka*ka+Z*Z+ia*ia))?(ea=1/ea,ka*=ea,Z*=ea,ia*=ea):ia=Z=ka=0;H[0]=ja;H[1]=ka;H[2]=ha;H[3]=0;H[4]=la;H[5]=Z;H[6]=O;H[7]=0;H[8]=da;H[9]=ia;H[10]=ca;H[11]=0;H[12]=-(ja*ba+la*qa+da*J);H[13]=-(ka*ba+Z*qa+ia*J);H[14]=-(ha*
ba+O*qa+ca*J);H[15]=1;return H}function P(H,J,aa,fa){const ja=J[0],la=J[1];J=J[2];var da=fa[0];const ka=fa[1];var Z=fa[2];fa=ja-aa[0];let ia=la-aa[1];aa=J-aa[2];let ha=fa*fa+ia*ia+aa*aa;0<ha&&(ha=1/Math.sqrt(ha),fa*=ha,ia*=ha,aa*=ha);let O=ka*aa-Z*ia;Z=Z*fa-da*aa;da=da*ia-ka*fa;ha=O*O+Z*Z+da*da;0<ha&&(ha=1/Math.sqrt(ha),O*=ha,Z*=ha,da*=ha);H[0]=O;H[1]=Z;H[2]=da;H[3]=0;H[4]=ia*da-aa*Z;H[5]=aa*O-fa*da;H[6]=fa*Z-ia*O;H[7]=0;H[8]=fa;H[9]=ia;H[10]=aa;H[11]=0;H[12]=ja;H[13]=la;H[14]=J;H[15]=1;return H}
function Q(H){return"mat4("+H[0]+", "+H[1]+", "+H[2]+", "+H[3]+", "+H[4]+", "+H[5]+", "+H[6]+", "+H[7]+", "+H[8]+", "+H[9]+", "+H[10]+", "+H[11]+", "+H[12]+", "+H[13]+", "+H[14]+", "+H[15]+")"}function R(H){return Math.sqrt(H[0]**2+H[1]**2+H[2]**2+H[3]**2+H[4]**2+H[5]**2+H[6]**2+H[7]**2+H[8]**2+H[9]**2+H[10]**2+H[11]**2+H[12]**2+H[13]**2+H[14]**2+H[15]**2)}function Y(H,J,aa){H[0]=J[0]+aa[0];H[1]=J[1]+aa[1];H[2]=J[2]+aa[2];H[3]=J[3]+aa[3];H[4]=J[4]+aa[4];H[5]=J[5]+aa[5];H[6]=J[6]+aa[6];H[7]=J[7]+aa[7];
H[8]=J[8]+aa[8];H[9]=J[9]+aa[9];H[10]=J[10]+aa[10];H[11]=J[11]+aa[11];H[12]=J[12]+aa[12];H[13]=J[13]+aa[13];H[14]=J[14]+aa[14];H[15]=J[15]+aa[15];return H}function T(H,J,aa){H[0]=J[0]-aa[0];H[1]=J[1]-aa[1];H[2]=J[2]-aa[2];H[3]=J[3]-aa[3];H[4]=J[4]-aa[4];H[5]=J[5]-aa[5];H[6]=J[6]-aa[6];H[7]=J[7]-aa[7];H[8]=J[8]-aa[8];H[9]=J[9]-aa[9];H[10]=J[10]-aa[10];H[11]=J[11]-aa[11];H[12]=J[12]-aa[12];H[13]=J[13]-aa[13];H[14]=J[14]-aa[14];H[15]=J[15]-aa[15];return H}function V(H,J,aa){H[0]=J[0]*aa;H[1]=J[1]*aa;
H[2]=J[2]*aa;H[3]=J[3]*aa;H[4]=J[4]*aa;H[5]=J[5]*aa;H[6]=J[6]*aa;H[7]=J[7]*aa;H[8]=J[8]*aa;H[9]=J[9]*aa;H[10]=J[10]*aa;H[11]=J[11]*aa;H[12]=J[12]*aa;H[13]=J[13]*aa;H[14]=J[14]*aa;H[15]=J[15]*aa;return H}function W(H,J,aa,fa){H[0]=J[0]+aa[0]*fa;H[1]=J[1]+aa[1]*fa;H[2]=J[2]+aa[2]*fa;H[3]=J[3]+aa[3]*fa;H[4]=J[4]+aa[4]*fa;H[5]=J[5]+aa[5]*fa;H[6]=J[6]+aa[6]*fa;H[7]=J[7]+aa[7]*fa;H[8]=J[8]+aa[8]*fa;H[9]=J[9]+aa[9]*fa;H[10]=J[10]+aa[10]*fa;H[11]=J[11]+aa[11]*fa;H[12]=J[12]+aa[12]*fa;H[13]=J[13]+aa[13]*fa;
H[14]=J[14]+aa[14]*fa;H[15]=J[15]+aa[15]*fa;return H}function X(H,J){return H[0]===J[0]&&H[1]===J[1]&&H[2]===J[2]&&H[3]===J[3]&&H[4]===J[4]&&H[5]===J[5]&&H[6]===J[6]&&H[7]===J[7]&&H[8]===J[8]&&H[9]===J[9]&&H[10]===J[10]&&H[11]===J[11]&&H[12]===J[12]&&H[13]===J[13]&&H[14]===J[14]&&H[15]===J[15]}function oa(H,J){const aa=H[0],fa=H[1],ja=H[2],la=H[3],da=H[4],ka=H[5],Z=H[6],ia=H[7],ha=H[8],O=H[9],ca=H[10],ea=H[11],ba=H[12],qa=H[13],na=H[14];H=H[15];const sa=J[0],wa=J[1],ra=J[2],xa=J[3],va=J[4],za=J[5],
Ba=J[6],Ea=J[7],Ha=J[8],Oa=J[9],Pa=J[10],Ja=J[11],Ka=J[12],Ia=J[13],Ra=J[14];J=J[15];return Math.abs(aa-sa)<=l.EPSILON*Math.max(1,Math.abs(aa),Math.abs(sa))&&Math.abs(fa-wa)<=l.EPSILON*Math.max(1,Math.abs(fa),Math.abs(wa))&&Math.abs(ja-ra)<=l.EPSILON*Math.max(1,Math.abs(ja),Math.abs(ra))&&Math.abs(la-xa)<=l.EPSILON*Math.max(1,Math.abs(la),Math.abs(xa))&&Math.abs(da-va)<=l.EPSILON*Math.max(1,Math.abs(da),Math.abs(va))&&Math.abs(ka-za)<=l.EPSILON*Math.max(1,Math.abs(ka),Math.abs(za))&&Math.abs(Z-Ba)<=
l.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Ba))&&Math.abs(ia-Ea)<=l.EPSILON*Math.max(1,Math.abs(ia),Math.abs(Ea))&&Math.abs(ha-Ha)<=l.EPSILON*Math.max(1,Math.abs(ha),Math.abs(Ha))&&Math.abs(O-Oa)<=l.EPSILON*Math.max(1,Math.abs(O),Math.abs(Oa))&&Math.abs(ca-Pa)<=l.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Pa))&&Math.abs(ea-Ja)<=l.EPSILON*Math.max(1,Math.abs(ea),Math.abs(Ja))&&Math.abs(ba-Ka)<=l.EPSILON*Math.max(1,Math.abs(ba),Math.abs(Ka))&&Math.abs(qa-Ia)<=l.EPSILON*Math.max(1,Math.abs(qa),Math.abs(Ia))&&
Math.abs(na-Ra)<=l.EPSILON*Math.max(1,Math.abs(na),Math.abs(Ra))&&Math.abs(H-J)<=l.EPSILON*Math.max(1,Math.abs(H),Math.abs(J))}const ua=e.create();e=Object.freeze({__proto__:null,copy:B,set:d,identity:f,transpose:u,invert:b,adjoint:p,determinant:q,multiply:r,translate:v,scale:D,rotate:y,rotateX:x,rotateY:c,rotateZ:m,fromTranslation:h,fromScaling:g,fromRotation:k,fromXRotation:n,fromYRotation:G,fromZRotation:C,fromRotationTranslation:t,fromQuat2:A,getTranslation:z,getScaling:w,getRotation:F,fromRotationTranslationScale:E,
fromRotationTranslationScaleOrigin:N,fromQuat:U,frustum:S,perspective:I,perspectiveFromFieldOfView:L,ortho:M,lookAt:K,targetTo:P,str:Q,frob:R,add:Y,subtract:T,multiplyScalar:V,multiplyScalarAndAdd:W,exactEquals:X,equals:oa,mul:r,sub:T});a.add=Y;a.adjoint=p;a.copy=B;a.determinant=q;a.equals=oa;a.exactEquals=X;a.frob=R;a.fromQuat=U;a.fromQuat2=A;a.fromRotation=k;a.fromRotationTranslation=t;a.fromRotationTranslationScale=E;a.fromRotationTranslationScaleOrigin=N;a.fromScaling=g;a.fromTranslation=h;a.fromXRotation=
n;a.fromYRotation=G;a.fromZRotation=C;a.frustum=S;a.getRotation=F;a.getScaling=w;a.getTranslation=z;a.identity=f;a.invert=b;a.lookAt=K;a.mat4=e;a.mul=r;a.multiply=r;a.multiplyScalar=V;a.multiplyScalarAndAdd=W;a.ortho=M;a.perspective=I;a.perspectiveFromFieldOfView=L;a.rotate=y;a.rotateX=x;a.rotateY=c;a.rotateZ=m;a.scale=D;a.set=d;a.str=Q;a.sub=T;a.subtract=T;a.targetTo=P;a.translate=v;a.transpose=u})},"esri/chunks/plane":function(){define("exports ../core/maybe ../core/mathUtils ./vec3f64 ./vec3 ../views/3d/support/stack ./sphere".split(" "),
function(a,e,l,B,d,f,u){function b(V=T){return[V[0],V[1],V[2],V[3]]}function p(V,W,X,oa){return r(V,W,X,oa,f.sv4d.get())}function q(V,W=b()){return r(V[0],V[1],V[2],V[3],W)}function r(V,W,X,oa,ua=b()){ua[0]=V;ua[1]=W;ua[2]=X;ua[3]=oa;return ua}function v(V,W,X=b()){d.copy(X,V);X[3]=W;return X}function D(V,W,X=b()){d.copy(X,W);W=d.dot(W,W);1E-5<Math.abs(W-1)&&1E-12<W&&d.scale(X,X,1/Math.sqrt(W));m(X,V,X);return X}function y(V,W,X,oa=b()){return g(d.subtract(f.sv3d.get(),V,W),d.subtract(f.sv3d.get(),
X,W),V,oa)}function x(V,W){return c(V,W,0,1,2)}function c(V,W,X,oa,ua){if(3>V.count)return!1;V.getVec(X,K);let H=oa,J=!1;for(;H<V.count-1&&!J;)V.getVec(H,P),H++,J=!d.exactEquals(K,P);if(!J)return!1;H=Math.max(H,ua);for(J=!1;H<V.count&&!J;)V.getVec(H,Q),H++,d.subtract(R,K,P),d.normalize(R,R),d.subtract(Y,P,Q),d.normalize(Y,Y),J=!d.exactEquals(K,Q)&&!d.exactEquals(P,Q)&&.99619469809>Math.abs(d.dot(R,Y));if(!J)return 0===X&&1===oa&&2===ua?!1:c(V,W,0,1,2);y(K,P,Q,W);return!0}function m(V,W,X){V!==X&&
q(V,X);X[3]=-d.dot(X,W);return X}function h(V,W){W[0]=-V[0];W[1]=-V[1];W[2]=-V[2];W[3]=-V[3];return W}function g(V,W,X,oa=b()){V=d.cross(f.sv3d.get(),W,V);return D(X,V,oa)}function k(V,W,X){return e.isSome(W)?L(V,W.origin,W.direction,!0,!1,X):!1}function n(V,W,X){return L(V,W.origin,W.vector,!1,!1,X)}function G(V,W,X){return L(V,W.origin,W.vector,!1,!0,X)}function C(V,W){return 0<=I(V,u.getCenter(W))-W[3]}function t(V,W){return 0>I(V,u.getCenter(W))+W[3]}function A(V,W){return 0<=I(V,W)}function z(V,
W){return 0>I(V,W)}function w(V,W){const X=W[0],oa=W[1],ua=W[2],H=W[3],J=W[4];W=W[5];return 0<=V[0]*(0<V[0]?X:H)+V[1]*(0<V[1]?oa:J)+V[2]*(0<V[2]?ua:W)+V[3]}function F(V,W){const X=d.dot(V,W.ray.direction);V=-I(V,W.ray.origin);if(0>V&&0<=X)return!1;if(-1E-6<X&&1E-6>X)return 0<V;if((0>V||0>X)&&!(0>V&&0>X))return!0;V/=X;0<X?V<W.c1&&(W.c1=V):V>W.c0&&(W.c0=V);return W.c0<=W.c1}function E(V,W){const X=d.dot(V,W.ray.direction);V=-I(V,W.ray.origin);if(-1E-6<X&&1E-6>X)return 0<V;V/=X;0<X?V<W.c1&&(W.c1=V):
V>W.c0&&(W.c0=V);return W.c0<=W.c1}function N(V,W,X){const oa=d.scale(f.sv3d.get(),V,-V[3]);W=d.subtract(f.sv3d.get(),W,oa);V=U(V,W,f.sv3d.get());d.add(X,V,oa);return X}function U(V,W,X){V=d.scale(f.sv3d.get(),V,d.dot(V,W));d.subtract(X,W,V);return X}function S(V,W){return Math.abs(I(V,W))}function I(V,W){return d.dot(V,W)+V[3]}function L(V,W,X,oa,ua,H){const J=d.dot(V,X);if(0===J)return!1;V=-(d.dot(V,W)+V[3])/J;ua&&(V=oa?Math.max(0,V):l.clamp(V,0,1));if(0>V||!oa&&1<V)return!1;d.add(H,W,d.scale(H,
X,V));return!0}function M(V){return V}const K=B.create(),P=B.create(),Q=B.create(),R=B.create(),Y=B.create(),T=[0,0,1,0];B=Object.freeze({__proto__:null,create:b,wrap:p,copy:q,fromValues:r,fromNormalAndOffset:v,fromPositionAndNormal:D,fromPoints:y,fromManyPoints:x,fromManyPointsSampleAt:c,setOffsetFromPoint:m,negate:h,fromVectorsAndPoint:g,intersectRay:k,intersectLineSegment:n,intersectLineSegmentClamp:G,isSphereFullyInside:C,isSphereFullyOutside:t,isPointInside:A,isPointOutside:z,isAABBFullyInside:w,
clip:F,clipInfinite:E,projectPoint:N,projectVector:U,distance:S,signedDistance:I,normal:M,UP:T});a.UP=T;a.clip=F;a.clipInfinite=E;a.copy=q;a.create=b;a.distance=S;a.fromManyPoints=x;a.fromManyPointsSampleAt=c;a.fromNormalAndOffset=v;a.fromPoints=y;a.fromPositionAndNormal=D;a.fromValues=r;a.fromVectorsAndPoint=g;a.intersectLineSegment=n;a.intersectLineSegmentClamp=G;a.intersectRay=k;a.isAABBFullyInside=w;a.isPointInside=A;a.isPointOutside=z;a.isSphereFullyInside=C;a.isSphereFullyOutside=t;a.negate=
h;a.normal=M;a.planeModule=B;a.projectPoint=N;a.projectVector=U;a.setOffsetFromPoint=m;a.signedDistance=I;a.wrap=p})},"esri/chunks/boundedPlane":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ./vec3f64 ./vec3 ../views/3d/support/mathUtils ./mat4 ../core/ObjectStack ./mat4f64 ../views/3d/support/stack ./vector ./lineSegment ./ray ./plane".split(" "),function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x){function c(Z=H){return{plane:x.create(Z.plane),origin:d.clone(Z.origin),basis1:d.clone(Z.basis1),
basis2:d.clone(Z.basis2)}}function m(Z,ia,ha){const O=ja.get();O.origin=Z;O.basis1=ia;O.basis2=ha;O.plane=x.wrap(0,0,0,0);n(O);return O}function h(Z,ia=c()){return k(Z.origin,Z.basis1,Z.basis2,ia)}function g(Z,ia){f.copy(ia.origin,Z.origin);f.copy(ia.basis1,Z.basis1);f.copy(ia.basis2,Z.basis2);x.copy(Z.plane,ia.plane)}function k(Z,ia,ha,O=c()){f.copy(O.origin,Z);f.copy(O.basis1,ia);f.copy(O.basis2,ha);n(O);1E-6<Math.abs(f.dot(O.basis1,O.basis2)/(f.length(O.basis1)*f.length(O.basis2)))&&ua.warn("fromValues()",
"Provided basis vectors are not perpendicular");1E-6<Math.abs(f.dot(O.basis1,T(O)))&&ua.warn("fromValues()","Basis vectors and plane normal are not perpendicular");1E-6<Math.abs(-f.dot(T(O),O.origin)-O.plane[3])&&ua.warn("fromValues()","Plane offset is not consistent with plane origin");return O}function n(Z){x.fromVectorsAndPoint(Z.basis2,Z.basis1,Z.origin,Z.plane)}function G(Z,ia,ha){Z!==ha&&h(Z,ha);Z=f.scale(r.sv3d.get(),T(Z),ia);f.add(ha.origin,ha.origin,Z);ha.plane[3]-=ia;return ha}function C(Z,
ia,ha){t(ia,ha);G(ha,K(Z,Z.origin),ha);return ha}function t(Z,ia=c()){const ha=(Z[2]-Z[0])/2,O=(Z[3]-Z[1])/2;f.set(ia.origin,Z[0]+ha,Z[1]+O,0);f.set(ia.basis1,ha,0,0);f.set(ia.basis2,0,O,0);x.fromValues(0,0,1,0,ia.plane);return ia}function A(Z,ia,ha){return x.intersectRay(Z.plane,ia,ha)?V(Z,ha):!1}function z(Z,ia,ha){if(A(Z,ia,ha))return ha;Z=w(Z,ia,r.sv3d.get());f.add(ha,ia.origin,f.scale(r.sv3d.get(),ia.direction,f.distance(ia.origin,Z)/f.length(ia.direction)));return ha}function w(Z,ia,ha){const O=
J.get();var ca=J.get();oa(Z,ia,O,ca);ca=Number.POSITIVE_INFINITY;for(const ba of la){var ea=X(Z,ba,aa.get());const qa=r.sv3d.get();x.intersectLineSegment(O,ea,qa)&&(ea=u.directionFromTo(r.sv3d.get(),ia.origin,qa),ea=Math.abs(B.acosClamped(f.dot(ia.direction,ea))),ea<ca&&(ca=ea,f.copy(ha,qa)))}return ca===Number.POSITIVE_INFINITY?F(Z,ia,ha):ha}function F(Z,ia,ha){if(A(Z,ia,ha))return ha;const O=J.get(),ca=J.get();oa(Z,ia,O,ca);let ea=Number.POSITIVE_INFINITY;for(const qa of la){var ba=X(Z,qa,aa.get());
const na=r.sv3d.get();x.intersectLineSegmentClamp(O,ba,na)&&(ba=y.distance2(ia,na),x.isPointInside(ca,na)&&ba<ea&&(ea=ba,f.copy(ha,na)))}U(Z,ia.origin)<ea&&E(Z,ia.origin,ha);return ha}function E(Z,ia,ha){var O=x.projectPoint(Z.plane,ia,r.sv3d.get());ia=D.projectPointClamp(W(Z,Z.basis1),O,-1,1,r.sv3d.get());O=D.projectPointClamp(W(Z,Z.basis2),O,-1,1,r.sv3d.get());f.subtract(ha,f.add(r.sv3d.get(),ia,O),Z.origin);return ha}function N(Z,ia,ha){const {origin:O,basis1:ca,basis2:ea}=Z,ba=f.subtract(r.sv3d.get(),
ia,O);ia=v.projectPointSignedLength(ca,ba);const qa=v.projectPointSignedLength(ea,ba);Z=v.projectPointSignedLength(T(Z),ba);return f.set(ha,ia,qa,Z)}function U(Z,ia){ia=N(Z,ia,r.sv3d.get());const {basis1:ha,basis2:O}=Z;Z=f.length(ha);var ca=f.length(O);Z=Math.max(Math.abs(ia[0])-Z,0);ca=Math.max(Math.abs(ia[1])-ca,0);ia=ia[2];return Z*Z+ca*ca+ia*ia}function S(Z,ia){return Math.sqrt(U(Z,ia))}function I(Z,ia){let ha=Number.NEGATIVE_INFINITY;for(const ca of la){var O=X(Z,ca,aa.get());O=D.distance2(O,
ia);O>ha&&(ha=O)}return Math.sqrt(ha)}function L(Z,ia){return x.isPointInside(Z.plane,ia)&&V(Z,ia)}function M(Z,ia,ha,O){switch(ha){case 0:f.copy(O,Z.basis1);f.normalize(O,O);break;case 1:f.copy(O,Z.basis2);f.normalize(O,O);break;case 2:f.copy(O,T(Z))}return O}function K(Z,ia){const ha=-Z.plane[3];return v.projectPointSignedLength(T(Z),ia)-ha}function P(Z,ia,ha,O){const ca=K(Z,ia);Z=f.scale(fa,T(Z),ha-ca);f.add(O,ia,Z);return O}function Q(Z,ia){return f.exactEquals(Z.basis1,ia.basis1)&&f.exactEquals(Z.basis2,
ia.basis2)&&f.exactEquals(Z.origin,ia.origin)}function R(Z,ia,ha){Z!==ha&&h(Z,ha);b.invert(da,ia);b.transpose(da,da);f.transformMat4(ha.basis1,Z.basis1,da);f.transformMat4(ha.basis2,Z.basis2,da);f.transformMat4(x.normal(ha.plane),x.normal(Z.plane),da);f.transformMat4(ha.origin,Z.origin,ia);x.setOffsetFromPoint(ha.plane,ha.origin,ha.plane);return ha}function Y(Z,ia,ha,O){Z!==O&&h(Z,O);b.rotate(ka,b.identity(ka),ia,ha);f.transformMat4(O.basis1,Z.basis1,ka);f.transformMat4(O.basis2,Z.basis2,ka);n(O);
return O}function T(Z){return x.normal(Z.plane)}function V(Z,ia){const ha=f.subtract(r.sv3d.get(),ia,Z.origin);ia=f.squaredLength(Z.basis1);const O=f.squaredLength(Z.basis2),ca=f.dot(Z.basis1,ha);Z=f.dot(Z.basis2,ha);return 0>-ca-ia&&0>ca-ia&&0>-Z-O&&0>Z-O}function W(Z,ia){const ha=aa.get();f.copy(ha.origin,Z.origin);f.copy(ha.vector,ia);return ha}function X(Z,ia,ha){const {basis1:O,basis2:ca,origin:ea}=Z;Z=f.scale(r.sv3d.get(),O,ia.origin[0]);const ba=f.scale(r.sv3d.get(),ca,ia.origin[1]);f.add(ha.origin,
Z,ba);f.add(ha.origin,ha.origin,ea);Z=f.scale(r.sv3d.get(),O,ia.direction[0]);ia=f.scale(r.sv3d.get(),ca,ia.direction[1]);f.scale(ha.vector,f.add(Z,Z,ia),2);return ha}function oa(Z,ia,ha,O){Z=T(Z);x.fromVectorsAndPoint(Z,ia.direction,ia.origin,ha);x.fromVectorsAndPoint(x.normal(ha),Z,ia.origin,O)}const ua=l.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");e=function(){this.plane=x.create();this.origin=d.create();this.basis1=d.create();this.basis2=d.create()};const H={plane:x.create(),
origin:d.fromValues(0,0,0),basis1:d.fromValues(1,0,0),basis2:d.fromValues(0,1,0)},J=new p.ObjectStack(x.create),aa=new p.ObjectStack(D.create),fa=d.create(),ja=new p.ObjectStack(()=>({origin:null,basis1:null,basis2:null,plane:null})),la=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],da=q.create(),ka=q.create();p=Object.freeze({__proto__:null,BoundedPlaneClass:e,create:c,wrap:m,copy:h,copyWithoutVerify:g,fromValues:k,
updateUnboundedPlane:n,elevate:G,setExtent:C,fromAABoundingRect:t,intersectRay:A,intersectRayClosestSilhouette:z,closestPointOnSilhouette:w,closestPoint:F,projectPoint:E,projectPointLocal:N,distance2:U,distance:S,distanceToSilhouette:I,extrusionContainsPoint:L,axisAt:M,altitudeAt:K,setAltitudeAt:P,equals:Q,transform:R,rotate:Y,normal:T,UP:H});a.BoundedPlaneClass=e;a.UP=H;a.altitudeAt=K;a.axisAt=M;a.boundedPlaneModule=p;a.closestPoint=F;a.closestPointOnSilhouette=w;a.copy=h;a.copyWithoutVerify=g;a.create=
c;a.distance=S;a.distance2=U;a.distanceToSilhouette=I;a.elevate=G;a.equals=Q;a.extrusionContainsPoint=L;a.fromAABoundingRect=t;a.fromValues=k;a.intersectRay=A;a.intersectRayClosestSilhouette=z;a.normal=T;a.projectPoint=E;a.projectPointLocal=N;a.rotate=Y;a.setAltitudeAt=P;a.setExtent=C;a.transform=R;a.updateUnboundedPlane=n;a.wrap=m})},"esri/chunks/frustum":function(){define("exports ./vec3f64 ./vec3 ./mat4 ../core/ObjectStack ./vec4f64 ./vec4 ../views/3d/support/stack ./plane ./clipRay".split(" "),
function(a,e,l,B,d,f,u,b,p,q){function r(w){return w?[p.create(w[0]),p.create(w[1]),p.create(w[2]),p.create(w[3]),p.create(w[4]),p.create(w[5])]:[p.create(),p.create(),p.create(),p.create(),p.create(),p.create()]}function v(){return[e.create(),e.create(),e.create(),e.create(),e.create(),e.create(),e.create(),e.create()]}function D(w,F=r()){for(let E=0;6>E;E++)p.copy(w[E],F[E])}function y(w,F,E,N=z){w=B.multiply(b.sm4d.get(),F,w);B.invert(w,w);for(F=0;8>F;++F){const U=u.transformMat4(b.sv4d.get(),
t[F],w);l.set(N[F],U[0]/U[3],U[1]/U[3],U[2]/U[3])}x(E,N)}function x(w,F){p.fromPoints(F[4],F[0],F[3],w[0]);p.fromPoints(F[1],F[5],F[6],w[1]);p.fromPoints(F[4],F[5],F[1],w[2]);p.fromPoints(F[3],F[2],F[6],w[3]);p.fromPoints(F[0],F[1],F[2],w[4]);p.fromPoints(F[5],F[4],F[7],w[5])}function c(w,F){for(let E=0;6>E;E++)if(p.isSphereFullyInside(w[E],F))return!1;return!0}function m(w,F){return G(w,q.fromRay(F,A.get()))}function h(w,F){for(let E=0;6>E;E++)if(!p.clipInfinite(w[E],F))return!1;return!0}function g(w,
F,E){return G(w,q.fromLineSegmentAndDirection(F,E,A.get()))}function k(w,F){for(let E=0;6>E;E++)if(0<p.signedDistance(w[E],F))return!1;return!0}function n(w,F){for(let E=0;6>E;E++)if(p.isAABBFullyInside(w[E],F))return!1;return!0}function G(w,F){for(let E=0;6>E;E++)if(!p.clip(w[E],F))return!1;return!0}const C={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]},t=[f.fromValues(-1,-1,-1,1),f.fromValues(1,-1,-1,1),f.fromValues(1,1,-1,1),f.fromValues(-1,1,-1,1),
f.fromValues(-1,-1,1,1),f.fromValues(1,-1,1,1),f.fromValues(1,1,1,1),f.fromValues(-1,1,1,1)],A=new d.ObjectStack(q.create),z=v();d=Object.freeze({__proto__:null,create:r,createPoints:v,copy:D,fromMatrix:y,computePlanes:x,intersectsSphere:c,intersectsRay:m,intersectClipRay:h,intersectsLineSegment:g,intersectsPoint:k,intersectsAABB:n,planePointIndices:C});a.computePlanes=x;a.copy=D;a.create=r;a.createPoints=v;a.fromMatrix=y;a.frustumModule=d;a.intersectClipRay=h;a.intersectsAABB=n;a.intersectsLineSegment=
g;a.intersectsPoint=k;a.intersectsRay=m;a.intersectsSphere=c;a.planePointIndices=C})},"esri/chunks/triangle":function(){define("exports ./vec3f64 ./vec3 ../core/ObjectStack ./vec2 ../views/3d/support/stack ./lineSegment".split(" "),function(a,e,l,B,d,f,u){function b(n){return n?{p0:e.clone(n.p0),p1:e.clone(n.p1),p2:e.clone(n.p2)}:{p0:e.create(),p1:e.create(),p2:e.create()}}function p(n,G,C){const t=h.get();t.p0=n;t.p1=G;t.p2=C;return t}function q(n,G=b()){return r(n.p0,n.p1,n.p2,G)}function r(n,G,
C,t=b()){l.copy(t.p0,n);l.copy(t.p1,G);l.copy(t.p2,C);return t}function v(n,G){var C=n.p0,t=n.p1;n=n.p2;const A=l.subtract(f.sv3d.get(),t,C),z=l.subtract(f.sv3d.get(),n,t),w=l.subtract(f.sv3d.get(),C,n),F=l.subtract(f.sv3d.get(),G,C);var E=l.subtract(f.sv3d.get(),G,t),N=l.subtract(f.sv3d.get(),G,n);const U=l.cross(A,A,w),S=l.dot(l.cross(f.sv3d.get(),A,U),F);E=l.dot(l.cross(f.sv3d.get(),z,U),E);N=l.dot(l.cross(f.sv3d.get(),w,U),N);if(0<S&&0<E&&0<N)return G=l.dot(U,F),G*G/l.dot(U,U);C=u.distance2(u.fromValues(C,
A,m.get()),G);t=u.distance2(u.fromValues(t,z,m.get()),G);G=u.distance2(u.fromValues(n,w,m.get()),G);return Math.min(C,t,G)}function D(n,G,C){const {direction:t,origin:A}=G,{p0:z,p1:w,p2:F}=n;var E=w[0]-z[0],N=w[1]-z[1],U=w[2]-z[2];n=F[0]-z[0];G=F[1]-z[1];const S=F[2]-z[2];var I=t[1]*S-G*t[2],L=t[2]*n-S*t[0];const M=t[0]*G-n*t[1];var K=E*I+N*L+U*M;if(-1E-5<K&&1E-5>K)return!1;K=1/K;const P=A[0]-z[0],Q=A[1]-z[1],R=A[2]-z[2];I=K*(P*I+Q*L+R*M);if(0>I||1<I)return!1;L=Q*U-N*R;U=R*E-U*P;E=P*N-E*Q;N=K*(t[0]*
L+t[1]*U+t[2]*E);if(0>N||1<I+N)return!1;C&&(l.scale(C,t,K*(n*L+G*U+S*E)),l.add(C,A,C));return!0}function y(n,G,C){var t=d.distance(n,G);G=d.distance(G,C);n=d.distance(C,n);C=(t+G+n)/2;t=C*(C-t)*(C-G)*(C-n);return 0>=t?0:Math.sqrt(t)}function x(n){return y(n.p0,n.p1,n.p2)}function c(n,G,C){l.subtract(g,G,n);l.subtract(k,C,n);return l.length(l.cross(g,g,k))/2}const m=new B.ObjectStack(u.create),h=new B.ObjectStack(()=>({p0:null,p1:null,p2:null})),g=e.create(),k=e.create();B=Object.freeze({__proto__:null,
create:b,wrap:p,copy:q,fromValues:r,distance2:v,intersectRay:D,areaPoints2d:y,area2d:x,areaPoints3d:c});a.area2d=x;a.areaPoints2d=y;a.areaPoints3d=c;a.copy=q;a.create=b;a.distance2=v;a.fromValues=r;a.intersectRay=D;a.triangleModule=B;a.wrap=p})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define("../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../chunks/vec3f32 ../../support/geometryUtils ./BufferVectorMath ./Util ./geometryDataUtils ./Geometry".split(" "),function(a,e,l,
B,d,f,u,b){const p=d.Vec3Compact;var q;(function(x){const c=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],m=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],h=[0,0,1,0,1,1,0,1],g=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),k=new Uint16Array(36);for(var n=0;6>n;n++)for(let C=0;6>C;C++)k[6*n+C]=n;const G=new Uint16Array(36);for(n=0;6>n;n++)G[6*n]=0,G[6*n+1]=1,G[6*n+2]=2,G[6*n+3]=2,G[6*n+4]=3,G[6*n+5]=0;x.createGeometry=
function(C){Array.isArray(C)||(C=[C,C,C]);const t=Array(24);for(let A=0;8>A;A++)t[3*A]=c[A][0]*C[0],t[3*A+1]=c[A][1]*C[1],t[3*A+2]=c[A][2]*C[2];return new b.Geometry([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:m}],["uv0",{size:2,data:h}]],[["position",g],["normal",k],["uv0",G]])}})(q||(q={}));var r;(function(x){const c=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],m=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],h=new Uint16Array([5,1,0,5,2,1,5,
3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),g=new Uint16Array([0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);x.createGeometry=function(k){Array.isArray(k)||(k=[k,k,k]);const n=Array(18);for(let G=0;6>G;G++)n[3*G]=c[G][0]*k[0],n[3*G+1]=c[G][1]*k[1],n[3*G+2]=c[G][2]*k[2];return new b.Geometry([["position",{size:3,data:n,exclusive:!0}],["normal",{size:3,data:m}]],[["position",h],["normal",g]])}})(r||(r={}));var v;(function(x){const c=l.fromValues(-.5,0,-.5),m=l.fromValues(.5,0,-.5),h=l.fromValues(0,0,.5),
g=l.fromValues(0,.5,0),k=l.create(),n=l.create(),G=l.create(),C=l.create(),t=l.create();e.subtract(k,c,g);e.subtract(n,c,m);e.cross(G,k,n);e.normalize(G,G);e.subtract(k,m,g);e.subtract(n,m,h);e.cross(C,k,n);e.normalize(C,C);e.subtract(k,h,g);e.subtract(n,h,c);e.cross(t,k,n);e.normalize(t,t);const A=[c,m,h,g],z=[0,-1,0,G[0],G[1],G[2],C[0],C[1],C[2],t[0],t[1],t[2]],w=[0,1,2,3,1,0,3,2,1,3,0,2],F=[0,0,0,1,1,1,2,2,2,3,3,3];x.createGeometry=function(E){Array.isArray(E)||(E=[E,E,E]);const N=Array(12);for(let U=
0;4>U;U++)N[3*U]=A[U][0]*E[0],N[3*U+1]=A[U][1]*E[1],N[3*U+2]=A[U][2]*E[2];return new b.Geometry([["position",{size:3,data:N,exclusive:!0}],["normal",{size:3,data:z}]],[["position",new Uint16Array(w)],["normal",new Uint16Array(F)]])}})(v||(v={}));var D;(function(x){function c(g,k,n,G,C){if(Math.abs(e.dot(k,g))>C)return!1;e.cross(n,g,k);e.normalize(n,n);e.cross(G,n,g);e.normalize(G,G);return!0}function m(g,k,n,G,C,t,A){return c(g,k,C,t,A)||c(g,n,C,t,A)||c(g,G,C,t,A)}x.createBoxGeometry=q.createGeometry;
x.createDiamondGeometry=r.createGeometry;x.createTetrahedronGeometry=v.createGeometry;x.createSphereGeometry=function(g,k,n,G={uv:!0}){var C=-Math.PI,t=2*Math.PI,A=-Math.PI/2,z=Math.PI;k=Math.max(3,Math.floor(k));const w=Math.max(2,Math.floor(n));var F=(k+1)*(w+1);n=new Float32Array(3*F);const E=new Float32Array(3*F);F=new Float32Array(2*F);const N=[];let U=0;for(var S=0;S<=w;S++){var I=[];const M=S/w,K=A+M*z,P=Math.cos(K);for(let Q=0;Q<=k;Q++){const R=Q/k;var L=C+R*t;const Y=Math.cos(L)*P,T=Math.sin(K);
L=-Math.sin(L)*P;n[3*U]=Y*g;n[3*U+1]=T*g;n[3*U+2]=L*g;E[3*U]=Y;E[3*U+1]=T;E[3*U+2]=L;F[2*U]=R;F[2*U+1]=M;I.push(U);++U}N.push(I)}g=new Uint32Array(2*k*(w-1)*3);U=0;for(C=0;C<w;C++)for(t=0;t<k;t++)A=N[C][t],z=N[C][t+1],S=N[C+1][t+1],I=N[C+1][t],0===C?(g[U++]=A,g[U++]=S,g[U++]=I):C===w-1?(g[U++]=A,g[U++]=z,g[U++]=S):(g[U++]=A,g[U++]=z,g[U++]=S,g[U++]=S,g[U++]=I,g[U++]=A);k=[["position",g],["normal",g]];n=[["position",{size:3,data:n,exclusive:!0}],["normal",{size:3,data:E,exclusive:!0}]];G.uv&&(n.push(["uv0",
{size:2,data:F,exclusive:!0}]),k.push(["uv0",g]));G.offset&&(k[0][0]="offset",n[0][0]="offset",k.push(["position",new Uint32Array(g.length)]),n.push(["position",{size:3,data:Float64Array.from(G.offset),exclusive:!0}]));return new b.Geometry(n,k)};x.createPolySphereGeometry=function(g,k,n){function G(z,w){z>w&&([z,w]=[w,z]);const F=z.toString()+"."+w.toString();if(A[F])return A[F];let E=C.length;C.length+=3;p.add(C,3*z,C,3*w,C,E);p.scale(C,E,g/p.length(C,E));E/=3;return A[F]=E}let C;n?(C=[0,-1,0,1,
0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],n=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1])):(n=g*(1+Math.sqrt(5))/2,C=[-g,n,0,g,n,0,-g,-n,0,g,-n,0,0,-g,n,0,g,n,0,-g,-n,0,g,-n,n,0,-g,n,0,g,-n,0,-g,-n,0,g],n=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]));for(var t=0;t<C.length;t+=3)p.scale(C,t,g/p.length(C,t));let A={};for(t=0;t<k;t++){const z=n.length,w=new Uint32Array(4*z);for(let F=0;F<
z;F+=3){const E=n[F],N=n[F+1],U=n[F+2],S=G(E,N),I=G(N,U),L=G(U,E),M=4*F;w[M]=E;w[M+1]=S;w[M+2]=L;w[M+3]=N;w[M+4]=I;w[M+5]=S;w[M+6]=U;w[M+7]=L;w[M+8]=I;w[M+9]=S;w[M+10]=I;w[M+11]=L}n=w;A={}}k=new Float32Array(C);for(t=0;t<k.length;t+=3)p.normalize(k,t);n=[["position",n],["normal",n]];k=[["position",{size:3,data:new Float32Array(C),exclusive:!0}],["normal",{size:3,data:k,exclusive:!0}]];return new b.Geometry(k,n)};x.createPointGeometry=function(g,k,n,G,C,t,A){k=k?[k[0],k[1],k[2]]:[0,0,0];g=g?[g[0],
g[1],g[2]]:[0,0,1];t=t||[0,0];n=[["position",{size:3,data:k,exclusive:!0}],["normal",{size:3,data:g,exclusive:!0}],["uv0",{size:t.length,data:t}],["color",{size:4,data:n?[255*n[0],255*n[1],255*n[2],3<n.length?255*n[3]:255]:[255,255,255,255],exclusive:!0}],["size",{size:2,data:null!=G&&2===G.length?G:[1,1]}]];null!=C&&(C=new Float32Array([C[0],C[1],C[2],C[3]]),n.push(["auxpos1",{size:4,data:C}]));null!=A&&(A=new Float32Array([A[0],A[1],A[2],A[3]]),n.push(["auxpos2",{size:4,data:A}]));return new b.Geometry(n,
null,1)};x.updatePointGeometry=function(g,k,n,G,C,t,A,z){if(null!=g){const {data:w}=z.getMutableAttribute("normal");w[0]=g[0];w[1]=g[1];w[2]=g[2]}null!=k&&({data:g}=z.getMutableAttribute("position"),g[0]=k[0],g[1]=k[1],g[2]=k[2]);null!=n&&({data:k}=z.getMutableAttribute("color"),k[0]=n[0],k[1]=n[1],k[2]=n[2],k[3]=n[3]);null!=G&&({data:n}=z.getMutableAttribute("size"),n[0]=G[0],n[1]=G[1]);null!=C&&({data:G}=z.getMutableAttribute("auxpos1"),G[0]=C[0],G[1]=C[1],G[2]=C[2],G[3]=C[3]);null!=t&&({data:C}=
z.getMutableAttribute("uv0"),C[0]=t[0],C[1]=t[1]);null!=A&&({data:t}=z.getMutableAttribute("auxpos2"),t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=A[3])};x.createPointArrayGeometry=function(g,k){const n=new Float32Array(3*g.length),G=new Float32Array(k?3*g.length:3),C=new Uint32Array(g.length),t=new Uint32Array(g.length);for(let A=0;A<g.length;A++)n[3*A]=g[A][0],n[3*A+1]=g[A][1],n[3*A+2]=g[A][2],k&&(G[3*A]=k[A][0],G[3*A+1]=k[A][1],G[3*A+2]=k[A][2]),C[A]=A,t[A]=0;k||(G[0]=0,G[1]=1,G[2]=0);return new b.Geometry([["position",
{size:3,data:n,exclusive:!0}],["normal",{size:3,data:G,exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",C],["normal",k?C:t],["uv0",t]],1)};x.createTriangleGeometry=function(){const g=new Uint16Array([0,1,2]),k=new Uint16Array([0,0,0]),n=new Uint16Array([0,0,0]);return new b.Geometry([["position",{size:3,data:[0,0,0,0,0,100,100,0,0],exclusive:!0}],["normal",{size:3,data:[0,1,0],exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",g],["normal",k],["uv0",n]])};const h=
[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];x.createSquareGeometry=function(g=h){const k=Array(12);for(var n=0;4>n;n++)for(let G=0;3>G;G++)k[3*n+G]=g[n][G];g=new Uint32Array([0,1,2,2,3,0]);n=new Uint32Array([0,0,0,0,0,0]);return new b.Geometry([["position",{size:3,data:k,exclusive:!0}],["normal",{size:3,data:[0,0,1],exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1],exclusive:!0}],["color",{size:4,data:[255,255,255,255],exclusive:!0}]],[["position",g],["normal",n],["uv0",g],["color",n]])};x.createConeGeometry=
function(g,k,n,G,C=!0,t=!0){var A=0,z=l.fromValues(0,A,0),w=l.fromValues(0,A+g,0),F=l.fromValues(0,-1,0),E=l.fromValues(0,1,0);G&&(A=g,w=l.fromValues(0,0,0),z=l.fromValues(0,A,0),F=l.fromValues(0,1,0),E=l.fromValues(0,-1,0));z=[w,z];F=[F,E];E=n+2;w=Math.sqrt(g*g+k*k);if(G)for(G=n-1;0<=G;G--){var N=2*Math.PI/n*G,U=l.fromValues(Math.cos(N)*k,A,Math.sin(N)*k);z.push(U);N=l.fromValues(g*Math.cos(N)/w,-k/w,g*Math.sin(N)/w);F.push(N)}else for(G=0;G<n;G++)N=2*Math.PI/n*G,U=l.fromValues(Math.cos(N)*k,A,Math.sin(N)*
k),z.push(U),N=l.fromValues(g*Math.cos(N)/w,k/w,g*Math.sin(N)/w),F.push(N);g=new Uint32Array(6*(n+2));n=new Uint32Array(6*(n+2));A=k=0;if(C){for(C=3;C<z.length;C++)g[k++]=1,g[k++]=C-1,g[k++]=C,n[A++]=0,n[A++]=0,n[A++]=0;g[k++]=z.length-1;g[k++]=2;g[k++]=1;n[A++]=0;n[A++]=0;n[A++]=0}if(t){for(t=3;t<z.length;t++)g[k++]=t,g[k++]=t-1,g[k++]=0,n[A++]=t,n[A++]=t-1,n[A++]=1;g[k++]=0;g[k++]=2;g[k++]=z.length-1;n[A++]=1;n[A++]=2;n[A++]=F.length-1}t=new Float32Array(3*E);for(C=0;C<E;C++)t[3*C]=z[C][0],t[3*
C+1]=z[C][1],t[3*C+2]=z[C][2];z=new Float32Array(3*E);for(C=0;C<E;C++)z[3*C]=F[C][0],z[3*C+1]=F[C][1],z[3*C+2]=F[C][2];return new b.Geometry([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:z,exclusive:!0}]],[["position",g],["normal",n]])};x.createCylinderGeometry=function(g,k,n,G,C,t){G=G?l.clone(G):l.fromValues(1,0,0);C=C?l.clone(C):l.fromValues(0,0,0);t=null==t?!0:t;var A=l.create();e.normalize(A,G);const z=l.create();e.scale(z,A,Math.abs(g));const w=l.create();e.scale(w,z,-.5);
e.add(w,w,C);const F=l.fromValues(0,1,0);.2>Math.abs(1-e.dot(A,F))&&e.set(F,0,0,1);const E=l.create();e.cross(E,A,F);e.normalize(E,E);e.cross(F,E,A);g=2*n+(t?2:0);C=n+(t?2:0);G=new Float32Array(3*g);const N=new Float32Array(3*C),U=new Float32Array(2*g),S=new Uint32Array(3*n*(t?4:2)),I=new Uint32Array(3*n*(t?4:2));t&&(G[3*(g-2)]=w[0],G[3*(g-2)+1]=w[1],G[3*(g-2)+2]=w[2],U[2*(g-2)]=0,U[2*(g-2)+1]=0,G[3*(g-1)]=G[3*(g-2)]+z[0],G[3*(g-1)+1]=G[3*(g-2)+1]+z[1],G[3*(g-1)+2]=G[3*(g-2)+2]+z[2],U[2*(g-1)]=1,
U[2*(g-1)+1]=1,N[3*(C-2)]=-A[0],N[3*(C-2)+1]=-A[1],N[3*(C-2)+2]=-A[2],N[3*(C-1)]=A[0],N[3*(C-1)+1]=A[1],N[3*(C-1)+2]=A[2]);A=function(Q,R,Y){S[Q]=R;I[Q]=Y};let L=0;const M=l.create(),K=l.create();for(let Q=0;Q<n;Q++){var P=2*Math.PI/n*Q;e.scale(M,F,Math.sin(P));e.scale(K,E,Math.cos(P));e.add(M,M,K);N[3*Q]=M[0];N[3*Q+1]=M[1];N[3*Q+2]=M[2];e.scale(M,M,k);e.add(M,M,w);G[3*Q]=M[0];G[3*Q+1]=M[1];G[3*Q+2]=M[2];U[2*Q]=Q/n;U[2*Q+1]=0;G[3*(Q+n)]=G[3*Q]+z[0];G[3*(Q+n)+1]=G[3*Q+1]+z[1];G[3*(Q+n)+2]=G[3*Q+2]+
z[2];U[2*(Q+n)]=Q/n;U[2*Q+1]=1;P=(Q+1)%n;A(L++,Q,Q);A(L++,Q+n,Q);A(L++,P,P);A(L++,P,P);A(L++,Q+n,Q);A(L++,P+n,P)}if(t){for(k=0;k<n;k++)t=(k+1)%n,A(L++,g-2,C-2),A(L++,k,C-2),A(L++,t,C-2);for(k=0;k<n;k++)t=(k+1)%n,A(L++,k+n,C-1),A(L++,g-1,C-1),A(L++,t+n,C-1)}return new b.Geometry([["position",{size:3,data:G,exclusive:!0}],["normal",{size:3,data:N,exclusive:!0}],["uv0",{size:2,data:U,exclusive:!0}]],[["position",S],["normal",I],["uv0",S]])};x.createTubeGeometry=function(g,k,n,G,C){n=n||10;G=null!=G?
G:!0;f.assert(1<g.length);const t=[],A=[];for(let z=0;z<n;z++){t.push([0,-z-1,-((z+1)%n)-1]);const w=z/n*2*Math.PI;A.push([Math.cos(w)*k,Math.sin(w)*k])}return x.createPathExtrusionGeometry(A,g,[[0,0,0]],t,G,C)};x.createPathExtrusionGeometry=function(g,k,n,G,C,t=l.fromValues(0,0,0)){var A=g.length;const z=new Float32Array(k.length*A*3+(6*n.length||0)),w=new Float32Array(k.length*A*3+(n?6:0));var F=(k.length-1)*A*6+6*G.length;const E=new Uint32Array(F);F=new Uint32Array(F);let N=0;var U=0;let S=0,
I=0;const L=l.create(),M=l.create(),K=l.create(),P=l.create(),Q=l.create(),R=l.create(),Y=l.create(),T=a.create(),V=l.create(),W=l.create(),X=l.create(),oa=l.create(),ua=l.create(),H=B.plane.create();e.set(V,0,1,0);e.subtract(M,k[1],k[0]);e.normalize(M,M);C?(e.add(T,k[0],t),e.normalize(K,T)):e.set(K,0,0,1);m(M,K,V,V,Q,K,.99619469809);e.copy(P,K);e.copy(oa,Q);for(var J=0;J<n.length;J++)e.scale(R,Q,n[J][0]),e.scale(T,K,n[J][2]),e.add(R,R,T),e.add(R,R,k[0]),z[N++]=R[0],z[N++]=R[1],z[N++]=R[2];w[U++]=
-M[0];w[U++]=-M[1];w[U++]=-M[2];for(J=0;J<G.length;J++)E[S++]=0<G[J][0]?G[J][0]:-G[J][0]-1+n.length,E[S++]=0<G[J][1]?G[J][1]:-G[J][1]-1+n.length,E[S++]=0<G[J][2]?G[J][2]:-G[J][2]-1+n.length,F[I++]=0,F[I++]=0,F[I++]=0;J=n.length;const aa=n.length-1;for(let ja=0;ja<k.length;ja++){let la=!1;0<ja&&(e.copy(L,M),ja<k.length-1?(e.subtract(M,k[ja+1],k[ja]),e.normalize(M,M)):la=!0,e.add(W,L,M),e.normalize(W,W),e.add(X,k[ja-1],P),B.plane.fromPositionAndNormal(k[ja],W,H),B.plane.intersectRay(H,B.ray.wrap(X,
L),T)?(e.subtract(T,T,k[ja]),e.normalize(K,T),e.cross(Q,W,K),e.normalize(Q,Q)):m(W,P,oa,V,Q,K,.99619469809),e.copy(P,K),e.copy(oa,Q));C&&(e.add(T,k[ja],t),e.normalize(ua,T));for(let da=0;da<A;da++)if(e.scale(R,Q,g[da][0]),e.scale(T,K,g[da][1]),e.add(R,R,T),e.normalize(Y,R),w[U++]=Y[0],w[U++]=Y[1],w[U++]=Y[2],e.add(R,R,k[ja]),z[N++]=R[0],z[N++]=R[1],z[N++]=R[2],!la){var fa=(da+1)%A;E[S++]=J+da;E[S++]=J+A+da;E[S++]=J+fa;E[S++]=J+fa;E[S++]=J+A+da;E[S++]=J+A+fa;for(fa=0;6>fa;fa++)F[I++]=E[S-6+fa]-aa}J+=
A}g=k[k.length-1];for(k=0;k<n.length;k++)e.scale(R,Q,n[k][0]),e.scale(T,K,n[k][1]),e.add(R,R,T),e.add(R,R,g),z[N++]=R[0],z[N++]=R[1],z[N++]=R[2];n=U/3;w[U++]=M[0];w[U++]=M[1];w[U++]=M[2];A=J-A;for(U=0;U<G.length;U++)E[S++]=0<=G[U][0]?J+G[U][0]:-G[U][0]-1+A,E[S++]=0<=G[U][2]?J+G[U][2]:-G[U][2]-1+A,E[S++]=0<=G[U][1]?J+G[U][1]:-G[U][1]-1+A,F[I++]=n,F[I++]=n,F[I++]=n;return new b.Geometry([["position",{size:3,data:z,exclusive:!0}],["normal",{size:3,data:w,exclusive:!0}]],[["position",E],["normal",F]])};
x.createPolylineGeometry=function(g,k,n){f.assert(1<g.length,"createPolylineGeometry(): polyline needs at least 2 points");f.assert(3===g[0].length,"createPolylineGeometry(): malformed vertex");f.assert(null==k||k.length===g.length,"createPolylineGeometry: need same number of points and normals");f.assert(null==k||3===k[0].length,"createPolylineGeometry(): malformed normal");var G=new Float64Array(3*g.length);const C=new Uint32Array(2*(g.length-1));var t=0,A=0;for(var z=0;z<g.length;z++){for(var w=
0;3>w;w++)G[t++]=g[z][w];0<z&&(C[A++]=z-1,C[A++]=z)}t=[];A=[];t.push(["position",C]);A.push(["position",{size:3,data:G,exclusive:!0}]);if(k){G=new Float32Array(3*k.length);z=0;for(w=0;w<g.length;w++)for(let F=0;3>F;F++)G[z++]=k[w][F];t.push(["normal",C]);A.push(["normal",{size:3,data:G,exclusive:!0}])}n&&(A.push(["color",{size:4,data:n}]),t.push(["color",u.generateDefaultIndexArray(n.length/4)]));return new b.Geometry(A,t,2)};x.createExtrudedTriangle=function(g,k,n,G){const C=Array(18);g=[[-k,0,G/
2],[n,0,G/2],[0,g,G/2],[-k,0,-G/2],[n,0,-G/2],[0,g,-G/2]];k=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]);for(n=0;6>n;n++)C[3*n]=g[n][0],C[3*n+1]=g[n][1],C[3*n+2]=g[n][2];return new b.Geometry([["position",{size:3,data:C,exclusive:!0}]],[["position",k]])};x.transformInPlace=function(g,k){g=g.getMutableAttribute("position").data;for(let n=0;n<g.length;n+=3)e.set(y,g[n],g[n+1],g[n+2]),e.transformMat4(y,y,k),g[n]=y[0],g[n+1]=y[1],g[n+2]=y[2]};x.cgToGIS=function(g,k=g){var n=g.vertexAttributes;
g=n.get("position").data;if(n=n.get("normal").data){var G=k.getMutableAttribute("normal").data;for(var C=0;C<n.length;C+=3){const t=n[C+1];G[C+1]=-n[C+2];G[C+2]=t}}if(g)for(n=k.getMutableAttribute("position").data,G=0;G<g.length;G+=3)C=g[G+1],n[G+1]=-g[G+2],n[G+2]=C;return k};x.makeOrthoBasisDirUp=c;x.makeOrthoBasisDirUpFallback=m})(D||(D={}));const y=l.create();return D})},"esri/chunks/vec3f32":function(){define(["exports"],function(a){function e(){return new Float32Array(3)}function l(m){const h=
new Float32Array(3);h[0]=m[0];h[1]=m[1];h[2]=m[2];return h}function B(m,h,g){const k=new Float32Array(3);k[0]=m;k[1]=h;k[2]=g;return k}function d(m,h){return new Float32Array(m,h,3)}function f(){return e()}function u(){return B(1,1,1)}function b(){return B(1,0,0)}function p(){return B(0,1,0)}function q(){return B(0,0,1)}const r=e(),v=u(),D=b(),y=p(),x=q();var c=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d,zeros:f,ones:u,unitX:b,unitY:p,unitZ:q,ZEROS:r,ONES:v,UNIT_X:D,UNIT_Y:y,
UNIT_Z:x});a.ONES=v;a.UNIT_X=D;a.UNIT_Y=y;a.UNIT_Z=x;a.ZEROS=r;a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.ones=u;a.unitX=b;a.unitY=p;a.unitZ=q;a.vec3f32=c;a.zeros=f})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["exports"],function(a){(function(e){e.length=function(l,B){const d=l[B],f=l[B+1];l=l[B+2];return Math.sqrt(d*d+f*f+l*l)};e.normalize=function(l,B){var d=l[B];const f=l[B+1],u=l[B+2];d=1/Math.sqrt(d*d+f*f+u*u);l[B]*=d;l[B+1]*=d;l[B+2]*=d};e.scale=function(l,
B,d){l[B]*=d;l[B+1]*=d;l[B+2]*=d};e.add=function(l,B,d,f,u,b=B){u=u||l;u[b]=l[B]+d[f];u[b+1]=l[B+1]+d[f+1];u[b+2]=l[B+2]+d[f+2]};e.subtract=function(l,B,d,f,u,b=B){u=u||l;u[b]=l[B]-d[f];u[b+1]=l[B+1]-d[f+1];u[b+2]=l[B+2]-d[f+2]}})(a.Vec3Compact||(a.Vec3Compact={}));Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Util":function(){define("exports ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../chunks/mat4 ../../../../chunks/vec2f64 ../../../../chunks/vec4f64 ../../../../chunks/vec2 ../../../../chunks/vec4".split(" "),
function(a,e,l,B,d,f,u,b){function p(h,g){if(!h)throw g=g||"assert",h=Error(g),h.stack&&console.log(h.stack),new y(g);}function q(h,g){h[12]=g[0];h[13]=g[1];h[14]=g[2]}function r(h,g=0){let k=0;for(let n=0;4>n;n++)k+=h[g+n]*c[n];return k}function v(h){return h-Math.floor(h)}const D=f.create();let y=function(){function h(g){this.message=g}h.prototype.toString=function(){return`AssertException: ${this.message}`};return h}();const x=[1,256,65536,16777216],c=[1/256,1/65536,1/16777216,1/4294967296],m=
r(new Uint8ClampedArray([255,255,255,255]));a.AssertException=y;a.assert=p;a.createTranslationMatrix=function(h,g){h=B.identity(h);q(h,g);return h};a.dec2hex=function(h){h=h.toString(16);return"00000000".substr(0,8-h.length)+h};a.encodeInt16=function(h){return e.clamp(Math.round(32767*h),-32767,32767)};a.encodeNormal=function(h,g){const k=Math.abs(h[0]),n=Math.abs(h[1]),G=1/(k+n+Math.abs(h[2])),C=Math.min(h[2]*G,0);g[0]=(0>h[0]?-1:1)*(k*G-C);g[1]=(0>h[1]?-1:1)*(n*G-C)};a.fallbackIfUndefined=function(h,
g){return void 0===h?g:h};a.fovd2fovx=function(h,g,k){return 2*Math.atan(g*Math.tan(.5*h)/Math.sqrt(g*g+k*k))};a.fovd2fovy=function(h,g,k){return 2*Math.atan(k*Math.tan(.5*h)/Math.sqrt(g*g+k*k))};a.fovx2fovd=function(h,g,k){return 2*Math.atan(Math.sqrt(g*g+k*k)*Math.tan(.5*h)/g)};a.fovx2fovy=function(h,g,k){return 2*Math.atan(k*Math.tan(.5*h)/g)};a.fovy2fovd=function(h,g,k){return 2*Math.atan(Math.sqrt(g*g+k*k)*Math.tan(.5*h)/k)};a.fovy2fovx=function(h,g,k){return 2*Math.atan(g*Math.tan(.5*h)/k)};
a.getFirstObjectKey=function(h){for(const g in h)return g};a.getMatrixTranslation=function(h,g=l.create()){g[0]=h[12];g[1]=h[13];g[2]=h[14];return g};a.hex2rgb=function(h){h=Math.floor(h);return[(h>>16&255)/255,(h>>8&255)/255,(h&255)/255]};a.inverseProjectionInfo=function(h,g,k,n,G){0===h[11]?(n[0]=2/(g*h[0]),n[1]=2/(k*h[5]),n[2]=(1+h[12])/h[0],n[3]=(1+h[13])/h[5],u.set(G,0,1)):(n[0]=-2/(g*h[0]),n[1]=-2/(k*h[5]),n[2]=(1-h[8])/h[0],n[3]=(1-h[9])/h[5],u.set(G,1,0))};a.isTranslationMatrix=function(h){return 1===
h[0]&&0===h[1]&&0===h[2]&&0===h[3]&&0===h[4]&&1===h[5]&&0===h[6]&&0===h[7]&&0===h[8]&&0===h[9]&&1===h[10]&&0===h[11]&&1===h[15]};a.logWithBase=function(h,g){return Math.log(h)/Math.log(g)};a.objectEmpty=function(h){for(const g in h)return!1;return!0};a.packFloatRGBA=function(h,g,k=0){h=e.clamp(h,0,m);for(let n=0;4>n;n++)g[k+n]=Math.floor(256*v(h*x[n]))};a.project=function(h,g,k,n,G){G||(G=h);D[0]=h[0];D[1]=h[1];D[2]=h[2];D[3]=1;b.transformMat4(D,D,g);2<G.length&&(G[2]=-D[2]);b.transformMat4(D,D,k);
p(0!==D[3]);G[0]=D[0]/D[3];G[1]=D[1]/D[3];G[2]=D[2]/D[3];G[0]=(.5*G[0]+.5)*n[2]+n[0];G[1]=(.5*G[1]+.5)*n[3]+n[1]};a.rayBoxTest=function(h,g,k,n){let G,C=(k[0]-h[0])/g[0],t=(n[0]-h[0])/g[0];C>t&&(G=C,C=t,t=G);let A=(k[1]-h[1])/g[1],z=(n[1]-h[1])/g[1];A>z&&(G=A,A=z,z=G);if(C>z||A>t)return!1;A>C&&(C=A);z<t&&(t=z);k=(k[2]-h[2])/g[2];h=(n[2]-h[2])/g[2];k>h&&(G=k,k=h,h=G);if(C>h||k>t)return!1;h<t&&(t=h);return 0>t?!1:!0};a.rayRay2D=function(h,g,k,n,G,C=d.create()){const t=(n[G]-k[G])*(g[0]-h[0])-(n[0]-
k[0])*(g[G]-h[G]);if(0===t)return!1;k=((n[0]-k[0])*(h[G]-k[G])-(n[G]-k[G])*(h[0]-k[0]))/t;C[0]=h[0]+k*(g[0]-h[0]);C[1]=h[G]+k*(g[G]-h[G]);return!0};a.rayTriangle3D=function(h,g,k,n,G,C,t,A,z=l.create()){var w=n[t]-k[C];const F=n[t+1]-k[C+1],E=n[t+2]-k[C+2];n=G[A]-k[C];t=G[A+1]-k[C+1];G=G[A+2]-k[C+2];const N=g[1]*G-t*g[2],U=g[2]*n-G*g[0],S=g[0]*t-n*g[1];A=w*N+F*U+E*S;if(-1E-5<A&&1E-5>A)return!1;A=1/A;const I=h[0]-k[C],L=h[1]-k[C+1];h=h[2]-k[C+2];z[1]=A*(I*N+L*U+h*S);if(0>z[1]||1<z[1])return!1;k=L*
E-F*h;h=h*w-E*I;w=I*F-w*L;z[2]=A*(g[0]*k+g[1]*h+g[2]*w);if(0>z[2]||1<z[1]+z[2])return!1;z[0]=A*(n*k+t*h+G*w);return!0};a.rgb2hex=function(h){const g=e.clamp(Math.round(255*h[0]),0,255),k=e.clamp(Math.round(255*h[1]),0,255);h=e.clamp(Math.round(255*h[2]),0,255);return"0x"+((g<<16)+(k<<8)+h).toString(16)};a.setMatrixTranslation=q;a.setMatrixTranslation3=function(h,g,k,n){h[12]=g;h[13]=k;h[14]=n};a.unpackFloatRGBA=r;a.verify=function(h,g){h||console.warn("Verify failed: "+(g||"")+"\n"+Error("verify").stack)};
Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["exports","../../../../chunks/vec3f64","../../../../chunks/vec3","../../../../chunks/triangle"],function(a,e,l,B){let d=(()=>{const v=new Uint32Array(131072);for(let D=0;D<v.length;++D)v[D]=D;return v})();const f=new Uint16Array([0]),u=(()=>{const v=new Uint16Array(65536);for(let D=0;D<v.length;++D)v[D]=D;return v})(),b=e.create(),p=e.create(),q=e.create(),r=e.create();a.computeAttachmentOriginLines=
function(v,D,y,x){if(!v)return!1;const {size:c,data:m}=v;l.set(x,0,0,0);l.set(r,0,0,0);let h=v=0;const g=D?D.length-1:m.length/c-1;y=g+(y?2:0);for(let G=0;G<y;G+=2){var k=G<g?G:g,n=G<g?G+1:0;k=(D?D[k]:k)*c;n=(D?D[n]:n)*c;b[0]=m[k+0];b[1]=m[k+1];b[2]=m[k+2];p[0]=m[n+0];p[1]=m[n+1];p[2]=m[n+2];l.scale(b,l.add(b,b,p),.5);n=l.dist(b,p);0<n?(l.add(x,x,l.scale(b,b,n)),v+=n):(l.add(r,r,b),h++)}return 0!==v?(l.scale(x,x,1/v),!0):0!==h?(l.scale(x,r,1/h),!0):!1};a.computeAttachmentOriginPoints=function(v,D,
y){if(!v||!D)return!1;const {size:x,data:c}=v;l.set(y,0,0,0);v=-1;let m=0;for(let h=0;h<D.length;h++){const g=D[h]*x;v!==g&&(y[0]+=c[g+0],y[1]+=c[g+1],y[2]+=c[g+2],m++);v=g}1<m&&l.scale(y,y,1/m);return 0<m};a.computeAttachmentOriginTriangles=function(v,D,y){if(!v)return!1;const {size:x,data:c}=v;l.set(y,0,0,0);l.set(r,0,0,0);let m=v=0;for(let g=0;g<D.length-2;g+=3){var h=D[g+0]*x;const k=D[g+1]*x,n=D[g+2]*x;l.set(b,c[h+0],c[h+1],c[h+2]);l.set(p,c[k+0],c[k+1],c[k+2]);l.set(q,c[n+0],c[n+1],c[n+2]);
(h=B.areaPoints3d(b,p,q))?(l.add(b,b,p),l.add(b,b,q),l.scale(b,b,1/3*h),l.add(y,y,b),v+=h):(l.add(r,r,b),l.add(r,r,p),l.add(r,r,q),m+=3)}return 0===m&&0===v?!1:0!==v?(l.scale(y,y,1/v),!0):0!==m?(l.scale(y,r,1/m),!0):!1};a.generateDefaultIndexArray=function(v){if(1===v)return f;if(v<u.length)return new Uint16Array(u.buffer,0,v);if(v>d.length){d=new Uint32Array(Math.max(2*d.length,v));for(let D=0;D<d.length;D++)d[D]=D}return new Uint32Array(d.buffer,0,v)};Object.defineProperty(a,"__esModule",{value:!0})})},
"esri/views/3d/webgl-engine/lib/Geometry":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./Util ./BoundingInfo ./ContentObject ./geometryDataUtils".split(" "),function(a,e,l,B,d,f,u){function b(p){if(p.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return p;for(const q of p)if(65536<=q)return p;return new Uint16Array(p)}f=function(p){function q(v,D=[],y=0,x=-1){var c=p.call(this)||this;c._primitiveType=y;c.edgeIndicesLength=x;c.type=2;c._vertexAttributes=
new Map;c._indices=new Map;c._boundingInfo=null;for(const [m,h]of v)h&&c._vertexAttributes.set(m,{...h});if(null==D||0===D.length){v=c._vertexAttributes.values().next().value;v=null==v?0:v.data.length/v.size;D=u.generateDefaultIndexArray(v);c.edgeIndicesLength=0>c.edgeIndicesLength?v:c.edgeIndicesLength;for(const m of c._vertexAttributes.keys())c._indices.set(m,D)}else for(const [m,h]of D)h&&(c._indices.set(m,b(h)),"position"===m&&(c.edgeIndicesLength=0>c.edgeIndicesLength?c._indices.get(m).length:
c.edgeIndicesLength));return c}e._inheritsLoose(q,p);var r=q.prototype;r.getMutableAttribute=function(v){(v=this._vertexAttributes.get(v))&&!v.exclusive&&(v.data=Array.from(v.data),v.exclusive=!0);return v};r.computeAttachmentOrigin=function(v){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(v):this.computeAttachmentOriginPoints(v)};r.computeAttachmentOriginTriangles=function(v){const D=this.indices.get("position"),y=this.vertexAttributes.get("position");return u.computeAttachmentOriginTriangles(y,
D,v)};r.computeAttachmentOriginPoints=function(v){const D=this.indices.get("position"),y=this.vertexAttributes.get("position");return u.computeAttachmentOriginPoints(y,D,v)};r.invalidateBoundingInfo=function(){this._boundingInfo=null};r._calculateBoundingInfo=function(){const v=this.indices.get("position");if(0===v.length)return null;const D=0===this.primitiveType?3:1;B.assert(0===v.length%D,"Indexing error: "+v.length+" not divisible by "+D);const y=u.generateDefaultIndexArray(v.length/D),x=this.vertexAttributes.get("position");
return new d.BoundingInfo(y,D,v,x)};e._createClass(q,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",get:function(){const v=this._indices.values().next().value;return v?v.length:0}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){l.isNone(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo());
return this._boundingInfo}}]);return q}(f.ContentObject);a.Geometry=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["exports","../../../../core/PooledArray","../../../../chunks/vec3f64","../../../../chunks/vec3","./Util"],function(a,e,l,B,d){let f=function(){function b(q,r,v,D){this.primitiveIndices=q;this._numIndexPerPrimitive=r;this.indices=v;this.position=D;this.center=l.create();d.assert(1<=q.length);d.assert(0===v.length%
this._numIndexPerPrimitive);d.assert(v.length>=q.length*this._numIndexPerPrimitive);d.assert(3===D.size||4===D.size);const {data:y,size:x}=D;D=q.length;r=x*v[this._numIndexPerPrimitive*q[0]];u.clear();u.push(r);this.bbMin=l.fromValues(y[r],y[r+1],y[r+2]);this.bbMax=l.clone(this.bbMin);for(var c=0;c<D;++c){var m=this._numIndexPerPrimitive*q[c];for(var h=0;h<this._numIndexPerPrimitive;++h){r=x*v[m+h];u.push(r);let g=y[r];this.bbMin[0]=Math.min(g,this.bbMin[0]);this.bbMax[0]=Math.max(g,this.bbMax[0]);
g=y[r+1];this.bbMin[1]=Math.min(g,this.bbMin[1]);this.bbMax[1]=Math.max(g,this.bbMax[1]);g=y[r+2];this.bbMin[2]=Math.min(g,this.bbMin[2]);this.bbMax[2]=Math.max(g,this.bbMax[2])}}B.lerp(this.center,this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);q=this.radius*this.radius;for(v=0;v<u.length;++v)r=u.getItemAt(v),D=y[r]-this.center[0],c=y[r+1]-this.center[1],r=y[r+2]-this.center[2],m=D*D+c*c+r*r,m<=q||(m=
Math.sqrt(m),h=.5*(m-this.radius),this.radius+=h,q=this.radius*this.radius,m=h/m,this.center[0]+=D*m,this.center[1]+=c*m,this.center[2]+=r*m);u.clear()}var p=b.prototype;p.getCenter=function(){return this.center};p.getBSRadius=function(){return this.radius};p.getBBMin=function(){return this.bbMin};p.getBBMax=function(){return this.bbMax};p.getChildren=function(){if(this._children)return this._children;if(1<B.squaredDistance(this.bbMin,this.bbMax)){var q=B.lerp(l.create(),this.bbMin,this.bbMax,.5),
r=this.primitiveIndices.length;const x=new Uint8Array(r),c=Array(8);for(var v=0;8>v;++v)c[v]=0;const {data:m,size:h}=this.position;for(v=0;v<r;++v){var D=0;const g=this._numIndexPerPrimitive*this.primitiveIndices[v];var y=h*this.indices[g];let k=m[y],n=m[y+1],G=m[y+2];for(let C=1;C<this._numIndexPerPrimitive;++C){y=h*this.indices[g+C];const t=m[y],A=m[y+1];y=m[y+2];t<k&&(k=t);A<n&&(n=A);y<G&&(G=y)}k<q[0]&&(D|=1);n<q[1]&&(D|=2);G<q[2]&&(D|=4);x[v]=D;++c[D]}q=0;for(v=0;8>v;++v)0<c[v]&&++q;if(2>q)return;
q=Array(8);for(v=0;8>v;++v)q[v]=0<c[v]?new Uint32Array(c[v]):void 0;for(v=0;8>v;++v)c[v]=0;for(v=0;v<r;++v)D=x[v],q[D][c[D]++]=this.primitiveIndices[v];this._children=Array(8);for(r=0;8>r;++r)void 0!==q[r]&&(this._children[r]=new b(q[r],this._numIndexPerPrimitive,this.indices,this.position))}return this._children};b.prune=function(){u.prune()};return b}();const u=new e({deallocator:null});a.BoundingInfo=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/ContentObject":function(){define(["exports",
"../../../../core/uid"],function(a,e){let l=function(){function B(){this.id=e.generateUID()}B.prototype.unload=function(){};return B}();a.ContentObject=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../chunks/vec2 ../../support/buffer/InterleavedLayout ../../support/geometryUtils ../lib/Util ../lib/geometryDataUtils ./renderers/utils ../lib/GLMaterial ../lib/Material ./VisualVariableMaterialParameters ../shaders/RibbonLineTechnique".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h){function g(oa,ua,H,J,aa){for(let fa=0;fa<aa;fa++)H[J++]=oa[ua++];return J}function k(oa,ua,H){ua=ua.get("position").data;H=H?H.get("position"):null;return oa.isClosed?H?2<H.length:6<ua.length:!1}const n=B.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");B=function(oa){function ua(J){J=oa.call(this,J,C)||this;J._vertexAttributeLocations=h.ribbonVertexAttributeLocations;J.techniqueConfig=new h.RibbonLineTechniqueConfiguration;J.layout=
J.createLayout();return J}e._inheritsLoose(ua,oa);var H=ua.prototype;H.isClosed=function(J,aa){return this.params.isClosed?aa?2<aa.length:6<J.length:!1};H.dispose=function(){};H.getPassParameters=function(){return this.params};H.getTechniqueConfig=function(J,aa){this.techniqueConfig.output=J;J=l.isSome(this.params.stipplePattern);this.techniqueConfig.stippleEnabled=J;this.techniqueConfig.stippleIntegerRepeatsEnabled=J&&this.params.stippleIntegerRepeats;this.techniqueConfig.stippleOffColorEnabled=
J&&l.isSome(this.params.stippleOffColor);this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.roundJoins="round"===this.params.join;this.techniqueConfig.roundCaps="round"===this.params.cap;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.vvColor=this.params.vvColorEnabled;
this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.innerColorEnabled=0<this.params.innerWidth&&l.isSome(this.params.innerColor);this.techniqueConfig.falloffEnabled=0<this.params.falloff;this.techniqueConfig.occluder=8===this.params.renderOccluded;this.techniqueConfig.transparencyPassType=aa?aa.transparencyPassType:3;this.techniqueConfig.multipassTerrainEnabled=aa?aa.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=
aa?aa.cullAboveGround:!0;return this.techniqueConfig};H.intersect=function(J,aa,fa,ja,la,da,ka,Z,ia){ia?this.intersectDrapedLineGeometry(J,ja,da,ka):this.intersectLineGeometry(J,aa,fa,ja,this.params.width,ka)};H.intersectDrapedLineGeometry=function(J,aa,fa,ja){if(aa.options.selectionMode){aa=J.vertexAttributes.get("position").data;var la=J.vertexAttributes.get("size"),da=this.params.width;this.params.vvSizeEnabled?(la=J.vertexAttributes.get("sizeFeatureAttribute").data[0],da*=d.clamp(this.params.vvSizeOffset[0]+
la*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])):la&&(da*=la.data[0]);la=fa[0];fa=fa[1];J=(da/2+4)*J.screenToWorldRatio;da=Number.MAX_VALUE;for(let O=0;O<aa.length-5;O+=3){var ka=aa[O],Z=aa[O+1],ia=la-ka,ha=fa-Z;ka=aa[O+3]-ka;Z=aa[O+4]-Z;const ca=d.clamp((ka*ia+Z*ha)/(ka*ka+Z*Z),0,1);ia=ka*ca-ia;ha=Z*ca-ha;ha=ia*ia+ha*ha;ha<da&&(da=ha)}da<J*J&&ja()}};H.intersectLineGeometry=function(J,aa,fa,ja,la,da){if(ja.options.selectionMode&&!y.isInstanceHidden(aa))if(v.isTranslationMatrix(fa)){var ka=
J.vertexAttributes;aa=ka.get("position").data;if(this.params.vvSizeEnabled){var Z=ka.get("sizeFeatureAttribute").data[0];la*=d.clamp(this.params.vvSizeOffset[0]+Z*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else ka.has("size")&&(la*=ka.get("size").data[0]);Z=ja.camera;var ia=E;p.copy(ia,ja.point);la=la*Z.pixelRatio/2+4*Z.pixelRatio;b.set(R[0],ia[0]-la,ia[1]+la,0);b.set(R[1],ia[0]+la,ia[1]+la,0);b.set(R[2],ia[0]+la,ia[1]-la,0);b.set(R[3],ia[0]-la,ia[1]-la,
0);for(var ha=0;4>ha;ha++)if(!Z.unprojectFromRenderScreen(R[ha],Y[ha]))return;r.plane.fromPoints(Z.eye,Y[0],Y[1],T);r.plane.fromPoints(Z.eye,Y[1],Y[2],V);r.plane.fromPoints(Z.eye,Y[2],Y[3],W);r.plane.fromPoints(Z.eye,Y[3],Y[0],X);ha=Number.MAX_VALUE;J=k(this.params,ka,J.indices)?aa.length-2:aa.length-5;for(ka=0;ka<J;ka+=3){A[0]=aa[ka]+fa[12];A[1]=aa[ka+1]+fa[13];A[2]=aa[ka+2]+fa[14];var O=(ka+3)%aa.length;z[0]=aa[O]+fa[12];z[1]=aa[O+1]+fa[13];z[2]=aa[O+2]+fa[14];if(!(0>r.plane.signedDistance(T,A)&&
0>r.plane.signedDistance(T,z)||0>r.plane.signedDistance(V,A)&&0>r.plane.signedDistance(V,z)||0>r.plane.signedDistance(W,A)&&0>r.plane.signedDistance(W,z)||0>r.plane.signedDistance(X,A)&&0>r.plane.signedDistance(X,z))){Z.projectToRenderScreen(A,N);Z.projectToRenderScreen(z,U);if(0>N[2]&&0<U[2])b.subtract(w,A,z),O=Z.frustum,O=-r.plane.signedDistance(O[4],A)/b.dot(w,r.plane.normal(O[4])),b.scale(w,w,O),b.add(A,A,w),Z.projectToRenderScreen(A,N);else if(0<N[2]&&0>U[2])b.subtract(w,z,A),O=Z.frustum,O=-r.plane.signedDistance(O[4],
z)/b.dot(w,r.plane.normal(O[4])),b.scale(w,w,O),b.add(z,z,w),Z.projectToRenderScreen(z,U);else if(0>N[2]&&0>U[2])continue;N[2]=0;U[2]=0;O=r.lineSegment.distance2(r.lineSegment.fromPoints(N,U,L),ia);O<ha&&(ha=O,b.copy(S,A),b.copy(I,z))}}fa=ja.rayBeginPoint;ja=ja.rayEndPoint;ha<la*la&&(aa=Number.MAX_VALUE,r.lineSegment.closestLineSegmentPoint(r.lineSegment.fromPoints(S,I,L),r.lineSegment.fromPoints(fa,ja,M),F)&&(b.subtract(F,F,fa),aa=b.length(F),b.scale(F,F,1/aa),aa/=b.distance(fa,ja)),da(aa,F))}else n.error("intersection assumes a translation-only matrix")};
H.computeAttachmentOrigin=function(J,aa){const fa=J.vertexAttributes;if(!fa)return null;J=J.indices;const ja=fa.get("position");return D.computeAttachmentOriginLines(ja,J?J.get("position"):null,J&&k(this.params,fa,J),aa)};H.createLayout=function(){const J=q.newLayout().vec3f("position").f32("subdivisionFactor").vec2f("uv0").vec3f("auxpos1").vec3f("auxpos2");this.params.vvSizeEnabled?J.f32("sizeFeatureAttribute"):J.f32("size");this.params.vvColorEnabled?J.f32("colorFeatureAttribute"):J.vec4f("color");
this.params.vvOpacityEnabled&&J.f32("opacityFeatureAttribute");return J};H.createBufferWriter=function(){return new t(this.layout,this.params)};H.getGLMaterial=function(J){return 0===J.output||7===J.output||4===J.output||1===J.output?new G(J):void 0};H.validateParameterValues=function(J){"miter"!==J.join&&(J.miterLimit=0);this.requiresTransparent(J)&&(J.transparent=!0)};H.requiresTransparent=function(J){return!!(1>(J.color&&J.color[3])||0<J.innerWidth&&this.colorRequiresTransparent(J.innerColor)||
J.stipplePattern&&this.colorRequiresTransparent(J.stippleOffColor)||0<J.falloff)};H.colorRequiresTransparent=function(J){return l.isSome(J)&&1>J[3]&&0<J[3]};return ua}(c.Material);let G=function(oa){function ua(J){J=oa.call(this,J)||this;J.updateParameters();return J}e._inheritsLoose(ua,oa);var H=ua.prototype;H.updateParameters=function(J){this.technique=this.techniqueRep.acquireAndReleaseExisting(h.RibbonLineTechnique,this.material.getTechniqueConfig(this.output,J),this.technique)};H.beginSlot=function(J){return this.technique.configuration.occluder?
3===J||10===J||11===J:0===this.output||7===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,J===this.targetSlot):3===J};H._updateOccludeeState=function(J){J.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:J.hasOccludees})};H.ensureParameters=function(J){0!==this.output&&7!==this.output||this._updateOccludeeState(J);this.updateParameters(J)};H.bind=function(J,aa){J.bindProgram(this.technique.program);this.technique.bindPass(J,
this.material.getPassParameters(),aa)};H.getPipelineState=function(J,aa){return this.technique.getPipelineState(J,aa)};return ua}(x);const C={width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1,...c.materialParametersDefaults,...m.Default};let t=function(){function oa(H,J){this.params=
J;this.numJoinSubdivisions=0;this.vertexBufferLayout=H;switch(this.params.join){case "miter":case "bevel":this.numJoinSubdivisions=J.stipplePattern?1:0;break;case "round":this.numJoinSubdivisions=1}}var ua=oa.prototype;ua.isClosed=function(H){return k(this.params,H.vertexAttributes,H.indices)};ua.numCapSubdivisions=function(H){if(this.isClosed(H))return 0;switch(this.params.cap){case "butt":return 0;case "square":return 1;case "round":return 3}};ua.allocate=function(H){return this.vertexBufferLayout.createBuffer(H)};
ua.elementCount=function(H){var J=2*this.numCapSubdivisions(H)+2,aa=H.indices.get("position").length/2+1;const fa=this.isClosed(H);J=fa?2:2*J;var ja=fa?0:1;aa=fa?aa:aa-1;if(H.vertexAttributes.has("subdivisions"))for(H=H.vertexAttributes.get("subdivisions").data;ja<aa;++ja)J+=4+2*H[ja];else J+=(aa-ja)*(2*this.numJoinSubdivisions+4);return J+2};ua.write=function(H,J,aa,fa){const ja=K,la=P,da=Q;var ka=J.vertexAttributes.get("position").data,Z=J.indices&&J.indices.get("position");const ia=this.numCapSubdivisions(J);
Z&&Z.length!==2*(ka.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");Z=null;J.vertexAttributes.has("subdivisions")&&(Z=J.vertexAttributes.get("subdivisions").data);let ha=1,O=0;this.params.vvSizeEnabled?O=J.vertexAttributes.get("sizeFeatureAttribute").data[0]:J.vertexAttributes.has("size")&&(ha=J.vertexAttributes.get("size").data[0]);let ca=[1,1,1,1],ea=0;this.params.vvColorEnabled?ea=J.vertexAttributes.get("colorFeatureAttribute").data[0]:J.vertexAttributes.has("color")&&
(ca=J.vertexAttributes.get("color").data);let ba=0;this.params.vvOpacityEnabled&&(ba=J.vertexAttributes.get("opacityFeatureAttribute").data[0]);const qa=ka.length/3;H=H.transformation;const na=new Float32Array(aa.buffer);aa=this.vertexBufferLayout.stride/4;let sa=fa*aa;fa=sa;const wa=(za,Ba,Ea,Ha,Oa,Pa,Ja)=>{na[sa++]=Ba[0];na[sa++]=Ba[1];na[sa++]=Ba[2];na[sa++]=Ha;na[sa++]=Oa;na[sa++]=Pa;na[sa++]=za[0];na[sa++]=za[1];na[sa++]=za[2];na[sa++]=Ea[0];na[sa++]=Ea[1];na[sa++]=Ea[2];this.params.vvSizeEnabled?
na[sa++]=O:na[sa++]=ha;this.params.vvColorEnabled?na[sa++]=ea:(za=Math.min(4*Ja,ca.length-4),na[sa++]=ca[za+0],na[sa++]=ca[za+1],na[sa++]=ca[za+2],na[sa++]=ca[za+3]);this.params.vvOpacityEnabled&&(na[sa++]=ba)};sa+=aa;b.set(la,ka[0],ka[1],ka[2]);H&&b.transformMat4(la,la,H);if(J=this.isClosed(J)){var ra=ka.length-3;b.set(ja,ka[ra],ka[ra+1],ka[ra+2]);H&&b.transformMat4(ja,ja,H)}else{b.copy(ja,la);b.set(da,ka[3],ka[4],ka[5]);H&&b.transformMat4(da,da,H);for(ra=0;ra<ia;++ra){var xa=1-ra/ia;wa(ja,la,da,
xa,1,-4,0);wa(ja,la,da,xa,1,4,0)}wa(ja,la,da,0,0,-4,0);wa(ja,la,da,0,0,4,0);b.copy(ja,la);b.copy(la,da)}xa=J?0:1;for(ra=J?qa:qa-1;xa<ra;xa++){var va=(xa+1)%qa*3;b.set(da,ka[va+0],ka[va+1],ka[va+2]);H&&b.transformMat4(da,da,H);wa(ja,la,da,0,1,-1,xa);wa(ja,la,da,0,1,1,xa);va=Z?Z[xa]:this.numJoinSubdivisions;for(let za=0;za<va;++za){const Ba=(za+1)/(va+1);wa(ja,la,da,Ba,1,-2,xa);wa(ja,la,da,Ba,1,2,xa)}wa(ja,la,da,1,0,-2,xa);wa(ja,la,da,1,0,2,xa);b.copy(ja,la);b.copy(la,da)}if(J)sa=g(na,fa+aa,na,sa,2*
aa);else for(wa(ja,la,da,0,1,-5,ra),wa(ja,la,da,0,1,5,ra),ka=0;ka<ia;++ka)Z=(ka+1)/ia,wa(ja,la,da,Z,1,-5,ra),wa(ja,la,da,Z,1,5,ra);g(na,fa+aa,na,fa,aa);sa=g(na,sa-aa,na,sa,aa)};return oa}();const A=u.create(),z=u.create(),w=u.create(),F=u.create(),E=u.create(),N=f.createRenderScreenPointArray3(),U=f.createRenderScreenPointArray3(),S=u.create(),I=u.create(),L=r.lineSegment.create(),M=r.lineSegment.create(),K=u.create(),P=u.create(),Q=u.create(),R=[f.createRenderScreenPointArray3(),f.createRenderScreenPointArray3(),
f.createRenderScreenPointArray3(),f.createRenderScreenPointArray3()],Y=[u.create(),u.create(),u.create(),u.create()],T=r.plane.create(),V=r.plane.create(),W=r.plane.create(),X=r.plane.create();a.RibbonLineMaterial=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/InterleavedLayout":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./BufferView","./types"],function(a,e,l,B){let d=function(){function u(p,q){this.layout=p;this.buffer="number"===
typeof q?new ArrayBuffer(q*p.stride):q;for(const r of p.fieldNames)q=p.fields.get(r),this[r]=new q.constructor(this.buffer,q.offset,this.stride)}var b=u.prototype;b.getField=function(p,q){return(p=this[p])&&p.elementCount===q.ElementCount&&p.elementType===q.ElementType?p:null};b.slice=function(p,q){return new u(this.layout,this.buffer.slice(p*this.stride,q*this.stride))};b.copyFrom=function(p,q,r,v){const D=this.stride;0===D%4?(p=new Uint32Array(p.buffer,q*D,v*D/4),(new Uint32Array(this.buffer,r*
D,v*D/4)).set(p)):(p=new Uint8Array(p.buffer,q*D,v*D),(new Uint8Array(this.buffer,r*D,v*D)).set(p))};e._createClass(u,[{key:"stride",get:function(){return this.layout.stride}},{key:"count",get:function(){return this.buffer.byteLength/this.stride}},{key:"byteLength",get:function(){return this.buffer.byteLength}}]);return u}(),f=function(){function u(){this.stride=0;this.fields=new Map;this.fieldNames=[]}var b=u.prototype;b.vec2f=function(p,q){this.appendField(p,l.BufferViewVec2f,q);return this};b.vec2f64=
function(p,q){this.appendField(p,l.BufferViewVec2f64,q);return this};b.vec3f=function(p,q){this.appendField(p,l.BufferViewVec3f,q);return this};b.vec3f64=function(p,q){this.appendField(p,l.BufferViewVec3f64,q);return this};b.vec4f=function(p,q){this.appendField(p,l.BufferViewVec4f,q);return this};b.vec4f64=function(p,q){this.appendField(p,l.BufferViewVec4f64,q);return this};b.mat3f=function(p,q){this.appendField(p,l.BufferViewMat3f,q);return this};b.mat3f64=function(p,q){this.appendField(p,l.BufferViewMat3f64,
q);return this};b.mat4f=function(p,q){this.appendField(p,l.BufferViewMat4f,q);return this};b.mat4f64=function(p,q){this.appendField(p,l.BufferViewMat4f64,q);return this};b.vec4u8=function(p,q){this.appendField(p,l.BufferViewVec4u8,q);return this};b.f32=function(p,q){this.appendField(p,l.BufferViewFloat,q);return this};b.f64=function(p,q){this.appendField(p,l.BufferViewFloat64,q);return this};b.u8=function(p,q){this.appendField(p,l.BufferViewUint8,q);return this};b.u16=function(p,q){this.appendField(p,
l.BufferViewUint16,q);return this};b.i8=function(p,q){this.appendField(p,l.BufferViewInt8,q);return this};b.vec2i8=function(p,q){this.appendField(p,l.BufferViewVec2i8,q);return this};b.vec2i16=function(p,q){this.appendField(p,l.BufferViewVec2i16,q);return this};b.vec2u8=function(p,q){this.appendField(p,l.BufferViewVec2u8,q);return this};b.vec4u16=function(p,q){this.appendField(p,l.BufferViewVec4u16,q);return this};b.u32=function(p,q){this.appendField(p,l.BufferViewUint32,q);return this};b.appendField=
function(p,q,r){const v=q.ElementCount*B.elementTypeSize(q.ElementType);this.fields.set(p,{size:v,constructor:q,offset:this.stride,optional:r});this.stride+=v;this.fieldNames.push(p)};b.alignTo=function(p){this.stride=Math.floor((this.stride+p-1)/p)*p;return this};b.hasField=function(p){return 0<=this.fieldNames.indexOf(p)};b.createBuffer=function(p){return new d(this,p)};b.createView=function(p){return new d(this,p)};b.clone=function(){const p=new u;p.stride=this.stride;p.fields=new Map;this.fields.forEach((q,
r)=>p.fields.set(r,q));p.fieldNames=this.fieldNames.slice();p.BufferType=this.BufferType;return p};return u}();a.InterleavedBuffer=d;a.InterleavedLayout=f;a.newLayout=function(){return new f};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/BufferView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./internals/Mat3 ./internals/Mat4 ./internals/Scalar ./internals/Vec2 ./internals/Vec3 ./internals/Vec4".split(" "),function(a,e,l,B,d,f,u,b){let p=
function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);p.ElementType="f32";let q=function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};
return Y}(f.BufferViewVec2Impl);q.ElementType="f32";let r=function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);r.ElementType="f32";let v=function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,
T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);v.ElementType="f32";let D=function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(l.BufferViewMat3Impl);D.ElementType="f32";l=function(R){function Y(T,V=0,W,X){T=R.call(this,Float64Array,T,V,W,X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,
R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(l.BufferViewMat3Impl);l.ElementType="f64";let y=function(R){function Y(T,V=0,W,X){T=R.call(this,Float32Array,T,V,W,X)||this;T.elementType="f32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(B.BufferViewMat4Impl);y.ElementType="f32";B=function(R){function Y(T,V=0,W,X){T=R.call(this,Float64Array,T,V,W,
X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(B.BufferViewMat4Impl);B.ElementType="f64";let x=function(R){function Y(T,V=0,W,X){T=R.call(this,Float64Array,T,V,W,X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);x.ElementType="f64";let c=function(R){function Y(T,
V=0,W,X){T=R.call(this,Float64Array,T,V,W,X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);c.ElementType="f64";let m=function(R){function Y(T,V=0,W,X){T=R.call(this,Float64Array,T,V,W,X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);
m.ElementType="f64";let h=function(R){function Y(T,V=0,W,X){T=R.call(this,Float64Array,T,V,W,X)||this;T.elementType="f64";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);h.ElementType="f64";let g=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint8Array,T,V,W,X)||this;T.elementType="u8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+
T.byteLength)};return Y}(d.BufferViewScalarImpl);g.ElementType="u8";let k=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint8Array,T,V,W,X)||this;T.elementType="u8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);k.ElementType="u8";let n=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint8Array,T,V,W,X)||this;T.elementType="u8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,
V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);n.ElementType="u8";let G=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint8Array,T,V,W,X)||this;T.elementType="u8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);G.ElementType="u8";let C=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint16Array,T,V,W,X)||this;T.elementType="u16";return T}
e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);C.ElementType="u16";let t=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint16Array,T,V,W,X)||this;T.elementType="u16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);t.ElementType="u16";let A=function(R){function Y(T,V=0,W,X){T=R.call(this,
Uint16Array,T,V,W,X)||this;T.elementType="u16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);A.ElementType="u16";let z=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint16Array,T,V,W,X)||this;T.elementType="u16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);z.ElementType="u16";
let w=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint32Array,T,V,W,X)||this;T.elementType="u32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);w.ElementType="u32";let F=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint32Array,T,V,W,X)||this;T.elementType="u32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};
return Y}(f.BufferViewVec2Impl);F.ElementType="u32";let E=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint32Array,T,V,W,X)||this;T.elementType="u32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);E.ElementType="u32";let N=function(R){function Y(T,V=0,W,X){T=R.call(this,Uint32Array,T,V,W,X)||this;T.elementType="u32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,
T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);N.ElementType="u32";let U=function(R){function Y(T,V=0,W,X){T=R.call(this,Int8Array,T,V,W,X)||this;T.elementType="i8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);U.ElementType="i8";let S=function(R){function Y(T,V=0,W,X){T=R.call(this,Int8Array,T,V,W,X)||this;T.elementType="i8";return T}e._inheritsLoose(Y,R);
Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);S.ElementType="i8";let I=function(R){function Y(T,V=0,W,X){T=R.call(this,Int8Array,T,V,W,X)||this;T.elementType="i8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);I.ElementType="i8";let L=function(R){function Y(T,V=0,W,X){T=R.call(this,Int8Array,T,V,W,X)||this;
T.elementType="i8";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);L.ElementType="i8";let M=function(R){function Y(T,V=0,W,X){T=R.call(this,Int16Array,T,V,W,X)||this;T.elementType="i16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(d.BufferViewScalarImpl);M.ElementType="i16";let K=function(R){function Y(T,
V=0,W,X){T=R.call(this,Int16Array,T,V,W,X)||this;T.elementType="i16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);K.ElementType="i16";let P=function(R){function Y(T,V=0,W,X){T=R.call(this,Int16Array,T,V,W,X)||this;T.elementType="i16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);
P.ElementType="i16";let Q=function(R){function Y(T,V=0,W,X){T=R.call(this,Int16Array,T,V,W,X)||this;T.elementType="i16";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);Q.ElementType="i16";d=function(R){function Y(T,V=0,W,X){T=R.call(this,Int32Array,T,V,W,X)||this;T.elementType="i32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+
T.byteLength)};return Y}(d.BufferViewScalarImpl);d.ElementType="i32";f=function(R){function Y(T,V=0,W,X){T=R.call(this,Int32Array,T,V,W,X)||this;T.elementType="i32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(f.BufferViewVec2Impl);f.ElementType="i32";u=function(R){function Y(T,V=0,W,X){T=R.call(this,Int32Array,T,V,W,X)||this;T.elementType="i32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,
T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(u.BufferViewVec3Impl);u.ElementType="i32";b=function(R){function Y(T,V=0,W,X){T=R.call(this,Int32Array,T,V,W,X)||this;T.elementType="i32";return T}e._inheritsLoose(Y,R);Y.fromTypedArray=function(T,V){return new Y(T.buffer,T.byteOffset,V,T.byteOffset+T.byteLength)};return Y}(b.BufferViewVec4Impl);b.ElementType="i32";a.BufferViewFloat=p;a.BufferViewFloat64=x;a.BufferViewInt16=M;a.BufferViewInt32=d;a.BufferViewInt8=U;a.BufferViewMat3f=D;a.BufferViewMat3f64=
l;a.BufferViewMat4f=y;a.BufferViewMat4f64=B;a.BufferViewUint16=C;a.BufferViewUint32=w;a.BufferViewUint8=g;a.BufferViewVec2f=q;a.BufferViewVec2f64=c;a.BufferViewVec2i16=K;a.BufferViewVec2i32=f;a.BufferViewVec2i8=S;a.BufferViewVec2u16=t;a.BufferViewVec2u32=F;a.BufferViewVec2u8=k;a.BufferViewVec3f=r;a.BufferViewVec3f64=m;a.BufferViewVec3i16=P;a.BufferViewVec3i32=u;a.BufferViewVec3i8=I;a.BufferViewVec3u16=A;a.BufferViewVec3u32=E;a.BufferViewVec3u8=n;a.BufferViewVec4f=v;a.BufferViewVec4f64=h;a.BufferViewVec4i16=
Q;a.BufferViewVec4i32=b;a.BufferViewVec4i8=L;a.BufferViewVec4u16=z;a.BufferViewVec4u32=N;a.BufferViewVec4u8=G;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Mat3":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(f,u,b=0,p,q){this.TypedArrayConstructor=f;this.elementCount=9;f=this.TypedArrayConstructor;void 0===p&&(p=9*f.BYTES_PER_ELEMENT);const r=0===u.byteLength?0:b;this.typedBuffer=
null==q?new f(u,r):new f(u,r,(q-b)/f.BYTES_PER_ELEMENT);this.typedBufferStride=p/f.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var d=B.prototype;d.getMat=function(f,u){f*=this.typedBufferStride;for(let b=0;9>b;b++)u[b]=this.typedBuffer[f+b];return u};d.setMat=function(f,u){f*=this.typedBufferStride;for(let b=0;9>b;b++)this.typedBuffer[f+b]=u[b]};d.get=function(f,u){return this.typedBuffer[f*
this.typedBufferStride+u]};d.set=function(f,u,b){this.typedBuffer[f*this.typedBufferStride+u]=b};d.copyFrom=function(f,u,b){const p=this.typedBuffer,q=u.typedBuffer;f*=this.typedBufferStride;u=b*u.typedBufferStride;for(b=0;9>b;++b)p[f+b]=q[u+b]};e._createClass(B,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return B}();l.ElementCount=9;a.BufferViewMat3Impl=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Mat4":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(f,u,b=0,p,q){this.TypedArrayConstructor=f;this.elementCount=16;f=this.TypedArrayConstructor;void 0===p&&(p=16*f.BYTES_PER_ELEMENT);const r=0===u.byteLength?0:b;this.typedBuffer=null==q?new f(u,r):new f(u,r,(q-b)/f.BYTES_PER_ELEMENT);this.typedBufferStride=p/f.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
var d=B.prototype;d.getMat=function(f,u){f*=this.typedBufferStride;for(let b=0;16>b;b++)u[b]=this.typedBuffer[f+b];return u};d.setMat=function(f,u){f*=this.typedBufferStride;for(let b=0;16>b;b++)this.typedBuffer[f+b]=u[b]};d.get=function(f,u){return this.typedBuffer[f*this.typedBufferStride+u]};d.set=function(f,u,b){this.typedBuffer[f*this.typedBufferStride+u]=b};d.copyFrom=function(f,u,b){const p=this.typedBuffer,q=u.typedBuffer;f*=this.typedBufferStride;u=b*u.typedBufferStride;for(b=0;16>b;++b)p[f+
b]=q[u+b]};e._createClass(B,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return B}();l.ElementCount=16;a.BufferViewMat4Impl=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Scalar":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(f,u,b=0,p,q){this.TypedArrayConstructor=f;this.elementCount=1;f=this.TypedArrayConstructor;void 0===p&&(p=f.BYTES_PER_ELEMENT);const r=
0===u.byteLength?0:b;this.typedBuffer=null==q?new f(u,r):new f(u,r,(q-b)/f.BYTES_PER_ELEMENT);this.typedBufferStride=p/f.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var d=B.prototype;d.get=function(f){return this.typedBuffer[f*this.typedBufferStride]};d.set=function(f,u){this.typedBuffer[f*this.typedBufferStride]=u};e._createClass(B,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);
return B}();l.ElementCount=1;a.BufferViewScalarImpl=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Vec2":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2"],function(a,e,l){let B=function(){function d(u,b,p=0,q,r){this.TypedArrayConstructor=u;this.elementCount=2;u=this.TypedArrayConstructor;void 0===q&&(q=2*u.BYTES_PER_ELEMENT);const v=0===b.byteLength?0:p;this.typedBuffer=null==r?new u(b,v):new u(b,
v,(r-p)/u.BYTES_PER_ELEMENT);this.typedBufferStride=q/u.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var f=d.prototype;f.getVec=function(u,b){return l.set(b,this.typedBuffer[u*this.typedBufferStride],this.typedBuffer[u*this.typedBufferStride+1])};f.setVec=function(u,b){this.typedBuffer[u*this.typedBufferStride]=b[0];this.typedBuffer[u*this.typedBufferStride+1]=b[1]};f.get=function(u,
b){return this.typedBuffer[u*this.typedBufferStride+b]};f.set=function(u,b,p){this.typedBuffer[u*this.typedBufferStride+b]=p};f.setValues=function(u,b,p){this.typedBuffer[u*this.typedBufferStride]=b;this.typedBuffer[u*this.typedBufferStride+1]=p};f.copyFrom=function(u,b,p){const q=this.typedBuffer,r=b.typedBuffer;u*=this.typedBufferStride;b=p*b.typedBufferStride;q[u]=r[b];q[u+1]=r[b+1]};e._createClass(d,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return d}();B.ElementCount=2;
a.BufferViewVec2Impl=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Vec3":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec3"],function(a,e,l){let B=function(){function d(u,b,p=0,q,r){this.TypedArrayConstructor=u;this.elementCount=3;u=this.TypedArrayConstructor;void 0===q&&(q=3*u.BYTES_PER_ELEMENT);const v=0===b.byteLength?0:p;this.typedBuffer=null==r?new u(b,v):new u(b,v,(r-p)/u.BYTES_PER_ELEMENT);
this.typedBufferStride=q/u.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var f=d.prototype;f.getVec=function(u,b){return l.set(b,this.typedBuffer[u*this.typedBufferStride],this.typedBuffer[u*this.typedBufferStride+1],this.typedBuffer[u*this.typedBufferStride+2])};f.setVec=function(u,b){this.typedBuffer[u*this.typedBufferStride]=b[0];this.typedBuffer[u*this.typedBufferStride+1]=
b[1];this.typedBuffer[u*this.typedBufferStride+2]=b[2]};f.get=function(u,b){return this.typedBuffer[u*this.typedBufferStride+b]};f.set=function(u,b,p){this.typedBuffer[u*this.typedBufferStride+b]=p};f.setValues=function(u,b,p,q){this.typedBuffer[u*this.typedBufferStride]=b;this.typedBuffer[u*this.typedBufferStride+1]=p;this.typedBuffer[u*this.typedBufferStride+2]=q};f.copyFrom=function(u,b,p){const q=this.typedBuffer,r=b.typedBuffer;u*=this.typedBufferStride;b=p*b.typedBufferStride;q[u]=r[b];q[u+
1]=r[b+1];q[u+2]=r[b+2]};e._createClass(d,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return d}();B.ElementCount=3;a.BufferViewVec3Impl=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/internals/Vec4":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec4"],function(a,e,l){let B=function(){function d(u,b,p=0,q,r){this.TypedArrayConstructor=u;this.elementCount=4;u=this.TypedArrayConstructor;
void 0===q&&(q=4*u.BYTES_PER_ELEMENT);const v=0===b.byteLength?0:p;this.typedBuffer=null==r?new u(b,v):new u(b,v,(r-p)/u.BYTES_PER_ELEMENT);this.typedBufferStride=q/u.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var f=d.prototype;f.getVec=function(u,b){return l.set(b,this.typedBuffer[u*this.typedBufferStride],this.typedBuffer[u*this.typedBufferStride+1],this.typedBuffer[u*this.typedBufferStride+
2],this.typedBuffer[u*this.typedBufferStride+3])};f.setVec=function(u,b){this.typedBuffer[u*this.typedBufferStride]=b[0];this.typedBuffer[u*this.typedBufferStride+1]=b[1];this.typedBuffer[u*this.typedBufferStride+2]=b[2];this.typedBuffer[u*this.typedBufferStride+3]=b[3]};f.get=function(u,b){return this.typedBuffer[u*this.typedBufferStride+b]};f.set=function(u,b,p){this.typedBuffer[u*this.typedBufferStride+b]=p};f.setValues=function(u,b,p,q,r){this.typedBuffer[u*this.typedBufferStride]=b;this.typedBuffer[u*
this.typedBufferStride+1]=p;this.typedBuffer[u*this.typedBufferStride+2]=q;this.typedBuffer[u*this.typedBufferStride+3]=r};f.copyFrom=function(u,b,p){const q=this.typedBuffer,r=b.typedBuffer;u*=this.typedBufferStride;b=p*b.typedBufferStride;q[u]=r[b];q[u+1]=r[b+1];q[u+2]=r[b+2];q[u+3]=r[b+3]};e._createClass(d,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return d}();B.ElementCount=4;a.BufferViewVec4Impl=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/types":function(){define(["exports",
"../../../../core/has"],function(a,e){a.elementTypeSize=function(l){switch(l){case "u8":return 1;case "u16":return 2;case "u32":return 4;case "i8":return 1;case "i16":return 2;case "i32":return 4;case "f32":return 4;case "f64":return 8}};a.isInteger=function(l){switch(l){case "u8":case "u16":case "u32":case "i8":case "i16":case "i32":return!0;case "f32":case "f64":return!1}};a.isSigned=function(l){switch(l){case "u8":case "u16":case "u32":return!1;case "i8":case "i16":case "i32":case "f32":case "f64":return!0}};
a.maximumValue=function(l){switch(l){case "u8":return 255;case "u16":return 65535;case "u32":return 4294967295;case "i8":return 127;case "i16":return 32767;case "i32":return 2147483647;case "f32":return 3.402823E38;case "f64":return 1.79769E308}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("exports ../../../../../core/maybe ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../lib/Util ../../lib/doublePrecisionUtils".split(" "),
function(a,e,l,B,d,f){const u=new Float64Array(3),b=new Float32Array(6),p=B.create();a.acquireMaterials=function(q,r){const v=new Map;v.set(0,r.acquire(q,0));v.set(1,r.acquire(q,7));v.set(4,r.acquire(q,3));v.set(3,r.acquire(q,2));v.set(2,r.acquire(q,1));v.set(5,r.acquire(q,4));v.set(7,r.acquire(q,3));v.set(6,r.acquire(q,3));return v};a.addObject3DStateID=function(q,r){e.isNone(q)&&(q=[]);q.push(r);return q};a.calculateTransformRelToOrigin=function(q,r,v){const D=q.origin.vec3;d.setMatrixTranslation3(p,
-D[0],-D[1],-D[2]);e.isSome(q.transformation)?l.multiply(r,p,q.transformation):l.copy(r,p);v&&(l.invert(v,r),l.transpose(v,v))};a.encodeDoubleVec3=function(q,r,v,D,y){u[0]=q.get(r,0);u[1]=q.get(r,1);u[2]=q.get(r,2);f.encodeDoubleArray(u,b,3);v.set(y,0,b[0]);D.set(y,0,b[1]);v.set(y,1,b[2]);D.set(y,1,b[3]);v.set(y,2,b[4]);D.set(y,2,b[5])};a.isInstanceHidden=function(q){return e.isSome(q)?!q.visible:!1};a.releaseMaterials=function(q,r){r.release(q,0);r.release(q,7);r.release(q,3);r.release(q,2);r.release(q,
1);r.release(q,4)};a.removeObject3DStateID=function(q,r){if(e.isNone(q))return q;q=q.filter(v=>v!==r);return 0===q.length?null:q};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/doublePrecisionUtils":function(){define(["exports"],function(a){function e(d,f,u){for(let b=0;b<u;++b)f[2*b]=d[b],f[2*b+1]=d[b]-f[2*b]}const l=new Float64Array(1),B=new Float32Array(2);a.decodeDoubleArray=function(d,f,u){for(let b=0;b<u;++b)f[b]=d[2*b]+d[2*b+1]};a.encodeDouble=function(d,
f){B[0]=d;B[1]=d-B[0];f[0]=B[0];f[1]=B[1]};a.encodeDoubleArray=e;a.encodeDoubleArraySplit=function(d,f,u,b){for(let p=0;p<b;++p)l[0]=d[p],e(l,B,1),f[p]=B[0],u[p]=B[1]};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GLMaterial":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./AutoDisposable"],function(a,e){return function(l){function B(f){var u=l.call(this)||this;u.material=f.material;u.techniqueRep=f.techniqueRep;u.output=f.output;return u}
a._inheritsLoose(B,l);var d=B.prototype;d.getTechnique=function(){return this.technique};d.getPipelineState=function(f,u){return this.getTechnique().pipeline};d.ensureResources=function(f){return 2};d.ensureParameters=function(f){};return B}(e.AutoDisposable)})},"esri/views/3d/webgl-engine/lib/AutoDisposable":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){const l=d=>function(f){function u(){var b=f.apply(this,arguments)||this;b._isDisposed=!1;return b}e._inheritsLoose(u,
f);u.prototype.dispose=function(){for(const p of null!=(b=this._managedDisposables)?b:[]){var b;b=this[p];this[p]=null;b&&"function"===typeof b.dispose&&b.dispose()}this._isDisposed=!0};e._createClass(u,[{key:"isDisposed",get:function(){return this._isDisposed}}]);return u}(d);let B=function(d){function f(){return d.apply(this,arguments)||this}e._inheritsLoose(f,d);return f}(l(function(){return function(){}}()));a.AutoDisposable=B;a.AutoDisposableMixin=l;a.autoDispose=function(){return(d,f)=>{if(!d.hasOwnProperty("_managedDisposables")){var u,
b;d._managedDisposables=null!=(u=null==(b=d._managedDisposables)?void 0:b.slice())?u:[]}d._managedDisposables.unshift(f)}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Material":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./DefaultVertexAttributeLocations ./ContentObject ../materials/internal/MaterialUtil".split(" "),function(a,e,l,B,d,f){d=function(u){function b(q,r){var v=u.call(this)||this;v.type=3;v.supportsEdges=
!1;v._visible=!0;v._renderPriority=0;v._insertOrder=0;v._vertexAttributeLocations=B.Default3D;v._params=f.copyParameters(q,r);v.validateParameterValues(v._params);return v}e._inheritsLoose(b,u);var p=b.prototype;p.dispose=function(){};p.update=function(q){return!1};p.setParameterValues=function(q){f.updateParameters(this._params,q)&&(this.validateParameterValues(this._params),this.parametersChanged())};p.validateParameterValues=function(q){};p.isVisibleInPass=function(q){return!0};p.isVisible=function(){return this._visible};
p.parametersChanged=function(){l.isSome(this.materialRepository)&&this.materialRepository.materialChanged(this)};e._createClass(b,[{key:"params",get:function(){return this._params}},{key:"visible",get:function(){return this._visible},set:function(q){q!==this._visible&&(this._visible=q,this.parametersChanged())}},{key:"renderOccluded",get:function(){return this.params.renderOccluded}},{key:"renderPriority",get:function(){return this._renderPriority},set:function(q){q!==this._renderPriority&&(this._renderPriority=
q,this.parametersChanged())}},{key:"insertOrder",get:function(){return this._insertOrder},set:function(q){q!==this._insertOrder&&(this._insertOrder=q,this.parametersChanged())}},{key:"vertexAttributeLocations",get:function(){return this._vertexAttributeLocations}}]);return b}(d.ContentObject);a.Material=d;a.materialParametersDefaults={renderOccluded:1};a.materialPredicate=function(u,b){return u.isVisible()&&u.isVisibleInPass(b.pass)&&0!==(u.renderOccluded&b.renderOccludedMask)};Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["exports"],function(a){a.Default3D={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("exports ../../../../../core/maybe ../../../../../core/mathUtils ../../../../../chunks/vec3f64 ../../../../../chunks/vec3 ../../../../../geometry/support/aaBoundingBox ../../lib/Util ../renderers/utils ../../lib/screenSizePerspectiveUtils".split(" "),
function(a,e,l,B,d,f,u,b,p){function q(C,t,A,z,w,F){if(!e.isNone(C)){var E=D(t,A,g);f.setMin(h,C.getBBMin());f.setMax(h,C.getBBMax());e.isSome(w)&&w.applyToAabb(h);if(y(h,t,E,z)){const {primitiveIndices:N,indices:U,position:S}=C;E=N?N.length:U.length/3;if(1E3<E&&(C=C.getChildren(),void 0!==C)){for(E=0;8>E;++E)void 0!==C[E]&&q(C[E],t,A,z,w,F);return}r(t,A,0,E,U,S,N,w,F)}}}function r(C,t,A,z,w,F,E,N,U){if(E){var S=F.data;F=F.stride||F.size;var I=C[0],L=C[1];C=C[2];var M=t[0]-I,K=t[1]-L;for(t=t[2]-C;A<
z;++A){var P=E[A],Q=3*P,R=F*w[Q++],Y=S[R++],T=S[R++],V=S[R];R=F*w[Q++];var W=S[R++],X=S[R++],oa=S[R];R=F*w[Q];Q=S[R++];var ua=S[R++];R=S[R];e.isSome(N)&&([Y,T,V]=N.applyToVertex(Y,T,V,A),[W,X,oa]=N.applyToVertex(W,X,oa,A),[Q,ua,R]=N.applyToVertex(Q,ua,R,A));W-=Y;X-=T;oa-=V;Q-=Y;ua-=T;R-=V;var H=K*R-ua*t,J=t*Q-R*M;const fa=M*ua-Q*K;var aa=W*H+X*J+oa*fa;if(!(Math.abs(aa)<=Number.EPSILON)){Y=I-Y;T=L-T;V=C-V;H=Y*H+T*J+V*fa;if(0<aa){if(0>H||H>aa)continue}else if(0<H||H<aa)continue;J=T*oa-X*V;V=V*W-oa*
Y;T=Y*X-W*T;Y=M*J+K*V+t*T;if(0<aa){if(0>Y||H+Y>aa)continue}else if(0<Y||H+Y<aa)continue;V=(Q*J+ua*V+R*T)/aa;0<=V&&(W=v(W,X,oa,Q,ua,R,k),U(V,W,P))}}}else{E=F.data;S=F.stride||F.size;F=C[0];I=C[1];L=C[2];C=t[0]-F;M=t[1]-I;K=t[2]-L;for(let fa=A,ja=3*A;fa<z;++fa)if(Q=S*w[ja++],T=E[Q++],V=E[Q++],oa=E[Q],Q=S*w[ja++],t=E[Q++],A=E[Q++],P=E[Q],Q=S*w[ja++],W=E[Q++],X=E[Q++],Q=E[Q],e.isSome(N)&&([T,V,oa]=N.applyToVertex(T,V,oa,fa),[t,A,P]=N.applyToVertex(t,A,P,fa),[W,X,Q]=N.applyToVertex(W,X,Q,fa)),t-=T,A-=
V,P-=oa,W-=T,X-=V,Q-=oa,R=M*Q-X*K,Y=K*W-Q*C,aa=C*X-W*M,ua=t*R+A*Y+P*aa,!(Math.abs(ua)<=Number.EPSILON)){T=F-T;V=I-V;oa=L-oa;R=T*R+V*Y+oa*aa;if(0<ua){if(0>R||R>ua)continue}else if(0<R||R<ua)continue;Y=V*P-A*oa;oa=oa*t-P*T;V=T*A-t*V;T=C*Y+M*oa+K*V;if(0<ua){if(0>T||R+T>ua)continue}else if(0<T||R+T<ua)continue;oa=(W*Y+X*oa+Q*V)/ua;0<=oa&&(t=v(t,A,P,W,X,Q,k),U(oa,t,fa))}}}function v(C,t,A,z,w,F,E){d.set(n,C,t,A);d.set(G,z,w,F);d.cross(E,n,G);d.normalize(E,E);return E}function D(C,t,A){return d.set(A,1/
(t[0]-C[0]),1/(t[1]-C[1]),1/(t[2]-C[2]))}function y(C,t,A,z){return x(C,t,A,z,Infinity)}function x(C,t,A,z,w){var F=(C[0]-z-t[0])*A[0],E=(C[3]+z-t[0])*A[0];let N=Math.min(F,E);F=Math.max(F,E);E=(C[1]-z-t[1])*A[1];const U=(C[4]+z-t[1])*A[1];F=Math.min(F,Math.max(E,U));if(0>F)return!1;N=Math.max(N,Math.min(E,U));if(N>F)return!1;E=(C[2]-z-t[2])*A[2];C=(C[5]+z-t[2])*A[2];F=Math.min(F,Math.max(E,C));if(0>F)return!1;N=Math.max(N,Math.min(E,C));return N>F?!1:N<w}function c(C,t){t=t?c(t):{};for(const A in C){let z=
C[A];z&&z.forEach&&(z=m(z));null==z&&A in t||(t[A]=z)}return t}function m(C){const t=[];C.forEach(A=>t.push(A));return t}const h=f.create(),g=B.create(),k=B.create(),n=B.create(),G=B.create();a.bindScreenSizePerspective=function(C,t,A){if(C){var z=C.parameters;t.setUniform4f(A,z.divisor,z.offset,z.minPixelSize,C.paddingPixelsOverride)}};a.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};a.computeInvDir=D;a.computeNormal=v;a.copyParameters=c;a.intersectAabbInvDir=y;a.intersectAabbInvDirBefore=
x;a.intersectDrapedRenderLineGeometry=function(C,t,A,z,w){if(t.options.selectionMode){t=C.vertexAttributes.get("position").data;var F=C.vertexAttributes.get("size"),E=A[0];A=A[1];C=(((F&&F.data[0])+z)/2+4)*C.screenToWorldRatio;z=Number.MAX_VALUE;for(F=0;F<t.length-5;F+=3){var N=t[F],U=t[F+1],S=E-N,I=A-U;N=t[F+3]-N;U=t[F+4]-U;const L=l.clamp((N*S+U*I)/(N*N+U*U),0,1);S=N*L-S;I=U*L-I;I=S*S+I*I;I<z&&(z=I)}z<C*C&&w()}};a.intersectTriangleGeometry=function(C,t,A,z,w,F,E){t=b.isInstanceHidden(t);A=A.tolerance;
t||(C.boundingInfo?(u.assert(0===C.primitiveType),q(C.boundingInfo,z,w,A,F,E)):(A=C.indices.get("position"),C=C.vertexAttributes.get("position"),r(z,w,0,A.length/3,A,C,void 0,F,E)))};a.intersectTriangles=r;a.updateParameters=function(C,t){let A=!1;for(const z in t){const w=t[z];void 0!==w&&(A=!0,Array.isArray(w)?C[z]=w.slice():C[z]=w)}return A};a.verticalOffsetAtDistance=function(C,t,A,z,w){let F=(A.screenLength||0)*C.pixelRatio;w&&(F=p.scale(F,z,t,w));return l.glClamp(F*Math.tan(.5*C.fovY)/(.5*C.fullHeight)*
t,A.minWorldLength||0,null!=A.maxWorldLength?A.maxWorldLength:Infinity)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/mathUtils"],function(a,e,l){function B(r,v,D){const y=D.parameters;D=D.paddingPixelsOverride;p.scale=Math.min(y.divisor/(v-y.offset),1);p.factor=Math.abs(r*r*r);p.minPixelSize=y.minPixelSize;p.paddingPixels=D;return p}function d(r,
v){return 0===r?v.minPixelSize:v.minPixelSize*(1+2*v.paddingPixels/r)}function f(r,v){return Math.max(l.lerp(r*v.scale,r,v.factor),d(r,v))}let u=function(){function r(D,y,x,c={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0},m){this.viewingMode=D;this.description=y;this.ellipsoidRadius=x;this.parameters=c;this._paddingPixelsOverride=m;2===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):
(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}var v=r.prototype;v.update=function(D){if(this.parameters&&this.parameters.camera.fovY===D.fovY&&this.parameters.camera.distance===D.distance)return!1;this.calculateParameters(D,this.ellipsoidRadius,this.parameters);return!0};v.overridePadding=function(D){return D!==this.paddingPixelsOverride?new r(this.viewingMode,this.description,this.ellipsoidRadius,
this.parameters,D):this};v.calculateParameters=function(D,y,x){const {scaleStart:c,scaleFallOffRange:m,minPixelSize:h}=this.description,{fovY:g,distance:k}=D;var n=this.calculateCurvatureDependentParameters(D,y);y=this.coverageCompensation(D,y,n);const {tiltAngle:G,scaleFallOffFactor:C}=n,t=Math.sin(G)*k,A=.5*Math.PI-G-g*(.5-c*y);n=t/Math.cos(A);y=(n-t/Math.cos(A+g*m*y)*C)/(1-C);x.camera.fovY=D.fovY;x.camera.distance=D.distance;x.offset=y;x.divisor=n-y;x.minPixelSize=h;return x};v.calculateCurvatureDependentParametersLocal=
function(D,y,x=q){x.tiltAngle=this.description.curvatureDependent.min.tiltAngle;x.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;return x};v.calculateCurvatureDependentParametersGlobal=function(D,y,x=q){const c=this.description.curvatureDependent;D=1+D.distance/y;D=Math.sqrt(D*D-1);const [m,h]=[c.min.curvature,c.max.curvature];D=l.clamp((D-m)/(h-m),0,1);const [g,k]=[c.min,c.max];x.tiltAngle=l.lerp(g.tiltAngle,k.tiltAngle,D);x.scaleFallOffFactor=l.lerp(g.scaleFallOffFactor,
k.scaleFallOffFactor,D);return x};v.surfaceCoverageCompensationLocal=function(D,y,x){return(D.fovY-x.tiltAngle)/D.fovY};v.surfaceCoverageCompensationGlobal=function(D,y,x){const c=y*y;x=x.tiltAngle+.5*Math.PI;const {fovY:m,distance:h}=D;D=h*h+c-2*Math.cos(x)*h*y;const g=Math.sqrt(D);return(Math.acos(Math.sqrt(D-c)/g)-Math.asin(y/(g/Math.sin(x)))+.5*m)/m};e._createClass(r,[{key:"paddingPixelsOverride",get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels}}]);return r}();
const b={curvatureDependent:{min:{curvature:l.deg2rad(10),tiltAngle:l.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:l.deg2rad(70),tiltAngle:l.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},p={scale:0,factor:0,minPixelSize:0,paddingPixels:0},q={tiltAngle:0,scaleFallOffFactor:0};a.applyPrecomputedScaleFactor=function(r,v,D=[0,0]){v=Math.min(Math.max(v.scale,d(r[1],v)/r[1]),1);D[0]=r[0]*v;D[1]=r[1]*v;return D};a.applyScaleFactor=f;a.applyScaleFactorVec2=function(r,
v,D=[0,0]){const y=Math.min(Math.max(v.scale,d(r[1],v)/r[1]),1);D[0]=l.lerp(r[0]*y,r[0],v.factor);D[1]=l.lerp(r[1]*y,r[1],v.factor);return D};a.getLabelSettings=function(r,v){const {curvatureDependent:D,scaleStart:y,scaleFallOffRange:x}=b;return new u(r,{curvatureDependent:{min:{curvature:D.min.curvature,tiltAngle:D.min.tiltAngle,scaleFallOffFactor:.7},max:{curvature:D.max.curvature,tiltAngle:D.max.tiltAngle,scaleFallOffFactor:.95}},scaleStart:y,scaleFallOffRange:x,minPixelSize:14},v)};a.getSettings=
function(r,v){return new u(r,b,v)};a.precomputeScaleFactor=function(r,v,D,y){r=B(r,v,D);r.minPixelSize=0;r.paddingPixels=0;r=f(1,r);y.scale=r;y.factor=0;y.minPixelSize=D.parameters.minPixelSize;y.paddingPixels=D.paddingPixelsOverride};a.scale=function(r,v,D,y){return f(r,B(v,D,y))};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":function(){define(["../../../../chunks/mat3f64","../../../../chunks/vec3f32"],function(a,e){var l;
(l||(l={})).Default={vvSizeEnabled:!1,vvSizeMinSize:e.fromValues(1,1,1),vvSizeMaxSize:e.fromValues(100,100,100),vvSizeOffset:e.fromValues(0,0,0),vvSizeFactor:e.fromValues(1,1,1),vvSizeValue:e.fromValues(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:a.create()};return l})},
"esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/maybe ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../../../webgl/Program ../../../webgl/renderState ../core/shaderLibrary/util/View.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../lib/OrderIndependentTransparency ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../lib/StencilUtils ../../../../chunks/RibbonLine.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h){const g={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};u=function(n){function G(t,A){A=n.call(this,t,A)||this;A.stipplePattern=null;A.stippleTextureBind=null;A.stippleTextureRepository=t.stippleTextureRepository;return A}l._inheritsLoose(G,n);var C=G.prototype;C.initializeProgram=function(t){var A=G.shader.get();const z=this.configuration;A=A.build({OITEnabled:0===
z.transparencyPassType,output:z.output,slicePlaneEnabled:z.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:z.stippleEnabled,stippleOffColorEnabled:z.stippleOffColorEnabled,stippleUVMaxEnabled:z.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:z.stippleIntegerRepeatsEnabled,roundCaps:z.roundCaps,roundJoins:z.roundJoins,vvColor:z.vvColor,vvSize:z.vvSize,vvInstancingEnabled:!0,vvOpacity:z.vvOpacity,falloffEnabled:z.falloffEnabled,innerColorEnabled:z.innerColorEnabled,
multipassTerrainEnabled:z.multipassTerrainEnabled,cullAboveGround:z.cullAboveGround});return new p(t.rctx,A.generateSource("vertex"),A.generateSource("fragment"),g)};C.dispose=function(){n.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};C.bindPass=function(t,A,z){r.View.bindProjectionMatrix(this.program,z.camera.projectionMatrix);4===this.configuration.output&&D.OutputHighlight.bindOutputHighlight(t,this.program,
z);z.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",z.inverseViewport),c.bindMultipassTerrainUniforms(this.program,t,z));this.program.setUniform1f("intrinsicWidth",A.width);this.program.setUniform4fv("intrinsicColor",A.color);this.program.setUniform1f("miterLimit","miter"!==A.join?0:A.miterLimit);this.program.setUniform2fv("cameraNearFar",z.camera.nearFar);this.program.setUniform1f("pixelRatio",z.camera.pixelRatio);this.program.setUniform2f("screenSize",z.camera.fullViewport[2],
z.camera.fullViewport[3]);y.VisualVariables.bindUniformsWithOpacity(this.program,A);if(this.stipplePattern!==A.stipplePattern){const w=A.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,w);this.stipplePattern=w}this.configuration.stippleEnabled&&(t=d.isSome(this.stippleTextureBind)?this.stippleTextureBind(t,0)*z.camera.pixelRatio:1,this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/t),this.configuration.stippleOffColorEnabled&&
(t=d.unwrap(A.stippleOffColor),this.program.setUniform4f("stippleOffColor",t[0],t[1],t[2],3<t.length?t[3]:1)));this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",A.falloff);this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",d.unwrapOr(A.innerColor,A.color)),this.program.setUniform1f("innerWidth",A.innerWidth*z.camera.pixelRatio))};C.bindDraw=function(t){r.View.bindView(this.program,t);v.Slice.bindUniformsWithOrigin(this.program,this.configuration,t)};
C.setPipelineState=function(t,A){const z=this.configuration,w=3===t,F=2===t;return q.makePipelineState({blending:0===z.output||7===z.output?w?x.blendingDefault:x.OITBlending(t):null,depthTest:{func:x.OITDepthTest(t)},depthWrite:w?!z.transparent&&z.writeDepth&&q.defaultDepthWriteParams:x.OITDepthWrite(t),colorWrite:q.defaultColorWriteParams,stencilWrite:z.sceneHasOcludees?m.stencilWriteMaskOn:null,stencilTest:z.sceneHasOcludees?A?m.stencilToolMaskBaseParams:m.stencilBaseAllZerosParams:null,polygonOffset:w||
F?z.polygonOffset&&k:x.OITPolygonOffset})};C.initializePipeline=function(){const t=this.configuration,A=t.polygonOffset&&k;t.occluder&&(this._occluderPipelineTransparent=q.makePipelineState({blending:x.blendingDefault,polygonOffset:A,depthTest:m.depthCompareAlways,depthWrite:null,colorWrite:q.defaultColorWriteParams,stencilWrite:null,stencilTest:m.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=q.makePipelineState({blending:x.blendingDefault,polygonOffset:A,depthTest:m.depthCompareAlways,
depthWrite:null,colorWrite:q.defaultColorWriteParams,stencilWrite:m.stencilWriteMaskOff,stencilTest:m.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=q.makePipelineState({blending:null,polygonOffset:A,depthTest:m.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:m.stencilWriteMaskOn,stencilTest:m.stencilToolMaskBaseParams}));this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0);return this.setPipelineState(this.configuration.transparencyPassType,
!1)};C.getPipelineState=function(t,A){return A?this._occludeePipelineState:this.configuration.occluder?11===t?this._occluderPipelineTransparent:10===t?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline};l._createClass(G,[{key:"primitiveType",get:function(){return 5}}]);return G}(u.ShaderTechnique);u.shader=new f.ReloadableShaderModule(h.RibbonLineShader,()=>new Promise(function(n,G){a(["./RibbonLine.glsl"],n,G)}));const k={factor:0,units:-4};f=function(n){function G(){var C=
n.apply(this,arguments)||this;C.output=0;C.occluder=!1;C.slicePlaneEnabled=!1;C.transparent=!1;C.polygonOffset=!1;C.writeDepth=!1;C.stippleEnabled=!1;C.stippleOffColorEnabled=!1;C.stippleIntegerRepeatsEnabled=!1;C.roundCaps=!1;C.roundJoins=!1;C.vvSize=!1;C.vvColor=!1;C.vvOpacity=!1;C.falloffEnabled=!1;C.innerColorEnabled=!1;C.sceneHasOcludees=!1;C.transparencyPassType=3;C.multipassTerrainEnabled=!1;C.cullAboveGround=!0;return C}l._inheritsLoose(G,n);return G}(b.ShaderTechniqueConfiguration);B.__decorate([b.parameter({count:8})],
f.prototype,"output",void 0);B.__decorate([b.parameter()],f.prototype,"occluder",void 0);B.__decorate([b.parameter()],f.prototype,"slicePlaneEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"transparent",void 0);B.__decorate([b.parameter()],f.prototype,"polygonOffset",void 0);B.__decorate([b.parameter()],f.prototype,"writeDepth",void 0);B.__decorate([b.parameter()],f.prototype,"stippleEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"stippleOffColorEnabled",void 0);B.__decorate([b.parameter()],
f.prototype,"stippleIntegerRepeatsEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"roundCaps",void 0);B.__decorate([b.parameter()],f.prototype,"roundJoins",void 0);B.__decorate([b.parameter()],f.prototype,"vvSize",void 0);B.__decorate([b.parameter()],f.prototype,"vvColor",void 0);B.__decorate([b.parameter()],f.prototype,"vvOpacity",void 0);B.__decorate([b.parameter()],f.prototype,"falloffEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"innerColorEnabled",void 0);B.__decorate([b.parameter()],
f.prototype,"sceneHasOcludees",void 0);B.__decorate([b.parameter({count:4})],f.prototype,"transparencyPassType",void 0);B.__decorate([b.parameter()],f.prototype,"multipassTerrainEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"cullAboveGround",void 0);e.RibbonLineTechnique=u;e.RibbonLineTechniqueConfiguration=f;e.ribbonVertexAttributeLocations=g;Object.defineProperty(e,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":function(){define(["exports"],
function(a){let e=function(){function l(d,f){this._module=d;this._loadModule=f}var B=l.prototype;B.get=function(){return this._module};B.reload=async function(){return this._module=await this._loadModule()};return l}();a.ReloadableShaderModule=e;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(f,u){u&&(this._config=
u.snapshot());this._program=this.initializeProgram(f);f.commonUniformStore&&(this._commonUniformStore=f.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program));this._pipeline=this.initializePipeline(f)}var d=B.prototype;d.dispose=function(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)};d.reload=function(f){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),
this._program.dispose());this._program=this.initializeProgram(f);this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)};d.bindPass=function(f,u,b){};d.bindMaterial=function(f,u,b){};d.bindDraw=function(f,u,b){};d.bindPipelineState=function(f){f.setPipelineState(this.pipeline)};d.ensureAttributeLocations=function(f){this.program.assertCompatibleVertexAttributeLocations(f)};e._createClass(B,[{key:"program",get:function(){return this._program}},{key:"pipeline",get:function(){return this._pipeline}},
{key:"key",get:function(){return this._config.key}},{key:"configuration",get:function(){return this._config}},{key:"primitiveType",get:function(){return 4}}]);return B}();a.ShaderTechnique=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils"],function(a,e,l){let B=function(){function d(){this._key="";this._keyDirty=
!1;this._parameterBits=this._parameterBits.map(()=>0)}d.prototype.snapshot=function(){const f=this._parameterNames,u={key:this.key};for(const b of f)u[b]=this[b];return u};e._createClass(d,[{key:"key",get:function(){this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits));return this._key}}]);return d}();a.ShaderTechniqueConfiguration=B;a.parameter=function(d={}){return(f,u)=>{var b,p;f._parameterNames=null!=(b=f._parameterNames)?b:[];f._parameterNames.push(u);
const q=f._parameterNames.length-1;b=Math.ceil(l.log2(d.count||2));const r=null!=(p=f._parameterBits)?p:[0];let v=0;for(;16<r[v]+b;)v++,v>=r.length&&r.push(0);f._parameterBits=r;const D=r[v],y=(1<<b)-1<<D;r[v]+=b;Object.defineProperty(f,u,{get(){return this[q]},set(x){if(this[q]!==x&&(this[q]=x,this._keyDirty=!0,this._parameterBits[v]=this._parameterBits[v]&~y|+x<<D&y,"number"!==typeof x&&"boolean"!==typeof x))throw"Configuration value for "+u+" must be boolean or number, got "+typeof x;}})}};Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/webgl/Program":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/has","../../core/maybe","./ShaderTranspiler"],function(a,e,l,B){function d(f,u){if(l.isNone(f)||f.length!==u.length)return!0;for(let b=0;b<f.length;++b)if(f[b]!==u[b])return!0;return!1}return function(){function f(b,p,q,r,v={}){this._glName=this._context=null;this._locations={};this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation=
{};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||console.error("RenderingContext isn't initialized!");0===p.length&&console.error("Shaders source should not be empty!");b.instanceCounter.increment(3,this);this._context=b;this._vertexShaderSource=p;this._fragmentShaderSource=q;if(Array.isArray(v))for(const D of v)this._defines[D]="1";
else this._defines=v;this._locations=r}var u=f.prototype;u.getDefine=function(b){return this._defines[b]};u.dispose=function(){if(this._context){var b=this._context.gl;this._vShader&&(b.deleteShader(this._vShader),this._vShader=null);this._fShader&&(b.deleteShader(this._fShader),this._fShader=null);this._glName&&(b.deleteProgram(this._glName),this._glName=null);this._context.instanceCounter.decrement(3,this);this._context=null}};u.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);
this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var b=this._context.gl,p=b.createProgram();b.attachShader(p,this._vShader);b.attachShader(p,this._fShader);for(const q in this._locations)b.bindAttribLocation(p,this._locations[q],q);b.linkProgram(p);this._glName=p;this._initialized=!0}};u.getUniformLocation=function(b){this.initialize();void 0===this._nameToUniformLocation[b]&&(this._nameToUniformLocation[b]=this._context.gl.getUniformLocation(this._glName,
b));return this._nameToUniformLocation[b]};u.hasUniform=function(b){return null!==this.getUniformLocation(b)};u.getAttribLocation=function(b){this.initialize();void 0===this._nameToAttribLocation[b]&&(this._nameToAttribLocation[b]=this._context.gl.getAttribLocation(this._glName,b));return this._nameToAttribLocation[b]};u.setUniform1i=function(b,p){const q=this._nameToUniform1[b];if(void 0===q||p!==q)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(b),p),this._nameToUniform1[b]=
p};u.setUniform1iv=function(b,p){const q=this._nameToUniform1v[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform1v[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform2iv=function(b,p){const q=this._nameToUniform2[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform2[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform3iv=function(b,p){const q=
this._nameToUniform3[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform3[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform4iv=function(b,p){const q=this._nameToUniform4[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform4[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform1f=function(b,p){const q=this._nameToUniform1[b];if(void 0===
q||p!==q)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(b),p),this._nameToUniform1[b]=p};u.setUniform1fv=function(b,p){const q=this._nameToUniform1v[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform1v[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform2f=function(b,p,q){const r=this._nameToUniform2[b];if(void 0===r||p!==r[0]||q!==r[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(b),
p,q),void 0===r?this._nameToUniform2[b]=[p,q]:(r[0]=p,r[1]=q)};u.setUniform2fv=function(b,p){const q=this._nameToUniform2[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform2[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform3f=function(b,p,q,r){const v=this._nameToUniform3[b];if(void 0===v||p!==v[0]||q!==v[1]||r!==v[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(b),p,q,r),void 0===
v?this._nameToUniform3[b]=[p,q,r]:(v[0]=p,v[1]=q,v[2]=r)};u.setUniform3fv=function(b,p){const q=this._nameToUniform3[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform3[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniform4f=function(b,p,q,r,v){const D=this._nameToUniform4[b];if(void 0===D||p!==D[0]||q!==D[1]||r!==D[2]||v!==D[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(b),p,
q,r,v),void 0===D?this._nameToUniform4[b]=[p,q,r,v]:(D[0]=p,D[1]=q,D[2]=r,D[3]=v)};u.setUniform4fv=function(b,p){const q=this._nameToUniform4[b];d(q,p)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(b),p),void 0===q?this._nameToUniform4[b]=f._arrayCopy(p):f._arrayAssign(p,q))};u.setUniformMatrix3fv=function(b,p,q=!1){const r=this._nameToUniformMatrix3[b];var v=l.isNone(r)?!0:9!==r.length?d(r,p):9!==r.length||r[0]!==p[0]||r[1]!==p[1]||r[2]!==p[2]||r[3]!==p[3]||
r[4]!==p[4]||r[5]!==p[5]||r[6]!==p[6]||r[7]!==p[7]||r[8]!==p[8];v&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(b),q,p),void 0===r?this._nameToUniformMatrix3[b]=f._arrayCopy(p):f._arrayAssign(p,r))};u.setUniformMatrix4fv=function(b,p,q=!1){const r=this._nameToUniformMatrix4[b];var v=l.isNone(r)?!0:16!==r.length?d(r,p):16!==r.length||r[0]!==p[0]||r[1]!==p[1]||r[2]!==p[2]||r[3]!==p[3]||r[4]!==p[4]||r[5]!==p[5]||r[6]!==p[6]||r[7]!==p[7]||r[8]!==p[8]||r[9]!==
p[9]||r[10]!==p[10]||r[11]!==p[11]||r[12]!==p[12]||r[13]!==p[13]||r[14]!==p[14]||r[15]!==p[15];v&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(b),q,p),void 0===r?this._nameToUniformMatrix4[b]=f._arrayCopy(p):f._arrayAssign(p,r))};u.assertCompatibleVertexAttributeLocations=function(b){(b=b.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return b};f._padToThree=function(b){let p=b.toString();1E3>b&&(p=("  "+b).slice(-3));
return p};u._addLineNumbers=function(b){let p=2;return b.replace(/\n/g,()=>"\n"+f._padToThree(p++)+":")};u._loadShader=function(b){var p=35633===b,q=p?this._vertexShaderSource:this._fragmentShaderSource;let r="";for(const v in this._defines)r+=`#define ${v} ${this._defines[v]}\n`;q=r+q;"webgl2"===this._context.contextVersion&&(q=B.transpileShader(q,p?"vertex":"fragment"));p=this._context.gl;b=p.createShader(b);p.shaderSource(b,q);p.compileShader(b);return b};f._arrayCopy=function(b){const p=[];for(let q=
0;q<b.length;++q)p.push(b[q]);return p};f._arrayAssign=function(b,p){for(let q=0;q<b.length;++q)p[q]=b[q]};a._createClass(f,[{key:"glName",get:function(){return this._glName}},{key:"locations",get:function(){return this._locations}}]);return f}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["exports","../../chunks/_commonjsHelpers","./reservedWordsGLSL3"],function(a,e,l){function B(){function c(P){P.length&&E.push({type:y[A],data:P,position:S,line:N,column:U})}function m(){F=F.length?
[]:F;if("/"===w&&"*"===z)return S=t+C-1,A=0,w=z,C+1;if("/"===w&&"/"===z)return S=t+C-1,A=1,w=z,C+1;if("#"===z)return A=2,S=t+C,C;if(/\s/.test(z))return A=9,S=t+C,C;I=/\d/.test(z);L=/[^\w_]/.test(z);S=t+C;A=I?4:L?3:9999;return C}function h(){if(("\r"===z||"\n"===z)&&"\\"!==w)return c(F.join("")),A=999,C;F.push(z);w=z;return C+1}function g(){if("."===w&&/\d/.test(z))return A=5,C;if("/"===w&&"*"===z)return A=0,C;if("/"===w&&"/"===z)return A=1,C;if("."===z&&F.length){for(;k(F););A=5;return C}if(";"===
z||")"===z||"("===z){if(F.length)for(;k(F););c(z);A=999;return C+1}var P=2===F.length&&"\x3d"!==z;if(/[\w_\d\s]/.test(z)||P){for(;k(F););A=999;return C}F.push(z);w=z;return C+1}function k(P){var Q=0;do{var R=v.indexOf(P.slice(0,P.length+Q).join(""));var Y=v[R];if(-1===R){if(0<Q--+P.length)continue;Y=P.slice(0,1).join("")}c(Y);S+=Y.length;F=F.slice(Y.length);return F.length}while(1)}function n(){if("."===z||/[eE]/.test(z))return F.push(z),A=5,w=z,C+1;if("x"===z&&1===F.length&&"0"===F[0])return A=11,
F.push(z),w=z,C+1;if(/[^\d]/.test(z))return c(F.join("")),A=999,C;F.push(z);w=z;return C+1}function G(){"f"===z&&(F.push(z),w=z,C+=1);if(/[eE]/.test(z)||"-"===z&&/[eE]/.test(w))return F.push(z),w=z,C+1;if(/[^\d]/.test(z))return c(F.join("")),A=999,C;F.push(z);w=z;return C+1}var C=0,t=0,A=999,z,w,F=[],E=[],N=1,U=0,S=0,I=!1,L=!1,M="",K;return function(P){E=[];if(null!==P){P=P.replace?P.replace(/\r\n/g,"\n"):P;C=0;M+=P;for(K=M.length;z=M[C],C<K;){P=C;switch(A){case 0:"/"===z&&"*"===w?(F.push(z),c(F.join("")),
A=999):(F.push(z),w=z);C+=1;break;case 1:C=h();break;case 2:C=h();break;case 3:C=g();break;case 4:C=n();break;case 11:/[^a-fA-F0-9]/.test(z)?(c(F.join("")),A=999):(F.push(z),w=z,C+=1);break;case 5:C=G();break;case 9999:if(/[^\d\w_]/.test(z)){var Q=F.join("");A=-1<r.indexOf(Q)?8:-1<D.indexOf(Q)?7:6;c(F.join(""));A=999}else F.push(z),w=z,C+=1;break;case 9:/[^\s]/g.test(z)?(c(F.join("")),A=999):(F.push(z),w=z,C+=1);break;case 999:C=m()}if(P!==C)switch(M[P]){case "\n":U=0;++N;break;default:++U}}t+=C;
M=M.slice(C);return E}F.length&&c(F.join(""));A=10;c("(eof)");return E}}function d(c){return c.map(m=>"eof"!==m.type?m.data:"").join("")}function f(c,m="100",h="300 es"){const g=/^\s*#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const k of c)if("preprocessor"===k.type){const n=g.exec(k.data);if(n){c=n[1].replace(/\s\s+/g," ");if(c===h)return c;if(c===m)return k.data="#version "+h,m;throw Error("unknown glsl version: "+c);}}c.splice(0,0,{type:"preprocessor",data:"#version "+h},{type:"whitespace",data:"\n"});
return null}function u(c,m,h,g){g=g||h;for(const k of c)if("ident"===k.type&&k.data===h)return g in m?m[g]++:m[g]=0,u(c,m,g+"_"+m[g],g);return h}function b(c,m,h="afterVersion"){const g={data:"\n",type:"whitespace"},k=G=>G<c.length?/[^\r\n]$/.test(c[G].data):!1;let n=function(G){let C=-1,t=0,A=-1;for(let w=0;w<G.length;w++){var z=G[w];"preprocessor"===z.type&&(z.data.match(/#(if|ifdef|ifndef)\s+.+/)?++t:z.data.match(/#endif\s*.*/)&&--t);("afterVersion"===h||"afterPrecision"===h)&&"preprocessor"===
z.type&&/^#version/.test(z.data)&&(A=Math.max(A,w));if("afterPrecision"===h&&"keyword"===z.type&&"precision"===z.data){a:{for(z=w;z<G.length;z++){const F=G[z];if("operator"===F.type&&";"===F.data)break a}z=null}if(null===z)throw Error("precision statement not followed by any semicolons!");A=Math.max(A,z)}C<A&&0===t&&(C=w)}return C+1}(c);k(n-1)&&c.splice(n++,0,g);for(const G of m)c.splice(n++,0,G);k(n-1)&&k(n)&&c.splice(n,0,g)}function p(c,m,h,g="lowp"){b(c,[{type:"keyword",data:"out"},{type:"whitespace",
data:" "},{type:"keyword",data:g},{type:"whitespace",data:" "},{type:"keyword",data:h},{type:"whitespace",data:" "},{type:"ident",data:m},{type:"operator",data:";"}],"afterPrecision")}function q(c,m,h,g,k="lowp"){b(c,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"\x3d"},{type:"whitespace",data:" "},{type:"integer",data:g.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",
data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:k},{type:"whitespace",data:" "},{type:"keyword",data:h},{type:"whitespace",data:" "},{type:"ident",data:m},{type:"operator",data:";"}],"afterPrecision")}var r=e.createCommonjsModule(function(c){(function(m){m=m();void 0!==m&&(c.exports=m)})(function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})}),
v=e.createCommonjsModule(function(c){(function(m){m=m();void 0!==m&&(c.exports=m)})(function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})}),D=e.createCommonjsModule(function(c){(function(m){m=m();void 0!==m&&(c.exports=m)})(function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})}),
y="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");const x=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];a.transpileShader=function(c,m){var h=B(),g=[];g=g.concat(h(c));c=g=g.concat(h(null));if("300 es"===f(c,"100","300 es"))throw Error("shader is already glsl 300 es");g=h=null;const k={},n={};for(let A=0;A<c.length;++A){const z=c[A];switch(z.type){case "keyword":"vertex"===
m&&"attribute"===z.data?z.data="in":"varying"===z.data&&(z.data="vertex"===m?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(z.data.trim())&&(z.data=z.data.replace(/(2D|Cube|EXT)/g,""));"fragment"===m&&"gl_FragColor"===z.data&&(h||(h=u(c,k,"fragColor"),p(c,h,"vec4")),z.data=h);if("fragment"===m&&"gl_FragData"===z.data){{var G=void 0;let w=void 0;var C=c;var t=A+1;let F=-1;for(;t<C.length;t++){const E=C[t];if("operator"===E.type&&("["===E.data&&(w=t),"]"===E.data)){G=
t;break}"integer"===E.type&&(F=parseInt(E.data,10))}w&&G&&C.splice(w,G-w+1);C=F}G=u(c,k,"fragData");q(c,G,"vec4",C,"mediump");z.data=G}else"fragment"===m&&"gl_FragDepthEXT"===z.data&&(g||(g=u(c,k,"gl_FragDepth")),z.data=g);break;case "ident":if(0<=l.indexOf(z.data)){if(C="vertex"===m)a:{for(C=A-1;0<=C;C--)if(G=c[C],"whitespace"!==G.type&&"block-comment"!==G.type)if("keyword"===G.type){if("attribute"===G.data||"in"===G.data){C=!0;break a}}else break;C=!1}if(C)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");
z.data in n||(n[z.data]=u(c,k,z.data));z.data=n[z.data]}}}for(m=c.length-1;0<=m;--m)h=c[m],"preprocessor"===h.type&&((g=h.data.match(/#extension\s+(.*):/))&&g[1]&&0<=x.indexOf(g[1].trim())&&(g=c[m+1],c.splice(m,g&&"whitespace"===g.type?2:1)),(g=h.data.match(/#ifdef\s+(.*)/))&&g[1]&&0<=x.indexOf(g[1].trim())&&(h.data="#if 1"),(g=h.data.match(/#ifndef\s+(.*)/))&&g[1]&&0<=x.indexOf(g[1].trim())&&(h.data="#if 0"));return d(c)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],
function(a){function e(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs");}a.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};a.commonjsRequire=e;a.createCommonjsModule=function(l,B,d){return d={path:B,exports:{},require:function(f,u){return e(f,void 0===u||null===u?d.path:u)}},l(d,d.exports),d.exports};a.getDefaultExportFromCjs=function(l){return l&&
l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l["default"]:l}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(function(){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/renderState":function(){define(["exports"],function(a){function e(E){return k.intern(E)}function l(E){return n.intern(E)}function B(E){return G.intern(E)}function d(E){return C.intern(E)}function f(E){return t.intern(E)}function u(E){return A.intern(E)}function b(E){return z.intern(E)}function p(E){return w.intern(E)}function q(E){return"["+E.join(",")+"]"}function r(E){return E?q([E.srcRgb,E.srcAlpha,E.dstRgb,E.dstAlpha,E.opRgb,E.opAlpha,E.color.r,E.color.g,E.color.b,E.color.a]):
null}function v(E){return E?q([E.face,E.mode]):null}function D(E){return E?q([E.factor,E.units]):null}function y(E){return E?q([E.func]):null}function x(E){return E?q([E.function.func,E.function.ref,E.function.mask,E.operation.fail,E.operation.zFail,E.operation.zPass]):null}function c(E){return E?q([E.zNear,E.zFar]):null}function m(E){return E?q([E.r,E.g,E.b,E.a]):null}function h(E){return E?q([E.mask]):null}var g=function(){function E(N,U){this.makeKey=N;this.makeRef=U;this.interns=new Map}E.prototype.intern=
function(N){if(!N)return null;const U=this.makeKey(N),S=this.interns;S.has(U)||S.set(U,this.makeRef(N));return S.get(U)};return E}();const k=new g(r,E=>({__tag:"Blending",...E})),n=new g(v,E=>({__tag:"Culling",...E})),G=new g(D,E=>({__tag:"PolygonOffset",...E})),C=new g(y,E=>({__tag:"DepthTest",...E})),t=new g(x,E=>({__tag:"StencilTest",...E})),A=new g(c,E=>({__tag:"DepthWrite",...E})),z=new g(m,E=>({__tag:"ColorWrite",...E})),w=new g(h,E=>({__tag:"StencilWrite",...E})),F=new g(function(E){return E?
q([r(E.blending),v(E.culling),D(E.polygonOffset),y(E.depthTest),x(E.stencilTest),c(E.depthWrite),m(E.colorWrite),h(E.stencilWrite)]):null},E=>({blending:e(E.blending),culling:l(E.culling),polygonOffset:B(E.polygonOffset),depthTest:d(E.depthTest),stencilTest:f(E.stencilTest),depthWrite:u(E.depthWrite),colorWrite:b(E.colorWrite),stencilWrite:p(E.stencilWrite)}));g=function(){function E(U){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=
this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=U}var N=E.prototype;N.setPipeline=function(U){if(this._pipelineInvalid||U!==this._pipeline)this.setBlending(U.blending),this.setCulling(U.culling),this.setPolygonOffset(U.polygonOffset),this.setDepthTest(U.depthTest),this.setStencilTest(U.stencilTest),this.setDepthWrite(U.depthWrite),this.setColorWrite(U.colorWrite),this.setStencilWrite(U.stencilWrite),this._pipeline=U;this._pipelineInvalid=
!1};N.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};N.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};N.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};N.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};N.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};N.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};
N.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};N.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};N.setBlending=function(U){this._blending=this.setSubState(U,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};N.setCulling=function(U){this._culling=this.setSubState(U,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};N.setPolygonOffset=function(U){this._polygonOffset=
this.setSubState(U,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};N.setDepthTest=function(U){this._depthTest=this.setSubState(U,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};N.setStencilTest=function(U){this._stencilTest=this.setSubState(U,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};N.setDepthWrite=function(U){this._depthWrite=
this.setSubState(U,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};N.setColorWrite=function(U){this._colorWrite=this.setSubState(U,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};N.setStencilWrite=function(U){this._stencilWrite=this.setSubState(U,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};N.setSubState=function(U,S,I,L){if(I||
U!==S)L(U),this._pipelineInvalid=!0;return U};return E}();a.StateTracker=g;a.backFaceCullingParams={face:1029,mode:2305};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.defaultDepthWriteParams={zNear:0,zFar:1};a.makeBlending=e;a.makeColorWrite=b;a.makeCulling=l;a.makeDepthTest=d;a.makeDepthWrite=u;a.makePipelineState=function(E){return F.intern(E)};a.makePolygonOffset=B;a.makeStencilTest=f;a.makeStencilWrite=p;a.separateBlendingParams=function(E,N,U,S,I=32774,L=32774,M=[0,0,0,0]){return{srcRgb:E,
srcAlpha:N,dstRgb:U,dstAlpha:S,opRgb:I,opAlpha:L,color:{r:M[0],g:M[1],b:M[2],a:M[3]}}};a.simpleBlendingParams=function(E,N,U=32774,S=[0,0,0,0]){return{srcRgb:E,srcAlpha:E,dstRgb:N,dstAlpha:N,opRgb:U,opAlpha:U,color:{r:S[0],g:S[1],b:S[2],a:S[3]}}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl":function(){define(["exports","../../../../../../chunks/mat4","../../../../../../chunks/mat4f32"],function(a,e,l){(function(d){function f(u,
b,p){e.translate(B,p,b);u.setUniform3fv("localOrigin",b);u.setUniformMatrix4fv("view",B)}d.bindCamPosition=function(u,b,p){u.setUniform3f("camPos",p[3]-b[0],p[7]-b[1],p[11]-b[2])};d.bindProjectionMatrix=function(u,b){u.setUniformMatrix4fv("proj",b)};d.bindNearFar=function(u,b){u.setUniform2fv("nearFar",b)};d.bindViewCustomOrigin=f;d.bindView=function(u,b){f(u,b.origin,b.camera.viewMatrix)};d.bindViewport=function(u,b){u.setUniform4fv("viewport",b.camera.fullViewport)}})(a.View||(a.View={}));const B=
l.create();Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/mat4f32":function(){define(["exports"],function(a){function e(){const b=new Float32Array(16);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}function l(b){const p=new Float32Array(16);p[0]=b[0];p[1]=b[1];p[2]=b[2];p[3]=b[3];p[4]=b[4];p[5]=b[5];p[6]=b[6];p[7]=b[7];p[8]=b[8];p[9]=b[9];p[10]=b[10];p[11]=b[11];p[12]=b[12];p[13]=b[13];p[14]=b[14];p[15]=b[15];return p}function B(b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){const t=new Float32Array(16);
t[0]=b;t[1]=p;t[2]=q;t[3]=r;t[4]=v;t[5]=D;t[6]=y;t[7]=x;t[8]=c;t[9]=m;t[10]=h;t[11]=g;t[12]=k;t[13]=n;t[14]=G;t[15]=C;return t}function d(b,p){return new Float32Array(b,p,16)}const f=e();var u=Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d,IDENTITY:f});a.IDENTITY=f;a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.mat4f32=u})},"esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":function(){define(["exports","../../../../../core/maybe","../../../../../chunks/vec3f64",
"../../../../../chunks/vec3","../shaderModules/interfaces"],function(a,e,l,B,d){function f(b,p){if(p.slicePlaneEnabled){b.extensions.add("GL_OES_standard_derivatives");p.sliceEnabledForVertexPrograms&&(b.vertex.uniforms.add("slicePlaneOrigin","vec3"),b.vertex.uniforms.add("slicePlaneBasis1","vec3"),b.vertex.uniforms.add("slicePlaneBasis2","vec3"));b.fragment.uniforms.add("slicePlaneOrigin","vec3");b.fragment.uniforms.add("slicePlaneBasis1","vec3");b.fragment.uniforms.add("slicePlaneBasis2","vec3");
var q=d.glsl`
      struct SliceFactors {
        float front;
        float side0;
        float side1;
        float side2;
        float side3;
      };

      SliceFactors calculateSliceFactors(vec3 pos) {
        vec3 rel = pos - slicePlaneOrigin;

        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);

        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);

        float basis1Dot = dot(slicePlaneBasis1, rel);
        float basis2Dot = dot(slicePlaneBasis2, rel);

        return SliceFactors(
          dot(slicePlaneNormal, pos) + slicePlaneW,
          -basis1Dot - basis1Len2,
          basis1Dot - basis1Len2,
          -basis2Dot - basis2Len2,
          basis2Dot - basis2Len2
        );
      }

      bool sliceByFactors(SliceFactors factors) {
        return factors.front < 0.0
          && factors.side0 < 0.0
          && factors.side1 < 0.0
          && factors.side2 < 0.0
          && factors.side3 < 0.0;
      }

      bool sliceEnabled() {
        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.
        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
      }

      bool sliceByPlane(vec3 pos) {
        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
      }

      #define rejectBySlice(_pos_) sliceByPlane(_pos_)
      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }
    `,r=d.glsl`
      vec4 applySliceHighlight(vec4 color, vec3 pos) {
        SliceFactors factors = calculateSliceFactors(pos);

        if (sliceByFactors(factors)) {
          return color;
        }

        const float HIGHLIGHT_WIDTH = 1.0;
        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);

        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);

        float highlightFactor = (1.0 - step(0.5, factors.front))
          * (1.0 - step(0.5, factors.side0))
          * (1.0 - step(0.5, factors.side1))
          * (1.0 - step(0.5, factors.side2))
          * (1.0 - step(0.5, factors.side3));

        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
      }
    `;r=p.sliceHighlightDisabled?d.glsl`#define highlightSlice(_color_, _pos_) (_color_)`:d.glsl`
        ${r}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;p.sliceEnabledForVertexPrograms&&b.vertex.code.add(q);b.fragment.code.add(q);b.fragment.code.add(r)}else q=d.glsl`
      #define rejectBySlice(_pos_) false
      #define discardBySlice(_pos_) {}
      #define highlightSlice(_color_, _pos_) (_color_)
    `,p.sliceEnabledForVertexPrograms&&b.vertex.code.add(q),b.fragment.code.add(q)}(function(b){b.bindUniformsWithOrigin=function(p,q,r){b.bindUniforms(p,q,r.slicePlane,r.origin)};b.bindUniforms=function(p,q,r,v){q.slicePlaneEnabled&&(e.isSome(r)?(v?(B.subtract(u,r.origin,v),p.setUniform3fv("slicePlaneOrigin",u)):p.setUniform3fv("slicePlaneOrigin",r.origin),p.setUniform3fv("slicePlaneBasis1",r.basis1),p.setUniform3fv("slicePlaneBasis2",r.basis2)):(p.setUniform3fv("slicePlaneBasis1",l.ZEROS),p.setUniform3fv("slicePlaneBasis2",
l.ZEROS),p.setUniform3fv("slicePlaneOrigin",l.ZEROS)))}})(f||(f={}));const u=l.create();a.Slice=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["exports"],function(a){function e(l,...B){let d="";for(let f=0;f<B.length;f++)d+=l[f]+B[f];return d+=l[l.length-1]}(function(l){l.int=function(B){return Math.round(B).toString()};l.float=function(B){return B.toPrecision(8)}})(e||(e={}));a.glsl=e;Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":function(){define(["exports","../../../../../../chunks/vec4f64","../../shaderModules/interfaces"],function(a,e,l){function B(u){u.fragment.uniforms.add("depthTex","sampler2D");u.fragment.uniforms.add("highlightViewportPixelSz","vec4");u.fragment.constants.add("occludedHighlightFlag","vec4",d).add("unoccludedHighlightFlag","vec4",f);u.fragment.code.add(l.glsl`
    void outputHighlight() {
      vec4 fragCoord = gl_FragCoord;

      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
      if (fragCoord.z > sceneDepth + 5e-7) {
        gl_FragColor = occludedHighlightFlag;
      }
      else {
        gl_FragColor = unoccludedHighlightFlag;
      }
    }
  `)}const d=e.fromValues(1,1,0,1),f=e.fromValues(1,0,1,1);(function(u){u.bindOutputHighlight=function(b,p,q){b.bindTexture(q.highlightDepthTexture,5);p.setUniform1i("depthTex",5);p.setUniform4f("highlightViewportPixelSz",0,0,q.inverseViewport[0],q.inverseViewport[1])}})(B||(B={}));a.OutputHighlight=B;a.occludedHighlightFlag=d;a.unoccludedHighlightFlag=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":function(){define(["exports",
"../../shaderModules/interfaces"],function(a,e){function l(B,d){d.vvInstancingEnabled&&(d.vvSize||d.vvColor)&&B.attributes.add("instanceFeatureAttribute","vec4");d.vvSize?(B.vertex.uniforms.add("vvSizeMinSize","vec3"),B.vertex.uniforms.add("vvSizeMaxSize","vec3"),B.vertex.uniforms.add("vvSizeOffset","vec3"),B.vertex.uniforms.add("vvSizeFactor","vec3"),B.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),B.vertex.uniforms.add("vvSymbolAnchor","vec3"),B.vertex.code.add(e.glsl`
      vec3 vvScale(vec4 _featureAttribute) {
        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
      }

      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
      }
    `),B.vertex.code.add(e.glsl`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${d.vvInstancingEnabled?e.glsl`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):B.vertex.code.add(e.glsl`
      vec4 localPosition() { return vec4(position, 1.0); }

      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }
    `);d.vvColor?(B.vertex.constants.add("vvColorNumber","int",8),B.vertex.code.add(e.glsl`
      uniform float vvColorValues[vvColorNumber];
      uniform vec4 vvColorColors[vvColorNumber];

      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${d.vvInstancingEnabled?e.glsl`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):B.vertex.code.add(e.glsl`
      vec4 vvColor() { return vec4(1.0); }
    `)}(function(B){function d(f,u){u.vvSizeEnabled&&(f.setUniform3fv("vvSizeMinSize",u.vvSizeMinSize),f.setUniform3fv("vvSizeMaxSize",u.vvSizeMaxSize),f.setUniform3fv("vvSizeOffset",u.vvSizeOffset),f.setUniform3fv("vvSizeFactor",u.vvSizeFactor));u.vvColorEnabled&&(f.setUniform1fv("vvColorValues",u.vvColorValues),f.setUniform4fv("vvColorColors",u.vvColorColors))}B.bindUniforms=d;B.bindUniformsWithOpacity=function(f,u){d(f,u);u.vvOpacityEnabled&&(f.setUniform1fv("vvOpacityValues",u.vvOpacityValues),
f.setUniform1fv("vvOpacityOpacities",u.vvOpacityOpacities))};B.bindUniformsForSymbols=function(f,u){d(f,u);u.vvSizeEnabled&&(f.setUniform3fv("vvSymbolAnchor",u.vvSymbolAnchor),f.setUniformMatrix3fv("vvSymbolRotationMatrix",u.vvSymbolRotationMatrix))}})(l||(l={}));a.VisualVariables=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports","../../../webgl/renderState"],function(a,e){const l=e.separateBlendingParams(770,
1,771,771),B=e.simpleBlendingParams(1,1),d=e.simpleBlendingParams(0,771),f={factor:-1,units:-2};a.OITBlending=function(u){return 2===u?null:1===u?d:B};a.OITDepthTest=function(u){return 3===u||2===u?513:515};a.OITDepthWrite=function(u){return 2===u?e.defaultDepthWriteParams:null};a.OITPolygonOffset=f;a.OITPolygonOffsetLimit=5E5;a.blendingAlpha=d;a.blendingColor=B;a.blendingDefault=l;a.getOITPolygonOffset=function(u){return u?f:null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl":function(){define(["exports",
"../../shaderModules/interfaces"],function(a,e){a.bindMultipassTerrainUniforms=function(l,B,d){d.multipassTerrainEnabled&&d.terrainLinearDepthTexture&&(l.setUniform1i("terrainDepthTexture",10),B.bindTexture(d.terrainLinearDepthTexture,10))};a.multipassTerrainTest=function(l,B){l.fragment.uniforms.add("terrainDepthTexture","sampler2D");l.fragment.uniforms.add("cameraNearFar","vec2");l.fragment.uniforms.add("inverseViewport","vec2");l.fragment.code.add(e.glsl`
    //Compare the linearized depths of the fragment and the terrain. If fragment is on the wrong side of the terrain, discard it.
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){

      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);
      if(fragmentDepth ${B.cullAboveGround?"\x3e":"\x3c\x3d"} terrainDepth){
        discard;
      }
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/StencilUtils":function(){define(["exports"],function(a){a.depthCompareAlways={func:519};a.depthCompareLess={func:513};a.renderWhenBitIsNotSet=e=>({function:{func:517,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7680}});a.replaceBitWhenDepthTestPasses=e=>({function:{func:519,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7681}});a.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,
zFail:7680,zPass:0}};a.stencilToolMaskBaseParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};a.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};a.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};a.stencilWriteMaskOff={mask:0};a.stencilWriteMaskOn={mask:255};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/RibbonLine.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){function D(x){const c=new l.ShaderBuilder;c.extensions.add("GL_OES_standard_derivatives");c.include(v.PiUtils);c.include(p.RibbonVertexPosition,x);c.include(r.LineStipple,x);1===x.output&&c.include(q.OutputDepth,x);c.vertex.uniforms.add("proj","mat4").add("view","mat4").add("cameraNearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2");c.attributes.add("position","vec3");c.attributes.add("subdivisionFactor","float");c.attributes.add("uv0",
"vec2");c.attributes.add("auxpos1","vec3");c.attributes.add("auxpos2","vec3");c.varyings.add("vColor","vec4");c.varyings.add("vpos","vec3");c.varyings.add("linearDepth","float");x.multipassTerrainEnabled&&c.varyings.add("depth","float");const m=x.falloffEnabled,h=x.innerColorEnabled;h&&c.varyings.add("vLineDistance","float");m&&c.varyings.add("vLineDistanceNorm","float");x.falloffEnabled&&c.fragment.uniforms.add("falloff","float");x.innerColorEnabled&&(c.fragment.uniforms.add("innerColor","vec4"),
c.fragment.uniforms.add("innerWidth","float"));c.vertex.code.add(e.glsl`
		#define PERPENDICULAR(v) vec2(v.y, -v.x);
		#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0

		float interp(float ncp, vec4 a, vec4 b) {
			return (-ncp - a.z) / (b.z - a.z);
		}

		vec2 rotate(vec2 v, float a) {
			float s = sin(a);
			float c = cos(a);
			mat2 m = mat2(c, -s, s, c);
			return m * v;
		}
`);c.vertex.code.add(e.glsl`
    vec4 projectAndScale(vec4 pos) {
      vec4 posNdc = proj * pos;

      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system
      // that is twice scaled (going from -size:size).
      posNdc.xy *= screenSize / posNdc.w;
      return posNdc;
    }
`);c.vertex.code.add(e.glsl`
    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {
      float vnp = cameraNearFar[0] * 0.99;

      //current pos behind ncp --> we need to clip
      if(pos.z > -cameraNearFar[0]) {
        if (!isStartVertex) {
          //previous in front of ncp
          if(prev.z < -cameraNearFar[0]) {
            pos = mix(prev, pos, interp(vnp, prev, pos));
            next = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
        //next in front of ncp
        if(isStartVertex) {
          if(next.z < -cameraNearFar[0]) {
            pos = mix(pos, next, interp(vnp, pos, next));
            prev = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
      } else {
        //current position visible
        //previous behind ncp
        if (prev.z > -cameraNearFar[0]) {
          prev = mix(pos, prev, interp(vnp, pos, prev));
        }
        //next behind ncp
        if (next.z > -cameraNearFar[0]) {
          next = mix(next, pos, interp(vnp, next, pos));
        }
      }

      ${x.multipassTerrainEnabled?"depth \x3d pos.z;":""}
      linearDepth = (-pos.z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);

      pos = projectAndScale(pos);
      next = projectAndScale(next);
      prev = projectAndScale(prev);
    }
`);c.vertex.code.add(e.glsl`
  void main(void) {
    float coverage = 1.0;
    vpos = position;

    // Check for special value of uv0.y which is used by the Renderer when graphics
    // are removed before the VBO is recompacted. If this is the case, then we just
    // project outside of clip space.
    if (uv0.y == 0.0) {
      // Project out of clip space
      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
    }
    else {
      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;
      bool isJoin = abs(uv0.y)-3.0 < 0.0;

      float lineWidth = getSize() * pixelRatio;

      // convert sub-pixel coverage to alpha
      if (lineWidth < 1.0) {
        coverage = lineWidth;
        lineWidth = 1.0;
      }else{
        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if
        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly
        // so we only really care to round anything larger than 1.
        lineWidth = floor(lineWidth + 0.5);
      }

      vec4 pos  = view * vec4(position.xyz, 1.0);
      vec4 prev = view * vec4(auxpos1.xyz, 1.0);
      vec4 next = view * vec4(auxpos2.xyz, 1.0);

      clipAndTransform(pos, prev, next, isStartVertex);

      vec2 left = (pos.xy - prev.xy);
      vec2 right = (next.xy - pos.xy);

      float leftLen = length(left);
      float rightLen = length(right);
  `);x.stippleEnabled&&c.vertex.code.add(e.glsl`
      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment
      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment
      // vector
      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);
      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;

      // Scale s.t. it's in units of stipple pattern size.
      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;
    `);c.vertex.code.add(e.glsl`
    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);
    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);

    vec2 capDisplacementDir = vec2(0, 0);
    vec2 joinDisplacementDir = vec2(0, 0);
    float displacementLen = lineWidth;

    if (isJoin) {

      // JOIN handling ---------------------------------------------------
      // determine if vertex is on the "outside or "inside" of the join
      bool isOutside = ISOUTSIDE;

      // compute miter join position first
      joinDisplacementDir = normalize(left + right);
      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);

      // compute miter stretch
      if (leftLen > 0.001 && rightLen > 0.001) {
        float nDotSeg = dot(joinDisplacementDir, left);
        displacementLen /= length(nDotSeg * left - joinDisplacementDir);

        // limit displacement of inner vertices
        if (!isOutside) {
          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));
        }
      }

      if (isOutside && (displacementLen > miterLimit * lineWidth)) {
    `);x.roundJoins?c.vertex.code.add(e.glsl`
        vec2 startDir;
        vec2 endDir;

        if (leftLen < 0.001) {
          startDir = right;
        }
        else{
          startDir = left;
        }
        startDir = normalize(startDir);
        startDir = PERPENDICULAR(startDir);

        if (rightLen < 0.001) {
          endDir = left;
        }
        else{
          endDir = right;
        }
        endDir = normalize(endDir);
        endDir = PERPENDICULAR(endDir);

        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));
        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);
      `):c.vertex.code.add(e.glsl`
        // convert to bevel join if miterLimit is exceeded
        if (leftLen < 0.001) {
          joinDisplacementDir = right;
        }
        else if (rightLen < 0.001) {
          joinDisplacementDir = left;
        }
        else {
          joinDisplacementDir = isStartVertex ? right : left;
        }
        joinDisplacementDir = normalize(joinDisplacementDir);
        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
  `);c.vertex.code.add(e.glsl`
        displacementLen = lineWidth;
      }
    } else {
    // CAP handling ---------------------------------------------------
    if (leftLen < 0.001) {
      joinDisplacementDir = right;
    }
    else if (rightLen < 0.001) {
      joinDisplacementDir = left;
    }
    else {
      joinDisplacementDir = isStartVertex ? right : left;
    }
    joinDisplacementDir = normalize(joinDisplacementDir);
    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
    displacementLen = lineWidth;

    capDisplacementDir = isStartVertex ? -right : left;
  `);x.roundCaps?c.vertex.code.add(e.glsl`
    float angle = subdivisionFactor*PI*0.5;
    joinDisplacementDir *= cos(angle);
    capDisplacementDir *= sin(angle);
    `):c.vertex.code.add(e.glsl`
    capDisplacementDir *= subdivisionFactor;
    `);c.vertex.code.add(e.glsl`
  }

  // Displacement (in pixels) caused by join/or cap
  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;

  ${m||h?e.glsl`float lineDist = lineWidth * sign(uv0.y) * pos.w;`:""}

  ${h?e.glsl`vLineDistance = lineDist;`:""}
  ${m?e.glsl`vLineDistanceNorm = lineDist / lineWidth;`:""}

  pos.xy += dpos;
  `);x.stippleEnabled&&(c.vertex.code.add(e.glsl`
    {
      // Compute the stipple pattern UV coordinate from the actual position, based on the origin
      // and direction of the line segment on which the stipple pattern is based.

      // Project the vector from the origin of the segment to the vertex onto the line segment.
      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)
      vec2 posVec = pos.xy - stippleSegmentOrigin;

      float stippleSegmentDirectionLength = length(stippleSegmentDirection);
    `),x.stippleIntegerRepeatsEnabled&&c.vertex.code.add(e.glsl`
      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;
      float roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);
      stipplePatternUvMax = roundedNumberOfPatternRepeats;
      `),c.vertex.code.add(e.glsl`
      if (stippleSegmentDirectionLength >= 0.001) {
        // Project the vertex position onto the line segment.
        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;
     ${x.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale \x3d roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale \x3d 1.0;"}
        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;
        } else {
          stipplePatternUv = 1.0;
        }
      }
    `));c.vertex.code.add(e.glsl`
      // Convert back into NDC
      pos.xy = pos.xy / screenSize * pos.w;

      vColor = getColor();
      vColor.a *= coverage;

      gl_Position = pos;
    }
  }
  `);x.multipassTerrainEnabled&&(c.fragment.include(f.ReadLinearDepth),c.include(b.multipassTerrainTest,x));c.include(d.Slice,x);c.fragment.uniforms.add("intrinsicColor","vec4");c.fragment.include(B.ColorConversion);c.fragment.code.add(e.glsl`
  void main() {
    discardBySlice(vpos);
    ${x.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    float stippleAlpha = getStippleAlpha();
    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);

    vec4 color = intrinsicColor * vColor;
  `);x.innerColorEnabled&&(c.fragment.uniforms.add("pixelRatio","float"),c.fragment.code.add(e.glsl`
    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;
    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);
    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);
    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);
    `));c.fragment.code.add(e.glsl`
    vec4 finalColor = blendStipple(color, stippleAlpha);
  `);x.falloffEnabled&&c.fragment.code.add(e.glsl`
    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);
    `);c.fragment.code.add(e.glsl`
    if (finalColor.a < ${e.glsl.float(u.symbolAlphaCutoff)}) {
      discard;
    }

    ${7===x.output?e.glsl`gl_FragColor = vec4(finalColor.a);`:""}
    ${0===x.output?e.glsl`gl_FragColor = highlightSlice(finalColor, vpos);`:""}
    ${0===x.output&&x.OITEnabled?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}
    ${4===x.output?e.glsl`gl_FragColor = vec4(1.0);`:""}
    ${1===x.output?e.glsl`outputDepth(linearDepth);`:""}
  }
  `);return c}var y=Object.freeze({__proto__:null,build:D});a.RibbonLineShader=y;a.build=D})},"esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Logger"],function(a,e,l){const B=l.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");l=function(){function D(){this.includedModules=new Map}D.prototype.include=function(y,x){this.includedModules.has(y)?this.includedModules.get(y)!==
x&&B.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(y,x),y(this.builder,x))};return D}();let d=function(D){function y(){var x=D.apply(this,arguments)||this;x.vertex=new b;x.fragment=new b;x.attributes=new p;x.varyings=new q;x.extensions=new r;x.constants=new v;return x}e._inheritsLoose(y,D);y.prototype.generateSource=function(x){const c=this.extensions.generateSource(x),m=this.attributes.generateSource(x),h=this.varyings.generateSource();
var g="vertex"===x?this.vertex:this.fragment;const k=g.uniforms.generateSource(),n=g.code.generateSource();x="vertex"===x?"precision highp float;\nprecision highp sampler2D;":"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif";g=this.constants.generateSource().concat(g.constants.generateSource());return`
${c.join("\n")}

${x}

${g.join("\n")}

${k.join("\n")}

${m.join("\n")}

${h.join("\n")}

${n.join("\n")}`};e._createClass(y,[{key:"builder",get:function(){return this}}]);return y}(l),f=function(){function D(){this._entries=[];this._set=new Set}var y=D.prototype;y.add=function(x,c,m){const h=`${x}_${c}_${m}`;this._set.has(h)||(this._entries.push([x,c,m]),this._set.add(h));return this};y.generateSource=function(){return this._entries.map(x=>{var c=x[2];return`uniform ${x[1]} ${x[0]}${c?`[${c}]`:""};`})};return D}(),u=function(){function D(){this._entries=[]}var y=D.prototype;y.add=function(x){this._entries.push(x)};
y.generateSource=function(){return this._entries};return D}(),b=function(D){function y(){var x=D.apply(this,arguments)||this;x.uniforms=new f;x.code=new u;x.constants=new v;return x}e._inheritsLoose(y,D);e._createClass(y,[{key:"builder",get:function(){return this}}]);return y}(l),p=function(){function D(){this._entries=[]}var y=D.prototype;y.add=function(x,c){this._entries.push([x,c])};y.generateSource=function(x){return"fragment"===x?[]:this._entries.map(c=>`attribute ${c[1]} ${c[0]};`)};return D}(),
q=function(){function D(){this._entries=[]}var y=D.prototype;y.add=function(x,c){this._entries.push([x,c])};y.generateSource=function(){return this._entries.map(x=>`varying ${x[1]} ${x[0]};`)};return D}(),r=function(){function D(){this._entries=new Set}var y=D.prototype;y.add=function(x){this._entries.add(x)};y.generateSource=function(x){const c="vertex"===x?D.ALLOWLIST_VERTEX:D.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(m=>c.includes(m)).map(m=>`#extension ${m} : enable`)};return D}();
r.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"];r.ALLOWLIST_VERTEX=[];let v=function(){function D(){this._entries=[]}var y=D.prototype;y.add=function(x,c,m){let h="ERROR_CONSTRUCTOR_STRING";switch(c){case "float":h=D.numberToFloatStr(m);break;case "int":h=D.numberToIntStr(m);break;case "bool":h=m.toString();break;case "vec2":h=`vec2(${D.numberToFloatStr(m[0])},\
                            ${D.numberToFloatStr(m[1])})`;break;case "vec3":h=`vec3(${D.numberToFloatStr(m[0])},\
                            ${D.numberToFloatStr(m[1])},\
                            ${D.numberToFloatStr(m[2])})`;break;case "vec4":h=`vec4(${D.numberToFloatStr(m[0])},\
                            ${D.numberToFloatStr(m[1])},\
                            ${D.numberToFloatStr(m[2])},\
                            ${D.numberToFloatStr(m[3])})`;break;case "ivec2":h=`ivec2(${D.numberToIntStr(m[0])},\
                             ${D.numberToIntStr(m[1])})`;break;case "ivec3":h=`ivec3(${D.numberToIntStr(m[0])},\
                             ${D.numberToIntStr(m[1])},\
                             ${D.numberToIntStr(m[2])})`;break;case "ivec4":h=`ivec4(${D.numberToIntStr(m[0])},\
                             ${D.numberToIntStr(m[1])},\
                             ${D.numberToIntStr(m[2])},\
                             ${D.numberToIntStr(m[3])})`;break;case "bvec2":h=`bvec2(${m[0].toString()},\
                             ${m[1].toString()})`;break;case "bvec3":h=`bvec3(${m[0].toString()},\
                             ${m[1].toString()},\
                             ${m[2].toString()})`;break;case "bvec4":h=`bvec4(${m[0].toString()},\
                             ${m[1].toString()},\
                             ${m[2].toString()},\
                             ${m[3].toString()})`;break;case "mat2":case "mat3":case "mat4":h=`${c}(${Array.prototype.map.call(m,g=>D.numberToFloatStr(g)).join(", ")})`}this._entries.push(`const ${c} ${x} = ${h};`);return this};D.numberToIntStr=function(x){return x.toFixed(0)};D.numberToFloatStr=function(x){return Number.isInteger(x)?x.toFixed(1):x.toString()};y.generateSource=function(){return Array.from(this._entries)};return D}();a.Code=u;a.Includes=l;a.ShaderBuilder=d;a.Stage=b;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.ColorConversion=function(l){l.code.add(e.glsl`
    vec4 premultiplyAlpha(vec4 v) {
      return vec4(v.rgb * v.a, v.a);
    }

    // Note: the min in the last line has been added to fix an instability in chrome.
    // See https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/23911
    // With proper floating point handling, the value could never be >1.
    vec3 rgb2hsv(vec3 c) {
      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);

      float d = q.x - min(q.w, q.y);
      float e = 1.0e-10;
      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
    }

    vec3 hsv2rgb(vec3 c) {
      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }

    float rgb2v(vec3 c) {
      return max(c.x, max(c.y, c.z));
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl":function(){define(["exports","../../shaderModules/interfaces","../util/RgbaFloatEncoding.glsl"],function(a,e,l){a.ReadLinearDepth=function(B){B.include(l.RgbaFloatEncoding);B.code.add(e.glsl`
    float linearDepthFromFloat(float depth, vec2 nearFar) {
      return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
    }

    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
      return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.RgbaFloatEncoding=function(l){l.code.add(e.glsl`
    // This is the maximum float value representable as 32bit fixed point,
    // it is rgba2float(vec4(1)) inlined.
    const float MAX_RGBA_FLOAT =
      255.0 / 256.0 +
      255.0 / 256.0 / 256.0 +
      255.0 / 256.0 / 256.0 / 256.0 +
      255.0 / 256.0 / 256.0 / 256.0 / 256.0;

    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)
    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);

    vec4 float2rgba(const float value) {
      // Make sure value is in the domain we can represent
      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);

      // Decompose value in 32bit fixed point parts represented as
      // uint8 rgba components. Decomposition uses the fractional part after multiplying
      // by a power of 256 (this removes the bits that are represented in the previous
      // component) and then converts the fractional part to 8bits.
      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);

      // Convert uint8 values (from 0 to 255) to floating point representation for
      // the shader
      const float toU8AsFloat = 1.0 / 255.0;

      return fixedPointU8 * toU8AsFloat;
    }

    // Factors to convert rgba back to float
    const vec4 RGBA_2_FLOAT_FACTORS = vec4(
      255.0 / (256.0),
      255.0 / (256.0 * 256.0),
      255.0 / (256.0 * 256.0 * 256.0),
      255.0 / (256.0 * 256.0 * 256.0 * 256.0)
    );

    float rgba2float(vec4 rgba) {
      // Convert components from 0->1 back to 0->255 and then
      // add the components together with their corresponding
      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)
      return dot(rgba, RGBA_2_FLOAT_FACTORS);
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.DiscardOrAdjustAlpha=function(l,B){const d=l.fragment;switch(B.alphaDiscardMode){case 0:d.code.add(e.glsl`
        #define discardOrAdjustAlpha(color) { if (color.a < ${e.glsl.float(.001)}) { discard; } }
      `);break;case 1:d.code.add(e.glsl`
        void discardOrAdjustAlpha(inout vec4 color) {
          color.a = 1.0;
        }
      `);break;case 2:d.uniforms.add("textureAlphaCutoff","float");d.code.add(e.glsl`
        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }
      `);break;case 3:l.fragment.uniforms.add("textureAlphaCutoff","float"),l.fragment.code.add(e.glsl`
        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }
      `)}};a.defaultMaskAlphaCutoff=.1;a.symbolAlphaCutoff=.001;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.RibbonVertexPosition=function(l,B){l.vertex.uniforms.add("intrinsicWidth","float");B.vvSize?(l.attributes.add("sizeFeatureAttribute","float"),l.vertex.uniforms.add("vvSizeMinSize","vec3"),l.vertex.uniforms.add("vvSizeMaxSize",
"vec3"),l.vertex.uniforms.add("vvSizeOffset","vec3"),l.vertex.uniforms.add("vvSizeFactor","vec3"),l.vertex.code.add(e.glsl`
    float getSize() {
      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;
    }
    `)):(l.attributes.add("size","float"),l.vertex.code.add(e.glsl`
    float getSize(){
      return intrinsicWidth * size;
    }
    `));B.vvOpacity?(l.attributes.add("opacityFeatureAttribute","float"),l.vertex.constants.add("vvOpacityNumber","int",8),l.vertex.code.add(e.glsl`
    uniform float vvOpacityValues[vvOpacityNumber];
    uniform float vvOpacityOpacities[vvOpacityNumber];

    float interpolateOpacity( float value ){
      if (value <= vvOpacityValues[0]) {
        return vvOpacityOpacities[0];
      }

      for (int i = 1; i < vvOpacityNumber; ++i) {
        if (vvOpacityValues[i] >= value) {
          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);
          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);
        }
      }

      return vvOpacityOpacities[vvOpacityNumber - 1];
    }

    vec4 applyOpacity( vec4 color ){
      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));
    }
    `)):l.vertex.code.add(e.glsl`
    vec4 applyOpacity( vec4 color ){
      return color;
    }
    `);B.vvColor?(l.attributes.add("colorFeatureAttribute","float"),l.vertex.constants.add("vvColorNumber","int",8),l.vertex.code.add(e.glsl`
    uniform float vvColorValues[vvColorNumber];
    uniform vec4 vvColorColors[vvColorNumber];

    vec4 interpolateColor( float value ) {
      if (value <= vvColorValues[0]) {
        return vvColorColors[0];
      }

      for (int i = 1; i < vvColorNumber; ++i) {
        if (vvColorValues[i] >= value) {
          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
          return mix(vvColorColors[i-1], vvColorColors[i], f);
        }
      }

      return vvColorColors[vvColorNumber - 1];
    }

    vec4 getColor(){
      return applyOpacity(interpolateColor(colorFeatureAttribute));
    }
    `)):(l.attributes.add("color","vec4"),l.vertex.code.add(e.glsl`
    vec4 getColor(){
      return applyOpacity(color);
    }
    `))};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl":function(){define(["exports","../../shaderModules/interfaces","../util/RgbaFloatEncoding.glsl"],function(a,e,l){a.OutputDepth=function(B,d){B.fragment.include(l.RgbaFloatEncoding);3===d.output?(B.extensions.add("GL_OES_standard_derivatives"),B.fragment.code.add(e.glsl`
      float _calculateFragDepth(const in float depth) {
        // calc polygon offset
        const float SLOPE_SCALE = 2.0;
        const float BIAS = 2.0 * .000015259;    // 1 / (2^16 - 1)
        float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
        float result = depth + SLOPE_SCALE * m + BIAS;
        return clamp(result, .0, .999999);
      }

      void outputDepth(float _linearDepth) {
        gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
      }
    `)):1===d.output&&B.fragment.code.add(e.glsl`
      void outputDepth(float _linearDepth) {
        gl_FragColor = float2rgba(_linearDepth);
      }
    `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.LineStipple=function(l,B){l.constants.add("stippleAlphaColorDiscard","float",.001);l.constants.add("stippleAlphaHighlightDiscard","float",.5);B.stippleEnabled?(l.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),B.stippleUVMaxEnabled&&l.varyings.add("stipplePatternUvMax","float"),
l.varyings.add("stipplePatternUv","float"),l.fragment.uniforms.add("stipplePatternTexture","sampler2D"),B.stippleOffColorEnabled&&l.fragment.uniforms.add("stippleOffColor","vec4"),l.fragment.code.add(e.glsl`
  float getStippleAlpha() {
    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;
    ${B.stippleUVMaxEnabled?"stipplePatternUvClamped \x3d clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":""}

    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;
  }`),B.stippleOffColorEnabled?l.fragment.code.add(e.glsl`
    #define discardByStippleAlpha(stippleAlpha, threshold) {}
    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)
    `):l.fragment.code.add(e.glsl`
    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }
    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)
    `)):l.fragment.code.add(e.glsl`
  float getStippleAlpha() { return 1.0; }

  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}
  #define blendStipple(color, _stippleAlpha_) color
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.PiUtils=function(l){l.vertex.code.add(e.glsl`
    const float PI = 3.141592653589793;
  `);l.fragment.code.add(e.glsl`
    const float PI = 3.141592653589793;
    const float LIGHT_NORMALIZATION = 1.0 / PI;
    const float INV_PI = 0.3183098861837907;
    const float HALF_PI = 1.570796326794897;
    `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/geometryUtils ./VisualElement ../../../../chunks/Laserlines.glsl ../../support/LaserLineRenderer".split(" "),function(a,e,l,B,d,f,u,b,p){u=function(r){function v(y){var x=r.call(this,y.view)||this;x._angleCutoff=b.defaultAngleCutoff;
x._style={};x._heightManifoldTarget=B.create();x._heightManifoldEnabled=!1;x._intersectsLine=f.lineSegment.create();x._intersectsLineEnabled=!1;x._intersectsLineInfinite=!1;x._lineVerticalPlaneSegment=null;x._pathVerticalPlaneBuffers=null;x._pointDistanceLine=null;x.applyProps(y);return x}e._inheritsLoose(v,r);var D=v.prototype;D.createResources=function(){this.ensureRenderer()};D.destroyResources=function(){this.disposeRenderer()};D.updateVisibility=function(){this.syncHeightManifold();this.syncIntersectsLine();
this.syncPathVerticalPlane();this.syncLineVerticalPlane();this.syncPointDistance()};D.syncRenderer=function(){this.attached&&(this._intersectsLineEnabled||this._heightManifoldEnabled||l.isSome(this._pointDistanceLine)||l.isSome(this._pathVerticalPlaneBuffers))?this.ensureRenderer():this.disposeRenderer()};D.ensureRenderer=function(){l.isSome(this.renderer)||(this.renderer=new p.LaserLineRenderer(this.view.renderCoordsHelper,void 0,{contrastControlEnabled:!0}),this.syncStyle(),this.syncHeightManifold(),
this.syncIntersectsLine(),this.syncIntersectsLineInfinite(),this.syncPathVerticalPlane(),this.syncLineVerticalPlane(),this.syncPointDistance(),this.syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))};D.syncStyle=function(){l.isNone(this.renderer)||(this.renderer.setParameterValues(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=this._style.intersectsLineRadius))};D.syncAngleCutoff=function(){l.isNone(this.renderer)||
this.renderer.setParameterValues({angleCutoff:this._angleCutoff})};D.syncHeightManifold=function(){l.isNone(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))};D.syncIntersectsLine=function(){l.isNone(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))};
D.syncIntersectsLineInfinite=function(){l.isNone(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)};D.syncPathVerticalPlane=function(){l.isNone(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=l.isSome(this._pathVerticalPlaneBuffers)&&this.visible,l.isSome(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))};D.syncLineVerticalPlane=function(){l.isNone(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=
l.isSome(this._lineVerticalPlaneSegment)&&this.visible,l.isSome(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))};D.syncPointDistance=function(){l.isNone(this.renderer)||(this.renderer.pointDistanceEnabled=l.isSome(this._pointDistanceLine)&&this.visible,l.isSome(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,this.renderer.pointDistanceTarget=this._pointDistanceLine.target))};D.disposeRenderer=function(){l.isSome(this.renderer)&&
this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)};e._createClass(v,[{key:"testData",get:function(){return this.renderer}},{key:"angleCutoff",get:function(){return this._angleCutoff},set:function(y){this._angleCutoff!==y&&(this._angleCutoff=y,this.syncAngleCutoff())}},{key:"style",get:function(){return this._style},set:function(y){this._style=y;this.syncStyle()}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldEnabled?this._heightManifoldTarget:
null},set:function(y){l.isSome(y)?(d.copy(this._heightManifoldTarget,y),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this.syncRenderer();this.syncHeightManifold()}},{key:"intersectsWorldUpAtLocation",set:function(y){if(l.isNone(y))this.intersectsLine=null;else{var x=this.view.renderCoordsHelper.worldUpAtPosition(y,q);this.intersectsLine=f.lineSegment.fromValues(y,x);this.intersectsLineInfinite=!0}}},{key:"intersectsLine",get:function(){return this._intersectsLineEnabled?this._intersectsLine:
null},set:function(y){l.isSome(y)?(f.lineSegment.copy(y,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1;this.syncIntersectsLine();this.syncRenderer()}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(y){this._intersectsLineInfinite=y;this.syncIntersectsLineInfinite()}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},set:function(y){this._lineVerticalPlaneSegment=l.isSome(y)?f.lineSegment.copy(y):
null;this.syncLineVerticalPlane();this.syncRenderer()}},{key:"pathVerticalPlane",get:function(){return this._pathVerticalPlaneBuffers},set:function(y){this._pathVerticalPlaneBuffers=y;this.syncPathVerticalPlane();this.syncLineVerticalPlane();this.syncPointDistance();this.syncRenderer()}},{key:"pointDistanceLine",get:function(){return this._pointDistanceLine},set:function(y){this._pointDistanceLine=l.isSome(y)?{origin:B.clone(y.origin),target:B.clone(y.target)}:null;this.syncPointDistance();this.syncRenderer()}}]);
return v}(u.VisualElement);const q=B.create();a.LaserlineVisualElement=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(f){this._resourcesCreated=this._attached=!1;this._visible=!0;this.view=f;this.view.watch("ready",u=>{this._resourcesCreated&&(u?this._createResources():this._destroyResources())})}var d=B.prototype;d.applyProps=
function(f){let u=!1;for(const b in f)b in this?"attached"===b?u=f[b]:this[b]=f[b]:console.error("Cannot set unknown property",b);this.attached=u};d.destroy=function(){this.attached=!1};d._createResources=function(){this.createResources();this._resourcesCreated=!0;this.visible||this.updateVisibility(!1)};d._destroyResources=function(){this.destroyResources();this._resourcesCreated=!1};e._createClass(B,[{key:"attached",get:function(){return this._attached},set:function(f){f!==this._attached&&this.view._stage&&
((this._attached=f)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(f){f!==this._visible&&(this._visible=f,this.attached&&this.updateVisibility(f))}}]);return B}();a.VisualElement=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl".split(" "),
function(a,e,l,B,d,f){function u(p){const q=new B.ShaderBuilder;q.extensions.add("GL_OES_standard_derivatives");q.include(d.ScreenSpacePass);q.include(f.Laserline,p);q.fragment.uniforms.add("angleCutoff","vec2");q.fragment.uniforms.add("globalAlpha","float");p.heightManifoldEnabled&&q.fragment.uniforms.add("heightPlane","vec4");p.pointDistanceEnabled&&q.fragment.uniforms.add("pointDistanceSphere","vec4");p.lineVerticalPlaneEnabled&&q.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart",
"vec3").add("lineVerticalEnd","vec3");(p.heightManifoldEnabled||p.pointDistanceEnabled||p.lineVerticalPlaneEnabled)&&q.fragment.uniforms.add("maxPixelDistance","float");p.intersectsLineEnabled&&q.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float");(p.lineVerticalPlaneEnabled||p.heightManifoldEnabled)&&q.fragment.code.add(l.glsl`
      float planeDistancePixels(vec4 plane, vec3 pos) {
        float dist = dot(plane.xyz, pos) + plane.w;
        float width = fwidth(dist);
        dist /= min(width, maxPixelDistance);
        return abs(dist);
      }`);p.pointDistanceEnabled&&q.fragment.code.add(l.glsl`
    float sphereDistancePixels(vec4 sphere, vec3 pos) {
      float dist = distance(sphere.xyz, pos) - sphere.w;
      float width = fwidth(dist);
      dist /= min(width, maxPixelDistance);
      return abs(dist);
    }
    `);p.intersectsLineEnabled&&q.fragment.code.add(l.glsl`
    float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
      float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
      return abs(dist) - radius;
    }
    `);(p.lineVerticalPlaneEnabled||p.intersectsLineEnabled)&&q.fragment.code.add(l.glsl`
    bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
      vec3 dir = end - start;
      float t2 = dot(dir, pos - start);
      float l2 = dot(dir, dir);
      return t2 >= 0.0 && t2 <= l2;
    }
    `);q.fragment.code.add(l.glsl`
  void main() {
    vec3 pos;
    vec3 normal;
    float depthDiscontinuityAlpha;

    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
      discard;
    }

    vec4 color = vec4(0, 0, 0, 0);
  `);p.heightManifoldEnabled&&q.fragment.code.add(l.glsl`
    {
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
      vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);
    }
    `);p.pointDistanceEnabled&&q.fragment.code.add(l.glsl`
    {
      // distance to sphere
      float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
      vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
      float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));

      color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
    }
    `);p.lineVerticalPlaneEnabled&&q.fragment.code.add(l.glsl`
    {
      if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
        float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);

        vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
        float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));

        color = max(color, lineVerticalColor * lineVerticalAlpha);
      }
    }
    `);p.intersectsLineEnabled&&q.fragment.code.add(l.glsl`
    {
      if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
        float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
        vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
        float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));

        color = max(color, intersectsLineColor * intersectsLineAlpha);
      }
    }
    `);q.fragment.code.add(l.glsl`
    gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
  }
  `);return q}e=e.deg2rad(6);var b=Object.freeze({__proto__:null,defaultAngleCutoff:e,build:u});a.LaserlinesShader=b;a.build=u;a.defaultAngleCutoff=e})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass":function(){define(["exports","../shaderModules/interfaces"],function(a,e){a.ScreenSpacePass=function(l){l.attributes.add("position","vec2");l.varyings.add("uv","vec2");l.vertex.code.add(e.glsl`
    void main(void) {
      gl_Position = vec4(position, 0.0, 1.0);
      uv = position * 0.5 + vec2(0.5);
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define(["exports","../shaderModules/interfaces","./output/ReadLinearDepth.glsl","./util/CameraSpace.glsl"],function(a,e,l,B){a.Laserline=function(d,f){d.extensions.add("GL_OES_standard_derivatives");d.fragment.include(l.ReadLinearDepth);d.include(B.CameraSpace);d.fragment.uniforms.add("glowColor","vec3");d.fragment.uniforms.add("glowWidth","float");d.fragment.uniforms.add("glowFalloff",
"float");d.fragment.uniforms.add("innerColor","vec3");d.fragment.uniforms.add("innerWidth","float");d.fragment.uniforms.add("depthMap","sampler2D");d.fragment.uniforms.add("nearFar","vec2");d.fragment.uniforms.add("frameColor","sampler2D");f.contrastControlEnabled&&d.fragment.uniforms.add("globalAlphaContrastBoost","float");d.fragment.code.add(e.glsl`
  vec4 blendPremultiplied(vec4 source, vec4 dest) {
    float oneMinusSourceAlpha = 1.0 - source.a;

    return vec4(
      source.rgb + dest.rgb * oneMinusSourceAlpha,
      source.a + dest.a * oneMinusSourceAlpha
    );
  }
  `);d.fragment.code.add(e.glsl`
  vec4 premultipliedColor(vec3 rgb, float alpha) {
    return vec4(rgb * alpha, alpha);
  }
  `);d.fragment.code.add(e.glsl`
  vec4 laserlineProfile(float dist) {
    if (dist > glowWidth) {
      return vec4(0.0);
    }

    float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
    float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);

    return blendPremultiplied(
      premultipliedColor(innerColor, innerAlpha),
      premultipliedColor(glowColor, glowAlpha)
    );
  }
  `);d.fragment.code.add(e.glsl`
  bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
    float depth = linearDepthFromTexture(depthMap, uv, nearFar);

    if (-depth == nearFar[0]) {
      return false;
    }

    pos = reconstructPosition(gl_FragCoord.xy, depth);
    normal = normalize(cross(dFdx(pos), dFdy(pos)));

    float ddepth = fwidth(depth);
    depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);

    return true;
  }
  `);f.contrastControlEnabled?d.fragment.code.add(e.glsl`
    float rgbToLuminance(vec3 color) {
      return dot(vec3(0.2126, 0.7152, 0.0722), color);
    }

    vec4 laserlineOutput(vec4 color) {
      float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
      float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);

      return color * alpha;
    }
    `):d.fragment.code.add(e.glsl`
    vec4 laserlineOutput(vec4 color) {
      return color * globalAlpha;
    }
    `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/CameraSpace.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.CameraSpace=function(l){l.fragment.uniforms.add("projInfo","vec4");l.fragment.uniforms.add("zScale","vec2");l.fragment.code.add(e.glsl`
    vec3 reconstructPosition(vec2 fragCoord, float depth) {
      return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/mathUtils ../../../chunks/vec3f64 ../../../chunks/vec3 ../../../chunks/vec2f64 ../../../chunks/vec4f64 ../../../chunks/vec4 ./geometryUtils ../webgl-engine/lib/Util ../webgl-engine/lib/glUtil3D ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ./LaserlinePathData ../webgl-engine/shaders/LaserlineTechnique".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){function m(t,A,z,w){const F=h,E=g;f.transformMat4(F,A,w);f.copy(E,z);E[3]=0;p.transformMat4(E,E,w);q.plane.fromPositionAndNormal(F,E,t)}const h=d.create(),g=b.create(),k={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:B.deg2rad(6),globalAlphaContrastBoost:2};B=function(){function t(z,w={},F={contrastControlEnabled:!1}){this._renderCoordsHelper=z;this._config=F;this._technique=null;this._projInfo=b.create();
this._zScale=u.create();this._heightManifoldEnabled=!1;this._heightManifoldTarget=d.create();this._pointDistanceEnabled=!1;this._pointDistanceOrigin=d.create();this._pointDistanceTarget=d.create();this._lineVerticalPlaneEnabled=!1;this._lineVerticalPlaneSegment=q.lineSegment.create();this._intersectsLineEnabled=!1;this._intersectsLineSegment=q.lineSegment.create();this._intersectsLineRadius=3;this._pathVerticalPlaneEnabled=this._intersectsLineInfinite=!1;this._pathTechnique=this._pathVerticalPlaneData=
null;this.canRender=!0;this._tempNormal=d.create();this._tempDir=d.create();this._tempUp=d.create();this._tempVec3A=d.create();this._tempVec3B=d.create();this._tempVec4=b.create();this._tempPlane=q.plane.create();this._tempSphere=q.sphere.create();this._params=D.copyParameters(w,k)}var A=t.prototype;A.setParameterValues=function(z){D.updateParameters(this._params,z)&&this._requestRender()};A.initializeRenderContext=function(z){this._context=z;this._quadVAO=v.createQuadVAO(z.renderContext.rctx);this._techniqueRepository=
z.shaderTechniqueRep;this._techniqueConfig=new c.LaserlineTechniqueConfiguration;this._pathTechniqueConfig=new y.LaserlinePathTechniqueConfiguration};A.uninitializeRenderContext=function(){this._quadVAO=l.disposeMaybe(this._quadVAO);this._techniqueRepository.release(this._technique);this._technique=null;this._pathVerticalPlaneData=l.disposeMaybe(this._pathVerticalPlaneData);this._techniqueRepository.release(this._pathTechnique);this._pathTechnique=null};A.render=function(z){const w=this.heightManifoldEnabled||
this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled,F=this.pathVerticalPlaneEnabled;if(!w&&!F)return!0;const E=z.camera;r.inverseProjectionInfo(E.projectionMatrix,E.fullWidth,E.fullHeight,this._projInfo,this._zScale);w&&this.renderUnified(z);F&&this.renderPath(z);return!0};A.renderUnified=function(z){const w=z.rctx,F=this._selectTechnique(),E=F.program;w.bindProgram(E);F.bindPipelineState(w);this.bindGlobalUniforms(z,E);this.bindHeightManifoldUniforms(z,E);this.bindPointDistanceUniforms(z,
E);this.bindLineVerticalPlaneUniforms(z,E);this.bindIntersectsLineUniforms(z,E);F.bind(this._params,z.camera);w.bindVAO(this._quadVAO);w.drawArrays(5,0,4)};A.renderPath=function(z){if(!l.isNone(this._pathVerticalPlaneData)){this._pathTechniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquireAndReleaseExisting(y.LaserlinePathTechnique,this._pathTechniqueConfig,this._pathTechnique);var w=z.rctx,F=this._pathTechnique,E=F.program;w.bindProgram(E);
F.bindPipelineState(w);this.bindGlobalUniforms(z,E);F.bind(this._params,this._pathVerticalPlaneData.origin,z.camera);this._pathVerticalPlaneData.draw(z.rctx)}};A.bindHeightManifoldUniforms=function(z,w){if(this.heightManifoldEnabled){var F=this._tempVec3A,E=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,F);m(E,this._heightManifoldTarget,F,z.camera.viewMatrix);w.setUniform4fv("heightPlane",E)}};A.bindPointDistanceUniforms=function(z,w){if(this._pointDistanceEnabled){z=
z.camera;var F=this._tempSphere;f.copy(F,this._pointDistanceOrigin);f.transformMat4(F,F,z.viewMatrix);F[3]=f.distance(this._pointDistanceOrigin,this._pointDistanceTarget);w.setUniform4f("pointDistanceSphere",F[0],F[1],F[2],F[3])}};A.bindLineVerticalPlaneUniforms=function(z,w){if(this._lineVerticalPlaneEnabled){var F=this._renderCoordsHelper;z=z.camera;var E=this._tempPlane,N=this._tempVec3A,U=this._tempUp,S=this._tempDir,I=this._tempNormal;q.lineSegment.pointAt(this._lineVerticalPlaneSegment,.5,N);
F.worldUpAtPosition(N,U);f.normalize(S,this._lineVerticalPlaneSegment.vector);f.cross(I,U,S);f.normalize(I,I);m(E,this._lineVerticalPlaneSegment.origin,I,z.viewMatrix);w.setUniform4fv("lineVerticalPlane",E);E=this._tempVec3A;f.copy(E,this._lineVerticalPlaneSegment.origin);F.setAltitude(0,E);f.transformMat4(E,E,z.viewMatrix);w.setUniform3fv("lineVerticalStart",E);E=this._tempVec3B;f.add(E,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector);F.setAltitude(0,E);f.transformMat4(E,
E,z.viewMatrix);w.setUniform3fv("lineVerticalEnd",E)}};A.bindIntersectsLineUniforms=function(z,w){if(this._intersectsLineEnabled){var F=G,E=C;if(this._intersectsLineInfinite){var N=z.camera;q.clipRay.fromRay(q.ray.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),n);n.c0=-Number.MAX_VALUE;if(!q.frustum.intersectClipRay(N.frustum,n))return;q.clipRay.getStart(n,F);q.clipRay.getEnd(n,E)}else f.copy(F,this._intersectsLineSegment.origin),f.add(E,this._intersectsLineSegment.origin,
this._intersectsLineSegment.vector);N=this._tempVec3A;f.transformMat4(N,F,z.camera.viewMatrix);w.setUniform3fv("intersectsLineStart",N);F=this._tempVec4;f.copy(F,this._intersectsLineSegment.vector);this._tempVec4[3]=0;p.transformMat4(this._tempVec4,this._tempVec4,z.camera.viewMatrix);f.transformMat4(E,E,z.camera.viewMatrix);w.setUniform3fv("intersectsLineEnd",E);f.normalize(F,F);w.setUniform3f("intersectsLineDirection",F[0],F[1],F[2]);w.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}};
A.bindGlobalUniforms=function(z,w){const F=z.camera;w.setUniform4fv("projInfo",this._projInfo);w.setUniform2fv("zScale",this._zScale);w.setUniform2f("nearFar",F.near,F.far);this._heightManifoldEnabled?w.setUniform1f("maxPixelDistance",2*F.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?w.setUniform1f("maxPixelDistance",2*F.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&w.setUniform1f("maxPixelDistance",2*F.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin));
w.setUniform1i("depthMap",0);z.rctx.bindTexture(z.offscreenRenderingHelper.linearDepthTexture,0);w.setUniform1i("frameColor",1);z.rctx.bindTexture(z.offscreenRenderingHelper.mainColorTexture,1)};A._requestRender=function(){this._context&&this._context.requestRender()};A._selectTechnique=function(){this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled;this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled;this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled;
this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled;this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled;return this._technique=this._techniqueRepository.acquireAndReleaseExisting(c.LaserlineTechnique,this._techniqueConfig,this._technique)};e._createClass(t,[{key:"renderSlots",get:function(){return[this._config.contrastControlEnabled?17:16]}},{key:"needsLinearDepth",get:function(){return!0}},{key:"heightManifoldEnabled",get:function(){return this._heightManifoldEnabled},
set:function(z){this._heightManifoldEnabled!==z&&(this._heightManifoldEnabled=z,this._requestRender())}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldTarget},set:function(z){f.copy(this._heightManifoldTarget,z);this._requestRender()}},{key:"pointDistanceEnabled",get:function(){return this._pointDistanceEnabled},set:function(z){z!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=z,this._requestRender())}},{key:"pointDistanceTarget",get:function(){return this._pointDistanceTarget},
set:function(z){f.copy(this._pointDistanceTarget,z);this._requestRender()}},{key:"pointDistanceOrigin",get:function(){return this._pointDistanceOrigin},set:function(z){f.copy(this._pointDistanceOrigin,z);this._requestRender()}},{key:"lineVerticalPlaneEnabled",get:function(){return this._lineVerticalPlaneEnabled},set:function(z){z!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=z,this._requestRender())}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},
set:function(z){q.lineSegment.copy(z,this._lineVerticalPlaneSegment);this._requestRender()}},{key:"intersectsLineEnabled",get:function(){return this._intersectsLineEnabled},set:function(z){z!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=z,this._requestRender())}},{key:"intersectsLineSegment",get:function(){return this._intersectsLineSegment},set:function(z){q.lineSegment.copy(z,this._intersectsLineSegment);this._requestRender()}},{key:"intersectsLineRadius",get:function(){return this._intersectsLineRadius},
set:function(z){z!==this._intersectsLineRadius&&(this._intersectsLineRadius=z,this._requestRender())}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(z){z!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=z,this._requestRender())}},{key:"pathVerticalPlaneEnabled",get:function(){return this._pathVerticalPlaneEnabled},set:function(z){z!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=z,l.isSome(this._pathVerticalPlaneData)&&
this._requestRender())}},{key:"pathVerticalPlaneVertices",set:function(z){l.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new x.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.vertices=z;this.pathVerticalPlaneEnabled&&this._requestRender()}},{key:"pathVerticalPlaneBuffers",set:function(z){l.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new x.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.buffers=z;this.pathVerticalPlaneEnabled&&
this._requestRender()}}]);return t}();const n=q.clipRay.create(),G=d.create(),C=d.create();a.LaserLineRenderer=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/glUtil3D":function(){define("exports ./DefaultVertexAttributeLocations ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ./DefaultVertexBufferLayouts".split(" "),function(a,e,l,B,d,f){a.createColorTexture=function(u,b,p=4){const q=new Uint8Array(p*p*4);for(let r=0;r<q.length;r+=
4)q[r+0]=255*b[0],q[r+1]=255*b[1],q[r+2]=255*b[2],q[r+3]=255*b[3];return new B(u,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:p,height:p},q)};a.createEmptyDepthTexture=function(u){return new B(u,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))};a.createEmptyTexture=function(u,b=4){return new B(u,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:b,height:b})};a.createQuadVAO=function(u,b=f.Pos2,
p=e.Default3D,q=-1,r=1){let v=null;switch(b){case f.Pos2Tex:v=new Float32Array([q,q,0,0,r,q,1,0,q,r,0,1,r,r,1,1]);break;default:v=new Float32Array([q,q,r,q,q,r,r,r])}return new d(u,p,{geometry:b},{geometry:l.createVertex(u,35044,v)})};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/BufferObject":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/typedArrayUtil","./checkWebGLError"],function(a,e,l){return function(){function B(f,u,b,p,q){this._context=f;this.bufferType=
u;this.usage=b;this._glName=null;this._size=-1;this._indexType=void 0;f.instanceCounter.increment(1,this);this._glName=this._context.gl.createBuffer();l.checkWebGLError(this._context.gl);p&&this.setData(p,q)}B.createIndex=function(f,u,b,p){return new B(f,34963,u,b,p)};B.createVertex=function(f,u,b){return new B(f,34962,u,b)};var d=B.prototype;d.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(1,
this),this._context=null)};d.setData=function(f,u){if(f){if("number"===typeof f){if(0>f&&console.error("Buffer size cannot be negative!"),34963===this.bufferType&&u)switch(this._indexType=u,this._size=f,u){case 5123:f*=2;break;case 5125:f*=4}}else u=f.byteLength,e.isUint16Array(f)&&(u/=2,this._indexType=5123),e.isUint32Array(f)&&(u/=4,this._indexType=5125),this._size=u;u=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this.bufferType,
f,this.usage);this._context.bindVAO(u)}};d.setSubData=function(f,u=0,b=0,p=f.byteLength){if(f){(0>u||u>=this._size)&&console.error("offset is out of range!");var q=u,r=b,v=p,D=f.byteLength;e.isUint16Array(f)&&(D/=2,q*=2,r*=2,v*=2);e.isUint32Array(f)&&(D/=4,q*=4,r*=4,v*=4);void 0===p&&(p=D-1);b>=p&&console.error("end must be bigger than start!");u+b-p>this._size&&console.error("An attempt to write beyond the end of the buffer!");u=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);
b=this._context.gl;p=ArrayBuffer.isView(f)?f.buffer:f;f=0===r&&v===f.byteLength?p:p.slice(r,v);b.bufferSubData(this.bufferType,q,f);this._context.bindVAO(u)}};a._createClass(B,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}}]);return B}()})},"esri/views/webgl/checkWebGLError":function(){define(["exports",
"../../core/has","../../core/Logger","../../core/Error"],function(a,e,l,B){l.getLogger("esri/views/webgl");a.checkWebGLError=function(d){};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/Texture":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/maybe","../../core/mathUtils","./capabilities/isWebGL2Context"],function(a,e,l,B){return function(){function d(u,b,p=null){this._glName=this._context=null;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=
!1;u.instanceCounter.increment(0,this);this._context=u;this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...b};this.setData(p)}var f=d.prototype;f.dispose=function(){if(this._context&&this._context.gl){if(this._glName){const u=this._context.gl;this._context.unbindTextureAllUnits(this);u.deleteTexture(this._glName);this._glName=null}this._context.instanceCounter.decrement(0,this);this._context=null}};f.release=function(){this.dispose()};
f.resize=function(u,b){const p=this._descriptor;if(p.width!==u||p.height!==b)p.width=u,p.height=b,this.setData(null)};f.setData=function(u){if(this._context&&this._context.gl){var b=this._context.gl;this._glName||(this._glName=b.createTexture());void 0===u&&(u=null);null===u&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var p=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var q=this._descriptor;d._validateTexture(this._context,
q);b.pixelStorei(b.UNPACK_ALIGNMENT,q.unpackAlignment);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,q.flipped?1:0);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.preMultiplyAlpha?1:0);var r=q.pixelFormat,v=q.internalFormat?q.internalFormat:r;if(u instanceof ImageData||u instanceof HTMLImageElement||u instanceof HTMLCanvasElement||u instanceof HTMLVideoElement){var D=u.width,y=u.height;u instanceof HTMLVideoElement&&(D=u.videoWidth,y=u.videoHeight);q.width&&q.height&&console.assert(D===q.width&&y===q.height);
b.texImage2D(b.TEXTURE_2D,0,v,r,q.dataType,u);q.hasMipmap&&this.generateMipmap();void 0===q.width&&(q.width=D);void 0===q.height&&(q.height=y)}else{null!=q.width&&null!=q.height||console.error("Width and height must be specified!");b.DEPTH24_STENCIL8&&v===b.DEPTH_STENCIL&&(v=b.DEPTH24_STENCIL8);D=q.width;y=q.height;var x=u;if(e.isSome(x)&&"type"in x&&"compressed"===x.type)for(r=Math.round(Math.log(Math.max(D,y))/Math.LN2)+1,q.hasMipmap=q.hasMipmap&&r===u.levels.length,r=0;;++r){b.compressedTexImage2D(b.TEXTURE_2D,
r,v,D,y,0,u.levels[Math.min(r,u.levels.length-1)]);if(1===D&&1===y||!q.hasMipmap)break;D=Math.max(1,D>>1);y=Math.max(1,y>>1)}else if(e.isSome(u))b.texImage2D(b.TEXTURE_2D,0,v,D,y,0,r,q.dataType,u),q.hasMipmap&&this.generateMipmap();else for(u=0;;++u){b.texImage2D(b.TEXTURE_2D,u,v,D,y,0,r,q.dataType,null);if(1===D&&1===y||!q.hasMipmap)break;D=Math.max(1,D>>1);y=Math.max(1,y>>1)}}d._applySamplingMode(b,this._descriptor);d._applyWrapMode(b,this._descriptor);d._applyAnisotropicFilteringParameters(this._context,
this._descriptor);p&&this._context.bindTexture(p,0)}};f.updateData=function(u,b,p,q,r,v){v||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const D=this._context.gl,y=this._descriptor,x=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>b||0>p||q>y.width||r>y.height||b+q>y.width||p+r>y.height)&&console.error("An attempt to update out of bounds of the texture!");D.pixelStorei(D.UNPACK_ALIGNMENT,y.unpackAlignment);
D.pixelStorei(D.UNPACK_FLIP_Y_WEBGL,y.flipped?1:0);D.pixelStorei(D.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.preMultiplyAlpha?1:0);v instanceof ImageData||v instanceof HTMLImageElement||v instanceof HTMLCanvasElement||v instanceof HTMLVideoElement?D.texSubImage2D(D.TEXTURE_2D,u,b,p,y.pixelFormat,y.dataType,v):D.texSubImage2D(D.TEXTURE_2D,u,b,p,q,r,y.pixelFormat,y.dataType,v);this._context.bindTexture(x,0)};f.generateMipmap=function(){var u=this._descriptor;u.hasMipmap||(this._samplingModeDirty=u.hasMipmap=
!0,d._validateTexture(this._context,u));9729===u.samplingMode?(this._samplingModeDirty=!0,u.samplingMode=9985):9728===u.samplingMode&&(this._samplingModeDirty=!0,u.samplingMode=9984);u=this._context.getBoundTexture(0);this._context.bindTexture(this,0);const b=this._context.gl;b.generateMipmap(b.TEXTURE_2D);this._context.bindTexture(u,0)};f.setSamplingMode=function(u){u!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=u,d._validateTexture(this._context,this._descriptor),this._samplingModeDirty=
!0)};f.setWrapMode=function(u){u!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=u,d._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)};f.applyChanges=function(){const u=this._context.gl,b=this._descriptor;this._samplingModeDirty&&(d._applySamplingMode(u,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(d._applyWrapMode(u,b),this._wrapModeDirty=!1)};d._validateTexture=function(u,b){(0>b.width||0>b.height)&&console.error("Negative dimension parameters are not allowed!");
const p=l.isPowerOfTwo(b.width)&&l.isPowerOfTwo(b.height);B(u.gl)||p||("number"===typeof b.wrapMode?33071!==b.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(33071!==b.wrapMode.s||33071!==b.wrapMode.t)&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};d._applySamplingMode=function(u,b){let p=b.samplingMode,q=b.samplingMode;if(9985===p||9987===p)p=
9729,b.hasMipmap||(q=9729);else if(9984===p||9986===p)p=9728,b.hasMipmap||(q=9728);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,p);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,q)};d._applyWrapMode=function(u,b){"number"===typeof b.wrapMode?(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,b.wrapMode),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,b.wrapMode)):(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,b.wrapMode.s),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,b.wrapMode.t))};d._applyAnisotropicFilteringParameters=
function(u,b){if(null!=b.maxAnisotropy){var p=u.capabilities.textureFilterAnisotropic;p&&(u=u.gl,u.texParameterf(u.TEXTURE_2D,p.TEXTURE_MAX_ANISOTROPY,b.maxAnisotropy))}};a._createClass(d,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}}]);return d}()})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(a){return window.WebGL2RenderingContext&&a instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/VertexArrayObject":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"../../core/maybe","./Util"],function(a,e,l){return function(){function B(f,u,b,p,q){this._context=f;this._locations=u;this._layout=b;this._buffers=p;this._indexBuffer=q;this._glName=null;this._initialized=!1;f.instanceCounter.increment(2,this)}var d=B.prototype;d.dispose=function(f=!0){if(this._context){var u=this._context.capabilities.vao;u&&this._glName&&(u.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(f){for(const b in this._buffers)this._buffers[b].dispose(),
delete this._buffers[b];this._indexBuffer=e.disposeMaybe(this._indexBuffer)}this._context.instanceCounter.decrement(2,this);this._context=null}};d.initialize=function(){if(!this._initialized){var f=this._context.capabilities.vao;if(f){const u=f.createVertexArray();f.bindVertexArray(u);this._bindLayout();f.bindVertexArray(null);this._glName=u}this._initialized=!0}};d.bind=function(){this.initialize();const f=this._context.capabilities.vao;f?f.bindVertexArray(this.glName):(this._context.bindVAO(null),
this._bindLayout())};d._bindLayout=function(){const f=this._buffers,u=!!this._context.capabilities.vao,b=this._layout,p=this._indexBuffer;f||console.error("Vertex buffer dictionary is empty!");const q=this._context.gl;for(const r in f){const v=f[r];v||console.error("Vertex buffer is uninitialized!");const D=b[r];D||console.error("Vertex element descriptor is empty!");l.bindVertexBufferLayout(this._context,this._locations,v,D)}p&&(u?q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,p.glName):this._context.bindBuffer(p))};
d.unbind=function(){this.initialize();const f=this._context.capabilities.vao;f?f.bindVertexArray(null):this._unbindLayout()};d._unbindLayout=function(){const f=this._buffers,u=this._layout;f||console.error("Vertex buffer dictionary is empty!");for(const b in f){const p=f[b];p||console.error("Vertex buffer is uninitialized!");l.unbindVertexBufferLayout(this._context,this._locations,p,u[b])}this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)};a._createClass(B,[{key:"glName",
get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){return Object.keys(this._buffers).reduce((f,u)=>f+this._buffers[u].size,this._indexBuffer?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}}]);return B}()})},"esri/views/webgl/Util":function(){define(["exports","../../core/has","../../core/maybe"],
function(a,e,l){function B(b){return b[0].stride}function d(b){switch(b){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw Error("Unknown data type");}}function f(b){switch(b){case 6406:case 6409:case 36168:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;case 33328:case 34842:return 8;
case 34836:return 16;case 33776:case 33777:return.5;case 33778:case 33779:return 1;case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5;case 37490:case 37491:case 37496:case 37497:return 1}return 0}function u(b){if(l.isNone(b))return 0;if("colorAttachment"in b)return b.glName?u(b.colorAttachment)+u(b.depthStencilAttachment):0;if("descriptor"in b)return b.glName?u(b.descriptor):0;const p=b.internalFormat||"pixelFormat"in b&&b.pixelFormat;if(!p)return 0;const q="hasMipmap"in b&&
b.hasMipmap?1.3:1;b=b.width*b.height;return f(p)*b*q}a.addDescriptor=function(b,p,q,r,v,D){const y=d(r);if(0<b.length){const x=b[0].stride,c=x+y*q;b.forEach(m=>m.stride=c);b.push({name:p,count:q,type:r,offset:x,stride:c,normalized:v,divisor:D})}else b.push({name:p,count:q,type:r,offset:0,stride:y*q,normalized:v,divisor:D})};a.bindVertexBufferLayout=function(b,p,q,r,v){const D=b.gl,y=b.capabilities.instancing;b.bindBuffer(q);for(const x of r)if(b=p[x.name],q=(v?v:0+x.baseInstance?x.baseInstance:0)*
x.stride,void 0===b&&console.error(`There is no location for vertex attribute '${x.name}' defined.`),x.baseInstance&&!x.divisor&&console.error(`Vertex attribute '${x.name}' uses baseInstanceOffset without divisor.`),4>=x.count)D.vertexAttribPointer(b,x.count,x.type,x.normalized,x.stride,x.offset+q),D.enableVertexAttribArray(b),x.divisor&&0<x.divisor&&y&&y.vertexAttribDivisor(b,x.divisor);else if(9===x.count)for(r=0;3>r;r++)D.vertexAttribPointer(b+r,3,x.type,x.normalized,x.stride,x.offset+12*r+q),
D.enableVertexAttribArray(b+r),x.divisor&&0<x.divisor&&y&&y.vertexAttribDivisor(b+r,x.divisor);else if(16===x.count)for(r=0;4>r;r++)D.vertexAttribPointer(b+r,4,x.type,x.normalized,x.stride,x.offset+16*r+q),D.enableVertexAttribArray(b+r),x.divisor&&0<x.divisor&&y&&y.vertexAttribDivisor(b+r,x.divisor);else console.error("Unsupported vertex attribute element count: "+x.count)};a.copyFramebufferToTexture=function(b,p,q,r,v=0){const D=b.getBoundFramebufferObject(),y=b.getBoundTexture(0);b.bindFramebuffer(p);
b.bindTexture(q,0);b.gl.copyTexImage2D(b.gl.TEXTURE_2D,v,q.descriptor.pixelFormat,r[0],r[1],r[2],r[3],0);b.gl.flush();b.bindFramebuffer(D);b.bindTexture(y,0)};a.findAttribute=function(b,p){for(let q=0;q<b.length;q++)if(b[q].name===p)return b[q];return null};a.getBytesPerElement=d;a.getBytesPerElementFormat=f;a.getGpuMemoryUsage=u;a.getStride=B;a.getTypedArrayConstructor=function(b){switch(b){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;
case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw Error("Unknown data type");}};a.hasAttribute=function(b,p){for(let q=0;q<b.length;q++)if(b[q].name===p)return!0;return!1};a.setBaseInstanceOffset=function(b,p){const q={};for(const r in b)q[r]=b[r].map(v=>v.divisor?{...v,baseInstance:p}:v);return q};a.unbindVertexBufferLayout=function(b,p,q,r){const v=b.gl,D=b.capabilities.instancing;b.bindBuffer(q);for(const y of r)if(q=p[y.name],4>=y.count)v.disableVertexAttribArray(q),
y.divisor&&0<y.divisor&&D&&D.vertexAttribDivisor(q,0);else if(9===y.count)for(r=0;3>r;r++)v.disableVertexAttribArray(q+r),y.divisor&&0<y.divisor&&D&&D.vertexAttribDivisor(q+r,0);else if(16===y.count)for(r=0;4>r;r++)v.disableVertexAttribArray(q+r),y.divisor&&0<y.divisor&&D&&D.vertexAttribDivisor(q+r,0);else console.error("Unsupported vertex attribute element count: "+y.count);b.unbindBuffer(34962)};a.vertexCount=function(b,p){return b.vertexBuffers[p].size/B(b.layout[p])};Object.defineProperty(a,"__esModule",
{value:!0})})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["exports"],function(a){a.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];a.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];a.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];a.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",
count:4,type:5121,offset:12,stride:16,normalized:!1}];a.Pos3NormalTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];a.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../../../webgl/Program ../../../webgl/renderState ../../../../chunks/LaserlinePath.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){b=function(y){function x(){return y.apply(this,arguments)||this}l._inheritsLoose(x,y);var c=x.prototype;c.initializeProgram=function(m){const h=x.shader.get().build(this.configuration);return new q(m.rctx,h.generateSource("vertex"),h.generateSource("fragment"),x.attributeLocations)};c.bind=function(m,h,g){this.program.setUniform3fv("innerColor",m.innerColor);this.program.setUniform1f("innerWidth",m.innerWidth*g.pixelRatio);this.program.setUniform3fv("glowColor",m.glowColor);
this.program.setUniform1f("glowWidth",m.glowWidth*g.pixelRatio);this.program.setUniform1f("glowFalloff",m.glowFalloff);this.program.setUniform1f("globalAlpha",m.globalAlpha);this.program.setUniform1f("perScreenPixelRatio",g.perScreenPixelRatio);this.program.setUniform2f("pixelToNDC",2/g.fullWidth,2/g.fullHeight);this.program.setUniformMatrix4fv("uProjectionMatrix",g.projectionMatrix);d.translate(D,g.viewMatrix,h);this.program.setUniformMatrix4fv("uModelViewMatrix",D);this.configuration.contrastControlEnabled&&
this.program.setUniform1f("globalAlphaContrastBoost",null!=m.globalAlphaContrastBoost?m.globalAlphaContrastBoost:1)};c.initializePipeline=function(){return r.makePipelineState({blending:r.simpleBlendingParams(1,771),colorWrite:r.defaultColorWriteParams})};c.bindPipelineState=function(m){m.setPipelineState(this.pipeline)};return x}(b.ShaderTechnique);b.shader=new u.ReloadableShaderModule(v.LaserlinePathShader,()=>new Promise(function(y,x){a(["./LaserlinePath.glsl"],y,x)}));b.attributeLocations={start:0,
end:1,up:2,extrude:3};u=function(y){function x(){var c=y.apply(this,arguments)||this;c.contrastControlEnabled=!1;return c}l._inheritsLoose(x,y);return x}(p.ShaderTechniqueConfiguration);B.__decorate([p.parameter()],u.prototype,"contrastControlEnabled",void 0);const D=f.create();e.LaserlinePathTechnique=b;e.LaserlinePathTechniqueConfiguration=u;Object.defineProperty(e,"__esModule",{value:!0})})},"esri/chunks/LaserlinePath.glsl":function(){define(["exports","../views/3d/webgl-engine/core/shaderModules/interfaces",
"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder","../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl"],function(a,e,l,B){function d(u){const b=new l.ShaderBuilder;b.include(B.Laserline,u);b.vertex.uniforms.add("uModelViewMatrix","mat4");b.vertex.uniforms.add("uProjectionMatrix","mat4");b.attributes.add("start","vec3");b.attributes.add("end","vec3");b.attributes.add("up","vec3");b.attributes.add("extrude","vec2");b.varyings.add("uv","vec2");b.varyings.add("vViewStart","vec3");b.varyings.add("vViewEnd",
"vec3");b.varyings.add("vViewPlane","vec4");b.vertex.uniforms.add("glowWidth","float");b.vertex.uniforms.add("pixelToNDC","vec2");b.vertex.code.add(e.glsl`
  void main() {
    vec3 pos = mix(start, end, extrude.x);

    vec4 viewPos = uModelViewMatrix * vec4(pos, 1);
    vec4 projPos = uProjectionMatrix * viewPos;
    vec2 ndcPos = projPos.xy / projPos.w;

    vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;
    vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);
    vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);

    vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
    ndcPos += length(lxy) * projExtrudeDir;

    vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
    vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;

    vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;
    vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;
    vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));

    // Add enough padding in the X screen space direction for glow
    float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
    ndcPos.x += xPaddingPixels * pixelToNDC.x;

    uv = ndcPos * 0.5 + 0.5;
    gl_Position = vec4(ndcPos, 0, 1);
  }
  `);b.fragment.uniforms.add("globalAlpha","float");b.fragment.uniforms.add("perScreenPixelRatio","float");b.fragment.code.add(e.glsl`
  float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
    vec3 origin = mix(start, end, 0.5);
    vec3 basis = end - origin;
    vec3 posAtOrigin = pos - origin;

    float x = dot(normalize(basis), posAtOrigin);
    float y = dot(plane.xyz, posAtOrigin);

    float dx = max(abs(x) - length(basis), 0.0);
    float dy = y;

    float dist = length(vec2(dx, dy));

    float width = fwidth(y);
    float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
    float pixelDist = dist / min(width, maxPixelDistance);
    return abs(pixelDist);
  }

  void main() {
    vec3 pos;
    vec3 normal;
    float depthDiscontinuityAlpha;

    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
      discard;
    }

    float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);

    vec4 color = laserlineProfile(distance);
    float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));

    gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
  }
  `);return b}var f=Object.freeze({__proto__:null,build:d});a.LaserlinePathShader=f;a.build=d})},"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3f64 ../../../chunks/vec3 ../../webgl/Program ./buffer/glUtil ./buffer/InterleavedLayout ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../webgl-engine/shaders/LaserlinePathTechnique".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){f=function(){function n(C){this._renderCoordsHelper=C;this._buffers=null;this._origin=B.create();this._dirty=!1;this._count=0;this._vao=null}var G=n.prototype;G.draw=function(C){const t=this.ensureVAO(C);l.isSome(t)&&(C.bindVAO(t),C.drawArrays(4,0,this._count))};G.dispose=function(){l.isSome(this._vao)&&this._vao.dispose()};G.ensureVAO=function(C){if(l.isNone(this._buffers))return null;l.isNone(this._vao)&&(this._vao=this.createVAO(C,this._buffers));this.ensureVertexData(this._vao,
this._buffers);return this._vao};G.createVAO=function(C,t){t=this.createDataBuffer(t);this._dirty=!1;return new r(C,m.LaserlinePathTechnique.attributeLocations,{data:u.glLayout(k)},{data:p.createVertex(C,35044,t)})};G.ensureVertexData=function(C,t){this._dirty&&(t=this.createDataBuffer(t),C.vertexBuffers.data.setData(t),this._dirty=!1)};G.numberOfRenderVertices=function(C){return 6*(C.length/3-1)};G.createDataBuffer=function(C){var t=C.reduce((N,U)=>N+this.numberOfRenderVertices(U),0);this._count=
t;t=k.createBuffer(t);const A=this._origin;let z=0,w=0;for(const N of C){for(C=0;C<N.length;C+=3){var F=d.set(g,N[C+0],N[C+1],N[C+2]);0===C?w=this._renderCoordsHelper.getAltitude(F):this._renderCoordsHelper.setAltitude(w,F);var E=this._renderCoordsHelper.worldUpAtPosition(F,h);const U=z+2*C;F=d.subtract(g,F,A);if(C<N.length-3){t.up.setVec(U,E);t.up.setVec(U+3,E);t.up.setVec(U+5,E);for(let S=0;6>S;S++)t.start.setVec(U+S,F);t.extrude.setValues(U+0,0,-1);t.extrude.setValues(U+1,1,-1);t.extrude.setValues(U+
2,1,1);t.extrude.setValues(U+3,0,-1);t.extrude.setValues(U+4,1,1);t.extrude.setValues(U+5,0,1)}if(0<C)for(t.up.setVec(U-2,E),t.up.setVec(U-4,E),t.up.setVec(U-5,E),E=-6;0>E;E++)t.end.setVec(U+E,F)}z+=this.numberOfRenderVertices(N)}return t.buffer};e._createClass(n,[{key:"vertices",set:function(C){const t=new Float64Array(3*C.length);let A=0;for(const z of C)t[A++]=z[0],t[A++]=z[1],t[A++]=z[2];this.buffers=[t]}},{key:"buffers",set:function(C){this._buffers=C;if(0<this._buffers.length){C=this._buffers[0];
const t=3*Math.floor(C.length/3/2);d.set(this._origin,C[t+0],C[t+1],C[t+2])}else d.set(this._origin,0,0,0);this._dirty=!0}},{key:"origin",get:function(){return this._origin}}]);return n}();const h=B.create(),g=B.create(),k=b.newLayout().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude");a.LaserlinePathData=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/glUtil":function(){define(["exports"],function(a){const e={divisor:0},l={u8:5121,u16:5123,u32:5125,i8:5120,
i16:5122,i32:5124,f32:5126};a.glLayout=function(B,d={}){d={...e,...d};const f=B.stride;return B.fieldNames.filter(u=>{u=B.fields.get(u).optional;return!(u&&u.glPadding)}).map(u=>{const b=B.fields.get(u),p=b.constructor.ElementCount;var q=l[b.constructor.ElementType];if(!q)throw Error("BufferType not supported in WebGL");return{name:u,stride:f,count:p,type:q,offset:b.offset,normalized:!(!b.optional||!b.optional.glNormalized),divisor:d.divisor}})};Object.defineProperty(a,"__esModule",{value:!0})})},
"esri/views/webgl/Renderbuffer":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(a){return function(){function e(B,d){this._context=B;this._desc=d;this._context.instanceCounter.increment(5,this);B=this._context.gl;this.glName=B.createRenderbuffer();this._context.bindRenderbuffer(this);B.renderbufferStorage(B.RENDERBUFFER,d.internalFormat,d.width,d.height)}var l=e.prototype;l.resize=function(B,d){const f=this._desc;if(f.width!==B||f.height!==d)f.width=B,f.height=d,B=this._context.gl,
this._context.bindRenderbuffer(this),B.renderbufferStorage(B.RENDERBUFFER,f.internalFormat,f.width,f.height)};l.dispose=function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(5,this),this._context=null)};a._createClass(e,[{key:"descriptor",get:function(){return this._desc}}]);return e}()})},"esri/views/webgl/FramebufferObject":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/has","../../core/Logger","./Texture","./Renderbuffer"],
function(a,e,l,B,d){const f=l.getLogger("esri.views.webgl.FrameBufferObject");e=function(){function u(p,q,r,v){this._context=p;this._stencilAttachment=this._depthAttachment=this._glName=null;this._colorAttachments=new Map;this._initialized=!1;this._desc={...q};p.instanceCounter.increment(4,this);if(r)if(Array.isArray(r))for(const x of r){const {attachmentPoint:c,texture:m}=x;r=m instanceof B?m:new B(p,m);q=r.descriptor;this._colorAttachments.set(c,r);this._validateColorAttachmentPoint(c);this._validateTextureDimensions(q,
this._desc)}else{var D;r instanceof B?(q=r.descriptor,this._colorAttachments.set(36064,r)):(q=r,this._colorAttachments.set(36064,new B(p,r)));0!==(null==(D=this._desc)?void 0:D.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!");this._validateTextureDimensions(q,this._desc)}if(v instanceof d){var y;p=null!=(y=this._desc.depthStencilTarget)?y:3;2===p?this._stencilAttachment=v:1===p||3===p?this._depthAttachment=
v:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER');u._validateBufferDimensions(v.descriptor,this._desc)}else v&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),v instanceof B?(this._depthStencilTexture=v,v=this._depthStencilTexture.descriptor):this._depthStencilTexture=
new B(this._context,v),this._validateTextureDimensions(v,this._desc))}var b=u.prototype;b.dispose=function(){if(this._desc){var p=this._context.getBoundFramebufferObject();this._disposeColorAttachments();this._disposeDepthStencilAttachments();this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null);this._context.bindFramebuffer(p);this._context.instanceCounter.decrement(4,this);this._desc=null}};b.getColorTexture=function(p){return(p=this._colorAttachments.get(p))&&p instanceof
B?p:null};b.attachColorTexture=function(p,q=36064){if(p){this._validateColorAttachmentPoint(q);this._validateTextureDimensions(p.descriptor,this._desc);this._disposeColorAttachments();if(this._initialized){this._context.bindFramebuffer(this);const r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,q,r.TEXTURE_2D,p.glName,0)}this._colorAttachments.set(q,p)}};b.detachColorTexture=function(p=36064){const q=this._colorAttachments.get(p);if(q instanceof B){if(this._initialized){this._context.bindFramebuffer(this);
const r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,p,r.TEXTURE_2D,null,0)}this._colorAttachments.delete(p);return q}};b.attachDepthStencilTexture=function(p){if(p){var q=p.descriptor;34041!==q.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==q.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");
this._validateTextureDimensions(q,this._desc);this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),q=this._context.gl,q.framebufferTexture2D(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.TEXTURE_2D,p.glName,0));this._depthStencilTexture=p}};b.detachDepthStencilTexture=function(){const p=this._depthStencilTexture;if(p&&this._initialized){this._context.bindFramebuffer(this);
const q=this._context.gl;this._context.gl.framebufferTexture2D(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return p};b.attachDepthStencilBuffer=function(p){if(p){var q=p.descriptor;34041!==q.internalFormat&&33189!==q.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");u._validateBufferDimensions(q,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===q.internalFormat?3:1;this._initialized&&
(this._context.bindFramebuffer(this),q=this._context.gl,q.framebufferRenderbuffer(q.FRAMEBUFFER,1===this._desc.depthStencilTarget?q.DEPTH_ATTACHMENT:q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,p.glName));this._depthAttachment=p}};b.detachDepthStencilBuffer=function(){const p=this._context.gl,q=this._depthAttachment;q&&this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(p.FRAMEBUFFER,1===this._desc.depthStencilTarget?p.DEPTH_ATTACHMENT:p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,
null));this._depthAttachment=null;return q};b.copyToTexture=function(p,q,r,v,D,y,x){(0>p||0>q||0>D||0>y)&&console.error("Offsets cannot be negative!");(0>=r||0>=v)&&console.error("Copy width and height must be greater than zero!");var c=this._desc;const m=x.descriptor;3553!==x.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(p+r>c.width||q+v>c.height||D+r>m.width||y+v>m.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");
c=this._context;c.bindTexture(x,0);c.bindFramebuffer(this);c.gl.copyTexSubImage2D(3553,0,D,y,p,q,r,v)};b.readPixels=function(p,q,r,v,D,y,x){(0>=r||0>=v)&&console.error("Copy width and height must be greater than zero!");x||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(p,q,r,v,D,y,x)};b.resize=function(p,q){const r=this._desc;if(r.width!==p||r.height!==q)if(this._initialized){r.width=p;r.height=q;this._colorAttachments.forEach(v=>
{v&&v.resize(p,q)});if(null!=this._depthStencilTexture)this._depthStencilTexture.resize(p,q);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(p,q),this._stencilAttachment&&this._stencilAttachment.resize(p,q);this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null);this._initialized=!1}else r.width=p,r.height=q,this._colorAttachments.forEach(v=>{v&&v.resize(p,q)}),this._depthStencilTexture&&this._depthStencilTexture.resize(p,
q)};b.initializeAndBind=function(){var p,q,r,v;const D=this._context.gl;if(this._initialized)D.bindFramebuffer(D.FRAMEBUFFER,this.glName);else{this._glName&&D.deleteFramebuffer(this._glName);var y=this._context,x=D.createFramebuffer(),c=this._desc,m=null!=(p=c.colorTarget)?p:1;p=null!=(q=c.width)?q:1;q=null!=(r=c.height)?r:1;D.bindFramebuffer(D.FRAMEBUFFER,x);0===this._colorAttachments.size&&(0===m?this._colorAttachments.set(36064,new B(y,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,
wrapMode:33071,width:c.width,height:c.height})):(r=new d(y,{internalFormat:32854,width:p,height:q}),this._colorAttachments.set(36064,r)));this._colorAttachments.forEach((h,g)=>{h&&(h instanceof B?D.framebufferTexture2D(D.FRAMEBUFFER,g,D.TEXTURE_2D,h.glName,0):D.framebufferRenderbuffer(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.RENDERBUFFER,h.glName))});r=null!=(v=c.depthStencilTarget)?v:0;switch(r){case 1:case 3:this._depthAttachment||(this._depthAttachment=new d(y,{internalFormat:1===c.depthStencilTarget?
33189:34041,width:p,height:q}));D.framebufferRenderbuffer(D.FRAMEBUFFER,1===r?D.DEPTH_ATTACHMENT:D.DEPTH_STENCIL_ATTACHMENT,D.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new d(y,{internalFormat:36168,width:p,height:q}));D.framebufferRenderbuffer(D.FRAMEBUFFER,D.STENCIL_ATTACHMENT,D.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(y.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
this._depthStencilTexture=new B(y,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:p,height:q})),D.framebufferTexture2D(D.FRAMEBUFFER,D.DEPTH_STENCIL_ATTACHMENT,D.TEXTURE_2D,this._depthStencilTexture.glName,0)}this._glName=x;this._initialized=!0}};b._disposeColorAttachments=function(){this._colorAttachments.forEach((p,q)=>{if(p instanceof B){if(this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,q,r.TEXTURE_2D,
null,0)}p.dispose()}else p instanceof WebGLRenderbuffer&&(r=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),r.framebufferRenderbuffer(r.FRAMEBUFFER,q,r.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(p))});this._colorAttachments.clear()};b._disposeDepthStencilAttachments=function(){const p=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(p.FRAMEBUFFER,1===this._desc.depthStencilTarget?p.DEPTH_ATTACHMENT:
p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(p.FRAMEBUFFER,p.STENCIL_ATTACHMENT,p.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),p.framebufferTexture2D(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.TEXTURE_2D,null,
0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};u._validateBufferDimensions=function(p,q){console.assert(0<=p.width&&0<=p.height);void 0!==q.width&&0<=q.width&&void 0!==q.height&&0<=q.height?q.width===p.width&&q.height===p.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(q.width=p.width,q.height=p.height)};b._validateTextureDimensions=function(p,q){console.assert(0<=p.width&&0<=p.height);3553!==p.target&&console.error("Texture type must be TEXTURE_2D!");
void 0!==q.width&&0<=q.width&&void 0!==q.height&&0<=q.height?q.width===p.width&&q.height===p.height||console.error("Color attachment texture must match the framebuffer's!"):(q.width=p.width,q.height=p.height)};b._validateColorAttachmentPoint=function(p){if(-1===u._MAX_COLOR_ATTACHMENTS){const q=this._context.capabilities.drawBuffers;u._MAX_COLOR_ATTACHMENTS=q?this._context.gl.getParameter(q.MAX_COLOR_ATTACHMENTS):1}p-=36064;p+1>u._MAX_COLOR_ATTACHMENTS&&f.error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${p+
1}. Implementation supports up to ${u._MAX_COLOR_ATTACHMENTS} color attachments`)};a._createClass(u,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._desc}},{key:"colorTexture",get:function(){const p=this._colorAttachments.get(36064);return p&&p instanceof B?p:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(36064)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},
{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},{key:"height",get:function(){return this._desc.height}}]);return u}();e._MAX_COLOR_ATTACHMENTS=-1;return e})},"esri/views/webgl/ProgramCache":function(){define(["./programUtils"],function(a){return function(){function e(B){this._programCacheByTemplate=new Map;this._rctx=B}var l=e.prototype;l.dispose=function(){this._programCacheByTemplate.forEach(B=>{B.programs.forEach(d=>
{d.dispose()})});this._programCacheByTemplate=null};l.getProgram=function(B,d){this._programCacheByTemplate.has(B)||this.addProgramTemplate(B,f=>a.createProgram(this._rctx,B,f));return this.getProgramTemplateInstance(B,d)};l.addProgramTemplate=function(B,d){this._programCacheByTemplate.set(B,{constructor:d,programs:new Map})};l.getProgramTemplateInstance=function(B,d){if(B=this._programCacheByTemplate.get(B)){const f=d?JSON.stringify(d):"default";B.programs.has(f)||(d=B.constructor(d),B.programs.set(f,
d));return B.programs.get(f)}return null};return e}()})},"esri/views/webgl/programUtils":function(){define(["exports","./Program"],function(a,e){a.createProgram=function(l,B,d,f){d=d||{};f=f||"";d="function"===typeof B.shaders?B.shaders(d):B.shaders;return new e(l,f+d.vertexShader,f+d.fragmentShader,B.attributes)};a.glslifyDefineMap=function(l){let B="";for(const d in l){const f=l[d];if("boolean"===typeof f)f&&(B+=`#define ${d}\n`);else if("number"===typeof f)B+=`#define ${d} ${f.toFixed()}\n`;else if("object"===
typeof f){const u=f.options;let b=0;for(const p in u)B+=`#define ${u[p]} ${(b++).toFixed()}\n`;B+=`#define ${d} ${u[f.value]}\n`}}return B};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/RenderingContext":function(){define("../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ./renderState ./capabilities/isWebGL2Context ./enums ./InstanceCounter ./capabilities/load".split(" "),function(a,e,l,B,d,f,u,b){function p(q,r,v,D){r?D!==r&&q.bindBuffer(v,r.glName):
q.bindBuffer(v,null);return r}return function(){function q(v,D){this.gl=null;this.instanceCounter=new u.InstanceCounter;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=
!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=
this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap=[];this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=d(v)?"webgl2":"webgl";this.gl=v;v instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=b.loadCapabilities(v,D);v=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:v[0],y:v[1],width:v[2],height:v[3]};this._stateTracker=new B.StateTracker({setBlending:y=>{y?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(y.opRgb,
y.opAlpha),this.setBlendFunctionSeparate(y.srcRgb,y.dstRgb,y.srcAlpha,y.dstAlpha),y=y.color,this.setBlendColor(y.r,y.g,y.b,y.a)):this.setBlendingEnabled(!1)},setCulling:y=>{y?(this.setFaceCullingEnabled(!0),this.setCullFace(y.face),this.setFrontFace(y.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:y=>{y?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(y.factor,y.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:y=>{y?(this.setDepthTestEnabled(!0),this.setDepthFunction(y.func)):
this.setDepthTestEnabled(!1)},setStencilTest:y=>{if(y){this.setStencilTestEnabled(!0);const x=y.function;this.setStencilFunction(x.func,x.ref,x.mask);y=y.operation;this.setStencilOp(y.fail,y.zFail,y.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:y=>{y?(this.setDepthWriteEnabled(!0),this.setDepthRange(y.zNear,y.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:y=>{y?this.setColorMask(y.r,y.g,y.b,y.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:y=>{y?this.setStencilWriteMask(y.mask):
this.setStencilWriteMask(0)}});this.enforceState()}var r=q.prototype;r.isWebGL2Context=function(){return"webgl2"===this.contextVersion};r.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap=[];this._capabilities=this.gl=null};r.setPipelineState=function(v){this._stateTracker.setPipeline(v)};r.setBlendingEnabled=function(v){this._blendEnabled!==v&&(!0===v?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=v,this._stateTracker.invalidateBlending())};
r.setBlendColor=function(v,D,y,x){if(v!==this._blendColorState.r||D!==this._blendColorState.g||y!==this._blendColorState.b||x!==this._blendColorState.a)this.gl.blendColor(v,D,y,x),this._blendColorState.r=v,this._blendColorState.g=D,this._blendColorState.b=y,this._blendColorState.a=x,this._stateTracker.invalidateBlending()};r.setBlendFunction=function(v,D){if(v!==this._blendFunctionState.srcRGB||D!==this._blendFunctionState.dstRGB)this.gl.blendFunc(v,D),this._blendFunctionState.srcRGB=v,this._blendFunctionState.srcAlpha=
v,this._blendFunctionState.dstRGB=D,this._blendFunctionState.dstAlpha=D,this._stateTracker.invalidateBlending()};r.setBlendFunctionSeparate=function(v,D,y,x){if(this._blendFunctionState.srcRGB!==v||this._blendFunctionState.srcAlpha!==y||this._blendFunctionState.dstRGB!==D||this._blendFunctionState.dstAlpha!==x)this.gl.blendFuncSeparate(v,D,y,x),this._blendFunctionState.srcRGB=v,this._blendFunctionState.srcAlpha=y,this._blendFunctionState.dstRGB=D,this._blendFunctionState.dstAlpha=x,this._stateTracker.invalidateBlending()};
r.setBlendEquation=function(v){this._blendEquationState.mode!==v&&(this.gl.blendEquation(v),this._blendEquationState.mode=v,this._blendEquationState.modeAlpha=v,this._stateTracker.invalidateBlending())};r.setBlendEquationSeparate=function(v,D){if(this._blendEquationState.mode!==v||this._blendEquationState.modeAlpha!==D)this.gl.blendEquationSeparate(v,D),this._blendEquationState.mode=v,this._blendEquationState.modeAlpha=D,this._stateTracker.invalidateBlending()};r.setColorMask=function(v,D,y,x){if(this._colorMaskState.r!==
v||this._colorMaskState.g!==D||this._colorMaskState.b!==y||this._colorMaskState.a!==x)this.gl.colorMask(v,D,y,x),this._colorMaskState.r=v,this._colorMaskState.g=D,this._colorMaskState.b=y,this._colorMaskState.a=x,this._stateTracker.invalidateColorWrite()};r.setClearColor=function(v,D,y,x){if(this._clearColor.r!==v||this._clearColor.g!==D||this._clearColor.b!==y||this._clearColor.a!==x)this.gl.clearColor(v,D,y,x),this._clearColor.r=v,this._clearColor.g=D,this._clearColor.b=y,this._clearColor.a=x};
r.setFaceCullingEnabled=function(v){this._polygonCullingEnabled!==v&&(!0===v?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=v,this._stateTracker.invalidateCulling())};r.setPolygonOffsetFillEnabled=function(v){this._polygonOffsetFillEnabled!==v&&(!0===v?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=v,this._stateTracker.invalidatePolygonOffset())};r.setPolygonOffset=function(v,
D){if(this._polygonOffset[0]!==v||this._polygonOffset[1]!==D)this._polygonOffset[0]=v,this._polygonOffset[1]=D,this.gl.polygonOffset(v,D),this._stateTracker.invalidatePolygonOffset()};r.setCullFace=function(v){this._cullFace!==v&&(this.gl.cullFace(v),this._cullFace=v,this._stateTracker.invalidateCulling())};r.setFrontFace=function(v){this._frontFace!==v&&(this.gl.frontFace(v),this._frontFace=v,this._stateTracker.invalidateCulling())};r.setScissorTestEnabled=function(v){this._scissorTestEnabled!==
v&&(!0===v?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=v)};r.setScissorRect=function(v,D,y,x){if(this._scissorRect.x!==v||this._scissorRect.y!==D||this._scissorRect.width!==y||this._scissorRect.height!==x)this.gl.scissor(v,D,y,x),this._scissorRect.x=v,this._scissorRect.y=D,this._scissorRect.width=y,this._scissorRect.height=x};r.setDepthTestEnabled=function(v){this._depthTestEnabled!==v&&(!0===v?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),
this._depthTestEnabled=v,this._stateTracker.invalidateDepthTest())};r.setClearDepth=function(v){this._clearDepth!==v&&(this.gl.clearDepth(v),this._clearDepth=v)};r.setDepthFunction=function(v){this._depthFunction!==v&&(this.gl.depthFunc(v),this._depthFunction=v,this._stateTracker.invalidateDepthTest())};r.setDepthWriteEnabled=function(v){this._depthWriteEnabled!==v&&(this.gl.depthMask(v),this._depthWriteEnabled=v,this._stateTracker.invalidateDepthWrite())};r.setDepthRange=function(v,D){if(this._depthRange.zNear!==
v||this._depthRange.zFar!==D)this.gl.depthRange(v,D),this._depthRange.zNear=v,this._depthRange.zFar=D,this._stateTracker.invalidateDepthWrite()};r.setStencilTestEnabled=function(v){this._stencilTestEnabled!==v&&(!0===v?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=v,this._stateTracker.invalidateStencilTest())};r.setClearStencil=function(v){v!==this._clearStencil&&(this.gl.clearStencil(v),this._clearStencil=v)};r.setStencilFunction=function(v,D,
y){if(this._stencilFunction.func!==v||this._stencilFunction.ref!==D||this._stencilFunction.mask!==y)this.gl.stencilFunc(v,D,y),this._stencilFunction.face=1032,this._stencilFunction.func=v,this._stencilFunction.ref=D,this._stencilFunction.mask=y,this._stateTracker.invalidateStencilTest()};r.setStencilFunctionSeparate=function(v,D,y,x){if(this._stencilFunction.face!==v||this._stencilFunction.func!==D||this._stencilFunction.ref!==y||this._stencilFunction.mask!==x)this.gl.stencilFuncSeparate(v,D,y,x),
this._stencilFunction.face=v,this._stencilFunction.func=D,this._stencilFunction.ref=y,this._stencilFunction.mask=x,this._stateTracker.invalidateStencilTest()};r.setStencilWriteMask=function(v){this._stencilWriteMask!==v&&(this.gl.stencilMask(v),this._stencilWriteMask=v,this._stateTracker.invalidateStencilWrite())};r.setStencilOp=function(v,D,y){if(this._stencilOperation.fail!==v||this._stencilOperation.zFail!==D||this._stencilOperation.zPass!==y)this.gl.stencilOp(v,D,y),this._stencilOperation.face=
1032,this._stencilOperation.fail=v,this._stencilOperation.zFail=D,this._stencilOperation.zPass=y,this._stateTracker.invalidateStencilTest()};r.setStencilOpSeparate=function(v,D,y,x){if(this._stencilOperation.face!==v||this._stencilOperation.fail!==D||this._stencilOperation.zFail!==y||this._stencilOperation.zPass!==x)this.gl.stencilOpSeparate(v,D,y,x),this._stencilOperation.face=v,this._stencilOperation.face=v,this._stencilOperation.fail=D,this._stencilOperation.zFail=y,this._stencilOperation.zPass=
x,this._stateTracker.invalidateStencilTest()};r.setActiveTexture=function(v){const D=this._activeTextureUnit;0<=v&&v!==this._activeTextureUnit&&(this.gl.activeTexture(f.BASE_TEXTURE_UNIT+v),this._activeTextureUnit=v);return D};r.clear=function(v){v&&this.gl.clear(v)};r.clearSafe=function(v,D=255){v&&(v&16384&&this.setColorMask(!0,!0,!0,!0),v&256&&this.setDepthWriteEnabled(!0),v&1024&&this.setStencilWriteMask(D),this.gl.clear(v))};r.drawArrays=function(v,D,y){this.gl.drawArrays(v,D,y)};r.drawElements=
function(v,D,y,x){5123===y?this.gl.drawElements(v,D,y,x):5125===y&&this.gl.drawElements(v,D,y,x)};r.logIno=function(){};r.setViewport=function(v,D,y,x){const c=this._viewport;if(c.x!==v||c.y!==D||c.width!==y||c.height!==x)c.x=v,c.y=D,c.width=y,c.height=x,this.gl.viewport(v,D,y,x)};r.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};r.bindProgram=function(v){v?this._activeShaderProgram!==v&&(v.initialize(),this.gl.useProgram(v.glName),
this._activeShaderProgram=v):(this.gl.useProgram(null),this._activeShaderProgram=null)};r.bindTexture=function(v,D){(D>=this.parameters.maxTextureImageUnits||0>D)&&console.error("Input texture unit is out of range of available units!");const y=this._textureUnitMap[D];this.setActiveTexture(D);null==v||null==v.glName?(null!=y&&this.gl.bindTexture(y.descriptor.target,null),this._textureUnitMap[D]=null):y===v?v.applyChanges():(this.gl.bindTexture(v.descriptor.target,v.glName),v.applyChanges(),this._textureUnitMap[D]=
v)};r.unbindTextureAllUnits=function(v){for(let D=0;D<this.parameters.maxTextureImageUnits;D++)this._textureUnitMap[D]===v&&this.bindTexture(null,D)};r.bindFramebuffer=function(v){l.isNone(v)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==v&&(v.initializeAndBind(),this._activeFramebuffer=v)};r.bindBuffer=function(v){v&&(34962===v.bufferType?this._activeVertexBuffer=p(this.gl,v,v.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=
p(this.gl,v,v.bufferType,this._activeIndexBuffer))};r.bindRenderbuffer=function(v){const D=this.gl;v||(D.bindRenderbuffer(D.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==v&&(D.bindRenderbuffer(D.RENDERBUFFER,v.glName),this._activeRenderbuffer=v)};r.unbindBuffer=function(v){34962===v?this._activeVertexBuffer=p(this.gl,null,v,this._activeVertexBuffer):this._activeIndexBuffer=p(this.gl,null,v,this._activeIndexBuffer)};r.bindVAO=function(v){v?this._activeVertexArrayObject&&
this._activeVertexArrayObject===v||(v.bind(),this._activeVertexArrayObject=v):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};r.getBoundTexture=function(v){return this._textureUnitMap[v]};r.getBoundFramebufferObject=function(){return this._activeFramebuffer};r.getBoundVAO=function(){return this._activeVertexArrayObject};r.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);
for(let v=0;v<this.parameters.maxTextureImageUnits;v++)this.bindTexture(null,v);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,
1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};r.enforceState=function(){const v=this.gl;var D=this.capabilities.vao;D&&D.bindVertexArray(null);for(var y=0;y<this.parameters.maxVertexAttributes;y++)v.disableVertexAttribArray(y);
this._activeVertexBuffer?v.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):v.bindBuffer(34962,null);this._activeIndexBuffer?v.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):v.bindBuffer(34963,null);if(D&&this._activeVertexArrayObject){if(D=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(D)}v.bindFramebuffer(v.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);v.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);v.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);v.bindRenderbuffer(v.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?v.enable(this.gl.BLEND):v.disable(this.gl.BLEND);v.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);v.blendFuncSeparate(this._blendFunctionState.srcRGB,
this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);v.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);v.clearDepth(this._clearDepth);v.clearStencil(this._clearStencil);v.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);v.cullFace(this._cullFace);v.depthFunc(this._depthFunction);v.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?
v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST);v.depthMask(this._depthWriteEnabled);v.frontFace(this._frontFace);v.lineWidth(1);!0===this._polygonCullingEnabled?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE);v.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?v.enable(v.POLYGON_OFFSET_FILL):v.disable(v.POLYGON_OFFSET_FILL);v.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?v.enable(v.SCISSOR_TEST):
v.disable(v.SCISSOR_TEST);v.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);v.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST);v.stencilMask(this._stencilWriteMask);for(D=0;D<this.parameters.maxTextureImageUnits;D++)v.activeTexture(f.BASE_TEXTURE_UNIT+D),v.bindTexture(3553,null),(y=this._textureUnitMap[D])&&
v.bindTexture(y.descriptor.target,y.glName);v.activeTexture(f.BASE_TEXTURE_UNIT+this._activeTextureUnit);v.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};a._createClass(q,[{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){if(!this._parameters){const v=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:v?this.gl.getParameter(v.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)}}return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return q}()})},"esri/views/webgl/enums":function(){define(["exports"],function(a){a.BASE_TEXTURE_UNIT=33984;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(a,e){let l=function(){function B(){this._current=[];this._max=[];for(this._allocations=new Map;6>this._current.length;)this._current.push(0),this._max.push(0)}var d=B.prototype;d.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};d.increment=function(f,u){u=++this._current[f];this._max[f]=Math.max(u,this._max[f])};
d.decrement=function(f,u){--this._current[f]};d.printResourceCount=function(){console.log("Live objects:");console.log(`Textures: ${this._current[0]}`);console.log(`Buffers: ${this._current[1]}`);console.log(`VAOs: ${this._current[2]}`);console.log(`Programs: ${this._current[3]}`);console.log(`Framebuffers: ${this._current[4]}`);console.log(`Renderbuffers: ${this._current[5]}`);if(0<this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const f=new Map;this._allocations.forEach(u=>
{var b;f.set(u,(null!=(b=f.get(u))?b:0)+1)});f.forEach((u,b)=>console.log(u," : ",b))}};e._createClass(B,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}}]);return B}();a.InstanceCounter=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/load":function(){define("exports ./isWebGL2Context ./DisjointTimerQuery ./DrawBuffers ./Instancing ./LoseContext ./VertexArrayObjects".split(" "),function(a,e,l,B,d,f,u){function b(p,
q,r,v,D){if(v&&e(p))return!0;if(q[r])return!1;for(const y of D)if(p.getExtension(y))return!0;return!1}a.loadCapabilities=function(p,q){const r=q&&q.disabledExtensions||{},v=q&&q.debugWebGLExtensions||{};let D,y,x,c,m,h,g,k,n,G,C,t=null,A=null,z=null,w=null;return{get drawBuffers(){C||(C=B.load(p,r));return C},get instancing(){D||(D=d.load(p));return D},get vao(){y||(y=u.load(p,r));return y},get compressedTextureETC(){if(!x)if(r.compressedTextureETC)x=null;else{var F=p.getExtension("WEBGL_compressed_texture_etc");
x=F?{COMPRESSED_R11_EAC:F.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:F.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:F.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:F.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:F.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:F.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:F.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:F.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:F.COMPRESSED_RGBA8_ETC2_EAC,
COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:F.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}return x},get compressedTextureS3TC(){if(!c)if(r.compressedTextureS3TC)c=null;else{var F=p.getExtension("WEBGL_compressed_texture_s3tc");c=F?{COMPRESSED_RGB_S3TC_DXT1:F.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:F.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:F.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:F.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}return c},get textureFilterAnisotropic(){if(!m)if(r.textureFilterAnisotropic)m=
null;else{var F=p.getExtension("EXT_texture_filter_anisotropic")||p.getExtension("MOZ_EXT_texture_filter_anisotropic")||p.getExtension("WEBKIT_EXT_texture_filter_anisotropic");m=F?{MAX_TEXTURE_MAX_ANISOTROPY:F.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:F.TEXTURE_MAX_ANISOTROPY_EXT}:null}return m},get disjointTimerQuery(){h||(h=l.createDisjointTimerQuery(p,r));return h},get textureFloat(){if(!g)if(e(p))g={textureFloat:!0,textureFloatLinear:!r.textureFloatLinear&&!!p.getExtension("OES_texture_float_linear"),
textureHalfFloat:!0,textureHalfFloatLinear:!r.textureHalfFloatLinear&&!!p.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:p.HALF_FLOAT};else if(p instanceof WebGLRenderingContext){const F=!r.textureHalfFloat&&p.getExtension("OES_texture_half_float");g={textureFloat:!r.textureFloat&&!!p.getExtension("OES_texture_float"),textureFloatLinear:!r.textureFloatLinear&&!!p.getExtension("OES_texture_float_linear"),textureHalfFloat:!!F,textureHalfFloatLinear:!r.textureHalfFloatLinear&&!!p.getExtension("OES_texture_half_float_linear"),
HALF_FLOAT:F?F.HALF_FLOAT_OES:void 0}}else g=null;return g},get colorBufferFloat(){if(!k)if(e(p)){var F=!r.colorBufferFloat&&p.getExtension("EXT_color_buffer_half_float"),E=!r.colorBufferFloat&&p.getExtension("EXT_color_buffer_float"),N=!r.colorBufferFloat&&p.getExtension("EXT_float_blend");k=F||E||N?{textureFloat:!!E,textureHalfFloat:!!F,R16F:p.R16F,RG16F:p.RG16F,RGBA16F:p.RGBA16F,R32F:p.R32F,RG32F:p.RG32F,RGBA32F:p.RGBA32F,R11F_G11F_B10F:p.R11F_G11F_B10F,RGB16F:p.RGB16F}:null}else p instanceof WebGLRenderingContext?
(F=!r.colorBufferFloat&&p.getExtension("EXT_color_buffer_half_float"),E=!r.colorBufferFloat&&p.getExtension("WEBGL_color_buffer_float"),N=!r.colorBufferFloat&&p.getExtension("EXT_float_blend"),k=F||E||N?{textureFloat:!!E,textureHalfFloat:!!F,RGBA16F:F?F.RGBA16F_EXT:void 0,RGB16F:F?F.RGB16F_EXT:void 0,RGBA32F:E?E.RGBA32F_EXT:void 0}:null):k=null;return k},get blendMinMax(){if(!n)if(e(p))n={MIN:p.MIN,MAX:p.MAX};else if(r.blendMinMax)n=null;else{{const F=p.getExtension("EXT_blend_minmax");n=F?{MIN:F.MIN_EXT,
MAX:F.MAX_EXT}:null}}return n},get depthTexture(){null===t&&(t=b(p,r,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return t},get standardDerivatives(){null===A&&(A=b(p,r,"standardDerivatives",!0,["OES_standard_derivatives"]));return A},get shaderTextureLOD(){null===z&&(z=b(p,r,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return z},get fragDepth(){null===w&&(w=b(p,r,"fragDepth",!0,["EXT_frag_depth"]));return w},get loseContext(){G||(G=f.load(p,
v));return G},enable(F){return this[F]}}};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(a,e){let l=function(B,d,f,u,b,p,q,r){this.createQuery=B;this.resultAvailable=d;this.getResult=f;this.disjoint=u;this.beginTimeElapsed=b;this.endTimeElapsed=p;this.createTimestamp=q;this.timestampBits=r};a.DisjointTimerQuery=l;a.createDisjointTimerQuery=function(B,d){if(d.disjointTimerQuery)return null;
let f=B.getExtension("EXT_disjoint_timer_query_webgl2");return f&&e(B)?new l(()=>B.createQuery(),u=>B.getQueryParameter(u,B.QUERY_RESULT_AVAILABLE),u=>B.getQueryParameter(u,B.QUERY_RESULT),()=>B.getParameter(f.GPU_DISJOINT_EXT),u=>B.beginQuery(f.TIME_ELAPSED_EXT,u),()=>B.endQuery(f.TIME_ELAPSED_EXT),u=>f.queryCounterEXT(u,f.TIMESTAMP_EXT),()=>B.getQuery(f.TIMESTAMP_EXT,f.QUERY_COUNTER_BITS_EXT)):(f=B.getExtension("EXT_disjoint_timer_query"))?new l(()=>f.createQueryEXT(),u=>f.getQueryObjectEXT(u,f.QUERY_RESULT_AVAILABLE_EXT),
u=>f.getQueryObjectEXT(u,f.QUERY_RESULT_EXT),()=>B.getParameter(f.GPU_DISJOINT_EXT),u=>f.beginQueryEXT(f.TIME_ELAPSED_EXT,u),()=>f.endQueryEXT(f.TIME_ELAPSED_EXT),u=>f.queryCounterEXT(u,f.TIMESTAMP_EXT),()=>f.getQueryEXT(f.TIMESTAMP_EXT,f.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(a,e){a.load=function(l,B){return B.disjointTimerQuery?null:e(l)?{drawBuffers:l.drawBuffers.bind(l),
MAX_DRAW_BUFFERS:l.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:l.MAX_COLOR_ATTACHMENTS}:B.drawBuffers?null:(l=l.getExtension("WEBGL_draw_buffers"))?{drawBuffers:l.drawBuffersWEBGL.bind(l),MAX_DRAW_BUFFERS:l.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:l.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(a,e){a.load=function(l){return e(l)?{drawArraysInstanced:l.drawArraysInstanced.bind(l),
drawElementsInstanced:l.drawElementsInstanced.bind(l),vertexAttribDivisor:l.vertexAttribDivisor.bind(l)}:(l=l.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:l.drawArraysInstancedANGLE.bind(l),drawElementsInstanced:l.drawElementsInstancedANGLE.bind(l),vertexAttribDivisor:l.vertexAttribDivisorANGLE.bind(l)}:null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(a){a.load=function(e,l){const B=l.loseContext&&
e.getExtension("WEBGL_lose_context");return B?{loseRenderingContext:()=>B.loseContext()}:null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports","./isWebGL2Context"],function(a,e){a.load=function(l,B){return e(l)?{createVertexArray:l.createVertexArray.bind(l),deleteVertexArray:l.deleteVertexArray.bind(l),bindVertexArray:l.bindVertexArray.bind(l)}:B.vao?null:(l=l.getExtension("OES_vertex_array_object")||l.getExtension("MOZ_OES_vertex_array_object")||
l.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:l.createVertexArrayOES.bind(l),deleteVertexArray:l.deleteVertexArrayOES.bind(l),bindVertexArray:l.bindVertexArrayOES.bind(l)}:null};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/webgl/ShaderCompiler":function(){define(function(){return function(){function a(l){this.readFile=l}var e=a.prototype;e.resolveIncludes=function(l){return this.resolve(l)};e.resolve=function(l,B=new Map){if(B.has(l))return B.get(l);const d=
this.read(l);if(!d)throw Error(`cannot find shader file ${l}`);const f=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm;let u=f.exec(d);const b=[];for(;null!=u;)b.push({path:u[1],start:u.index,length:u[0].length}),u=f.exec(d);let p=0,q="";b.forEach(r=>{q+=d.slice(p,r.start);q+=B.has(r.path)?"":this.resolve(r.path,B);p=r.start+r.length});q+=d.slice(p);B.set(l,q);return q};e.read=function(l){return this.readFile(l)};return a}()})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/mathUtils ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState ../../../../chunks/Laserlines.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){u=function(D){function y(){return D.apply(this,arguments)||this}l._inheritsLoose(y,D);var x=y.prototype;x.initializeProgram=function(c){const m=y.shader.get().build(this.configuration);return new q(c.rctx,m.generateSource("vertex"),m.generateSource("fragment"),p.Default3D)};x.bind=function(c,m){this.program.setUniform3fv("innerColor",c.innerColor);this.program.setUniform1f("innerWidth",c.innerWidth*m.pixelRatio);this.program.setUniform3fv("glowColor",c.glowColor);
this.program.setUniform1f("glowWidth",c.glowWidth*m.pixelRatio);this.program.setUniform1f("glowFalloff",c.glowFalloff);this.program.setUniform1f("globalAlpha",c.globalAlpha);this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=c.globalAlphaContrastBoost?c.globalAlphaContrastBoost:1);c=null!=c.angleCutoff?c.angleCutoff:v.defaultAngleCutoff;this.program.setUniform2f("angleCutoff",Math.cos(c),Math.cos(Math.max(0,c-d.deg2rad(2))));this.configuration.intersectsLineEnabled&&
this.program.setUniform1f("perScreenPixelRatio",m.perScreenPixelRatio)};x.initializePipeline=function(){return r.makePipelineState({blending:r.simpleBlendingParams(1,771),colorWrite:r.defaultColorWriteParams})};return y}(u.ShaderTechnique);u.shader=new f.ReloadableShaderModule(v.LaserlinesShader,()=>new Promise(function(D,y){a(["./Laserlines.glsl"],D,y)}));f=function(D){function y(){var x=D.apply(this,arguments)||this;x.heightManifoldEnabled=!1;x.pointDistanceEnabled=!1;x.lineVerticalPlaneEnabled=
!1;x.intersectsLineEnabled=!1;x.contrastControlEnabled=!1;return x}l._inheritsLoose(y,D);return y}(b.ShaderTechniqueConfiguration);B.__decorate([b.parameter()],f.prototype,"heightManifoldEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"pointDistanceEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"lineVerticalPlaneEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"intersectsLineEnabled",void 0);B.__decorate([b.parameter()],f.prototype,"contrastControlEnabled",void 0);e.LaserlineTechnique=
u;e.LaserlineTechniqueConfiguration=f;Object.defineProperty(e,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/Object3DVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/WebGLLayer ./VisualElement".split(" "),function(a,e,l,B,d,f,u,b){b=function(p){function q(v){v=p.call(this,v.view)||this;v._resources=null;v._transform=
d.create();return v}e._inheritsLoose(q,p);var r=q.prototype;r.recreate=function(){this.attached&&this.createResources()};r.recreateGeometry=function(){if(!l.isNone(this._resources)){var v=this._resources.object,D=this.view._stage;D.removeMany(v.geometries);v.removeAllGeometries();this.createGeometries(v);this.visible||v.setVisible(this.visible);D.addMany(v.geometries);this._resources.layer.commit()}};r.createResources=function(){this.destroyResources();const v=this.view._stage;if(v){var D=new u.WebGLLayer({isPickable:!1});
v.add(D);var y=new f.Object3D({castShadow:!1});y.transformation=this._transform;this.createExternalResources();this.createGeometries(y);v.addMany(y.geometries);this.forEachExternalMaterial(x=>v.add(x));v.add(y);D.add(y);D.commit();this.visible||(y.setVisible(!1),D.commit());this._resources={layer:D,object:y}}};r.destroyResources=function(){const v=this.view._stage;!l.isNone(this._resources)&&v&&(v.remove(this._resources.object),v.remove(this._resources.layer),this.forEachExternalMaterial(D=>{v.remove(D);
D.dispose()}),v.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)};r.updateVisibility=function(v){l.isNone(this._resources)||(this._resources.object.setVisible(v),this._resources.layer.commit())};e._createClass(q,[{key:"object",get:function(){return l.isSome(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(v){B.copy(this._transform,v);l.isSome(this._resources)&&
(this._resources.object.transformation=this._transform,this._resources.layer.commit())}}]);return q}(b.VisualElement);a.Object3DVisualElement=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/mathUtils ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/sphere ./Util ./ContentObject ./GeometryRecord ./Object3DStateID ../materials/renderers/utils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){r=function(m){function h(k={}){var n=m.call(this)||this;n.type=1;n._geometryRecords=[];n._geometries=[];n._objectTransformation=b.create();n._bvObjectSpace=new c;n._bvWorldSpace=new c;n._bvDirty=!0;n._hasVolatileTransformation=!1;n._visible=!0;n.castShadow=null!=k.castShadow?k.castShadow:!0;n.metadata=k.metadata;n.metadata&&n.metadata.isElevationSource&&(n.metadata.lastValidElevationBB=new x);n.transformation=b.create();const {geometries:G,materials:C,transformations:t,
origins:A}=k;if(!Array.isArray(G))return e._assertThisInitialized(n);q.assert(C.length===G.length,"Object3D: materials don't match geometries");q.assert(t.length===G.length,"Object3D: transformations don't match geometries");n._geometryRecords.length=G.length;n._geometries.length=G.length;for(k=0;k<G.length;k++)n._geometries[k]=G[k],n._geometryRecords[k]=v.GeometryRecord.pool.acquire(G[k],C[k],b.clone(t[k]),{highlights:null,occludees:null,visible:!0},A&&A[k]);return n}e._inheritsLoose(h,m);var g=
h.prototype;g.dispose=function(){this._geometryRecords.length=0;this._geometries.length=0};g.getNumGeometryRecords=function(){return this._geometryRecords.length};g.getGeometryRecord=function(k){q.assert(0<=k&&k<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this._geometryRecords[k]};g.addGeometry=function(k,n,G,C,t,A){G=G?G:b.IDENTITY;this._geometries.push(k);k=v.GeometryRecord.pool.acquire(k,n,G,C||{highlights:null,occludees:null,visible:!0},t,A);this._geometryRecords.push(k);
this._hasVolatileTransformation=this._hasVolatileTransformation||l.isSome(k.shaderTransformation);this._emit("objectGeometryAdded",{object:this,record:k});this._invalidateBoundingVolume();return k};g.removeGeometry=function(k){const n=this._geometryRecords.splice(k,1)[0];this._hasVolatileTransformation=l.isSome(n.shaderTransformation)?this._geometryRecords.some(G=>l.isSome(G.shaderTransformation)):this._hasVolatileTransformation;n.dispose();this._geometries.splice(k,1);this._emit("objectGeometryRemoved",
{object:this,record:n});this._invalidateBoundingVolume();return n};g.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)};g.geometryVertexAttrsUpdated=function(k){this._emit("vertexAttrsUpdated",{object:this,record:this._geometryRecords[k]});this._invalidateBoundingVolume()};g.setVisible=function(k){this._visible=k;for(const n of this._geometryRecords)n.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)};g.maskOccludee=function(){const k=
new D.Object3DStateID(1);for(const n of this._geometryRecords)n.instanceParameters.occludees=y.addObject3DStateID(n.instanceParameters.occludees,k);this._emit("occlusionChanged",this);return k};g.removeOcclude=function(k){for(const n of this._geometryRecords)n.instanceParameters.occludees=y.removeObject3DStateID(n.instanceParameters.occludees,k);this._emit("occlusionChanged",this)};g.highlight=function(){const k=new D.Object3DStateID(0);for(const n of this._geometryRecords)n.instanceParameters.highlights=
y.addObject3DStateID(n.instanceParameters.highlights,k);this._emit("highlightChanged",this);return k};g.removeHighlight=function(k){for(const n of this._geometryRecords)n.instanceParameters.highlights=y.removeObject3DStateID(n.instanceParameters.highlights,k);this._emit("highlightChanged",this)};g.getCombinedStaticTransformation=function(k,n){return u.multiply(l.unwrapOr(n,b.create()),this.transformation,k.getStaticTransformation())};g.getCombinedShaderTransformation=function(k,n){n=n||b.create();
u.multiply(n,this.transformation,k.getShaderTransformation());return n};g.hasVolativeTransformation=function(){return this._hasVolatileTransformation};g.getBBMin=function(k){this._validateBoundingVolume();return k?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};g.getBBMax=function(k){this._validateBoundingVolume();return k?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};g.getBounds=function(k){this._validateBoundingVolume();return k?this._bvObjectSpace.bounds:this._bvWorldSpace.bounds};g._validateBoundingVolume=
function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var k=0;k<this._geometryRecords.length;++k){var n=this._geometryRecords[k],G=this._geometries[k].boundingInfo;l.isSome(G)&&(this._calculateTransformedBoundingVolume(G,this._bvObjectSpace,n.getShaderTransformation()),this._calculateTransformedBoundingVolume(G,this._bvWorldSpace,this.getCombinedShaderTransformation(n)))}d.lerp(this._bvObjectSpace.bounds,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,
.5);d.lerp(this._bvWorldSpace.bounds,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);k=B.create();n=B.create();G=f.maxScale(this.transformation);for(let z=0;z<this._geometryRecords.length;++z){var C=this._geometries[z].boundingInfo;if(!l.isNone(C)){var t=this._geometryRecords[z].getShaderTransformation(),A=f.maxScale(t);d.transformMat4(k,C.getCenter(),t);t=d.distance(k,this._bvObjectSpace.bounds);C=C.getBSRadius()*A;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],t+C);d.transformMat4(n,
k,this.transformation);A=d.distance(n,this._bvWorldSpace.bounds);this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],A+C*G)}}this._bvDirty=!1}};g._calculateTransformedBoundingVolume=function(k,n,G){const C=k.getBBMin();k=k.getBBMax();const t=B.clone(C),A=B.clone(k);d.transformMat4(t,t,G);d.transformMat4(A,A,G);for(var z=0;3>z;++z)n.bbMin[z]=Math.min(n.bbMin[z],t[z],A[z]),n.bbMax[z]=Math.max(n.bbMax[z],t[z],A[z]);for(z=0;3>z;++z){d.copy(t,C);d.copy(A,k);t[z]=k[z];A[z]=C[z];d.transformMat4(t,
t,G);d.transformMat4(A,A,G);for(let w=0;3>w;++w)n.bbMin[w]=Math.min(n.bbMin[w],t[w],A[w]),n.bbMax[w]=Math.max(n.bbMax[w],t[w],A[w])}};g._invalidateBoundingVolume=function(){this._bvDirty=!0;l.isSome(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)};g._emit=function(k,n){l.isSome(this._parentLayer)&&this._parentLayer.events.emit(k,n)};e._createClass(h,[{key:"geometryRecords",get:function(){return this._geometryRecords}},{key:"geometries",get:function(){return this._geometries}},
{key:"transformation",get:function(){return this._objectTransformation},set:function(k){u.copy(this._objectTransformation,k);this._invalidateBoundingVolume();this._emit("objectTransformation",this)}},{key:"parentLayer",get:function(){return this._parentLayer},set:function(k){q.assert(null==this._parentLayer||null==k,"Object3D can only be added to a single Layer");this._parentLayer=k}},{key:"isVisible",get:function(){return this._visible}},{key:"test",get:function(){const k=this;return{hasGeometry:n=>
-1<k._geometries.indexOf(n),getGeometryIndex:n=>k._geometries.indexOf(n)}}}]);return h}(r.ContentObject);let x=function(){function m(){this.bbMin=B.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this.bbMax=B.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}m.prototype.isEmpty=function(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]};return m}(),c=function(m){function h(){var g=m.apply(this,arguments)||this;g.bounds=p.create();
return g}e._inheritsLoose(h,m);h.prototype.init=function(){d.set(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);p.clear(this.bounds)};return h}(x);a.Object3D=r;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/ObjectPool ../../../../core/uid ../../../../chunks/vec3".split(" "),
function(a,e,l,B,d,f){let u=function(){function b(){this._disposed=!1}var p=b.prototype;p.acquire=function(q,r,v,D,y,x){this.id=d.generateUID();this.geometry=q;this.material=r;this.transformation=v;this.instanceParameters=D;this.origin=y;this._shaderTransformation=x;this._disposed=!1};p.release=function(){this._disposed=!1};p.dispose=function(){this._disposed=!0};p.getStaticTransformation=function(){return this.transformation};p.getShaderTransformation=function(){return l.isSome(this._shaderTransformation)?
this._shaderTransformation(this.transformation):this.transformation};p.computeAttachmentOrigin=function(q){return(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,q):this.geometry.computeAttachmentOrigin(q))?(f.transformMat4(q,q,this.getStaticTransformation()),!0):!1};e._createClass(b,[{key:"disposed",get:function(){return this._disposed}},{key:"shaderTransformation",get:function(){return this._shaderTransformation}}]);return b}();u.pool=new B(u);a.GeometryRecord=
u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Object3DStateID":function(){define(["exports","../../../../core/uid"],function(a,e){a.Object3DStateID=function(l){this.channel=l;this.id=e.generateUID()};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/WebGLLayer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/PooledArray ../../../../core/Evented ../../../../chunks/vec3f64 ../../../../core/Handles ./ContentObject ./DirtyEvents ./Octree".split(" "),
function(a,e,l,B,d,f,u,b,p,q){b=function(r){function v(y,x=""){var c=r.call(this)||this;c.apiLayerUid=x;c.type=0;c.events=new d;c.isSliceable=!1;c._objects=new B;c._stageHandles=new u;c.apiLayerUid=x;y=y||{};c.group=y.group||"";c.isVisible=null!=y.isVisible?y.isVisible:!0;c.isPickable=null!=y.isPickable?y.isPickable:!0;c.translation=y.translation?f.clone(y.translation):f.create();return c}e._inheritsLoose(v,r);var D=v.prototype;D.destroy=function(){this.detachStage();this._stage=null};D.attachStage=
function(y){this.detachStage();this._stage=y;for(const x of p.DirtyEventNames)this._stageHandles.add(this.events.on(x,c=>y.handleEvent(x,c)))};D.detachStage=function(){this._stageHandles.removeAll();this.invalidateSpatialQueryAccelerator()};D.getObjectIds=function(){return this._objects.map(y=>y.id)};D.getObjects=function(){return this._objects};D.add=function(y){this._objects.push(y);y.parentLayer=this;this.events.emit("layerObjectAdded",{layer:this,object:y});l.isSome(this._octree)&&this._octree.add([y])};
D.remove=function(y){this._objects.removeUnordered(y)&&(y.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:y}),l.isSome(this._octree)&&this._octree.remove([y]))};D.addMany=function(y){this._objects.pushArray(y);for(const x of y)x.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:y});l.isSome(this._octree)&&this._octree.add(y)};D.removeMany=function(y){const x=[];this._objects.removeUnorderedMany(y,y.length,x);if(0!==x.length){for(const c of x)c.parentLayer=
null;this.events.emit("layerObjectsRemoved",{layer:this,objects:x});l.isSome(this._octree)&&this._octree.remove(x)}};D.commit=function(){l.isSome(this._stage)&&this._stage.processDirtyLayer(this.id)};D.notifyObjectBBChanged=function(y,x){l.isSome(this._octree)&&this._octree.update(y,x)};D.getSpatialQueryAccelerator=function(){l.isNone(this._octree)&&50<this._objects.length&&this._createOctree();return this._octree};D.shaderTransformationChanged=function(){this.invalidateSpatialQueryAccelerator();
this.events.emit("shaderTransformationChanged",this)};D.invalidateSpatialQueryAccelerator=function(){this._octree=l.destroyMaybe(this._octree)};D._createOctree=function(){this._octree=new q(y=>y.getBounds());this._octree.add(this._objects.data,this._objects.length)};return v}(b.ContentObject);a.WebGLLayer=b;a.isWebGLLayer=function(r){return l.isSome(r)&&0===r.type};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DirtyEvents":function(){define(["exports"],function(a){a.DirtyEventNames=
"layerObjectAdded layerObjectRemoved layerObjectsAdded layerObjectsRemoved shaderTransformationChanged objectTransformation visibilityChanged occlusionChanged highlightChanged objectGeometryAdded objectGeometryRemoved vertexAttrsUpdated".split(" ");Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/ObjectPool ../../../../core/PooledArray ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/geometryUtils ./Util".split(" "),
function(a,e,l,B,d,f,u,b){function p(I,L,M){M[0]=I[0]+L;M[1]=I[1]+L;M[2]=I[2]+L}function q(I,L,M,K){if(1===L)I=M(I[0]),u.sphere.copy(I,K);else{C[0]=Infinity;C[1]=Infinity;C[2]=Infinity;t[0]=-Infinity;t[1]=-Infinity;t[2]=-Infinity;for(let Y=0;Y<L;Y++){var P=M(I[Y]);if(y(P[3])){var Q=C,R=P;Q[0]=Math.min(Q[0],R[0]-R[3]);Q[1]=Math.min(Q[1],R[1]-R[3]);Q[2]=Math.min(Q[2],R[2]-R[3]);Q=t;Q[0]=Math.max(Q[0],P[0]+P[3]);Q[1]=Math.max(Q[1],P[1]+P[3]);Q[2]=Math.max(Q[2],P[2]+P[3])}}f.lerp(K,C,t,.5);K[3]=Math.max(t[0]-
C[0],t[1]-C[1],t[2]-C[2])/2}}function r(I,L,M){if(!U.length)for(var K=0;8>K;++K)U.push({index:0,distance:0});for(K=0;8>K;++K){const P=m[K];U.data[K].index=K;U.data[K].distance=D(I,L,P)}U.sort((P,Q)=>P.distance-Q.distance);for(I=0;8>I;++I)M[I]=U.data[I].index}function v(I,L){let M=Infinity,K=null;for(let P=0;8>P;++P){const Q=D(I,L,h[P]);Q<M&&(M=Q,K=h[P])}return K}function D(I,L,M){return L*(I[0]*M[0]+I[1]*M[1]+I[2]*M[2])}function y(I){return!isNaN(I)&&-Infinity!==I&&Infinity!==I&&0<I}let x=function(){function I(M,
K){this._objectToBoundingSphere=M;this._maximumObjectsPerNode=10;this._maximumDepth=20;this._degenerateObjects=new Set;this._root=new c;this._objectCount=0;K&&(void 0!==K.maximumObjectsPerNode&&(this._maximumObjectsPerNode=K.maximumObjectsPerNode),void 0!==K.maximumDepth&&(this._maximumDepth=K.maximumDepth))}var L=I.prototype;L.destroy=function(){this._degenerateObjects.clear();c.clearPool();k[0]=null;A.prune();U.prune()};L.add=function(M,K=M.length){this._objectCount+=K;this._grow(M,K);const P=c.acquire();
for(let Q=0;Q<K;Q++){const R=M[Q];this._isDegenerate(R)?this._degenerateObjects.add(R):(P.init(this._root),this._add(R,P))}c.release(P)};L.remove=function(M,K=null){this._objectCount-=M.length;const P=c.acquire();for(const Q of M)M=e.isSome(K)?K:u.sphere.copy(this._objectToBoundingSphere(Q),z),y(M[3])?(P.init(this._root),this._remove(Q,M,P)):this._degenerateObjects.delete(Q);c.release(P);this._shrink()};L.update=function(M,K){if(y(K[3])||!this._isDegenerate(M))k[0]=M,M=k,this.remove(M,K),this.add(M)};
L.forEachAlongRay=function(M,K,P){const Q=u.ray.wrap(M,K);this._forEachNode(this._root,R=>{if(!this._intersectsNode(Q,R))return!1;R=R.node;R.terminals.forAll(Y=>{this._intersectsObject(Q,Y)&&P(Y)});null!==R.residents&&R.residents.forAll(Y=>{this._intersectsObject(Q,Y)&&P(Y)});return!0})};L.forEachAlongRayWithVerticalOffset=function(M,K,P,Q){const R=u.ray.wrap(M,K);this._forEachNode(this._root,Y=>{if(!this._intersectsNodeWithOffset(R,Y,Q))return!1;Y=Y.node;Y.terminals.forAll(T=>{this._intersectsObjectWithOffset(R,
T,Q)&&P(T)});null!==Y.residents&&Y.residents.forAll(T=>{this._intersectsObjectWithOffset(R,T,Q)&&P(T)});return!0})};L.forEach=function(M){this._forEachNode(this._root,K=>{K=K.node;K.terminals.forAll(M);null!==K.residents&&K.residents.forAll(M);return!0});this._degenerateObjects.forEach(M)};L.forEachDegenerateObject=function(M){this._degenerateObjects.forEach(M)};L.findClosest=function(M,K,P,Q,R){return this._findClosest(M,"front-to-back"===K?1:-1,P,Q,R)};L.forEachInDepthRange=function(M,K,P,Q,R,Y,
T,V){this._forEachInDepthRange(M,K,"front-to-back"===P?1:-1,Q,R,Y,T,V)};L.forEachNode=function(M){this._forEachNode(this._root,K=>M(K.node,K.bounds,K.halfSize))};L._intersectsNode=function(M,K){p(K.bounds,2*-K.halfSize,C);p(K.bounds,2*K.halfSize,t);return b.rayBoxTest(M.origin,M.direction,C,t)};L._intersectsNodeWithOffset=function(M,K,P){p(K.bounds,2*-K.halfSize,C);p(K.bounds,2*K.halfSize,t);P.applyToMinMax(C,t);return b.rayBoxTest(M.origin,M.direction,C,t)};L._intersectsObject=function(M,K){K=this._objectToBoundingSphere(K);
return 0<K[3]?u.sphere.intersectsRay(K,M):!0};L._intersectsObjectWithOffset=function(M,K,P){K=this._objectToBoundingSphere(K);return 0<K[3]?u.sphere.intersectsRay(P.applyToBoundingSphere(K),M):!0};L._forEachNode=function(M,K){M=c.acquire().init(M);const P=[M];for(;0!==P.length;){M=P.pop();if(K(M)&&!M.isLeaf())for(let Q=0;Q<M.node.children.length;Q++)M.node.children[Q]&&P.push(c.acquire().init(M).advance(Q));c.release(M)}};L._forEachNodeDepthOrdered=function(M,K,P,Q=1){M=c.acquire().init(M);const R=
[M];for(r(P,Q,S);0!==R.length;){M=R.pop();if(K(M)&&!M.isLeaf())for(P=7;0<=P;--P)Q=S[P],Q>=M.node.children.length||M.node.children[Q]&&R.push(c.acquire().init(M).advance(Q));c.release(M)}};L._findClosest=function(M,K,P,Q,R){let Y=Infinity,T=Infinity,V=null;const W=v(M,K);let X=0;const oa=ua=>{++X;if(!Q||Q(ua)){var H=this._objectToBoundingSphere(ua);if(!P||u.frustum.intersectsSphere(P,H)){var J=D(M,K,u.sphere.getCenter(H)),aa=J-H[3];H=J+H[3];aa<Y&&(Y=aa,T=H,V=ua)}}};this._forEachNodeDepthOrdered(this._root,
ua=>{if(null!=R&&X>=R||P&&!u.frustum.intersectsSphere(P,ua.bounds))return!1;f.scale(G,W,ua.halfSize);f.add(G,G,ua.bounds);if(D(M,K,G)>T)return!1;ua=ua.node;ua.terminals.forAll(H=>{oa(H)});null!==ua.residents&&ua.residents.forAll(H=>{oa(H)});return!0},M,K);return V};L._forEachInDepthRange=function(M,K,P,Q,R,Y,T,V){let W=-Infinity,X=Infinity;const oa={setRange:ja=>{1===P?(W=Math.max(W,ja.near),X=Math.min(X,ja.far)):(W=Math.max(W,-ja.far),X=Math.min(X,-ja.near))}};oa.setRange(Q);const ua=D(K,P,M),H=
v(K,P),J=v(K,-1*P);let aa=0;const fa=ja=>{++aa;if(!T||T(ja)){var la=this._objectToBoundingSphere(ja),da=u.sphere.getCenter(la);da=D(K,P,da)-ua;var ka=da+la[3];da-la[3]>X||ka<W||(!Y||u.frustum.intersectsSphere(Y,la))&&R(ja,oa)}};this._forEachNodeDepthOrdered(this._root,ja=>{if(null!=V&&aa>=V||Y&&!u.frustum.intersectsSphere(Y,ja.bounds))return!1;f.scale(G,H,ja.halfSize);f.add(G,G,ja.bounds);if(D(K,P,G)-ua>X)return!1;f.scale(G,J,ja.halfSize);f.add(G,G,ja.bounds);if(D(K,P,G)-ua<W)return!1;ja=ja.node;
ja.terminals.forAll(la=>{fa(la)});null!==ja.residents&&ja.residents.forAll(la=>{fa(la)});return!0},K,P)};L._remove=function(M,K,P){A.clear();K=P.advanceTo(K,(Q,R)=>{A.push(Q.node);A.push(R)})?P.node.terminals:P.node.residents;K.removeUnordered(M);if(0===K.length)for(M=A.length-2;0<=M&&this._purge(A.data[M],A.data[M+1]);M-=2);};L._nodeIsEmpty=function(M){if(0!==M.terminals.length)return!1;if(null!==M.residents)return 0===M.residents.length;for(let K=0;K<M.children.length;K++)if(M.children[K])return!1;
return!0};L._purge=function(M,K){0<=K&&(M.children[K]=null);return this._nodeIsEmpty(M)?(null===M.residents&&(M.residents=new B({shrink:!0})),!0):!1};L._add=function(M,K){K.advanceTo(this._objectToBoundingSphere(M))?K.node.terminals.push(M):(K.node.residents.push(M),K.node.residents.length>this._maximumObjectsPerNode&&K.depth<this._maximumDepth&&this._split(K))};L._split=function(M){const K=M.node.residents;M.node.residents=null;for(let P=0;P<K.length;P++){const Q=c.acquire().init(M);this._add(K.getItemAt(P),
Q);c.release(Q)}};L._grow=function(M,K){0!==K&&(q(M,K,P=>this._objectToBoundingSphere(P),w),y(w[3])&&!this._fitsInsideTree(w)&&(this._nodeIsEmpty(this._root.node)?(u.sphere.copy(w,this._root.bounds),this._root.halfSize=1.25*w[3]):(M=this._rootBoundsForRootAsSubNode(w),this._placingRootViolatesMaxDepth(M)?this._rebuildTree(w,M):this._growRootAsSubNode(M),c.release(M))))};L._rebuildTree=function(M,K){f.copy(F,K.bounds);F[3]=K.halfSize;q([M,F],2,P=>P,E);M=c.acquire().init(this._root);this._root.initFrom(null,
E,1.25*E[3]);this._forEachNode(M,P=>{this.add(P.node.terminals.data,P.node.terminals.length);null!==P.node.residents&&this.add(P.node.residents.data,P.node.residents.length);return!0});c.release(M)};L._placingRootViolatesMaxDepth=function(M){const K=Math.log(M.halfSize/this._root.halfSize)*Math.LOG2E;let P=0;this._forEachNode(this._root,Q=>{P=Math.max(P,Q.depth);return P+K<=this._maximumDepth});return P+K>this._maximumDepth};L._rootBoundsForRootAsSubNode=function(M){var K=M[3];let P=-Infinity;const Q=
this._root.bounds,R=this._root.halfSize;for(var Y=0;3>Y;Y++){var T=Math.max(0,Math.ceil((Q[Y]-R-(M[Y]-K))/(2*R)));const V=Math.max(0,Math.ceil((M[Y]+K-(Q[Y]+R))/(2*R)))+1;P=Math.max(P,2**Math.ceil(Math.log(T+V)*Math.LOG2E));N[Y].min=T;N[Y].max=V}for(M=0;3>M;M++)K=N[M].min,Y=N[M].max,T=(P-(K+Y))/2,K+=Math.ceil(T),Y+=Math.floor(T),n[M]=Q[M]-R-K*R*2+(Y+K)*R;n[3]=P*R*g;return c.acquire().initFrom(null,n,P*R,0)};L._growRootAsSubNode=function(M){const K=this._root.node;f.copy(w,this._root.bounds);w[3]=
this._root.halfSize;this._root.init(M);M.advanceTo(w,null,!0);M.node.children=K.children;M.node.residents=K.residents;M.node.terminals=K.terminals};L._shrink=function(){for(;;){const M=this._findShrinkIndex();if(-1===M)break;this._root.advance(M);this._root.depth=0}};L._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let M=null;const K=this._root.node.children;let P=0,Q=0;for(;Q<K.length&&null==M;)P=Q++,M=K[P];for(;Q<K.length;)if(K[Q++])return-1;return P};
L._isDegenerate=function(M){M=this._objectToBoundingSphere(M)[3];return!y(M)};L._fitsInsideTree=function(M){const K=this._root.bounds,P=this._root.halfSize;return M[3]<=P&&M[0]>=K[0]-P&&M[0]<=K[0]+P&&M[1]>=K[1]-P&&M[1]<=K[1]+P&&M[2]>=K[2]-P&&M[2]<=K[2]+P};a._createClass(I,[{key:"bounds",get:function(){return this._root.bounds}},{key:"halfSize",get:function(){return this._root.halfSize}},{key:"root",get:function(){return this._root.node}},{key:"maximumObjectsPerNode",get:function(){return this._maximumObjectsPerNode}},
{key:"maximumDepth",get:function(){return this._maximumDepth}},{key:"objectCount",get:function(){return this._objectCount}}]);return I}(),c=function(){function I(){this.bounds=u.sphere.create();this.halfSize=0;this.initFrom(null,null,0,0)}var L=I.prototype;L.init=function(M){return this.initFrom(M.node,M.bounds,M.halfSize,M.depth)};L.initFrom=function(M,K,P,Q=this.depth){this.node=e.isSome(M)?M:I.createEmptyNode();e.isSome(K)&&u.sphere.copy(K,this.bounds);this.halfSize=P;this.depth=Q;return this};
L.advance=function(M){let K=this.node.children[M];K||(K=I.createEmptyNode(),this.node.children[M]=K);this.node=K;this.halfSize/=2;this.depth++;M=m[M];this.bounds[0]+=M[0]*this.halfSize;this.bounds[1]+=M[1]*this.halfSize;this.bounds[2]+=M[2]*this.halfSize;this.bounds[3]=this.halfSize*g;return this};L.advanceTo=function(M,K,P=!1){for(;;){if(this.isTerminalFor(M))return K&&K(this,-1),!0;if(this.isLeaf()){if(!P)return K&&K(this,-1),!1;this.node.residents=null}const Q=this._childIndex(M);K&&K(this,Q);
this.advance(Q)}};L.isLeaf=function(){return null!=this.node.residents};L.isTerminalFor=function(M){return M[3]>this.halfSize/2};L._childIndex=function(M){const K=this.bounds;return(K[0]<M[0]?1:0)+(K[1]<M[1]?2:0)+(K[2]<M[2]?4:0)};I.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new B({shrink:!0}),residents:new B({shrink:!0})}};I.acquire=function(){return I._pool.acquire()};I.release=function(M){I._pool.release(M)};I.clearPool=function(){I._pool.prune()};
return I}();c._pool=new l(c);const m=[d.fromValues(-1,-1,-1),d.fromValues(1,-1,-1),d.fromValues(-1,1,-1),d.fromValues(1,1,-1),d.fromValues(-1,-1,1),d.fromValues(1,-1,1),d.fromValues(-1,1,1),d.fromValues(1,1,1)],h=[d.fromValues(-1,-1,-1),d.fromValues(-1,-1,1),d.fromValues(-1,1,-1),d.fromValues(-1,1,1),d.fromValues(1,-1,-1),d.fromValues(1,-1,1),d.fromValues(1,1,-1),d.fromValues(1,1,1)],g=Math.sqrt(3),k=[null],n=u.sphere.create(),G=d.create(),C=d.create(),t=d.create(),A=new B,z=u.sphere.create(),w=u.sphere.create(),
F=u.sphere.create(),E=u.sphere.create(),N=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],U=new B,S=[0,0,0,0,0,0,0,0];return x})},"esri/views/3d/interactive/visualElements/ParallelLineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../core/Handles ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/RibbonLineMaterial ./Object3DVisualElement".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){y=function(n){function G(t){var A=n.call(this,t)||this;A._handles=new u;A._location=d.create();A._direction=d.fromValues(1,0,0);A._width=1;A._offset=1;A._length=18;A._color=r.fromValues(1,0,1,1);A._renderOccluded=4;A.applyProps(t);return A}e._inheritsLoose(G,n);var C=G.prototype;C.setDirectionFromPoints=function(t,A){f.normalize(this._direction,f.subtract(this._direction,A,t));this.updateGeometry()};C.createExternalResources=function(){const t=new D.RibbonLineMaterial(this.materialParameters);
this._handles.add(this.view.state.watch("camera",()=>{this.updateGeometry()}));this._externalResources={material:t}};C.destroyExternalResources=function(){this._handles.removeAll();this._externalResources=null};C.createGeometries=function(t){const A=v.createPolylineGeometry([d.create(),d.create()]),z=v.createPolylineGeometry([d.create(),d.create()]),w=l.unwrap(this._externalResources).material;t.addGeometry(A,w,b.IDENTITY);t.addGeometry(z,w,b.IDENTITY);this.updateVertices(t)};C.forEachExternalMaterial=
function(t){l.isSome(this._externalResources)&&t(this._externalResources.material)};C.updateMaterial=function(){l.isNone(this._externalResources)||this._externalResources.material.setParameterValues(this.materialParameters)};C.updateGeometry=function(){const t=this.object;l.isNone(t)||this.updateVertices(t)};C.updateVertices=function(t){const A=this.view.state.camera;A.projectToScreen(this.location,c);f.add(x,this.location,this.direction);A.projectToScreen(x,m);p.normalize(m,p.subtract(m,m,c));this.updateVertexAttributes(A,
t,0,c,m,1);this.updateVertexAttributes(A,t,1,c,m,-1)};C.updateVertexAttributes=function(t,A,z,w,F,E){const N=A.geometryRecords[z].geometry.getMutableAttribute("position").data;E=p.scale(h,p.set(h,F[1]*E,F[0]*-E),this.offset+this.width/2);w=p.add(g,p.add(g,p.add(g,w,p.scale(g,F,this.length/2)),E),E);F=p.add(k,w,p.scale(k,F,-this.length));t.unprojectFromScreen(w,x);N[0]=x[0];N[1]=x[1];N[2]=x[2];t.unprojectFromScreen(F,x);N[3]=x[0];N[4]=x[1];N[5]=x[2];A.geometryVertexAttrsUpdated(z)};e._createClass(G,
[{key:"location",get:function(){return this._location},set:function(t){f.exactEquals(this._location,t)||(f.copy(this._location,t),this.updateGeometry())}},{key:"direction",get:function(){return this._direction},set:function(t){f.exactEquals(this._direction,t)||(f.copy(this._direction,t),this.updateGeometry())}},{key:"width",get:function(){return this._width},set:function(t){t!==this._width&&(this._width=t,this.updateMaterial())}},{key:"offset",get:function(){return this._offset},set:function(t){t!==
this._offset&&(this._offset=t,this.updateGeometry())}},{key:"length",get:function(){return this._length},set:function(t){t!==this._length&&(this._length=t,this.updateGeometry())}},{key:"color",get:function(){return this._color},set:function(t){q.exactEquals(t,this._color)||(q.copy(this._color,t),this.updateMaterial())}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(t){t!==this._renderOccluded&&(this._renderOccluded=t,this.updateMaterial())}},{key:"materialParameters",
get:function(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}}]);return G}(y.Object3DVisualElement);const x=d.create(),c=B.createScreenPointArray(),m=B.createScreenPointArray(),h=B.createScreenPointArray(),g=B.createScreenPointArray(),k=B.createScreenPointArray();a.ParallelLineVisualElement=y;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/PointVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../geometry/projection ../../../../chunks/vec4f64 ../../../../chunks/vec4 ../../../../geometry/support/aaBoundingBox ../../support/stack ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/HUDMaterial ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../layers/graphics/sdfPrimitives ../../webgl-engine/lib/Texture ./VisualElementResources".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h){let g=function(){function G(t){this._geometry=this.view=null;this._size=3;this._color=b.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=b.fromValues(1,1,1,1);this._elevationInfo=null;this.resources=new h.VisualElementResources({view:t.view,createResources:z=>this.createResources(z),recreateGeometry:(z,w)=>{z.geometry=this.recreateGeometry(w,z.material);return l.isSome(z.geometry)?[z.geometry]:
[]}});let A=!0;for(const z in t)z in this?"attached"===z?A=t[z]:this[z]=t[z]:console.error("Cannot set unknown property",z);this.attached=A}var C=G.prototype;C.destroy=function(){this.resources.destroy()};C.updateMaterial=function(){const t=this.resources.resources;l.isNone(t)||t.material.setParameterValues(this.materialParameters(t.texture.id))};C.updateSizeAttribute=function(){var t=this.resources.resources;const A=this.resources.object;if(!l.isNone(t)&&!l.isNone(A)&&(t=t.geometry,!l.isNone(t))){t=
t.getMutableAttribute("size").data;var z=this.geometrySize;t[0]=z;t[1]=z;A.geometryVertexAttrsUpdated(0)}};C.materialParameters=function(t){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:k,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:t,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}};C.recreateGeometry=function(t,A){const z=this.createRenderGeometry();
l.isSome(z)&&t.addGeometry(z,A);return z};C.createResources=function(t){const A=this.createTexture(),z=new D.HUDMaterial(this.materialParameters(A.id));t=this.recreateGeometry(t,z);return{material:z,texture:A,geometry:t,forEach(w){w(A);w(z);l.isSome(this.geometry)&&w(this.geometry)}}};C.createTexture=function(){const t=this.preferredTextureSize;return new m.Texture(c.createType(this._primitive,t,.5*t),{mipmap:!1,wrap:{s:33071,t:33071},width:t,height:t,components:4,noUnpackFlip:!0})};C.calculateMapBounds=
function(t){if(l.isNone(this.resources.resources)||l.isNone(this.resources.resources.geometry))return!1;const A=this.resources.resources.geometry.vertexAttributes.get("position");u.projectVectorToVector(A.data,this.view.renderCoordsHelper.spatialReference,n,this.view.spatialReference);q.expandWithBuffer(t,n);return!0};C.createRenderGeometry=function(){var t=this.geometry;if(l.isNone(t))return null;const {renderCoordsHelper:A,elevationProvider:z}=this.view;var w=y.evaluateElevationAlignmentAtPoint(t,
z,x.ElevationContext.fromElevationInfo(this.elevationInfo),A);const F=f.set(r.sv3d.get(),t.x,t.y,w);w=r.sv3d.get();u.projectVectorToVector(F,t.spatialReference,w,A.spatialReference);t=this.geometrySize;return v.createPointGeometry(null,w,null,[t,t],[0,0,0,1])};e._createClass(G,[{key:"visible",get:function(){return this.resources.visible},set:function(t){this.resources.visible=t}},{key:"attached",get:function(){return this.resources.attached},set:function(t){this.resources.attached=t}},{key:"geometry",
get:function(){return this._geometry},set:function(t){this._geometry=t;this.resources.recreateGeometry()}},{key:"size",get:function(){return this._size},set:function(t){if(t!==this._size){const A=this.preferredTextureSize;this._size=t;A<this.preferredTextureSize?l.isSome(this.resources)&&this.resources.recreate():this.updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(t){p.exactEquals(t,this._color)||(p.copy(this._color,t),this.updateMaterial())}},{key:"pixelSnappingEnabled",
get:function(){return this._pixelSnappingEnabled},set:function(t){this._pixelSnappingEnabled!==t&&(this._pixelSnappingEnabled=t,this.updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(t){this._primitive!==t&&(this._primitive=t,l.isSome(this.resources)&&this.resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(t){t!==this._outlineSize&&(this._outlineSize=t,this.updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},
set:function(t){p.exactEquals(t,this._outlineColor)||(p.copy(this._outlineColor,t),this.updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(t){this._elevationInfo=t;this.resources&&this.resources.recreateGeometry()}},{key:"geometrySize",get:function(){return this._size/.5}},{key:"preferredTextureSize",get:function(){return B.clamp(B.nextHighestPowerOfTwo(2*this.geometrySize),16,128)}}]);return G}();const k=[.25,.25,.75,.75],n=d.create();a.PointVisualElement=
g;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/maybe ../core/Error ../core/promiseUtils ./support/spatialReferenceUtils ./support/Ellipsoid ./Point ./Extent ./Multipoint ./Polygon ./Polyline ../core/mathUtils ../chunks/vec3f64 ../chunks/vec3 ./projectionEllipsoid ../core/unitUtils ../chunks/mat4 ../chunks/pe ./support/aaBoundingRect ./support/geodesicConstants ./support/GeographicTransformation".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){function t(){return!!wa&&k.isLoaded()}function A(ma){B.isNone(xa)&&(xa=Promise.all([k.load(),(new Promise(function(ta,pa){a(["../chunks/geometryEngineBase"],ta,pa)})).then(function(ta){return ta.geometryEngineBase}),new Promise(function(ta,pa){a(["./geometryAdapters/hydrated"],ta,pa)})]));return xa.then(([,ta,{hydratedAdapter:pa}])=>{f.throwIfAborted(ma);ra=pa;wa=ta.default;wa._enableProjection(k.pe)})}function z(ma,ta,pa,ya,Aa=null){if(B.isNone(pa)||
B.isNone(ya))return ta;if(F(pa,ya,Aa))return ta.map(Ca=>E(Ca,pa,ya));if(B.isNone(Aa)){const Ca=C.cacheKey(pa,ya);void 0!==va[Ca]?Aa=va[Ca]:(Aa=w(pa,ya,null),B.isNone(Aa)&&(Aa=new C),va[Ca]=Aa)}if(B.isNone(wa))throw new za;return wa._project(ma,ta,pa,ya,Aa)}function w(ma,ta,pa=null){if(B.isNone(wa))throw new za;if(B.isNone(ma)||B.isNone(ta))return null;ma=wa._getTransformation(ra,ma,ta,pa,null==pa?void 0:pa.spatialReference);return null!==ma?C.fromGE(ma):null}function F(ma,ta,pa){return pa?!1:u.equals(ma,
ta)?!0:u.isValid(ma)&&u.isValid(ta)&&!!qa(ma,ta,Oa)}function E(ma,ta,pa){if(!ma)return ma;if("x"in ma){var ya=new p;return N(ma,ta,ya,pa)?ya:null}return"xmin"in ma?(ya=new q,L(ma,ta,ya,pa)?ya:null):"rings"in ma?(ya=new v,I(ma,ta,ya,pa)?ya:null):"paths"in ma?(ya=new D,S(ma,ta,ya,pa)?ya:null):"points"in ma?(ya=new r,U(ma,ta,ya,pa)?ya:null):null}function N(ma,ta,pa,ya,Aa=0){Ga[0]=ma.x;Ga[1]=ma.y;const Ca=ma.z;Ga[2]=void 0!==Ca?Ca:Aa;if(!Q(Ga,ta,0,Ga,ya,0,1))return!1;pa.x=Ga[0];pa.y=Ga[1];pa.spatialReference=
ya;void 0===Ca?(pa.z=void 0,pa.hasZ=!1):(pa.z=Ga[2],pa.hasZ=!0);void 0===ma.m?(pa.m=void 0,pa.hasM=!1):(pa.m=ma.m,pa.hasM=!0);return!0}function U(ma,ta,pa,ya,Aa=0){const {points:Ca,hasZ:Da,hasM:Fa}=ma;ma=[];const Na=Ca.length,Ma=[];for(var La of Ca)Ma.push(La[0],La[1],Da?La[2]:Aa);if(!Q(Ma,ta,0,Ma,ya,0,Na))return!1;for(ta=0;ta<Na;++ta){Aa=3*ta;La=Ma[Aa];const Qa=Ma[Aa+1];Da&&Fa?ma.push([La,Qa,Ma[Aa+2],Ca[ta][3]]):Da?ma.push([La,Qa,Ma[Aa+2]]):Fa?ma.push([La,Qa,Ca[ta][2]]):ma.push([La,Qa])}pa.points=
ma;pa.spatialReference=ya;pa.hasZ=Da;pa.hasM=Fa;return!0}function S(ma,ta,pa,ya,Aa=0){const {paths:Ca,hasZ:Da,hasM:Fa}=ma;ma=[];if(!R(Ca,Da,Fa,ta,ma,ya,Aa))return!1;pa.paths=ma;pa.spatialReference=ya;pa.hasZ=Da;pa.hasM=Fa;return!0}function I(ma,ta,pa,ya,Aa=0){const {rings:Ca,hasZ:Da,hasM:Fa}=ma;ma=[];if(!R(Ca,Da,Fa,ta,ma,ya,Aa))return!1;pa.rings=ma;pa.spatialReference=ya;pa.hasZ=Da;pa.hasM=Fa;return!0}function L(ma,ta,pa,ya,Aa=0){const {xmin:Ca,ymin:Da,xmax:Fa,ymax:Na,hasZ:Ma,hasM:La}=ma;if(!M(Ca,
Da,Ma?ma.zmin:Aa,ta,Ga,ya))return!1;pa.xmin=Ga[0];pa.ymin=Ga[1];Ma&&(pa.zmin=Ga[2]);if(!M(Fa,Na,Ma?ma.zmax:Aa,ta,Ga,ya))return!1;pa.xmax=Ga[0];pa.ymax=Ga[1];Ma&&(pa.zmax=Ga[2]);La&&(pa.mmin=ma.mmin,pa.mmax=ma.mmax);pa.spatialReference=ya;return!0}function M(ma,ta,pa,ya,Aa,Ca){Ia[0]=ma;Ia[1]=ta;Ia[2]=pa;return Q(Ia,ya,0,Aa,Ca,0,1)}function K(ma,ta,pa,ya){if(B.isNone(ta)||B.isNone(ya)||2>ma.length)return!1;2===ma.length&&(Ia[0]=ma[0],Ia[1]=ma[1],Ia[2]=0,ma=Ia);return Q(ma,ta,0,pa,ya,0,1)}function P(ma,
ta,pa){B.isNone(ta)?ma=!1:(ta=T(ta,Ea),ta=Ba[ta][6],B.isNone(ta)?ma=!1:(ta(ma,0,Ia,0),pa!==Ia&&(pa[0]=Ia[0],pa[1]=Ia[1],2<pa.length&&(pa[2]=Ia[2])),ma=!0));return ma}function Q(ma,ta,pa,ya,Aa,Ca,Da=1){ta=qa(ta,Aa,Oa);if(B.isNone(ta))return!1;if(ta===V){if(ma===ya&&pa===Ca)return!0;Da=pa+3*Da;for(let Fa=pa,Na=Ca;Fa<Da;Fa++,Na++)ya[Na]=ma[Fa];return!0}Da=pa+3*Da;for(let Fa=pa,Na=Ca;Fa<Da;Fa+=3,Na+=3)ta(ma,Fa,ya,Na);return!0}function R(ma,ta,pa,ya,Aa,Ca,Da=0){const Fa=[];for(const Na of ma)for(const Ma of Na)Fa.push(Ma[0],
Ma[1],ta?Ma[2]:Da);if(!Q(Fa,ya,0,Fa,Ca,0,Fa.length/3))return!1;ya=0;Aa.length=0;for(const Na of ma){ma=[];for(const Ma of Na)ta&&pa?ma.push([Fa[ya++],Fa[ya++],Fa[ya++],Ma[3]]):ta?ma.push([Fa[ya++],Fa[ya++],Fa[ya++]]):(pa?ma.push([Fa[ya++],Fa[ya++],Ma[2]]):ma.push([Fa[ya++],Fa[ya++]]),ya++);Aa.push(ma)}return!0}function Y(ma,ta,pa){const ya=Math.sin(ta);ta=Math.cos(ta);const Aa=Math.sin(ma);ma=Math.cos(ma);pa[0]=-ya;pa[4]=-Aa*ta;pa[8]=ma*ta;pa[12]=0;pa[1]=ta;pa[5]=-Aa*ya;pa[9]=ma*ya;pa[13]=0;pa[2]=
0;pa[6]=ma;pa[10]=Aa;pa[14]=0;pa[3]=0;pa[7]=0;pa[11]=0;pa[15]=1;return pa}function T(ma,ta){if(ta.spatialReference===ma)return ta.spatialReferenceId;ta.spatialReference=ma;"metersPerUnit"in ta&&(ta.metersPerUnit=h.getMetersPerUnitForSR(ma,1));return ma.wkt===m.SphericalECEFSpatialReference.wkt?ta.spatialReferenceId=1:u.isWGS84(ma)?ta.spatialReferenceId=2:u.isWebMercator(ma)?ta.spatialReferenceId=3:ma.wkt===m.WGS84ECEFSpatialReference.wkt?ta.spatialReferenceId=4:4490===ma.wkid?ta.spatialReferenceId=
5:ma.wkt===m.SphericalPCPFMars.wkt?ta.spatialReferenceId=7:ma.wkt===m.SphericalPCPFMoon.wkt?ta.spatialReferenceId=9:u.isMars(ma)?ta.spatialReferenceId=8:u.isMoon(ma)?ta.spatialReferenceId=10:ta.spatialReferenceId=0}function V(ma,ta,pa,ya){ma!==pa&&(pa[ya++]=ma[ta++],pa[ya++]=ma[ta++],pa[ya]=ma[ta])}function W(ma,ta,pa,ya){pa[ya++]=Ka*(ma[ta++]/b.earth.radius);pa[ya++]=Ka*(Math.PI/2-2*Math.atan(Math.exp(-1*ma[ta++]/b.earth.radius)));pa[ya]=ma[ta]}function X(ma,ta,pa,ya){W(ma,ta,pa,ya);ja(pa,ya,pa,
ya)}function oa(ma,ta,pa,ya){W(ma,ta,pa,ya);O(pa,ya,pa,ya)}function ua(ma,ta,pa,ya,Aa){var Ca=.4999999*Math.PI;Ca=y.clamp(Ja*ma[ta+1],-Ca,Ca);Ca=Math.sin(Ca);pa[ya++]=Ja*ma[ta]*Aa.radius;pa[ya++]=Aa.halfSemiMajorAxis*Math.log((1+Ca)/(1-Ca));pa[ya]=ma[ta+2]}function H(ma,ta,pa,ya){ua(ma,ta,pa,ya,b.earth)}function J(ma,ta,pa,ya,Aa){Aa+=ma[ta+2];const Ca=Ja*ma[ta+1];ma=Ja*ma[ta];ta=Math.cos(Ca);pa[ya++]=Math.cos(ma)*ta*Aa;pa[ya++]=Math.sin(ma)*ta*Aa;pa[ya]=Math.sin(Ca)*Aa}function aa(ma,ta,pa,ya){J(ma,
ta,pa,ya,b.moon.radius)}function fa(ma,ta,pa,ya){J(ma,ta,pa,ya,b.mars.radius)}function ja(ma,ta,pa,ya){J(ma,ta,pa,ya,b.earth.radius)}function la(ma,ta,pa,ya,Aa){var Ca=ma[ta];const Da=ma[ta+1];ta=ma[ta+2];ma=Math.sqrt(Ca*Ca+Da*Da+ta*ta);ta=y.asinClamped(ta/(0===ma?1:ma));Ca=Math.atan2(Da,Ca);pa[ya++]=Ka*Ca;pa[ya++]=Ka*ta;pa[ya]=ma-Aa}function da(ma,ta,pa,ya){la(ma,ta,pa,ya,b.moon.radius)}function ka(ma,ta,pa,ya){la(ma,ta,pa,ya,b.mars.radius)}function Z(ma,ta,pa,ya){la(ma,ta,pa,ya,b.earth.radius)}
function ia(ma,ta,pa,ya){Z(ma,ta,pa,ya);H(pa,ya,pa,ya)}function ha(ma,ta,pa,ya){Z(ma,ta,pa,ya);O(pa,ya,pa,ya)}function O(ma,ta,pa,ya){{var Aa=b.earth;const Da=Ja*ma[ta];var Ca=Ja*ma[ta+1];ma=ma[ta+2];ta=Math.sin(Ca);Ca=Math.cos(Ca);const Fa=Aa.radius/Math.sqrt(1-Aa.eccentricitySquared*ta*ta);pa[ya++]=(Fa+ma)*Ca*Math.cos(Da);pa[ya++]=(Fa+ma)*Ca*Math.sin(Da);pa[ya++]=(Fa*(1-Aa.eccentricitySquared)+ma)*ta}}function ca(ma,ta,pa,ya){var Aa=G.earthEllipsoidConstants,Ca=ma[ta],Da=ma[ta+1];ma=ma[ta+2];let Fa;
ta=Math.abs(ma);var Na=Ca*Ca+Da*Da;var Ma=Math.sqrt(Na);var La=Na+ma*ma;var Qa=Math.sqrt(La);Ca=Math.atan2(Da,Ca);var Sa=ma*ma/La;La=Na/La;Da=Aa.a2/Qa;Na=Aa.a3-Aa.a4/Qa;.3<La?(Sa=ta/Qa*(1+La*(Aa.a1+Da+Sa*Na)/Qa),Qa=Math.asin(Sa),Da=Sa*Sa,La=Math.sqrt(1-Da)):(La=Ma/Qa*(1-Sa*(Aa.a5-Da-La*Na)/Qa),Qa=Math.acos(La),Da=1-La*La,Sa=Math.sqrt(Da));Fa=1-b.earth.eccentricitySquared*Da;Da=b.earth.radius/Math.sqrt(Fa);Aa=Aa.a6*Da;Da=Ma-Da*La;Na=ta-Aa*Sa;ta=La*Da+Sa*Na;Ma=La*Na-Sa*Da;Aa=Ma/(Aa/Fa+ta);Qa+=Aa;0>
ma&&(Qa=-Qa);pa[ya++]=Ka*Ca;pa[ya++]=Ka*Qa;pa[ya]=ta+Ma*Aa/2}function ea(ma,ta,pa,ya){ca(ma,ta,pa,ya);ja(pa,ya,pa,ya)}function ba(ma,ta,pa,ya){ca(ma,ta,pa,ya);H(pa,ya,pa,ya)}function qa(ma,ta,pa=sa()){return B.isNone(ma)||B.isNone(ta)?null:na(ma,ta,pa).projector}function na(ma,ta,pa){if(B.isNone(ma)||B.isNone(ta)||pa.source.spatialReference===ma&&pa.dest.spatialReference===ta)return pa;const ya=T(ma,pa.source),Aa=T(ta,pa.dest);0===ya&&0===Aa?u.equals(ma,ta)?pa.projector=V:pa.projector=null:pa.projector=
Ba[ya][Aa];return pa}function sa(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:V}}let wa=null,ra=null,xa=null,va={},za=function(ma){function ta(){return ma.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}l._inheritsLoose(ta,ma);return ta}(d);const Ba={[2]:{[5]:null,[8]:null,[10]:null,[6]:V,[1]:ja,[7]:null,[9]:null,[0]:null,[3]:H,[2]:V,[4]:O},
[5]:{[5]:V,[8]:null,[10]:null,[6]:V,[1]:ja,[7]:null,[9]:null,[0]:null,[3]:null,[2]:null,[4]:O},[8]:{[5]:null,[8]:V,[10]:null,[6]:null,[1]:null,[7]:fa,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:V,[6]:null,[1]:null,[7]:null,[9]:aa,[0]:null,[3]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[6]:W,[1]:X,[7]:null,[9]:null,[0]:null,[3]:V,[2]:W,[4]:oa},[4]:{[5]:ca,[8]:null,[10]:null,[6]:ca,[1]:ea,[7]:null,[9]:null,[0]:null,[3]:ba,[2]:ca,[4]:V},[1]:{[5]:Z,[8]:null,
[10]:null,[6]:Z,[1]:V,[7]:null,[9]:null,[0]:null,[3]:ia,[2]:Z,[4]:ha},[7]:{[5]:null,[8]:ka,[10]:null,[6]:null,[1]:null,[7]:V,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:da,[6]:null,[1]:null,[7]:null,[9]:V,[0]:null,[3]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[6]:null,[1]:null,[7]:null,[9]:null,[0]:V,[3]:null,[2]:null,[4]:null},[6]:{[5]:null,[8]:null,[10]:null,[6]:V,[1]:ja,[7]:null,[9]:null,[0]:null,[3]:null,[2]:V,[4]:O}},Ea={spatialReference:null,spatialReferenceId:0},
Ha={spatialReference:null,spatialReferenceId:0},Oa=sa(),Pa=sa(),Ja=y.deg2rad(1),Ka=y.rad2deg(1),Ia=x.create(),Ra=x.create(),Ta=x.create(),Ga=x.create(),Ua=x.create();e.canProjectToWGS84ComparableLonLat=function(ma){if(B.isNone(ma))return!1;ma=T(ma,Ea);return!!Ba[ma][6]};e.canProjectWithoutEngine=F;e.computeLatLonToENURotation=Y;e.computeLinearTransformation=function(ma,ta,pa,ya){if(B.isNone(ma)||B.isNone(ya))return!1;var Aa=T(ma,Ea),Ca=T(ya,Ha);if(Aa===Ca&&1!==Ca&&(0!==Aa||u.equals(ma,ya)))return g.identity(pa),
g.translate(pa,pa,ta),!0;if(1===Ca||7===Ca||9===Ca){ya=ma=0;if(1===Ca){Aa=Ba[Aa][6];Ca=Ba[6][Ca];if(B.isNone(Aa)||B.isNone(Ca))return!1;Aa(ta,0,Ra,0);Ca(Ra,0,Ta,0);ma=Ja*Ra[0];ya=Ja*Ra[1]}else if(7===Ca||9===Ca){Ca=Ba[Aa][Ca];if(B.isNone(Ca))return!1;Ca(ta,0,Ta,0);ma=Ja*ta[0];ya=Ja*ta[1]}Y(ya,ma,pa);pa[12]=Ta[0];pa[13]=Ta[1];pa[14]=Ta[2];return!0}if(3===Ca&&(2===Aa||1===Aa)){Ca=Ba[Aa][6];if(B.isNone(Ca))return!1;Ca(ta,0,Ra,0);ta=Ja*Ra[1];H(Ra,0,Ta,0);g.identity(pa);g.translate(pa,pa,Ta);ta=1/Math.cos(ta);
g.scale(pa,pa,[ta,ta,1]);return!0}return!1};e.getProjectorName=function(ma,ta){switch(qa(ma,ta,Oa)){case V:return"copy3";case ja:return"wgs84ToSphericalECEF";case H:return"wgs84ToWebMercator";case O:return"wgs84ToWGS84ECEF";case W:return"webMercatorToWGS84";case X:return"webMercatorToSphericalECEF";case oa:return"webMercatorToWGS84ECEF";case ca:return"wgs84ECEFToWGS84";case ea:return"wgs84ECEFToSphericalECEF";case ba:return"wgs84ECEFToWebMercator";case Z:return"sphericalECEFToWGS84";case ia:return"sphericalECEFToWebMercator";
case ka:return"sphericalMarsPCPFToMars2000";case da:return"sphericalMoonPCPFToMoon2000";case ha:return"sphericalECEFToWGS84ECEF";case fa:return"mars2000ToSphericalPCPF";case aa:return"moon2000ToSphericalPCPF";default:return null}};e.getTransformation=w;e.getTransformations=function(ma,ta,pa=null){if(B.isNone(wa))throw new za;ma=wa._getTransformationBySuitability(ra,ma,ta,pa,null==pa?void 0:pa.spatialReference);if(null!==ma){ta=[];for(const ya of ma)ta.push(C.fromGE(ya));return ta}return[]};e.initializeProjection=
async function(ma,ta){if(!t())for(const {source:pa,dest:ya,geographicTransformation:Aa}of ma)if(!F(pa,ya,Aa))return A(ta)};e.isLoaded=t;e.isSupported=function(){return!0};e.load=A;e.localLinearScaleFactors=function(ma,ta,pa,ya){if(B.isNone(ta)||B.isNone(ya))return!1;const Aa=T(ta,Ea);var Ca=T(ya,Ha);if(Aa===Ca&&0!==Aa||u.equals(ta,ya))return pa[0]=1,pa[1]=1,pa[2]=1,!0;if(1===Aa){ta=c.length(ma);ma=ta/Math.sqrt(ma[0]*ma[0]+ma[1]*ma[1]);ta/=b.earth.radius;if(3===Ca)return pa[0]=ma*ta,pa[1]=ma*ta,pa[2]=
1,!0;if(2===Ca||5===Ca)return Ca=180/(b.earth.radius*Math.PI),pa[0]=Ca*ma*ta,pa[1]=Ca*ta,pa[2]=1,!0}return!1};e.lonLatToSphericalPCPF=function(ma,ta,pa,ya,Aa=0){ya+=Aa;Aa=Math.cos(pa);ma[0]=Math.cos(ta)*Aa*ya;ma[1]=Math.sin(ta)*Aa*ya;ma[2]=Math.sin(pa)*ya};e.lonLatToWebMercatorComparable=ua;e.project=function(ma,ta,pa=null){return Array.isArray(ma)?0===ma.length?[]:z(ra,ma,ma[0].spatialReference,ta,pa):z(ra,[ma],ma.spatialReference,ta,pa)[0]};e.projectBoundingRect=function(ma,ta,pa,ya){if(null==ma)return!1;
if(u.equals(ta,ya))return n.set(pa,ma),!0;Ia[0]=ma[0];Ia[1]=ma[1];Ia[2]=0;if(!Q(Ia,ta,0,Ia,ya,0,1))return!1;pa[0]=Ia[0];pa[1]=Ia[1];Ia[0]=ma[2];Ia[1]=ma[3];Ia[2]=0;if(!Q(Ia,ta,0,Ia,ya,0,1))return!1;pa[2]=Ia[0];pa[3]=Ia[1];return!0};e.projectBoundingSphere=function(ma,ta,pa,ya){if(B.isNone(ta)||B.isNone(ya))return!1;ta=na(ta,ya,Pa);if(ta.projector===V)return pa[0]=ma[0],pa[1]=ma[1],pa[2]=ma[2],pa[3]=ma[3],!0;if(B.isNone(ta.projector))return!1;const {source:Aa,dest:Ca}=ta;if(3===Ca.spatialReferenceId){ta=
Ba[Aa.spatialReferenceId][2];if(B.isNone(ta))return!1;ta(ma,0,Ra,0);ta=Math.abs(Ja*Ra[1])+Math.asin(ma[3]/(b.earth.radius+ma[2]));H(Ra,0,pa,0);pa[3]=ta>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(ta)*ma[3];return!0}ta.projector(ma,0,pa,0);pa[3]=ma[3]*Aa.metersPerUnit/Ca.metersPerUnit;return!0};e.projectBuffer=Q;e.projectDirection=function(ma,ta,pa,ya,Aa){c.copy(Ga,ma);c.add(Ua,ma,ta);K(Ga,pa,Ga,Aa);K(Ua,pa,Ua,Aa);c.subtract(ya,Ua,Ga);c.normalize(ya,ya)};e.projectExtent=function(ma,ta,pa=ta.spatialReference,
ya=0){return B.isNone(pa)?!1:L(ma,ma.spatialReference,ta,pa,ya)};e.projectMany=z;e.projectMultipoint=function(ma,ta,pa=ta.spatialReference,ya=0){return B.isNone(pa)?!1:U(ma,ma.spatialReference,ta,pa,ya)};e.projectPoint=function(ma,ta,pa=ta.spatialReference,ya=0){return B.isNone(pa)?!1:N(ma,ma.spatialReference,ta,pa,ya)};e.projectPointToVector=function(ma,ta,pa,ya=0){Ga[0]=ma.x;Ga[1]=ma.y;const Aa=ma.z;Ga[2]=void 0!==Aa?Aa:ya;return Q(Ga,ma.spatialReference,0,ta,pa,0,1)};e.projectPointToWGS84ComparableLonLat=
function(ma,ta){Ga[0]=ma.x;Ga[1]=ma.y;const pa=ma.z;Ga[2]=void 0!==pa?pa:0;return P(Ga,ma.spatialReference,ta)};e.projectPolygon=function(ma,ta,pa=ta.spatialReference,ya=0){return B.isNone(pa)?!1:I(ma,ma.spatialReference,ta,pa,ya)};e.projectPolyline=function(ma,ta,pa=ta.spatialReference,ya=0){return B.isNone(pa)?!1:S(ma,ma.spatialReference,ta,pa,ya)};e.projectVectorToDehydratedPoint=function(ma,ta,pa){return Q(ma,ta,0,Ga,pa.spatialReference,0,1)?(pa.x=Ga[0],pa.y=Ga[1],pa.z=Ga[2],pa):null};e.projectVectorToPoint=
function(ma,ta,pa){if(B.isNone(ta)||B.isNone(pa))return null;const ya=new p({spatialReference:pa});return Q(ma,ta,0,Ga,pa,0,1)?(ya.x=Ga[0],ya.y=Ga[1],ya.z=Ga[2],ya):null};e.projectVectorToVector=K;e.projectVectorToWGS84ComparableLonLat=P;e.projectXYZToVector=M;e.sphericalPCPFtoLonLatElevation=la;e.unload=function(){xa=ra=wa=null;va={}};Object.defineProperty(e,"__esModule",{value:!0})})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../core/has","../assets"],
function(a,e,l,B,d){function f(){return!!e._pe}function u(){return!!B("esri-wasm")}function b(){return y?y:y=(new Promise(function(c,m){a(["./pe-wasm"],c,m)})).then(function(c){return c.peWasm}).then(({default:c})=>c({locateFile:m=>d.getAssetUrl(`esri/geometry/support/${m}`)})).then(c=>{p(c)})}function p(c){function m(k,n,G){k[n]=G(k[n])}e._pe=c;e.PeDefs.init();e.PeGTlistExtended.init();e.PeNotationMgrs.init();e.PeNotationUtm.init();e.PePCSInfo.init();e.PeGCSExtent=function(k){function n(){return k.apply(this,
arguments)||this}l._inheritsLoose(n,k);n.prototype.destroy=function(){e._pe.destroy(this)};return n}(e._pe.PeGCSExtent);c=[e._pe.PeDatum,e._pe.PeGeogcs,e._pe.PeGeogtran,e._pe.PeObject,e._pe.PeParameter,e._pe.PePrimem,e._pe.PeProjcs,e._pe.PeSpheroid,e._pe.PeUnit];for(var h of c)m(h.prototype,"getName",k=>function(){return k.call(this,Array(e.PeDefs.PE_NAME_MAX))});for(const k of[e._pe.PeGeogtran,e._pe.PeProjcs])m(k.prototype,"getParameters",n=>function(){const G=Array(e.PeDefs.PE_PARM_MAX);let C=n.call(this);
for(let t=0;t<G.length;t++){const A=e._pe.getValue(C,"*");G[t]=A?e._pe.wrapPointer(A,e._pe.PeParameter):null;C+=Int32Array.BYTES_PER_ELEMENT}return G});m(e._pe.PeHorizon.prototype,"getCoord",k=>function(){const n=this.getSize();if(!n)return null;const G=[],C=k.call(this);D(G,n,C);return G});m(e._pe.PeGTlistExtendedEntry.prototype,"getEntries",k=>{const n=e._pe._pe_getPeGTlistExtendedGTsSize();return function(){let G=null;var C=k.call(this);if(!e._pe.compare(C,e._pe.NULL)){G=[C];const t=this.getSteps();
if(1<t){C=e._pe.getPointer(C);for(let A=1;A<t;A++)G.push(e._pe.wrapPointer(C+n*A,e._pe.PeGTlistExtendedGTs))}}return G}});const g=e._pe._pe_getPeHorizonSize();h=k=>function(){let n=this._cache;n||(this._cache=n=new Map);if(n.has(k))return n.get(k);let G=null;var C=k.call(this);if(!e._pe.compare(C,e._pe.NULL)){G=[C];const t=C.getNump();if(1<t){C=e._pe.getPointer(C);for(let A=1;A<t;A++)G.push(e._pe.wrapPointer(C+g*A,e._pe.PeHorizon))}}n.set(k,G);return G};m(e._pe.PeProjcs.prototype,"horizonGcsGenerate",
h);m(e._pe.PeProjcs.prototype,"horizonPcsGenerate",h);e._pe.PeObject.prototype.toString=function(k=e.PeDefs.PE_STR_OPTS_NONE){e._pe.ensureCache.prepare();const n=e._pe.getPointer(this),G=e._pe.ensureInt8(Array(e.PeDefs.PE_BUFFER_MAX));return e._pe.UTF8ToString(e._pe._pe_object_to_string_ext(n,k,G))}}function q(c){if(c){var m=e._pe.getClass(c);m&&(m=e._pe.getCache(m))&&(c=e._pe.getPointer(c))&&delete m[c]}}function r(c,m){const h=[];m=Array(m);for(let g=0;g<c;g++)h.push(e._pe.ensureInt8(m));return h}
function v(c){let m;Array.isArray(c[0])?(m=[],c.forEach(h=>{m.push(h[0],h[1])})):m=c;return m}function D(c,m,h,g=!1){if(g)for(g=0;g<2*m;g++)c[g]=e._pe.getValue(h+g*Float64Array.BYTES_PER_ELEMENT,"double");else{g=0===c.length;for(let k=0;k<m;k++)g&&(c[k]=Array(2)),c[k][0]=e._pe.getValue(h,"double"),c[k][1]=e._pe.getValue(h+Float64Array.BYTES_PER_ELEMENT,"double"),h+=2*Float64Array.BYTES_PER_ELEMENT}}let y;e._pe=null;(function(c){function m(k,n,G){e._pe.ensureCache.prepare();var C=v(G);const t=G===
C;C=e._pe.ensureFloat64(C);(k=e._pe._pe_geog_to_proj(e._pe.getPointer(k),n,C))&&D(G,n,C,t);return k}function h(k,n,G){return g(k,n,G,0)}function g(k,n,G,C){e._pe.ensureCache.prepare();var t=v(G);const A=G===t;t=e._pe.ensureFloat64(t);(k=e._pe._pe_proj_to_geog_center(e._pe.getPointer(k),n,t,C))&&D(G,n,t,A);return k}c.geogToProj=m;c.projGeog=function(k,n,G,C){switch(C){case e.PeDefs.PE_TRANSFORM_P_TO_G:return h(k,n,G);case e.PeDefs.PE_TRANSFORM_G_TO_P:return m(k,n,G)}return 0};c.projToGeog=h;c.projToGeogCenter=
g})(e.PeCSTransformations||(e.PeCSTransformations={}));(function(c){c.init=function(){c.PE_BUFFER_MAX=e._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=e._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=e._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=e._pe.PeDefs.prototype.PE_USNG_MAX;c.PE_DD_MAX=e._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=e._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=e._pe.PeDefs.prototype.PE_DMS_MAX;c.PE_UTM_MAX=e._pe.PeDefs.prototype.PE_UTM_MAX;c.PE_PARM_MAX=e._pe.PeDefs.prototype.PE_PARM_MAX;
c.PE_TYPE_NONE=e._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=e._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=e._pe.PeDefs.prototype.PE_TYPE_PROJCS;c.PE_TYPE_GEOGTRAN=e._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=e._pe.PeDefs.prototype.PE_TYPE_COORDSYS;c.PE_TYPE_UNIT=e._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_TYPE_LINUNIT=e._pe.PeDefs.prototype.PE_TYPE_LINUNIT;c.PE_STR_OPTS_NONE=e._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=e._pe.PeDefs.prototype.PE_STR_AUTH_NONE;
c.PE_STR_AUTH_TOP=e._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=e._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=e._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=e._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=e._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=e._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;c.PE_TRANSFORM_P_TO_G=e._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;c.PE_TRANSFORM_G_TO_P=e._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;c.PE_HORIZON_RECT=e._pe.PeDefs.prototype.PE_HORIZON_RECT;
c.PE_HORIZON_POLY=e._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=e._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=e._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(e.PeDefs||(e.PeDefs={}));(function(c){function m(n,G){let C=null,t=h[n];t||(t={},h[n]=t);t.hasOwnProperty(String(G))?C=t[G]:(n=e._pe.PeFactory.prototype.factoryByType(n,G),e._pe.compare(n,e._pe.NULL)||(C=n,t[G]=C));return C=k(C)}const h={},g={},k=n=>{if(n){const G=n.getType();switch(G){case e.PeDefs.PE_TYPE_GEOGCS:n=e._pe.castObject(n,
e._pe.PeGeogcs);break;case e.PeDefs.PE_TYPE_PROJCS:n=e._pe.castObject(n,e._pe.PeProjcs);break;case e.PeDefs.PE_TYPE_GEOGTRAN:n=e._pe.castObject(n,e._pe.PeGeogtran);break;default:G&e.PeDefs.PE_TYPE_UNIT&&(n=e._pe.castObject(n,e._pe.PeUnit))}}return n};c.initialize=function(){e._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(n){return m(e.PeDefs.PE_TYPE_COORDSYS,n)};c.factoryByType=m;c.fromString=function(n,G){let C=null,t=g[n];t||(t={},g[n]=t);t.hasOwnProperty(G)?C=t[G]:(n=e._pe.PeFactory.prototype.fromString(n,
G),e._pe.compare(n,e._pe.NULL)||(C=n,t[G]=C));return C=k(C)};c.geogcs=function(n){return m(e.PeDefs.PE_TYPE_GEOGCS,n)};c.geogtran=function(n){return m(e.PeDefs.PE_TYPE_GEOGTRAN,n)};c.getCode=function(n){return e._pe.PeFactory.prototype.getCode(n)};c.projcs=function(n){return m(e.PeDefs.PE_TYPE_PROJCS,n)};c.unit=function(n){return m(e.PeDefs.PE_TYPE_UNIT,n)}})(e.PeFactory||(e.PeFactory={}));e.PeGCSExtent=null;(function(c){let m;c.init=function(){c.PE_GTLIST_OPTS_COMMON=e._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
m=e._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(h,g,k,n,G,C){let t=null;const A=new e._pe.PeInteger(C);try{const z=e._pe.PeGTlistExtended.prototype.getGTlist(h,g,k,n,G,A);if(C=A.val)if(t=[z],1<C){const w=e._pe.getPointer(z);for(h=1;h<C;h++)t.push(e._pe.wrapPointer(w+m*h,e._pe.PeGTlistExtendedEntry))}}finally{e._pe.destroy(A)}return t}})(e.PeGTlistExtended||(e.PeGTlistExtended={}));(function(c){c.destroy=function(m){if(m&&m.length){for(const h of m)q(h),h.getEntries().forEach(g=>{q(g);
g=g.getGeogtran();q(g);g.getParameters().forEach(q);[g.getGeogcs1(),g.getGeogcs2()].forEach(k=>{q(k);const n=k.getDatum();q(n);q(n.getSpheroid());q(k.getPrimem());q(k.getUnit())})});e._pe.PeGTlistExtendedEntry.prototype.Delete(m[0])}}})(e.PeGTlistExtendedEntry||(e.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(m,h,g,k,n){e._pe.ensureCache.prepare();var G=v(g);const C=g===G;G=e._pe.ensureFloat64(G);let t=0;k&&(t=e._pe.ensureFloat64(k));(m=e._pe._pe_geog_to_geog(e._pe.getPointer(m),h,
G,t,n))&&D(g,h,G,C);return m}})(e.PeGTTransformations||(e.PeGTTransformations={}));(function(c){const m=(g,k,n,G,C,t)=>{e._pe.ensureCache.prepare();switch(g){case "dd":var A=e._pe._pe_geog_to_dd;var z=e.PeDefs.PE_DD_MAX;break;case "ddm":A=e._pe._pe_geog_to_ddm;z=e.PeDefs.PE_DDM_MAX;break;case "dms":A=e._pe._pe_geog_to_dms,z=e.PeDefs.PE_DMS_MAX}g=0;k&&(g=e._pe.getPointer(k));k=v(G);k=e._pe.ensureFloat64(k);z=r(n,z);G=e._pe.ensureInt32(z);if(C=A(g,n,k,C,G))for(A=0;A<n;A++)t[A]=e._pe.UTF8ToString(z[A]);
return C},h=(g,k,n,G,C)=>{e._pe.ensureCache.prepare();switch(g){case "dd":var t=e._pe._pe_dd_to_geog;break;case "ddm":t=e._pe._pe_ddm_to_geog;break;case "dms":t=e._pe._pe_dms_to_geog}g=0;k&&(g=e._pe.getPointer(k));k=G.map(A=>e._pe.ensureString(A));G=e._pe.ensureInt32(k);k=e._pe.ensureFloat64(Array(2*n));(t=t(g,n,G,k))&&D(C,n,k);return t};c.geog_to_dms=function(g,k,n,G,C){return m("dms",g,k,n,G,C)};c.dms_to_geog=function(g,k,n,G){return h("dms",g,k,n,G)};c.geog_to_ddm=function(g,k,n,G,C){return m("ddm",
g,k,n,G,C)};c.ddm_to_geog=function(g,k,n,G){return h("ddm",g,k,n,G)};c.geog_to_dd=function(g,k,n,G,C){return m("dd",g,k,n,G,C)};c.dd_to_geog=function(g,k,n,G){return h("dd",g,k,n,G)}})(e.PeNotationDms||(e.PeNotationDms={}));(function(c){c.init=function(){c.PE_MGRS_STYLE_NEW=e._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;c.PE_MGRS_STYLE_OLD=e._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;c.PE_MGRS_STYLE_AUTO=e._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;c.PE_MGRS_180_ZONE_1_PLUS=e._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
c.PE_MGRS_ADD_SPACES=e._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};c.geog_to_mgrs_extended=function(m,h,g,k,n,G,C){e._pe.ensureCache.prepare();let t=0;m&&(t=e._pe.getPointer(m));m=v(g);g=e._pe.ensureFloat64(m);m=r(h,e.PeDefs.PE_MGRS_MAX);const A=e._pe.ensureInt32(m);if(k=e._pe._pe_geog_to_mgrs_extended(t,h,g,k,n,G,A))for(n=0;n<h;n++)C[n]=e._pe.UTF8ToString(m[n]);return k};c.mgrs_to_geog_extended=function(m,h,g,k,n){e._pe.ensureCache.prepare();let G=0;m&&(G=e._pe.getPointer(m));m=g.map(C=>e._pe.ensureString(C));
g=e._pe.ensureInt32(m);m=e._pe.ensureFloat64(Array(2*h));(k=e._pe._pe_mgrs_to_geog_extended(G,h,g,k,m))&&D(n,h,m);return k}})(e.PeNotationMgrs||(e.PeNotationMgrs={}));(function(c){c.geog_to_usng=function(m,h,g,k,n,G,C){e._pe.ensureCache.prepare();let t=0;m&&(t=e._pe.getPointer(m));m=v(g);g=e._pe.ensureFloat64(m);m=r(h,e.PeDefs.PE_MGRS_MAX);const A=e._pe.ensureInt32(m);if(k=e._pe._pe_geog_to_usng(t,h,g,k,n,G,A))for(n=0;n<h;n++)C[n]=e._pe.UTF8ToString(m[n]);return k};c.usng_to_geog=function(m,h,g,k){e._pe.ensureCache.prepare();
var n=0;m&&(n=e._pe.getPointer(m));m=g.map(G=>e._pe.ensureString(G));g=e._pe.ensureInt32(m);m=e._pe.ensureFloat64(Array(2*h));(n=e._pe._pe_usng_to_geog(n,h,g,m))&&D(k,h,m);return n}})(e.PeNotationUsng||(e.PeNotationUsng={}));(function(c){c.init=function(){c.PE_UTM_OPTS_NONE=e._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;c.PE_UTM_OPTS_ADD_SPACES=e._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;c.PE_UTM_OPTS_NS=e._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};c.geog_to_utm=function(m,h,g,k,n){e._pe.ensureCache.prepare();
var G=0;m&&(G=e._pe.getPointer(m));m=v(g);g=e._pe.ensureFloat64(m);m=r(h,e.PeDefs.PE_UTM_MAX);const C=e._pe.ensureInt32(m);if(k=e._pe._pe_geog_to_utm(G,h,g,k,C))for(G=0;G<h;G++)n[G]=e._pe.UTF8ToString(m[G]);return k};c.utm_to_geog=function(m,h,g,k,n){e._pe.ensureCache.prepare();let G=0;m&&(G=e._pe.getPointer(m));m=g.map(C=>e._pe.ensureString(C));g=e._pe.ensureInt32(m);m=e._pe.ensureFloat64(Array(2*h));(k=e._pe._pe_utm_to_geog(G,h,g,k,m))&&D(n,h,m);return k}})(e.PeNotationUtm||(e.PeNotationUtm={}));
(function(c){const m=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=e._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=e._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=e._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=e._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(h,g=c.PE_PCSINFO_OPTION_DOMAIN){let k,n;m.has(h)&&(n=m.get(h),n[g]&&(k=n[g]));k||(k=e._pe.PePCSInfo.prototype.generate(h,g),n||(n=[],m.set(h,n)),n[g]=
k);return k}})(e.PePCSInfo||(e.PePCSInfo={}));(function(c){c.version_string=function(){return e._pe.PeVersion.prototype.version_string()}})(e.PeVersion||(e.PeVersion={}));var x=Object.freeze({__proto__:null,get _pe(){return e._pe},isLoaded:f,isSupported:u,load:b,get PeCSTransformations(){return e.PeCSTransformations},get PeDefs(){return e.PeDefs},get PeFactory(){return e.PeFactory},get PeGCSExtent(){return e.PeGCSExtent},get PeGTlistExtended(){return e.PeGTlistExtended},get PeGTlistExtendedEntry(){return e.PeGTlistExtendedEntry},
get PeGTTransformations(){return e.PeGTTransformations},get PeNotationDms(){return e.PeNotationDms},get PeNotationMgrs(){return e.PeNotationMgrs},get PeNotationUsng(){return e.PeNotationUsng},get PeNotationUtm(){return e.PeNotationUtm},get PePCSInfo(){return e.PePCSInfo},get PeVersion(){return e.PeVersion},_init:p});e._init=p;e.isLoaded=f;e.isSupported=u;e.load=b;e.pe=x})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(a,e){const l=Math.PI/180;var B=
e.earth.radius;const d=e.earth.eccentricitySquared;B={a1:B*d,a2:B*d*B*d,a3:B*d*d/2,a4:B*d*B*d*2.5,a5:B*d+B*d*d/2,a6:1-d};e={4326:{a:e.earth.radius,f:e.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:e.moon.radius,f:e.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:e.mars.radius,f:e.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,
f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},
104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,
f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:e.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};a.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;a.earthEllipsoidConstants=B;a.spheroids=e;a.toRadians=l;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(a){return function(){function e(B){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(B&&B.steps)for(const d of B.steps)d instanceof a?this.steps.push(d):this.steps.push(new a({wkid:d.wkid,wkt:d.wkt,isInverse:d.isInverse}))}e.cacheKey=function(B,d){return[void 0!==B.wkid&&null!==B.wkid?B.wkid.toString():"-1",void 0!==B.wkt&&null!==
B.wkt?B.wkt.toString():"",void 0!==d.wkid&&null!==d.wkid?d.wkid.toString():"-1",void 0!==d.wkt&&null!==d.wkt?d.wkt.toString():""].join()};e.fromGE=function(B){const d=new e;let f="";for(const u of B.steps)B=a.fromGE(u),d.steps.push(B),f+=B.uid.toString()+",";d._cached_projection={};d._gtlistentry=null;d._chain=f;return d};var l=e.prototype;l.getInverse=function(){const B=new e;B.steps=[];for(let d=this.steps.length-1;0<=d;d--)B.steps.push(this.steps[d].getInverse());return B};l.getGTListEntry=function(){let B=
"";for(const d of this.steps)B+=d.uid.toString()+",";B!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=B);return this._gtlistentry};l.assignCachedGe=function(B,d,f){this._cached_projection[e.cacheKey(B,d)]=f};l.getCachedGeTransformation=function(B,d){let f="";for(const u of this.steps)f+=u.uid.toString()+",";f!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=f);B=this._cached_projection[e.cacheKey(B,d)];return void 0===B?null:B};return e}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(a){let e=0;return function(){function l(B=null){this.uid=e++;B?(this._wkt=void 0!==B.wkt?B.wkt:null,this._wkid=void 0!==B.wkid?B.wkid:-1,this._isInverse=void 0!==B.isInverse?!0===B.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}l.fromGE=function(B){const d=new l;d._wkt=B.wkt;d._wkid=B.wkid;d._isInverse=B.isInverse;return d};l.prototype.getInverse=function(){const B=
new l;B._wkt=this.wkt;B._wkid=this._wkid;B._isInverse=!this.isInverse;return B};a._createClass(l,[{key:"wkt",get:function(){return this._wkt},set:function(B){this._wkt=B;this.uid=e++}},{key:"wkid",get:function(){return this._wkid},set:function(B){this._wkid=B;this.uid=e++}},{key:"isInverse",get:function(){return this._isInverse},set:function(B){this._isInverse=B;this.uid=e++}}]);return l}()})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/mathUtils ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../chunks/mat4 ../../../../geometry/support/aaBoundingRect ../../../../chunks/mat3f64 ../../../../chunks/mat4f64 ../../../../chunks/vec2f64 ../../../../chunks/mat3 ../../../../chunks/vec2 ../../support/buffer/InterleavedLayout ../lib/Util ../lib/geometryDataUtils ./renderers/utils ../lib/screenSizePerspectiveUtils ../../../../core/libs/gl-matrix-2/types/mat4 ../lib/GLMaterialTexture ./internal/MaterialUtil ../lib/Material ./internal/bufferWriterUtils ../../../../chunks/HUDMaterial.glsl ../shaders/HUDMaterialTechnique".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z){function w(fa,ja,la,da=I){y.copy(da,fa.anchorPos);da[0]*=-ja[0];da[1]*=-ja[1];da[0]+=fa.screenOffset[0]*la;da[1]+=fa.screenOffset[1]*la;return da}function F(fa,ja,la,da,ka,Z,ia,ha){ja=ja-ka-(0<ha[0]?da[0]*ha[0]:0);let O=ja+da[0]+2*ka;la=la-ka-(0<ha[1]?da[1]*ha[1]:0);ka=la+da[1]+2*ka;ia.textureIsSignedDistanceField&&(ia=ia.distanceFieldBoundingBox,ja+=da[0]*ia[0],la+=da[1]*ia[1],O-=da[0]*(1-ia[2]),ka-=da[1]*(1-ia[3]),ja-=Z,O+=Z,la-=Z,ka+=
Z);return fa[0]>ja&&fa[0]<O&&fa[1]>la&&fa[1]<ka}let E=function(fa){function ja(da){da=fa.call(this,da,H)||this;da.techniqueConfig=new z.HUDMaterialTechniqueConfiguration;return da}e._inheritsLoose(ja,fa);var la=ja.prototype;la.getTechniqueConfig=function(da,ka){this.techniqueConfig.output=da;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.verticalOffset=!!this.params.verticalOffset;this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective;
this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0;this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset;this.techniqueConfig.isDraped=this.params.isDraped;this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest;this.techniqueConfig.pixelSnappingEnabled=this.params.pixelSnappingEnabled;this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField;this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled;this.techniqueConfig.vvColor=
!!this.params.vvColorEnabled;0===da&&(this.techniqueConfig.debugDrawBorder=!!this.params.debugDrawBorder);4===da&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion);this.techniqueConfig.depthEnabled=this.params.depthEnabled;this.techniqueConfig.transparencyPassType=ka?ka.transparencyPassType:3;this.techniqueConfig.multipassGeometryEnabled=ka?ka.multipassGeometryEnabled:!1;return this.techniqueConfig};la.intersect=function(da,ka,Z,ia,ha,O,ca,ea,ba){ba?this.intersectDrapedHudGeometry(da,
O,ca,ea):this.intersectHudGeometry(da,ka,Z,ia,ca,ea)};la.intersectDrapedHudGeometry=function(da,ka,Z,ia){const ha=da.vertexAttributes.get("position"),O=da.vertexAttributes.get("size"),ca=this.params,ea=A.calculateAnchorPosForRendering(ca);let ba=1;var qa=1;l.isSome(ia)&&(qa=ia(X),ba=qa[0],qa=qa[5]);ba*=da.screenToWorldRatio;qa*=da.screenToWorldRatio;ia=2*da.screenToWorldRatio;for(let sa=0;sa<ha.data.length/ha.size;sa++){var na=sa*ha.size;const wa=ha.data[na];na=ha.data[na+1];const ra=sa*O.size;oa[0]=
O.data[ra]*ba;oa[1]=O.data[ra+1]*qa;let xa;ca.textureIsSignedDistanceField&&(xa=ca.outlineSize*da.screenToWorldRatio/2);F(ka,wa,na,oa,ia,xa,ca,ea)&&Z()}};la.intersectHudGeometry=function(da,ka,Z,ia,ha,O){if(ia.options.selectionMode&&ia.options.hud&&!h.isInstanceHidden(ka)){ka=this.params;var ca=1,ea=1;D.fromMat4(R,Z);if(l.isSome(O)){ea=O(X);ca=ea[0];ea=ea[5];{O=R;var ba=O[0],qa=O[1],na=O[2],sa=O[3],wa=O[4],ra=O[5],xa=O[6],va=O[7],za=O[8],Ba=1/Math.sqrt(ba*ba+qa*qa+na*na);const Ea=1/Math.sqrt(sa*sa+
wa*wa+ra*ra),Ha=1/Math.sqrt(xa*xa+va*va+za*za);O[0]=ba*Ba;O[1]=qa*Ba;O[2]=na*Ba;O[3]=sa*Ea;O[4]=wa*Ea;O[5]=ra*Ea;O[6]=xa*Ha;O[7]=va*Ha;O[8]=za*Ha}}O=da.vertexAttributes.get("position");ba=da.vertexAttributes.get("size");qa=da.vertexAttributes.get("normal");da=da.vertexAttributes.get("auxpos1");c.assert(3<=O.size);na=ia.point;sa=ia.camera;wa=A.calculateAnchorPosForRendering(ka);ca*=sa.pixelRatio;ea*=sa.pixelRatio;ra="screen"===this.params.centerOffsetUnits;for(xa=0;xa<O.data.length/O.size;xa++)if(va=
xa*O.size,u.set(L,O.data[va],O.data[va+1],O.data[va+2]),u.transformMat4(L,L,Z),va=xa*ba.size,oa[0]=ba.data[va]*ca,oa[1]=ba.data[va+1]*ea,u.transformMat4(L,L,sa.viewMatrix),va=xa*da.size,u.set(V,da.data[va+0],da.data[va+1],da.data[va+2]),ra||(L[0]+=V[0],L[1]+=V[1],0!==V[2]&&(va=V[2],u.normalize(V,L),u.subtract(L,L,u.scale(V,V,va)))),va=xa*qa.size,u.set(M,qa.data[va],qa.data[va+1],qa.data[va+2]),this.normalAndViewAngle(M,R,sa,W),this.applyVerticalOffsetTransformationView(L,W,sa,S),sa.applyProjection(L,
K),-1<K[0]){va=Math.floor(K[0])+this.params.screenOffset[0];za=Math.floor(K[1])+this.params.screenOffset[1];ra&&(va+=V[0],0!==V[1]&&(za+=g.applyScaleFactor(V[1],S.factorAlignment)));g.applyPrecomputedScaleFactor(oa,S.factor,oa);Ba=1*sa.pixelRatio;let Ea;ka.textureIsSignedDistanceField&&(Ea=ka.outlineSize*sa.pixelRatio/2);F(na,va,za,oa,Ba,Ea,ka,wa)&&(za=ia.ray,u.transformMat4(Q,L,b.invert(T,sa.viewMatrix)),K[0]=na[0],K[1]=na[1],sa.unprojectFromRenderScreen(K,L)&&(va=f.create(),u.copy(va,za.direction),
Ba=1/u.length(va),u.scale(va,va,Ba),za=u.distance(za.origin,L)*Ba,ha(za,va,-1,1,!0,Q)))}}};la.computeAttachmentOrigin=function(da,ka){var Z=da.vertexAttributes;if(!Z)return!1;Z=Z.get("position");da=da.indices.get("position");return m.computeAttachmentOriginPoints(Z,da,ka)};la.createBufferWriter=function(){return new aa(this)};la.normalAndViewAngle=function(da,ka,Z,ia){k.isMat4(ka)&&(ka=D.fromMat4(Y,ka));u.transformMat3(ia.normal,da,ka);u.transformMat4(ia.normal,ia.normal,Z.viewInverseTransposeMatrix);
ia.cosAngle=u.dot(P,ua);return ia};la.updateScaleInfo=function(da,ka,Z){const ia=this.params;ia.screenSizePerspective?g.precomputeScaleFactor(Z,ka,ia.screenSizePerspective,da.factor):(da.factor.scale=1,da.factor.factor=0,da.factor.minPixelSize=0,da.factor.paddingPixels=0);ia.screenSizePerspectiveAlignment?g.precomputeScaleFactor(Z,ka,ia.screenSizePerspectiveAlignment,da.factorAlignment):(da.factorAlignment.factor=da.factor.factor,da.factorAlignment.scale=da.factor.scale,da.factorAlignment.minPixelSize=
da.factor.minPixelSize,da.factorAlignment.paddingPixels=da.factor.paddingPixels)};la.applyShaderOffsetsView=function(da,ka,Z,ia,ha,O,ca){ka=this.normalAndViewAngle(ka,Z,ha,W);this.applyVerticalGroundOffsetView(da,ka,ha,ca);this.applyVerticalOffsetTransformationView(ca,ka,ha,O);this.applyPolygonOffsetView(ca,ka,ia[3],ha,ca);this.applyCenterOffsetView(ca,ia,ca);return ca};la.applyShaderOffsetsNDC=function(da,ka,Z,ia,ha){this.applyCenterOffsetNDC(da,ka,Z,ia);l.isSome(ha)&&u.copy(ha,ia);this.applyPolygonOffsetNDC(ia,
ka,Z,ia);return ia};la.applyPolygonOffsetView=function(da,ka,Z,ia,ha){var O=ia.aboveGround?1:-1;Z=B.sign(Z);0===Z&&(Z=O);O*=Z;if(0>=this.params.shaderPolygonOffset)return u.copy(ha,da);ka=B.clamp(Math.abs(ka.cosAngle),.01,1);ia=1-Math.sqrt(1-ka*ka)/ka/ia.viewport[2];0<O?u.scale(ha,da,ia):u.scale(ha,da,1/ia);return ha};la.applyVerticalGroundOffsetView=function(da,ka,Z,ia){const ha=u.length(da),O=Z.aboveGround?1:-1;Z=.5*Z.computeRenderPixelSizeAtDist(ha);ka=u.scale(L,ka.normal,O*Z);u.add(ia,da,ka);
return ia};la.applyVerticalOffsetTransformationView=function(da,ka,Z,ia){const ha=this.params;if(!ha.verticalOffset||!ha.verticalOffset.screenLength){if(ha.screenSizePerspective||ha.screenSizePerspectiveAlignment){var O=u.length(da);this.updateScaleInfo(ia,O,ka.cosAngle)}else ia.factor.scale=1,ia.factorAlignment.scale=1;return da}O=u.length(da);Z=G.verticalOffsetAtDistance(Z,O,ha.verticalOffset,ka.cosAngle,ha.screenSizePerspectiveAlignment||ha.screenSizePerspective);this.updateScaleInfo(ia,O,ka.cosAngle);
u.scale(ka.normal,ka.normal,Z);return u.add(da,da,ka.normal)};la.applyCenterOffsetView=function(da,ka,Z){const ia="screen"!==this.params.centerOffsetUnits;Z!==da&&u.copy(Z,da);ia&&(Z[0]+=ka[0],Z[1]+=ka[1],ka[2]&&(u.normalize(M,Z),u.add(Z,Z,u.scale(M,M,ka[2]))));return Z};la.applyCenterOffsetNDC=function(da,ka,Z,ia){const ha="screen"!==this.params.centerOffsetUnits;ia!==da&&u.copy(ia,da);ha||(ia[0]+=ka[0]/Z.fullWidth*2,ia[1]+=ka[1]/Z.fullHeight*2);return ia};la.applyPolygonOffsetNDC=function(da,ka,
Z,ia){const ha=this.params.shaderPolygonOffset;da!==ia&&u.copy(ia,da);ha&&(da=Z.aboveGround?1:-1,ka=da*B.sign(ka[3]),ia[2]-=(ka||da)*ha);return ia};la.getGLMaterial=function(da){if(0===da.output||7===da.output)return new N(da);if(4===da.output)return new U(da)};la.calculateRelativeScreenBounds=function(da,ka,Z=p.create()){w(this.params,da,ka,Z);Z[2]=Z[0]+da[0];Z[3]=Z[1]+da[1];return Z};return ja}(C.Material);n=function(fa){function ja(da){da=fa.call(this,{...da,...da.material.params})||this;da.updateParameters();
return da}e._inheritsLoose(ja,fa);var la=ja.prototype;la.beginSlot=function(da){return da===(this.material.params.drawInSecondSlot?19:18)};la.updateParameters=function(da){this.updateTexture(this.material.params.textureId);this.selectProgram(da)};la.selectProgram=function(da){this.technique=this.techniqueRep.acquireAndReleaseExisting(z.HUDMaterialTechnique,this.material.getTechniqueConfig(this.output,da),this.technique)};la.ensureParameters=function(da){this.updateParameters(da)};la.bind=function(da,
ka){da.bindProgram(this.technique.program);this.bindTexture(da,this.technique.program);this.bindTextureScale(da,this.technique.program);this.technique.bindPass(da,this.material.params,ka)};return ja}(n);let N=function(fa){function ja(da){da=fa.call(this,da)||this;da.isOcclusionSlot=!1;return da}e._inheritsLoose(ja,fa);var la=ja.prototype;la.beginSlot=function(da){const ka=this.material.params.drawInSecondSlot?19:18;if(this.material.params.occlusionTest)return this.isOcclusionSlot=12===da,12===da||
da===ka;this.isOcclusionSlot=!1;return da===ka};la.getTechnique=function(){return this.isOcclusionSlot?this.occlusionTechnique:this.technique};la.selectProgram=function(da){this.technique=this.techniqueRep.acquireAndReleaseExisting(z.HUDMaterialTechnique,this.material.getTechniqueConfig(this.output,da),this.technique);this.occlusionTechnique=this.techniqueRep.acquireAndReleaseExisting(z.HUDMaterialTechnique,this.material.getTechniqueConfig(6,da),this.occlusionTechnique)};la.bind=function(da,ka){const Z=
this.getTechnique();da.bindProgram(Z.program);this.isOcclusionSlot||(this.bindTexture(da,Z.program),this.bindTextureScale(da,Z.program));Z.bindPass(da,this.material.params,ka)};return ja}(n),U=function(fa){function ja(la){return fa.call(this,{...la,output:4})||this}e._inheritsLoose(ja,fa);return ja}(n);const S={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},I=v.create(),L=f.create(),M=f.create(),K=d.createRenderScreenPointArray3(),
P=f.create(),Q=f.create(),R=q.create(),Y=q.create(),T=r.create(),V=f.create(),W={normal:P,cosAngle:0},X=r.create(),oa=[0,0],ua=f.fromValues(0,0,1),H={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,
0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:v.fromValues(.5,.5),shaderPolygonOffset:1E-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",depthEnabled:!0,pixelSnappingEnabled:!0,debugDrawBorder:!1,isDraped:!1,...C.materialParametersDefaults},J=x.newLayout().vec3f("position").vec3f("normal").vec2f("uv0").vec4u8("color").vec2f("size").vec4f("auxpos1").vec4f("auxpos2");
let aa=function(){function fa(la){this.material=la;this.vertexBufferLayout=J}var ja=fa.prototype;ja.allocate=function(la){return this.vertexBufferLayout.createBuffer(la)};ja.elementCount=function(la){return 6*la.indices.get("position").length};ja.write=function(la,da,ka,Z){t.writePosition(da.indices.get("position"),da.vertexAttributes.get("position").data,la.transformation,ka.position,Z,6);t.writeNormal(da.indices.get("normal"),da.vertexAttributes.get("normal").data,la.invTranspTransformation,ka.normal,
Z,6);var ia=da.vertexAttributes.get("uv0").data;if(null==ia||4>ia.length){ia=this.material.params;var ha=la=0;var O=ia.texCoordScale[0];ia=ia.texCoordScale[1]}else la=ia[0],ha=ia[1],O=ia[2],ia=ia[3];O=Math.min(1.99999,O+1);ia=Math.min(1.99999,ia+1);var ca=da.indices.get("position").length,ea=ka.uv0,ba=Z;for(var qa=0;qa<ca;++qa)ea.set(ba,0,la),ea.set(ba,1,ha),ba+=1,ea.set(ba,0,O),ea.set(ba,1,ha),ba+=1,ea.set(ba,0,O),ea.set(ba,1,ia),ba+=1,ea.set(ba,0,O),ea.set(ba,1,ia),ba+=1,ea.set(ba,0,la),ea.set(ba,
1,ia),ba+=1,ea.set(ba,0,la),ea.set(ba,1,ha),ba+=1;t.writeColor(da.indices.get("color"),da.vertexAttributes.get("color").data,4,ka.color,Z,6);la=da.indices.get("size");ha=da.vertexAttributes.get("size").data;O=la.length;ia=ka.size;ca=Z;for(ea=0;ea<O;++ea){ba=ha[2*la[ea]];qa=ha[2*la[ea]+1];for(let na=0;6>na;++na)ia.set(ca,0,ba),ia.set(ca,1,qa),ca+=1}da.indices.get("auxpos1")&&da.vertexAttributes.get("auxpos1")&&t.writeBufferVec4(da.indices.get("auxpos1"),da.vertexAttributes.get("auxpos1").data,ka.auxpos1,
Z,6);da.indices.get("auxpos2")&&da.vertexAttributes.get("auxpos2")&&t.writeBufferVec4(da.indices.get("auxpos2"),da.vertexAttributes.get("auxpos2").data,ka.auxpos2,Z,6)};return fa}();a.HUDMaterial=E;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/mat3":function(){define(["exports","./common"],function(a,e){function l(I,L){I[0]=L[0];I[1]=L[1];I[2]=L[2];I[3]=L[4];I[4]=L[5];I[5]=L[6];I[6]=L[8];I[7]=L[9];I[8]=L[10];return I}function B(I,L){I[0]=L[0];I[1]=L[1];I[2]=L[2];I[3]=L[3];I[4]=
L[4];I[5]=L[5];I[6]=L[6];I[7]=L[7];I[8]=L[8];return I}function d(I,L,M,K,P,Q,R,Y,T,V){I[0]=L;I[1]=M;I[2]=K;I[3]=P;I[4]=Q;I[5]=R;I[6]=Y;I[7]=T;I[8]=V;return I}function f(I){I[0]=1;I[1]=0;I[2]=0;I[3]=0;I[4]=1;I[5]=0;I[6]=0;I[7]=0;I[8]=1;return I}function u(I,L){if(I===L){const M=L[1],K=L[2],P=L[5];I[1]=L[3];I[2]=L[6];I[3]=M;I[5]=L[7];I[6]=K;I[7]=P}else I[0]=L[0],I[1]=L[3],I[2]=L[6],I[3]=L[1],I[4]=L[4],I[5]=L[7],I[6]=L[2],I[7]=L[5],I[8]=L[8];return I}function b(I,L){const M=L[0],K=L[1],P=L[2],Q=L[3],
R=L[4],Y=L[5],T=L[6],V=L[7];L=L[8];const W=L*R-Y*V,X=-L*Q+Y*T,oa=V*Q-R*T;let ua=M*W+K*X+P*oa;if(!ua)return null;ua=1/ua;I[0]=W*ua;I[1]=(-L*K+P*V)*ua;I[2]=(Y*K-P*R)*ua;I[3]=X*ua;I[4]=(L*M-P*T)*ua;I[5]=(-Y*M+P*Q)*ua;I[6]=oa*ua;I[7]=(-V*M+K*T)*ua;I[8]=(R*M-K*Q)*ua;return I}function p(I,L){const M=L[0],K=L[1],P=L[2],Q=L[3],R=L[4],Y=L[5],T=L[6],V=L[7];L=L[8];I[0]=R*L-Y*V;I[1]=P*V-K*L;I[2]=K*Y-P*R;I[3]=Y*T-Q*L;I[4]=M*L-P*T;I[5]=P*Q-M*Y;I[6]=Q*V-R*T;I[7]=K*T-M*V;I[8]=M*R-K*Q;return I}function q(I){const L=
I[3],M=I[4],K=I[5],P=I[6],Q=I[7],R=I[8];return I[0]*(R*M-K*Q)+I[1]*(-R*L+K*P)+I[2]*(Q*L-M*P)}function r(I,L,M){const K=L[0],P=L[1],Q=L[2],R=L[3],Y=L[4],T=L[5],V=L[6],W=L[7];L=L[8];const X=M[0],oa=M[1],ua=M[2],H=M[3],J=M[4],aa=M[5],fa=M[6],ja=M[7];M=M[8];I[0]=X*K+oa*R+ua*V;I[1]=X*P+oa*Y+ua*W;I[2]=X*Q+oa*T+ua*L;I[3]=H*K+J*R+aa*V;I[4]=H*P+J*Y+aa*W;I[5]=H*Q+J*T+aa*L;I[6]=fa*K+ja*R+M*V;I[7]=fa*P+ja*Y+M*W;I[8]=fa*Q+ja*T+M*L;return I}function v(I,L,M){const K=L[0],P=L[1],Q=L[2],R=L[3],Y=L[4],T=L[5],V=L[6],
W=L[7];L=L[8];const X=M[0];M=M[1];I[0]=K;I[1]=P;I[2]=Q;I[3]=R;I[4]=Y;I[5]=T;I[6]=X*K+M*R+V;I[7]=X*P+M*Y+W;I[8]=X*Q+M*T+L;return I}function D(I,L,M){const K=L[0],P=L[1],Q=L[2],R=L[3],Y=L[4],T=L[5],V=L[6],W=L[7];L=L[8];const X=Math.sin(M);M=Math.cos(M);I[0]=M*K+X*R;I[1]=M*P+X*Y;I[2]=M*Q+X*T;I[3]=M*R-X*K;I[4]=M*Y-X*P;I[5]=M*T-X*Q;I[6]=V;I[7]=W;I[8]=L;return I}function y(I,L,M){const K=M[0],P=M[1];M=M[2];I[0]=K*L[0];I[1]=K*L[1];I[2]=K*L[2];I[3]=P*L[3];I[4]=P*L[4];I[5]=P*L[5];I[6]=M*L[6];I[7]=M*L[7];I[8]=
M*L[8];return I}function x(I,L,M){const K=M[0];M=M[1];I[0]=K*L[0];I[1]=K*L[1];I[2]=K*L[2];I[3]=M*L[3];I[4]=M*L[4];I[5]=M*L[5];return I}function c(I,L){I[0]=1;I[1]=0;I[2]=0;I[3]=0;I[4]=1;I[5]=0;I[6]=L[0];I[7]=L[1];I[8]=1;return I}function m(I,L){const M=Math.sin(L);L=Math.cos(L);I[0]=L;I[1]=M;I[2]=0;I[3]=-M;I[4]=L;I[5]=0;I[6]=0;I[7]=0;I[8]=1;return I}function h(I,L){I[0]=L[0];I[1]=0;I[2]=0;I[3]=0;I[4]=L[1];I[5]=0;I[6]=0;I[7]=0;I[8]=1;return I}function g(I,L){I[0]=L[0];I[1]=L[1];I[2]=0;I[3]=L[2];I[4]=
L[3];I[5]=0;I[6]=L[4];I[7]=L[5];I[8]=1;return I}function k(I,L){var M=L[0],K=L[1],P=L[2];L=L[3];var Q=M+M,R=K+K;const Y=P+P;M*=Q;const T=K*Q;K*=R;const V=P*Q,W=P*R;P*=Y;Q*=L;R*=L;L*=Y;I[0]=1-K-P;I[3]=T-L;I[6]=V+R;I[1]=T+L;I[4]=1-M-P;I[7]=W-Q;I[2]=V-R;I[5]=W+Q;I[8]=1-M-K;return I}function n(I,L){const M=L[0],K=L[1],P=L[2],Q=L[4],R=L[5],Y=L[6],T=L[8],V=L[9];L=L[10];const W=L*R-Y*V,X=-L*Q+Y*T,oa=V*Q-R*T;var ua=M*W+K*X+P*oa;if(!ua)return null;ua=1/ua;I[0]=W*ua;I[1]=(-L*K+P*V)*ua;I[2]=(Y*K-P*R)*ua;I[3]=
X*ua;I[4]=(L*M-P*T)*ua;I[5]=(-Y*M+P*Q)*ua;I[6]=oa*ua;I[7]=(-V*M+K*T)*ua;I[8]=(R*M-K*Q)*ua;return I}function G(I,L){const M=L[0],K=L[1],P=L[2],Q=L[3],R=L[4],Y=L[5],T=L[6],V=L[7];var W=L[8],X=L[9],oa=L[10],ua=L[11];const H=L[12],J=L[13],aa=L[14];L=L[15];const fa=M*Y-K*R,ja=M*T-P*R,la=M*V-Q*R,da=K*T-P*Y,ka=K*V-Q*Y,Z=P*V-Q*T,ia=W*J-X*H,ha=W*aa-oa*H;W=W*L-ua*H;const O=X*aa-oa*J;X=X*L-ua*J;oa=oa*L-ua*aa;ua=fa*oa-ja*X+la*O+da*W-ka*ha+Z*ia;if(!ua)return null;ua=1/ua;I[0]=(Y*oa-T*X+V*O)*ua;I[1]=(T*W-R*oa-
V*ha)*ua;I[2]=(R*X-Y*W+V*ia)*ua;I[3]=(P*X-K*oa-Q*O)*ua;I[4]=(M*oa-P*W+Q*ha)*ua;I[5]=(K*W-M*X-Q*ia)*ua;I[6]=(J*Z-aa*ka+L*da)*ua;I[7]=(aa*la-H*Z-L*ja)*ua;I[8]=(H*ka-J*la+L*fa)*ua;return I}function C(I,L,M){I[0]=2/L;I[1]=0;I[2]=0;I[3]=0;I[4]=-2/M;I[5]=0;I[6]=-1;I[7]=1;I[8]=1;return I}function t(I){return"mat3("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+", "+I[4]+", "+I[5]+", "+I[6]+", "+I[7]+", "+I[8]+")"}function A(I){return Math.sqrt(I[0]**2+I[1]**2+I[2]**2+I[3]**2+I[4]**2+I[5]**2+I[6]**2+I[7]**2+I[8]**2)}
function z(I,L,M){I[0]=L[0]+M[0];I[1]=L[1]+M[1];I[2]=L[2]+M[2];I[3]=L[3]+M[3];I[4]=L[4]+M[4];I[5]=L[5]+M[5];I[6]=L[6]+M[6];I[7]=L[7]+M[7];I[8]=L[8]+M[8];return I}function w(I,L,M){I[0]=L[0]-M[0];I[1]=L[1]-M[1];I[2]=L[2]-M[2];I[3]=L[3]-M[3];I[4]=L[4]-M[4];I[5]=L[5]-M[5];I[6]=L[6]-M[6];I[7]=L[7]-M[7];I[8]=L[8]-M[8];return I}function F(I,L,M){I[0]=L[0]*M;I[1]=L[1]*M;I[2]=L[2]*M;I[3]=L[3]*M;I[4]=L[4]*M;I[5]=L[5]*M;I[6]=L[6]*M;I[7]=L[7]*M;I[8]=L[8]*M;return I}function E(I,L,M,K){I[0]=L[0]+M[0]*K;I[1]=
L[1]+M[1]*K;I[2]=L[2]+M[2]*K;I[3]=L[3]+M[3]*K;I[4]=L[4]+M[4]*K;I[5]=L[5]+M[5]*K;I[6]=L[6]+M[6]*K;I[7]=L[7]+M[7]*K;I[8]=L[8]+M[8]*K;return I}function N(I,L){return I[0]===L[0]&&I[1]===L[1]&&I[2]===L[2]&&I[3]===L[3]&&I[4]===L[4]&&I[5]===L[5]&&I[6]===L[6]&&I[7]===L[7]&&I[8]===L[8]}function U(I,L){const M=I[0],K=I[1],P=I[2],Q=I[3],R=I[4],Y=I[5],T=I[6],V=I[7];I=I[8];const W=L[0],X=L[1],oa=L[2],ua=L[3],H=L[4],J=L[5],aa=L[6],fa=L[7];L=L[8];return Math.abs(M-W)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(W))&&
Math.abs(K-X)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(X))&&Math.abs(P-oa)<=e.EPSILON*Math.max(1,Math.abs(P),Math.abs(oa))&&Math.abs(Q-ua)<=e.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ua))&&Math.abs(R-H)<=e.EPSILON*Math.max(1,Math.abs(R),Math.abs(H))&&Math.abs(Y-J)<=e.EPSILON*Math.max(1,Math.abs(Y),Math.abs(J))&&Math.abs(T-aa)<=e.EPSILON*Math.max(1,Math.abs(T),Math.abs(aa))&&Math.abs(V-fa)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(fa))&&Math.abs(I-L)<=e.EPSILON*Math.max(1,Math.abs(I),Math.abs(L))}
var S=Object.freeze({__proto__:null,fromMat4:l,copy:B,set:d,identity:f,transpose:u,invert:b,adjoint:p,determinant:q,multiply:r,translate:v,rotate:D,scale:y,scaleByVec2:x,fromTranslation:c,fromRotation:m,fromScaling:h,fromMat2d:g,fromQuat:k,normalFromMat4Legacy:n,normalFromMat4:G,projection:C,str:t,frob:A,add:z,subtract:w,multiplyScalar:F,multiplyScalarAndAdd:E,exactEquals:N,equals:U,mul:r,sub:w});a.add=z;a.adjoint=p;a.copy=B;a.determinant=q;a.equals=U;a.exactEquals=N;a.frob=A;a.fromMat2d=g;a.fromMat4=
l;a.fromQuat=k;a.fromRotation=m;a.fromScaling=h;a.fromTranslation=c;a.identity=f;a.invert=b;a.mat3=S;a.mul=r;a.multiply=r;a.multiplyScalar=F;a.multiplyScalarAndAdd=E;a.normalFromMat4=G;a.normalFromMat4Legacy=n;a.projection=C;a.rotate=D;a.scale=y;a.scaleByVec2=x;a.set=d;a.str=t;a.sub=w;a.subtract=w;a.translate=v;a.transpose=u})},"esri/core/libs/gl-matrix-2/types/mat4":function(){define(["exports"],function(a){function e(B){return B instanceof Float32Array&&16<=B.length}function l(B){return Array.isArray(B)&&
16<=B.length}a.isMat4=function(B){return e(B)||l(B)};a.isMat4f32=e;a.isMat4f64=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GLMaterialTexture":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./DefaultTextureUnits","./GLMaterial"],function(a,e,l,B){return function(d){function f(b){var p=d.call(this,b)||this;p._textureIDs=new Set;p._textureRepository=b.textureRep;p._textureId=b.textureId;p._initTransparent=!!b.initTextureTransparent;
p._texture=p._acquireIfNotUndefined(p._textureId);p._textureNormal=p._acquireIfNotUndefined(b.normalTextureId);p._textureEmissive=p._acquireIfNotUndefined(b.emissiveTextureId);p._textureOcclusion=p._acquireIfNotUndefined(b.occlusionTextureId);p._textureMetallicRoughness=p._acquireIfNotUndefined(b.metallicRoughnessTextureId);return p}a._inheritsLoose(f,d);var u=f.prototype;u.dispose=function(){this._textureIDs.forEach(b=>this._textureRepository.release(b));this._textureIDs.clear()};u.updateTexture=
function(b){b!==this._textureId&&(this._releaseIfNotUndefined(this._textureId),this._textureId=b,this._texture=this._acquireIfNotUndefined(this._textureId))};u.bindTexture=function(b,p){e.isSome(this._texture)&&(p.setUniform1i("tex",l.DefaultTextureUnits.DIFFUSE),b.bindTexture(this._texture.glTexture,l.DefaultTextureUnits.DIFFUSE));e.isSome(this._textureNormal)&&(p.setUniform1i("normalTexture",l.DefaultTextureUnits.NORMAL),b.bindTexture(this._textureNormal.glTexture,l.DefaultTextureUnits.NORMAL));
e.isSome(this._textureEmissive)&&(p.setUniform1i("texEmission",l.DefaultTextureUnits.EMISSION),b.bindTexture(this._textureEmissive.glTexture,l.DefaultTextureUnits.EMISSION));e.isSome(this._textureOcclusion)&&(p.setUniform1i("texOcclusion",l.DefaultTextureUnits.OCCLUSION),b.bindTexture(this._textureOcclusion.glTexture,l.DefaultTextureUnits.OCCLUSION));e.isSome(this._textureMetallicRoughness)&&(p.setUniform1i("texMetallicRoughness",l.DefaultTextureUnits.METALLIC_ROUGHNESS),b.bindTexture(this._textureMetallicRoughness.glTexture,
l.DefaultTextureUnits.METALLIC_ROUGHNESS))};u.bindTextureScale=function(b,p){(b=e.isSome(this._texture)&&this._texture.glTexture)&&b.descriptor.textureCoordinateScaleFactor?p.setUniform2fv("textureCoordinateScaleFactor",b.descriptor.textureCoordinateScaleFactor):p.setUniform2f("textureCoordinateScaleFactor",1,1)};u._acquireIfNotUndefined=function(b){if(!e.isNone(b))return this._textureIDs.add(b),this._textureRepository.acquire(b,this._initTransparent)};u._releaseIfNotUndefined=function(b){e.isNone(b)||
(this._textureIDs.delete(b),this._textureRepository.release(b))};return f}(B)})},"esri/views/3d/webgl-engine/lib/DefaultTextureUnits":function(){define(["exports"],function(a){a.DefaultTextureUnits={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/internal/bufferWriterUtils":function(){define(["exports","../../../support/buffer/BufferView","../../lib/Util"],function(a,e,l){function B(q,
r,v,D){const y=v.typedBuffer;v=v.typedBufferStride;const x=q.length;D*=v;for(let c=0;c<x;++c){const m=2*q[c];y[D]=r[m];y[D+1]=r[m+1];D+=v}}function d(q,r,v,D,y){const x=v.typedBuffer;v=v.typedBufferStride;const c=q.length;D*=v;if(null==y||1===y)for(y=0;y<c;++y){var m=3*q[y];x[D]=r[m];x[D+1]=r[m+1];x[D+2]=r[m+2];D+=v}else for(m=0;m<c;++m){const h=3*q[m];for(let g=0;g<y;++g)x[D]=r[h],x[D+1]=r[h+1],x[D+2]=r[h+2],D+=v}}function f(q,r,v,D,y=1){const x=v.typedBuffer;v=v.typedBufferStride;const c=q.length;
D*=v;if(1===y)for(y=0;y<c;++y){var m=4*q[y];x[D]=r[m];x[D+1]=r[m+1];x[D+2]=r[m+2];x[D+3]=r[m+3];D+=v}else for(m=0;m<c;++m){const h=4*q[m];for(let g=0;g<y;++g)x[D]=r[h],x[D+1]=r[h+1],x[D+2]=r[h+2],x[D+3]=r[h+3],D+=v}}function u(q,r,v,D,y,x=1){if(v){const n=D.typedBuffer;D=D.typedBufferStride;const G=q.length,C=v[0],t=v[1],A=v[2],z=v[4],w=v[5],F=v[6],E=v[8],N=v[9],U=v[10],S=v[12],I=v[13];v=v[14];y*=D;if(1===x)for(x=0;x<G;++x){var c=3*q[x],m=r[c],h=r[c+1];c=r[c+2];n[y]=C*m+z*h+E*c+S;n[y+1]=t*m+w*h+N*
c+I;n[y+2]=A*m+F*h+U*c+v;y+=D}else for(m=0;m<G;++m){h=3*q[m];var g=r[h],k=r[h+1];const L=r[h+2];h=C*g+z*k+E*L+S;c=t*g+w*k+N*L+I;g=A*g+F*k+U*L+v;for(k=0;k<x;++k)n[y]=h,n[y+1]=c,n[y+2]=g,y+=D}}else d(q,r,D,y,x)}function b(q,r,v,D,y,x){if(v){const n=D.typedBuffer;D=D.typedBufferStride;const G=q.length,C=v[0],t=v[1],A=v[2],z=v[4],w=v[5],F=v[6],E=v[8],N=v[9];v=v[10];const U=1E-5<Math.abs(1-C*C+z*z+E*E)||1E-5<Math.abs(1-t*t+w*w+N*N)||1E-5<Math.abs(1-A*A+F*F+v*v);y*=D;if(1===x)for(x=0;x<G;++x){var c=3*q[x],
m=r[c],h=r[c+1],g=r[c+2];c=C*m+z*h+E*g;var k=t*m+w*h+N*g;m=A*m+F*h+v*g;U&&(h=c*c+k*k+m*m,.999999>h&&1E-6<h&&(h=Math.sqrt(h),c/=h,k/=h,m/=h));n[y+0]=c;n[y+1]=k;n[y+2]=m;y+=D}else for(c=0;c<G;++c){k=3*q[c];h=r[k];g=r[k+1];const S=r[k+2];k=C*h+z*g+E*S;m=t*h+w*g+N*S;h=A*h+F*g+v*S;U&&(g=k*k+m*m+h*h,.999999>g&&1E-6<g&&(g=Math.sqrt(g),k/=g,m/=g,h/=g));for(g=0;g<x;++g)n[y+0]=k,n[y+1]=m,n[y+2]=h,y+=D}}else d(q,r,D,y,x)}function p(q,r,v,D,y,x=1){const c=D.typedBuffer;D=D.typedBufferStride;const m=q.length;
y*=D;if(1===x)if(4===v)for(x=0;x<m;++x)v=4*q[x],c[y]=r[v],c[y+1]=r[v+1],c[y+2]=r[v+2],c[y+3]=r[v+3],y+=D;else{if(3===v)for(x=0;x<m;++x)v=3*q[x],c[y]=r[v],c[y+1]=r[v+1],c[y+2]=r[v+2],c[y+3]=255,y+=D}else if(4===v)for(v=0;v<m;++v){var h=4*q[v];for(var g=0;g<x;++g)c[y]=r[h],c[y+1]=r[h+1],c[y+2]=r[h+2],c[y+3]=r[h+3],y+=D}else if(3===v)for(v=0;v<m;++v)for(h=3*q[v],g=0;g<x;++g)c[y]=r[h],c[y+1]=r[h+1],c[y+2]=r[h+2],c[y+3]=255,y+=D}a.writeBufferMat3f=function(q,r,v,D){const y=v.typedBuffer;v=v.typedBufferStride;
const x=q.length;D*=v;for(let c=0;c<x;++c){const m=9*q[c];for(let h=0;9>h;++h)y[D+h]=r[m+h];D+=v}};a.writeBufferMat4f=function(q,r,v,D){const y=v.typedBuffer;v=v.typedBufferStride;const x=q.length;D*=v;for(let c=0;c<x;++c){const m=16*q[c];for(let h=0;16>h;++h)y[D+h]=r[m+h];D+=v}};a.writeBufferVec2=B;a.writeBufferVec3=d;a.writeBufferVec4=f;a.writeColor=p;a.writeDefaultAttributes=function(q,r,v,D,y,x){for(const m of r.fieldNames){r=q.vertexAttributes.get(m);const h=q.indices.get(m);if(r&&h)switch(m){case "position":l.assert(3===
r.size);var c=y.getField(m,e.BufferViewVec3f);c&&u(h,r.data,v,c,x);break;case "normal":l.assert(3===r.size);(c=y.getField(m,e.BufferViewVec3f))&&b(h,r.data,D,c,x,1);break;case "uv0":l.assert(2===r.size);(c=y.getField(m,e.BufferViewVec2f))&&B(h,r.data,c,x);break;case "color":l.assert(3===r.size||4===r.size);(c=y.getField(m,e.BufferViewVec4u8))&&p(h,r.data,r.size,c,x);break;case "symbolColor":l.assert(3===r.size||4===r.size);(c=y.getField(m,e.BufferViewVec4u8))&&p(h,r.data,r.size,c,x);break;case "tangent":l.assert(4===
r.size),(c=y.getField(m,e.BufferViewVec4f))&&f(h,r.data,c,x)}}};a.writeNormal=b;a.writePosition=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/HUDMaterial.glsl":function(){define("exports ./vec2f64 ./vec4f64 ./vec2 ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){function m(k){const n=new f.ShaderBuilder;var G=k.signedDistanceFieldEnabled;n.include(b.AlignPixel);n.include(r.HUD,k);n.include(p.Slice,k);if(6===k.output)return n.include(D.HUDOcclusionPass,k),n;n.include(q.ScreenSizePerspective);n.fragment.include(v.RgbaFloatEncoding);n.fragment.include(u.ColorConversion);n.include(x.VisualVariables,k);n.varyings.add("vcolor","vec4");n.varyings.add("vtc","vec2");n.varyings.add("vsize","vec2");k.binaryHighlightOcclusionEnabled&&
n.varyings.add("voccluded","float");n.vertex.uniforms.add("screenOffset","vec2").add("anchorPos","vec2").add("textureCoordinateScaleFactor","vec2").add("materialColor","vec4");G&&n.vertex.uniforms.add("outlineColor","vec4");k.screenSizePerspectiveEnabled&&n.vertex.uniforms.add("screenSizePerspective","vec4");(k.debugDrawBorder||k.binaryHighlightOcclusionEnabled)&&n.varyings.add("debugBorderCoords","vec4");n.attributes.add("uv0","vec2");n.attributes.add("color","vec4");n.attributes.add("size","vec2");
n.attributes.add("auxpos2","vec4");n.vertex.code.add(d.glsl`
    void main(void) {
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);

      if (rejectBySlice(projectAux.posModel)) {
        // Project outside of clip plane
        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
        return;
      }
      vec2 inputSize;
      ${k.screenSizePerspectiveEnabled?d.glsl`
      inputSize = screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);
      vec2 screenOffsetScaled = screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);
         `:d.glsl`
      inputSize = size;
      vec2 screenOffsetScaled = screenOffset;`}

      ${k.vvSize?"inputSize *\x3d vvScale(auxpos2).xx;":""}

      vec2 combinedSize = inputSize * pixelRatio;
      vec4 quadOffset = vec4(0.0);

      ${k.occlusionTestEnabled||k.binaryHighlightOcclusionEnabled?"bool visible \x3d testVisibilityHUD(posProj);":""}

      ${k.binaryHighlightOcclusionEnabled?"voccluded \x3d visible ? 0.0 : 1.0;":""}
    `);var C=d.glsl`
      vec2 uv01 = floor(uv0);
      vec2 uv = uv0 - uv01;
      quadOffset.xy = ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;
  `;const t=k.pixelSnappingEnabled?G?d.glsl`
  posProj = alignToPixelOrigin(posProj, viewport.zw) + quadOffset;`:d.glsl`
  posProj += quadOffset;
  if (inputSize.x == size.x) {
    posProj = alignToPixelOrigin(posProj, viewport.zw);
  }`:d.glsl`posProj += quadOffset;`;n.vertex.code.add(d.glsl`
      ${k.occlusionTestEnabled?"if (visible) {":""}
      ${C}
      ${k.vvColor?"vcolor \x3d vvGetColor(auxpos2, vvColorValues, vvColorColors) * materialColor;":"vcolor \x3d color / 255.0 * materialColor;"}

      bool alphaDiscard = vcolor.a < ${d.glsl.float(c.symbolAlphaCutoff)};
      ${G?`alphaDiscard = alphaDiscard && outlineColor.a < ${d.glsl.float(c.symbolAlphaCutoff)};`:""}
      if (alphaDiscard) {
        // "early discard" if both symbol color (= fill) and outline color (if applicable) are transparent
        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
        return;
      } else {
        ${t}
        gl_Position = posProj;
      }

      vtc = uv * textureCoordinateScaleFactor;

      ${k.debugDrawBorder?"debugBorderCoords \x3d vec4(uv01, 1.5 / combinedSize);":""}
      vsize = inputSize;
      ${k.occlusionTestEnabled?d.glsl`} else { vtc = vec2(0.0);
        ${k.debugDrawBorder?"debugBorderCoords \x3d vec4(0.5, 0.5, 1.5 / combinedSize);}":"}"}`:""}
    }
    `);n.fragment.uniforms.add("tex","sampler2D");G&&(n.fragment.uniforms.add("outlineColor","vec4"),n.fragment.uniforms.add("outlineSize","float"));C=k.debugDrawBorder?d.glsl`(isBorder > 0.0 ? 0.0 : ${d.glsl.float(c.defaultMaskAlphaCutoff)})`:d.glsl.float(c.defaultMaskAlphaCutoff);G=d.glsl`
    ${k.debugDrawBorder?d.glsl`
      float isBorder = float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));`:""}

    ${G?d.glsl`
      vec4 fillPixelColor = vcolor;

      // Attempt to sample texel centers to avoid that thin cross outlines
      // disappear with large symbol sizes.
      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041
      const float txSize = 128.0;
      const float texelSize = 1.0 / txSize;
      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel
      vec2 scaleFactor = (vsize - txSize) * texelSize;
      vec2 samplePos = vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;

      // Get distance and map it into [-0.5, 0.5]
      float d = rgba2float(texture2D(tex, samplePos)) - 0.5;

      // Distance in output units (i.e. pixels)
      float dist = d * vsize.x;

      // Create smooth transition from the icon into its outline
      float fillAlphaFactor = clamp(0.5 - dist, 0.0, 1.0);
      fillPixelColor.a *= fillAlphaFactor;

      if (outlineSize > 0.25) {
        vec4 outlinePixelColor = outlineColor;
        float clampedOutlineSize = min(outlineSize, 0.5*vsize.x);

        // Create smooth transition around outline
        float outlineAlphaFactor = clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);
        outlinePixelColor.a *= outlineAlphaFactor;

        if (
          outlineAlphaFactor + fillAlphaFactor < ${C} ||
          fillPixelColor.a + outlinePixelColor.a < ${d.glsl.float(c.symbolAlphaCutoff)}
        ) {
          discard;
        }

        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)
        float compositeAlpha = outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);
        vec3 compositeColor = vec3(outlinePixelColor) * outlinePixelColor.a +
          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);

        gl_FragColor = vec4(compositeColor, compositeAlpha);
      } else {
        if (fillAlphaFactor < ${C}) {
          discard;
        }

        gl_FragColor = premultiplyAlpha(fillPixelColor);
      }

      // visualize SDF:
      // gl_FragColor = vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);
      `:d.glsl`
          vec4 texColor = texture2D(tex, vtc, -0.5);
          if (texColor.a < ${C}) {
            discard;
          }
          gl_FragColor = texColor * premultiplyAlpha(vcolor);
          `}

    ${k.debugDrawBorder?d.glsl`gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);`:""}
  `;7===k.output&&n.fragment.code.add(d.glsl`
      void main() {
        ${G}
        gl_FragColor = vec4(gl_FragColor.a);
      }
      `);0===k.output&&n.fragment.code.add(d.glsl`
    void main() {
      ${G}
      ${k.FrontFacePass?"gl_FragColor.rgb /\x3d gl_FragColor.a;":""}
    }
    `);4===k.output&&(n.include(y.OutputHighlight),n.fragment.code.add(d.glsl`
    void main() {
      ${G}
      ${k.binaryHighlightOcclusionEnabled?d.glsl`
          if (voccluded == 1.0) {
            gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
          } else {
            gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
          }`:"outputHighlight();"}
    }
    `));return n}function h(k,n=g){if(k.textureIsSignedDistanceField){var G=k.anchorPos;k=k.distanceFieldBoundingBox;n[0]=G[0]*(k[2]-k[0])+k[0];n[1]=G[1]*(k[3]-k[1])+k[1]}else B.copy(n,k.anchorPos);return n}(function(k){k.bindUniforms=function(n,G,C){n.setUniform4fv("materialColor",G.color);G.textureIsSignedDistanceField&&(0>=G.outlineColor[3]||0>=G.outlineSize?(n.setUniform4fv("outlineColor",l.ZEROS),n.setUniform1f("outlineSize",0)):(n.setUniform4fv("outlineColor",G.outlineColor),n.setUniform1f("outlineSize",
G.outlineSize)));n.setUniform2f("screenOffset",2*G.screenOffset[0]*C,2*G.screenOffset[1]*C);n.setUniform2fv("anchorPos",h(G))}})(a.HUDMaterial||(a.HUDMaterial={}));const g=e.create();e=Object.freeze({__proto__:null,build:m,get HUDMaterial(){return a.HUDMaterial},calculateAnchorPosForRendering:h});a.HUDMaterialShader=e;a.build=m;a.calculateAnchorPosForRendering=h})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,
e){a.AlignPixel=function(l){const B=e.glsl`
    vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {
      vec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;
      vec2 pixelSz = vec2(1.0) / widthHeight;
      vec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;
      vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
      return vec4(result, clipCoord.zw);
    }
  `,d=e.glsl`

    vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {
      vec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;
      vec2 pixelSz = vec2(1.0) / widthHeight;
      vec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;
      vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
      return vec4(result, clipCoord.zw);
    }
  `;l.vertex.code.add(B);l.vertex.code.add(d);l.fragment.code.add(B);l.fragment.code.add(d)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl":function(){define(["exports","../../shaderModules/interfaces","../../../materials/internal/MaterialUtil"],function(a,e,l){function B(d){d.vertex.code.add(e.glsl`
    float screenSizePerspectiveMinSize(float size, vec4 factor) {
      float nonZeroSize = 1.0 - step(size, 0.0);

      return (
        factor.z * (
          1.0 +
          // Multiply by nzs ensures if size is 0, then we ignore proportionally scaled padding
          nonZeroSize *
          2.0 * factor.w / (
            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1
          )
        )
      );
    }
  `);d.vertex.code.add(e.glsl`
    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
      return absCosAngle * absCosAngle * absCosAngle;
    }
  `);d.vertex.code.add(e.glsl`
    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
      return vec4(
        min(params.x / (distanceToCamera - params.y), 1.0),
        screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
        params.z,
        params.w
      );
    }
  `);d.vertex.code.add(e.glsl`
    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
    }
  `);d.vertex.code.add(e.glsl`
    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
      return applyScreenSizePerspectiveScaleFactorFloat(
        size,
        screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
      );
    }
  `);d.vertex.code.add(e.glsl`
    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);
    }
  `);d.vertex.code.add(e.glsl`
    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
    }
  `)}(function(d){d.bindUniforms=function(f,u){u.screenSizePerspective&&(l.bindScreenSizePerspective(u.screenSizePerspective,f,"screenSizePerspective"),l.bindScreenSizePerspective(u.screenSizePerspectiveAlignment||u.screenSizePerspective,f,"screenSizePerspectiveAlignment"))}})(B||(B={}));a.ScreenSizePerspective=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl":function(){define(["exports","../../shaderModules/interfaces","../util/ScreenSizePerspective.glsl"],
function(a,e,l){function B(d,f){d.include(l.ScreenSizePerspective);d.attributes.add("position","vec3");d.attributes.add("normal","vec3");d.attributes.add("auxpos1","vec4");d.vertex.uniforms.add("proj","mat4");d.vertex.uniforms.add("view","mat4");d.vertex.uniforms.add("viewNormal","mat4");d.vertex.uniforms.add("viewport","vec4");d.vertex.uniforms.add("camPos","vec3");d.vertex.uniforms.add("polygonOffset","float");d.vertex.uniforms.add("cameraGroundRelative","float");d.vertex.uniforms.add("pixelRatio",
"float");d.vertex.uniforms.add("perDistancePixelRatio","float");d.vertex.uniforms.add("uRenderTransparentlyOccludedHUD","float");f.verticalOffsetEnabled&&d.vertex.uniforms.add("verticalOffset","vec4");f.screenSizePerspectiveEnabled&&d.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4");d.vertex.uniforms.add("hudVisibilityTexture","sampler2D");d.vertex.constants.add("smallOffsetAngle","float",.984807753012208);d.vertex.code.add(e.glsl`
    struct ProjectHUDAux {
      vec3 posModel;
      vec3 posView;
      vec3 vnormal;

      float distanceToCamera;
      float absCosAngle;
    };
  `);d.vertex.code.add(e.glsl`
    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {
      float pointGroundSign = sign(pointGroundDistance);

      if (pointGroundSign == 0.0) {
        pointGroundSign = cameraGroundRelative;
      }

      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground
      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise
      float groundRelative = cameraGroundRelative * pointGroundSign;

      // view angle dependent part of polygon offset emulation
      // we take the absolute value because the sign that is dropped is
      // instead introduced using the ground-relative position of the symbol and the camera
      if (polygonOffset > .0) {
        float cosAlpha = clamp(absCosAngle, 0.01, 1.0);

        float tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;
        float factor = (1.0 - tanAlpha / viewport[2]);

        // same side of the terrain
        if (groundRelative > 0.0) {
          posView *= factor;
        }
        // opposite sides of the terrain
        else {
          posView /= factor;
        }
      }

      return groundRelative;
    }
  `);f.isDraped||d.vertex.code.add(e.glsl`
    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {
      float distanceToCamera = length(posView);

      // Compute offset in world units for a half pixel shift
      float pixelOffset = distanceToCamera * perDistancePixelRatio * 0.5;

      // Apply offset along normal in the direction away from the ground surface
      vec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;

      // Apply the same offset also on the view space position
      vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;

      posModel += modelOffset;
      posView += viewOffset;
    }
  `);d.vertex.code.add(e.glsl`
    vec4 projectPositionHUD(out ProjectHUDAux aux) {
      // centerOffset is in view space and is used to implement world size offsetting
      // of labels with respect to objects. It also pulls the label towards the viewer
      // so that the label is visible in front of the object.
      vec3 centerOffset = auxpos1.xyz;

      // The pointGroundDistance is the distance of the geometry to the ground and is
      // negative if the point is below the ground, or positive if the point is above
      // ground.
      float pointGroundDistance = auxpos1.w;

      aux.posModel = position;
      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;
      aux.vnormal = normal;
      ${f.isDraped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);"}

      // Screen sized offset in world space, used for example for line callouts
      // Note: keep this implementation in sync with the CPU implementation, see
      //   - MaterialUtil.verticalOffsetAtDistance
      //   - HUDMaterial.applyVerticalOffsetTransformation

      aux.distanceToCamera = length(aux.posView);

      vec3 viewDirObjSpace = normalize(camPos - aux.posModel);
      float cosAngle = dot(aux.vnormal, viewDirObjSpace);

      aux.absCosAngle = abs(cosAngle);

      ${f.screenSizePerspectiveEnabled?f.verticalOffsetEnabled||1===f.screenCenterOffsetUnitsEnabled?"vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":"":""}

      ${f.verticalOffsetEnabled?f.screenSizePerspectiveEnabled?"float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight \x3d verticalOffset.x;":""}

      ${f.verticalOffsetEnabled?e.glsl`
            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);
            vec3 modelOffset = aux.vnormal * worldOffset;
            aux.posModel += modelOffset;
            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
            aux.posView += viewOffset;
            // Since we elevate the object, we need to take that into account
            // in the distance to ground
            pointGroundDistance += worldOffset;`:""}

      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);

      ${1!==f.screenCenterOffsetUnitsEnabled?e.glsl`
            // Apply x/y in view space, but z in screen space (i.e. along posView direction)
            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);

            // Same material all have same z != 0.0 condition so should not lead to
            // branch fragmentation and will save a normalization if it's not needed
            if (centerOffset.z != 0.0) {
              aux.posView -= normalize(aux.posView) * centerOffset.z;
            }
          `:""}

      vec4 posProj = proj * vec4(aux.posView, 1.0);

      ${1===f.screenCenterOffsetUnitsEnabled?f.screenSizePerspectiveEnabled?"float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY \x3d centerOffset.y;":""}

      ${1===f.screenCenterOffsetUnitsEnabled?"posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""}

      // constant part of polygon offset emulation
      posProj.z -= groundRelative * polygonOffset * posProj.w;
      return posProj;
    }
  `);d.vertex.code.add(e.glsl`
    bool testVisibilityHUD(vec4 posProj) {
      // For occlusion testing, use the nearest pixel center to avoid
      // subpixel filtering messing up the color we use to test for
      vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);

      vec4 occlusionPixel = texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);

      // the red pixel here indicates that the occlusion pixel passed the depth test against solid geometry and was written
      // the green pixel stores transparency of transparent geometry (1.0 -> fully transparent)
      // note that we also check against green == 0.0, i.e. transparent geometry that has opaque parts

      // thus we render visible pixels that are occluded by semi-transparent (but not fully transparent!) geometry here
      if (uRenderTransparentlyOccludedHUD > 0.5) {
        // multiplying by uRenderTransparentlyOccludedHUD allows us to ignore the second condition if
        // uRenderTransparentlyOccludedHUD = 0.75
        return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * uRenderTransparentlyOccludedHUD < 1.0;
      }

      // and visible pixels that are not occluded by semi-transparent geometry here
      return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
    }
  `)}(function(d){d.bindUniforms=function(f,u){f.setUniform1f("uRenderTransparentlyOccludedHUD",0===u.renderTransparentlyOccludedHUD?1:1===u.renderTransparentlyOccludedHUD?0:.75)};d.bindVisibilityTexture=function(f,u,b){u.setUniform1i("hudVisibilityTexture",4);f.bindTexture(b.hudVisibilityTexture,4);f.setActiveTexture(0)}})(B||(B={}));a.HUD=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl":function(){define(["exports","../../shaderModules/interfaces",
"../shading/MultipassGeometryTest.glsl"],function(a,e,l){(function(B){B.bindUniforms=function(d){d.setUniform4f("color",1,1,1,1)}})(a.HUDOcclusion||(a.HUDOcclusion={}));a.HUDOcclusionPass=function(B,d){d.multipassGeometryEnabled&&B.vertex.include(l.multipassGeometryTest);B.vertex.code.add(e.glsl`
  void main(void) {
    vec4 posProjCenter;
    if (dot(position, position) > 0.0) {
      // Render single point to center of the pixel to avoid subpixel
      // filtering to affect the marker color
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);
      posProjCenter = alignToPixelCenter(posProj, viewport.zw);

      ${d.multipassGeometryEnabled?e.glsl`
        // Don't draw vertices behind geometry
        if(geometryDepthTest(.5 + .5 * posProjCenter.xy / posProjCenter.w, projectAux.posView.z)){
          posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
        }`:""}

      vec3 vpos = projectAux.posModel;
      if (rejectBySlice(vpos)) {
        // Project out of clip space
        posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
      }

    }
    else {
      // Project out of clip space
      posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
    }

    gl_Position = posProjCenter;
    gl_PointSize = 1.0;
  }
  `);B.fragment.uniforms.add("color","vec4");B.fragment.code.add(e.glsl`
  void main() {
    gl_FragColor = color;
  }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassGeometryTest.glsl":function(){define(["exports","../../shaderModules/interfaces","../output/ReadLinearDepth.glsl"],function(a,e,l){a.bindMultipassGeometryUniforms=function(B,d,f){f.multipassGeometryEnabled&&f.geometryLinearDepthTexture&&(B.setUniform1i("geometryDepthTexture",11),d.bindTexture(f.geometryLinearDepthTexture,11))};a.multipassGeometryTest=function(B){B.include(l.ReadLinearDepth);
B.uniforms.add("geometryDepthTexture","sampler2D");B.uniforms.add("cameraNearFar","vec2");B.code.add(e.glsl`
    //Compare the linearized depths of the vertex/fragment and the geometry in the scene. If vertex/fragment is behind geometry, don't draw it.
    bool geometryDepthTest(vec2 pos, float elementDepth){

      float geometryDepth = linearDepthFromTexture(geometryDepthTexture, pos, cameraNearFar);
      if(elementDepth < (geometryDepth - 1.0)){
        return true;
      }
      return false;
    }
  `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/HUDMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState ../core/shaderLibrary/util/View.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/shading/MultipassGeometryTest.glsl ../core/shaderLibrary/hud/HUDOcclusionPass.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../../../../chunks/HUDMaterial.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../lib/OrderIndependentTransparency".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n){f=function(t){function A(){return t.apply(this,arguments)||this}l._inheritsLoose(A,t);var z=A.prototype;z.initializeProgram=function(w){var F=A.shader.get();const E=this.configuration;F=F.build({output:E.output,FrontFacePass:2===E.transparencyPassType,viewingMode:w.viewingMode,occlusionTestEnabled:E.occlusionTestEnabled,signedDistanceFieldEnabled:E.sdf,slicePlaneEnabled:E.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,
debugDrawBorder:E.debugDrawBorder,binaryHighlightOcclusionEnabled:E.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:E.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:E.screenSizePerspective,verticalOffsetEnabled:E.verticalOffset,pixelSnappingEnabled:E.pixelSnappingEnabled,vvSize:E.vvSize,vvColor:E.vvColor,vvInstancingEnabled:!1,isDraped:E.isDraped,multipassGeometryEnabled:E.multipassGeometryEnabled});return new p(w.rctx,F.generateSource("vertex"),F.generateSource("fragment"),b.Default3D)};
z.bindPass=function(w,F,E){r.View.bindProjectionMatrix(this.program,E.camera.projectionMatrix);this.program.setUniform1f("cameraGroundRelative",E.camera.aboveGround?1:-1);this.program.setUniform1f("perDistancePixelRatio",Math.tan(E.camera.fovY/2)/(E.camera.fullViewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",E.camera.viewInverseTransposeMatrix);this.program.setUniform1f("polygonOffset",F.shaderPolygonOffset);k.VerticalOffset.bindUniforms(this.program,F,E);D.ScreenSizePerspective.bindUniforms(this.program,
F);this.program.setUniform1f("pixelRatio",E.camera.pixelRatio||1);r.View.bindViewport(this.program,E);6===this.configuration.output?(c.HUDOcclusion.bindUniforms(this.program),this.program.setUniform2fv("cameraNearFar",E.camera.nearFar),this.program.setUniform2fv("inverseViewport",E.inverseViewport),x.bindMultipassGeometryUniforms(this.program,w,E)):(y.HUD.bindUniforms(this.program,E),g.HUDMaterial.bindUniforms(this.program,F,E.camera.pixelRatio||1),h.VisualVariables.bindUniforms(this.program,F),this.configuration.occlusionTestEnabled&&
y.HUD.bindVisibilityTexture(w,this.program,E));4===this.configuration.output&&m.OutputHighlight.bindOutputHighlight(w,this.program,E)};z.bindDraw=function(w){r.View.bindView(this.program,w);r.View.bindCamPosition(this.program,w.origin,w.camera.viewInverseTransposeMatrix);v.Slice.bindUniformsWithOrigin(this.program,this.configuration,w)};z.setPipelineState=function(w){const F=this.configuration,E=3===w,N=this.configuration.polygonOffsetEnabled&&G,U=!E&&2!==w||4===F.output?null:(F.depthEnabled||6===
F.output)&&q.defaultDepthWriteParams;return q.makePipelineState({blending:0===F.output||7===F.output||4===F.output?E?C:n.OITBlending(w):null,depthTest:{func:515},depthWrite:U,colorWrite:q.defaultColorWriteParams,polygonOffset:N})};z.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)};l._createClass(A,[{key:"primitiveType",get:function(){return 6===this.configuration.output?0:4}}]);return A}(f.ShaderTechnique);f.shader=new d.ReloadableShaderModule(g.HUDMaterialShader,
()=>new Promise(function(t,A){a(["./HUDMaterial.glsl"],t,A)}));const G={factor:0,units:-4},C=q.simpleBlendingParams(1,771);d=function(t){function A(){var z=t.apply(this,arguments)||this;z.output=0;z.occlusionTestEnabled=!0;z.sdf=!1;z.vvSize=!1;z.vvColor=!1;z.verticalOffset=!1;z.screenSizePerspective=!1;z.screenCenterOffsetUnitsEnabled=0;z.debugDrawBorder=!0;z.binaryHighlightOcclusion=!0;z.slicePlaneEnabled=!1;z.polygonOffsetEnabled=!1;z.depthEnabled=!0;z.transparencyPassType=3;z.pixelSnappingEnabled=
!0;z.isDraped=!1;z.multipassGeometryEnabled=!1;return z}l._inheritsLoose(A,t);return A}(u.ShaderTechniqueConfiguration);B.__decorate([u.parameter({count:8})],d.prototype,"output",void 0);B.__decorate([u.parameter()],d.prototype,"occlusionTestEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"sdf",void 0);B.__decorate([u.parameter()],d.prototype,"vvSize",void 0);B.__decorate([u.parameter()],d.prototype,"vvColor",void 0);B.__decorate([u.parameter()],d.prototype,"verticalOffset",void 0);B.__decorate([u.parameter()],
d.prototype,"screenSizePerspective",void 0);B.__decorate([u.parameter({count:2})],d.prototype,"screenCenterOffsetUnitsEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"debugDrawBorder",void 0);B.__decorate([u.parameter()],d.prototype,"binaryHighlightOcclusion",void 0);B.__decorate([u.parameter()],d.prototype,"slicePlaneEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"polygonOffsetEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"depthEnabled",void 0);B.__decorate([u.parameter({count:4})],
d.prototype,"transparencyPassType",void 0);B.__decorate([u.parameter()],d.prototype,"pixelSnappingEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"isDraped",void 0);B.__decorate([u.parameter()],d.prototype,"multipassGeometryEnabled",void 0);e.HUDMaterialTechnique=f;e.HUDMaterialTechniqueConfiguration=d;Object.defineProperty(e,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl":function(){define(["exports","../../shaderModules/interfaces",
"../util/ScreenSizePerspective.glsl"],function(a,e,l){function B(u,b){const p=u.vertex.code;b.verticalOffsetEnabled?(u.vertex.uniforms.add("verticalOffset","vec4"),b.screenSizePerspectiveEnabled&&(u.include(l.ScreenSizePerspective),u.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),p.add(e.glsl`
    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
      ${1===b.viewingMode?e.glsl`vec3 worldNormal = normalize(worldPos + localOrigin);`:e.glsl`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
      ${b.screenSizePerspectiveEnabled?e.glsl`
          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));
          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:e.glsl`
          float verticalOffsetScreenHeight = verticalOffset.x;`}
      // Screen sized offset in world space, used for example for line callouts
      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
      return worldNormal * worldOffset;
    }

    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      return worldPos + calculateVerticalOffset(worldPos, localOrigin);
    }
    `)):p.add(e.glsl`
    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }
    `)}function d(u,b,p,q=f){q.screenLength=u.screenLength;q.perDistance=Math.tan(.5*b)/(.5*p);q.minWorldLength=u.minWorldLength;q.maxWorldLength=u.maxWorldLength;return q}(function(u){u.bindUniforms=function(b,p,q){p.verticalOffset&&(p=d(p.verticalOffset,q.camera.fovY,q.camera.fullViewport[3]),b.setUniform4f("verticalOffset",p.screenLength*(q.camera.pixelRatio||1),p.perDistance,p.minWorldLength,p.maxWorldLength))}})(B||(B={}));const f={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0};
a.VerticalOffset=B;a.calculateVerticalOffsetFactors=d;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/elevationAlignmentUtils":function(){define("exports ../../../../core/compilerUtils ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/mat4 ../../../../geometry/projection ../../../../chunks/mat4f64 ../../../../layers/graphics/dehydratedFeatures ../../support/ElevationProvider ./graphicUtils".split(" "),function(a,e,l,B,d,f,u,b,p,q){function r(c,
m,h,g,k){const n=(b.isDehydratedPoint(c)?c.z:p.isSamplePosition(c)?c.array[c.offset+2]:c[2])||0;switch(h.mode){case "on-the-ground":return h=l.unwrapOr(p.getElevationAtPoint(m,c,"ground"),0),k&&(k.verticalDistanceToGround=0,k.sampledElevation=h),h;case "relative-to-ground":return c=l.unwrapOr(p.getElevationAtPoint(m,c,"ground"),0),h=h.geometryZWithOffset(n,g),k&&(k.verticalDistanceToGround=h,k.sampledElevation=c),h+c;case "relative-to-scene":return c=l.unwrapOr(p.getElevationAtPoint(m,c,"scene"),
0),h=h.geometryZWithOffset(n,g),k&&(k.verticalDistanceToGround=h,k.sampledElevation=c),h+c;case "absolute-height":return h=h.geometryZWithOffset(n,g),k&&(g=l.unwrapOr(p.getElevationAtPoint(m,c,"ground"),0),k.verticalDistanceToGround=h-g,k.sampledElevation=g),h;default:return e.neverReached(h.mode),0}}(function(c){c[c.NONE=0]="NONE";c[c.UPDATE=1]="UPDATE";c[c.RECREATE=2]="RECREATE"})(a.SymbolUpdateType||(a.SymbolUpdateType={}));const v={"absolute-height":{applyElevationAlignmentBuffer:function(c,m,
h,g,k,n,G,C){n=C.calculateOffsetRenderUnits(G);C=C.featureExpressionInfoContext;m*=3;g*=3;for(G=0;G<k;++G){const t=c[m+1],A=c[m+2];h[g+0]=c[m+0];h[g+1]=t;h[g+2]=null==C?A+n:n;m+=3;g+=3}return 0},requiresAlignment:function(c){const m=c.featureExpressionInfoContext;return 0!==c.meterUnitOffset||null!=m}},"on-the-ground":{applyElevationAlignmentBuffer:function(c,m,h,g,k,n){let G=0;const C=n.spatialReference;m*=3;g*=3;for(let t=0;t<k;++t){const A=c[m+0],z=c[m+1],w=l.unwrapOr(n.getElevation(A,z,c[m+2],
C,"ground"),0);G+=w;h[g+0]=A;h[g+1]=z;h[g+2]=w;m+=3;g+=3}return G/k},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(c,m,h,g,k,n,G,C){let t=0;G=C.calculateOffsetRenderUnits(G);C=C.featureExpressionInfoContext;const A=n.spatialReference;m*=3;g*=3;for(let z=0;z<k;++z){const w=c[m+0],F=c[m+1],E=c[m+2],N=l.unwrapOr(n.getElevation(w,F,E,A,"ground"),0);t+=N;h[g+0]=w;h[g+1]=F;h[g+2]=null==C?E+N+G:N+G;m+=3;g+=3}return t/k},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(c,
m,h,g,k,n,G,C){let t=0;G=C.calculateOffsetRenderUnits(G);C=C.featureExpressionInfoContext;const A=n.spatialReference;m*=3;g*=3;for(let z=0;z<k;++z){const w=c[m+0],F=c[m+1],E=c[m+2],N=l.unwrapOr(n.getElevation(w,F,E,A,"scene"),0);t+=N;h[g+0]=w;h[g+1]=F;h[g+2]=null==C?E+N+G:N+G;m+=3;g+=3}return t/k},requiresAlignment:()=>!0}},D=u.create(),y={verticalDistanceToGround:0,sampledElevation:0},x=B.create();a.applyElevationAlignmentForHUD=function(c,m,h,g,k){h=r(m,h,k,g,y);q.updateVertexAttributeAuxpos1w(c,
y.verticalDistanceToGround);k=y.sampledElevation;const n=d.copy(D,c.transformation);x[0]=m.x;x[1]=m.y;x[2]=h;f.computeLinearTransformation(m.spatialReference,x,n,g.spatialReference)?c.transformation=n:console.warn("Could not locate symbol object properly, it might be misplaced");return k};a.applyPerVertexElevationAlignment=function(c,m,h,g,k,n,G,C,t,A,z){const w=v[z.mode];let F=0;if(f.projectBuffer(c,m,h,g,t.spatialReference,k,C)&&(w.requiresAlignment(z)?(F=w.applyElevationAlignmentBuffer(g,k,n,G,
C,t,A,z),c=n,k=G):c=g,f.projectBuffer(c,t.spatialReference,k,n,A.spatialReference,G,C)))return F};a.elevationModeChangeUpdateType=function(c,m,h){return null==m||null==h?c.definedChanged:"on-the-ground"===m&&"on-the-ground"===h?c.staysOnTheGround:m===h||"on-the-ground"!==m&&"on-the-ground"!==h?a.SymbolUpdateType.UPDATE:c.onTheGroundChanged};a.evaluateElevationAlignmentAtPoint=r;a.needsElevationUpdates2D=function(c){return"relative-to-ground"===c||"relative-to-scene"===c};a.needsElevationUpdates3D=
function(c){return"absolute-height"!==c};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/support/ElevationProvider":function(){define(["exports","../../../core/maybe","../../../layers/graphics/dehydratedFeatures"],function(a,e,l){function B(d){return"array"in d}a.SamplePosition=function(d,f=null,u=0){this.array=d;this.spatialReference=f;this.offset=u};a.getElevationAtPoint=function(d,f,u="ground"){if(l.isDehydratedPoint(f))return d.getElevation(f.x,f.y,f.z||0,f.spatialReference,
u);if(B(f)){let b=f.offset;return d.getElevation(f.array[b++],f.array[b++],f.array[b]||0,e.unwrapOr(f.spatialReference,d.spatialReference),u)}return d.getElevation(f[0],f[1],f[2]||0,d.spatialReference,u)};a.isSamplePosition=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("exports ../../../../core/maybe ../../../../geometry/support/coordsUtils ../../../../geometry/support/centroid ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../chunks/mat4 ../../../../geometry/support/aaBoundingRect ../../../../geometry/projection ../../../../chunks/mat4f64 ../../../../chunks/vec2f64 ../../../../chunks/vec4f64 ../../../../chunks/vec4 ../../../../geometry/support/aaBoundingBox ../../../../layers/graphics/dehydratedFeatures ../../../../layers/graphics/hydratedFeatures".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){function m(k){var n=k.paths[0];if(!n||0===n.length)return null;n=l.getPointOnPath(n,l.getPathLength(n)/2);return x.makeDehydratedPoint(n[0],n[1],n[2],k.spatialReference)}function h(k,n,G){G=G?k:c.clonePoint(k);return n&&k?p.projectPoint(k,G,n)?G:null:G}function g(k){if(Array.isArray(k)){for(const n of k)if(!g(n))return!1;return!0}return null==k||0<=k}r={"bottom-left":r.fromValues(0,0),bottom:r.fromValues(.5,0),"bottom-right":r.fromValues(1,0),left:r.fromValues(0,
.5),center:r.fromValues(.5,.5),right:r.fromValues(1,.5),"top-left":r.fromValues(0,1),top:r.fromValues(.5,1),"top-right":r.fromValues(1,1)};a.computeCentroid=function(k,n){if("point"===k.type)return h(k,n,!1);if(c.isHydratedGeometry(k))switch(k.type){case "extent":return h(k.center,n,!1);case "polygon":return h(k.centroid,n,!1);case "polyline":return h(m(k),n,!0);case "mesh":return h(k.extent.center,n,!1)}else switch(k.type){case "extent":var G=d.isFinite(k.zmin);k=x.makeDehydratedPoint(.5*(k.xmax+
k.xmin),.5*(k.ymax+k.ymin),G?.5*(k.zmax+k.zmin):void 0,k.spatialReference);return h(k,n,!0);case "polygon":return(G=k.rings[0])&&0!==G.length?(G=B.ringsCentroid(k.rings,k.hasZ),k=x.makeDehydratedPoint(G[0],G[1],G[2],k.spatialReference)):k=null,h(k,n,!0);case "polyline":return h(m(k),n,!0)}};a.computeObjectRotation=function(k,n,G,C=q.create()){k=k||0;n=n||0;G=G||0;0!==k&&u.rotateZ(C,C,-k/180*Math.PI);0!==n&&u.rotateX(C,C,n/180*Math.PI);0!==G&&u.rotateY(C,C,G/180*Math.PI);return C};a.computeObjectScale=
function(k=f.ONES,n,G,C=1){const t=Array(3);if(e.isNone(n)||e.isNone(G))t[0]=1,t[1]=1,t[2]=1;else{let z=0;for(let w=2;0<=w;w--){const F=k[w];let E;const N=null!=F,U=0===w&&!A&&!N,S=G[w];"symbol-value"===F||U?E=0!==S?n[w]/S:1:N&&"proportional"!==F&&isFinite(F)&&(E=0!==S?F/S:1);if(null!=E){var A=t[w]=E;z=Math.max(z,Math.abs(E))}}for(k=2;0<=k;k--)null==t[k]?t[k]=A:0===t[k]&&(t[k]=.001*z)}for(A=2;0<=A;A--)t[A]/=C;return f.fromArray(t)};a.demResolutionForBoundingBox=function(k,n){return null!=n.minDemResolution?
n.minDemResolution:y.isPoint(k)?n.minDemResolutionForPoints:.01*y.maximumDimension(k)};a.enlargeExtent=function(k,n,G,C=0){if(k){n||(n=b.create());let t=.5*k.width*(G-1);G=.5*k.height*(G-1);k.width<1E-7*k.height?t+=G/20:k.height<1E-7*k.width&&(G+=t/20);D.set(n,k.xmin-t-C,k.ymin-G-C,k.xmax+t+C,k.ymax+G+C);return n}return null};a.isValidSize=g;a.mixinColorAndOpacity=function(k,n){const G=v.clone(v.ONES);e.isSome(k)&&(G[0]=k[0],G[1]=k[1],G[2]=k[2]);e.isSome(n)?G[3]=n:e.isSome(k)&&3<k.length&&(G[3]=k[3]);
return G};a.namedAnchorToHUDMaterialAnchorPos=r;a.overrideColor=function(k,n,G,C,t,A=[0,0,0,0]){for(let z=0;3>z;++z)e.isSome(k)&&null!=k[z]?A[z]=k[z]:e.isSome(G)&&null!=G[z]?A[z]=G[z]:A[z]=t[z];e.isSome(n)?A[3]=n:e.isSome(C)?A[3]=C:A[3]=t[3];return A};a.updateVertexAttributeAuxpos1w=function(k,n){for(let G=0;G<k.geometries.length;++G){const C=k.geometries[G].getMutableAttribute("auxpos1");C&&C.data[3]!==n&&(C.data[3]=n,k.geometryVertexAttrsUpdated(G))}};a.validateSymbolLayerSize=function(k){null!=
k.isPrimitive&&(k=[k.width,k.depth,k.height]);return g(k)?null:"Symbol sizes may not be negative values"};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/layers/graphics/hydratedFeatures":function(){define("exports ../../core/has ../../core/typedArrayUtil ../../core/lang ../../core/maybe ../../geometry/support/jsonUtils ../../Graphic ./dehydratedFeatures".split(" "),function(a,e,l,B,d,f,u,b){function p(h){return"declaredClass"in h}function q(h){return"declaredClass"in h}function r(h){return"declaredClass"in
h}function v(h){return d.isNone(h)?null:p(h)?h:f.fromJSON(D(h))}function D(h){const g=h.spatialReference.toJSON();switch(h.type){case "point":{const {x:k,y:n,z:G,m:C}=h;return{x:k,y:n,z:G,m:C,spatialReference:g}}case "polygon":{const {rings:k,hasZ:n,hasM:G}=h;return{rings:y(k),hasZ:n,hasM:G,spatialReference:g}}case "polyline":{const {paths:k,hasZ:n,hasM:G}=h;return{paths:y(k),hasZ:n,hasM:G,spatialReference:g}}case "extent":{const {xmin:k,xmax:n,ymin:G,ymax:C,zmin:t,zmax:A,mmin:z,mmax:w,hasZ:F,hasM:E}=
h;return{xmin:k,xmax:n,ymin:G,ymax:C,zmin:t,zmax:A,mmin:z,mmax:w,hasZ:F,hasM:E,spatialReference:g}}case "multipoint":{const {points:k,hasZ:n,hasM:G}=h;return{points:m(k)?x(k):k,hasZ:n,hasM:G,spatialReference:g}}}}function y(h){return c(h)?h.map(g=>x(g)):h}function x(h){return h.map(g=>l.toArray(g))}function c(h){for(const g of h)if(0!==g.length)return m(g);return!1}function m(h){return h.length&&(l.isFloat32Array(h[0])||l.isFloat64Array(h[0]))}a.clonePoint=function(h,g){if(!h)return null;if(q(h)){if(null==
g)return h.clone();if(q(g))return g.copy(h)}null!=g?(g.x=h.x,g.y=h.y,g.spatialReference=h.spatialReference,h.hasZ?(g.z=h.z,g.hasZ=h.hasZ):(g.z=null,g.hasZ=!1),h.hasM?(g.m=h.m,g.hasM=!0):(g.m=null,g.hasM=!1)):(g=b.makeDehydratedPoint(h.x,h.y,h.z,h.spatialReference),h.hasM&&(g.m=h.m,g.hasM=!0));return g};a.hydrateGeometry=v;a.hydrateGraphic=function(h,g){if(!h)return null;if(r(h))return h;g=new u({layer:g,sourceLayer:g});g.visible=h.visible;g.symbol=B.clone(h.symbol);g.attributes=B.clone(h.attributes);
g.geometry=v(h.geometry);return g};a.isHydratedGeometry=p;a.isHydratedGraphic=r;a.isHydratedPoint=q;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/ElevationContext":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../symbols/support/unitConversionUtils","./featureExpressionInfoUtils"],function(a,e,l,B,d){let f=function(){function u(){this._renderUnitOffset=this._meterUnitOffset=0;this._unit="meters";
this._metersPerElevationInfoUnit=1;this.mode=this.centerPointInElevationSR=this._featureExpressionInfoContext=null}var b=u.prototype;b.reset=function(){this.mode=null;this._renderUnitOffset=this._meterUnitOffset=0;this._featureExpressionInfoContext=null;this.unit="meters"};b.addOffsetRenderUnits=function(p){this._renderUnitOffset+=p};b.geometryZWithOffset=function(p,q){q=this.calculateOffsetRenderUnits(q);return null!=this.featureExpressionInfoContext?q:p+q};b.calculateOffsetRenderUnits=function(p){let q=
this._meterUnitOffset;const r=this.featureExpressionInfoContext;null!=r&&(q+=d.execute(r)*this._metersPerElevationInfoUnit);return q/p.unitInMeters+this._renderUnitOffset};b.setFromElevationInfo=function(p){this.mode=p.mode;this.unit=B.supportsUnit(p.unit)?p.unit:"meters";this.offsetElevationInfoUnits=l.unwrapOr(p.offset,0)};b.updateFeatureExpressionInfoContext=function(p,q,r){if(l.isNone(p))this._featureExpressionInfoContext=null;else{var v=p&&p.arcade;v&&l.isSome(q)&&l.isSome(r)?(this._featureExpressionInfoContext=
d.clone(p),d.setContextFeature(this._featureExpressionInfoContext,d.createFeature(v.modules,q,r))):this._featureExpressionInfoContext=p}};u.fromElevationInfo=function(p){const q=new u;l.isSome(p)&&q.setFromElevationInfo(p);return q};e._createClass(u,[{key:"featureExpressionInfoContext",get:function(){return this._featureExpressionInfoContext}},{key:"meterUnitOffset",get:function(){return this._meterUnitOffset}},{key:"unit",get:function(){return this._unit},set:function(p){this._unit=p;this._metersPerElevationInfoUnit=
B.getMetersPerUnit(p)}},{key:"offsetMeters",set:function(p){this._meterUnitOffset=p;this._renderUnitOffset=0}},{key:"offsetElevationInfoUnits",set:function(p){this._meterUnitOffset=p*this._metersPerElevationInfoUnit;this._renderUnitOffset=0}}]);return u}();a.ElevationContext=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/featureExpressionInfoUtils":function(){define(["exports","../../../../core/Logger","../../../../support/arcadeOnDemand","../../../../layers/graphics/hydratedFeatures"],
function(a,e,l,B){const d=e.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");a.clone=function(f){return{cachedResult:f.cachedResult,arcade:f.arcade?{func:f.arcade.func,context:f.arcade.modules.arcadeUtils.createExecContext(null,{sr:f.arcade.context.spatialReference}),modules:f.arcade.modules}:null}};a.createContext=async function(f,u,b){f=f&&f.expression;if("string"!==typeof f)return null;var p="0"===f?0:null;if(null!=p)return{cachedResult:p};p=await l.loadArcade();const q=p.arcadeUtils;
f=q.createSyntaxTree(f);return q.dependsOnView(f)?(null!=b&&b.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:q.createFunction(f),context:q.createExecContext(null,{sr:u}),modules:p}}};a.createContextWithoutExpressionSupport=function(f){f=f&&f.expression;return"string"===typeof f&&(f="0"===f?0:null,null!=f)?{cachedResult:f}:null};a.createFeature=function(f,u,b){return f.arcadeUtils.createFeature(u.attributes,u.geometry,b)};a.execute=function(f){if(null!=
f){if(null!=f.cachedResult)return f.cachedResult;var u=f.arcade;u=f.arcade.modules.arcadeUtils.executeFunction(u.func,u.context);"number"!==typeof u&&(u=f.cachedResult=0);return u}return 0};a.extractExpressionInfo=function(f,u=!1){const b=(f=f&&f.featureExpressionInfo)&&f.expression;u||"0"===b||(f=null);return f};a.setContextFeature=function(f,u){null!=f&&null==f.cachedResult&&(u&&f.arcade?(u._geometry&&(u._geometry=B.hydrateGeometry(u._geometry)),f.arcade.modules.arcadeUtils.updateExecContext(f.arcade.context,
u)):d.errorOncePerTick("Arcade support required but not provided"))};a.zeroContext={cachedResult:0};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/sdfPrimitives":function(){define(["exports","../../../../core/has","../../webgl-engine/lib/Util"],function(a,e,l){function B(v,D){const y=new Uint8Array(4*v*v),x=v/2-.5;D/=2;for(let m=0;m<v;m++)for(let h=0;h<v;h++){const g=h+v*m;var c=h-x;const k=m-x;c=Math.sqrt(c*c+k*k)-D;c=c/v+.5;l.packFloatRGBA(c,y,4*g)}return y}function d(v,
D){return q(v,D,!1)}function f(v,D){return q(v,D,!0)}function u(v,D){return r(v,D,!1)}function b(v,D){return r(v,D,!0)}function p(v,D){const y=new Uint8Array(4*v*v),x=Math.sqrt(1.25),c=(v-D)/2;for(let m=0;m<v;m++)for(let h=0;h<v;h++){const g=(h-c)/D,k=(m-c+.75)/D;l.packFloatRGBA(Math.max(-(1*g+-.5*k)/x,(g-1+-.5*-k)/x,-k)*D/v+.5,y,4*(m*v+h))}return y}function q(v,D,y){y&&(D/=Math.SQRT2);const x=new Uint8Array(4*v*v);for(let m=0;m<v;m++)for(let h=0;h<v;h++){var c=h-.5*v+.25;let g=-m+.5*v-.75;const k=
m*v+h;if(y){const n=(c+g)/Math.SQRT2;g=(g-c)/Math.SQRT2;c=n}c=Math.max(Math.abs(c),Math.abs(g))-.5*D;c=c/v+.5;l.packFloatRGBA(c,x,4*k)}return x}function r(v,D,y){y&&(D*=Math.SQRT2);D*=.5;const x=new Uint8Array(4*v*v);for(let m=0;m<v;m++)for(let h=0;h<v;h++){var c=h-.5*v;let g=-m+.5*v-1;const k=m*v+h;if(y){const n=(c+g)/Math.SQRT2;g=(g-c)/Math.SQRT2;c=n}c=Math.abs(c);g=Math.abs(g);c=c>g?c>D?Math.sqrt((c-D)*(c-D)+g*g):g:g>D?Math.sqrt(c*c+(g-D)*(g-D)):c;c=c/v+.5;l.packFloatRGBA(c,x,4*k)}return x}a.createCircle=
B;a.createCross=u;a.createKite=f;a.createSquare=d;a.createTriangle=p;a.createType=function(v,D,y){switch(v){case "circle":return B(D,y);case "square":return d(D,y);case "cross":return u(D,y);case "x":return b(D,y);case "kite":return f(D,y);case "triangle":return p(D,y);default:return B(D,y)}};a.createX=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/compilerUtils ../../../../core/typedArrayUtil ../../../../core/maybe ../../../../core/Error ../../../../core/urlUtils ../../../../core/promiseUtils ../../../../core/Evented ../../../../core/mathUtils ../../../../support/requestUtils ../../../../support/requestImageUtils ./Util ./ContentObject ../../../webgl/capabilities/isWebGL2Context ../../../webgl/Texture ../../../webgl/Util ./glUtil3D ../../../webgl/FramebufferObject ./BasisUtil ./DDSUtil".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n){y=function(G){function C(A,z){var w=G.call(this)||this;w.data=A;w.type=4;w.glTexture=null;w.powerOfTwoStretchInfo=null;w.loadingPromise=null;w.loadingController=null;w.events=new p;w.params=z||{};w.params.mipmap=!1!==w.params.mipmap;w.params.noUnpackFlip=w.params.noUnpackFlip||!1;w.params.preMultiplyAlpha=w.params.preMultiplyAlpha||!1;w.params.wrap=w.params.wrap||{s:10497,t:10497};w.params.powerOfTwoResizeMode=w.params.powerOfTwoResizeMode||1;w.estimatedTexMemRequired=
C.estimateTexMemRequired(w.data,w.params);w.startPreload();return w}e._inheritsLoose(C,G);var t=C.prototype;t.startPreload=function(){const A=this.data;d.isNone(A)||(A instanceof HTMLVideoElement?this.startPreloadVideoElement(A):A instanceof HTMLImageElement&&this.startPreloadImageElement(A))};t.startPreloadVideoElement=function(A){u.isBlobProtocol(A.src)||"auto"===A.preload&&A.crossOrigin||(A.preload="auto",A.crossOrigin="anonymous",A.src=A.src)};t.startPreloadImageElement=function(A){u.isDataProtocol(A.src)||
u.isBlobProtocol(A.src)||A.crossOrigin||(A.crossOrigin="anonymous",A.src=A.src)};C.getDataDimensions=function(A){return A instanceof HTMLVideoElement?{width:A.videoWidth,height:A.videoHeight}:A};C.estimateTexMemRequired=function(A,z){if(d.isNone(A))return 0;if(B.isArrayBuffer(A)||B.isUint8Array(A))return z.encoding===C.BASIS_ENCODING?k.estimateBasisTextureMemoryUsage(A):A.byteLength;const {width:w,height:F}=A instanceof Image||A instanceof ImageData||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement?
C.getDataDimensions(A):z;return(z.mipmap?4/3:1)*w*F*(z.components||4)||0};t.dispose=function(){this.data=void 0};t.createDescriptor=function(A){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.mipmap&&!this.params.disableAnisotropy?A.parameters.maxMaxAnisotropy:void 0}};t.load=function(A,z){if(d.isSome(this.glTexture))return this.glTexture;
if(d.isSome(this.loadingPromise))return this.loadingPromise;const w=this.data;return d.isNone(w)?(this.glTexture=new c(A,this.createDescriptor(A),null),A.bindTexture(this.glTexture,0),this.glTexture):"string"===typeof w?this.loadFromURL(A,z,w):w instanceof Image?this.loadFromImageElement(A,z,w):w instanceof HTMLVideoElement?this.loadFromVideoElement(A,z,w):w instanceof ImageData||w instanceof HTMLCanvasElement?this.loadFromImage(A,w,z):(B.isArrayBuffer(w)||B.isUint8Array(w))&&this.params.encoding===
C.DDS_ENCODING?this.loadFromDDSData(A,w):(B.isArrayBuffer(w)||B.isUint8Array(w))&&this.params.encoding===C.BASIS_ENCODING?this.loadFromBasis(A,w):B.isUint8Array(w)?this.loadFromPixelData(A,w):B.isArrayBuffer(w)?this.loadFromPixelData(A,new Uint8Array(w)):null};t.frameUpdate=function(A,z,w){if(!(this.data instanceof HTMLVideoElement)||d.isNone(this.glTexture)||2>this.data.readyState||w===this.data.currentTime)return w;if(d.isSome(this.powerOfTwoStretchInfo)){const {framebuffer:F,vao:E,sourceTexture:N}=
this.powerOfTwoStretchInfo;N.setData(this.data);this.drawStretchedTexture(A,z,F,E,N,this.glTexture)}else{const {width:F,height:E}=this.data,{width:N,height:U}=this.glTexture.descriptor;F!==N||E!==U?this.glTexture.updateData(0,0,0,Math.min(F,N),Math.min(E,U),this.data):this.glTexture.setData(this.data)}this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap();return this.data.currentTime};t.loadFromDDSData=function(A,z){this.glTexture=n.createDDSTexture(A,this.createDescriptor(A),z,this.params.mipmap);
A.bindTexture(this.glTexture,0);return this.glTexture};t.loadFromBasis=function(A,z){return this.loadAsync(()=>k.createTextureFromBasis(A,this.createDescriptor(A),z).then(w=>this.glTexture=w))};t.loadFromPixelData=function(A,z){D.assert(0<this.params.width&&0<this.params.height);const w=this.createDescriptor(A);w.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408;w.width=this.params.width;w.height=this.params.height;this.glTexture=new c(A,w,z);A.bindTexture(this.glTexture,
0);return this.glTexture};t.loadAsync=async function(A){const z=b.createAbortController();this.loadingController=z;const w=A(z.signal);this.loadingPromise=w;A=()=>{this.loadingController===z&&(this.loadingController=null);this.loadingPromise===w&&(this.loadingPromise=null)};w.then(A,A);return w};t.loadFromURL=function(A,z,w){return this.loadAsync(async F=>{F=await v.requestImage(w,{signal:F});return this.loadFromImage(A,F,z)})};t.loadFromImageElement=function(A,z,w){return w.complete?this.loadFromImage(A,
w,z):this.loadAsync(async F=>{F=await r.loadImageAsync(w,w.src,!1,F);return this.loadFromImage(A,F,z)})};t.loadFromVideoElement=function(A,z,w){return 2<=w.readyState?this.loadFromImage(A,w,z):this.loadFromVideoElementAsync(A,z,w)};t.loadFromVideoElementAsync=function(A,z,w){return this.loadAsync(F=>new Promise((E,N)=>{const U=()=>{w.removeEventListener("loadeddata",S);w.removeEventListener("error",I);d.isSome(L)&&L.remove()},S=()=>{2<=w.readyState&&(U(),E(this.loadFromImage(A,w,z)))},I=M=>{U();N(M||
new f("Failed to load video"))};w.addEventListener("loadeddata",S);w.addEventListener("error",I);const L=b.onAbort(F,()=>I(b.createAbortError()))}))};t.loadFromImage=function(A,z,w){const F=C.getDataDimensions(z);this.params.width=F.width;this.params.height=F.height;const E=this.createDescriptor(A);E.pixelFormat=3===this.params.components?6407:6408;if(this.requiresPowerOfTwo(A,E)&&(!q.isPowerOfTwo(F.width)||!q.isPowerOfTwo(F.height)))return this.glTexture=this.makePowerOfTwoTexture(A,z,F,E,w),A.bindTexture(this.glTexture,
0),this.glTexture;E.width=F.width;E.height=F.height;this.glTexture=new c(A,E,z);A.bindTexture(this.glTexture,0);return this.glTexture};t.requiresPowerOfTwo=function(A,z){const w="number"===typeof z.wrapMode?33071===z.wrapMode:33071===z.wrapMode.s&&33071===z.wrapMode.t;return!x(A.gl)&&(z.hasMipmap||!w)};t.makePowerOfTwoTexture=function(A,z,w,F,E){const {width:N,height:U}=w;w=q.nextHighestPowerOfTwo(N);const S=q.nextHighestPowerOfTwo(U);F.width=w;F.height=S;let I;switch(this.params.powerOfTwoResizeMode){case 2:F.textureCoordinateScaleFactor=
[N/w,U/S];I=new c(A,F);I.updateData(0,0,0,N,U,z);break;case 1:case null:case void 0:I=this.stretchToPowerOfTwo(A,z,F,E);break;default:l.neverReached(this.params.powerOfTwoResizeMode)}F.hasMipmap&&I.generateMipmap();return I};t.stretchToPowerOfTwo=function(A,z,w,F){const E=new c(A,w),N=new g(A,{colorTarget:0,depthStencilTarget:0},E);z=new c(A,{target:3553,pixelFormat:w.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!w.flipped,maxAnisotropy:8,preMultiplyAlpha:w.preMultiplyAlpha},
z);w=h.createQuadVAO(A);this.drawStretchedTexture(A,F,N,w,z,E);this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:w,sourceTexture:z,framebuffer:N}:(w.dispose(!0),z.dispose(),N.detachColorTexture(),A.bindFramebuffer(null),N.dispose());return E};t.drawStretchedTexture=function(A,z,w,F,E,N){A.bindFramebuffer(w);w=A.getViewport();A.setViewport(0,0,N.descriptor.width,N.descriptor.height);N=z.program;A.bindProgram(N);N.setUniform4f("color",1,1,1,1);N.setUniform1i("tex",0);A.bindTexture(E,0);A.bindVAO(F);
A.setPipelineState(z.pipeline);A.drawArrays(5,0,m.vertexCount(F,"geometry"));A.bindFramebuffer(null);A.setViewport(w.x,w.y,w.width,w.height)};t.unload=function(){if(d.isSome(this.powerOfTwoStretchInfo)){const {framebuffer:A,vao:z,sourceTexture:w}=this.powerOfTwoStretchInfo;z.dispose(!0);w.dispose();A.dispose();this.powerOfTwoStretchInfo=this.glTexture=null}d.isSome(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null);if(d.isSome(this.loadingController)){const A=this.loadingController;this.loadingPromise=
this.loadingController=null;A.abort()}this.events.emit("unloaded")};e._createClass(C,[{key:"width",get:function(){return this.params.width}},{key:"height",get:function(){return this.params.height}},{key:"requiresFrameUpdates",get:function(){return this.data instanceof HTMLVideoElement}}]);return C}(y.ContentObject);y.DDS_ENCODING="image/vnd-ms.dds";y.BASIS_ENCODING="image/x.basis";a.Texture=y;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports",
"../request"],function(a,e){a.requestImage=async function(l,B){({data:l}=await e(l,{responseType:"image",...B}));return l};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/BasisUtil":function(){define(["exports","../../../../core/maybe","../../../webgl/Texture","../../../webgl/Util","../../../../libs/basisu/BasisU"],function(a,e,l,B,d){async function f(){e.isNone(b)&&(b=d.getBasisTranscoder(),u=await b);return b}let u=null,b=null;a.createTextureFromBasis=async function(p,
q,r){e.isNone(u)&&(u=await f());r=new u.BasisFile(new Uint8Array(r));if(1>r.getNumImages())return null;const v=r.getNumLevels(0);var D=r.getHasAlpha();const y=r.getImageWidth(0,0),x=r.getImageHeight(0,0),{compressedTextureETC:c,compressedTextureS3TC:m}=p.capabilities,[h,g]=c?D?[1,37496]:[0,37492]:m?D?[3,33779]:[2,33776]:[13,6408];r.startTranscoding();D=[];for(let k=0;k<v;k++)D.push(new Uint8Array(r.getImageTranscodedSizeInBytes(0,k,h))),r.transcodeImage(D[k],0,k,h,0,0);r.close();r.delete();return new l(p,
{...q,samplingMode:1<v?9987:9729,hasMipmap:1<v,internalFormat:g,width:y,height:x},{type:"compressed",levels:D})};a.estimateBasisTextureMemoryUsage=function(p){if(e.isNone(u))return p.byteLength;var q=new u.BasisFile(new Uint8Array(p));if(1>q.getNumImages())return 0;p=q.getNumLevels(0);const r=q.getHasAlpha(),v=q.getImageWidth(0,0),D=q.getImageHeight(0,0);q.close();q.delete();q=B.getBytesPerElementFormat(r?37496:37492);return Math.ceil((4**p-1)/(3*4**(p-1))*D*q*v)};a.loadBasis=f;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/libs/basisu/BasisU":function(){define(["require","exports","../../core/maybe","../../assets"],function(a,e,l,B){let d;e.getBasisTranscoder=function(){if(l.isNone(d)){const f=u=>B.getAssetUrl(`esri/libs/basisu/${u}`);d=(new Promise(function(u,b){a(["../../chunks/basis_transcoder"],u,b)})).then(function(u){return u.basis_transcoder}).then(({default:u})=>u({locateFile:f}).then(b=>{b.initializeBasis();delete b.then;return b}))}return d};Object.defineProperty(e,"__esModule",
{value:!0})})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["exports","../../../../core/Logger","../../../../core/mathUtils","../../../webgl/Texture"],function(a,e,l,B){function d(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function f(r,v){var D=new Int32Array(r,0,31);if(542327876!==D[0])return u.error("Invalid magic number in DDS header"),null;if(!(D[20]&4))return u.error("Unsupported format, must contain a FourCC code"),null;var y=D[21];
let x;switch(y){case b:y=8;x=33776;break;case p:y=16;x=33778;break;case q:y=16;x=33779;break;default:return u.error("Unsupported FourCC code:",String.fromCharCode(y&255,y>>8&255,y>>16&255,y>>24&255)),null}let c=1,m=D[4],h=D[3];if(0!==(m&3)||0!==(h&3))u.warn("Rounding up compressed texture size to nearest multiple of 4."),m=m+3&-4,h=h+3&-4;const g=m,k=h;D[2]&131072&&!1!==v&&(c=Math.max(1,D[7]));1===c||l.isPowerOfTwo(m)&&l.isPowerOfTwo(h)||(u.warn("Ignoring mipmaps of non power of two sized compressed texture."),
c=1);let n=D[1]+4;const G=[];for(let C=0;C<c;++C)D=(m+3>>2)*(h+3>>2)*y,v=new Uint8Array(r,n,D),G.push(v),n+=D,m=Math.max(1,m>>1),h=Math.max(1,h>>1);return{textureData:{type:"compressed",levels:G},internalFormat:x,width:g,height:k}}const u=e.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),b=d("DXT1"),p=d("DXT3"),q=d("DXT5");a.createDDSTexture=function(r,v,D,y){const {textureData:x,internalFormat:c,width:m,height:h}=f(D,y);v.samplingMode=1<x.levels.length?9987:9729;v.hasMipmap=1<x.levels.length;
v.internalFormat=c;v.width=m;v.height=h;v=new B(r,v,x);r.bindTexture(v,0);return v};a.createDDSTextureData=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/VisualElementResources":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/watchUtils ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,e,l,B,d,f){let u=function(){function b(q){this.resourceFactory=
q;this._resources=null;this._visible=!0;this._attached=!1}var p=b.prototype;p.destroy=function(){this._destroyResources()};p.recreate=function(){this.attached&&this._createResources()};p.recreateGeometry=function(){if(this.resourceFactory.recreateGeometry){var q=this.resourceFactory.view._stage;if(!l.isNone(this._resources)&&q){var r=this._resources.object;this._resources.external.forEach(v=>{2===v.type&&q.remove(v)});r.removeAllGeometries();r=this.resourceFactory.recreateGeometry(this._resources.external,
r,this._resources.layer);q.addMany(r);this._resources.layer.commit()}}else this.recreate()};p._createOrDestroyResources=function(){this._attached?this._resources||this._createResources():this._destroyResources()};p._createResources=function(){this._destroyResources();const q=this.resourceFactory.view._stage;if(q){var r=new f.WebGLLayer({isPickable:!1});q.add(r);var v=new d.Object3D({castShadow:!1}),D=this.resourceFactory.createResources(v,r);D.forEach(x=>q.add(x));q.add(v);r.add(v);r.commit();this._syncVisible();
var y=this.resourceFactory.cameraChanged?B.init(this.resourceFactory.view.state,"camera",x=>this.resourceFactory.cameraChanged(x)):null;this._resources={layer:r,object:v,external:D,cameraHandle:y}}};p._destroyResources=function(){if(!l.isNone(this._resources)){var q=this.resourceFactory.view._stage;null==q?void 0:q.remove(this._resources.object);null==q?void 0:q.remove(this._resources.layer);this._resources.external.forEach(r=>{null==q?void 0:q.remove(r);"dispose"in r&&r.dispose()});this._resources.object.dispose();
this._resources.cameraHandle&&this._resources.cameraHandle.remove();this._resources=null}};p._syncVisible=function(){l.isNone(this._resources)||(this._resources.object.setVisible(this._visible),this._resources.layer.commit())};e._createClass(b,[{key:"object",get:function(){return l.isSome(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return l.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(q){q!==
this._visible&&(this._visible=q,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(q){q!==this._attached&&(this._attached=q,this._createOrDestroyResources())}}]);return b}();a.VisualElementResources=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/RightAngleQuadVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../core/Handles ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../support/stack ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/ColorMaterial ./Object3DVisualElement".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){c=function(h){function g(n){var G=h.call(this,n)||this;G._handles=new f;G._quadMaterial=null;G._outlineMaterial=null;G._maxSize=0;G._position=B.create();G._up=B.create();G._right=B.create();G._renderOccluded=4;G._color=q.fromValues(1,0,0,1);G._outlineColor=q.fromValues(0,0,0,1);G._outlineSize=0;G._size=32;G._outlineRenderOccluded=16;G.applyProps(n);return G}e._inheritsLoose(g,h);var k=g.prototype;k.createExternalResources=function(){this._quadMaterial=new x.ColorMaterial(this.quadMaterialParameters);
this._outlineMaterial=new y.RibbonLineMaterial(this.outlineMaterialParameters);this._handles.add(this.view.state.watch("camera",()=>this._updateTransform()))};k.destroyExternalResources=function(){this._outlineMaterial=this._quadMaterial=null;this._handles.removeAll()};k.forEachExternalMaterial=function(n){n(this._quadMaterial);n(this._outlineMaterial)};k.createGeometries=function(n){this._createQuadGeometry(n);this._createOutlineGeometry(n);this._updateTransform(n)};k._createQuadGeometry=function(n){const G=
this._quadGeometryData(this._up,this._right);n.addGeometry(G,this._quadMaterial)};k._createOutlineGeometry=function(n){if(0!==this._outlineSize){var G=d.add(r.sv3d.get(),this._up,this._right);G=D.createPolylineGeometry([this._up,G,this._right]);n.addGeometry(G,this._outlineMaterial)}};k._updateTransform=function(n=this.object){var G=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position);G=Math.min(this._maxSize,G);u.identity(m);u.translate(m,m,this._position);u.scale(m,m,[G,G,
G]);l.isSome(n)&&(n.transformation=m)};k._quadGeometryData=function(n,G){const C=d.add(r.sv3d.get(),n,G);return new v.Geometry([["position",{size:3,data:[0,0,0,...G,...n,...C],exclusive:!0}]],[["position",new Uint16Array([0,1,2,1,2,3])]])};k._updateQuadMaterial=function(){this._quadMaterial&&this._quadMaterial.setParameterValues(this.quadMaterialParameters)};k._updateOutlineMaterial=function(){this._outlineMaterial&&this._outlineMaterial.setParameterValues(this.outlineMaterialParameters)};e._createClass(g,
[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(n){n!==this._renderOccluded&&(this._renderOccluded=n,this._updateQuadMaterial())}},{key:"color",get:function(){return this._color},set:function(n){p.copy(this._color,n);this._updateQuadMaterial()}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(n){p.copy(this._outlineColor,n);this._updateOutlineMaterial()}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(n){const G=
0===this._outlineSize!==(0===n);this._outlineSize=n;G?this.recreateGeometry():this._updateOutlineMaterial()}},{key:"size",get:function(){return this._size},set:function(n){n!==this._size&&(this._size=n,this._updateTransform())}},{key:"outlineRenderOccluded",get:function(){return this._outlineRenderOccluded},set:function(n){this._outlineRenderOccluded=n;this._updateOutlineMaterial()}},{key:"geometry",set:function({previous:n,center:G,next:C}){this._maxSize=Math.min(d.distance(G,n),d.distance(G,C))/
3;d.normalize(this._up,d.subtract(this._up,n,G));d.normalize(this._right,d.subtract(this._right,C,G));d.copy(this._position,G);this.recreateGeometry()}},{key:"quadMaterialParameters",get:function(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}},{key:"outlineMaterialParameters",get:function(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}}]);return g}(c.Object3DVisualElement);const m=
b.create();a.RightAngleQuadVisualElement=c;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../lib/GLMaterial ./internal/MaterialUtil ../lib/Material ../lib/OrderIndependentTransparency ./internal/DefaultBufferWriter ../shaders/ColorMaterialTechnique".split(" "),function(a,e,l,B,d,f,u,b){let p=function(v){function D(x){x=v.call(this,x,r)||this;x.supportsEdges=!0;x.techniqueConfig=
new b.ColorMaterialTechniqueConfiguration;return x}e._inheritsLoose(D,v);var y=D.prototype;y.getTechniqueConfig=function(x,c){this.techniqueConfig.output=x;this.techniqueConfig.cullFace=this.params.cullFace;this.techniqueConfig.vertexColors=this.params.vertexColors;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;
this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.transparencyPassType=c?c.transparencyPassType:3;this.techniqueConfig.enableOffset=c?c.camera.relativeElevation<f.OITPolygonOffsetLimit:!0;this.techniqueConfig.multipassTerrainEnabled=c?c.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=c?c.cullAboveGround:!0;return this.techniqueConfig};y.getPassParameters=function(){return this.params};y.intersect=function(x,c,m,h,g,k,n){B.intersectTriangleGeometry(x,
c,h,g,k,void 0,n)};y.getGLMaterial=function(x){return 0===x.output||7===x.output||4===x.output||1===x.output&&this.params.writeLinearDepth?new q(x):void 0};y.createBufferWriter=function(){return new u.DefaultBufferWriter(u.PositionColorLayout)};return D}(d.Material),q=function(v){function D(x){x=v.call(this,x)||this;x.updateParameters();return x}e._inheritsLoose(D,v);var y=D.prototype;y.updateParameters=function(x){this.technique=this.techniqueRep.acquireAndReleaseExisting(b.ColorMaterialTechnique,
this.material.getTechniqueConfig(this.output,x),this.technique)};y.beginSlot=function(x){return 4===this.output?3===x:x===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)};y._updateOccludeeState=function(x){x.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:x.hasOccludees})};y.ensureParameters=function(x){0!==this.output&&7!==this.output||this._updateOccludeeState(x);this.updateParameters(x)};y.bind=function(x,
c){x.bindProgram(this.technique.program);this.technique.bindPass(x,this.material.getPassParameters(),c)};y.getPipelineState=function(x,c){return this.technique.getPipelineState(c)};return D}(l);const r={color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,...d.materialParametersDefaults};a.ColorMaterial=p;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/internal/DefaultBufferWriter":function(){define(["exports",
"../../../support/buffer/InterleavedLayout","./bufferWriterUtils"],function(a,e,l){const B=e.newLayout().vec3f("position"),d=e.newLayout().vec3f("position").vec2f("uv0");e=e.newLayout().vec3f("position").vec4u8("color");let f=function(){function u(p){this.vertexBufferLayout=p}var b=u.prototype;b.allocate=function(p){return this.vertexBufferLayout.createBuffer(p)};b.elementCount=function(p){return p.indices.get("position").length};b.write=function(p,q,r,v){l.writeDefaultAttributes(q,this.vertexBufferLayout,
p.transformation,p.invTranspTransformation,r,v)};return u}();a.DefaultBufferWriter=f;a.PositionColorLayout=e;a.PositionLayout=B;a.PositionUVLayout=d;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/ColorMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState ../core/shaderLibrary/util/View.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../lib/OrderIndependentTransparency ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../lib/StencilUtils ../../../../chunks/ColorMaterial.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m){f=function(g){function k(){return g.apply(this,arguments)||this}l._inheritsLoose(k,g);var n=k.prototype;n.initializeProgram=function(G){var C=k.shader.get();const t=this.configuration;C=C.build({output:t.output,OITEnabled:0===t.transparencyPassType,attributeColor:t.vertexColors,slicePlaneEnabled:t.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,multipassTerrainEnabled:t.multipassTerrainEnabled,cullAboveGround:t.cullAboveGround});
return new p(G.rctx,C.generateSource("vertex"),C.generateSource("fragment"),b.Default3D)};n.bindPass=function(G,C,t){r.View.bindProjectionMatrix(this.program,t.camera.projectionMatrix);this.program.setUniform4fv("eColor",C.color);4===this.configuration.output&&D.OutputHighlight.bindOutputHighlight(G,this.program,t);(1===this.configuration.output||t.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",t.camera.nearFar);t.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",
t.inverseViewport),x.bindMultipassTerrainUniforms(this.program,G,t))};n.bindDraw=function(G){r.View.bindView(this.program,G);v.Slice.bindUniformsWithOrigin(this.program,this.configuration,G)};n.setPipelineState=function(G,C){const t=this.configuration,A=3===G,z=2===G;return q.makePipelineState({blending:0!==t.output&&7!==t.output||!t.transparent?null:A?y.blendingDefault:y.OITBlending(G),culling:(w=>0!==w&&{face:1===w?1028:1029,mode:2305})(t.cullFace),depthTest:{func:y.OITDepthTest(G)},depthWrite:A||
z?t.writeDepth&&q.defaultDepthWriteParams:null,colorWrite:q.defaultColorWriteParams,stencilWrite:t.sceneHasOcludees?c.stencilWriteMaskOn:null,stencilTest:t.sceneHasOcludees?C?c.stencilToolMaskBaseParams:c.stencilBaseAllZerosParams:null,polygonOffset:A||z?t.polygonOffset&&h:y.getOITPolygonOffset(t.enableOffset)})};n.initializePipeline=function(){this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0);return this.setPipelineState(this.configuration.transparencyPassType,
!1)};n.getPipelineState=function(G){return G?this._occludeePipelineState:this.pipeline};return k}(f.ShaderTechnique);f.shader=new d.ReloadableShaderModule(m.ColorMaterialShader,()=>new Promise(function(g,k){a(["./ColorMaterial.glsl"],g,k)}));const h={factor:1,units:1};d=function(g){function k(){var n=g.apply(this,arguments)||this;n.output=0;n.cullFace=0;n.slicePlaneEnabled=!1;n.vertexColors=!1;n.transparent=!1;n.polygonOffset=!1;n.enableOffset=!0;n.writeDepth=!0;n.sceneHasOcludees=!1;n.transparencyPassType=
3;n.multipassTerrainEnabled=!1;n.cullAboveGround=!0;return n}l._inheritsLoose(k,g);return k}(u.ShaderTechniqueConfiguration);B.__decorate([u.parameter({count:8})],d.prototype,"output",void 0);B.__decorate([u.parameter({count:3})],d.prototype,"cullFace",void 0);B.__decorate([u.parameter()],d.prototype,"slicePlaneEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"vertexColors",void 0);B.__decorate([u.parameter()],d.prototype,"transparent",void 0);B.__decorate([u.parameter()],d.prototype,"polygonOffset",
void 0);B.__decorate([u.parameter()],d.prototype,"enableOffset",void 0);B.__decorate([u.parameter()],d.prototype,"writeDepth",void 0);B.__decorate([u.parameter()],d.prototype,"sceneHasOcludees",void 0);B.__decorate([u.parameter({count:4})],d.prototype,"transparencyPassType",void 0);B.__decorate([u.parameter()],d.prototype,"multipassTerrainEnabled",void 0);B.__decorate([u.parameter()],d.prototype,"cullAboveGround",void 0);e.ColorMaterialTechnique=f;e.ColorMaterialTechniqueConfiguration=d;Object.defineProperty(e,
"__esModule",{value:!0})})},"esri/chunks/ColorMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v){function D(x){const c=new B.ShaderBuilder,m=1===x.output;c.include(l.Transform,{linearDepth:m});c.include(v.VertexColor,x);c.vertex.uniforms.add("proj","mat4").add("view","mat4");c.attributes.add("position","vec3");c.varyings.add("vpos","vec3");x.multipassTerrainEnabled&&c.varyings.add("depth","float");m&&(c.include(r.OutputDepth,x),c.vertex.uniforms.add("cameraNearFar","vec2"),c.varyings.add("linearDepth","float"));c.vertex.code.add(e.glsl`
    void main(void) {
      vpos = position;
      forwardNormalizedVertexColor();
      ${x.multipassTerrainEnabled?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
      gl_Position = ${m?e.glsl`transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);`:e.glsl`transformPosition(proj, view, vpos);`}
    }
  `);c.include(f.Slice,x);c.fragment.include(d.ColorConversion);x.multipassTerrainEnabled&&(c.fragment.include(u.ReadLinearDepth),c.include(q.multipassTerrainTest,x));c.fragment.uniforms.add("eColor","vec4");4===x.output&&c.include(b.OutputHighlight);c.fragment.code.add(e.glsl`
  void main() {
    discardBySlice(vpos);
    ${x.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    vec4 color = ${x.attributeColor?"vColor * eColor;":"eColor;"}

    if (color.a < ${e.glsl.float(p.symbolAlphaCutoff)}) {
      discard;
    }

    ${7===x.output?e.glsl`gl_FragColor = vec4(color.a);`:""}

    ${0===x.output?e.glsl`gl_FragColor = highlightSlice(color, vpos); ${x.OITEnabled?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}`:""}
    ${4===x.output?e.glsl`outputHighlight();`:""};
    ${1===x.output?e.glsl`outputDepth(linearDepth);`:""};
  }
  `);return c}var y=Object.freeze({__proto__:null,build:D});a.ColorMaterialShader=y;a.build=D})},"esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":function(){define(["exports","../shaderModules/interfaces"],function(a,e){a.Transform=function(l,B){B.linearDepth?l.vertex.code.add(e.glsl`
    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
      vec4 eye = view * vec4(pos, 1.0);
      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
      return proj * eye;
    }
    `):l.vertex.code.add(e.glsl`
    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
      // Make sure the order of operations is the same as in transformPositionWithDepth.
      return proj * (view * vec4(pos, 1.0));
    }
    `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(a,e){a.VertexColor=function(l,B){B.attributeColor?(l.attributes.add("color","vec4"),l.varyings.add("vColor","vec4"),l.vertex.code.add(e.glsl`
      void forwardVertexColor() { vColor = color; }
    `),l.vertex.code.add(e.glsl`
      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }
    `)):l.vertex.code.add(e.glsl`
      void forwardVertexColor() {}
      void forwardNormalizedVertexColor() {}
    `)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawManipulator":function(){define(["exports","../../../../../core/Evented"],function(a,e){let l=function(){function B({grabbableForEvent:f}){this.events=new e;this.interactive=!0;this.selectable=!1;this.cursor=null;this.grabbable=!0;this.grabbableForEvent=f}var d=B.prototype;d.intersectionDistance=function(f,u){return 0};d.attach=function(){};d.detach=function(){};return B}();a.DrawManipulator=
l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/DrawingMode":function(){define(["exports"],function(a){a.defaultDrawingMode="click";a.drawingModes=["freehand","hybrid","click"];Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/drawSurfaces":function(){define(["exports","../../../../../core/maybe","../../../../../core/screenUtils","../../../../../support/elevationInfoUtils","../../../../../layers/graphics/dehydratedFeatures"],function(a,
e,l,B,d){let f=function(){function b(q,r,v,D=null){this.elevationInfo=q;this.defaultZ=r;this.view=v;this.excludeGraphics=D}var p=b.prototype;p.screenToMap=function(q){if(e.isSome(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen(l.createScreenPointArray(q.x,q.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);q=this.view.sceneIntersectionHelper.intersectElevationFromScreen(l.createScreenPointArray(q.x,q.y),this.elevationInfo,0,this.excludeGraphics);e.isSome(q)&&
(q.z=void 0);return q};p.mapToScreen=function(q){q=d.makeDehydratedPoint(q.x,q.y,B.getConvertedElevation(this.view,q,this.elevationInfo),q.spatialReference);return this.view.toScreen(q)};return b}(),u=function(){function b(q,r,v=[]){this.view=q;this.elevationInfo=r;this.exclude=v}var p=b.prototype;p.screenToMap=function(q){q=this.view.toMap(q,{exclude:this.exclude});e.isSome(q)&&(q.z=B.getZForElevationMode(q,this.view,this.elevationInfo));return q};p.mapToScreen=function(q){let r=q;e.isSome(this.elevationInfo)&&
(r=d.makeDehydratedPoint(q.x,q.y,B.getConvertedElevation(this.view,q,this.elevationInfo),q.spatialReference));return this.view.toScreen(r)};return b}();a.ElevationDrawSurface=f;a.SceneDrawSurface=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/Accessor ./interactiveToolUtils ./ManipulatorCollection".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c){a.InteractiveToolBase=function(m){function h(k){k=m.call(this,k)||this;k.attached=!1;k.created=!1;k.completed=!1;k.manipulators=new c.ManipulatorCollection;k.deferCreation=!1;k._editableFlags=[];k._creationResolver=D.createResolver();return k}e._inheritsLoose(h,m);var g=h.prototype;g.attach=function(){if(!this.attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();this._set("attached",!0)}};g.detach=function(){this.attached&&
(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))};g.handleInputEvent=function(k){if(this.attached)this.onInputEvent(k)};g.handleInputEventAfter=function(k){if(this.attached)this.onInputEventAfter(k)};g.destroy=function(){this.manipulators.destroy();this._set("view",null);this._set("created",!1);this._set("completed",!1)};g.setEditableFlag=function(k,n){this._editableFlags[k]=n;this.manipulators.isToolEditable=this._editableFlags.every(G=>null==G||G);this._updateManipulatorAttachment();
0===k&&this.notifyChange("editable");this.onEditableChange()};g.hasEditableFlag=function(k){k=this._editableFlags[k];return null==k?!0:k};g.when=function(){return this._creationResolver.promise};g.rejectCreation=function(k){this._creationResolver.reject(k)};g.initialize=function(){this.deferCreation||this.complete()};g.onAttach=function(){};g.onDetach=function(){};g.onShow=function(){};g.onHide=function(){};g.onEditableChange=function(){};g.onInputEvent=function(k){};g.onInputEventAfter=function(k){};
g.create=function(){this.created||(this._set("created",!0),this._creationResolver.resolve(this))};g.complete=function(){this.create();this._set("completed",!0)};g._show=function(){this._updateManipulatorAttachment();this.onShow()};g._hide=function(){this._updateManipulatorAttachment();this.onHide()};g._updateManipulatorAttachment=function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()};e._createClass(h,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===
this}},{key:"isSupported",get:function(){return!0}},{key:"visible",set:function(k){this._set("visible",k);k||x.setActive(this,!1);this.attached&&(k?this._show():this._hide())}},{key:"editable",get:function(){return this.hasEditableFlag(0)},set:function(k){this.setEditableFlag(0,k)}},{key:"internallyEditable",get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)}}]);return h}(y);l.__decorate([u.property({constructOnly:!0})],a.InteractiveToolBase.prototype,"view",void 0);l.__decorate([u.property({readOnly:!0})],
a.InteractiveToolBase.prototype,"active",null);l.__decorate([u.property({value:!0})],a.InteractiveToolBase.prototype,"visible",null);l.__decorate([u.property({value:!0})],a.InteractiveToolBase.prototype,"editable",null);l.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"attached",void 0);l.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"created",void 0);l.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"completed",void 0);l.__decorate([u.property({readOnly:!0})],
a.InteractiveToolBase.prototype,"manipulators",void 0);l.__decorate([u.property({constructOnly:!0})],a.InteractiveToolBase.prototype,"deferCreation",void 0);a.InteractiveToolBase=l.__decorate([p.subclass("esri.views.interactive.InteractiveToolBase")],a.InteractiveToolBase);Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe","../../core/Collection"],function(a,e,l,
B){let d=function(){function f(){this._isToolEditable=!0;this._manipulators=new B;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}var u=f.prototype;u.add=function(b,p=0){return this.addMany([b],p)[0]};u.addMany=function(b,p=0){return b.map(q=>{const r=this._nextManipulatorId++;q={id:r,manipulator:q,visibilityPredicate:p,attached:!1};this._manipulators.add(q);this._attached&&this._updateManipulatorAttachment(q);return r})};u.remove=function(b){if("number"===typeof b){for(var p=
0;p<this._manipulators.length;p++)if(this._manipulators.getItemAt(p).id===b)return b=this._manipulators.splice(p,1)[0],this._detachManipulator(b),b.id;return null}for(p=0;p<this._manipulators.length;p++)if(this._manipulators.getItemAt(p).manipulator===b)return b=this._manipulators.splice(p,1)[0],this._detachManipulator(b),b.id;return null};u.removeAll=function(){this._manipulators.forEach(b=>{this._detachManipulator(b)});this._manipulators.removeAll()};u.attach=function(){this._manipulators.forEach(b=>
{this._updateManipulatorAttachment(b)});this._attached=!0};u.detach=function(){this._manipulators.forEach(b=>{this._detachManipulator(b)});this._attached=!1};u.destroy=function(){this._manipulators.forEach(({manipulator:b})=>{b.destroy&&b.destroy()});this._manipulators.destroy();this._resourceContexts=null};u.on=function(b,p){return this._manipulators.on(b,q=>{p(q)})};u.forEach=function(b){for(const p of this._manipulators.items)b(p)};u.some=function(b){return this._manipulators.items.some(b)};u.toArray=
function(){const b=[];this.forEach(p=>b.push(p.manipulator));return b};u.intersect=function(b,p){let q=null,r=Number.MAX_VALUE;this._manipulators.forEach(({id:v,manipulator:D,attached:y})=>{y&&D.interactive&&(y=D.intersectionDistance(b,p),l.isSome(y)&&y<r&&(r=y,q={id:v,manipulator:D}))});return q};u.findById=function(b){if(l.isNone(b))return null;for(const p of this._manipulators.items)if(b===p.id)return p.manipulator;return null};u._updateManipulatorAttachment=function(b){this._isManipulatorItemVisible(b)?
this._attachManipulator(b):this._detachManipulator(b)};u._attachManipulator=function(b){b.attached||(b.manipulator.attach&&b.manipulator.attach(this._resourceContexts),b.attached=!0)};u._detachManipulator=function(b){if(b.attached){var p=b.manipulator;p.grabbing=!1;p.dragging=!1;p.hovering=!1;p.selected=!1;p.detach&&p.detach(this._resourceContexts);b.attached=!1}};u._isManipulatorItemVisible=function(b){return 2===b.visibilityPredicate?!0:this._isToolEditable?0===b.visibilityPredicate:1===b.visibilityPredicate};
e._createClass(f,[{key:"isToolEditable",set:function(b){this._isToolEditable=b}},{key:"length",get:function(){return this._manipulators.length}}]);return f}();a.ManipulatorCollection=d;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/PolygonDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../geometry ../../core/Handles ../input/InputManager ../support/screenUtils ./DrawAction ./input/DrawEvents ./input/Keys ./DrawingMode ../3d/interactive/editingTools/draw/DrawTool".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){a.PolygonDrawAction=function(t){function A(w){w=t.call(this,w)||this;w._cursorScreenPoint=null;w._panEnabled=!1;w._popVertexOnPointerMove=!1;w._addVertexOnPointerUp=!1;w._activePointerId=null;w._viewHandles=new c;w._undoRedoHandles=new c;w.mode=G.defaultDrawingMode;return w}e._inheritsLoose(A,t);var z=A.prototype;z.initialize=function(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)};z.destroy=
function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool();this.emit("destroy")};z.undo=function(){t.prototype.undo.call(this);this.notifyChange("vertices")};z.redo=function(){t.prototype.redo.call(this);this.notifyChange("vertices")};z.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};z.getGeometryZValue=function(){return 0<this.vertices.length&&
2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};z._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("click",w=>{w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=w.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(w),"touch"===w.pointerType&&this._updateCursor(w.native))},
m.ViewEventPriorities.TOOL),this.view.on("pointer-move",w=>{this._snappingTask=d.abortMaybe(this._snappingTask);this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1);this._cursorScreenPoint=h.createScreenPointFromEvent(w);"touch"!==w.pointerType&&this._updateCursor(w.native)},m.ViewEventPriorities.TOOL),this.view.on("pointer-drag",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._cursorScreenPoint=h.createScreenPointFromEvent(w),
this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(w):this._addVertexOnPointerUp=!1)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._clickEnabled?this._vertexAddHandler(w):(1===this.vertices.length&&this.vertices.pop(),this._drawCompleteHandler(w)):this._updateCursor(w.native,"touch"===w.pointerType))},m.ViewEventPriorities.TOOL),this.view.on("drag",
w=>{this._dragEnabled&&d.isSome(this._activePointerId)&&!this._panEnabled&&w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],w=>{w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("double-click",w=>{w.stopPropagation();this._drawCompleteHandler(w)},m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],w=>{w.stopPropagation();this._drawCompleteHandler(w)},m.ViewEventPriorities.TOOL),this.view.on("key-down",w=>{const {key:F,repeat:E}=w;F===n.KEYS.vertexAddKey&&
!E&&this._cursorScreenPoint?(w.stopPropagation(),this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler(w)):F===n.KEYS.drawCompleteKey&&!E&&this._cursorScreenPoint&&2<this.vertices.length?(w.stopPropagation(),this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler(w),this._drawCompleteHandler(w)):F!==n.KEYS.undoKey||this.interactiveUndoDisabled||E?F!==n.KEYS.redoKey||this.interactiveUndoDisabled||E?F!==n.KEYS.panKey||E||(w.stopPropagation(),this._panEnabled=
!0):(w.stopPropagation(),this.redo()):(w.stopPropagation(),this.undo())},m.ViewEventPriorities.TOOL),this.view.on("key-up",w=>{w.key===n.KEYS.panKey&&(w.stopPropagation(),this._panEnabled=!1)},m.ViewEventPriorities.TOOL)])};z._addUndoRedoHandles=function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",w=>{this.notifyChange("vertices");if("undo"===w.operation){const F=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(F);
const E=[...this._committedVertices];d.isSome(this._stagedVertex)&&E.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("undo",new k.VertexRemoveEvent(this.view,F,w.vertices[0].index,E))}}),this._editGeometry.on("vertex-add",w=>{this.notifyChange("vertices");if("apply"===w.operation)w=new k.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",w),w.defaultPrevented&&
(this._popVertexOnPointerMove=!0);else if("redo"===w.operation){const F=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(F);const E=[...this._committedVertices];d.isSome(this._stagedVertex)&&E.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("redo",new k.VertexAddEvent(this.view,F,w.vertices[0].index,E))}})])};z._removeViewHandles=function(){this._viewHandles.removeAll()};z._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};
z._addDrawTool=function(w){this._drawTool=new C.DrawTool({view:w,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",F=>{1===F.vertices.length&&this.emit("vertex-add",new k.VertexAddEvent(this.view,null,F.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",F=>{1===F.vertices.length&&this.emit("cursor-update",
new k.CursorUpdateEvent(this.view,null,F.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",F=>{this.emit("draw-complete",new k.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));this._removeDrawTool()})};z._removeDrawTool=function(){d.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};z._addVertex=function(w,F){w=this._coordinateHelper.fromArray(w);this._isDuplicateOfLastVertex(w)||(this._lastVertexUnsnapped=
this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(w),F=F||new Event("placeholder"),this._nativeEventHistory.undoStack.push(F))};z._updateCursor=function(w,F=!1){this._popCursorVertex();if(this._cursorScreenPoint){var E=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(d.isSome(E)&&!F){this._pushCursorVertex(E.vertex);const N=()=>new k.CursorUpdateEvent(this.view,w,this._activeComponent.vertices.length,this.vertices,d.isSome(this._stagedVertex)?new y(this._stagedVertex):
null);this.emit("cursor-update",N());d.isSome(this._snappingTask)&&this._snappingTask.promise.then(U=>{U.valid&&this.emit("cursor-update",N())},()=>{})}}};z._completeDrawing=function(w){this._activePointerId=null;this._popCursorVertex();this._snappingTask=d.abortMaybe(this._snappingTask);d.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();3>this.vertices.length||(w=new k.DrawCompleteEvent(w,this.vertices),this.emit("draw-complete",w),w.defaultPrevented||this._removeViewHandles())};
z._shouldHandlePointerEvent=function(w){return("mouse"!==w.pointerType||0===w.button)&&(d.isNone(this._activePointerId)||this._activePointerId===w.pointerId)};z._vertexAddHandler=function(w){const F=d.isSome(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);d.isSome(F)&&this._addVertex(F,w.native)};z._drawCompleteHandler=function(w){this._completeDrawing(w.native)};e._createClass(A,[{key:"_dragEnabled",get:function(){return"freehand"===
this.mode||"hybrid"===this.mode}},{key:"_clickEnabled",get:function(){return"click"===this.mode||"hybrid"===this.mode}}]);return A}(g);l.__decorate([b.property()],a.PolygonDrawAction.prototype,"_dragEnabled",null);l.__decorate([b.property()],a.PolygonDrawAction.prototype,"_clickEnabled",null);l.__decorate([b.property({type:G.drawingModes})],a.PolygonDrawAction.prototype,"mode",void 0);a.PolygonDrawAction=l.__decorate([q.subclass("esri.views.draw.PolygonDrawAction")],a.PolygonDrawAction);Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/draw/PolylineDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../geometry ../../core/Handles ../input/InputManager ../support/screenUtils ./DrawAction ./input/DrawEvents ./input/Keys ./DrawingMode ../3d/interactive/editingTools/draw/DrawTool".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C){a.PolylineDrawAction=function(t){function A(w){w=t.call(this,w)||this;w._cursorScreenPoint=null;w._panEnabled=!1;w._popVertexOnPointerMove=!1;w._addVertexOnPointerUp=!1;w._activePointerId=null;w._viewHandles=new c;w._undoRedoHandles=new c;w.mode=G.defaultDrawingMode;return w}e._inheritsLoose(A,t);var z=A.prototype;z.initialize=function(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)};z.destroy=
function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool();this.emit("destroy")};z.undo=function(){t.prototype.undo.call(this);this.notifyChange("vertices")};z.redo=function(){t.prototype.redo.call(this);this.notifyChange("vertices")};z.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};z._addViewHandles=function(){this._removeViewHandles();
this._viewHandles.add([this.view.on("click",w=>{w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",w=>{this._shouldHandlePointerEvent(w)&&!this._panEnabled&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=w.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(w),"touch"===w.pointerType&&this._updateCursor(w.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",w=>{this._popVertexOnPointerMove&&
(this.undo(),this._popVertexOnPointerMove=!1);this._snappingTask=d.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(w);"touch"!==w.pointerType&&this._updateCursor(w.native)},m.ViewEventPriorities.TOOL),this.view.on("pointer-drag",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._cursorScreenPoint=h.createScreenPointFromEvent(w),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(w):this._addVertexOnPointerUp=
!1)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",w=>{this._shouldHandlePointerEvent(w)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._clickEnabled?this._vertexAddHandler(w):(1===this.vertices.length&&this.vertices.pop(),this._drawCompleteHandler(w)):this._updateCursor(w.native,"touch"===w.pointerType))},m.ViewEventPriorities.TOOL),this.view.on("drag",w=>{this._dragEnabled&&d.isSome(this._activePointerId)&&!this._panEnabled&&
w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],w=>{w.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("double-click",w=>{w.stopPropagation();this._drawCompleteHandler(w)},m.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],w=>{w.stopPropagation();this._drawCompleteHandler(w)},m.ViewEventPriorities.TOOL),this.view.on("key-down",w=>{const {key:F,repeat:E}=w;F===n.KEYS.vertexAddKey&&!E&&this._cursorScreenPoint?(w.stopPropagation(),this._snappingTask=
d.abortMaybe(this._snappingTask),this._vertexAddHandler(w)):F===n.KEYS.drawCompleteKey&&!E&&this._cursorScreenPoint&&1<this.vertices.length?(w.stopPropagation(),this._snappingTask=d.abortMaybe(this._snappingTask),this._vertexAddHandler(w),this._drawCompleteHandler(w)):F!==n.KEYS.undoKey||this.interactiveUndoDisabled||E?F!==n.KEYS.redoKey||this.interactiveUndoDisabled||E?F!==n.KEYS.panKey||E||(w.stopPropagation(),this._panEnabled=!0):(w.stopPropagation(),this.redo()):(w.stopPropagation(),this.undo())},
m.ViewEventPriorities.TOOL),this.view.on("key-up",w=>{w.key===n.KEYS.panKey&&(w.stopPropagation(),this._panEnabled=!1)},m.ViewEventPriorities.TOOL)])};z._addUndoRedoHandles=function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",w=>{this.notifyChange("vertices");if("undo"===w.operation){const F=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(F);const E=[...this._committedVertices];d.isSome(this._stagedVertex)&&E.push(this._coordinateHelper.pointToArray(this._stagedVertex));
this.emit("undo",new k.VertexRemoveEvent(this.view,F,w.vertices[0].index,E))}}),this._editGeometry.on("vertex-add",w=>{this.notifyChange("vertices");if("apply"===w.operation)w=new k.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",w),w.defaultPrevented&&(this._popVertexOnPointerMove=!0);else if("redo"===w.operation){const F=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(F);
const E=[...this._committedVertices];d.isSome(this._stagedVertex)&&E.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("redo",new k.VertexAddEvent(this.view,F,w.vertices[0].index,E))}})])};z._removeViewHandles=function(){this._viewHandles.removeAll()};z._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};z._addDrawTool=function(w){this._drawTool=new C.DrawTool({view:w,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);
this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",F=>{1===F.vertices.length&&this.emit("vertex-add",new k.VertexAddEvent(this.view,null,F.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",F=>{1===F.vertices.length&&this.emit("cursor-update",new k.CursorUpdateEvent(this.view,null,F.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",F=>{this.emit("draw-complete",new k.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));
this._removeDrawTool()})};z._removeDrawTool=function(){d.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool=d.destroyMaybe(this._drawTool))};z._addVertex=function(w,F){w=this._coordinateHelper.fromArray(w);this._isDuplicateOfLastVertex(w)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(w),F=F||new Event("placeholder"),this._nativeEventHistory.undoStack.push(F))};z._updateCursor=function(w,F=!1){this._popCursorVertex();
if(this._cursorScreenPoint){var E=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(d.isSome(E)&&!F){this._pushCursorVertex(E.vertex);const N=()=>new k.CursorUpdateEvent(this.view,w,this._activeComponent.vertices.length,this.vertices,d.isSome(this._stagedVertex)?new y(this._stagedVertex):null);this.emit("cursor-update",N());d.isSome(this._snappingTask)&&this._snappingTask.promise.then(U=>{U.valid&&this.emit("cursor-update",N())},()=>{})}}};z._completeDrawing=function(w){this._activePointerId=
null;this._popCursorVertex();this._snappingTask=d.abortMaybe(this._snappingTask);d.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();2>this.vertices.length||(w=new k.DrawCompleteEvent(w,this.vertices),this.emit("draw-complete",w),w.defaultPrevented||this._removeViewHandles())};z._shouldHandlePointerEvent=function(w){return("mouse"!==w.pointerType||0===w.button)&&(d.isNone(this._activePointerId)||this._activePointerId===w.pointerId)};z._vertexAddHandler=function(w){const F=d.isSome(this._stagedVertex)?
this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);d.isSome(F)&&this._addVertex(F,w.native)};z._drawCompleteHandler=function(w){this._completeDrawing(w.native)};e._createClass(A,[{key:"_clickEnabled",get:function(){return"click"===this.mode||"hybrid"===this.mode}},{key:"_dragEnabled",get:function(){return"freehand"===this.mode||"hybrid"===this.mode}}]);return A}(g);l.__decorate([b.property()],a.PolylineDrawAction.prototype,"_clickEnabled",
null);l.__decorate([b.property()],a.PolylineDrawAction.prototype,"_dragEnabled",null);l.__decorate([b.property({type:G.drawingModes})],a.PolylineDrawAction.prototype,"mode",void 0);a.PolylineDrawAction=l.__decorate([q.subclass("esri.views.draw.PolylineDrawAction")],a.PolylineDrawAction);Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/SegmentDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../geometry ../../core/Handles ../input/InputManager ../support/screenUtils ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryHelper ./DrawAction ./input/DrawEvents ./input/Keys ../3d/interactive/editingTools/draw/DrawTool ./support/surfaceCoordinateSystems".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A){a.SegmentDrawAction=function(z){function w(E){E=z.call(this,E)||this;E._isDragging=!1;E._panEnabled=!1;E._cursorScreenPoint=null;E._viewHandles=new c;E._activePointerId=null;E._addVertexOnPointerUp=!1;E.viewAlignedCoordinateSystem=null;E.mode="freehand";return E}e._inheritsLoose(w,z);var F=w.prototype;F.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};F.destroy=function(){"2d"===this.view.type?
(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};F.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};F.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};F._addViewHandles=function(){this._removeViewHandles();"click"===this.mode?this._viewHandles.add(this._getClickModeViewHandles()):this._viewHandles.add(this._getDragModeViewHandles())};
F._getDragModeViewHandles=function(){return[this.view.on("immediate-click",E=>{E.stopPropagation();if(E.mapPoint&&!this._panEnabled){const N=this.getCoordsFromScreenPoint(h.createScreenPointFromEvent(E));d.isSome(N)&&(this._vertexAddHandler(E),this._drawCompleteHandler(E))}},m.ViewEventPriorities.TOOL),this.view.on("pointer-down",E=>{this._shouldHandlePointerEvent(E)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._panEnabled||(this._resetGeometry(),this._addVertexOnPointerUp=!0,this._cursorScreenPoint=
h.createScreenPointFromEvent(E),this._activePointerId=E.pointerId,this._vertexAddHandler(E),this._isDragging=!1,"touch"===E.pointerType&&this._updateCursor(E.native)))},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",E=>{this._snappingTask=d.abortMaybe(this._snappingTask);d.isNone(this._activePointerId)&&"touch"!==E.pointerType&&(this._cursorScreenPoint=h.createScreenPointFromEvent(E),this._updateCursor(E.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-drag",E=>{this._shouldHandlePointerEvent(E)&&
(this._snappingTask=d.abortMaybe(this._snappingTask),this._isDragging=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(E),this._updateCursor(E.native))},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",E=>{this._shouldHandlePointerEvent(E)&&this._addVertexOnPointerUp&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=null,this._isDragging&&this._vertexAddHandler(E),2===this._committedVertices.length&&this._drawCompleteHandler(E),this._isDragging=!1)},m.ViewEventPriorities.TOOL),
this.view.on("key-down",E=>{E.key===C.KEYS.drawCompleteKey&&this._cursorScreenPoint?(this._snappingTask=d.abortMaybe(this._snappingTask),this._drawCompleteHandler(E)):E.key===C.KEYS.panKey&&(this._panEnabled=!0)},m.ViewEventPriorities.TOOL),this.view.on("key-up",E=>{E.key===C.KEYS.panKey&&(this._panEnabled=!1)},m.ViewEventPriorities.TOOL),this.view.on("drag",E=>{d.isSome(this._activePointerId)&&E.stopPropagation()},m.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],E=>{E.stopPropagation()},
m.ViewEventPriorities.TOOL)]};F._getClickModeViewHandles=function(){return[this.view.on("pointer-down",E=>{this._snappingTask=d.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(E);this._activePointerId=E.pointerId;this._isDragging=!1;"touch"===E.pointerType&&this._updateCursor(E.native)},m.ViewEventPriorities.TOOL),this.view.on("pointer-move",E=>{this._snappingTask=d.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(E);d.isNone(this._activePointerId)&&
"touch"!==E.pointerType&&this._updateCursor(E.native)},m.ViewEventPriorities.TOOL),this.view.on("pointer-drag",E=>{this._shouldHandlePointerEvent(E)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._isDragging=!0)},m.ViewEventPriorities.TOOL),this.view.on("pointer-up",E=>{this._shouldHandlePointerEvent(E)&&(this._snappingTask=d.abortMaybe(this._snappingTask),this._activePointerId=null,E.stopPropagation(),this._isDragging||this._vertexAddHandler(E),2!==this.vertices.length||this._isDragging||
this._drawCompleteHandler(E),this._isDragging=!1)},m.ViewEventPriorities.TOOL),this.view.on("key-down",E=>{E.key===C.KEYS.vertexAddKey&&this._cursorScreenPoint&&(this._vertexAddHandler(E),2===this.vertices.length&&this._drawCompleteHandler(E));E.key===C.KEYS.drawCompleteKey&&this._cursorScreenPoint&&2===this.vertices.length&&this._drawCompleteHandler(E)},m.ViewEventPriorities.TOOL)]};F._removeViewHandles=function(){this._viewHandles.removeAll()};F._addDrawTool=function(E){this._drawTool=new t.DrawTool({view:E,
elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",N=>{1===N.vertices.length&&this.emit("vertex-add",new G.VertexAddEvent(this.view,null,N.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",N=>{1===N.vertices.length&&this.emit("cursor-update",new G.CursorUpdateEvent(this.view,null,N.vertices[0].vertexIndex,
this._drawTool.getVertexCoords()))});this._drawTool.on("complete",N=>{this.emit("draw-complete",new G.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));this._removeDrawTool()})};F._removeDrawTool=function(){d.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};F._addVertex=function(E,N){E=this._coordinateHelper.fromArray(E);this._isDuplicateOfLastVertex(E)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),
this._editGeometry.appendVertex(E),1===this._committedVertices.length&&(this.viewAlignedCoordinateSystem=A.createViewAlignedCoordinateSystem(this.view,this._committedVertices[0])),N=new G.VertexAddEvent(this.view,N,this._committedVertices.length-1,this.vertices),this.emit("vertex-add",N))};F._updateCursor=function(E){this._popCursorVertex();if(this._cursorScreenPoint){var N=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(d.isSome(N)){this._pushCursorVertex(N.vertex);const U=()=>
new G.CursorUpdateEvent(this.view,E,this._activeComponent.vertices.length,this.vertices,d.isSome(this._stagedVertex)?new y(this._stagedVertex):null);this.emit("cursor-update",U());d.isSome(this._snappingTask)&&this._snappingTask.promise.then(S=>{S.valid&&this.emit("cursor-update",U())},()=>{})}}};F._completeDrawing=function(E){this._activePointerId=null;this._popCursorVertex();this._cursorScreenPoint=null;this._isDragging=!1;this._snappingTask=d.abortMaybe(this._snappingTask);d.isSome(this._snappingManager)&&
this._snappingManager.doneSnapping();1>this.vertices.length||(E=new G.DrawCompleteEvent(E,this.vertices),this.emit("draw-complete",E),E.defaultPrevented||this._removeViewHandles())};F._resetGeometry=function(){this._editGeometry.destroy();this._editGeometry=new k.EditGeometryHelper(new g.EditGeometry(this._coordinateHelper),"polygon");this._activeComponent=new g.Component(this._editGeometry.editGeometry);this._editGeometry.editGeometry.components.push(this._activeComponent)};F._shouldHandlePointerEvent=
function(E){return("mouse"!==E.pointerType||0===E.button)&&(d.isNone(this._activePointerId)||this._activePointerId===E.pointerId)};F._vertexAddHandler=function(E){const N=d.isSome(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);d.isSome(N)&&this._addVertex(N,E.native)};F._drawCompleteHandler=function(E){this._completeDrawing(E.native)};return w}(n);l.__decorate([b.property({type:["freehand","click"]})],a.SegmentDrawAction.prototype,
"mode",void 0);a.SegmentDrawAction=l.__decorate([q.subclass("esri/views/2d/engine/markup/SegmentDrawAction")],a.SegmentDrawAction);Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/Point ../../../geometry ../../../chunks/vec3f64 ../../../chunks/vec3 ../../../chunks/quatf64 ../../../chunks/quat ../../../chunks/mat2d ../../../chunks/mat2df64".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r){function v(c,m,h=null){return l.isSome(h)?[c,m,h]:[c,m]}function D(c,m,h=null){return l.isSome(h)?{x:c,y:m,z:h}:{x:c,y:m}}d=function(){function c(m){this.spatialReference=m}c.prototype.mapToLocalMultiple=function(m){return l.filterNones(m.map(h=>this.mapToLocal(h)))};e._createClass(c,[{key:"doUnnormalization",get:function(){return!1}}]);return c}();let y=function(c){function m(g,k,n=null){k=c.call(this,k)||this;k.defaultZ=n;k.transform=r.create();k.transformInv=r.create();
k.transform=r.clone(g);q.invert(k.transformInv,k.transform);return k}e._inheritsLoose(m,c);var h=m.prototype;h.makeMapPoint=function(g,k){return v(g,k,this.defaultZ)};h.mapToLocal=function(g){return D(this.transform[0]*g[0]+this.transform[2]*g[1]+this.transform[4],this.transform[1]*g[0]+this.transform[3]*g[1]+this.transform[5])};h.localToMap=function(g){return v(this.transformInv[0]*g.x+this.transformInv[2]*g.y+this.transformInv[4],this.transformInv[1]*g.x+this.transformInv[3]*g.y+this.transformInv[5],
this.defaultZ)};return m}(d),x=function(c){function m(g,k){var n=c.call(this,g.spatialReference)||this;n.view=g;n.defaultZ=null;n.pWS=f.create();n.tangentFrameUpWS=f.create();n.tangentFrameRightWS=f.create();n.tangentFrameForwardWS=f.create();n.localFrameRightWS=f.create();n.localFrameUpWS=f.create();n.worldToLocalTransform=b.create();n.localToWorldTransform=b.create();n.scale=1;n.scale=g.resolution;n.referenceMapPoint=k;n.defaultZ=k.hasZ?k.z:null;g=g.state.camera.viewRight;n.view.renderCoordsHelper.toRenderCoords(n.referenceMapPoint,
n.pWS);n.view.renderCoordsHelper.worldBasisAtPosition(n.pWS,0,n.tangentFrameRightWS);n.view.renderCoordsHelper.worldBasisAtPosition(n.pWS,1,n.tangentFrameUpWS);n.view.renderCoordsHelper.worldBasisAtPosition(n.pWS,2,n.tangentFrameForwardWS);k=f.create();u.scale(k,n.tangentFrameForwardWS,u.dot(g,n.tangentFrameForwardWS));u.subtract(n.localFrameRightWS,g,k);u.normalize(n.localFrameRightWS,n.localFrameRightWS);u.cross(n.localFrameUpWS,n.tangentFrameForwardWS,n.localFrameRightWS);p.rotationTo(n.worldToLocalTransform,
n.localFrameRightWS,n.tangentFrameRightWS);p.invert(n.localToWorldTransform,n.worldToLocalTransform);return n}e._inheritsLoose(m,c);var h=m.prototype;h.makeMapPoint=function(g,k){return v(g,k,this.defaultZ)};h.mapToLocal=function(g){const k=f.create();this.view.renderCoordsHelper.toRenderCoords(new B({x:g[0],y:g[1],spatialReference:this.spatialReference}),k);u.transformQuat(k,k,this.worldToLocalTransform);g=this.view.renderCoordsHelper.fromRenderCoords(k,this.view.spatialReference);return l.isSome(g)?
D(g.x/this.scale,g.y/this.scale):null};h.localToMap=function(g){const k=f.create();this.view.renderCoordsHelper.toRenderCoords(new B({x:g.x*this.scale,y:g.y*this.scale,spatialReference:this.spatialReference}),k);u.transformQuat(k,k,this.localToWorldTransform);g=this.view.renderCoordsHelper.fromRenderCoords(k,this.view.spatialReference);return l.isSome(g)?v(g.x,g.y,this.defaultZ):null};e._createClass(m,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}}]);return m}(d);
a.AffineCoordinateSystem=y;a.SceneViewCoordinateSystem=x;a.SurfaceCoordinateSystem=d;a.createViewAlignedCoordinateSystem=function(c,m){return"2d"===c.type?new y(c.state.transform,c.spatialReference,2<m.length?m[2]:null):"3d"===c.type?(m=2<m.length?new B({x:m[0],y:m[1],z:m[2],spatialReference:c.spatialReference}):new B({x:m[0],y:m[1],spatialReference:c.spatialReference}),new x(c,m)):null};a.makeMapPoint=v;a.makeSurfacePoint=D;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/chunks/quat":function(){define("exports ./vec3f64 ./common ./vec3 ./mat3f64 ./quatf64 ./vec4".split(" "),
function(a,e,l,B,d,f,u){function b(V){V[0]=0;V[1]=0;V[2]=0;V[3]=1;return V}function p(V,W,X){X*=.5;const oa=Math.sin(X);V[0]=oa*W[0];V[1]=oa*W[1];V[2]=oa*W[2];V[3]=Math.cos(X);return V}function q(V,W){const X=2*Math.acos(W[3]),oa=Math.sin(X/2);oa>l.EPSILON?(V[0]=W[0]/oa,V[1]=W[1]/oa,V[2]=W[2]/oa):(V[0]=1,V[1]=0,V[2]=0);return X}function r(V,W,X){const oa=W[0],ua=W[1],H=W[2];W=W[3];const J=X[0],aa=X[1],fa=X[2];X=X[3];V[0]=oa*X+W*J+ua*fa-H*aa;V[1]=ua*X+W*aa+H*J-oa*fa;V[2]=H*X+W*fa+oa*aa-ua*J;V[3]=W*
X-oa*J-ua*aa-H*fa;return V}function v(V,W,X){X*=.5;const oa=W[0],ua=W[1],H=W[2];W=W[3];const J=Math.sin(X);X=Math.cos(X);V[0]=oa*X+W*J;V[1]=ua*X+H*J;V[2]=H*X-ua*J;V[3]=W*X-oa*J;return V}function D(V,W,X){X*=.5;const oa=W[0],ua=W[1],H=W[2];W=W[3];const J=Math.sin(X);X=Math.cos(X);V[0]=oa*X-H*J;V[1]=ua*X+W*J;V[2]=H*X+oa*J;V[3]=W*X-ua*J;return V}function y(V,W,X){X*=.5;const oa=W[0],ua=W[1],H=W[2];W=W[3];const J=Math.sin(X);X=Math.cos(X);V[0]=oa*X+ua*J;V[1]=ua*X-oa*J;V[2]=H*X+W*J;V[3]=W*X-H*J;return V}
function x(V,W){const X=W[0],oa=W[1];W=W[2];V[0]=X;V[1]=oa;V[2]=W;V[3]=Math.sqrt(Math.abs(1-X*X-oa*oa-W*W));return V}function c(V,W,X,oa){const ua=W[0],H=W[1],J=W[2];W=W[3];let aa=X[0],fa=X[1],ja=X[2];X=X[3];let la;let da;var ka=ua*aa+H*fa+J*ja+W*X;0>ka&&(ka=-ka,aa=-aa,fa=-fa,ja=-ja,X=-X);1-ka>l.EPSILON?(la=Math.acos(ka),da=Math.sin(la),ka=Math.sin((1-oa)*la)/da,oa=Math.sin(oa*la)/da):ka=1-oa;V[0]=ka*ua+oa*aa;V[1]=ka*H+oa*fa;V[2]=ka*J+oa*ja;V[3]=ka*W+oa*X;return V}function m(V){var W=l.RANDOM();const X=
l.RANDOM(),oa=l.RANDOM(),ua=Math.sqrt(1-W);W=Math.sqrt(W);V[0]=ua*Math.sin(2*Math.PI*X);V[1]=ua*Math.cos(2*Math.PI*X);V[2]=W*Math.sin(2*Math.PI*oa);V[3]=W*Math.cos(2*Math.PI*oa);return V}function h(V,W){const X=W[0],oa=W[1],ua=W[2];W=W[3];var H=X*X+oa*oa+ua*ua+W*W;H=H?1/H:0;V[0]=-X*H;V[1]=-oa*H;V[2]=-ua*H;V[3]=W*H;return V}function g(V,W){V[0]=-W[0];V[1]=-W[1];V[2]=-W[2];V[3]=W[3];return V}function k(V,W){var X=W[0]+W[4]+W[8];if(0<X)X=Math.sqrt(X+1),V[3]=.5*X,X=.5/X,V[0]=(W[5]-W[7])*X,V[1]=(W[6]-
W[2])*X,V[2]=(W[1]-W[3])*X;else{let oa=0;W[4]>W[0]&&(oa=1);W[8]>W[3*oa+oa]&&(oa=2);const ua=(oa+1)%3,H=(oa+2)%3;X=Math.sqrt(W[3*oa+oa]-W[3*ua+ua]-W[3*H+H]+1);V[oa]=.5*X;X=.5/X;V[3]=(W[3*ua+H]-W[3*H+ua])*X;V[ua]=(W[3*ua+oa]+W[3*oa+ua])*X;V[H]=(W[3*H+oa]+W[3*oa+H])*X}return V}function n(V,W,X,oa){var ua=.5*Math.PI/180;W*=ua;X*=ua;oa*=ua;ua=Math.sin(W);W=Math.cos(W);const H=Math.sin(X);X=Math.cos(X);const J=Math.sin(oa);oa=Math.cos(oa);V[0]=ua*X*oa-W*H*J;V[1]=W*H*oa+ua*X*J;V[2]=W*X*J-ua*H*oa;V[3]=W*
X*oa+ua*H*J;return V}function G(V){return"quat("+V[0]+", "+V[1]+", "+V[2]+", "+V[3]+")"}function C(V,W,X){const oa=B.dot(W,X);if(-.999999>oa)return B.cross(K,P,W),1E-6>B.len(K)&&B.cross(K,Q,W),B.normalize(K,K),p(V,K,Math.PI),V;if(.999999<oa)return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V;B.cross(K,W,X);V[0]=K[0];V[1]=K[1];V[2]=K[2];V[3]=1+oa;return L(V,V)}function t(V,W,X,oa,ua,H){c(R,W,ua,H);c(Y,X,oa,H);c(V,R,Y,2*H*(1-H));return V}function A(V,W,X,oa){const ua=T;ua[0]=X[0];ua[3]=X[1];ua[6]=X[2];ua[1]=oa[0];
ua[4]=oa[1];ua[7]=oa[2];ua[2]=-W[0];ua[5]=-W[1];ua[8]=-W[2];return L(V,k(V,ua))}const z=u.copy,w=u.set,F=u.add,E=u.scale,N=u.dot,U=u.lerp,S=u.length,I=u.squaredLength,L=u.normalize,M=u.exactEquals;u=u.equals;const K=e.create(),P=e.fromValues(1,0,0),Q=e.fromValues(0,1,0),R=f.create(),Y=f.create(),T=d.create();e=Object.freeze({__proto__:null,identity:b,setAxisAngle:p,getAxisAngle:q,multiply:r,rotateX:v,rotateY:D,rotateZ:y,calculateW:x,slerp:c,random:m,invert:h,conjugate:g,fromMat3:k,fromEuler:n,str:G,
copy:z,set:w,add:F,mul:r,scale:E,dot:N,lerp:U,length:S,len:S,squaredLength:I,sqrLen:I,normalize:L,exactEquals:M,equals:u,rotationTo:C,sqlerp:t,setAxes:A});a.add=F;a.calculateW=x;a.conjugate=g;a.copy=z;a.dot=N;a.equals=u;a.exactEquals=M;a.fromEuler=n;a.fromMat3=k;a.getAxisAngle=q;a.identity=b;a.invert=h;a.len=S;a.length=S;a.lerp=U;a.mul=r;a.multiply=r;a.normalize=L;a.quat=e;a.random=m;a.rotateX=v;a.rotateY=D;a.rotateZ=y;a.rotationTo=C;a.scale=E;a.set=w;a.setAxes=A;a.setAxisAngle=p;a.slerp=c;a.sqlerp=
t;a.sqrLen=I;a.squaredLength=I;a.str=G})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(a,e){function l(t,A){t[0]=A[0];t[1]=A[1];t[2]=A[2];t[3]=A[3];t[4]=A[4];t[5]=A[5];return t}function B(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t}function d(t,A,z,w,F,E,N){t[0]=A;t[1]=z;t[2]=w;t[3]=F;t[4]=E;t[5]=N;return t}function f(t,A){const z=A[0],w=A[1],F=A[2],E=A[3],N=A[4];A=A[5];let U=z*E-w*F;if(!U)return null;U=1/U;t[0]=E*U;t[1]=-w*U;t[2]=-F*U;t[3]=z*U;t[4]=(F*A-E*N)*U;
t[5]=(w*N-z*A)*U;return t}function u(t){return t[0]*t[3]-t[1]*t[2]}function b(t,A,z){const w=A[0],F=A[1],E=A[2],N=A[3],U=A[4];A=A[5];const S=z[0],I=z[1],L=z[2],M=z[3],K=z[4];z=z[5];t[0]=w*S+E*I;t[1]=F*S+N*I;t[2]=w*L+E*M;t[3]=F*L+N*M;t[4]=w*K+E*z+U;t[5]=F*K+N*z+A;return t}function p(t,A,z){const w=A[0],F=A[1],E=A[2],N=A[3],U=A[4];A=A[5];const S=Math.sin(z);z=Math.cos(z);t[0]=w*z+E*S;t[1]=F*z+N*S;t[2]=w*-S+E*z;t[3]=F*-S+N*z;t[4]=U;t[5]=A;return t}function q(t,A,z){const w=A[1],F=A[2],E=A[3],N=A[4],
U=A[5],S=z[0];z=z[1];t[0]=A[0]*S;t[1]=w*S;t[2]=F*z;t[3]=E*z;t[4]=N;t[5]=U;return t}function r(t,A,z){const w=A[0],F=A[1],E=A[2],N=A[3],U=A[4];A=A[5];const S=z[0];z=z[1];t[0]=w;t[1]=F;t[2]=E;t[3]=N;t[4]=w*S+E*z+U;t[5]=F*S+N*z+A;return t}function v(t,A){const z=Math.sin(A);A=Math.cos(A);t[0]=A;t[1]=z;t[2]=-z;t[3]=A;t[4]=0;t[5]=0;return t}function D(t,A){t[0]=A[0];t[1]=0;t[2]=0;t[3]=A[1];t[4]=0;t[5]=0;return t}function y(t,A){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=A[0];t[5]=A[1];return t}function x(t){return"mat2d("+
t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function c(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function m(t,A,z){t[0]=A[0]+z[0];t[1]=A[1]+z[1];t[2]=A[2]+z[2];t[3]=A[3]+z[3];t[4]=A[4]+z[4];t[5]=A[5]+z[5];return t}function h(t,A,z){t[0]=A[0]-z[0];t[1]=A[1]-z[1];t[2]=A[2]-z[2];t[3]=A[3]-z[3];t[4]=A[4]-z[4];t[5]=A[5]-z[5];return t}function g(t,A,z){t[0]=A[0]*z;t[1]=A[1]*z;t[2]=A[2]*z;t[3]=A[3]*z;t[4]=A[4]*z;t[5]=A[5]*z;return t}function k(t,A,z,w){t[0]=A[0]+
z[0]*w;t[1]=A[1]+z[1]*w;t[2]=A[2]+z[2]*w;t[3]=A[3]+z[3]*w;t[4]=A[4]+z[4]*w;t[5]=A[5]+z[5]*w;return t}function n(t,A){return t[0]===A[0]&&t[1]===A[1]&&t[2]===A[2]&&t[3]===A[3]&&t[4]===A[4]&&t[5]===A[5]}function G(t,A){const z=t[0],w=t[1],F=t[2],E=t[3],N=t[4];t=t[5];const U=A[0],S=A[1],I=A[2],L=A[3],M=A[4];A=A[5];return Math.abs(z-U)<=e.EPSILON*Math.max(1,Math.abs(z),Math.abs(U))&&Math.abs(w-S)<=e.EPSILON*Math.max(1,Math.abs(w),Math.abs(S))&&Math.abs(F-I)<=e.EPSILON*Math.max(1,Math.abs(F),Math.abs(I))&&
Math.abs(E-L)<=e.EPSILON*Math.max(1,Math.abs(E),Math.abs(L))&&Math.abs(N-M)<=e.EPSILON*Math.max(1,Math.abs(N),Math.abs(M))&&Math.abs(t-A)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(A))}var C=Object.freeze({__proto__:null,copy:l,identity:B,set:d,invert:f,determinant:u,multiply:b,rotate:p,scale:q,translate:r,fromRotation:v,fromScaling:D,fromTranslation:y,str:x,frob:c,add:m,subtract:h,multiplyScalar:g,multiplyScalarAndAdd:k,exactEquals:n,equals:G,mul:b,sub:h});a.add=m;a.copy=l;a.determinant=u;a.equals=
G;a.exactEquals=n;a.frob=c;a.fromRotation=v;a.fromScaling=D;a.fromTranslation=y;a.identity=B;a.invert=f;a.mat2d=C;a.mul=b;a.multiply=b;a.multiplyScalar=g;a.multiplyScalarAndAdd=k;a.rotate=p;a.scale=q;a.set=d;a.str=x;a.sub=h;a.subtract=h;a.translate=r})},"esri/chunks/mat2df64":function(){define(["exports"],function(a){function e(){return[1,0,0,1,0,0]}function l(u){return[u[0],u[1],u[2],u[3],u[4],u[5]]}function B(u,b,p,q,r,v){return[u,b,p,q,r,v]}function d(u,b){return new Float64Array(u,b,6)}var f=
Object.freeze({__proto__:null,create:e,clone:l,fromValues:B,createView:d});a.clone=l;a.create=e;a.createView=d;a.fromValues=B;a.mat2df64=f})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(a,e){a.isSupportedGraphicResultMessage=function(l){switch(l){case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the elevation mode is not supported";
case 5:return"the symbol type is not supported"}return""};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(a,e,l,B){a.isSupportedGraphic=function(d){var f;if("graphics"!==(null==(f=d.layer)?void 0:f.type))return 1;if(l.isNone(d.geometry))return 2;switch(d.geometry.type){case "polygon":case "point":case "polyline":break;
case "multipoint":case "extent":case "mesh":return 3;default:return 3}return"on-the-ground"!==B.getGraphicEffectiveElevationMode(d)&&B.hasGraphicFeatureExpressionInfo(d)?4:0};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils"],function(a,e,l,B,d){a.isSupportedGraphic=
function(f){var u;if("graphics"!==(null==(u=f.layer)?void 0:u.type))return 1;u=f.geometry;if(l.isNone(u))return 2;switch(u.type){case "polygon":if(u instanceof B)return 3;break;case "polyline":break;case "point":case "multipoint":case "extent":case "mesh":return 3;default:return 3}return"on-the-ground"!==d.getGraphicEffectiveElevationMode(f)&&d.hasGraphicFeatureExpressionInfo(f)?4:0};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ./support/WKIDUnitConversion ./support/webMercatorUtils ./Point ./Polygon ./projectionEllipsoid ../core/unitUtils ./support/geodesicUtils".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h){var g;l=g=function(k){function n(...C){C=k.call(this,...C)||this;C.center=null;C.geodesic=!1;C.numberOfPoints=60;C.radius=1E3;C.radiusUnit="meters";return C}a._inheritsLoose(n,k);var G=n.prototype;G.normalizeCtorArgs=function(C,t){if(!C||!C.center){if(C&&C.rings)return k.prototype.normalizeCtorArgs.call(this,C,t);C={center:C}}return{...k.prototype.normalizeCtorArgs.call(this),...C,...t}};G.initialize=function(){var C=this.center;const t=this.numberOfPoints;
this.hasZ=C&&C.hasZ;if(0===this.rings.length&&C){var A=m.convertUnit(this.radius,this.radiusUnit,"meters"),z=C.spatialReference,w="geographic";if(z.isWebMercator)w="webMercator";else if(null!=v[z.wkid]||z.wkt&&0===z.wkt.indexOf("PROJCS"))w="projected";if(this.geodesic){let F;switch(w){case "webMercator":F=D.webMercatorToGeographic(C);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":F=
C}C=this._createGeodesicCircle(F,A,t);"webMercator"===w&&(C=D.geographicToWebMercator(C))}else{let F;"webMercator"===w||"projected"===w?F=A/this._convert2Meters(1,C.spatialReference):"geographic"===w&&(F=m.lengthToDegrees(A,"meters",c.getReferenceEllipsoid(C.spatialReference).radius));C=this._createPlanarCircle(C,F,t)}this.spatialReference=C.spatialReference;this.addRing(C.rings[0])}};G.clone=function(){const {center:C,numberOfPoints:t,radius:A,radiusUnit:z,geodesic:w}=this;return new g({center:C.clone(),
numberOfPoints:t,radius:A,radiusUnit:z,geodesic:w})};G._createGeodesicCircle=function(C,t,A){let z=0;const w=[];for(;360>z;){const F=[0,0];h.directGeodeticSolver(F,[C.x,C.y],z,t);this.hasZ&&F.push(C.z);w.push(F);z+=360/A}w.push(w[0]);return new x(w)};G._createPlanarCircle=function(C,t,A){let z=0;const w=[];for(;z<2*Math.PI;){const F=[C.x+Math.cos(-z)*t,C.y+Math.sin(-z)*t];this.hasZ&&F.push(C.z);w.push(F);z+=Math.PI/(A/2)}w.push(w[0]);return new x({spatialReference:C.spatialReference,rings:[w]})};
G._convert2Meters=function(C,t){if(null!=v[t.wkid])t=v.values[v[t.wkid]];else{t=t.wkt;const A=t.lastIndexOf(",")+1,z=t.lastIndexOf("]]");t=parseFloat(t.substring(A,z))}return C*t};return n}(x);e.__decorate([f.property({type:y})],l.prototype,"center",void 0);e.__decorate([f.property()],l.prototype,"geodesic",void 0);e.__decorate([f.property()],l.prototype,"numberOfPoints",void 0);e.__decorate([f.property()],l.prototype,"radius",void 0);e.__decorate([f.property()],l.prototype,"radiusUnit",void 0);return l=
g=e.__decorate([b.subclass("esri.geometry.Circle")],l)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../core/Error ../SpatialReference ../Point ../Polygon ../Polyline ../../geometry ../../core/unitUtils ./geodesicConstants".split(" "),function(a,e,l,B,d,f,u,b,p){function q(m){if(!m)return null;if(m.isGeographic&&m.wkid){var h=p.spheroids[m.wkid];if(h)return h}if(m.wkt){m=p.WKT_SPHEROID_REGEX.exec(m.wkt);if(!m||2!==m.length)return null;h=m[1].split(",");if(!h||3>h.length)return null;
m=parseFloat(h[1]);h=parseFloat(h[2]);return isNaN(m)||isNaN(h)?null:{a:m,f:0===h?0:1/h}}return null}function r(m){m=q(m||l.WGS84);if("b"in m&&"eSq"in m&&"radius"in m)return m;const h=m.a*(1-m.f);return Object.assign(m,{b:h,eSq:1-(h/m.a)**2,radius:(2*m.a+h)/3,densificationRatio:1E4/((2*m.a+h)/3)})}function v(m,h,g){const {a:k,eSq:n}=r(g);g=Math.sqrt(n);const G=Math.sin(h[1]*p.toRadians);h=k*h[0]*p.toRadians;g=0<n?k*(1-n)*(G/(1-n*G*G)-1/(2*g)*Math.log((1-g*G)/(1+g*G)))*.5:k*G;m[0]=h;m[1]=g;return m}
function D(m){return null!==q(m)}function y(m,h){if("polyline"!==m.type&&"polygon"!==m.type)throw new e("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:g}=m;if(!D(g))throw new e("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var k="polyline"===m.type?m.paths:m.rings;const n=[],G=[0,0],C={distance:null};for(const z of k){k=[];n.push(k);k.push([z[0][0],z[0][1]]);var t=z[0][0],A=z[0][1];
let w,F;for(let E=0;E<z.length-1;E++){w=z[E+1][0];F=z[E+1][1];if(t===w&&A===F)continue;const N=[t,A];c(C,[t,A],[w,F],g);const {azimuth:U,distance:S}=C;t=S/h;if(1<t){for(A=1;A<=t-1;A++)x(G,N,U,A*h,g),k.push(G.slice(0));x(G,N,U,(S+Math.floor(t-1)*h)/2,g);k.push(G.slice(0))}x(G,N,U,S,g);k.push(G.slice(0));t=G[0];A=G[1]}}return"polyline"===m.type?new f({paths:n,spatialReference:g}):new d({rings:n,spatialReference:g})}function x(m,h,g,k,n){const G=h[0]*p.toRadians;h=h[1]*p.toRadians;g*=p.toRadians;const {a:C,
b:t,f:A}=r(n);n=Math.sin(g);g=Math.cos(g);var z=(1-A)*Math.tan(h);h=1/Math.sqrt(1+z*z);const w=z*h,F=Math.atan2(z,g);z=h*n;const E=z*z;var N=1-E,U=N*(C*C-t*t)/(t*t);const S=1+U/16384*(4096+U*(-768+U*(320-175*U))),I=U/1024*(256+U*(-128+U*(74-47*U)));U=k/(t*S);let L=2*Math.PI,M,K,P,Q;for(;1E-12<Math.abs(U-L);)P=Math.cos(2*F+U),M=Math.sin(U),K=Math.cos(U),Q=I*M*(P+I/4*(K*(-1+2*P*P)-I/6*P*(-3+4*M*M)*(-3+4*P*P))),L=U,U=k/(t*S)+Q;k=w*M-h*K*g;N=A/16*N*(4+A*(4-3*N));k=Math.atan2(w*K+h*M*g,(1-A)*Math.sqrt(E+
k*k))/p.toRadians;m[0]=(G+(Math.atan2(M*n,h*K-w*M*g)-(1-N)*A*z*(U+N*M*(P+N*K*(-1+2*P*P)))))/p.toRadians;m[1]=k;return m}function c(m,h,g,k){var n=h[0]*p.toRadians;h=h[1]*p.toRadians;var G=g[0]*p.toRadians;g=g[1]*p.toRadians;const {a:C,b:t,f:A,radius:z}=r(k),w=G-n;var F=Math.atan((1-A)*Math.tan(h)),E=Math.atan((1-A)*Math.tan(g));k=Math.sin(F);F=Math.cos(F);const N=Math.sin(E);E=Math.cos(E);let U=1E3,S=w,I,L,M;let K,P,Q;do{var R=Math.sin(S);var Y=Math.cos(S);M=Math.sqrt(E*R*E*R+(F*N-k*E*Y)*(F*N-k*E*
Y));if(0===M)return m.distance=0,m.azimuth=void 0,m.reverseAzimuth=void 0,m;Y=k*N+F*E*Y;K=Math.atan2(M,Y);P=F*E*R/M;L=1-P*P;R=Y-2*k*N/L;isNaN(R)&&(R=0);Q=A/16*L*(4+A*(4-3*L));I=S;S=w+(1-Q)*A*P*(K+Q*M*(R+Q*Y*(-1+2*R*R)))}while(1E-12<Math.abs(S-I)&&0<--U);if(0===U)return k=Math.acos(Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos(G-n))*z,n=G-n,m.azimuth=Math.atan2(Math.sin(n)*Math.cos(g),Math.cos(h)*Math.sin(g)-Math.sin(h)*Math.cos(g)*Math.cos(n))/p.toRadians,m.distance=k,m.reverseAzimuth=
void 0,m;n=L*(C*C-t*t)/(t*t);h=n/1024*(256+n*(-128+n*(74-47*n)));G=Math.atan2(F*Math.sin(S),F*N*Math.cos(S)-k*E);m.azimuth=Math.atan2(E*Math.sin(S),F*N-k*E*Math.cos(S))/p.toRadians;m.distance=t*(1+n/16384*(4096+n*(-768+n*(320-175*n))))*(K-h*M*(R+h/4*(Y*(-1+2*R*R)-h/6*R*(-3+4*M*M)*(-3+4*R*R))));m.reverseAzimuth=G/p.toRadians;return m}a.directGeodeticSolver=x;a.geodesicAreas=function(m,h="square-meters"){if(m.some(G=>!D(G.spatialReference)))throw new e("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");
const g=[];for(var k=0;k<m.length;k++){var n=m[k];const {radius:G,densificationRatio:C}=r(n.spatialReference);g.push(y(n,G*C))}m=[];k=[0,0];n=[0,0];for(let G=0;G<g.length;G++){const {rings:C,spatialReference:t}=g[G];let A=0;for(let z=0;z<C.length;z++){const w=C[z];v(k,w[0],t);v(n,w[w.length-1],t);let F=n[0]*k[1]-k[0]*n[1];for(let E=0;E<w.length-1;E++)v(k,w[E+1],t),v(n,w[E],t),F+=n[0]*k[1]-k[0]*n[1];A+=F}A=b.convertUnit(A,"square-meters",h);m.push(A/-2)}return m};a.geodesicDensify=y;a.geodesicDistance=
function(m,h,g="meters"){if(!m||!h)throw new e("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!m.spatialReference||!h.spatialReference)throw new e("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!m.spatialReference.equals(h.spatialReference))throw new e("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:k}=m;if(!D(k))throw new e("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(m.equals(h))return{distance:0,azimuth:0,reverseAzimuth:0};const n={distance:null};c(n,[m.x,m.y],[h.x,h.y],k);n.distance=b.convertUnit(n.distance,"meters",g);return n};a.geodesicLengths=function(m,h="meters"){if(!m&&!m)throw new e("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(m.some(n=>!D(n.spatialReference)))throw new e("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const g=[];for(let n=0;n<m.length;n++){var k=m[n];const {spatialReference:G}=k;k="polyline"===k.type?k.paths:k.rings;let C=0;for(let t=0;t<k.length;t++){const A=k[t];let z=0;for(let w=1;w<A.length;w++){const F=A[w-1][0],E=A[w][0],N=A[w-1][1],U=A[w][1];if(N!==U||F!==E){const S={distance:null};c(S,[F,N],[E,U],G);z+=S.distance}}C+=z}C=b.convertUnit(C,"meters",h);g.push(C)}return g};a.inverseGeodeticSolver=c;a.isSupported=D;a.pointFromDistance=function(m,h,g){if(!m||null==h||null==g)throw new e("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>g||360<g)throw new e("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!m.spatialReference)throw new e("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:k}=m;if(!D(k))throw new e("geodesic-distance:not-supported","input geometry spatial reference is not supported");const n=[0,0];x(n,[m.x,m.y],
g,h,k);return new B({x:n[0],y:n[1],spatialReference:k})};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(a,e,l,B){a.isSupportedGraphic=function(d){var f;if("graphics"!==(null==(f=d.layer)?void 0:f.type))return 1;if(l.isNone(d.geometry))return 2;switch(d.geometry.type){case "point":break;
case "polygon":case "polyline":return 0;case "multipoint":case "extent":case "mesh":return 3;default:return 3}return(f=l.isSome(d.symbol)&&"point-3d"===d.symbol.type&&d.symbol.symbolLayers)&&0<f.length&&f.some(u=>"object"===u.type)?"on-the-ground"!==B.getGraphicEffectiveElevationMode(d)&&B.hasGraphicFeatureExpressionInfo(d)?4:0:5};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/draw/support/createUtilsAsync":function(){define(["require","exports"],function(a,e){let l=null;e.loadCreateUtils=
async function(){l||(l=await new Promise(function(B,d){a(["./createUtils"],B,d)}));return l};Object.defineProperty(e,"__esModule",{value:!0})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(e,l){l&&e&&e.map&&({map:e}=e,e.layers.find(B=>B===l)||e.add(l))};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/promiseUtils ../../../core/accessorSupport/trackingUtils ../../../geometry/SpatialReference ../../../geometry/Point ../../../core/Evented ../../../core/watchUtils ../../../core/HandleOwner ../../../chunks/vec2 ./snappingUtils ./SnappingOptions ./FeatureSnappingEngine ./SelfSnappingEngine ./candidates/IntersectionSnappingCandidate".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z){a.SnappingManager=function(w){function F(N){N=w.call(this,N)||this;N.options=new C;N.engines=[];N._currentMainCandidate=null;N._currentOtherActiveCandidates=[];N.options=new C;return N}e._inheritsLoose(F,w);var E=F.prototype;E.initialize=function(){this.handles.add([x.reaction(()=>{const {effectiveFeatureEnabled:N,effectiveSelfEnabled:U,touchSensitivityMultiplier:S,distance:I}=this.options;return{effectiveFeatureEnabled:N,effectiveSelfEnabled:U,
touchSensitivityMultiplier:S,distance:I}},()=>{this.doneSnapping();this.emit("changed")}),this.watch("options",N=>{for(const U of this.engines)U.options=N},!0),g.init(this.view,"ready",N=>this.onViewReady(N),!0)])};E.destroy=function(){this.destroyEngines()};E.onViewReady=function(N){this.destroyEngines();if(N){var U,S;this.engines=[new A.SelfSnappingEngine({view:this.view,options:this.options}),new t.FeatureSnappingEngine({view:this.view,spatialReference:null!=(U=null==(S=this.view)?void 0:S.spatialReference)?
U:c.WGS84,options:this.options})]}};E.destroyEngines=function(){for(const N of this.engines)N.destroy();this.engines.length=0};E.snap=async function(N,U,S){const I=U.coordinateHelper.fromPoint(N),L=await this.fetchCandidates(I,U,S);return{get valid(){return!y.isAborted(S)},apply:()=>{const {snappedPoint:M,hints:K}=this.processCandidates(I,L,U);this.removeVisualization();d.isSome(U.visualizer)&&this.handles.add(U.visualizer.draw(K,{coordinateHelper:U.coordinateHelper,elevationInfo:U.elevationInfo,
view:this.view}),"visualization-handle");return M}}};E.update=function(N,U){this.removeVisualization();let S=N;const I=[];if(d.isSome(this._currentMainCandidate)){const L=U.coordinateHelper;N=L.fromPoint(N);const M=this._currentMainCandidate.constraint.closestTo(N);if(G.squareDistance(G.anyMapPointToScreenPoint(N,L,U.elevationInfo,this.view),G.anyMapPointToScreenPoint(M,L,U.elevationInfo,this.view))<this.squaredPointProximityThreshold(U.pointer)){S=L.createDehydratedPoint(M);this._currentMainCandidate.targetPoint=
M;I.push(...this._currentMainCandidate.hints);for(const K of this._currentOtherActiveCandidates)K.targetPoint=M,I.push(...K.hints)}else this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}d.isSome(U.visualizer)&&this.handles.add(U.visualizer.draw(I,{coordinateHelper:U.coordinateHelper,elevationInfo:U.elevationInfo,view:this.view}),"visualization-handle");return S};E.doneSnapping=function(){this.removeVisualization();this._currentMainCandidate=null;this._currentOtherActiveCandidates=
[]};E.removeVisualization=function(){this.handles.remove("visualization-handle")};E.fetchCandidates=async function(N,U,S){return(await Promise.all(this.engines.map(I=>I.fetchCandidates(N,U,S)))).flat()};E.processCandidates=function(N,U,S){if(1>U.length)return this.doneSnapping(),{snappedPoint:S.coordinateHelper.toPoint(N,new m),hints:[]};G.sortCandidatesInPlace(N,U);const I=this._currentMainCandidate;if(d.isSome(I)){const L=this.findOldConstraintInNewCandidates(I,U);if(0<=L)if(U[L]instanceof z.IntersectionSnappingCandidate){if(n.squaredDistance(N,
I.targetPoint)<this.squaredPointProximityThreshold(S.pointer))return this.updateSnappingCandidate(I,U,S)}else return this.intersectWithOtherCandidates(L,U,N,S)}return this.intersectWithOtherCandidates(0,U,N,S)};E.findOldConstraintInNewCandidates=function(N,U){return N instanceof z.IntersectionSnappingCandidate?0<=this.findOldCandidateIndex(U,N.first)&&0<=this.findOldCandidateIndex(U,N.second)?0:-1:this.findOldCandidateIndex(U,N)};E.intersectWithOtherCandidates=function(N,U,S,I){const L=U[N],M=[],
K=I.coordinateHelper;for(let P=0;P<U.length;++P){if(P===N)continue;const Q=U[P];for(const R of L.constraint.intersect(Q.constraint)){const Y=K.fromXYZ(R.intersection,L.targetPoint[2]);M.push([new z.IntersectionSnappingCandidate(K,Y,L,Q),G.squareDistance(G.anyMapPointToScreenPoint(S,I.coordinateHelper,I.elevationInfo,this.view),G.anyMapPointToScreenPoint(Y,I.coordinateHelper,I.elevationInfo,this.view))])}}return 0<M.length&&(M.sort((P,Q)=>P[1]-Q[1]),M[0][1]<this.squaredPointProximityThreshold(I.pointer))?
this.updateSnappingCandidate(M[0][0],U,I):this.updateSnappingCandidate(L,U,I)};E.updateSnappingCandidate=function(N,U,S){this.doneSnapping();this._currentMainCandidate=N;const I=this._currentMainCandidate.targetPoint,L=[];L.push(...N.hints);for(const M of U){if(N instanceof z.IntersectionSnappingCandidate){if(M.constraint.objectEqual(N.first.constraint)||M.constraint.objectEqual(N.second.constraint))continue}else if(M.constraint.objectEqual(N.constraint))continue;M.constraint.check(I)&&(M.targetPoint=
I,this._currentOtherActiveCandidates.push(M),L.push(...M.hints))}return{snappedPoint:S.coordinateHelper.createDehydratedPoint(I),hints:L}};E.squaredPointProximityThreshold=function(N){return"touch"===N?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};E.findOldCandidateIndex=function(N,U){let S=-1;for(let I=0;I<N.length;++I)if(U.constraint.objectEqual(N[I].constraint)){S=I;break}return S};e._createClass(F,[{key:"updating",get:function(){return this.engines.some(N=>N.updating)}},
{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:N,touchSensitivityMultiplier:U}=this.options,S=N*U;return S*S}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle")}}}]);return F}(h.EventedMixin(k.HandleOwner));l.__decorate([b.property({constructOnly:!0})],a.SnappingManager.prototype,"view",void 0);l.__decorate([b.property()],a.SnappingManager.prototype,
"options",void 0);l.__decorate([b.property({readOnly:!0})],a.SnappingManager.prototype,"updating",null);l.__decorate([b.property()],a.SnappingManager.prototype,"engines",void 0);l.__decorate([b.property()],a.SnappingManager.prototype,"squaredMouseProximityTreshold",null);l.__decorate([b.property()],a.SnappingManager.prototype,"squaredTouchProximityThreshold",null);a.SnappingManager=l.__decorate([q.subclass("esri.views.interactive.snapping.SnappingManager")],a.SnappingManager);Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/promiseUtils ../../../chunks/vec3f64 ../../../core/Handles ../../../core/watchUtils ../../../core/HandleOwner ../../../core/MapUtils ./snappingUtils ./candidates/FeatureSnappingCandidate".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G){e.FeatureSnappingEngine=function(A){function z(F){F=A.call(this,F)||this;F.sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null}};return F}l._inheritsLoose(z,A);var w=z.prototype;w.initialize=function(){this.updatingHandles.add(this,"snappingSources",()=>{this.notifyChange("updating")},1);if(f.isSome(this.view)){var F;this.handles.add([null==(F=this.view.refreshManager)?
void 0:F.on("refresh",E=>{"interval"===E.trigger&&this.refreshSourceOfLayer(E.layerView.layer)}),this.view.on("layerview-create",E=>this.updateLayerView(E.layer,E.layerView)),this.view.on("layerview-destroy",E=>this.updateLayerView(E.layer,null))])}};w.refreshSourceOfLayer=function(F){for(const [,{snappingSource:E}]of this.snappingSources)E.layerSource.layer===F&&E.refresh()};w.updateLayerView=function(F,E){for(const [,N]of this.snappingSources)N.snappingSource.layerSource.layer===F&&(N.layerView=
E)};w.destroy=function(){this._set("options",null);for(const [,F]of this.snappingSources)F.destroy()};w.fetchCandidates=async function(F,E,N){if(!this.options.effectiveFeatureEnabled)return[];var U=[];const S={distance:this.computeScreeenSizeDistanceParameters(F,E),point:F,coordinateHelper:E.coordinateHelper,types:this.types,filter:null};for(const [,{snappingSource:I,layerView:L}]of this.snappingSources)!I.layerSource.enabled||f.isSome(L)&&L.suspended||U.push(I.fetchCandidates(S,N).then(({candidates:M})=>
M.filter(K=>!this.candidateIsExcluded(I,K,E.excludeFeature))));U=(await x.eachAlwaysValues(U)).flat();x.throwIfAborted(N);n.sortCandidatesInPlace(F,U);return U};w.computeScreeenSizeDistanceParameters=function(F,E){const N=this.options.distance*("touch"===E.pointer?this.options.touchSensitivityMultiplier:1);return f.isNone(this.view)?N:"2d"===this.view.type?N*this.view.resolution:this.computeScreeenSizeDistanceParameters3D(F,N,this.view,E)};w.computeScreeenSizeDistanceParameters3D=function(F,E,N,U){const {coordinateHelper:S,
elevationInfo:I}=U,L=N.state.camera.computeScreenPixelSizeAt(n.anyMapPointToRender(F,S,I,N,t))*N.renderCoordsHelper.unitInMeters/N.mapCoordsHelper.unitInMeters;E*=L;const M=this.computeScreenMagnitudeOfMapOffset(F,L,0,N,U);F=this.computeScreenMagnitudeOfMapOffset(F,0,L,N,U);return{x:E/M,y:E/F}};w.computeScreenMagnitudeOfMapOffset=function(F,E,N,U,{coordinateHelper:S,elevationInfo:I}){const L=S.clone(F);L[0]+=E;L[1]+=N;F=n.anyMapPointToScreenPoint(F,S,I,U);S=n.anyMapPointToScreenPoint(L,S,I,U);U=S.x-
F.x;S=S.y-F.y;return Math.sqrt(U*U+S*S)};w.candidateIsExcluded=function(F,E,N){if(f.isNone(N))return!1;E=this.getCandidateObjectId(E);if(f.isNone(E))return!1;F=F.layerSource.layer;return"graphics"===F.type?N.uid===E:N.sourceLayer===F&&N.attributes&&"objectIdField"in F?N.attributes[F.objectIdField]===E:!1};w.getCandidateObjectId=function(F){return F instanceof G.FeatureSnappingCandidate?F.objectId:null};w.createSourceInfo=function(F){const E=this.createFeatureSnappingSourceType(F);if(f.isNone(E))return null;
if("loading"in E)return this.updatingHandles.addPromise(E.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const N=f.isSome(this.view)?this.view.allLayerViews.find(U=>U.layer===F.layer):null;return new C(E.source,N)};w.createFeatureSnappingSourceType=function(F){switch(F.layer.type){case "feature":case "geojson":case "csv":return this.createFeatureSnappingSourceFeatureLayer(F);case "graphics":return this.createFeatureSnappingSourceGraphicsLayer(F)}return null};w.createFeatureSnappingSourceFeatureLayer=
function(F){switch(F.layer.source.type){case "feature-layer":var E=this.getSourceModule("featureService");return f.isSome(E.module)?{source:new E.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:F})}:{loading:E.loader};case "memory":case "csv":case "geojson":if("mesh"!==F.layer.geometryType)return E=this.getSourceModule("featureCollection"),f.isSome(E.module)?{source:new E.module.FeatureCollectionSnappingSource({layerSource:F})}:{loading:E.loader}}return null};
w.createFeatureSnappingSourceGraphicsLayer=function(F){const E=this.getSourceModule("graphics");return f.isSome(E.module)?{source:new E.module.GraphicsSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:F})}:{loading:E.loader}};w.getSourceModule=function(F){const E=this.sourceModules[F];return f.isNone(E.loader)?(F=this.loadSourceModule(F).then(N=>{E.module=N}),E.loader=F,{module:E.module,loader:F}):{module:E.module,loader:E.loader}};w.loadSourceModule=function(F){switch(F){case "featureService":return this.updatingHandles.addPromise(new Promise(function(E,
N){a(["./featureSources/FeatureServiceSnappingSource"],E,N)}));case "featureCollection":return this.updatingHandles.addPromise(new Promise(function(E,N){a(["./featureSources/FeatureCollectionSnappingSource"],E,N)}));case "graphics":return this.updatingHandles.addPromise(new Promise(function(E,N){a(["./featureSources/GraphicsSnappingSource"],E,N)}))}return null};l._createClass(z,[{key:"updating",get:function(){return k.someMap(this.snappingSources,({snappingSource:F})=>F.updating)||this.updatingHandles.updating}},
{key:"snappingSources",get:function(){var F;const E=this._get("snappingSources")||new Map,N=new Map;if(null!=(F=this.options)&&F.featureSources)for(const S of this.options.featureSources.items){F=S.layer.uid;var U=E.get(F);U?(E.delete(F),N.set(F,U)):S.layer.loaded?(U=this.createSourceInfo(S),f.isSome(U)&&N.set(F,U)):this.updatingHandles.addPromise(S.layer.load())}for(const [,S]of E)S.destroy();return N}},{key:"types",get:function(){return 3}}]);return z}(g.HandleOwner);B.__decorate([p.property({constructOnly:!0})],
e.FeatureSnappingEngine.prototype,"spatialReference",void 0);B.__decorate([p.property({constructOnly:!0})],e.FeatureSnappingEngine.prototype,"view",void 0);B.__decorate([p.property()],e.FeatureSnappingEngine.prototype,"options",void 0);B.__decorate([p.property({readOnly:!0})],e.FeatureSnappingEngine.prototype,"updating",null);B.__decorate([p.property({readOnly:!0})],e.FeatureSnappingEngine.prototype,"snappingSources",null);e.FeatureSnappingEngine=B.__decorate([r.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],
e.FeatureSnappingEngine);let C=function(){function A(z,w){this.snappingSource=z;this.layerView=w;this.handles=new m;w=this.snappingSource.layerSource.layer;"refresh"in w&&this.handles.add(w.on("refresh",()=>z.refresh()));this.handles.add([h.init(z,"updating",F=>z.layerSource.updating=F,!0),h.init(z,"availability",F=>z.layerSource.availability=F,!0)])}A.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return A}();const t=c.create();Object.defineProperty(e,"__esModule",
{value:!0})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./SnappingCandidate"],function(a,e,l){l=function(B){function d({coordinateHelper:f,targetPoint:u,objectId:b,constraint:p}){f=B.call(this,f,u,p)||this;f.objectId=b;return f}e._inheritsLoose(d,B);return d}(l.SnappingCandidate);a.FeatureSnappingCandidate=l;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],
function(a){a.SnappingCandidate=function(e,l,B){this.coordinateHelper=e;this.targetPoint=l;this.constraint=B};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../core/Collection ./snappingUtils ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g){a.SelfSnappingEngine=function(k){function n(C){C=k.call(this,C)||this;C.updating=!1;C._snappers=new y;return C}e._inheritsLoose(n,k);var G=n.prototype;G.initialize=function(){this._snappers.push(new m.ParallelLineSnapper(this.view,this.options),new c.LineSnapper(this.view,this.options),new h.RightAngleSnapper(this.view,this.options),new g.RightAngleTriangleSnapper(this.view,this.options))};G.fetchCandidates=async function(C,t){if(!this.options.effectiveSelfEnabled)return[];
const A=[];for(const z of this._snappers.items)A.push(...z.snap(C,t));x.sortCandidatesInPlace(C,A);return A};e._createClass(n,[{key:"options",set:function(C){this._set("options",C);for(const t of this._snappers)t.options=C}}]);return n}(D);l.__decorate([u.property({readOnly:!0})],a.SelfSnappingEngine.prototype,"updating",void 0);l.__decorate([u.property({constructOnly:!0})],a.SelfSnappingEngine.prototype,"view",void 0);l.__decorate([u.property()],a.SelfSnappingEngine.prototype,"options",null);a.SelfSnappingEngine=
l.__decorate([p.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],a.SelfSnappingEngine);Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2f64 ./snappingUtils ./SnappingAlgorithm ../../support/geometry2dUtils ./candidates/LineSnappingCandidate".split(" "),function(a,e,l,B,d,f,u,b){f=function(p){function q(){return p.apply(this,arguments)||
this}e._inheritsLoose(q,p);var r=q.prototype;r.snapNewVertex=function(v,D){var y=D.geometry.editGeometry.components[0],x=y.edges.length;const c=[];if(1>x)return c;const m=d.anyMapPointToScreenPoint(v,D.coordinateHelper,D.elevationInfo,this.view);x=y=y.edges[x-1];do this.edgeExceedsShortLineThreshold(x,D)&&this._processCandidateProposal(x.left.pos,x.right.pos,v,m,D,c),x=x.left.left;while(x&&x!==y);return c};r.snapExistingVertex=function(v,D){const y=[],x=l.unwrap(D.vertexHandle);var c=x.component;
if(2>c.edges.length)return y;const m=d.anyMapPointToScreenPoint(v,D.coordinateHelper,D.elevationInfo,this.view);var h=x.left;const g=x.right;h&&g&&this.edgeExceedsShortLineThreshold(h,D)&&this.edgeExceedsShortLineThreshold(g,D)&&this._processCandidateProposal(h.left.pos,g.right.pos,v,m,D,y);h=c=c.edges[0];do h!==x.left&&h!==x.right&&this.edgeExceedsShortLineThreshold(h,D)&&this._processCandidateProposal(h.left.pos,h.right.pos,v,m,D,y),h=h.right.right;while(h&&h!==c);return y};r._processCandidateProposal=
function(v,D,y,x,c,m){const h=u.projectPointToLine(B.create(),y,v,D),g=c.coordinateHelper;y=g.fromXYZ(h,g.getZ(y,0));d.squareDistance(x,d.anyMapPointToScreenPoint(y,g,c.elevationInfo,this.view))<this.squaredProximityTreshold(c.pointer)&&m.push(new b.LineSnappingCandidate({coordinateHelper:c.coordinateHelper,lineStart:v,lineEnd:D,targetPoint:y}))};return q}(f.SnappingAlgorithm);a.LineSnapper=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","./Settings","./snappingUtils"],function(a,e,l,B,d){let f=function(){function u(p,q){this.view=p;this.options=q;this.squaredShortLineThreshold=B.defaults.shortLineThreshold*B.defaults.shortLineThreshold}var b=u.prototype;b.snap=function(p,q){return l.isSome(q.vertexHandle)?"vertex"!==q.vertexHandle.type?[]:this.snapExistingVertex(p,q):this.snapNewVertex(p,q)};b.edgeExceedsShortLineThreshold=function(p,q){return this.exceedsShortLineThreshold(p.left.pos,
p.right.pos,q)};b.exceedsShortLineThreshold=function(p,q,{elevationInfo:r,geometry:v}){v=v.editGeometry.coordinateHelper;return 0===this.squaredShortLineThreshold||d.squareDistance(d.anyMapPointToScreenPoint(q,v,r,this.view),d.anyMapPointToScreenPoint(p,v,r,this.view))>this.squaredShortLineThreshold};b.squaredProximityTreshold=function(p){return"touch"===p?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};e._createClass(u,[{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*
this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:p,touchSensitivityMultiplier:q}=this.options,r=p*q;return r*r}}]);return u}();a.SnappingAlgorithm=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2f64","../../chunks/vec2"],function(a,e,l,B){function d(D,y){return D[0]*y[1]-D[1]*y[0]}function f(D,y,x){y=B.dot(x,y)/B.squaredLength(x);return B.scale(D,
x,y)}function u(D,y,x,c,m=x){B.subtract(p,c,x);B.subtract(r,y,m);f(v,r,p);return B.add(D,m,v)}function b(D,y,x,c){B.subtract(p,y,x);y=c/B.length(p);return B.scaleAndAdd(D,x,p,y)}const p=l.create(),q=l.create(),r=l.create(),v=l.create();a.cross=d;a.intersectCircleAndPoint=function(D,y,x){b(r,x,D,y);return e.floatEqualAbsolute(r[0],x[0])&&e.floatEqualAbsolute(r[1],x[1])?[l.clone(x)]:[]};a.intersectLineAndPoint=function(D,y){u(r,y,D.start,D.end);return e.floatEqualAbsolute(r[0],y[0])&&e.floatEqualAbsolute(r[1],
y[1])?[l.clone(y)]:[]};a.intersectLineAndRay=function(D,y){const x=D.start;var c=y.start,m=y.end;const h=B.subtract(p,D.end,x);var g=B.subtract(q,m,c);m=d(h,g);if(1E-6>=Math.abs(m))return[];c=B.subtract(r,x,c);g=d(g,c)/m;m=d(h,c)/m;if(0<=g){if(0<=m||1===y.type)return[B.scaleAndAdd(v,x,h,g)]}else if(1===D.type&&(0<=m||1===y.type))return[B.scaleAndAdd(v,x,h,g)];return[]};a.intersectLineLikeAndCircle=function(D,y,x){const c=[],m=B.subtract(p,D.end,D.start);var h=B.subtract(q,D.start,y);y=B.squaredLength(m);
const g=2*B.dot(m,h);x=B.squaredLength(h)-x*x;x=g*g-4*y*x;0===x?(y=-g/(2*y),(1===D.type||0<=y)&&c.push(B.scaleAndAdd(v,D.start,m,y))):0<x&&(x=Math.sqrt(x),h=(-g+x)/(2*y),(1===D.type||0<=h)&&c.push(B.scaleAndAdd(v,D.start,m,h)),y=(-g-x)/(2*y),(1===D.type||0<=y)&&c.push(B.scaleAndAdd(r,D.start,m,y)));return c};a.pointToLineDistance=function(D,y,x){return Math.abs((y[0]-D[0])*(x[1]-D[1])-(y[1]-D[1])*(x[0]-D[0]))/B.distance(y,x)};a.projectPoint=f;a.projectPointToCircle=b;a.projectPointToLine=u;a.projectPointToRay=
function(D,y,x,c){B.subtract(p,c,x);B.subtract(r,y,x);y=B.dot(p,r)/B.squaredLength(p);return 0<y?B.scaleAndAdd(D,x,p,y):B.copy(D,x)};Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../hints/LineSnappingHint ./SnappingCandidate ../SnappingConstraint".split(" "),function(a,e,l,B,d,
f,u,b){u=function(r){function v({coordinateHelper:D,lineStart:y,lineEnd:x,targetPoint:c}){D=r.call(this,D,c,new b.LineConstraint(D,y,x))||this;D.referenceLineHint=new f.LineSnappingHint(2,y,x);return D}e._inheritsLoose(v,r);v.prototype.lineEndClosestToTarget=function(){const D=this.constraint.start,y=this.constraint.end;return 0<l.sign(d.dot(d.subtract(q,y,D),d.subtract(p,this.targetPoint,D)))?y:D};e._createClass(v,[{key:"hints",get:function(){return[this.referenceLineHint,new f.LineSnappingHint(0,
this.lineEndClosestToTarget(),this.targetPoint)]}}]);return v}(u.SnappingCandidate);const p=B.create(),q=B.create();a.LineSnappingCandidate=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2f64 ../../../chunks/vec2 ./Settings ./snappingUtils ../../support/geometry2dUtils".split(" "),function(a,e,l,B,d,f,u){let b=function(x){this.coordinateHelper=x},p=function(x){function c(h,
g){h=x.call(this,h)||this;h.point=g;return h}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?f.objectEqual(this.point,h.point):!1};m.check=function(h){return B.squaredDistance(h,this.point)<d.defaults.pointThreshold};m.closestTo=function(){return this.coordinateHelper.clone(this.point)};m.intersect=function(h){const g=[];h instanceof q?g.push(...u.intersectLineAndPoint({start:h.start,end:h.end,type:h instanceof v?1:0},this.point)):h instanceof y&&g.push(...u.intersectCircleAndPoint(h.center,
h.radius,this.point));return g.map(k=>new D(this.coordinateHelper,k,this,h))};return c}(b),q=function(x){function c(h,g,k){h=x.call(this,h)||this;h.start=g;h.end=k;return h}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?f.objectEqual(this.start,h.start)&&f.objectEqual(this.end,h.end):!1};m.intersect=function(h){const g=[];h instanceof p?g.push(...u.intersectLineAndPoint({start:this.start,end:this.end,type:this instanceof v?1:0},h.point)):h instanceof c?g.push(...u.intersectLineAndRay({start:this.start,
end:this.end,type:this instanceof v?1:0},{start:h.start,end:h.end,type:h instanceof v?1:0})):h instanceof y&&g.push(...u.intersectLineLikeAndCircle({start:this.start,end:this.end,type:this instanceof v?1:0},h.center,h.radius));return g.map(k=>new D(this.coordinateHelper,k,this,h))};return c}(b),r=function(x){function c(h,g,k){h=x.call(this,h,g,k)||this;h.dir=l.create();h.p=l.create();return h}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?x.prototype.objectEqual.call(this,
h):!1};m.check=function(h){B.subtract(this.dir,this.end,this.start);B.subtract(this.p,h,this.start);return 0<=B.dot(this.dir,this.p)?u.pointToLineDistance(h,this.start,this.end)<d.defaults.pointOnLineThreshold:!1};m.closestTo=function(h){const g=this.coordinateHelper.clone(h);u.projectPointToRay(g,h,this.start,this.end);return g};return c}(q),v=function(x){function c(h,g,k){return x.call(this,h,g,k)||this}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?x.prototype.objectEqual.call(this,
h):!1};m.check=function(h){return u.pointToLineDistance(h,this.start,this.end)<d.defaults.pointOnLineThreshold};m.closestTo=function(h){const g=this.coordinateHelper.clone(h);u.projectPointToLine(g,h,this.start,this.end);return g};return c}(q),D=function(x){function c(h,g,k,n){h=x.call(this,h)||this;h.intersection=g;h.first=k;h.second=n;return h}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?this.first.objectEqual(h.first)&&this.second.objectEqual(h.second):
!1};m.check=function(){return!1};m.closestTo=function(h){h=this.coordinateHelper.clone(h);B.copy(h,this.intersection);return h};m.intersect=function(){return[]};return c}(b),y=function(x){function c(h,g,k){h=x.call(this,h)||this;h.center=g;h.radius=k;return h}e._inheritsLoose(c,x);var m=c.prototype;m.objectEqual=function(h){return h instanceof c?this.center[0]===h.center[0]&&this.center[1]===h.center[1]&&this.radius===h.radius:!1};m.check=function(){return!1};m.closestTo=function(h){const g=this.coordinateHelper.clone(h);
u.projectPointToCircle(g,h,this.center,this.radius);return g};m.intersect=function(h){const g=[];h instanceof q?g.push(...u.intersectLineLikeAndCircle({start:h.start,end:h.end,type:h instanceof v?1:0},this.center,this.radius)):h instanceof p&&g.push(...u.intersectCircleAndPoint(this.center,this.radius,h.point));return g.map(k=>new D(this.coordinateHelper,k,this,h))};return c}(b);a.IntersectionConstraint=D;a.LineConstraint=v;a.LineLikeConstraint=q;a.PlanarCircleConstraint=y;a.PointConstraint=p;a.RayConstraint=
r;a.SnappingConstraint=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2f64 ../../../chunks/vec2 ./Settings ./snappingUtils ./SnappingAlgorithm ../../support/geometry2dUtils ./candidates/ParallelLineSnappingCandidate".split(" "),function(a,e,l,B,d,f,u,b,p,q){b=function(r){function v(){var y=r.apply(this,arguments)||this;y._tmpProjection=
B.create();return y}e._inheritsLoose(v,r);var D=v.prototype;D.snapNewVertex=function(y,x){var c=x.geometry.editGeometry.components[0],m=c.edges.length,h=c.vertices.length;const g=[];if(2>m)return g;const k=u.anyMapPointToScreenPoint(y,x.coordinateHelper,x.elevationInfo,this.view);h=c.vertices[h-1];const n=c.vertices[0];m=c=c.edges[m-1];do this.edgeExceedsShortLineThreshold(m,x)&&(this._checkEdgeForParalleLines(m,h.pos,y,k,x,g),this._checkEdgeForParalleLines(m,n.pos,y,k,x,g)),m=m.left.left;while(m&&
m!==c);return g};D.snapExistingVertex=function(y,x){const c=[],m=l.unwrap(x.vertexHandle);var h=m.component;if(3>h.edges.length)return c;const g=u.anyMapPointToScreenPoint(y,x.coordinateHelper,x.elevationInfo,this.view),k=m.left,n=m.right,G=h.vertices[0],C=h.vertices[h.vertices.length-1];let t=h=h.edges[0];do t!==k&&t!==n&&this.edgeExceedsShortLineThreshold(t,x)&&(k&&this._checkEdgeForParalleLines(t,k.left.pos,y,g,x,c),n&&this._checkEdgeForParalleLines(t,n.right.pos,y,g,x,c),m===G?this._checkEdgeForParalleLines(t,
C.pos,y,g,x,c):m===C&&this._checkEdgeForParalleLines(t,G.pos,y,g,x,c)),t=t.right.right;while(t&&t!==h);return c};D._checkEdgeForParalleLines=function(y,x,c,m,h,g){var k=y.left.pos;const n=y.right.pos;p.projectPointToLine(this._tmpProjection,x,k,n);d.squaredDistance(this._tmpProjection,x)<f.defaults.parallelLineThreshold||(p.projectPointToLine(this._tmpProjection,c,k,n,x),k=h.coordinateHelper,c=k.fromXYZ(this._tmpProjection,k.getZ(c,0)),u.squareDistance(m,u.anyMapPointToScreenPoint(c,k,h.elevationInfo,
this.view))<this.squaredProximityTreshold(h.pointer)&&!this.parallelToPreviousCandidate(y,g)&&g.push(new q.ParallelLineSnappingCandidate({coordinateHelper:k,referenceLine:y,lineStart:x,targetPoint:c})))};D.parallelToPreviousCandidate=function(y,x){const c=y.left.pos,m=y.right.pos;for(const h of x)if(p.projectPointToLine(this._tmpProjection,m,h.constraint.start,h.constraint.end,c),d.squaredDistance(this._tmpProjection,m)<f.defaults.parallelLineThreshold)return h.addReferenceLine(y),!0;return!1};return v}(b.SnappingAlgorithm);
a.ParallelLineSnapper=b;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../hints/LineSnappingHint ../hints/ParallelSnappingHint ./SnappingCandidate ../SnappingConstraint".split(" "),function(a,e,l,B,d,f,u){f=function(b){function p({coordinateHelper:q,referenceLine:r,lineStart:v,targetPoint:D}){const y=q.clone(v);l.subtract(y,
l.add(y,y,r.right.pos),r.left.pos);q=b.call(this,q,D,new u.LineConstraint(q,v,y))||this;q._referenceLines=[{edge:r,fadeLeft:!0,fadeRight:!0}];return q}e._inheritsLoose(p,b);p.prototype.addReferenceLine=function(q){const r={edge:q,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(v=>{q.right.right===v.edge&&(v.fadeLeft=!1,r.fadeRight=!1);q.left.left===v.edge&&(v.fadeRight=!1,r.fadeLeft=!1)});this._referenceLines.push(r)};e._createClass(p,[{key:"hints",get:function(){return[new B.LineSnappingHint(0,
this.constraint.start,this.targetPoint),new d.ParallelSnappingHint(this.constraint.start,this.targetPoint),...this._referenceLines.map(q=>new B.LineSnappingHint(1,q.edge.left.pos,q.edge.right.pos,q.fadeLeft,q.fadeRight))]}}]);return p}(f.SnappingCandidate);a.ParallelLineSnappingCandidate=f;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/mathUtils ../../../chunks/vec2f64 ../../../chunks/vec2 ./snappingUtils ./SnappingAlgorithm ./SnappingConstraint ./candidates/RightAngleSnappingCandidate".split(" "),
function(a,e,l,B,d,f,u,b,p,q){b=function(r){function v(){var y=r.apply(this,arguments)||this;y._tmp=d.create();return y}e._inheritsLoose(v,r);var D=v.prototype;D.snapNewVertex=function(y,x){var c=x.geometry.editGeometry.components[0],m=c.vertices.length;const h=[];if(2>m)return h;const g=u.anyMapPointToScreenPoint(y,x.coordinateHelper,x.elevationInfo,this.view);m=c.vertices[m-1];this._checkForSnappingCandidate(h,m.left,m.pos,y,m.left.left.pos,m.pos,x,y,g);c=c.vertices[0];this._checkForSnappingCandidate(h,
c.right,c.pos,y,c.right.right.pos,c.pos,x,y,g);return h};D.snapExistingVertex=function(y,x){const c=[];var m=l.unwrap(x.vertexHandle),h=m.component;const g=h.vertices.length;if(3>g)return c;const k=u.anyMapPointToScreenPoint(y,x.coordinateHelper,x.elevationInfo,this.view);var n=m.left;m=m.right;const G=h.vertices[0];h=h.vertices[g-1];if(!n)return this._checkForSnappingCandidate(c,G.right.right.right,G.right.right.pos,y,G.right.right.right.right.pos,G.right.right.pos,x,y,k),c;if(!m)return this._checkForSnappingCandidate(c,
h.left.left.left,h.left.left.pos,y,h.left.left.left.left.pos,h.left.left.pos,x,y,k),c;n&&n.left.left&&(h=n.left.left,this._checkForSnappingCandidate(c,h,n.left.pos,y,h.left.pos,n.left.pos,x,y,k));m&&m.right.right&&(n=m.right.right,this._checkForSnappingCandidate(c,n,m.right.pos,y,n.right.pos,m.right.pos,x,y,k));return c};D._checkForSnappingCandidate=function(y,x,c,m,h,g,k,n,G){this.edgeExceedsShortLineThreshold(x,k)&&(f.subtract(this._tmp,x.right.pos,x.left.pos),x=d.fromValues(this._tmp[1],-this._tmp[0]),
c=f.dot(x,f.subtract(this._tmp,m,c))/f.squaredLength(x),m=k.coordinateHelper,n=m.fromXYZ(f.scaleAndAdd(d.create(),g,x,c),m.getZ(n,0)),u.squareDistance(G,u.anyMapPointToScreenPoint(n,m,k.elevationInfo,this.view))<this.squaredProximityTreshold(k.pointer)&&y.push(new q.RightAngleSnappingCandidate({coordinateHelper:m,targetPoint:n,constraint:new p.RayConstraint(m,g,f.scaleAndAdd(m.createNew(),g,x,B.sign(c))),previousVertex:h,centerVertex:g})))};return v}(b.SnappingAlgorithm);a.RightAngleSnapper=b;Object.defineProperty(a,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../hints/LineSnappingHint","../hints/RightAngleSnappingHint","./SnappingCandidate"],function(a,e,l,B,d){d=function(f){function u({coordinateHelper:b,targetPoint:p,constraint:q,previousVertex:r,centerVertex:v}){b=f.call(this,b,p,q)||this;b.previousVertex=r;b.centerVertex=v;b.referenceLine=new l.LineSnappingHint(1,r,q.start);
return b}e._inheritsLoose(u,f);e._createClass(u,[{key:"hints",get:function(){return[new l.LineSnappingHint(0,this.constraint.start,this.targetPoint),this.referenceLine,new B.RightAngleSnappingHint(this.previousVertex,this.centerVertex,this.targetPoint)]}}]);return u}(d.SnappingCandidate);a.RightAngleSnappingCandidate=d;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2f64 ../../../chunks/vec2 ./snappingUtils ./SnappingAlgorithm ../../support/geometry2dUtils ./candidates/RightAngleTriangleSnappingCandidate".split(" "),
function(a,e,l,B,d,f,u,b,p){u=function(q){function r(){return q.apply(this,arguments)||this}e._inheritsLoose(r,q);var v=r.prototype;v.snapNewVertex=function(D,y){const x=y.geometry.editGeometry.components[0],c=[],m=x.vertices.length;if("polygon"!==y.geometry.type||2>m)return c;this._processCandidateProposal(x.vertices[0].pos,x.vertices[m-1].pos,D,y,c);return c};v.snapExistingVertex=function(D,y){const x=[],c=l.unwrap(y.vertexHandle),m=c.component;if(2>m.edges.length||"polyline"===y.geometry.type&&
(0===c.index||c.index===m.vertices.length-1))return x;this._processCandidateProposal(c.left.left.pos,c.right.right.pos,D,y,x);return x};v._processCandidateProposal=function(D,y,x,c,m){if(this.exceedsShortLineThreshold(D,y,c)){var h=d.lerp(B.create(),D,y,.5),g=.5*d.distance(D,y);g=b.projectPointToCircle(B.create(),x,h,g);h=c.coordinateHelper;g=h.fromXYZ(g,h.getZ(x,0));x=f.anyMapPointToScreenPoint(x,h,c.elevationInfo,this.view);f.squareDistance(x,f.anyMapPointToScreenPoint(g,h,c.elevationInfo,this.view))<
this.squaredProximityTreshold(c.pointer)&&m.push(new p.RightAngleTriangleSnappingCandidate({coordinateHelper:h,targetPoint:g,point1:D,point2:y}))}};return r}(u.SnappingAlgorithm);a.RightAngleTriangleSnapper=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../hints/LineSnappingHint ../hints/RightAngleSnappingHint ./SnappingCandidate ../SnappingConstraint".split(" "),
function(a,e,l,B,d,f,u,b){u=function(q){function r({coordinateHelper:v,targetPoint:D,point1:y,point2:x}){v=q.call(this,v,D,new b.PlanarCircleConstraint(v,B.lerp(p,y,x,.5),.5*B.distance(y,x)))||this;v.p1=y;v.p2=x;return v}e._inheritsLoose(r,q);e._createClass(r,[{key:"hints",get:function(){return[new d.LineSnappingHint(1,this.targetPoint,this.p1),new d.LineSnappingHint(1,this.targetPoint,this.p2),new f.RightAngleSnappingHint(this.p1,this.targetPoint,this.p2)]}}]);return r}(u.SnappingCandidate);const p=
l.create();a.RightAngleTriangleSnappingCandidate=u;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../hints/IntersectionSnappingHint","./SnappingCandidate","../SnappingConstraint"],function(a,e,l,B,d){B=function(f){function u(b,p,q,r){b=f.call(this,b,p,new d.IntersectionConstraint(b,p,q.constraint,r.constraint))||this;b.first=q;b.second=r;return b}
e._inheritsLoose(u,f);e._createClass(u,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new l.IntersectionSnappingHint(this.targetPoint)]}}]);return u}(B.SnappingCandidate);a.IntersectionSnappingCandidate=B;Object.defineProperty(a,"__esModule",{value:!0})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/compilerUtils ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Evented".split(" "),
function(a,e,l,B,d,f,u,b,p,q,r,v,D,y){a.OperationHandle=function(x){function c(h){h=x.call(this,h)||this;h.cancelled=!1;h.history={undo:[],redo:[]};h.type=null;return h}e._inheritsLoose(c,x);var m=c.prototype;m.addToHistory=function(h){this.history.redo=[];this.history.undo.push(h)};m.resetHistory=function(){this.history.redo=[];this.history.undo=[]};m.canUndo=function(){return 0<this.history.undo.length};m.canRedo=function(){return 0<this.history.redo.length};m.complete=function(){this.reset();this.onEnd();
this.emit("complete")};m.cancel=function(){this.cancelled=!0;this.complete()};m.reset=function(){this.activeComponent.reset()};m.refreshComponent=function(){const h=this.activeComponent;h&&("box"!==h.type&&"reshape"!==h.type||h.refresh())};e._createClass(c,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw":case "draw-3d":break;default:d.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(h){this._set("undo",()=>{this.canUndo()&&h()})}},{key:"redo",set:function(h){this._set("redo",()=>{this.canRedo()&&h()})}}]);return c}(y.EventedAccessor);l.__decorate([b.property()],a.OperationHandle.prototype,"activeComponent",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"cancelled",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"history",void 0);
l.__decorate([b.property()],a.OperationHandle.prototype,"tool",null);l.__decorate([b.property()],a.OperationHandle.prototype,"type",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"canUndo",null);l.__decorate([b.property()],a.OperationHandle.prototype,"canRedo",null);l.__decorate([b.property()],a.OperationHandle.prototype,"onEnd",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"undo",null);l.__decorate([b.property()],a.OperationHandle.prototype,"redo",null);l.__decorate([b.property()],
a.OperationHandle.prototype,"toggleTool",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"addToSelection",void 0);l.__decorate([b.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=l.__decorate([q.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);Object.defineProperty(a,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/events ../layers/support/fieldUtils ../intl/substitute ../intl ../core/watchUtils ../core/HandleOwner ./support/widgetUtils ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ../chunks/index ./Widget ./Attachments ./Spinner ../views/interactive/snapping/SnappingOptions ./FeatureForm ./FeatureTemplates/ItemList ./FeatureTemplates ./Editor/EditorViewModel".split(" "),function(a,
e,l,B,d,f,u,b,p,q,r,v,D,y,x,c,m,h,g,k,n,G,C,t,A,z,w,F,E,N,U){function S(I){I.focus()}l=function(I){function L(K,P){var Q=I.call(this,K,P)||this;Q._candidateCommitted=!1;Q._featureForm=new F;Q._attachments=new A({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});Q._featureTemplates=new N;Q._filterText="";Q._prompt=null;Q._spinner=new z;Q.activeWorkflow=null;Q.allowedWorkflows=null;Q.iconClass="esri-icon-edit";
Q.label=void 0;Q.layerInfos=null;Q.messages=null;Q.messagesCommon=null;Q.messagesTemplates=null;Q.snappingOptions=new w;Q.supportingWidgetDefaults=null;Q.view=null;Q.viewModel=new U;Q._handleHeaderClickOrKeyDown=R=>{R.currentTarget["data-prevent-back"]||Q._handleBack.call(a._assertThisInitialized(Q),R)};Q._setCandidateFeature=(R,Y=!1)=>{if(!Q._candidateCommitted){var T=Q.viewModel.activeWorkflow;T.data.edits.feature=R;Y&&(T.next(),Q._candidateCommitted=!0)}};Q._handleSave=Q._handleSave.bind(a._assertThisInitialized(Q));
Q._handleBack=Q._handleBack.bind(a._assertThisInitialized(Q));Q._handleDone=Q._handleDone.bind(a._assertThisInitialized(Q));Q._handleDelete=Q._handleDelete.bind(a._assertThisInitialized(Q));Q._handleAdd=Q._handleAdd.bind(a._assertThisInitialized(Q));Q._handleEdit=Q._handleEdit.bind(a._assertThisInitialized(Q));Q._handleAttachmentAdd=Q._handleAttachmentAdd.bind(a._assertThisInitialized(Q));Q._handleAttachmentUpdate=Q._handleAttachmentUpdate.bind(a._assertThisInitialized(Q));Q._handleAttachmentDelete=
Q._handleAttachmentDelete.bind(a._assertThisInitialized(Q));return Q}a._inheritsLoose(L,I);var M=L.prototype;M.initialize=function(){this.own([m.init(this,"viewModel",K=>{this._featureForm.viewModel=K?K.featureFormViewModel:null;this._attachments.viewModel=K?K.attachmentsViewModel:null;this._featureTemplates.viewModel=K?K.featureTemplatesViewModel:null;this._spinner.viewModel=K?K.spinnerViewModel:null}),m.init(this,"view",(K,P)=>{const Q=`editor-${this.id}-spinner`;P&&P.ui.remove(this._spinner,Q);
K&&K.ui.add(this._spinner,{key:Q,position:"manual"})}),m.on(this,"viewModel.sketchViewModel","create",()=>{this.scheduleRender()}),m.on(this,"viewModel.activeWorkflow","cancel-request",({controller:K})=>{const {messages:P,messagesCommon:Q}=this;this._prompt={title:P.cancelRequestTitle,message:P.cancelRequestWarningMessage,options:[{label:Q.form.no,type:"neutral",action:()=>{K.deny();return this._prompt=null}},{label:Q.form.yes,type:"negative",action:()=>{K.allow();this._prompt=null}}]};this.scheduleRender()}),
m.init(this,"supportingWidgetDefaults",K=>{K&&(this._featureForm.set(K.featureForm),this._attachments.set(K.attachments),this._featureTemplates.set(K.featureTemplates),this.viewModel.sketchViewModel.set(K.sketch))}),m.watch(this,"_attachments.error",K=>{if(K){var {messages:P,messagesCommon:Q}=this;this._prompt={title:P.errorWarningTitle,message:K.message,options:[{label:Q.form.ok,type:"neutral",action:()=>{this._prompt=null}}]}}}),m.watch(this,"viewModel.failures",K=>{if(K){var {messages:P}=this,
[{error:Q,retry:R,cancel:Y}]=K;this._prompt={title:P.errorWarningTitle,message:x.substitute(P.errorWarningMessageTemplate,{errorMessage:Q.message}),options:[{label:P.retry,type:"positive",action:()=>{R();this._prompt=null}},{label:P.ignore,type:"neutral",action:()=>{Y();return this._prompt=null}}]}}}),m.watch(this,"viewModel.state",K=>{"awaiting-update-feature-candidate"===K&&(this._candidateCommitted=!1)}),m.watch(this,["_attachments.selectedFile","_attachments.submitting"],()=>this.scheduleRender()),
m.whenNot(this,"viewModel.activeWorkflow",()=>this._featureTemplates.filterText="")])};M.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};M.startCreateWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};M.startCreateWorkflowAtFeatureCreation=function(K){return this.viewModel.startCreateWorkflowAtFeatureCreation(K)};M.startCreateWorkflowAtFeatureEdit=function(K){return this.viewModel.startCreateWorkflowAtFeatureEdit(K)};
M.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};M.startUpdateWorkflowAtMultipleFeatureSelection=function(K){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(K)};M.startUpdateWorkflowAtFeatureEdit=function(K){return this.viewModel.startUpdateWorkflowAtFeatureEdit(K)};M.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};M.cancelWorkflow=function(K){return this.viewModel.cancelWorkflow(K)};
M.render=function(){const {_attachments:K,viewModel:P}=this;if(!P)return C.jsx("div",{class:"esri-editor esri-widget esri-widget--panel"});const {state:Q}=P,R=this._prompt?C.jsx("div",{class:"esri-editor__overlay",key:"overlay"},this.renderPrompt({message:this._prompt.message,title:this._prompt.title,options:this._prompt.options})):null;return C.jsx("div",{class:"esri-editor esri-widget esri-widget--panel"},P.syncing||K.submitting?this.renderProgressBar():null,"disabled"===Q?null:"ready"===Q?this.renderLanding():
"awaiting-feature-creation-info"===Q?this.renderTemplates():"editing-new-feature"===Q||"editing-existing-feature"===Q?this.renderAttributeEditing():"awaiting-feature-to-update"===Q?this.renderFeatureUpdating():"awaiting-update-feature-candidate"===Q?this.renderFeatureList():"awaiting-feature-to-create"===Q?this.renderFeatureCreation():"adding-attachment"===Q?this.renderAttachmentAdding():"editing-attachment"===Q?this.renderAttachmentEditing():null,R)};M.renderTemplates=function(){return C.jsx("div",
{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(this.messages.selectTemplate,!0),C.jsx("div",{key:"content",class:"esri-editor__content"},this._featureTemplates.render()))};M.renderAttributeEditing=function(){const {activeWorkflow:K,featureFormViewModel:P}=this.viewModel;var Q=K.data.edits.feature,R="update"===K.type&&!K.data.edits.modified||0<P.inputFields.length&&!P.valid;const {messages:Y,messagesCommon:T}=this,V="create"===K.type?T.add:T.update;R=[{label:V,type:"primary",disabled:R,
clickHandler:this._handleSave}];let W=!1;"update"===K.type&&(K.data.editableItem.hasAttachments&&(W=!0),-1<K.data.editableItem.supports.indexOf("delete")&&R.push({label:T.delete,type:"tertiary",clickHandler:this._handleDelete}));Q=this._getLabel(Q);return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(Q,!0),C.jsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},C.jsx("div",{class:"esri-editor__content-group"},0<P.inputFields.length?
this._featureForm.render():this.renderMessage(x.substitute(Y.clickToFinishTemplate,{button:V})),W?C.jsx("div",{key:"attachments"},C.jsx("div",null,Y.attachments),this._attachments.render()):null)),this.renderControls(R))};M.renderAttachmentAdding=function(){const {_attachments:K,messages:P,messagesCommon:Q}=this,R=[{label:K.submitting?Q.cancel:Q.add,disabled:K.submitting||!K.selectedFile,type:"primary",clickHandler:this._handleAttachmentAdd}];return C.jsx("div",{class:"esri-editor__temp-wrapper",
key:"wrapper"},this.renderHeader(P.addAttachment,!0,K.submitting),C.jsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},K.render()),this.renderControls(R))};M.renderAttachmentEditing=function(){const {_attachments:K,messages:P,messagesCommon:Q}=this,R=[{label:Q.update,disabled:K.submitting||!K.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate},{label:Q.delete,disabled:K.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete}];
return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(P.editAttachment,!0,K.submitting),C.jsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},K.render()),this.renderControls(R))};M.renderFeatureUpdating=function(){const {messages:K}=this;return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(K.selectFeature,!0),C.jsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},
this.renderMessage(K.selectFeatureToEdit)))};M.renderMessage=function(K){return C.jsx("div",{class:"esri-editor__message"},K)};M.renderFeatureCreation=function(){const {messages:K,viewModel:P}=this;var Q=P.sketchViewModel,R=P.activeWorkflow.data.creationInfo.layer;Q=Q.canUndo()&&Q.createGraphic?Q.createGraphic:null;R=this._getSketchingTip(R.geometryType,Q);return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(K.placeFeature,!0),C.jsx("div",{key:"content",class:this.classes("esri-editor__content",
"esri-editor__scroller")},this.renderMessage(R)))};M.renderControls=function(K){return C.jsx("div",{class:"esri-editor__controls",key:"controls"},K.map(({disabled:P=!1,label:Q,type:R,clickHandler:Y},T)=>this.renderButton({label:Q,class:this.classes("esri-editor__control-button","esri-button","secondary"===R?"esri-button--secondary":"tertiary"===R?"esri-button--tertiary":null,P?"esri-button--disabled":null),disabled:P,clickHandler:Y,key:T})))};M.renderPrompt=function({title:K,message:P,options:Q=[]}){return C.jsx("div",
{class:"esri-editor__warning-card",role:"alert"},C.jsx("div",{class:"esri-editor__warning-header"},C.jsx("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),C.jsx("h4",{class:this.classes("esri-heading","esri-editor__warning-heading")},K)),C.jsx("div",{class:"esri-editor__warning-message"},P),C.jsx("div",{class:"esri-editor__warning-divider"}),Q.map(({label:R,action:Y,type:T},V)=>{const W=0===V;return C.jsx("div",{afterCreate:W?S:null,class:this.classes("esri-editor__warning-option",
W?"esri-editor__warning-option--primary":null,"positive"===T?"esri-editor__warning-option--positive":"negative"===T?"esri-editor__warning-option--negative":null),key:V,onclick:Y,onkeydown:X=>{const oa=D.eventKey(X);if("Enter"===oa||" "===oa)X.preventDefault(),Y.call(null)},tabIndex:0,role:"button"},R)}))};M.renderProgressBar=function(){return C.jsx("div",{class:this.classes("esri-editor__progress-bar"),key:"progress-bar"})};M.renderButton=function(K){return C.jsx("button",{class:K.class,disabled:K.disabled,
key:K.key,onclick:K.clickHandler,type:"button"},K.label)};M.renderHeader=function(K,P=!1,Q=!1){const {messagesCommon:R}=this;return C.jsx("header",{class:"esri-editor__header",key:"header"},P?C.jsx("div",{"aria-label":R.back,class:this.classes("esri-editor__back-button","esri-interactive",Q?"esri-button--disabled":null),key:"back-button","data-prevent-back":Q,onclick:this._handleHeaderClickOrKeyDown,onkeydown:this._handleHeaderClickOrKeyDown,role:"button",tabIndex:0,title:R.back},C.jsx("span",{"aria-hidden":"true",
class:g.isRTL()?"esri-icon-right":"esri-icon-left"})):null,C.jsx("h4",{class:this.classes("esri-editor__title","esri-heading")},K))};M.renderLanding=function(){const {messages:K}=this,{allowedWorkflows:P,canCreate:Q,canUpdate:R}=this.viewModel,Y=g.isRTL()?"esri-icon-left":"esri-icon-right";return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(K.widgetLabel),C.jsx("div",{key:"content",class:"esri-editor__content",role:"group"},C.jsx("div",{class:"esri-editor__mode-selection",
key:"mode-selection"},-1<P.indexOf("update")?C.jsx("div",{"aria-disabled":R?"false":"true",class:this.classes("esri-editor__feature-list-item",R?null:"esri-editor__feature-list-item--disabled"),key:"update",onclick:this._handleEdit,onkeydown:this._handleEdit,role:"button",tabIndex:R?0:-1},C.jsx("span",{class:"esri-editor__feature-list-name"},K.editFeature),C.jsx("span",{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",Y)})):null,-1<P.indexOf("create")?C.jsx("div",{class:this.classes("esri-editor__feature-list-item",
Q?null:"esri-editor__feature-list-item--disabled"),key:"create",onclick:this._handleAdd,onkeydown:this._handleAdd,role:"button",tabIndex:Q?0:-1},C.jsx("span",{class:"esri-editor__feature-list-name"},K.addFeature),C.jsx("span",{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",Y)})):null)))};M.renderFeatureList=function(){const {messages:K,messagesTemplates:P,viewModel:{editableItems:Q,activeWorkflow:R}}=this;var Y=R.data.candidates;const T=x.substitute(K.multipleFeaturesTemplate,
{total:Y.length}),V=new Map;Y.map(W=>({label:this._getLabel(W),id:W.attributes[W.layer.objectIdField],data:W})).filter(W=>{const {label:X,data:oa}=W;W=this._filterText.toLowerCase();const {title:ua}=oa.layer;return-1<this.viewModel.editableItems.find(H=>H.layer===oa.layer).supports.indexOf("update")&&(!W||-1<X.toLowerCase().indexOf(W)||-1<ua.toLowerCase().indexOf(W))}).forEach(W=>{const X=W.data.layer;V.has(X)?V.get(X).items.push(W):V.set(X,{id:`${X.id}`,label:X.title,items:[W]})});Y=Q.filter(({layer:W})=>
V.has(W)).map(({layer:W})=>V.get(W)).toArray();return C.jsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(T,!0),C.jsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},E.ItemList({id:this.id,filterText:this._filterText,items:Y,messages:{filterPlaceholder:P.filterPlaceholder,noItems:P.noItems,noMatches:P.noMatches},onItemMouseEnter:({data:W})=>this._setCandidateFeature(W),onItemMouseLeave:()=>this._setCandidateFeature(null),onItemSelect:({data:W})=>
this._setCandidateFeature(W,!0),onFilterChange:W=>this._filterText=W})))};M._getSketchingTip=function(K,P){const {messages:Q}=this;if("point"===K)return Q.tips.clickToAddPoint;if("polygon"===K||"polyline"===K){if(!P)return Q.tips.clickToStart;[P]=P.geometry["polygon"===K?"rings":"paths"];return"polygon"===K&&4>P?Q.tips.clickToContinue:Q.tips.clickToContinueThenDoubleClickToEnd}return Q.tips.clickToAddFeature};M._getLabel=function(K){var P=K.layer;const {objectIdField:Q}=P;({attributes:K}=K);return(P=
y.getDisplayFieldName(P))&&K[P]&&`${K[P]}`||x.substitute(this.messages.untitledFeatureTemplate,{id:K[Q]})};M._handleDelete=function(){const {messages:K,messagesCommon:P}=this;this._prompt={title:K.deleteWarningTitle,message:K.deleteWarningMessage,options:[{label:K.keepFeature,type:"neutral",action:()=>this._prompt=null},{label:P.delete,type:"positive",action:()=>{this.viewModel.deleteFeatureFromWorkflow();this._prompt=null}}]}};M._handleSave=function(){this.viewModel.activeWorkflow.commit()};M._handleAttachmentAdd=
function(){const {_attachments:K}=this,{activeWorkflow:P}=this.viewModel;K.addAttachment().then(()=>P.previous())};M._handleAttachmentUpdate=function(){const {_attachments:K}=this,{activeWorkflow:P}=this.viewModel;K.updateAttachment().then(()=>P.previous())};M._handleAttachmentDelete=function(){const {messages:K,messagesCommon:P}=this;this._prompt={title:K.deleteAttachmentWarningTitle,message:K.deleteAttachmentWarningMessage,options:[{label:K.keepAttachment,type:"neutral",action:()=>this._prompt=
null},{label:P.delete,type:"positive",action:()=>{const {_attachments:Q}=this,{activeWorkflow:R}=this.viewModel;Q.deleteAttachment(Q.viewModel.activeAttachmentInfo).then(()=>{R.previous();this._prompt=null})}}]}};M._handleAdd=function(){this.viewModel.canCreate&&this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};M._handleEdit=function(){this.viewModel.canUpdate&&this.viewModel.startUpdateWorkflowAtFeatureSelection()};M._handleDone=function(){this.viewModel.cancelWorkflow({force:!0})};M._handleBack=
function(){const {messages:K}=this,{activeWorkflow:P}=this.viewModel,{stepId:Q,data:R,type:Y}=P,T=()=>{P.hasPreviousStep?P.previous():this.viewModel.cancelWorkflow({force:!0})};"editing-new-feature"===Q||"editing-existing-feature"===Q&&R.edits.modified?this._prompt={title:"create"===Y?K.cancelAddTitle:K.cancelEditTitle,message:"create"===Y?K.cancelAddWarningMessage:K.cancelEditWarningMessage,options:[{label:"create"===Y?K.continueAdding:K.continueEditing,type:"neutral",action:()=>this._prompt=null},
{label:"create"===Y?K.discardFeature:K.discardEdits,type:"negative",action:()=>{T();this._prompt=null}}]}:T()};return L}(h.HandleOwnerMixin(t));e.__decorate([f.property()],l.prototype,"_attachments",void 0);e.__decorate([u.aliasOf("viewModel.activeWorkflow")],l.prototype,"activeWorkflow",void 0);e.__decorate([u.aliasOf("viewModel.allowedWorkflows")],l.prototype,"allowedWorkflows",void 0);e.__decorate([f.property()],l.prototype,"iconClass",void 0);e.__decorate([f.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],l.prototype,"label",void 0);e.__decorate([u.aliasOf("viewModel.layerInfos")],l.prototype,"layerInfos",void 0);e.__decorate([f.property(),n.messageBundle("esri/widgets/Editor/t9n/Editor")],l.prototype,"messages",void 0);e.__decorate([f.property(),n.messageBundle("esri/t9n/common")],l.prototype,"messagesCommon",void 0);e.__decorate([f.property(),n.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],l.prototype,"messagesTemplates",void 0);e.__decorate([u.aliasOf("viewModel.snappingOptions")],
l.prototype,"snappingOptions",void 0);e.__decorate([f.property()],l.prototype,"supportingWidgetDefaults",void 0);e.__decorate([u.aliasOf("viewModel.view")],l.prototype,"view",void 0);e.__decorate([f.property(),G.vmEvent(["workflow-cancel","workflow-commit"])],l.prototype,"viewModel",void 0);e.__decorate([k.accessibleHandler()],l.prototype,"_handleDelete",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleAttachmentAdd",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleAttachmentUpdate",
null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleAttachmentDelete",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleAdd",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleEdit",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleDone",null);e.__decorate([k.accessibleHandler()],l.prototype,"_handleBack",null);return l=e.__decorate([p.subclass("esri.widgets.Editor")],l)});