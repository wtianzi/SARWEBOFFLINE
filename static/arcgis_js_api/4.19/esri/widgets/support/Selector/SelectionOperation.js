// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Evented ../../../core/Collection ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleMarkerSymbol ../../../symbols ../../../core/Handles ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils".split(" "),
function(p,d,c,E,F,e,G,u,H,I,J,v,w,x,y,z,K,A,B,C,D){c=function(r){function m(b){var a=r.call(this)||this;a._activeOptions=null;a._dashedFillSymbol=new y({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});a._dashedLineSymbol=new x({style:"dash",color:[12,207,255],width:2});a._defaultOptions={tool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};a._completed=!1;a._handles=new A;a._sketchViewModel=new C;a._sketchGraphicsLayer=new B({listMode:"hide",
internal:!0});a._transparentPointSymbol=new z({color:[0,0,0,0],outline:{style:"none",width:0}});a.candidates=null;a.geometry=null;a.options=null;a.selection=new w;a.view=null;a.candidates=b.candidates;a.options=b.options;a.view=b.view;const {_dashedFillSymbol:f,_dashedLineSymbol:n,_sketchViewModel:l,_sketchGraphicsLayer:q,_transparentPointSymbol:h}=p._assertThisInitialized(a);l.set({layer:q,view:a.view,activePointSymbol:h,activeLineSymbol:n,activeVertexSymbol:h,activeFillSymbol:f,pointSymbol:h,polygonSymbol:f,
polylineSymbol:n,vertexSymbol:h});a._handles.add([l.on("create",k=>a._onSketchEvent(k)),l.on(["undo","redo"],k=>a._onSketchEvent(k))]);return a}p._inheritsLoose(m,r);var g=m.prototype;g.initialize=function(){this._load()};g.destroy=function(){this._handles.destroy();this._handles=null};g.cancel=function(){this._sketchViewModel.cancel()};g._load=async function(){await this.view.whenReady();const {options:b}=this,{tool:a,createOptions:f}=this._activeOptions={...this._defaultOptions,...b};this._sketchViewModel.create(a,
f)};g._onSketchEvent=function(b){const a="create"===b.type?b.graphic:b.graphics[0];this._processSelectionGeometry((null==a?void 0:a.geometry)||null,"create"===b.type&&"complete"===b.state,"create"===b.type&&"cancel"===b.state)};g._processSelectionGeometry=function(b,a,f){this._set("geometry",b);if(a||f)this._completed=!0;if(f)this._onComplete([],!0);else{var {_activeOptions:n,candidates:l,selection:q,view:h}=this;D.updateSelection({selector:b,candidates:l,currentSelection:q,options:n.selectionOptions,
view:h}).then(({added:k,removed:t})=>{a?this._onComplete(this.selection.toArray(),!1):(k.length||t.length)&&this.emit("selection-change",{added:k,removed:t,type:"selection-change"})})}};g._onComplete=function(b,a){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:a,selection:b,type:"complete"})};p._createClass(m,[{key:"state",get:function(){const {_completed:b,_sketchViewModel:{state:a}}=this;return b?"complete":"active"===a?"active":"disabled"}}]);return m}(v.EventedAccessor);
d.__decorate([e.property()],c.prototype,"_completed",void 0);d.__decorate([e.property()],c.prototype,"candidates",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"geometry",void 0);d.__decorate([e.property()],c.prototype,"options",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"selection",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([e.property({value:null})],c.prototype,"view",void 0);return c=d.__decorate([u.subclass("esri.widgets.support.Selector")],
c)});