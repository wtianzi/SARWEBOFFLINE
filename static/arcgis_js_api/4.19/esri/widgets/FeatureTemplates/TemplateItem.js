// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../Graphic ../../core/watchUtils ../../core/HandleOwner ../../symbols/support/symbolUtils".split(" "),function(l,q,f,e,y,z,g,A,r,B,C,D,t,u,v,
w,x){function m(k){return Object.freeze({__proto__:null,"default":k})}var n;e=n=function(k){function p(a){a=k.call(this,a)||this;a._activeFetchInfo={id:null,request:null};a.description=null;a.label=null;a.layer=null;a.template=null;a.thumbnail=null;return a}q._inheritsLoose(p,k);var h=p.prototype;h.initialize=function(){this.handles.add(v.init(this,["layer.renderer","template"],()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",null)}))};h.clone=function(){const a=
this.thumbnail?this.thumbnail.cloneNode(!0):null,b=new n({layer:this.layer,template:this.template});b._set("thumbnail",a);return b};h.fetchThumbnail=async function(){const {_activeFetchInfo:a}=this;if(`${this.label}-${this.layer.id}`===a.id)return a.request;a.id=`${this.label}-${this.layer.id}`;a.request=this._getPreviewSymbol().then(async b=>{var d;if(`${this.label}-${this.layer.id}`===a.id){var c={maxSize:36};"dictionary"===(null==(d=this.layer.renderer)?void 0:d.type)&&(c.fieldMap=this.layer.renderer.fieldMap,
c.feature={attributes:this.template.prototype.attributes});b=await x.renderPreviewHTML(b,c);`${this.label}-${this.layer.id}`===a.id&&this._set("thumbnail",b)}});return a.request};h._getPreviewSymbol=async function(){const {layer:a,template:b,layer:{renderer:d}}=this;if(d){var c=new u({attributes:b.prototype.attributes});if(c=await d.getSymbolAsync(c))return c}return this._getFallbackSymbolFromGeometry(a)};h._getFallbackSymbolFromGeometry=function(a){({geometryType:a}=a);if("point"===a||"multipoint"===
a)return(new Promise(function(b,d){l(["../../symbols/SimpleMarkerSymbol"],function(c){b(m(c))},d)})).then(b=>new b.default);if("polyline"===a)return(new Promise(function(b,d){l(["../../symbols/SimpleLineSymbol"],function(c){b(m(c))},d)})).then(b=>new b.default);if("polygon"===a||"mesh"===a||"multipatch"===a)return(new Promise(function(b,d){l(["../../symbols/SimpleFillSymbol"],function(c){b(m(c))},d)})).then(b=>new b.default)};return p}(w.HandleOwnerMixin(t));f.__decorate([g.property({aliasOf:"template.description"})],
e.prototype,"description",void 0);f.__decorate([g.property({aliasOf:"template.name"})],e.prototype,"label",void 0);f.__decorate([g.property()],e.prototype,"layer",void 0);f.__decorate([g.property()],e.prototype,"template",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"thumbnail",void 0);return e=n=f.__decorate([r.subclass("esri.widgets.FeatureTemplates.TemplateItem")],e)});