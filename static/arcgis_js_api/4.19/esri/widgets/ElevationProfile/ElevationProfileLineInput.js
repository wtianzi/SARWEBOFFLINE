// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.19/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/handleUtils ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../Color ../../core/watchUtils ../../core/memoize ../../support/elevationInfoUtils ./ElevationProfileLine ../../layers/support/ElevationQuery".split(" "),
function(r,g,c,d,D,E,v,h,F,w,G,H,I,t,x,y,z,A,B){c=function(p){function m(a){a=p.call(this,a)||this;a.type="input";a.color=new t("#00c8c8");a.numSamplesForPreview=50;a.numSamplesPerChunk=500;a.chartFillEnabled=!1;a.chartStrokeOffsetY=-1;a._getQueryElevationDependencies=y.memoize((b,k,e,f,l)=>d.applySome(b,n=>({elevationInfo:n,visibleLayers:k,view:e,stationary:f,spatialReference:l})));return a}r._inheritsLoose(m,p);var u=m.prototype;u.queryElevation=async function(a,{noDataValue:b,signal:k}){const e=
this.queryElevationDependencies;if(d.isNone(e))throw Error("ElevationProfileLineInput: no dependencies");const {view:f,elevationInfo:l,spatialReference:n}=e;if("on-the-ground"===l.mode&&"3d"===f.type){a=await B.GeometryDescriptor.fromGeometry(a).project(n,k);const C=f.elevationProvider;a.coordinates.forEach(q=>{q.z=d.unwrapOr(C.getElevation(q.x,q.y,0,n,"ground"),0)});return{geometry:a.export(),noDataValue:b}}return{geometry:a,noDataValue:b}};u.attach=function(a){const b=()=>this._onChange();return v.handlesGroup([p.prototype.attach.call(this,
a),this.watch("queryElevationDependencies",b),x.on(a,"view.elevationProvider","elevation-change",b)])};r._createClass(m,[{key:"queryElevationDependencies",get:function(){const a=this._viewModel.view;return d.isNone(a)?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,a,a.stationary,a.spatialReference)}},{key:"available",get:function(){return!this._viewModel.inputIsSketched}},{key:"_elevationInfo",get:function(){return d.applySome(this._viewModel.input,z.getGraphicEffectiveElevationInfo)}},
{key:"_visibleLayers",get:function(){var a;const b=null==(a=this._viewModel)?void 0:a.view;a=d.applySome(b,k=>{var e,f;return null==(e=k.map)?void 0:null==(f=e.allLayers)?void 0:f.filter(l=>l.visible).toArray()});return d.unwrapOr(a,[])}}]);return m}(A.ElevationProfileLine);g.__decorate([h.property({type:t,nonNullable:!0})],c.prototype,"color",void 0);g.__decorate([h.property()],c.prototype,"queryElevationDependencies",null);g.__decorate([h.property()],c.prototype,"available",null);g.__decorate([h.property()],
c.prototype,"_elevationInfo",null);g.__decorate([h.property()],c.prototype,"_visibleLayers",null);return c=g.__decorate([w.subclass("esri.widgets.ElevationProfile.ElevationProfileLineInput")],c)});